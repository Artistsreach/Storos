function JF(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var xv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function r0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var XF={exports:{}},s0={},QF={exports:{}},ln={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fg=Symbol.for("react.element"),Dq=Symbol.for("react.portal"),Mq=Symbol.for("react.fragment"),Lq=Symbol.for("react.strict_mode"),Fq=Symbol.for("react.profiler"),Oq=Symbol.for("react.provider"),Vq=Symbol.for("react.context"),$q=Symbol.for("react.forward_ref"),Uq=Symbol.for("react.suspense"),Bq=Symbol.for("react.memo"),zq=Symbol.for("react.lazy"),Ek=Symbol.iterator;function Gq(t){return t===null||typeof t!="object"?null:(t=Ek&&t[Ek]||t["@@iterator"],typeof t=="function"?t:null)}var ZF={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},eO=Object.assign,tO={};function pf(t,e,n){this.props=t,this.context=e,this.refs=tO,this.updater=n||ZF}pf.prototype.isReactComponent={};pf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};pf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function nO(){}nO.prototype=pf.prototype;function f1(t,e,n){this.props=t,this.context=e,this.refs=tO,this.updater=n||ZF}var m1=f1.prototype=new nO;m1.constructor=f1;eO(m1,pf.prototype);m1.isPureReactComponent=!0;var Tk=Array.isArray,rO=Object.prototype.hasOwnProperty,p1={current:null},sO={key:!0,ref:!0,__self:!0,__source:!0};function iO(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)rO.call(e,r)&&!sO.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:fg,type:t,key:i,ref:o,props:s,_owner:p1.current}}function Wq(t,e){return{$$typeof:fg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function g1(t){return typeof t=="object"&&t!==null&&t.$$typeof===fg}function Hq(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Ik=/\/+/g;function p_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?Hq(""+t.key):e.toString(36)}function Tx(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case fg:case Dq:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+p_(o,0):r,Tk(s)?(n="",t!=null&&(n=t.replace(Ik,"$&/")+"/"),Tx(s,e,n,"",function(u){return u})):s!=null&&(g1(s)&&(s=Wq(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Ik,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Tk(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+p_(i,l);o+=Tx(i,e,n,c,s)}else if(c=Gq(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+p_(i,l++),o+=Tx(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function gy(t,e,n){if(t==null)return t;var r=[],s=0;return Tx(t,r,"","",function(i){return e.call(n,i,s++)}),r}function qq(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Qs={current:null},Ix={transition:null},Kq={ReactCurrentDispatcher:Qs,ReactCurrentBatchConfig:Ix,ReactCurrentOwner:p1};function oO(){throw Error("act(...) is not supported in production builds of React.")}ln.Children={map:gy,forEach:function(t,e,n){gy(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return gy(t,function(){e++}),e},toArray:function(t){return gy(t,function(e){return e})||[]},only:function(t){if(!g1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ln.Component=pf;ln.Fragment=Mq;ln.Profiler=Fq;ln.PureComponent=f1;ln.StrictMode=Lq;ln.Suspense=Uq;ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Kq;ln.act=oO;ln.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=eO({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=p1.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)rO.call(e,c)&&!sO.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:fg,type:t.type,key:s,ref:i,props:r,_owner:o}};ln.createContext=function(t){return t={$$typeof:Vq,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Oq,_context:t},t.Consumer=t};ln.createElement=iO;ln.createFactory=function(t){var e=iO.bind(null,t);return e.type=t,e};ln.createRef=function(){return{current:null}};ln.forwardRef=function(t){return{$$typeof:$q,render:t}};ln.isValidElement=g1;ln.lazy=function(t){return{$$typeof:zq,_payload:{_status:-1,_result:t},_init:qq}};ln.memo=function(t,e){return{$$typeof:Bq,type:t,compare:e===void 0?null:e}};ln.startTransition=function(t){var e=Ix.transition;Ix.transition={};try{t()}finally{Ix.transition=e}};ln.unstable_act=oO;ln.useCallback=function(t,e){return Qs.current.useCallback(t,e)};ln.useContext=function(t){return Qs.current.useContext(t)};ln.useDebugValue=function(){};ln.useDeferredValue=function(t){return Qs.current.useDeferredValue(t)};ln.useEffect=function(t,e){return Qs.current.useEffect(t,e)};ln.useId=function(){return Qs.current.useId()};ln.useImperativeHandle=function(t,e,n){return Qs.current.useImperativeHandle(t,e,n)};ln.useInsertionEffect=function(t,e){return Qs.current.useInsertionEffect(t,e)};ln.useLayoutEffect=function(t,e){return Qs.current.useLayoutEffect(t,e)};ln.useMemo=function(t,e){return Qs.current.useMemo(t,e)};ln.useReducer=function(t,e,n){return Qs.current.useReducer(t,e,n)};ln.useRef=function(t){return Qs.current.useRef(t)};ln.useState=function(t){return Qs.current.useState(t)};ln.useSyncExternalStore=function(t,e,n){return Qs.current.useSyncExternalStore(t,e,n)};ln.useTransition=function(){return Qs.current.useTransition()};ln.version="18.3.1";QF.exports=ln;var p=QF.exports;const ht=r0(p),i0=JF({__proto__:null,default:ht},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Yq=p,Jq=Symbol.for("react.element"),Xq=Symbol.for("react.fragment"),Qq=Object.prototype.hasOwnProperty,Zq=Yq.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,eK={key:!0,ref:!0,__self:!0,__source:!0};function aO(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)Qq.call(e,r)&&!eK.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:Jq,type:t,key:i,ref:o,props:s,_owner:Zq.current}}s0.Fragment=Xq;s0.jsx=aO;s0.jsxs=aO;XF.exports=s0;var a=XF.exports,mC={},lO={exports:{}},Ki={},cO={exports:{}},uO={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(H,K){var V=H.length;H.push(K);e:for(;0<V;){var $=V-1>>>1,z=H[$];if(0<s(z,K))H[$]=K,H[V]=z,V=$;else break e}}function n(H){return H.length===0?null:H[0]}function r(H){if(H.length===0)return null;var K=H[0],V=H.pop();if(V!==K){H[0]=V;e:for(var $=0,z=H.length,F=z>>>1;$<F;){var Z=2*($+1)-1,ce=H[Z],le=Z+1,he=H[le];if(0>s(ce,V))le<z&&0>s(he,ce)?(H[$]=he,H[le]=V,$=le):(H[$]=ce,H[Z]=V,$=Z);else if(le<z&&0>s(he,V))H[$]=he,H[le]=V,$=le;else break e}}return K}function s(H,K){var V=H.sortIndex-K.sortIndex;return V!==0?V:H.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,g=!1,x=!1,v=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(H){for(var K=n(u);K!==null;){if(K.callback===null)r(u);else if(K.startTime<=H)r(u),K.sortIndex=K.expirationTime,e(c,K);else break;K=n(u)}}function T(H){if(x=!1,C(H),!g)if(n(c)!==null)g=!0,W(R);else{var K=n(u);K!==null&&X(T,K.startTime-H)}}function R(H,K){g=!1,x&&(x=!1,w(I),I=-1),m=!0;var V=f;try{for(C(K),h=n(c);h!==null&&(!(h.expirationTime>K)||H&&!j());){var $=h.callback;if(typeof $=="function"){h.callback=null,f=h.priorityLevel;var z=$(h.expirationTime<=K);K=t.unstable_now(),typeof z=="function"?h.callback=z:h===n(c)&&r(c),C(K)}else r(c);h=n(c)}if(h!==null)var F=!0;else{var Z=n(u);Z!==null&&X(T,Z.startTime-K),F=!1}return F}finally{h=null,f=V,m=!1}}var A=!1,E=null,I=-1,N=5,k=-1;function j(){return!(t.unstable_now()-k<N)}function D(){if(E!==null){var H=t.unstable_now();k=H;var K=!0;try{K=E(!0,H)}finally{K?L():(A=!1,E=null)}}else A=!1}var L;if(typeof _=="function")L=function(){_(D)};else if(typeof MessageChannel<"u"){var G=new MessageChannel,B=G.port2;G.port1.onmessage=D,L=function(){B.postMessage(null)}}else L=function(){v(D,0)};function W(H){E=H,A||(A=!0,L())}function X(H,K){I=v(function(){H(t.unstable_now())},K)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(H){H.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,W(R))},t.unstable_forceFrameRate=function(H){0>H||125<H?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<H?Math.floor(1e3/H):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(H){switch(f){case 1:case 2:case 3:var K=3;break;default:K=f}var V=f;f=K;try{return H()}finally{f=V}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(H,K){switch(H){case 1:case 2:case 3:case 4:case 5:break;default:H=3}var V=f;f=H;try{return K()}finally{f=V}},t.unstable_scheduleCallback=function(H,K,V){var $=t.unstable_now();switch(typeof V=="object"&&V!==null?(V=V.delay,V=typeof V=="number"&&0<V?$+V:$):V=$,H){case 1:var z=-1;break;case 2:z=250;break;case 5:z=1073741823;break;case 4:z=1e4;break;default:z=5e3}return z=V+z,H={id:d++,callback:K,priorityLevel:H,startTime:V,expirationTime:z,sortIndex:-1},V>$?(H.sortIndex=V,e(u,H),n(c)===null&&H===n(u)&&(x?(w(I),I=-1):x=!0,X(T,V-$))):(H.sortIndex=z,e(c,H),g||m||(g=!0,W(R))),H},t.unstable_shouldYield=j,t.unstable_wrapCallback=function(H){var K=f;return function(){var V=f;f=K;try{return H.apply(this,arguments)}finally{f=V}}}})(uO);cO.exports=uO;var tK=cO.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var nK=p,Gi=tK;function Ze(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var dO=new Set,pp={};function od(t,e){Lh(t,e),Lh(t+"Capture",e)}function Lh(t,e){for(pp[t]=e,t=0;t<e.length;t++)dO.add(e[t])}var Za=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),pC=Object.prototype.hasOwnProperty,rK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Nk={},Pk={};function sK(t){return pC.call(Pk,t)?!0:pC.call(Nk,t)?!1:rK.test(t)?Pk[t]=!0:(Nk[t]=!0,!1)}function iK(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function oK(t,e,n,r){if(e===null||typeof e>"u"||iK(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Zs(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var gs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){gs[t]=new Zs(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];gs[e]=new Zs(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){gs[t]=new Zs(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){gs[t]=new Zs(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){gs[t]=new Zs(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){gs[t]=new Zs(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){gs[t]=new Zs(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){gs[t]=new Zs(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){gs[t]=new Zs(t,5,!1,t.toLowerCase(),null,!1,!1)});var y1=/[\-:]([a-z])/g;function x1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(y1,x1);gs[e]=new Zs(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(y1,x1);gs[e]=new Zs(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(y1,x1);gs[e]=new Zs(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){gs[t]=new Zs(t,1,!1,t.toLowerCase(),null,!1,!1)});gs.xlinkHref=new Zs("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){gs[t]=new Zs(t,1,!1,t.toLowerCase(),null,!0,!0)});function v1(t,e,n,r){var s=gs.hasOwnProperty(e)?gs[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(oK(e,n,s,r)&&(n=null),r||s===null?sK(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var fl=nK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,yy=Symbol.for("react.element"),Kd=Symbol.for("react.portal"),Yd=Symbol.for("react.fragment"),w1=Symbol.for("react.strict_mode"),gC=Symbol.for("react.profiler"),hO=Symbol.for("react.provider"),fO=Symbol.for("react.context"),b1=Symbol.for("react.forward_ref"),yC=Symbol.for("react.suspense"),xC=Symbol.for("react.suspense_list"),_1=Symbol.for("react.memo"),Fl=Symbol.for("react.lazy"),mO=Symbol.for("react.offscreen"),Ak=Symbol.iterator;function Of(t){return t===null||typeof t!="object"?null:(t=Ak&&t[Ak]||t["@@iterator"],typeof t=="function"?t:null)}var yr=Object.assign,g_;function hm(t){if(g_===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);g_=e&&e[1]||""}return`
`+g_+t}var y_=!1;function x_(t,e){if(!t||y_)return"";y_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{y_=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?hm(t):""}function aK(t){switch(t.tag){case 5:return hm(t.type);case 16:return hm("Lazy");case 13:return hm("Suspense");case 19:return hm("SuspenseList");case 0:case 2:case 15:return t=x_(t.type,!1),t;case 11:return t=x_(t.type.render,!1),t;case 1:return t=x_(t.type,!0),t;default:return""}}function vC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Yd:return"Fragment";case Kd:return"Portal";case gC:return"Profiler";case w1:return"StrictMode";case yC:return"Suspense";case xC:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case fO:return(t.displayName||"Context")+".Consumer";case hO:return(t._context.displayName||"Context")+".Provider";case b1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case _1:return e=t.displayName||null,e!==null?e:vC(t.type)||"Memo";case Fl:e=t._payload,t=t._init;try{return vC(t(e))}catch{}}return null}function lK(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return vC(e);case 8:return e===w1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function xc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function pO(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function cK(t){var e=pO(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function xy(t){t._valueTracker||(t._valueTracker=cK(t))}function gO(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=pO(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function vv(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function wC(t,e){var n=e.checked;return yr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function kk(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=xc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function yO(t,e){e=e.checked,e!=null&&v1(t,"checked",e,!1)}function bC(t,e){yO(t,e);var n=xc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?_C(t,e.type,n):e.hasOwnProperty("defaultValue")&&_C(t,e.type,xc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Rk(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function _C(t,e,n){(e!=="number"||vv(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var fm=Array.isArray;function yh(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+xc(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function SC(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Ze(91));return yr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function jk(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Ze(92));if(fm(n)){if(1<n.length)throw Error(Ze(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:xc(n)}}function xO(t,e){var n=xc(e.value),r=xc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Dk(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function vO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function CC(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?vO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var vy,wO=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(vy=vy||document.createElement("div"),vy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=vy.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function gp(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var jm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},uK=["Webkit","ms","Moz","O"];Object.keys(jm).forEach(function(t){uK.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),jm[e]=jm[t]})});function bO(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||jm.hasOwnProperty(t)&&jm[t]?(""+e).trim():e+"px"}function _O(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=bO(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var dK=yr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function EC(t,e){if(e){if(dK[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Ze(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Ze(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Ze(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Ze(62))}}function TC(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var IC=null;function S1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var NC=null,xh=null,vh=null;function Mk(t){if(t=gg(t)){if(typeof NC!="function")throw Error(Ze(280));var e=t.stateNode;e&&(e=u0(e),NC(t.stateNode,t.type,e))}}function SO(t){xh?vh?vh.push(t):vh=[t]:xh=t}function CO(){if(xh){var t=xh,e=vh;if(vh=xh=null,Mk(t),e)for(t=0;t<e.length;t++)Mk(e[t])}}function EO(t,e){return t(e)}function TO(){}var v_=!1;function IO(t,e,n){if(v_)return t(e,n);v_=!0;try{return EO(t,e,n)}finally{v_=!1,(xh!==null||vh!==null)&&(TO(),CO())}}function yp(t,e){var n=t.stateNode;if(n===null)return null;var r=u0(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Ze(231,e,typeof n));return n}var PC=!1;if(Za)try{var Vf={};Object.defineProperty(Vf,"passive",{get:function(){PC=!0}}),window.addEventListener("test",Vf,Vf),window.removeEventListener("test",Vf,Vf)}catch{PC=!1}function hK(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Dm=!1,wv=null,bv=!1,AC=null,fK={onError:function(t){Dm=!0,wv=t}};function mK(t,e,n,r,s,i,o,l,c){Dm=!1,wv=null,hK.apply(fK,arguments)}function pK(t,e,n,r,s,i,o,l,c){if(mK.apply(this,arguments),Dm){if(Dm){var u=wv;Dm=!1,wv=null}else throw Error(Ze(198));bv||(bv=!0,AC=u)}}function ad(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function NO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Lk(t){if(ad(t)!==t)throw Error(Ze(188))}function gK(t){var e=t.alternate;if(!e){if(e=ad(t),e===null)throw Error(Ze(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Lk(s),t;if(i===r)return Lk(s),e;i=i.sibling}throw Error(Ze(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(Ze(189))}}if(n.alternate!==r)throw Error(Ze(190))}if(n.tag!==3)throw Error(Ze(188));return n.stateNode.current===n?t:e}function PO(t){return t=gK(t),t!==null?AO(t):null}function AO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=AO(t);if(e!==null)return e;t=t.sibling}return null}var kO=Gi.unstable_scheduleCallback,Fk=Gi.unstable_cancelCallback,yK=Gi.unstable_shouldYield,xK=Gi.unstable_requestPaint,Dr=Gi.unstable_now,vK=Gi.unstable_getCurrentPriorityLevel,C1=Gi.unstable_ImmediatePriority,RO=Gi.unstable_UserBlockingPriority,_v=Gi.unstable_NormalPriority,wK=Gi.unstable_LowPriority,jO=Gi.unstable_IdlePriority,o0=null,da=null;function bK(t){if(da&&typeof da.onCommitFiberRoot=="function")try{da.onCommitFiberRoot(o0,t,void 0,(t.current.flags&128)===128)}catch{}}var Do=Math.clz32?Math.clz32:CK,_K=Math.log,SK=Math.LN2;function CK(t){return t>>>=0,t===0?32:31-(_K(t)/SK|0)|0}var wy=64,by=4194304;function mm(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Sv(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=mm(l):(i&=o,i!==0&&(r=mm(i)))}else o=n&~s,o!==0?r=mm(o):i!==0&&(r=mm(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Do(e),s=1<<n,r|=t[n],e&=~s;return r}function EK(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function TK(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Do(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=EK(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function kC(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function DO(){var t=wy;return wy<<=1,!(wy&4194240)&&(wy=64),t}function w_(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function mg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Do(e),t[e]=n}function IK(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Do(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function E1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Do(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var kn=0;function MO(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var LO,T1,FO,OO,VO,RC=!1,_y=[],Xl=null,Ql=null,Zl=null,xp=new Map,vp=new Map,$l=[],NK="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ok(t,e){switch(t){case"focusin":case"focusout":Xl=null;break;case"dragenter":case"dragleave":Ql=null;break;case"mouseover":case"mouseout":Zl=null;break;case"pointerover":case"pointerout":xp.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":vp.delete(e.pointerId)}}function $f(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=gg(e),e!==null&&T1(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function PK(t,e,n,r,s){switch(e){case"focusin":return Xl=$f(Xl,t,e,n,r,s),!0;case"dragenter":return Ql=$f(Ql,t,e,n,r,s),!0;case"mouseover":return Zl=$f(Zl,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return xp.set(i,$f(xp.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,vp.set(i,$f(vp.get(i)||null,t,e,n,r,s)),!0}return!1}function $O(t){var e=xu(t.target);if(e!==null){var n=ad(e);if(n!==null){if(e=n.tag,e===13){if(e=NO(n),e!==null){t.blockedOn=e,VO(t.priority,function(){FO(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Nx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=jC(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);IC=r,n.target.dispatchEvent(r),IC=null}else return e=gg(n),e!==null&&T1(e),t.blockedOn=n,!1;e.shift()}return!0}function Vk(t,e,n){Nx(t)&&n.delete(e)}function AK(){RC=!1,Xl!==null&&Nx(Xl)&&(Xl=null),Ql!==null&&Nx(Ql)&&(Ql=null),Zl!==null&&Nx(Zl)&&(Zl=null),xp.forEach(Vk),vp.forEach(Vk)}function Uf(t,e){t.blockedOn===e&&(t.blockedOn=null,RC||(RC=!0,Gi.unstable_scheduleCallback(Gi.unstable_NormalPriority,AK)))}function wp(t){function e(s){return Uf(s,t)}if(0<_y.length){Uf(_y[0],t);for(var n=1;n<_y.length;n++){var r=_y[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Xl!==null&&Uf(Xl,t),Ql!==null&&Uf(Ql,t),Zl!==null&&Uf(Zl,t),xp.forEach(e),vp.forEach(e),n=0;n<$l.length;n++)r=$l[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<$l.length&&(n=$l[0],n.blockedOn===null);)$O(n),n.blockedOn===null&&$l.shift()}var wh=fl.ReactCurrentBatchConfig,Cv=!0;function kK(t,e,n,r){var s=kn,i=wh.transition;wh.transition=null;try{kn=1,I1(t,e,n,r)}finally{kn=s,wh.transition=i}}function RK(t,e,n,r){var s=kn,i=wh.transition;wh.transition=null;try{kn=4,I1(t,e,n,r)}finally{kn=s,wh.transition=i}}function I1(t,e,n,r){if(Cv){var s=jC(t,e,n,r);if(s===null)A_(t,e,r,Ev,n),Ok(t,r);else if(PK(s,t,e,n,r))r.stopPropagation();else if(Ok(t,r),e&4&&-1<NK.indexOf(t)){for(;s!==null;){var i=gg(s);if(i!==null&&LO(i),i=jC(t,e,n,r),i===null&&A_(t,e,r,Ev,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else A_(t,e,r,null,n)}}var Ev=null;function jC(t,e,n,r){if(Ev=null,t=S1(r),t=xu(t),t!==null)if(e=ad(t),e===null)t=null;else if(n=e.tag,n===13){if(t=NO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Ev=t,null}function UO(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(vK()){case C1:return 1;case RO:return 4;case _v:case wK:return 16;case jO:return 536870912;default:return 16}default:return 16}}var ql=null,N1=null,Px=null;function BO(){if(Px)return Px;var t,e=N1,n=e.length,r,s="value"in ql?ql.value:ql.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Px=s.slice(t,1<r?1-r:void 0)}function Ax(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Sy(){return!0}function $k(){return!1}function Yi(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Sy:$k,this.isPropagationStopped=$k,this}return yr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Sy)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Sy)},persist:function(){},isPersistent:Sy}),e}var gf={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},P1=Yi(gf),pg=yr({},gf,{view:0,detail:0}),jK=Yi(pg),b_,__,Bf,a0=yr({},pg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:A1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bf&&(Bf&&t.type==="mousemove"?(b_=t.screenX-Bf.screenX,__=t.screenY-Bf.screenY):__=b_=0,Bf=t),b_)},movementY:function(t){return"movementY"in t?t.movementY:__}}),Uk=Yi(a0),DK=yr({},a0,{dataTransfer:0}),MK=Yi(DK),LK=yr({},pg,{relatedTarget:0}),S_=Yi(LK),FK=yr({},gf,{animationName:0,elapsedTime:0,pseudoElement:0}),OK=Yi(FK),VK=yr({},gf,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),$K=Yi(VK),UK=yr({},gf,{data:0}),Bk=Yi(UK),BK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zK={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},GK={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function WK(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=GK[t])?!!e[t]:!1}function A1(){return WK}var HK=yr({},pg,{key:function(t){if(t.key){var e=BK[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Ax(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?zK[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:A1,charCode:function(t){return t.type==="keypress"?Ax(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ax(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),qK=Yi(HK),KK=yr({},a0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),zk=Yi(KK),YK=yr({},pg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:A1}),JK=Yi(YK),XK=yr({},gf,{propertyName:0,elapsedTime:0,pseudoElement:0}),QK=Yi(XK),ZK=yr({},a0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),eY=Yi(ZK),tY=[9,13,27,32],k1=Za&&"CompositionEvent"in window,Mm=null;Za&&"documentMode"in document&&(Mm=document.documentMode);var nY=Za&&"TextEvent"in window&&!Mm,zO=Za&&(!k1||Mm&&8<Mm&&11>=Mm),Gk=String.fromCharCode(32),Wk=!1;function GO(t,e){switch(t){case"keyup":return tY.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function WO(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Jd=!1;function rY(t,e){switch(t){case"compositionend":return WO(e);case"keypress":return e.which!==32?null:(Wk=!0,Gk);case"textInput":return t=e.data,t===Gk&&Wk?null:t;default:return null}}function sY(t,e){if(Jd)return t==="compositionend"||!k1&&GO(t,e)?(t=BO(),Px=N1=ql=null,Jd=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return zO&&e.locale!=="ko"?null:e.data;default:return null}}var iY={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!iY[t.type]:e==="textarea"}function HO(t,e,n,r){SO(r),e=Tv(e,"onChange"),0<e.length&&(n=new P1("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Lm=null,bp=null;function oY(t){rV(t,0)}function l0(t){var e=Zd(t);if(gO(e))return t}function aY(t,e){if(t==="change")return e}var qO=!1;if(Za){var C_;if(Za){var E_="oninput"in document;if(!E_){var qk=document.createElement("div");qk.setAttribute("oninput","return;"),E_=typeof qk.oninput=="function"}C_=E_}else C_=!1;qO=C_&&(!document.documentMode||9<document.documentMode)}function Kk(){Lm&&(Lm.detachEvent("onpropertychange",KO),bp=Lm=null)}function KO(t){if(t.propertyName==="value"&&l0(bp)){var e=[];HO(e,bp,t,S1(t)),IO(oY,e)}}function lY(t,e,n){t==="focusin"?(Kk(),Lm=e,bp=n,Lm.attachEvent("onpropertychange",KO)):t==="focusout"&&Kk()}function cY(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return l0(bp)}function uY(t,e){if(t==="click")return l0(e)}function dY(t,e){if(t==="input"||t==="change")return l0(e)}function hY(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Oo=typeof Object.is=="function"?Object.is:hY;function _p(t,e){if(Oo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!pC.call(e,s)||!Oo(t[s],e[s]))return!1}return!0}function Yk(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Jk(t,e){var n=Yk(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Yk(n)}}function YO(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?YO(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function JO(){for(var t=window,e=vv();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=vv(t.document)}return e}function R1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function fY(t){var e=JO(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&YO(n.ownerDocument.documentElement,n)){if(r!==null&&R1(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Jk(n,i);var o=Jk(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var mY=Za&&"documentMode"in document&&11>=document.documentMode,Xd=null,DC=null,Fm=null,MC=!1;function Xk(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;MC||Xd==null||Xd!==vv(r)||(r=Xd,"selectionStart"in r&&R1(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),Fm&&_p(Fm,r)||(Fm=r,r=Tv(DC,"onSelect"),0<r.length&&(e=new P1("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Xd)))}function Cy(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var Qd={animationend:Cy("Animation","AnimationEnd"),animationiteration:Cy("Animation","AnimationIteration"),animationstart:Cy("Animation","AnimationStart"),transitionend:Cy("Transition","TransitionEnd")},T_={},XO={};Za&&(XO=document.createElement("div").style,"AnimationEvent"in window||(delete Qd.animationend.animation,delete Qd.animationiteration.animation,delete Qd.animationstart.animation),"TransitionEvent"in window||delete Qd.transitionend.transition);function c0(t){if(T_[t])return T_[t];if(!Qd[t])return t;var e=Qd[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in XO)return T_[t]=e[n];return t}var QO=c0("animationend"),ZO=c0("animationiteration"),eV=c0("animationstart"),tV=c0("transitionend"),nV=new Map,Qk="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ac(t,e){nV.set(t,e),od(e,[t])}for(var I_=0;I_<Qk.length;I_++){var N_=Qk[I_],pY=N_.toLowerCase(),gY=N_[0].toUpperCase()+N_.slice(1);Ac(pY,"on"+gY)}Ac(QO,"onAnimationEnd");Ac(ZO,"onAnimationIteration");Ac(eV,"onAnimationStart");Ac("dblclick","onDoubleClick");Ac("focusin","onFocus");Ac("focusout","onBlur");Ac(tV,"onTransitionEnd");Lh("onMouseEnter",["mouseout","mouseover"]);Lh("onMouseLeave",["mouseout","mouseover"]);Lh("onPointerEnter",["pointerout","pointerover"]);Lh("onPointerLeave",["pointerout","pointerover"]);od("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));od("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));od("onBeforeInput",["compositionend","keypress","textInput","paste"]);od("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));od("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));od("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pm="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yY=new Set("cancel close invalid load scroll toggle".split(" ").concat(pm));function Zk(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,pK(r,e,void 0,t),t.currentTarget=null}function rV(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;Zk(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;Zk(s,l,u),i=c}}}if(bv)throw t=AC,bv=!1,AC=null,t}function Yn(t,e){var n=e[$C];n===void 0&&(n=e[$C]=new Set);var r=t+"__bubble";n.has(r)||(sV(e,t,2,!1),n.add(r))}function P_(t,e,n){var r=0;e&&(r|=4),sV(n,t,r,e)}var Ey="_reactListening"+Math.random().toString(36).slice(2);function Sp(t){if(!t[Ey]){t[Ey]=!0,dO.forEach(function(n){n!=="selectionchange"&&(yY.has(n)||P_(n,!1,t),P_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ey]||(e[Ey]=!0,P_("selectionchange",!1,e))}}function sV(t,e,n,r){switch(UO(e)){case 1:var s=kK;break;case 4:s=RK;break;default:s=I1}n=s.bind(null,e,n,t),s=void 0,!PC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function A_(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=xu(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}IO(function(){var u=i,d=S1(n),h=[];e:{var f=nV.get(t);if(f!==void 0){var m=P1,g=t;switch(t){case"keypress":if(Ax(n)===0)break e;case"keydown":case"keyup":m=qK;break;case"focusin":g="focus",m=S_;break;case"focusout":g="blur",m=S_;break;case"beforeblur":case"afterblur":m=S_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=Uk;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=MK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=JK;break;case QO:case ZO:case eV:m=OK;break;case tV:m=QK;break;case"scroll":m=jK;break;case"wheel":m=eY;break;case"copy":case"cut":case"paste":m=$K;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=zk}var x=(e&4)!==0,v=!x&&t==="scroll",w=x?f!==null?f+"Capture":null:f;x=[];for(var _=u,C;_!==null;){C=_;var T=C.stateNode;if(C.tag===5&&T!==null&&(C=T,w!==null&&(T=yp(_,w),T!=null&&x.push(Cp(_,T,C)))),v)break;_=_.return}0<x.length&&(f=new m(f,g,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==IC&&(g=n.relatedTarget||n.fromElement)&&(xu(g)||g[el]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?xu(g):null,g!==null&&(v=ad(g),g!==v||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(x=Uk,T="onMouseLeave",w="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(x=zk,T="onPointerLeave",w="onPointerEnter",_="pointer"),v=m==null?f:Zd(m),C=g==null?f:Zd(g),f=new x(T,_+"leave",m,n,d),f.target=v,f.relatedTarget=C,T=null,xu(d)===u&&(x=new x(w,_+"enter",g,n,d),x.target=C,x.relatedTarget=v,T=x),v=T,m&&g)t:{for(x=m,w=g,_=0,C=x;C;C=_d(C))_++;for(C=0,T=w;T;T=_d(T))C++;for(;0<_-C;)x=_d(x),_--;for(;0<C-_;)w=_d(w),C--;for(;_--;){if(x===w||w!==null&&x===w.alternate)break t;x=_d(x),w=_d(w)}x=null}else x=null;m!==null&&eR(h,f,m,x,!1),g!==null&&v!==null&&eR(h,v,g,x,!0)}}e:{if(f=u?Zd(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var R=aY;else if(Hk(f))if(qO)R=dY;else{R=cY;var A=lY}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(R=uY);if(R&&(R=R(t,u))){HO(h,R,n,d);break e}A&&A(t,f,u),t==="focusout"&&(A=f._wrapperState)&&A.controlled&&f.type==="number"&&_C(f,"number",f.value)}switch(A=u?Zd(u):window,t){case"focusin":(Hk(A)||A.contentEditable==="true")&&(Xd=A,DC=u,Fm=null);break;case"focusout":Fm=DC=Xd=null;break;case"mousedown":MC=!0;break;case"contextmenu":case"mouseup":case"dragend":MC=!1,Xk(h,n,d);break;case"selectionchange":if(mY)break;case"keydown":case"keyup":Xk(h,n,d)}var E;if(k1)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else Jd?GO(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(zO&&n.locale!=="ko"&&(Jd||I!=="onCompositionStart"?I==="onCompositionEnd"&&Jd&&(E=BO()):(ql=d,N1="value"in ql?ql.value:ql.textContent,Jd=!0)),A=Tv(u,I),0<A.length&&(I=new Bk(I,t,null,n,d),h.push({event:I,listeners:A}),E?I.data=E:(E=WO(n),E!==null&&(I.data=E)))),(E=nY?rY(t,n):sY(t,n))&&(u=Tv(u,"onBeforeInput"),0<u.length&&(d=new Bk("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=E))}rV(h,e)})}function Cp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Tv(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=yp(t,n),i!=null&&r.unshift(Cp(t,i,s)),i=yp(t,e),i!=null&&r.push(Cp(t,i,s))),t=t.return}return r}function _d(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function eR(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=yp(n,i),c!=null&&o.unshift(Cp(n,c,l))):s||(c=yp(n,i),c!=null&&o.push(Cp(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var xY=/\r\n?/g,vY=/\u0000|\uFFFD/g;function tR(t){return(typeof t=="string"?t:""+t).replace(xY,`
`).replace(vY,"")}function Ty(t,e,n){if(e=tR(e),tR(t)!==e&&n)throw Error(Ze(425))}function Iv(){}var LC=null,FC=null;function OC(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var VC=typeof setTimeout=="function"?setTimeout:void 0,wY=typeof clearTimeout=="function"?clearTimeout:void 0,nR=typeof Promise=="function"?Promise:void 0,bY=typeof queueMicrotask=="function"?queueMicrotask:typeof nR<"u"?function(t){return nR.resolve(null).then(t).catch(_Y)}:VC;function _Y(t){setTimeout(function(){throw t})}function k_(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),wp(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);wp(e)}function ec(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function rR(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var yf=Math.random().toString(36).slice(2),ra="__reactFiber$"+yf,Ep="__reactProps$"+yf,el="__reactContainer$"+yf,$C="__reactEvents$"+yf,SY="__reactListeners$"+yf,CY="__reactHandles$"+yf;function xu(t){var e=t[ra];if(e)return e;for(var n=t.parentNode;n;){if(e=n[el]||n[ra]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=rR(t);t!==null;){if(n=t[ra])return n;t=rR(t)}return e}t=n,n=t.parentNode}return null}function gg(t){return t=t[ra]||t[el],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Zd(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Ze(33))}function u0(t){return t[Ep]||null}var UC=[],eh=-1;function kc(t){return{current:t}}function Qn(t){0>eh||(t.current=UC[eh],UC[eh]=null,eh--)}function Gn(t,e){eh++,UC[eh]=t.current,t.current=e}var vc={},Ms=kc(vc),fi=kc(!1),Ou=vc;function Fh(t,e){var n=t.type.contextTypes;if(!n)return vc;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function mi(t){return t=t.childContextTypes,t!=null}function Nv(){Qn(fi),Qn(Ms)}function sR(t,e,n){if(Ms.current!==vc)throw Error(Ze(168));Gn(Ms,e),Gn(fi,n)}function iV(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Ze(108,lK(t)||"Unknown",s));return yr({},n,r)}function Pv(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||vc,Ou=Ms.current,Gn(Ms,t),Gn(fi,fi.current),!0}function iR(t,e,n){var r=t.stateNode;if(!r)throw Error(Ze(169));n?(t=iV(t,e,Ou),r.__reactInternalMemoizedMergedChildContext=t,Qn(fi),Qn(Ms),Gn(Ms,t)):Qn(fi),Gn(fi,n)}var Ma=null,d0=!1,R_=!1;function oV(t){Ma===null?Ma=[t]:Ma.push(t)}function EY(t){d0=!0,oV(t)}function Rc(){if(!R_&&Ma!==null){R_=!0;var t=0,e=kn;try{var n=Ma;for(kn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Ma=null,d0=!1}catch(s){throw Ma!==null&&(Ma=Ma.slice(t+1)),kO(C1,Rc),s}finally{kn=e,R_=!1}}return null}var th=[],nh=0,Av=null,kv=0,eo=[],to=0,Vu=null,Va=1,$a="";function nu(t,e){th[nh++]=kv,th[nh++]=Av,Av=t,kv=e}function aV(t,e,n){eo[to++]=Va,eo[to++]=$a,eo[to++]=Vu,Vu=t;var r=Va;t=$a;var s=32-Do(r)-1;r&=~(1<<s),n+=1;var i=32-Do(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Va=1<<32-Do(e)+s|n<<s|r,$a=i+t}else Va=1<<i|n<<s|r,$a=t}function j1(t){t.return!==null&&(nu(t,1),aV(t,1,0))}function D1(t){for(;t===Av;)Av=th[--nh],th[nh]=null,kv=th[--nh],th[nh]=null;for(;t===Vu;)Vu=eo[--to],eo[to]=null,$a=eo[--to],eo[to]=null,Va=eo[--to],eo[to]=null}var Bi=null,Fi=null,ir=!1,No=null;function lV(t,e){var n=so(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function oR(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Bi=t,Fi=ec(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Bi=t,Fi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Vu!==null?{id:Va,overflow:$a}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=so(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Bi=t,Fi=null,!0):!1;default:return!1}}function BC(t){return(t.mode&1)!==0&&(t.flags&128)===0}function zC(t){if(ir){var e=Fi;if(e){var n=e;if(!oR(t,e)){if(BC(t))throw Error(Ze(418));e=ec(n.nextSibling);var r=Bi;e&&oR(t,e)?lV(r,n):(t.flags=t.flags&-4097|2,ir=!1,Bi=t)}}else{if(BC(t))throw Error(Ze(418));t.flags=t.flags&-4097|2,ir=!1,Bi=t}}}function aR(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Bi=t}function Iy(t){if(t!==Bi)return!1;if(!ir)return aR(t),ir=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!OC(t.type,t.memoizedProps)),e&&(e=Fi)){if(BC(t))throw cV(),Error(Ze(418));for(;e;)lV(t,e),e=ec(e.nextSibling)}if(aR(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Ze(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Fi=ec(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Fi=null}}else Fi=Bi?ec(t.stateNode.nextSibling):null;return!0}function cV(){for(var t=Fi;t;)t=ec(t.nextSibling)}function Oh(){Fi=Bi=null,ir=!1}function M1(t){No===null?No=[t]:No.push(t)}var TY=fl.ReactCurrentBatchConfig;function zf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Ze(309));var r=n.stateNode}if(!r)throw Error(Ze(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Ze(284));if(!n._owner)throw Error(Ze(290,t))}return t}function Ny(t,e){throw t=Object.prototype.toString.call(e),Error(Ze(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function lR(t){var e=t._init;return e(t._payload)}function uV(t){function e(w,_){if(t){var C=w.deletions;C===null?(w.deletions=[_],w.flags|=16):C.push(_)}}function n(w,_){if(!t)return null;for(;_!==null;)e(w,_),_=_.sibling;return null}function r(w,_){for(w=new Map;_!==null;)_.key!==null?w.set(_.key,_):w.set(_.index,_),_=_.sibling;return w}function s(w,_){return w=sc(w,_),w.index=0,w.sibling=null,w}function i(w,_,C){return w.index=C,t?(C=w.alternate,C!==null?(C=C.index,C<_?(w.flags|=2,_):C):(w.flags|=2,_)):(w.flags|=1048576,_)}function o(w){return t&&w.alternate===null&&(w.flags|=2),w}function l(w,_,C,T){return _===null||_.tag!==6?(_=V_(C,w.mode,T),_.return=w,_):(_=s(_,C),_.return=w,_)}function c(w,_,C,T){var R=C.type;return R===Yd?d(w,_,C.props.children,T,C.key):_!==null&&(_.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Fl&&lR(R)===_.type)?(T=s(_,C.props),T.ref=zf(w,_,C),T.return=w,T):(T=Fx(C.type,C.key,C.props,null,w.mode,T),T.ref=zf(w,_,C),T.return=w,T)}function u(w,_,C,T){return _===null||_.tag!==4||_.stateNode.containerInfo!==C.containerInfo||_.stateNode.implementation!==C.implementation?(_=$_(C,w.mode,T),_.return=w,_):(_=s(_,C.children||[]),_.return=w,_)}function d(w,_,C,T,R){return _===null||_.tag!==7?(_=Au(C,w.mode,T,R),_.return=w,_):(_=s(_,C),_.return=w,_)}function h(w,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return _=V_(""+_,w.mode,C),_.return=w,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case yy:return C=Fx(_.type,_.key,_.props,null,w.mode,C),C.ref=zf(w,null,_),C.return=w,C;case Kd:return _=$_(_,w.mode,C),_.return=w,_;case Fl:var T=_._init;return h(w,T(_._payload),C)}if(fm(_)||Of(_))return _=Au(_,w.mode,C,null),_.return=w,_;Ny(w,_)}return null}function f(w,_,C,T){var R=_!==null?_.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return R!==null?null:l(w,_,""+C,T);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case yy:return C.key===R?c(w,_,C,T):null;case Kd:return C.key===R?u(w,_,C,T):null;case Fl:return R=C._init,f(w,_,R(C._payload),T)}if(fm(C)||Of(C))return R!==null?null:d(w,_,C,T,null);Ny(w,C)}return null}function m(w,_,C,T,R){if(typeof T=="string"&&T!==""||typeof T=="number")return w=w.get(C)||null,l(_,w,""+T,R);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case yy:return w=w.get(T.key===null?C:T.key)||null,c(_,w,T,R);case Kd:return w=w.get(T.key===null?C:T.key)||null,u(_,w,T,R);case Fl:var A=T._init;return m(w,_,C,A(T._payload),R)}if(fm(T)||Of(T))return w=w.get(C)||null,d(_,w,T,R,null);Ny(_,T)}return null}function g(w,_,C,T){for(var R=null,A=null,E=_,I=_=0,N=null;E!==null&&I<C.length;I++){E.index>I?(N=E,E=null):N=E.sibling;var k=f(w,E,C[I],T);if(k===null){E===null&&(E=N);break}t&&E&&k.alternate===null&&e(w,E),_=i(k,_,I),A===null?R=k:A.sibling=k,A=k,E=N}if(I===C.length)return n(w,E),ir&&nu(w,I),R;if(E===null){for(;I<C.length;I++)E=h(w,C[I],T),E!==null&&(_=i(E,_,I),A===null?R=E:A.sibling=E,A=E);return ir&&nu(w,I),R}for(E=r(w,E);I<C.length;I++)N=m(E,w,I,C[I],T),N!==null&&(t&&N.alternate!==null&&E.delete(N.key===null?I:N.key),_=i(N,_,I),A===null?R=N:A.sibling=N,A=N);return t&&E.forEach(function(j){return e(w,j)}),ir&&nu(w,I),R}function x(w,_,C,T){var R=Of(C);if(typeof R!="function")throw Error(Ze(150));if(C=R.call(C),C==null)throw Error(Ze(151));for(var A=R=null,E=_,I=_=0,N=null,k=C.next();E!==null&&!k.done;I++,k=C.next()){E.index>I?(N=E,E=null):N=E.sibling;var j=f(w,E,k.value,T);if(j===null){E===null&&(E=N);break}t&&E&&j.alternate===null&&e(w,E),_=i(j,_,I),A===null?R=j:A.sibling=j,A=j,E=N}if(k.done)return n(w,E),ir&&nu(w,I),R;if(E===null){for(;!k.done;I++,k=C.next())k=h(w,k.value,T),k!==null&&(_=i(k,_,I),A===null?R=k:A.sibling=k,A=k);return ir&&nu(w,I),R}for(E=r(w,E);!k.done;I++,k=C.next())k=m(E,w,I,k.value,T),k!==null&&(t&&k.alternate!==null&&E.delete(k.key===null?I:k.key),_=i(k,_,I),A===null?R=k:A.sibling=k,A=k);return t&&E.forEach(function(D){return e(w,D)}),ir&&nu(w,I),R}function v(w,_,C,T){if(typeof C=="object"&&C!==null&&C.type===Yd&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case yy:e:{for(var R=C.key,A=_;A!==null;){if(A.key===R){if(R=C.type,R===Yd){if(A.tag===7){n(w,A.sibling),_=s(A,C.props.children),_.return=w,w=_;break e}}else if(A.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===Fl&&lR(R)===A.type){n(w,A.sibling),_=s(A,C.props),_.ref=zf(w,A,C),_.return=w,w=_;break e}n(w,A);break}else e(w,A);A=A.sibling}C.type===Yd?(_=Au(C.props.children,w.mode,T,C.key),_.return=w,w=_):(T=Fx(C.type,C.key,C.props,null,w.mode,T),T.ref=zf(w,_,C),T.return=w,w=T)}return o(w);case Kd:e:{for(A=C.key;_!==null;){if(_.key===A)if(_.tag===4&&_.stateNode.containerInfo===C.containerInfo&&_.stateNode.implementation===C.implementation){n(w,_.sibling),_=s(_,C.children||[]),_.return=w,w=_;break e}else{n(w,_);break}else e(w,_);_=_.sibling}_=$_(C,w.mode,T),_.return=w,w=_}return o(w);case Fl:return A=C._init,v(w,_,A(C._payload),T)}if(fm(C))return g(w,_,C,T);if(Of(C))return x(w,_,C,T);Ny(w,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,_!==null&&_.tag===6?(n(w,_.sibling),_=s(_,C),_.return=w,w=_):(n(w,_),_=V_(C,w.mode,T),_.return=w,w=_),o(w)):n(w,_)}return v}var Vh=uV(!0),dV=uV(!1),Rv=kc(null),jv=null,rh=null,L1=null;function F1(){L1=rh=jv=null}function O1(t){var e=Rv.current;Qn(Rv),t._currentValue=e}function GC(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function bh(t,e){jv=t,L1=rh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ci=!0),t.firstContext=null)}function ho(t){var e=t._currentValue;if(L1!==t)if(t={context:t,memoizedValue:e,next:null},rh===null){if(jv===null)throw Error(Ze(308));rh=t,jv.dependencies={lanes:0,firstContext:t}}else rh=rh.next=t;return e}var vu=null;function V1(t){vu===null?vu=[t]:vu.push(t)}function hV(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,V1(e)):(n.next=s.next,s.next=n),e.interleaved=n,tl(t,r)}function tl(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ol=!1;function $1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function fV(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Wa(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function tc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,gn&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,tl(t,n)}return s=r.interleaved,s===null?(e.next=e,V1(r)):(e.next=s.next,s.next=e),r.interleaved=e,tl(t,n)}function kx(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,E1(t,n)}}function cR(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function Dv(t,e,n,r){var s=t.updateQueue;Ol=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,x=l;switch(f=e,m=n,x.tag){case 1:if(g=x.payload,typeof g=="function"){h=g.call(m,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,f=typeof g=="function"?g.call(m,h,f):g,f==null)break e;h=yr({},h,f);break e;case 2:Ol=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Uu|=o,t.lanes=o,t.memoizedState=h}}function uR(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Ze(191,s));s.call(r)}}}var yg={},ha=kc(yg),Tp=kc(yg),Ip=kc(yg);function wu(t){if(t===yg)throw Error(Ze(174));return t}function U1(t,e){switch(Gn(Ip,e),Gn(Tp,t),Gn(ha,yg),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:CC(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=CC(e,t)}Qn(ha),Gn(ha,e)}function $h(){Qn(ha),Qn(Tp),Qn(Ip)}function mV(t){wu(Ip.current);var e=wu(ha.current),n=CC(e,t.type);e!==n&&(Gn(Tp,t),Gn(ha,n))}function B1(t){Tp.current===t&&(Qn(ha),Qn(Tp))}var hr=kc(0);function Mv(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var j_=[];function z1(){for(var t=0;t<j_.length;t++)j_[t]._workInProgressVersionPrimary=null;j_.length=0}var Rx=fl.ReactCurrentDispatcher,D_=fl.ReactCurrentBatchConfig,$u=0,pr=null,qr=null,ss=null,Lv=!1,Om=!1,Np=0,IY=0;function Cs(){throw Error(Ze(321))}function G1(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Oo(t[n],e[n]))return!1;return!0}function W1(t,e,n,r,s,i){if($u=i,pr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Rx.current=t===null||t.memoizedState===null?kY:RY,t=n(r,s),Om){i=0;do{if(Om=!1,Np=0,25<=i)throw Error(Ze(301));i+=1,ss=qr=null,e.updateQueue=null,Rx.current=jY,t=n(r,s)}while(Om)}if(Rx.current=Fv,e=qr!==null&&qr.next!==null,$u=0,ss=qr=pr=null,Lv=!1,e)throw Error(Ze(300));return t}function H1(){var t=Np!==0;return Np=0,t}function Qo(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ss===null?pr.memoizedState=ss=t:ss=ss.next=t,ss}function fo(){if(qr===null){var t=pr.alternate;t=t!==null?t.memoizedState:null}else t=qr.next;var e=ss===null?pr.memoizedState:ss.next;if(e!==null)ss=e,qr=t;else{if(t===null)throw Error(Ze(310));qr=t,t={memoizedState:qr.memoizedState,baseState:qr.baseState,baseQueue:qr.baseQueue,queue:qr.queue,next:null},ss===null?pr.memoizedState=ss=t:ss=ss.next=t}return ss}function Pp(t,e){return typeof e=="function"?e(t):e}function M_(t){var e=fo(),n=e.queue;if(n===null)throw Error(Ze(311));n.lastRenderedReducer=t;var r=qr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if(($u&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,pr.lanes|=d,Uu|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,Oo(r,e.memoizedState)||(ci=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,pr.lanes|=i,Uu|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function L_(t){var e=fo(),n=e.queue;if(n===null)throw Error(Ze(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Oo(i,e.memoizedState)||(ci=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function pV(){}function gV(t,e){var n=pr,r=fo(),s=e(),i=!Oo(r.memoizedState,s);if(i&&(r.memoizedState=s,ci=!0),r=r.queue,q1(vV.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||ss!==null&&ss.memoizedState.tag&1){if(n.flags|=2048,Ap(9,xV.bind(null,n,r,s,e),void 0,null),os===null)throw Error(Ze(349));$u&30||yV(n,e,s)}return s}function yV(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=pr.updateQueue,e===null?(e={lastEffect:null,stores:null},pr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function xV(t,e,n,r){e.value=n,e.getSnapshot=r,wV(e)&&bV(t)}function vV(t,e,n){return n(function(){wV(e)&&bV(t)})}function wV(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Oo(t,n)}catch{return!0}}function bV(t){var e=tl(t,1);e!==null&&Mo(e,t,1,-1)}function dR(t){var e=Qo();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Pp,lastRenderedState:t},e.queue=t,t=t.dispatch=AY.bind(null,pr,t),[e.memoizedState,t]}function Ap(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=pr.updateQueue,e===null?(e={lastEffect:null,stores:null},pr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function _V(){return fo().memoizedState}function jx(t,e,n,r){var s=Qo();pr.flags|=t,s.memoizedState=Ap(1|e,n,void 0,r===void 0?null:r)}function h0(t,e,n,r){var s=fo();r=r===void 0?null:r;var i=void 0;if(qr!==null){var o=qr.memoizedState;if(i=o.destroy,r!==null&&G1(r,o.deps)){s.memoizedState=Ap(e,n,i,r);return}}pr.flags|=t,s.memoizedState=Ap(1|e,n,i,r)}function hR(t,e){return jx(8390656,8,t,e)}function q1(t,e){return h0(2048,8,t,e)}function SV(t,e){return h0(4,2,t,e)}function CV(t,e){return h0(4,4,t,e)}function EV(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function TV(t,e,n){return n=n!=null?n.concat([t]):null,h0(4,4,EV.bind(null,e,t),n)}function K1(){}function IV(t,e){var n=fo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&G1(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function NV(t,e){var n=fo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&G1(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function PV(t,e,n){return $u&21?(Oo(n,e)||(n=DO(),pr.lanes|=n,Uu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ci=!0),t.memoizedState=n)}function NY(t,e){var n=kn;kn=n!==0&&4>n?n:4,t(!0);var r=D_.transition;D_.transition={};try{t(!1),e()}finally{kn=n,D_.transition=r}}function AV(){return fo().memoizedState}function PY(t,e,n){var r=rc(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},kV(t))RV(e,n);else if(n=hV(t,e,n,r),n!==null){var s=Js();Mo(n,t,r,s),jV(n,e,r)}}function AY(t,e,n){var r=rc(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(kV(t))RV(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,Oo(l,o)){var c=e.interleaved;c===null?(s.next=s,V1(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=hV(t,e,s,r),n!==null&&(s=Js(),Mo(n,t,r,s),jV(n,e,r))}}function kV(t){var e=t.alternate;return t===pr||e!==null&&e===pr}function RV(t,e){Om=Lv=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function jV(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,E1(t,n)}}var Fv={readContext:ho,useCallback:Cs,useContext:Cs,useEffect:Cs,useImperativeHandle:Cs,useInsertionEffect:Cs,useLayoutEffect:Cs,useMemo:Cs,useReducer:Cs,useRef:Cs,useState:Cs,useDebugValue:Cs,useDeferredValue:Cs,useTransition:Cs,useMutableSource:Cs,useSyncExternalStore:Cs,useId:Cs,unstable_isNewReconciler:!1},kY={readContext:ho,useCallback:function(t,e){return Qo().memoizedState=[t,e===void 0?null:e],t},useContext:ho,useEffect:hR,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,jx(4194308,4,EV.bind(null,e,t),n)},useLayoutEffect:function(t,e){return jx(4194308,4,t,e)},useInsertionEffect:function(t,e){return jx(4,2,t,e)},useMemo:function(t,e){var n=Qo();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Qo();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=PY.bind(null,pr,t),[r.memoizedState,t]},useRef:function(t){var e=Qo();return t={current:t},e.memoizedState=t},useState:dR,useDebugValue:K1,useDeferredValue:function(t){return Qo().memoizedState=t},useTransition:function(){var t=dR(!1),e=t[0];return t=NY.bind(null,t[1]),Qo().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=pr,s=Qo();if(ir){if(n===void 0)throw Error(Ze(407));n=n()}else{if(n=e(),os===null)throw Error(Ze(349));$u&30||yV(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,hR(vV.bind(null,r,i,t),[t]),r.flags|=2048,Ap(9,xV.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Qo(),e=os.identifierPrefix;if(ir){var n=$a,r=Va;n=(r&~(1<<32-Do(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Np++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=IY++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},RY={readContext:ho,useCallback:IV,useContext:ho,useEffect:q1,useImperativeHandle:TV,useInsertionEffect:SV,useLayoutEffect:CV,useMemo:NV,useReducer:M_,useRef:_V,useState:function(){return M_(Pp)},useDebugValue:K1,useDeferredValue:function(t){var e=fo();return PV(e,qr.memoizedState,t)},useTransition:function(){var t=M_(Pp)[0],e=fo().memoizedState;return[t,e]},useMutableSource:pV,useSyncExternalStore:gV,useId:AV,unstable_isNewReconciler:!1},jY={readContext:ho,useCallback:IV,useContext:ho,useEffect:q1,useImperativeHandle:TV,useInsertionEffect:SV,useLayoutEffect:CV,useMemo:NV,useReducer:L_,useRef:_V,useState:function(){return L_(Pp)},useDebugValue:K1,useDeferredValue:function(t){var e=fo();return qr===null?e.memoizedState=t:PV(e,qr.memoizedState,t)},useTransition:function(){var t=L_(Pp)[0],e=fo().memoizedState;return[t,e]},useMutableSource:pV,useSyncExternalStore:gV,useId:AV,unstable_isNewReconciler:!1};function So(t,e){if(t&&t.defaultProps){e=yr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function WC(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:yr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var f0={isMounted:function(t){return(t=t._reactInternals)?ad(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Js(),s=rc(t),i=Wa(r,s);i.payload=e,n!=null&&(i.callback=n),e=tc(t,i,s),e!==null&&(Mo(e,t,s,r),kx(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Js(),s=rc(t),i=Wa(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=tc(t,i,s),e!==null&&(Mo(e,t,s,r),kx(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Js(),r=rc(t),s=Wa(n,r);s.tag=2,e!=null&&(s.callback=e),e=tc(t,s,r),e!==null&&(Mo(e,t,r,n),kx(e,t,r))}};function fR(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!_p(n,r)||!_p(s,i):!0}function DV(t,e,n){var r=!1,s=vc,i=e.contextType;return typeof i=="object"&&i!==null?i=ho(i):(s=mi(e)?Ou:Ms.current,r=e.contextTypes,i=(r=r!=null)?Fh(t,s):vc),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=f0,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function mR(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&f0.enqueueReplaceState(e,e.state,null)}function HC(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},$1(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ho(i):(i=mi(e)?Ou:Ms.current,s.context=Fh(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(WC(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&f0.enqueueReplaceState(s,s.state,null),Dv(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Uh(t,e){try{var n="",r=e;do n+=aK(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function F_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function qC(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var DY=typeof WeakMap=="function"?WeakMap:Map;function MV(t,e,n){n=Wa(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Vv||(Vv=!0,rE=r),qC(t,e)},n}function LV(t,e,n){n=Wa(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){qC(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){qC(t,e),typeof r!="function"&&(nc===null?nc=new Set([this]):nc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function pR(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new DY;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=KY.bind(null,t,e,n),e.then(t,t))}function gR(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function yR(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Wa(-1,1),e.tag=2,tc(n,e,1))),n.lanes|=1),t)}var MY=fl.ReactCurrentOwner,ci=!1;function Hs(t,e,n,r){e.child=t===null?dV(e,null,n,r):Vh(e,t.child,n,r)}function xR(t,e,n,r,s){n=n.render;var i=e.ref;return bh(e,s),r=W1(t,e,n,r,i,s),n=H1(),t!==null&&!ci?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nl(t,e,s)):(ir&&n&&j1(e),e.flags|=1,Hs(t,e,r,s),e.child)}function vR(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!nI(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,FV(t,e,i,r,s)):(t=Fx(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:_p,n(o,r)&&t.ref===e.ref)return nl(t,e,s)}return e.flags|=1,t=sc(i,r),t.ref=e.ref,t.return=e,e.child=t}function FV(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(_p(i,r)&&t.ref===e.ref)if(ci=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(ci=!0);else return e.lanes=t.lanes,nl(t,e,s)}return KC(t,e,n,r,s)}function OV(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Gn(ih,ki),ki|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Gn(ih,ki),ki|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Gn(ih,ki),ki|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Gn(ih,ki),ki|=r;return Hs(t,e,s,n),e.child}function VV(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function KC(t,e,n,r,s){var i=mi(n)?Ou:Ms.current;return i=Fh(e,i),bh(e,s),n=W1(t,e,n,r,i,s),r=H1(),t!==null&&!ci?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,nl(t,e,s)):(ir&&r&&j1(e),e.flags|=1,Hs(t,e,n,s),e.child)}function wR(t,e,n,r,s){if(mi(n)){var i=!0;Pv(e)}else i=!1;if(bh(e,s),e.stateNode===null)Dx(t,e),DV(e,n,r),HC(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=ho(u):(u=mi(n)?Ou:Ms.current,u=Fh(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&mR(e,o,r,u),Ol=!1;var f=e.memoizedState;o.state=f,Dv(e,r,o,s),c=e.memoizedState,l!==r||f!==c||fi.current||Ol?(typeof d=="function"&&(WC(e,n,d,r),c=e.memoizedState),(l=Ol||fR(e,n,l,r,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,fV(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:So(e.type,l),o.props=u,h=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=ho(c):(c=mi(n)?Ou:Ms.current,c=Fh(e,c));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&mR(e,o,r,c),Ol=!1,f=e.memoizedState,o.state=f,Dv(e,r,o,s);var g=e.memoizedState;l!==h||f!==g||fi.current||Ol?(typeof m=="function"&&(WC(e,n,m,r),g=e.memoizedState),(u=Ol||fR(e,n,u,r,f,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return YC(t,e,n,r,i,s)}function YC(t,e,n,r,s,i){VV(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&iR(e,n,!1),nl(t,e,i);r=e.stateNode,MY.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Vh(e,t.child,null,i),e.child=Vh(e,null,l,i)):Hs(t,e,l,i),e.memoizedState=r.state,s&&iR(e,n,!0),e.child}function $V(t){var e=t.stateNode;e.pendingContext?sR(t,e.pendingContext,e.pendingContext!==e.context):e.context&&sR(t,e.context,!1),U1(t,e.containerInfo)}function bR(t,e,n,r,s){return Oh(),M1(s),e.flags|=256,Hs(t,e,n,r),e.child}var JC={dehydrated:null,treeContext:null,retryLane:0};function XC(t){return{baseLanes:t,cachePool:null,transitions:null}}function UV(t,e,n){var r=e.pendingProps,s=hr.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Gn(hr,s&1),t===null)return zC(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=g0(o,r,0,null),t=Au(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=XC(n),e.memoizedState=JC,t):Y1(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return LY(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=sc(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=sc(l,i):(i=Au(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?XC(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=JC,r}return i=t.child,t=i.sibling,r=sc(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function Y1(t,e){return e=g0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Py(t,e,n,r){return r!==null&&M1(r),Vh(e,t.child,null,n),t=Y1(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function LY(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=F_(Error(Ze(422))),Py(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=g0({mode:"visible",children:r.children},s,0,null),i=Au(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Vh(e,t.child,null,o),e.child.memoizedState=XC(o),e.memoizedState=JC,i);if(!(e.mode&1))return Py(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(Ze(419)),r=F_(i,r,void 0),Py(t,e,o,r)}if(l=(o&t.childLanes)!==0,ci||l){if(r=os,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,tl(t,s),Mo(r,t,s,-1))}return tI(),r=F_(Error(Ze(421))),Py(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=YY.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Fi=ec(s.nextSibling),Bi=e,ir=!0,No=null,t!==null&&(eo[to++]=Va,eo[to++]=$a,eo[to++]=Vu,Va=t.id,$a=t.overflow,Vu=e),e=Y1(e,r.children),e.flags|=4096,e)}function _R(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),GC(t.return,e,n)}function O_(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function BV(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Hs(t,e,r.children,n),r=hr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&_R(t,n,e);else if(t.tag===19)_R(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Gn(hr,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Mv(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),O_(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Mv(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}O_(e,!0,n,null,i);break;case"together":O_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Dx(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function nl(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Uu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Ze(153));if(e.child!==null){for(t=e.child,n=sc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=sc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function FY(t,e,n){switch(e.tag){case 3:$V(e),Oh();break;case 5:mV(e);break;case 1:mi(e.type)&&Pv(e);break;case 4:U1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Gn(Rv,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Gn(hr,hr.current&1),e.flags|=128,null):n&e.child.childLanes?UV(t,e,n):(Gn(hr,hr.current&1),t=nl(t,e,n),t!==null?t.sibling:null);Gn(hr,hr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return BV(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Gn(hr,hr.current),r)break;return null;case 22:case 23:return e.lanes=0,OV(t,e,n)}return nl(t,e,n)}var zV,QC,GV,WV;zV=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};QC=function(){};GV=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,wu(ha.current);var i=null;switch(n){case"input":s=wC(t,s),r=wC(t,r),i=[];break;case"select":s=yr({},s,{value:void 0}),r=yr({},r,{value:void 0}),i=[];break;case"textarea":s=SC(t,s),r=SC(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Iv)}EC(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(pp.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(pp.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&Yn("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};WV=function(t,e,n,r){n!==r&&(e.flags|=4)};function Gf(t,e){if(!ir)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Es(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function OY(t,e,n){var r=e.pendingProps;switch(D1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Es(e),null;case 1:return mi(e.type)&&Nv(),Es(e),null;case 3:return r=e.stateNode,$h(),Qn(fi),Qn(Ms),z1(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Iy(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,No!==null&&(oE(No),No=null))),QC(t,e),Es(e),null;case 5:B1(e);var s=wu(Ip.current);if(n=e.type,t!==null&&e.stateNode!=null)GV(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Ze(166));return Es(e),null}if(t=wu(ha.current),Iy(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[ra]=e,r[Ep]=i,t=(e.mode&1)!==0,n){case"dialog":Yn("cancel",r),Yn("close",r);break;case"iframe":case"object":case"embed":Yn("load",r);break;case"video":case"audio":for(s=0;s<pm.length;s++)Yn(pm[s],r);break;case"source":Yn("error",r);break;case"img":case"image":case"link":Yn("error",r),Yn("load",r);break;case"details":Yn("toggle",r);break;case"input":kk(r,i),Yn("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Yn("invalid",r);break;case"textarea":jk(r,i),Yn("invalid",r)}EC(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&Ty(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&Ty(r.textContent,l,t),s=["children",""+l]):pp.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Yn("scroll",r)}switch(n){case"input":xy(r),Rk(r,i,!0);break;case"textarea":xy(r),Dk(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Iv)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=vO(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ra]=e,t[Ep]=r,zV(t,e,!1,!1),e.stateNode=t;e:{switch(o=TC(n,r),n){case"dialog":Yn("cancel",t),Yn("close",t),s=r;break;case"iframe":case"object":case"embed":Yn("load",t),s=r;break;case"video":case"audio":for(s=0;s<pm.length;s++)Yn(pm[s],t);s=r;break;case"source":Yn("error",t),s=r;break;case"img":case"image":case"link":Yn("error",t),Yn("load",t),s=r;break;case"details":Yn("toggle",t),s=r;break;case"input":kk(t,r),s=wC(t,r),Yn("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=yr({},r,{value:void 0}),Yn("invalid",t);break;case"textarea":jk(t,r),s=SC(t,r),Yn("invalid",t);break;default:s=r}EC(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?_O(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&wO(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&gp(t,c):typeof c=="number"&&gp(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(pp.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Yn("scroll",t):c!=null&&v1(t,i,c,o))}switch(n){case"input":xy(t),Rk(t,r,!1);break;case"textarea":xy(t),Dk(t);break;case"option":r.value!=null&&t.setAttribute("value",""+xc(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?yh(t,!!r.multiple,i,!1):r.defaultValue!=null&&yh(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Iv)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Es(e),null;case 6:if(t&&e.stateNode!=null)WV(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Ze(166));if(n=wu(Ip.current),wu(ha.current),Iy(e)){if(r=e.stateNode,n=e.memoizedProps,r[ra]=e,(i=r.nodeValue!==n)&&(t=Bi,t!==null))switch(t.tag){case 3:Ty(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Ty(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ra]=e,e.stateNode=r}return Es(e),null;case 13:if(Qn(hr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(ir&&Fi!==null&&e.mode&1&&!(e.flags&128))cV(),Oh(),e.flags|=98560,i=!1;else if(i=Iy(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Ze(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Ze(317));i[ra]=e}else Oh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Es(e),i=!1}else No!==null&&(oE(No),No=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||hr.current&1?Kr===0&&(Kr=3):tI())),e.updateQueue!==null&&(e.flags|=4),Es(e),null);case 4:return $h(),QC(t,e),t===null&&Sp(e.stateNode.containerInfo),Es(e),null;case 10:return O1(e.type._context),Es(e),null;case 17:return mi(e.type)&&Nv(),Es(e),null;case 19:if(Qn(hr),i=e.memoizedState,i===null)return Es(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)Gf(i,!1);else{if(Kr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Mv(t),o!==null){for(e.flags|=128,Gf(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Gn(hr,hr.current&1|2),e.child}t=t.sibling}i.tail!==null&&Dr()>Bh&&(e.flags|=128,r=!0,Gf(i,!1),e.lanes=4194304)}else{if(!r)if(t=Mv(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Gf(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!ir)return Es(e),null}else 2*Dr()-i.renderingStartTime>Bh&&n!==1073741824&&(e.flags|=128,r=!0,Gf(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Dr(),e.sibling=null,n=hr.current,Gn(hr,r?n&1|2:n&1),e):(Es(e),null);case 22:case 23:return eI(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ki&1073741824&&(Es(e),e.subtreeFlags&6&&(e.flags|=8192)):Es(e),null;case 24:return null;case 25:return null}throw Error(Ze(156,e.tag))}function VY(t,e){switch(D1(e),e.tag){case 1:return mi(e.type)&&Nv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return $h(),Qn(fi),Qn(Ms),z1(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return B1(e),null;case 13:if(Qn(hr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Ze(340));Oh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Qn(hr),null;case 4:return $h(),null;case 10:return O1(e.type._context),null;case 22:case 23:return eI(),null;case 24:return null;default:return null}}var Ay=!1,As=!1,$Y=typeof WeakSet=="function"?WeakSet:Set,vt=null;function sh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Cr(t,e,r)}else n.current=null}function ZC(t,e,n){try{n()}catch(r){Cr(t,e,r)}}var SR=!1;function UY(t,e){if(LC=Cv,t=JO(),R1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++u===s&&(l=o),f===i&&++d===r&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(FC={focusedElem:t,selectionRange:n},Cv=!1,vt=e;vt!==null;)if(e=vt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,vt=t;else for(;vt!==null;){e=vt;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,v=g.memoizedState,w=e.stateNode,_=w.getSnapshotBeforeUpdate(e.elementType===e.type?x:So(e.type,x),v);w.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Ze(163))}}catch(T){Cr(e,e.return,T)}if(t=e.sibling,t!==null){t.return=e.return,vt=t;break}vt=e.return}return g=SR,SR=!1,g}function Vm(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&ZC(e,n,i)}s=s.next}while(s!==r)}}function m0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function eE(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function HV(t){var e=t.alternate;e!==null&&(t.alternate=null,HV(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ra],delete e[Ep],delete e[$C],delete e[SY],delete e[CY])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function qV(t){return t.tag===5||t.tag===3||t.tag===4}function CR(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||qV(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function tE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Iv));else if(r!==4&&(t=t.child,t!==null))for(tE(t,e,n),t=t.sibling;t!==null;)tE(t,e,n),t=t.sibling}function nE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(nE(t,e,n),t=t.sibling;t!==null;)nE(t,e,n),t=t.sibling}var us=null,Eo=!1;function _l(t,e,n){for(n=n.child;n!==null;)KV(t,e,n),n=n.sibling}function KV(t,e,n){if(da&&typeof da.onCommitFiberUnmount=="function")try{da.onCommitFiberUnmount(o0,n)}catch{}switch(n.tag){case 5:As||sh(n,e);case 6:var r=us,s=Eo;us=null,_l(t,e,n),us=r,Eo=s,us!==null&&(Eo?(t=us,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):us.removeChild(n.stateNode));break;case 18:us!==null&&(Eo?(t=us,n=n.stateNode,t.nodeType===8?k_(t.parentNode,n):t.nodeType===1&&k_(t,n),wp(t)):k_(us,n.stateNode));break;case 4:r=us,s=Eo,us=n.stateNode.containerInfo,Eo=!0,_l(t,e,n),us=r,Eo=s;break;case 0:case 11:case 14:case 15:if(!As&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&ZC(n,e,o),s=s.next}while(s!==r)}_l(t,e,n);break;case 1:if(!As&&(sh(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){Cr(n,e,l)}_l(t,e,n);break;case 21:_l(t,e,n);break;case 22:n.mode&1?(As=(r=As)||n.memoizedState!==null,_l(t,e,n),As=r):_l(t,e,n);break;default:_l(t,e,n)}}function ER(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new $Y),e.forEach(function(r){var s=JY.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function wo(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:us=l.stateNode,Eo=!1;break e;case 3:us=l.stateNode.containerInfo,Eo=!0;break e;case 4:us=l.stateNode.containerInfo,Eo=!0;break e}l=l.return}if(us===null)throw Error(Ze(160));KV(i,o,s),us=null,Eo=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){Cr(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)YV(e,t),e=e.sibling}function YV(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(wo(e,t),Ko(t),r&4){try{Vm(3,t,t.return),m0(3,t)}catch(x){Cr(t,t.return,x)}try{Vm(5,t,t.return)}catch(x){Cr(t,t.return,x)}}break;case 1:wo(e,t),Ko(t),r&512&&n!==null&&sh(n,n.return);break;case 5:if(wo(e,t),Ko(t),r&512&&n!==null&&sh(n,n.return),t.flags&32){var s=t.stateNode;try{gp(s,"")}catch(x){Cr(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&yO(s,i),TC(l,o);var u=TC(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?_O(s,h):d==="dangerouslySetInnerHTML"?wO(s,h):d==="children"?gp(s,h):v1(s,d,h,u)}switch(l){case"input":bC(s,i);break;case"textarea":xO(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?yh(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?yh(s,!!i.multiple,i.defaultValue,!0):yh(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ep]=i}catch(x){Cr(t,t.return,x)}}break;case 6:if(wo(e,t),Ko(t),r&4){if(t.stateNode===null)throw Error(Ze(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){Cr(t,t.return,x)}}break;case 3:if(wo(e,t),Ko(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{wp(e.containerInfo)}catch(x){Cr(t,t.return,x)}break;case 4:wo(e,t),Ko(t);break;case 13:wo(e,t),Ko(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Q1=Dr())),r&4&&ER(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(As=(u=As)||d,wo(e,t),As=u):wo(e,t),Ko(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(vt=t,d=t.child;d!==null;){for(h=vt=d;vt!==null;){switch(f=vt,m=f.child,f.tag){case 0:case 11:case 14:case 15:Vm(4,f,f.return);break;case 1:sh(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(x){Cr(r,n,x)}}break;case 5:sh(f,f.return);break;case 22:if(f.memoizedState!==null){IR(h);continue}}m!==null?(m.return=f,vt=m):IR(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=bO("display",o))}catch(x){Cr(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){Cr(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:wo(e,t),Ko(t),r&4&&ER(t);break;case 21:break;default:wo(e,t),Ko(t)}}function Ko(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(qV(n)){var r=n;break e}n=n.return}throw Error(Ze(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(gp(s,""),r.flags&=-33);var i=CR(t);nE(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=CR(t);tE(t,l,o);break;default:throw Error(Ze(161))}}catch(c){Cr(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function BY(t,e,n){vt=t,JV(t)}function JV(t,e,n){for(var r=(t.mode&1)!==0;vt!==null;){var s=vt,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||Ay;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||As;l=Ay;var u=As;if(Ay=o,(As=c)&&!u)for(vt=s;vt!==null;)o=vt,c=o.child,o.tag===22&&o.memoizedState!==null?NR(s):c!==null?(c.return=o,vt=c):NR(s);for(;i!==null;)vt=i,JV(i),i=i.sibling;vt=s,Ay=l,As=u}TR(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,vt=i):TR(t)}}function TR(t){for(;vt!==null;){var e=vt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:As||m0(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!As)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:So(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&uR(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}uR(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&wp(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Ze(163))}As||e.flags&512&&eE(e)}catch(f){Cr(e,e.return,f)}}if(e===t){vt=null;break}if(n=e.sibling,n!==null){n.return=e.return,vt=n;break}vt=e.return}}function IR(t){for(;vt!==null;){var e=vt;if(e===t){vt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,vt=n;break}vt=e.return}}function NR(t){for(;vt!==null;){var e=vt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{m0(4,e)}catch(c){Cr(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){Cr(e,s,c)}}var i=e.return;try{eE(e)}catch(c){Cr(e,i,c)}break;case 5:var o=e.return;try{eE(e)}catch(c){Cr(e,o,c)}}}catch(c){Cr(e,e.return,c)}if(e===t){vt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,vt=l;break}vt=e.return}}var zY=Math.ceil,Ov=fl.ReactCurrentDispatcher,J1=fl.ReactCurrentOwner,ao=fl.ReactCurrentBatchConfig,gn=0,os=null,Or=null,ps=0,ki=0,ih=kc(0),Kr=0,kp=null,Uu=0,p0=0,X1=0,$m=null,li=null,Q1=0,Bh=1/0,ja=null,Vv=!1,rE=null,nc=null,ky=!1,Kl=null,$v=0,Um=0,sE=null,Mx=-1,Lx=0;function Js(){return gn&6?Dr():Mx!==-1?Mx:Mx=Dr()}function rc(t){return t.mode&1?gn&2&&ps!==0?ps&-ps:TY.transition!==null?(Lx===0&&(Lx=DO()),Lx):(t=kn,t!==0||(t=window.event,t=t===void 0?16:UO(t.type)),t):1}function Mo(t,e,n,r){if(50<Um)throw Um=0,sE=null,Error(Ze(185));mg(t,n,r),(!(gn&2)||t!==os)&&(t===os&&(!(gn&2)&&(p0|=n),Kr===4&&Ul(t,ps)),pi(t,r),n===1&&gn===0&&!(e.mode&1)&&(Bh=Dr()+500,d0&&Rc()))}function pi(t,e){var n=t.callbackNode;TK(t,e);var r=Sv(t,t===os?ps:0);if(r===0)n!==null&&Fk(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Fk(n),e===1)t.tag===0?EY(PR.bind(null,t)):oV(PR.bind(null,t)),bY(function(){!(gn&6)&&Rc()}),n=null;else{switch(MO(r)){case 1:n=C1;break;case 4:n=RO;break;case 16:n=_v;break;case 536870912:n=jO;break;default:n=_v}n=s$(n,XV.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function XV(t,e){if(Mx=-1,Lx=0,gn&6)throw Error(Ze(327));var n=t.callbackNode;if(_h()&&t.callbackNode!==n)return null;var r=Sv(t,t===os?ps:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Uv(t,r);else{e=r;var s=gn;gn|=2;var i=ZV();(os!==t||ps!==e)&&(ja=null,Bh=Dr()+500,Pu(t,e));do try{HY();break}catch(l){QV(t,l)}while(1);F1(),Ov.current=i,gn=s,Or!==null?e=0:(os=null,ps=0,e=Kr)}if(e!==0){if(e===2&&(s=kC(t),s!==0&&(r=s,e=iE(t,s))),e===1)throw n=kp,Pu(t,0),Ul(t,r),pi(t,Dr()),n;if(e===6)Ul(t,r);else{if(s=t.current.alternate,!(r&30)&&!GY(s)&&(e=Uv(t,r),e===2&&(i=kC(t),i!==0&&(r=i,e=iE(t,i))),e===1))throw n=kp,Pu(t,0),Ul(t,r),pi(t,Dr()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Ze(345));case 2:ru(t,li,ja);break;case 3:if(Ul(t,r),(r&130023424)===r&&(e=Q1+500-Dr(),10<e)){if(Sv(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Js(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=VC(ru.bind(null,t,li,ja),e);break}ru(t,li,ja);break;case 4:if(Ul(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Do(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Dr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*zY(r/1960))-r,10<r){t.timeoutHandle=VC(ru.bind(null,t,li,ja),r);break}ru(t,li,ja);break;case 5:ru(t,li,ja);break;default:throw Error(Ze(329))}}}return pi(t,Dr()),t.callbackNode===n?XV.bind(null,t):null}function iE(t,e){var n=$m;return t.current.memoizedState.isDehydrated&&(Pu(t,e).flags|=256),t=Uv(t,e),t!==2&&(e=li,li=n,e!==null&&oE(e)),t}function oE(t){li===null?li=t:li.push.apply(li,t)}function GY(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Oo(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Ul(t,e){for(e&=~X1,e&=~p0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Do(e),r=1<<n;t[n]=-1,e&=~r}}function PR(t){if(gn&6)throw Error(Ze(327));_h();var e=Sv(t,0);if(!(e&1))return pi(t,Dr()),null;var n=Uv(t,e);if(t.tag!==0&&n===2){var r=kC(t);r!==0&&(e=r,n=iE(t,r))}if(n===1)throw n=kp,Pu(t,0),Ul(t,e),pi(t,Dr()),n;if(n===6)throw Error(Ze(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,ru(t,li,ja),pi(t,Dr()),null}function Z1(t,e){var n=gn;gn|=1;try{return t(e)}finally{gn=n,gn===0&&(Bh=Dr()+500,d0&&Rc())}}function Bu(t){Kl!==null&&Kl.tag===0&&!(gn&6)&&_h();var e=gn;gn|=1;var n=ao.transition,r=kn;try{if(ao.transition=null,kn=1,t)return t()}finally{kn=r,ao.transition=n,gn=e,!(gn&6)&&Rc()}}function eI(){ki=ih.current,Qn(ih)}function Pu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,wY(n)),Or!==null)for(n=Or.return;n!==null;){var r=n;switch(D1(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Nv();break;case 3:$h(),Qn(fi),Qn(Ms),z1();break;case 5:B1(r);break;case 4:$h();break;case 13:Qn(hr);break;case 19:Qn(hr);break;case 10:O1(r.type._context);break;case 22:case 23:eI()}n=n.return}if(os=t,Or=t=sc(t.current,null),ps=ki=e,Kr=0,kp=null,X1=p0=Uu=0,li=$m=null,vu!==null){for(e=0;e<vu.length;e++)if(n=vu[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}vu=null}return t}function QV(t,e){do{var n=Or;try{if(F1(),Rx.current=Fv,Lv){for(var r=pr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Lv=!1}if($u=0,ss=qr=pr=null,Om=!1,Np=0,J1.current=null,n===null||n.return===null){Kr=1,kp=e,Or=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=ps,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=gR(o);if(m!==null){m.flags&=-257,yR(m,o,l,i,e),m.mode&1&&pR(i,u,e),e=m,c=u;var g=e.updateQueue;if(g===null){var x=new Set;x.add(c),e.updateQueue=x}else g.add(c);break e}else{if(!(e&1)){pR(i,u,e),tI();break e}c=Error(Ze(426))}}else if(ir&&l.mode&1){var v=gR(o);if(v!==null){!(v.flags&65536)&&(v.flags|=256),yR(v,o,l,i,e),M1(Uh(c,l));break e}}i=c=Uh(c,l),Kr!==4&&(Kr=2),$m===null?$m=[i]:$m.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var w=MV(i,c,e);cR(i,w);break e;case 1:l=c;var _=i.type,C=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(nc===null||!nc.has(C)))){i.flags|=65536,e&=-e,i.lanes|=e;var T=LV(i,l,e);cR(i,T);break e}}i=i.return}while(i!==null)}t$(n)}catch(R){e=R,Or===n&&n!==null&&(Or=n=n.return);continue}break}while(1)}function ZV(){var t=Ov.current;return Ov.current=Fv,t===null?Fv:t}function tI(){(Kr===0||Kr===3||Kr===2)&&(Kr=4),os===null||!(Uu&268435455)&&!(p0&268435455)||Ul(os,ps)}function Uv(t,e){var n=gn;gn|=2;var r=ZV();(os!==t||ps!==e)&&(ja=null,Pu(t,e));do try{WY();break}catch(s){QV(t,s)}while(1);if(F1(),gn=n,Ov.current=r,Or!==null)throw Error(Ze(261));return os=null,ps=0,Kr}function WY(){for(;Or!==null;)e$(Or)}function HY(){for(;Or!==null&&!yK();)e$(Or)}function e$(t){var e=r$(t.alternate,t,ki);t.memoizedProps=t.pendingProps,e===null?t$(t):Or=e,J1.current=null}function t$(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=VY(n,e),n!==null){n.flags&=32767,Or=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Kr=6,Or=null;return}}else if(n=OY(n,e,ki),n!==null){Or=n;return}if(e=e.sibling,e!==null){Or=e;return}Or=e=t}while(e!==null);Kr===0&&(Kr=5)}function ru(t,e,n){var r=kn,s=ao.transition;try{ao.transition=null,kn=1,qY(t,e,n,r)}finally{ao.transition=s,kn=r}return null}function qY(t,e,n,r){do _h();while(Kl!==null);if(gn&6)throw Error(Ze(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Ze(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(IK(t,i),t===os&&(Or=os=null,ps=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||ky||(ky=!0,s$(_v,function(){return _h(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=ao.transition,ao.transition=null;var o=kn;kn=1;var l=gn;gn|=4,J1.current=null,UY(t,n),YV(n,t),fY(FC),Cv=!!LC,FC=LC=null,t.current=n,BY(n),xK(),gn=l,kn=o,ao.transition=i}else t.current=n;if(ky&&(ky=!1,Kl=t,$v=s),i=t.pendingLanes,i===0&&(nc=null),bK(n.stateNode),pi(t,Dr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Vv)throw Vv=!1,t=rE,rE=null,t;return $v&1&&t.tag!==0&&_h(),i=t.pendingLanes,i&1?t===sE?Um++:(Um=0,sE=t):Um=0,Rc(),null}function _h(){if(Kl!==null){var t=MO($v),e=ao.transition,n=kn;try{if(ao.transition=null,kn=16>t?16:t,Kl===null)var r=!1;else{if(t=Kl,Kl=null,$v=0,gn&6)throw Error(Ze(331));var s=gn;for(gn|=4,vt=t.current;vt!==null;){var i=vt,o=i.child;if(vt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(vt=u;vt!==null;){var d=vt;switch(d.tag){case 0:case 11:case 15:Vm(8,d,i)}var h=d.child;if(h!==null)h.return=d,vt=h;else for(;vt!==null;){d=vt;var f=d.sibling,m=d.return;if(HV(d),d===u){vt=null;break}if(f!==null){f.return=m,vt=f;break}vt=m}}}var g=i.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var v=x.sibling;x.sibling=null,x=v}while(x!==null)}}vt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,vt=o;else e:for(;vt!==null;){if(i=vt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Vm(9,i,i.return)}var w=i.sibling;if(w!==null){w.return=i.return,vt=w;break e}vt=i.return}}var _=t.current;for(vt=_;vt!==null;){o=vt;var C=o.child;if(o.subtreeFlags&2064&&C!==null)C.return=o,vt=C;else e:for(o=_;vt!==null;){if(l=vt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:m0(9,l)}}catch(R){Cr(l,l.return,R)}if(l===o){vt=null;break e}var T=l.sibling;if(T!==null){T.return=l.return,vt=T;break e}vt=l.return}}if(gn=s,Rc(),da&&typeof da.onPostCommitFiberRoot=="function")try{da.onPostCommitFiberRoot(o0,t)}catch{}r=!0}return r}finally{kn=n,ao.transition=e}}return!1}function AR(t,e,n){e=Uh(n,e),e=MV(t,e,1),t=tc(t,e,1),e=Js(),t!==null&&(mg(t,1,e),pi(t,e))}function Cr(t,e,n){if(t.tag===3)AR(t,t,n);else for(;e!==null;){if(e.tag===3){AR(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(nc===null||!nc.has(r))){t=Uh(n,t),t=LV(e,t,1),e=tc(e,t,1),t=Js(),e!==null&&(mg(e,1,t),pi(e,t));break}}e=e.return}}function KY(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Js(),t.pingedLanes|=t.suspendedLanes&n,os===t&&(ps&n)===n&&(Kr===4||Kr===3&&(ps&130023424)===ps&&500>Dr()-Q1?Pu(t,0):X1|=n),pi(t,e)}function n$(t,e){e===0&&(t.mode&1?(e=by,by<<=1,!(by&130023424)&&(by=4194304)):e=1);var n=Js();t=tl(t,e),t!==null&&(mg(t,e,n),pi(t,n))}function YY(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),n$(t,n)}function JY(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Ze(314))}r!==null&&r.delete(e),n$(t,n)}var r$;r$=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||fi.current)ci=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ci=!1,FY(t,e,n);ci=!!(t.flags&131072)}else ci=!1,ir&&e.flags&1048576&&aV(e,kv,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;Dx(t,e),t=e.pendingProps;var s=Fh(e,Ms.current);bh(e,n),s=W1(null,e,r,t,s,n);var i=H1();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,mi(r)?(i=!0,Pv(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,$1(e),s.updater=f0,e.stateNode=s,s._reactInternals=e,HC(e,r,t,n),e=YC(null,e,r,!0,i,n)):(e.tag=0,ir&&i&&j1(e),Hs(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(Dx(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=QY(r),t=So(r,t),s){case 0:e=KC(null,e,r,t,n);break e;case 1:e=wR(null,e,r,t,n);break e;case 11:e=xR(null,e,r,t,n);break e;case 14:e=vR(null,e,r,So(r.type,t),n);break e}throw Error(Ze(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:So(r,s),KC(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:So(r,s),wR(t,e,r,s,n);case 3:e:{if($V(e),t===null)throw Error(Ze(387));r=e.pendingProps,i=e.memoizedState,s=i.element,fV(t,e),Dv(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Uh(Error(Ze(423)),e),e=bR(t,e,r,n,s);break e}else if(r!==s){s=Uh(Error(Ze(424)),e),e=bR(t,e,r,n,s);break e}else for(Fi=ec(e.stateNode.containerInfo.firstChild),Bi=e,ir=!0,No=null,n=dV(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Oh(),r===s){e=nl(t,e,n);break e}Hs(t,e,r,n)}e=e.child}return e;case 5:return mV(e),t===null&&zC(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,OC(r,s)?o=null:i!==null&&OC(r,i)&&(e.flags|=32),VV(t,e),Hs(t,e,o,n),e.child;case 6:return t===null&&zC(e),null;case 13:return UV(t,e,n);case 4:return U1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Vh(e,null,r,n):Hs(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:So(r,s),xR(t,e,r,s,n);case 7:return Hs(t,e,e.pendingProps,n),e.child;case 8:return Hs(t,e,e.pendingProps.children,n),e.child;case 12:return Hs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Gn(Rv,r._currentValue),r._currentValue=o,i!==null)if(Oo(i.value,o)){if(i.children===s.children&&!fi.current){e=nl(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Wa(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),GC(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Ze(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),GC(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Hs(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,bh(e,n),s=ho(s),r=r(s),e.flags|=1,Hs(t,e,r,n),e.child;case 14:return r=e.type,s=So(r,e.pendingProps),s=So(r.type,s),vR(t,e,r,s,n);case 15:return FV(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:So(r,s),Dx(t,e),e.tag=1,mi(r)?(t=!0,Pv(e)):t=!1,bh(e,n),DV(e,r,s),HC(e,r,s,n),YC(null,e,r,!0,t,n);case 19:return BV(t,e,n);case 22:return OV(t,e,n)}throw Error(Ze(156,e.tag))};function s$(t,e){return kO(t,e)}function XY(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function so(t,e,n,r){return new XY(t,e,n,r)}function nI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function QY(t){if(typeof t=="function")return nI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===b1)return 11;if(t===_1)return 14}return 2}function sc(t,e){var n=t.alternate;return n===null?(n=so(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Fx(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")nI(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Yd:return Au(n.children,s,i,e);case w1:o=8,s|=8;break;case gC:return t=so(12,n,e,s|2),t.elementType=gC,t.lanes=i,t;case yC:return t=so(13,n,e,s),t.elementType=yC,t.lanes=i,t;case xC:return t=so(19,n,e,s),t.elementType=xC,t.lanes=i,t;case mO:return g0(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case hO:o=10;break e;case fO:o=9;break e;case b1:o=11;break e;case _1:o=14;break e;case Fl:o=16,r=null;break e}throw Error(Ze(130,t==null?t:typeof t,""))}return e=so(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Au(t,e,n,r){return t=so(7,t,r,e),t.lanes=n,t}function g0(t,e,n,r){return t=so(22,t,r,e),t.elementType=mO,t.lanes=n,t.stateNode={isHidden:!1},t}function V_(t,e,n){return t=so(6,t,null,e),t.lanes=n,t}function $_(t,e,n){return e=so(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ZY(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=w_(0),this.expirationTimes=w_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=w_(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function rI(t,e,n,r,s,i,o,l,c){return t=new ZY(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=so(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},$1(i),t}function eJ(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Kd,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function i$(t){if(!t)return vc;t=t._reactInternals;e:{if(ad(t)!==t||t.tag!==1)throw Error(Ze(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(mi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Ze(171))}if(t.tag===1){var n=t.type;if(mi(n))return iV(t,n,e)}return e}function o$(t,e,n,r,s,i,o,l,c){return t=rI(n,r,!0,t,s,i,o,l,c),t.context=i$(null),n=t.current,r=Js(),s=rc(n),i=Wa(r,s),i.callback=e??null,tc(n,i,s),t.current.lanes=s,mg(t,s,r),pi(t,r),t}function y0(t,e,n,r){var s=e.current,i=Js(),o=rc(s);return n=i$(n),e.context===null?e.context=n:e.pendingContext=n,e=Wa(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=tc(s,e,o),t!==null&&(Mo(t,s,o,i),kx(t,s,o)),o}function Bv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function kR(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function sI(t,e){kR(t,e),(t=t.alternate)&&kR(t,e)}function tJ(){return null}var a$=typeof reportError=="function"?reportError:function(t){console.error(t)};function iI(t){this._internalRoot=t}x0.prototype.render=iI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Ze(409));y0(t,e,null,null)};x0.prototype.unmount=iI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Bu(function(){y0(null,t,null,null)}),e[el]=null}};function x0(t){this._internalRoot=t}x0.prototype.unstable_scheduleHydration=function(t){if(t){var e=OO();t={blockedOn:null,target:t,priority:e};for(var n=0;n<$l.length&&e!==0&&e<$l[n].priority;n++);$l.splice(n,0,t),n===0&&$O(t)}};function oI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function v0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function RR(){}function nJ(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=Bv(o);i.call(u)}}var o=o$(e,r,t,0,null,!1,!1,"",RR);return t._reactRootContainer=o,t[el]=o.current,Sp(t.nodeType===8?t.parentNode:t),Bu(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=Bv(c);l.call(u)}}var c=rI(t,0,!1,null,null,!1,!1,"",RR);return t._reactRootContainer=c,t[el]=c.current,Sp(t.nodeType===8?t.parentNode:t),Bu(function(){y0(e,c,n,r)}),c}function w0(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=Bv(o);l.call(c)}}y0(e,o,t,s)}else o=nJ(n,e,t,s,r);return Bv(o)}LO=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=mm(e.pendingLanes);n!==0&&(E1(e,n|1),pi(e,Dr()),!(gn&6)&&(Bh=Dr()+500,Rc()))}break;case 13:Bu(function(){var r=tl(t,1);if(r!==null){var s=Js();Mo(r,t,1,s)}}),sI(t,1)}};T1=function(t){if(t.tag===13){var e=tl(t,134217728);if(e!==null){var n=Js();Mo(e,t,134217728,n)}sI(t,134217728)}};FO=function(t){if(t.tag===13){var e=rc(t),n=tl(t,e);if(n!==null){var r=Js();Mo(n,t,e,r)}sI(t,e)}};OO=function(){return kn};VO=function(t,e){var n=kn;try{return kn=t,e()}finally{kn=n}};NC=function(t,e,n){switch(e){case"input":if(bC(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=u0(r);if(!s)throw Error(Ze(90));gO(r),bC(r,s)}}}break;case"textarea":xO(t,n);break;case"select":e=n.value,e!=null&&yh(t,!!n.multiple,e,!1)}};EO=Z1;TO=Bu;var rJ={usingClientEntryPoint:!1,Events:[gg,Zd,u0,SO,CO,Z1]},Wf={findFiberByHostInstance:xu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sJ={bundleType:Wf.bundleType,version:Wf.version,rendererPackageName:Wf.rendererPackageName,rendererConfig:Wf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=PO(t),t===null?null:t.stateNode},findFiberByHostInstance:Wf.findFiberByHostInstance||tJ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Ry=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Ry.isDisabled&&Ry.supportsFiber)try{o0=Ry.inject(sJ),da=Ry}catch{}}Ki.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rJ;Ki.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!oI(e))throw Error(Ze(200));return eJ(t,e,null,n)};Ki.createRoot=function(t,e){if(!oI(t))throw Error(Ze(299));var n=!1,r="",s=a$;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=rI(t,1,!1,null,null,n,!1,r,s),t[el]=e.current,Sp(t.nodeType===8?t.parentNode:t),new iI(e)};Ki.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Ze(188)):(t=Object.keys(t).join(","),Error(Ze(268,t)));return t=PO(e),t=t===null?null:t.stateNode,t};Ki.flushSync=function(t){return Bu(t)};Ki.hydrate=function(t,e,n){if(!v0(e))throw Error(Ze(200));return w0(null,t,e,!0,n)};Ki.hydrateRoot=function(t,e,n){if(!oI(t))throw Error(Ze(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=a$;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=o$(e,null,t,1,n??null,s,!1,i,o),t[el]=e.current,Sp(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new x0(e)};Ki.render=function(t,e,n){if(!v0(e))throw Error(Ze(200));return w0(null,t,e,!1,n)};Ki.unmountComponentAtNode=function(t){if(!v0(t))throw Error(Ze(40));return t._reactRootContainer?(Bu(function(){w0(null,null,t,!1,function(){t._reactRootContainer=null,t[el]=null})}),!0):!1};Ki.unstable_batchedUpdates=Z1;Ki.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!v0(n))throw Error(Ze(200));if(t==null||t._reactInternals===void 0)throw Error(Ze(38));return w0(t,e,n,!1,r)};Ki.version="18.3.1-next-f1338f8080-20240426";function l$(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(l$)}catch(t){console.error(t)}}l$(),lO.exports=Ki;var ml=lO.exports;const aI=r0(ml),iJ=JF({__proto__:null,default:aI},[ml]);var jR=ml;mC.createRoot=jR.createRoot,mC.hydrateRoot=jR.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function rr(){return rr=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},rr.apply(this,arguments)}var jr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(jr||(jr={}));const DR="popstate";function oJ(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Rp("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:zu(s)}return lJ(e,n,null,t)}function an(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function zh(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function aJ(){return Math.random().toString(36).substr(2,8)}function MR(t,e){return{usr:t.state,key:t.key,idx:e}}function Rp(t,e,n,r){return n===void 0&&(n=null),rr({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?pl(e):e,{state:n,key:e&&e.key||r||aJ()})}function zu(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function pl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function lJ(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=jr.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(rr({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){l=jr.Pop;let v=d(),w=v==null?null:v-u;u=v,c&&c({action:l,location:x.location,delta:w})}function f(v,w){l=jr.Push;let _=Rp(x.location,v,w);n&&n(_,v),u=d()+1;let C=MR(_,u),T=x.createHref(_);try{o.pushState(C,"",T)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;s.location.assign(T)}i&&c&&c({action:l,location:x.location,delta:1})}function m(v,w){l=jr.Replace;let _=Rp(x.location,v,w);n&&n(_,v),u=d();let C=MR(_,u),T=x.createHref(_);o.replaceState(C,"",T),i&&c&&c({action:l,location:x.location,delta:0})}function g(v){let w=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof v=="string"?v:zu(v);return _=_.replace(/ $/,"%20"),an(w,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,w)}let x={get action(){return l},get location(){return t(s,o)},listen(v){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(DR,h),c=v,()=>{s.removeEventListener(DR,h),c=null}},createHref(v){return e(s,v)},createURL:g,encodeLocation(v){let w=g(v);return{pathname:w.pathname,search:w.search,hash:w.hash}},push:f,replace:m,go(v){return o.go(v)}};return x}var Pn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Pn||(Pn={}));const cJ=new Set(["lazy","caseSensitive","path","id","index","children"]);function uJ(t){return t.index===!0}function zv(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,String(i)],l=typeof s.id=="string"?s.id:o.join("-");if(an(s.index!==!0||!s.children,"Cannot specify children on an index route"),an(!r[l],'Found a route id collision on id "'+l+`".  Route id's must be globally unique within Data Router usages`),uJ(s)){let c=rr({},s,e(s),{id:l});return r[l]=c,c}else{let c=rr({},s,e(s),{id:l,children:void 0});return r[l]=c,s.children&&(c.children=zv(s.children,e,o,r)),c}})}function uu(t,e,n){return n===void 0&&(n="/"),Ox(t,e,n,!1)}function Ox(t,e,n,r){let s=typeof e=="string"?pl(e):e,i=xf(s.pathname||"/",n);if(i==null)return null;let o=c$(t);hJ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=SJ(i);l=bJ(o[c],u,r)}return l}function dJ(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function c$(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(an(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Ha([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(an(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),c$(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:vJ(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of u$(i.path))s(i,o,c)}),e}function u$(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=u$(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function hJ(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:wJ(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const fJ=/^:[\w-]+$/,mJ=3,pJ=2,gJ=1,yJ=10,xJ=-2,LR=t=>t==="*";function vJ(t,e){let n=t.split("/"),r=n.length;return n.some(LR)&&(r+=xJ),e&&(r+=pJ),n.filter(s=>!LR(s)).reduce((s,i)=>s+(fJ.test(i)?mJ:i===""?gJ:yJ),r)}function wJ(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function bJ(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=FR({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=FR({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Ha([i,h.pathname]),pathnameBase:TJ(Ha([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Ha([i,h.pathnameBase]))}return o}function FR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=_J(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:f,isOptional:m}=d;if(f==="*"){let x=l[h]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const g=l[h];return m&&!g?u[f]=void 0:u[f]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function _J(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),zh(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function SJ(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return zh(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function xf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function CJ(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?pl(t):t;return{pathname:n?n.startsWith("/")?n:EJ(n,e):e,search:IJ(r),hash:NJ(s)}}function EJ(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function U_(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function d$(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function b0(t,e){let n=d$(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function _0(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=pl(t):(s=rr({},t),an(!s.pathname||!s.pathname.includes("?"),U_("?","pathname","search",s)),an(!s.pathname||!s.pathname.includes("#"),U_("#","pathname","hash",s)),an(!s.search||!s.search.includes("#"),U_("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=CJ(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Ha=t=>t.join("/").replace(/\/\/+/g,"/"),TJ=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),IJ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,NJ=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Gv{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function jp(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const h$=["post","put","patch","delete"],PJ=new Set(h$),AJ=["get",...h$],kJ=new Set(AJ),RJ=new Set([301,302,303,307,308]),jJ=new Set([307,308]),B_={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},DJ={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Hf={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},lI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,MJ=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),f$="remix-router-transitions";function LJ(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;an(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let Y=t.detectErrorBoundary;s=re=>({hasErrorBoundary:Y(re)})}else s=MJ;let i={},o=zv(t.routes,s,void 0,i),l,c=t.basename||"/",u=t.dataStrategy||$J,d=t.patchRoutesOnNavigation,h=rr({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,m=new Set,g=null,x=null,v=null,w=t.hydrationData!=null,_=uu(o,t.history.location,c),C=!1,T=null;if(_==null&&!d){let Y=ai(404,{pathname:t.history.location.pathname}),{matches:re,route:ge}=KR(o);_=re,T={[ge.id]:Y}}_&&!t.hydrationData&&sn(_,o,t.history.location.pathname).active&&(_=null);let R;if(_)if(_.some(Y=>Y.route.lazy))R=!1;else if(!_.some(Y=>Y.route.loader))R=!0;else if(h.v7_partialHydration){let Y=t.hydrationData?t.hydrationData.loaderData:null,re=t.hydrationData?t.hydrationData.errors:null;if(re){let ge=_.findIndex(Oe=>re[Oe.route.id]!==void 0);R=_.slice(0,ge+1).every(Oe=>!lE(Oe.route,Y,re))}else R=_.every(ge=>!lE(ge.route,Y,re))}else R=t.hydrationData!=null;else if(R=!1,_=[],h.v7_partialHydration){let Y=sn(null,o,t.history.location.pathname);Y.active&&Y.matches&&(C=!0,_=Y.matches)}let A,E={historyAction:t.history.action,location:t.history.location,matches:_,initialized:R,navigation:B_,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||T,fetchers:new Map,blockers:new Map},I=jr.Pop,N=!1,k,j=!1,D=new Map,L=null,G=!1,B=!1,W=[],X=new Set,H=new Map,K=0,V=-1,$=new Map,z=new Set,F=new Map,Z=new Map,ce=new Set,le=new Map,he=new Map,Le;function $e(){if(f=t.history.listen(Y=>{let{action:re,location:ge,delta:Oe}=Y;if(Le){Le(),Le=void 0;return}zh(he.size===0||Oe!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let tt=wt({currentLocation:E.location,nextLocation:ge,historyAction:re});if(tt&&Oe!=null){let J=new Promise(te=>{Le=te});t.history.go(Oe*-1),Tt(tt,{state:"blocked",location:ge,proceed(){Tt(tt,{state:"proceeding",proceed:void 0,reset:void 0,location:ge}),J.then(()=>t.history.go(Oe))},reset(){let te=new Map(E.blockers);te.set(tt,Hf),Ce({blockers:te})}});return}return Me(re,ge)}),n){eX(e,D);let Y=()=>tX(e,D);e.addEventListener("pagehide",Y),L=()=>e.removeEventListener("pagehide",Y)}return E.initialized||Me(jr.Pop,E.location,{initialHydration:!0}),A}function Be(){f&&f(),L&&L(),m.clear(),k&&k.abort(),E.fetchers.forEach((Y,re)=>Pe(re)),E.blockers.forEach((Y,re)=>Te(re))}function ue(Y){return m.add(Y),()=>m.delete(Y)}function Ce(Y,re){re===void 0&&(re={}),E=rr({},E,Y);let ge=[],Oe=[];h.v7_fetcherPersist&&E.fetchers.forEach((tt,J)=>{tt.state==="idle"&&(ce.has(J)?Oe.push(J):ge.push(J))}),ce.forEach(tt=>{!E.fetchers.has(tt)&&!H.has(tt)&&Oe.push(tt)}),[...m].forEach(tt=>tt(E,{deletedFetchers:Oe,viewTransitionOpts:re.viewTransitionOpts,flushSync:re.flushSync===!0})),h.v7_fetcherPersist?(ge.forEach(tt=>E.fetchers.delete(tt)),Oe.forEach(tt=>Pe(tt))):Oe.forEach(tt=>ce.delete(tt))}function Ie(Y,re,ge){var Oe,tt;let{flushSync:J}=ge===void 0?{}:ge,te=E.actionData!=null&&E.navigation.formMethod!=null&&To(E.navigation.formMethod)&&E.navigation.state==="loading"&&((Oe=Y.state)==null?void 0:Oe._isRedirect)!==!0,me;re.actionData?Object.keys(re.actionData).length>0?me=re.actionData:me=null:te?me=E.actionData:me=null;let q=re.loaderData?HR(E.loaderData,re.loaderData,re.matches||[],re.errors):E.loaderData,ne=E.blockers;ne.size>0&&(ne=new Map(ne),ne.forEach((Ge,Se)=>ne.set(Se,Hf)));let be=N===!0||E.navigation.formMethod!=null&&To(E.navigation.formMethod)&&((tt=Y.state)==null?void 0:tt._isRedirect)!==!0;l&&(o=l,l=void 0),G||I===jr.Pop||(I===jr.Push?t.history.push(Y,Y.state):I===jr.Replace&&t.history.replace(Y,Y.state));let Ne;if(I===jr.Pop){let Ge=D.get(E.location.pathname);Ge&&Ge.has(Y.pathname)?Ne={currentLocation:E.location,nextLocation:Y}:D.has(Y.pathname)&&(Ne={currentLocation:Y,nextLocation:E.location})}else if(j){let Ge=D.get(E.location.pathname);Ge?Ge.add(Y.pathname):(Ge=new Set([Y.pathname]),D.set(E.location.pathname,Ge)),Ne={currentLocation:E.location,nextLocation:Y}}Ce(rr({},re,{actionData:me,loaderData:q,historyAction:I,location:Y,initialized:!0,navigation:B_,revalidation:"idle",restoreScrollPosition:cr(Y,re.matches||E.matches),preventScrollReset:be,blockers:ne}),{viewTransitionOpts:Ne,flushSync:J===!0}),I=jr.Pop,N=!1,j=!1,G=!1,B=!1,W=[]}async function ve(Y,re){if(typeof Y=="number"){t.history.go(Y);return}let ge=aE(E.location,E.matches,c,h.v7_prependBasename,Y,h.v7_relativeSplatPath,re==null?void 0:re.fromRouteId,re==null?void 0:re.relative),{path:Oe,submission:tt,error:J}=OR(h.v7_normalizeFormMethod,!1,ge,re),te=E.location,me=Rp(E.location,Oe,re&&re.state);me=rr({},me,t.history.encodeLocation(me));let q=re&&re.replace!=null?re.replace:void 0,ne=jr.Push;q===!0?ne=jr.Replace:q===!1||tt!=null&&To(tt.formMethod)&&tt.formAction===E.location.pathname+E.location.search&&(ne=jr.Replace);let be=re&&"preventScrollReset"in re?re.preventScrollReset===!0:void 0,Ne=(re&&re.flushSync)===!0,Ge=wt({currentLocation:te,nextLocation:me,historyAction:ne});if(Ge){Tt(Ge,{state:"blocked",location:me,proceed(){Tt(Ge,{state:"proceeding",proceed:void 0,reset:void 0,location:me}),ve(Y,re)},reset(){let Se=new Map(E.blockers);Se.set(Ge,Hf),Ce({blockers:Se})}});return}return await Me(ne,me,{submission:tt,pendingError:J,preventScrollReset:be,replace:re&&re.replace,enableViewTransition:re&&re.viewTransition,flushSync:Ne})}function ie(){if(De(),Ce({revalidation:"loading"}),E.navigation.state!=="submitting"){if(E.navigation.state==="idle"){Me(E.historyAction,E.location,{startUninterruptedRevalidation:!0});return}Me(I||E.historyAction,E.navigation.location,{overrideNavigation:E.navigation,enableViewTransition:j===!0})}}async function Me(Y,re,ge){k&&k.abort(),k=null,I=Y,G=(ge&&ge.startUninterruptedRevalidation)===!0,Sn(E.location,E.matches),N=(ge&&ge.preventScrollReset)===!0,j=(ge&&ge.enableViewTransition)===!0;let Oe=l||o,tt=ge&&ge.overrideNavigation,J=ge!=null&&ge.initialHydration&&E.matches&&E.matches.length>0&&!C?E.matches:uu(Oe,re,c),te=(ge&&ge.flushSync)===!0;if(J&&E.initialized&&!B&&HJ(E.location,re)&&!(ge&&ge.submission&&To(ge.submission.formMethod))){Ie(re,{matches:J},{flushSync:te});return}let me=sn(J,Oe,re.pathname);if(me.active&&me.matches&&(J=me.matches),!J){let{error:it,notFoundMatches:st,route:Mt}=xt(re.pathname);Ie(re,{matches:st,loaderData:{},errors:{[Mt.id]:it}},{flushSync:te});return}k=new AbortController;let q=Sd(t.history,re,k.signal,ge&&ge.submission),ne;if(ge&&ge.pendingError)ne=[du(J).route.id,{type:Pn.error,error:ge.pendingError}];else if(ge&&ge.submission&&To(ge.submission.formMethod)){let it=await He(q,re,ge.submission,J,me.active,{replace:ge.replace,flushSync:te});if(it.shortCircuited)return;if(it.pendingActionResult){let[st,Mt]=it.pendingActionResult;if(Ri(Mt)&&jp(Mt.error)&&Mt.error.status===404){k=null,Ie(re,{matches:it.matches,loaderData:{},errors:{[st]:Mt.error}});return}}J=it.matches||J,ne=it.pendingActionResult,tt=z_(re,ge.submission),te=!1,me.active=!1,q=Sd(t.history,q.url,q.signal)}let{shortCircuited:be,matches:Ne,loaderData:Ge,errors:Se}=await yt(q,re,J,me.active,tt,ge&&ge.submission,ge&&ge.fetcherSubmission,ge&&ge.replace,ge&&ge.initialHydration===!0,te,ne);be||(k=null,Ie(re,rr({matches:Ne||J},qR(ne),{loaderData:Ge,errors:Se})))}async function He(Y,re,ge,Oe,tt,J){J===void 0&&(J={}),De();let te=QJ(re,ge);if(Ce({navigation:te},{flushSync:J.flushSync===!0}),tt){let ne=await Vt(Oe,re.pathname,Y.signal);if(ne.type==="aborted")return{shortCircuited:!0};if(ne.type==="error"){let be=du(ne.partialMatches).route.id;return{matches:ne.partialMatches,pendingActionResult:[be,{type:Pn.error,error:ne.error}]}}else if(ne.matches)Oe=ne.matches;else{let{notFoundMatches:be,error:Ne,route:Ge}=xt(re.pathname);return{matches:be,pendingActionResult:[Ge.id,{type:Pn.error,error:Ne}]}}}let me,q=gm(Oe,re);if(!q.route.action&&!q.route.lazy)me={type:Pn.error,error:ai(405,{method:Y.method,pathname:re.pathname,routeId:q.route.id})};else if(me=(await Et("action",E,Y,[q],Oe,null))[q.route.id],Y.signal.aborted)return{shortCircuited:!0};if(bu(me)){let ne;return J&&J.replace!=null?ne=J.replace:ne=zR(me.response.headers.get("Location"),new URL(Y.url),c)===E.location.pathname+E.location.search,await Ue(Y,me,!0,{submission:ge,replace:ne}),{shortCircuited:!0}}if(Yl(me))throw ai(400,{type:"defer-action"});if(Ri(me)){let ne=du(Oe,q.route.id);return(J&&J.replace)!==!0&&(I=jr.Push),{matches:Oe,pendingActionResult:[ne.route.id,me]}}return{matches:Oe,pendingActionResult:[q.route.id,me]}}async function yt(Y,re,ge,Oe,tt,J,te,me,q,ne,be){let Ne=tt||z_(re,J),Ge=J||te||JR(Ne),Se=!G&&(!h.v7_partialHydration||!q);if(Oe){if(Se){let Cn=kt(be);Ce(rr({navigation:Ne},Cn!==void 0?{actionData:Cn}:{}),{flushSync:ne})}let nn=await Vt(ge,re.pathname,Y.signal);if(nn.type==="aborted")return{shortCircuited:!0};if(nn.type==="error"){let Cn=du(nn.partialMatches).route.id;return{matches:nn.partialMatches,loaderData:{},errors:{[Cn]:nn.error}}}else if(nn.matches)ge=nn.matches;else{let{error:Cn,notFoundMatches:ni,route:ri}=xt(re.pathname);return{matches:ni,loaderData:{},errors:{[ri.id]:Cn}}}}let it=l||o,[st,Mt]=$R(t.history,E,ge,Ge,re,h.v7_partialHydration&&q===!0,h.v7_skipActionErrorRevalidation,B,W,X,ce,F,z,it,c,be);if(pt(nn=>!(ge&&ge.some(Cn=>Cn.route.id===nn))||st&&st.some(Cn=>Cn.route.id===nn)),V=++K,st.length===0&&Mt.length===0){let nn=oe();return Ie(re,rr({matches:ge,loaderData:{},errors:be&&Ri(be[1])?{[be[0]]:be[1].error}:null},qR(be),nn?{fetchers:new Map(E.fetchers)}:{}),{flushSync:ne}),{shortCircuited:!0}}if(Se){let nn={};if(!Oe){nn.navigation=Ne;let Cn=kt(be);Cn!==void 0&&(nn.actionData=Cn)}Mt.length>0&&(nn.fetchers=en(Mt)),Ce(nn,{flushSync:ne})}Mt.forEach(nn=>{Ve(nn.key),nn.controller&&H.set(nn.key,nn.controller)});let xn=()=>Mt.forEach(nn=>Ve(nn.key));k&&k.signal.addEventListener("abort",xn);let{loaderResults:Zr,fetcherResults:Dn}=await de(E,ge,st,Mt,Y);if(Y.signal.aborted)return{shortCircuited:!0};k&&k.signal.removeEventListener("abort",xn),Mt.forEach(nn=>H.delete(nn.key));let Gr=jy(Zr);if(Gr)return await Ue(Y,Gr.result,!0,{replace:me}),{shortCircuited:!0};if(Gr=jy(Dn),Gr)return z.add(Gr.key),await Ue(Y,Gr.result,!0,{replace:me}),{shortCircuited:!0};let{loaderData:bs,errors:Si}=WR(E,ge,Zr,be,Mt,Dn,le);le.forEach((nn,Cn)=>{nn.subscribe(ni=>{(ni||nn.done)&&le.delete(Cn)})}),h.v7_partialHydration&&q&&E.errors&&(Si=rr({},E.errors,Si));let Vs=oe(),$s=_e(V),es=Vs||$s||Mt.length>0;return rr({matches:ge,loaderData:bs,errors:Si},es?{fetchers:new Map(E.fetchers)}:{})}function kt(Y){if(Y&&!Ri(Y[1]))return{[Y[0]]:Y[1].data};if(E.actionData)return Object.keys(E.actionData).length===0?null:E.actionData}function en(Y){return Y.forEach(re=>{let ge=E.fetchers.get(re.key),Oe=qf(void 0,ge?ge.data:void 0);E.fetchers.set(re.key,Oe)}),new Map(E.fetchers)}function mn(Y,re,ge,Oe){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");Ve(Y);let tt=(Oe&&Oe.flushSync)===!0,J=l||o,te=aE(E.location,E.matches,c,h.v7_prependBasename,ge,h.v7_relativeSplatPath,re,Oe==null?void 0:Oe.relative),me=uu(J,te,c),q=sn(me,J,te);if(q.active&&q.matches&&(me=q.matches),!me){ae(Y,re,ai(404,{pathname:te}),{flushSync:tt});return}let{path:ne,submission:be,error:Ne}=OR(h.v7_normalizeFormMethod,!0,te,Oe);if(Ne){ae(Y,re,Ne,{flushSync:tt});return}let Ge=gm(me,ne),Se=(Oe&&Oe.preventScrollReset)===!0;if(be&&To(be.formMethod)){cn(Y,re,ne,Ge,me,q.active,tt,Se,be);return}F.set(Y,{routeId:re,path:ne}),fn(Y,re,ne,Ge,me,q.active,tt,Se,be)}async function cn(Y,re,ge,Oe,tt,J,te,me,q){De(),F.delete(Y);function ne(Mn){if(!Mn.route.action&&!Mn.route.lazy){let Us=ai(405,{method:q.formMethod,pathname:ge,routeId:re});return ae(Y,re,Us,{flushSync:te}),!0}return!1}if(!J&&ne(Oe))return;let be=E.fetchers.get(Y);ee(Y,ZJ(q,be),{flushSync:te});let Ne=new AbortController,Ge=Sd(t.history,ge,Ne.signal,q);if(J){let Mn=await Vt(tt,new URL(Ge.url).pathname,Ge.signal,Y);if(Mn.type==="aborted")return;if(Mn.type==="error"){ae(Y,re,Mn.error,{flushSync:te});return}else if(Mn.matches){if(tt=Mn.matches,Oe=gm(tt,ge),ne(Oe))return}else{ae(Y,re,ai(404,{pathname:ge}),{flushSync:te});return}}H.set(Y,Ne);let Se=K,st=(await Et("action",E,Ge,[Oe],tt,Y))[Oe.route.id];if(Ge.signal.aborted){H.get(Y)===Ne&&H.delete(Y);return}if(h.v7_fetcherPersist&&ce.has(Y)){if(bu(st)||Ri(st)){ee(Y,Rl(void 0));return}}else{if(bu(st))if(H.delete(Y),V>Se){ee(Y,Rl(void 0));return}else return z.add(Y),ee(Y,qf(q)),Ue(Ge,st,!1,{fetcherSubmission:q,preventScrollReset:me});if(Ri(st)){ae(Y,re,st.error);return}}if(Yl(st))throw ai(400,{type:"defer-action"});let Mt=E.navigation.location||E.location,xn=Sd(t.history,Mt,Ne.signal),Zr=l||o,Dn=E.navigation.state!=="idle"?uu(Zr,E.navigation.location,c):E.matches;an(Dn,"Didn't find any matches after fetcher action");let Gr=++K;$.set(Y,Gr);let bs=qf(q,st.data);E.fetchers.set(Y,bs);let[Si,Vs]=$R(t.history,E,Dn,q,Mt,!1,h.v7_skipActionErrorRevalidation,B,W,X,ce,F,z,Zr,c,[Oe.route.id,st]);Vs.filter(Mn=>Mn.key!==Y).forEach(Mn=>{let Us=Mn.key,xo=E.fetchers.get(Us),Ho=qf(void 0,xo?xo.data:void 0);E.fetchers.set(Us,Ho),Ve(Us),Mn.controller&&H.set(Us,Mn.controller)}),Ce({fetchers:new Map(E.fetchers)});let $s=()=>Vs.forEach(Mn=>Ve(Mn.key));Ne.signal.addEventListener("abort",$s);let{loaderResults:es,fetcherResults:nn}=await de(E,Dn,Si,Vs,xn);if(Ne.signal.aborted)return;Ne.signal.removeEventListener("abort",$s),$.delete(Y),H.delete(Y),Vs.forEach(Mn=>H.delete(Mn.key));let Cn=jy(es);if(Cn)return Ue(xn,Cn.result,!1,{preventScrollReset:me});if(Cn=jy(nn),Cn)return z.add(Cn.key),Ue(xn,Cn.result,!1,{preventScrollReset:me});let{loaderData:ni,errors:ri}=WR(E,Dn,es,void 0,Vs,nn,le);if(E.fetchers.has(Y)){let Mn=Rl(st.data);E.fetchers.set(Y,Mn)}_e(Gr),E.navigation.state==="loading"&&Gr>V?(an(I,"Expected pending action"),k&&k.abort(),Ie(E.navigation.location,{matches:Dn,loaderData:ni,errors:ri,fetchers:new Map(E.fetchers)})):(Ce({errors:ri,loaderData:HR(E.loaderData,ni,Dn,ri),fetchers:new Map(E.fetchers)}),B=!1)}async function fn(Y,re,ge,Oe,tt,J,te,me,q){let ne=E.fetchers.get(Y);ee(Y,qf(q,ne?ne.data:void 0),{flushSync:te});let be=new AbortController,Ne=Sd(t.history,ge,be.signal);if(J){let st=await Vt(tt,new URL(Ne.url).pathname,Ne.signal,Y);if(st.type==="aborted")return;if(st.type==="error"){ae(Y,re,st.error,{flushSync:te});return}else if(st.matches)tt=st.matches,Oe=gm(tt,ge);else{ae(Y,re,ai(404,{pathname:ge}),{flushSync:te});return}}H.set(Y,be);let Ge=K,it=(await Et("loader",E,Ne,[Oe],tt,Y))[Oe.route.id];if(Yl(it)&&(it=await cI(it,Ne.signal,!0)||it),H.get(Y)===be&&H.delete(Y),!Ne.signal.aborted){if(ce.has(Y)){ee(Y,Rl(void 0));return}if(bu(it))if(V>Ge){ee(Y,Rl(void 0));return}else{z.add(Y),await Ue(Ne,it,!1,{preventScrollReset:me});return}if(Ri(it)){ae(Y,re,it.error);return}an(!Yl(it),"Unhandled fetcher deferred data"),ee(Y,Rl(it.data))}}async function Ue(Y,re,ge,Oe){let{submission:tt,fetcherSubmission:J,preventScrollReset:te,replace:me}=Oe===void 0?{}:Oe;re.response.headers.has("X-Remix-Revalidate")&&(B=!0);let q=re.response.headers.get("Location");an(q,"Expected a Location header on the redirect Response"),q=zR(q,new URL(Y.url),c);let ne=Rp(E.location,q,{_isRedirect:!0});if(n){let st=!1;if(re.response.headers.has("X-Remix-Reload-Document"))st=!0;else if(lI.test(q)){const Mt=t.history.createURL(q);st=Mt.origin!==e.location.origin||xf(Mt.pathname,c)==null}if(st){me?e.location.replace(q):e.location.assign(q);return}}k=null;let be=me===!0||re.response.headers.has("X-Remix-Replace")?jr.Replace:jr.Push,{formMethod:Ne,formAction:Ge,formEncType:Se}=E.navigation;!tt&&!J&&Ne&&Ge&&Se&&(tt=JR(E.navigation));let it=tt||J;if(jJ.has(re.response.status)&&it&&To(it.formMethod))await Me(be,ne,{submission:rr({},it,{formAction:q}),preventScrollReset:te||N,enableViewTransition:ge?j:void 0});else{let st=z_(ne,tt);await Me(be,ne,{overrideNavigation:st,fetcherSubmission:J,preventScrollReset:te||N,enableViewTransition:ge?j:void 0})}}async function Et(Y,re,ge,Oe,tt,J){let te,me={};try{te=await UJ(u,Y,re,ge,Oe,tt,J,i,s)}catch(q){return Oe.forEach(ne=>{me[ne.route.id]={type:Pn.error,error:q}}),me}for(let[q,ne]of Object.entries(te))if(qJ(ne)){let be=ne.result;me[q]={type:Pn.redirect,response:GJ(be,ge,q,tt,c,h.v7_relativeSplatPath)}}else me[q]=await zJ(ne);return me}async function de(Y,re,ge,Oe,tt){let J=Y.matches,te=Et("loader",Y,tt,ge,re,null),me=Promise.all(Oe.map(async be=>{if(be.matches&&be.match&&be.controller){let Ge=(await Et("loader",Y,Sd(t.history,be.path,be.controller.signal),[be.match],be.matches,be.key))[be.match.route.id];return{[be.key]:Ge}}else return Promise.resolve({[be.key]:{type:Pn.error,error:ai(404,{pathname:be.path})}})})),q=await te,ne=(await me).reduce((be,Ne)=>Object.assign(be,Ne),{});return await Promise.all([JJ(re,q,tt.signal,J,Y.loaderData),XJ(re,ne,Oe)]),{loaderResults:q,fetcherResults:ne}}function De(){B=!0,W.push(...pt()),F.forEach((Y,re)=>{H.has(re)&&X.add(re),Ve(re)})}function ee(Y,re,ge){ge===void 0&&(ge={}),E.fetchers.set(Y,re),Ce({fetchers:new Map(E.fetchers)},{flushSync:(ge&&ge.flushSync)===!0})}function ae(Y,re,ge,Oe){Oe===void 0&&(Oe={});let tt=du(E.matches,re);Pe(Y),Ce({errors:{[tt.route.id]:ge},fetchers:new Map(E.fetchers)},{flushSync:(Oe&&Oe.flushSync)===!0})}function Q(Y){return Z.set(Y,(Z.get(Y)||0)+1),ce.has(Y)&&ce.delete(Y),E.fetchers.get(Y)||DJ}function Pe(Y){let re=E.fetchers.get(Y);H.has(Y)&&!(re&&re.state==="loading"&&$.has(Y))&&Ve(Y),F.delete(Y),$.delete(Y),z.delete(Y),h.v7_fetcherPersist&&ce.delete(Y),X.delete(Y),E.fetchers.delete(Y)}function Ae(Y){let re=(Z.get(Y)||0)-1;re<=0?(Z.delete(Y),ce.add(Y),h.v7_fetcherPersist||Pe(Y)):Z.set(Y,re),Ce({fetchers:new Map(E.fetchers)})}function Ve(Y){let re=H.get(Y);re&&(re.abort(),H.delete(Y))}function qe(Y){for(let re of Y){let ge=Q(re),Oe=Rl(ge.data);E.fetchers.set(re,Oe)}}function oe(){let Y=[],re=!1;for(let ge of z){let Oe=E.fetchers.get(ge);an(Oe,"Expected fetcher: "+ge),Oe.state==="loading"&&(z.delete(ge),Y.push(ge),re=!0)}return qe(Y),re}function _e(Y){let re=[];for(let[ge,Oe]of $)if(Oe<Y){let tt=E.fetchers.get(ge);an(tt,"Expected fetcher: "+ge),tt.state==="loading"&&(Ve(ge),$.delete(ge),re.push(ge))}return qe(re),re.length>0}function ze(Y,re){let ge=E.blockers.get(Y)||Hf;return he.get(Y)!==re&&he.set(Y,re),ge}function Te(Y){E.blockers.delete(Y),he.delete(Y)}function Tt(Y,re){let ge=E.blockers.get(Y)||Hf;an(ge.state==="unblocked"&&re.state==="blocked"||ge.state==="blocked"&&re.state==="blocked"||ge.state==="blocked"&&re.state==="proceeding"||ge.state==="blocked"&&re.state==="unblocked"||ge.state==="proceeding"&&re.state==="unblocked","Invalid blocker state transition: "+ge.state+" -> "+re.state);let Oe=new Map(E.blockers);Oe.set(Y,re),Ce({blockers:Oe})}function wt(Y){let{currentLocation:re,nextLocation:ge,historyAction:Oe}=Y;if(he.size===0)return;he.size>1&&zh(!1,"A router only supports one blocker at a time");let tt=Array.from(he.entries()),[J,te]=tt[tt.length-1],me=E.blockers.get(J);if(!(me&&me.state==="proceeding")&&te({currentLocation:re,nextLocation:ge,historyAction:Oe}))return J}function xt(Y){let re=ai(404,{pathname:Y}),ge=l||o,{matches:Oe,route:tt}=KR(ge);return pt(),{notFoundMatches:Oe,route:tt,error:re}}function pt(Y){let re=[];return le.forEach((ge,Oe)=>{(!Y||Y(Oe))&&(ge.cancel(),re.push(Oe),le.delete(Oe))}),re}function Nt(Y,re,ge){if(g=Y,v=re,x=ge||null,!w&&E.navigation===B_){w=!0;let Oe=cr(E.location,E.matches);Oe!=null&&Ce({restoreScrollPosition:Oe})}return()=>{g=null,v=null,x=null}}function jn(Y,re){return x&&x(Y,re.map(Oe=>dJ(Oe,E.loaderData)))||Y.key}function Sn(Y,re){if(g&&v){let ge=jn(Y,re);g[ge]=v()}}function cr(Y,re){if(g){let ge=jn(Y,re),Oe=g[ge];if(typeof Oe=="number")return Oe}return null}function sn(Y,re,ge){if(d)if(Y){if(Object.keys(Y[0].params).length>0)return{active:!0,matches:Ox(re,ge,c,!0)}}else return{active:!0,matches:Ox(re,ge,c,!0)||[]};return{active:!1,matches:null}}async function Vt(Y,re,ge,Oe){if(!d)return{type:"success",matches:Y};let tt=Y;for(;;){let J=l==null,te=l||o,me=i;try{await d({signal:ge,path:re,matches:tt,fetcherKey:Oe,patch:(be,Ne)=>{ge.aborted||BR(be,Ne,te,me,s)}})}catch(be){return{type:"error",error:be,partialMatches:tt}}finally{J&&!ge.aborted&&(o=[...o])}if(ge.aborted)return{type:"aborted"};let q=uu(te,re,c);if(q)return{type:"success",matches:q};let ne=Ox(te,re,c,!0);if(!ne||tt.length===ne.length&&tt.every((be,Ne)=>be.route.id===ne[Ne].route.id))return{type:"success",matches:null};tt=ne}}function tn(Y){i={},l=zv(Y,s,void 0,i)}function Zn(Y,re){let ge=l==null;BR(Y,re,l||o,i,s),ge&&(o=[...o],Ce({}))}return A={get basename(){return c},get future(){return h},get state(){return E},get routes(){return o},get window(){return e},initialize:$e,subscribe:ue,enableScrollRestoration:Nt,navigate:ve,fetch:mn,revalidate:ie,createHref:Y=>t.history.createHref(Y),encodeLocation:Y=>t.history.encodeLocation(Y),getFetcher:Q,deleteFetcher:Ae,dispose:Be,getBlocker:ze,deleteBlocker:Te,patchRoutes:Zn,_internalFetchControllers:H,_internalActiveDeferreds:le,_internalSetRoutes:tn},A}function FJ(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function aE(t,e,n,r,s,i,o,l){let c,u;if(o){c=[];for(let h of e)if(c.push(h),h.route.id===o){u=h;break}}else c=e,u=e[e.length-1];let d=_0(s||".",b0(c,i),xf(t.pathname,n)||t.pathname,l==="path");if(s==null&&(d.search=t.search,d.hash=t.hash),(s==null||s===""||s===".")&&u){let h=uI(d.search);if(u.route.index&&!h)d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index";else if(!u.route.index&&h){let f=new URLSearchParams(d.search),m=f.getAll("index");f.delete("index"),m.filter(x=>x).forEach(x=>f.append("index",x));let g=f.toString();d.search=g?"?"+g:""}}return r&&n!=="/"&&(d.pathname=d.pathname==="/"?n:Ha([n,d.pathname])),zu(d)}function OR(t,e,n,r){if(!r||!FJ(r))return{path:n};if(r.formMethod&&!YJ(r.formMethod))return{path:n,error:ai(405,{method:r.formMethod})};let s=()=>({path:n,error:ai(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),l=g$(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!To(o))return s();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((m,g)=>{let[x,v]=g;return""+m+x+"="+v+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!To(o))return s();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return s()}}}an(typeof FormData=="function","FormData is not available in this environment");let c,u;if(r.formData)c=cE(r.formData),u=r.formData;else if(r.body instanceof FormData)c=cE(r.body),u=r.body;else if(r.body instanceof URLSearchParams)c=r.body,u=GR(c);else if(r.body==null)c=new URLSearchParams,u=new FormData;else try{c=new URLSearchParams(r.body),u=GR(c)}catch{return s()}let d={formMethod:o,formAction:l,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(To(d.formMethod))return{path:n,submission:d};let h=pl(n);return e&&h.search&&uI(h.search)&&c.append("index",""),h.search="?"+c,{path:zu(h),submission:d}}function VR(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(s=>s.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function $R(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x){let v=x?Ri(x[1])?x[1].error:x[1].data:void 0,w=t.createURL(e.location),_=t.createURL(s),C=n;i&&e.errors?C=VR(n,Object.keys(e.errors)[0],!0):x&&Ri(x[1])&&(C=VR(n,x[0]));let T=x?x[1].statusCode:void 0,R=o&&T&&T>=400,A=C.filter((I,N)=>{let{route:k}=I;if(k.lazy)return!0;if(k.loader==null)return!1;if(i)return lE(k,e.loaderData,e.errors);if(OJ(e.loaderData,e.matches[N],I)||c.some(L=>L===I.route.id))return!0;let j=e.matches[N],D=I;return UR(I,rr({currentUrl:w,currentParams:j.params,nextUrl:_,nextParams:D.params},r,{actionResult:v,actionStatus:T,defaultShouldRevalidate:R?!1:l||w.pathname+w.search===_.pathname+_.search||w.search!==_.search||m$(j,D)}))}),E=[];return h.forEach((I,N)=>{if(i||!n.some(G=>G.route.id===I.routeId)||d.has(N))return;let k=uu(m,I.path,g);if(!k){E.push({key:N,routeId:I.routeId,path:I.path,matches:null,match:null,controller:null});return}let j=e.fetchers.get(N),D=gm(k,I.path),L=!1;f.has(N)?L=!1:u.has(N)?(u.delete(N),L=!0):j&&j.state!=="idle"&&j.data===void 0?L=l:L=UR(D,rr({currentUrl:w,currentParams:e.matches[e.matches.length-1].params,nextUrl:_,nextParams:n[n.length-1].params},r,{actionResult:v,actionStatus:T,defaultShouldRevalidate:R?!1:l})),L&&E.push({key:N,routeId:I.routeId,path:I.path,matches:k,match:D,controller:new AbortController})}),[A,E]}function lE(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,s=n!=null&&n[t.id]!==void 0;return!r&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!s}function OJ(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function m$(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function UR(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function BR(t,e,n,r,s){var i;let o;if(t){let u=r[t];an(u,"No route found to patch children into: routeId = "+t),u.children||(u.children=[]),o=u.children}else o=n;let l=e.filter(u=>!o.some(d=>p$(u,d))),c=zv(l,s,[t||"_","patch",String(((i=o)==null?void 0:i.length)||"0")],r);o.push(...c)}function p$(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var s;return(s=e.children)==null?void 0:s.some(i=>p$(n,i))}):!1}async function VJ(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];an(s,"No route found in manifest");let i={};for(let o in r){let c=s[o]!==void 0&&o!=="hasErrorBoundary";zh(!c,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!c&&!cJ.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,rr({},e(s),{lazy:void 0}))}async function $J(t){let{matches:e}=t,n=e.filter(s=>s.shouldLoad);return(await Promise.all(n.map(s=>s.resolve()))).reduce((s,i,o)=>Object.assign(s,{[n[o].route.id]:i}),{})}async function UJ(t,e,n,r,s,i,o,l,c,u){let d=i.map(m=>m.route.lazy?VJ(m.route,c,l):void 0),h=i.map((m,g)=>{let x=d[g],v=s.some(_=>_.route.id===m.route.id);return rr({},m,{shouldLoad:v,resolve:async _=>(_&&r.method==="GET"&&(m.route.lazy||m.route.loader)&&(v=!0),v?BJ(e,r,m,x,_,u):Promise.resolve({type:Pn.data,result:void 0}))})}),f=await t({matches:h,request:r,params:i[0].params,fetcherKey:o,context:u});try{await Promise.all(d)}catch{}return f}async function BJ(t,e,n,r,s,i){let o,l,c=u=>{let d,h=new Promise((g,x)=>d=x);l=()=>d(),e.signal.addEventListener("abort",l);let f=g=>typeof u!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):u({request:e,params:n.params,context:i},...g!==void 0?[g]:[]),m=(async()=>{try{return{type:"data",result:await(s?s(x=>f(x)):f())}}catch(g){return{type:"error",result:g}}})();return Promise.race([m,h])};try{let u=n.route[t];if(r)if(u){let d,[h]=await Promise.all([c(u).catch(f=>{d=f}),r]);if(d!==void 0)throw d;o=h}else if(await r,u=n.route[t],u)o=await c(u);else if(t==="action"){let d=new URL(e.url),h=d.pathname+d.search;throw ai(405,{method:e.method,pathname:h,routeId:n.route.id})}else return{type:Pn.data,result:void 0};else if(u)o=await c(u);else{let d=new URL(e.url),h=d.pathname+d.search;throw ai(404,{pathname:h})}an(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(u){return{type:Pn.error,result:u}}finally{l&&e.signal.removeEventListener("abort",l)}return o}async function zJ(t){let{result:e,type:n}=t;if(y$(e)){let h;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(f){return{type:Pn.error,error:f}}return n===Pn.error?{type:Pn.error,error:new Gv(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:Pn.data,data:h,statusCode:e.status,headers:e.headers}}if(n===Pn.error){if(YR(e)){var r,s;if(e.data instanceof Error){var i,o;return{type:Pn.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:Pn.error,error:new Gv(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:jp(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:Pn.error,error:e,statusCode:jp(e)?e.status:void 0}}if(KJ(e)){var l,c;return{type:Pn.deferred,deferredData:e,statusCode:(l=e.init)==null?void 0:l.status,headers:((c=e.init)==null?void 0:c.headers)&&new Headers(e.init.headers)}}if(YR(e)){var u,d;return{type:Pn.data,data:e.data,statusCode:(u=e.init)==null?void 0:u.status,headers:(d=e.init)!=null&&d.headers?new Headers(e.init.headers):void 0}}return{type:Pn.data,data:e}}function GJ(t,e,n,r,s,i){let o=t.headers.get("Location");if(an(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!lI.test(o)){let l=r.slice(0,r.findIndex(c=>c.route.id===n)+1);o=aE(new URL(e.url),l,s,!0,o,i),t.headers.set("Location",o)}return t}function zR(t,e,n){if(lI.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=xf(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function Sd(t,e,n,r){let s=t.createURL(g$(e)).toString(),i={signal:n};if(r&&To(r.formMethod)){let{formMethod:o,formEncType:l}=r;i.method=o.toUpperCase(),l==="application/json"?(i.headers=new Headers({"Content-Type":l}),i.body=JSON.stringify(r.json)):l==="text/plain"?i.body=r.text:l==="application/x-www-form-urlencoded"&&r.formData?i.body=cE(r.formData):i.body=r.formData}return new Request(s,i)}function cE(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function GR(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function WJ(t,e,n,r,s){let i={},o=null,l,c=!1,u={},d=n&&Ri(n[1])?n[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let f=h.route.id,m=e[f];if(an(!bu(m),"Cannot handle redirect results in processLoaderData"),Ri(m)){let g=m.error;if(d!==void 0&&(g=d,d=void 0),o=o||{},s)o[f]=g;else{let x=du(t,f);o[x.route.id]==null&&(o[x.route.id]=g)}i[f]=void 0,c||(c=!0,l=jp(m.error)?m.error.status:500),m.headers&&(u[f]=m.headers)}else Yl(m)?(r.set(f,m.deferredData),i[f]=m.deferredData.data,m.statusCode!=null&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers)):(i[f]=m.data,m.statusCode&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers))}),d!==void 0&&n&&(o={[n[0]]:d},i[n[0]]=void 0),{loaderData:i,errors:o,statusCode:l||200,loaderHeaders:u}}function WR(t,e,n,r,s,i,o){let{loaderData:l,errors:c}=WJ(e,n,r,o,!1);return s.forEach(u=>{let{key:d,match:h,controller:f}=u,m=i[d];if(an(m,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if(Ri(m)){let g=du(t.matches,h==null?void 0:h.route.id);c&&c[g.route.id]||(c=rr({},c,{[g.route.id]:m.error})),t.fetchers.delete(d)}else if(bu(m))an(!1,"Unhandled fetcher revalidation redirect");else if(Yl(m))an(!1,"Unhandled fetcher deferred data");else{let g=Rl(m.data);t.fetchers.set(d,g)}}),{loaderData:l,errors:c}}function HR(t,e,n,r){let s=rr({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function qR(t){return t?Ri(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function du(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function KR(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function ai(t,e){let{pathname:n,routeId:r,method:s,type:i,message:o}=e===void 0?{}:e,l="Unknown Server Error",c="Unknown @remix-run/router error";return t===400?(l="Bad Request",s&&n&&r?c="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?c="defer() is not supported in actions":i==="invalid-body"&&(c="Unable to encode submission body")):t===403?(l="Forbidden",c='Route "'+r+'" does not match URL "'+n+'"'):t===404?(l="Not Found",c='No route matches URL "'+n+'"'):t===405&&(l="Method Not Allowed",s&&n&&r?c="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(c='Invalid request method "'+s.toUpperCase()+'"')),new Gv(t||500,l,new Error(c),!0)}function jy(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,s]=e[n];if(bu(s))return{key:r,result:s}}}function g$(t){let e=typeof t=="string"?pl(t):t;return zu(rr({},e,{hash:""}))}function HJ(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function qJ(t){return y$(t.result)&&RJ.has(t.result.status)}function Yl(t){return t.type===Pn.deferred}function Ri(t){return t.type===Pn.error}function bu(t){return(t&&t.type)===Pn.redirect}function YR(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function KJ(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function y$(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function YJ(t){return kJ.has(t.toLowerCase())}function To(t){return PJ.has(t.toLowerCase())}async function JJ(t,e,n,r,s){let i=Object.entries(e);for(let o=0;o<i.length;o++){let[l,c]=i[o],u=t.find(f=>(f==null?void 0:f.route.id)===l);if(!u)continue;let d=r.find(f=>f.route.id===u.route.id),h=d!=null&&!m$(d,u)&&(s&&s[u.route.id])!==void 0;Yl(c)&&h&&await cI(c,n,!1).then(f=>{f&&(e[l]=f)})}}async function XJ(t,e,n){for(let r=0;r<n.length;r++){let{key:s,routeId:i,controller:o}=n[r],l=e[s];t.find(u=>(u==null?void 0:u.route.id)===i)&&Yl(l)&&(an(o,"Expected an AbortController for revalidating fetcher deferred result"),await cI(l,o.signal,!0).then(u=>{u&&(e[s]=u)}))}}async function cI(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Pn.data,data:t.deferredData.unwrappedData}}catch(s){return{type:Pn.error,error:s}}return{type:Pn.data,data:t.deferredData.data}}}function uI(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function gm(t,e){let n=typeof e=="string"?pl(e).search:e.search;if(t[t.length-1].route.index&&uI(n||""))return t[t.length-1];let r=d$(t);return r[r.length-1]}function JR(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function z_(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function QJ(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function qf(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function ZJ(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Rl(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function eX(t,e){try{let n=t.sessionStorage.getItem(f$);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function tX(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(f$,JSON.stringify(n))}catch(r){zh(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Dp(){return Dp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Dp.apply(this,arguments)}const S0=p.createContext(null),x$=p.createContext(null),jc=p.createContext(null),C0=p.createContext(null),Ca=p.createContext({outlet:null,matches:[],isDataRoute:!1}),v$=p.createContext(null);function nX(t,e){let{relative:n}=e===void 0?{}:e;vf()||an(!1);let{basename:r,navigator:s}=p.useContext(jc),{hash:i,pathname:o,search:l}=b$(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Ha([r,o])),s.createHref({pathname:c,search:l,hash:i})}function vf(){return p.useContext(C0)!=null}function gl(){return vf()||an(!1),p.useContext(C0).location}function w$(t){p.useContext(jc).static||p.useLayoutEffect(t)}function vi(){let{isDataRoute:t}=p.useContext(Ca);return t?gX():rX()}function rX(){vf()||an(!1);let t=p.useContext(S0),{basename:e,future:n,navigator:r}=p.useContext(jc),{matches:s}=p.useContext(Ca),{pathname:i}=gl(),o=JSON.stringify(b0(s,n.v7_relativeSplatPath)),l=p.useRef(!1);return w$(()=>{l.current=!0}),p.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let h=_0(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ha([e,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[e,r,o,i,t])}const sX=p.createContext(null);function iX(t){let e=p.useContext(Ca).outlet;return e&&p.createElement(sX.Provider,{value:t},e)}function E0(){let{matches:t}=p.useContext(Ca),e=t[t.length-1];return e?e.params:{}}function b$(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=p.useContext(jc),{matches:s}=p.useContext(Ca),{pathname:i}=gl(),o=JSON.stringify(b0(s,r.v7_relativeSplatPath));return p.useMemo(()=>_0(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function oX(t,e,n,r){vf()||an(!1);let{navigator:s}=p.useContext(jc),{matches:i}=p.useContext(Ca),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=gl(),d;if(e){var h;let v=typeof e=="string"?pl(e):e;c==="/"||(h=v.pathname)!=null&&h.startsWith(c)||an(!1),d=v}else d=u;let f=d.pathname||"/",m=f;if(c!=="/"){let v=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(v.length).join("/")}let g=uu(t,{pathname:m}),x=dX(g&&g.map(v=>Object.assign({},v,{params:Object.assign({},l,v.params),pathname:Ha([c,s.encodeLocation?s.encodeLocation(v.pathname).pathname:v.pathname]),pathnameBase:v.pathnameBase==="/"?c:Ha([c,s.encodeLocation?s.encodeLocation(v.pathnameBase).pathname:v.pathnameBase])})),i,n,r);return e&&x?p.createElement(C0.Provider,{value:{location:Dp({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:jr.Pop}},x):x}function aX(){let t=pX(),e=jp(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:s},n):null,i)}const lX=p.createElement(aX,null);class cX extends p.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?p.createElement(Ca.Provider,{value:this.props.routeContext},p.createElement(v$.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function uX(t){let{routeContext:e,match:n,children:r}=t,s=p.useContext(S0);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(Ca.Provider,{value:e},r)}function dX(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||an(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:m}=n,g=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||g){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let m,g=!1,x=null,v=null;n&&(m=l&&h.route.id?l[h.route.id]:void 0,x=h.route.errorElement||lX,c&&(u<0&&f===0?(yX("route-fallback",!1),g=!0,v=null):u===f&&(g=!0,v=h.route.hydrateFallbackElement||null)));let w=e.concat(o.slice(0,f+1)),_=()=>{let C;return m?C=x:g?C=v:h.route.Component?C=p.createElement(h.route.Component,null):h.route.element?C=h.route.element:C=d,p.createElement(uX,{match:h,routeContext:{outlet:d,matches:w,isDataRoute:n!=null},children:C})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?p.createElement(cX,{location:n.location,revalidation:n.revalidation,component:x,error:m,children:_(),routeContext:{outlet:null,matches:w,isDataRoute:!0}}):_()},null)}var _$=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(_$||{}),Wv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Wv||{});function hX(t){let e=p.useContext(S0);return e||an(!1),e}function fX(t){let e=p.useContext(x$);return e||an(!1),e}function mX(t){let e=p.useContext(Ca);return e||an(!1),e}function S$(t){let e=mX(),n=e.matches[e.matches.length-1];return n.route.id||an(!1),n.route.id}function pX(){var t;let e=p.useContext(v$),n=fX(Wv.UseRouteError),r=S$(Wv.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function gX(){let{router:t}=hX(_$.UseNavigateStable),e=S$(Wv.UseNavigateStable),n=p.useRef(!1);return w$(()=>{n.current=!0}),p.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,Dp({fromRouteId:e},i)))},[t,e])}const XR={};function yX(t,e,n){!e&&!XR[t]&&(XR[t]=!0)}function xX(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function C$(t){let{to:e,replace:n,state:r,relative:s}=t;vf()||an(!1);let{future:i,static:o}=p.useContext(jc),{matches:l}=p.useContext(Ca),{pathname:c}=gl(),u=vi(),d=_0(e,b0(l,i.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return p.useEffect(()=>u(JSON.parse(h),{replace:n,state:r,relative:s}),[u,h,s,n,r]),null}function vX(t){return iX(t.context)}function wX(t){let{basename:e="/",children:n=null,location:r,navigationType:s=jr.Pop,navigator:i,static:o=!1,future:l}=t;vf()&&an(!1);let c=e.replace(/^\/*/,"/"),u=p.useMemo(()=>({basename:c,navigator:i,static:o,future:Dp({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=pl(r));let{pathname:d="/",search:h="",hash:f="",state:m=null,key:g="default"}=r,x=p.useMemo(()=>{let v=xf(d,c);return v==null?null:{location:{pathname:v,search:h,hash:f,state:m,key:g},navigationType:s}},[c,d,h,f,m,g,s]);return x==null?null:p.createElement(jc.Provider,{value:u},p.createElement(C0.Provider,{children:n,value:x}))}new Promise(()=>{});function bX(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:p.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:p.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:p.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Mp(){return Mp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Mp.apply(this,arguments)}function _X(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function SX(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function CX(t,e){return t.button===0&&(!e||e==="_self")&&!SX(t)}const EX=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],TX="6";try{window.__reactRouterVersion=TX}catch{}function IX(t,e){return LJ({basename:e==null?void 0:e.basename,future:Mp({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:oJ({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||NX(),routes:t,mapRouteProperties:bX,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function NX(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=Mp({},e,{errors:PX(e.errors)})),e}function PX(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new Gv(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const AX=p.createContext({isTransitioning:!1}),kX=p.createContext(new Map),RX="startTransition",QR=i0[RX],jX="flushSync",ZR=iJ[jX];function DX(t){QR?QR(t):t()}function Kf(t){ZR?ZR(t):t()}let MX=class{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}};function LX(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=p.useState(n.state),[o,l]=p.useState(),[c,u]=p.useState({isTransitioning:!1}),[d,h]=p.useState(),[f,m]=p.useState(),[g,x]=p.useState(),v=p.useRef(new Map),{v7_startTransition:w}=r||{},_=p.useCallback(I=>{w?DX(I):I()},[w]),C=p.useCallback((I,N)=>{let{deletedFetchers:k,flushSync:j,viewTransitionOpts:D}=N;I.fetchers.forEach((G,B)=>{G.data!==void 0&&v.current.set(B,G.data)}),k.forEach(G=>v.current.delete(G));let L=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!D||L){j?Kf(()=>i(I)):_(()=>i(I));return}if(j){Kf(()=>{f&&(d&&d.resolve(),f.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:D.currentLocation,nextLocation:D.nextLocation})});let G=n.window.document.startViewTransition(()=>{Kf(()=>i(I))});G.finished.finally(()=>{Kf(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})})}),Kf(()=>m(G));return}f?(d&&d.resolve(),f.skipTransition(),x({state:I,currentLocation:D.currentLocation,nextLocation:D.nextLocation})):(l(I),u({isTransitioning:!0,flushSync:!1,currentLocation:D.currentLocation,nextLocation:D.nextLocation}))},[n.window,f,d,v,_]);p.useLayoutEffect(()=>n.subscribe(C),[n,C]),p.useEffect(()=>{c.isTransitioning&&!c.flushSync&&h(new MX)},[c]),p.useEffect(()=>{if(d&&o&&n.window){let I=o,N=d.promise,k=n.window.document.startViewTransition(async()=>{_(()=>i(I)),await N});k.finished.finally(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})}),m(k)}},[_,o,d,n.window]),p.useEffect(()=>{d&&o&&s.location.key===o.location.key&&d.resolve()},[d,f,s.location,o]),p.useEffect(()=>{!c.isTransitioning&&g&&(l(g.state),u({isTransitioning:!0,flushSync:!1,currentLocation:g.currentLocation,nextLocation:g.nextLocation}),x(void 0))},[c.isTransitioning,g]),p.useEffect(()=>{},[]);let T=p.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:I=>n.navigate(I),push:(I,N,k)=>n.navigate(I,{state:N,preventScrollReset:k==null?void 0:k.preventScrollReset}),replace:(I,N,k)=>n.navigate(I,{replace:!0,state:N,preventScrollReset:k==null?void 0:k.preventScrollReset})}),[n]),R=n.basename||"/",A=p.useMemo(()=>({router:n,navigator:T,static:!1,basename:R}),[n,T,R]),E=p.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return p.useEffect(()=>xX(r,n.future),[r,n.future]),p.createElement(p.Fragment,null,p.createElement(S0.Provider,{value:A},p.createElement(x$.Provider,{value:s},p.createElement(kX.Provider,{value:v.current},p.createElement(AX.Provider,{value:c},p.createElement(wX,{basename:R,location:s.location,navigationType:s.historyAction,navigator:T,future:E},s.initialized||n.future.v7_partialHydration?p.createElement(FX,{routes:n.routes,future:n.future,state:s}):e))))),null)}const FX=p.memo(OX);function OX(t){let{routes:e,future:n,state:r}=t;return oX(e,void 0,r,n)}const VX=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$X=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xn=p.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=e,f=_X(e,EX),{basename:m}=p.useContext(jc),g,x=!1;if(typeof u=="string"&&$X.test(u)&&(g=u,VX))try{let C=new URL(window.location.href),T=u.startsWith("//")?new URL(C.protocol+u):new URL(u),R=xf(T.pathname,m);T.origin===C.origin&&R!=null?u=R+T.search+T.hash:x=!0}catch{}let v=nX(u,{relative:s}),w=UX(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function _(C){r&&r(C),C.defaultPrevented||w(C)}return p.createElement("a",Mp({},f,{href:g||v,onClick:x||i?r:_,ref:n,target:c}))});var ej;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(ej||(ej={}));var tj;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(tj||(tj={}));function UX(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=vi(),u=gl(),d=b$(t,{relative:o});return p.useCallback(h=>{if(CX(h,n)){h.preventDefault();let f=r!==void 0?r:zu(u)===zu(d);c(t,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,d,r,s,n,t,i,o,l])}function E$(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=E$(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function T$(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=E$(t))&&(r&&(r+=" "),r+=e);return r}function BX(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=I$(e))&&(r&&(r+=" "),r+=n);return r}function I$(t){if(typeof t=="string")return t;for(var e,n="",r=0;r<t.length;r++)t[r]&&(e=I$(t[r]))&&(n&&(n+=" "),n+=e);return n}var dI="-";function zX(t){var e=WX(t),n=t.conflictingClassGroups,r=t.conflictingClassGroupModifiers,s=r===void 0?{}:r;function i(l){var c=l.split(dI);return c[0]===""&&c.length!==1&&c.shift(),N$(c,e)||GX(l)}function o(l,c){var u=n[l]||[];return c&&s[l]?[].concat(u,s[l]):u}return{getClassGroupId:i,getConflictingClassGroupIds:o}}function N$(t,e){var o;if(t.length===0)return e.classGroupId;var n=t[0],r=e.nextPart.get(n),s=r?N$(t.slice(1),r):void 0;if(s)return s;if(e.validators.length!==0){var i=t.join(dI);return(o=e.validators.find(function(l){var c=l.validator;return c(i)}))==null?void 0:o.classGroupId}}var nj=/^\[(.+)\]$/;function GX(t){if(nj.test(t)){var e=nj.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function WX(t){var e=t.theme,n=t.prefix,r={nextPart:new Map,validators:[]},s=qX(Object.entries(t.classGroups),n);return s.forEach(function(i){var o=i[0],l=i[1];uE(l,r,o,e)}),r}function uE(t,e,n,r){t.forEach(function(s){if(typeof s=="string"){var i=s===""?e:rj(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(HX(s)){uE(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(function(o){var l=o[0],c=o[1];uE(c,rj(e,l),n,r)})})}function rj(t,e){var n=t;return e.split(dI).forEach(function(r){n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n}function HX(t){return t.isThemeGetter}function qX(t,e){return e?t.map(function(n){var r=n[0],s=n[1],i=s.map(function(o){return typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(l){var c=l[0],u=l[1];return[e+c,u]})):o});return[r,i]}):t}function KX(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,r=new Map;function s(i,o){n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)}return{get:function(o){var l=n.get(o);if(l!==void 0)return l;if((l=r.get(o))!==void 0)return s(o,l),l},set:function(o,l){n.has(o)?n.set(o,l):s(o,l)}}}var P$="!";function YX(t){var e=t.separator||":",n=e.length===1,r=e[0],s=e.length;return function(o){for(var l=[],c=0,u=0,d,h=0;h<o.length;h++){var f=o[h];if(c===0){if(f===r&&(n||o.slice(h,h+s)===e)){l.push(o.slice(u,h)),u=h+s;continue}if(f==="/"){d=h;continue}}f==="["?c++:f==="]"&&c--}var m=l.length===0?o:o.substring(u),g=m.startsWith(P$),x=g?m.substring(1):m,v=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:x,maybePostfixModifierPosition:v}}}function JX(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(r){var s=r[0]==="[";s?(e.push.apply(e,n.sort().concat([r])),n=[]):n.push(r)}),e.push.apply(e,n.sort()),e}function XX(t){return{cache:KX(t.cacheSize),splitModifiers:YX(t),...zX(t)}}var QX=/\s+/;function ZX(t,e){var n=e.splitModifiers,r=e.getClassGroupId,s=e.getConflictingClassGroupIds,i=new Set;return t.trim().split(QX).map(function(o){var l=n(o),c=l.modifiers,u=l.hasImportantModifier,d=l.baseClassName,h=l.maybePostfixModifierPosition,f=r(h?d.substring(0,h):d),m=!!h;if(!f){if(!h)return{isTailwindClass:!1,originalClassName:o};if(f=r(d),!f)return{isTailwindClass:!1,originalClassName:o};m=!1}var g=JX(c).join(":"),x=u?g+P$:g;return{isTailwindClass:!0,modifierId:x,classGroupId:f,originalClassName:o,hasPostfixModifier:m}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var l=o.modifierId,c=o.classGroupId,u=o.hasPostfixModifier,d=l+c;return i.has(d)?!1:(i.add(d),s(c,u).forEach(function(h){return i.add(l+h)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function eQ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,s,i,o=l;function l(u){var d=e[0],h=e.slice(1),f=h.reduce(function(m,g){return g(m)},d());return r=XX(f),s=r.cache.get,i=r.cache.set,o=c,c(u)}function c(u){var d=s(u);if(d)return d;var h=ZX(u,r);return i(u,h),h}return function(){return o(BX.apply(null,arguments))}}function Kn(t){var e=function(r){return r[t]||[]};return e.isThemeGetter=!0,e}var A$=/^\[(?:([a-z-]+):)?(.+)\]$/i,tQ=/^\d+\/\d+$/,nQ=new Set(["px","full","screen"]),rQ=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,sQ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,iQ=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function bo(t){return _u(t)||nQ.has(t)||tQ.test(t)||dE(t)}function dE(t){return ld(t,"length",dQ)}function oQ(t){return ld(t,"size",k$)}function aQ(t){return ld(t,"position",k$)}function lQ(t){return ld(t,"url",hQ)}function Dy(t){return ld(t,"number",_u)}function _u(t){return!Number.isNaN(Number(t))}function cQ(t){return t.endsWith("%")&&_u(t.slice(0,-1))}function Yf(t){return sj(t)||ld(t,"number",sj)}function un(t){return A$.test(t)}function Jf(){return!0}function Sl(t){return rQ.test(t)}function uQ(t){return ld(t,"",fQ)}function ld(t,e,n){var r=A$.exec(t);return r?r[1]?r[1]===e:n(r[2]):!1}function dQ(t){return sQ.test(t)}function k$(){return!1}function hQ(t){return t.startsWith("url(")}function sj(t){return Number.isInteger(Number(t))}function fQ(t){return iQ.test(t)}function mQ(){var t=Kn("colors"),e=Kn("spacing"),n=Kn("blur"),r=Kn("brightness"),s=Kn("borderColor"),i=Kn("borderRadius"),o=Kn("borderSpacing"),l=Kn("borderWidth"),c=Kn("contrast"),u=Kn("grayscale"),d=Kn("hueRotate"),h=Kn("invert"),f=Kn("gap"),m=Kn("gradientColorStops"),g=Kn("gradientColorStopPositions"),x=Kn("inset"),v=Kn("margin"),w=Kn("opacity"),_=Kn("padding"),C=Kn("saturate"),T=Kn("scale"),R=Kn("sepia"),A=Kn("skew"),E=Kn("space"),I=Kn("translate"),N=function(){return["auto","contain","none"]},k=function(){return["auto","hidden","clip","visible","scroll"]},j=function(){return["auto",un,e]},D=function(){return[un,e]},L=function(){return["",bo]},G=function(){return["auto",_u,un]},B=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},W=function(){return["solid","dashed","dotted","double","none"]},X=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},H=function(){return["start","end","center","between","around","evenly","stretch"]},K=function(){return["","0",un]},V=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},$=function(){return[_u,Dy]},z=function(){return[_u,un]};return{cacheSize:500,theme:{colors:[Jf],spacing:[bo],blur:["none","",Sl,un],brightness:$(),borderColor:[t],borderRadius:["none","","full",Sl,un],borderSpacing:D(),borderWidth:L(),contrast:$(),grayscale:K(),hueRotate:z(),invert:K(),gap:D(),gradientColorStops:[t],gradientColorStopPositions:[cQ,dE],inset:j(),margin:j(),opacity:$(),padding:D(),saturate:$(),scale:$(),sepia:K(),skew:z(),space:D(),translate:D()},classGroups:{aspect:[{aspect:["auto","square","video",un]}],container:["container"],columns:[{columns:[Sl]}],"break-after":[{"break-after":V()}],"break-before":[{"break-before":V()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(B(),[un])}],overflow:[{overflow:k()}],"overflow-x":[{"overflow-x":k()}],"overflow-y":[{"overflow-y":k()}],overscroll:[{overscroll:N()}],"overscroll-x":[{"overscroll-x":N()}],"overscroll-y":[{"overscroll-y":N()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Yf]}],basis:[{basis:j()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",un]}],grow:[{grow:K()}],shrink:[{shrink:K()}],order:[{order:["first","last","none",Yf]}],"grid-cols":[{"grid-cols":[Jf]}],"col-start-end":[{col:["auto",{span:["full",Yf]},un]}],"col-start":[{"col-start":G()}],"col-end":[{"col-end":G()}],"grid-rows":[{"grid-rows":[Jf]}],"row-start-end":[{row:["auto",{span:[Yf]},un]}],"row-start":[{"row-start":G()}],"row-end":[{"row-end":G()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",un]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",un]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal"].concat(H())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(H(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(H(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[v]}],mx:[{mx:[v]}],my:[{my:[v]}],ms:[{ms:[v]}],me:[{me:[v]}],mt:[{mt:[v]}],mr:[{mr:[v]}],mb:[{mb:[v]}],ml:[{ml:[v]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",un,e]}],"min-w":[{"min-w":["min","max","fit",un,bo]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[Sl]},Sl,un]}],h:[{h:[un,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",un,bo]}],"max-h":[{"max-h":[un,e,"min","max","fit"]}],"font-size":[{text:["base",Sl,dE]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Dy]}],"font-family":[{font:[Jf]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",un]}],"line-clamp":[{"line-clamp":["none",_u,Dy]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",un,bo]}],"list-image":[{"list-image":["none",un]}],"list-style-type":[{list:["none","disc","decimal",un]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[w]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[w]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(W(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",bo]}],"underline-offset":[{"underline-offset":["auto",un,bo]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:D()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",un]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",un]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[w]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(B(),[aQ])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",oQ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},lQ]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[w]}],"border-style":[{border:[].concat(W(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[w]}],"divide-style":[{divide:W()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(W())}],"outline-offset":[{"outline-offset":[un,bo]}],"outline-w":[{outline:[bo]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:L()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[w]}],"ring-offset-w":[{"ring-offset":[bo]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Sl,uQ]}],"shadow-color":[{shadow:[Jf]}],opacity:[{opacity:[w]}],"mix-blend":[{"mix-blend":X()}],"bg-blend":[{"bg-blend":X()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Sl,un]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[C]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[w]}],"backdrop-saturate":[{"backdrop-saturate":[C]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",un]}],duration:[{duration:z()}],ease:[{ease:["linear","in","out","in-out",un]}],delay:[{delay:z()}],animate:[{animate:["none","spin","ping","pulse","bounce",un]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[Yf,un]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[A]}],"skew-y":[{"skew-y":[A]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",un]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",un]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":D()}],"scroll-mx":[{"scroll-mx":D()}],"scroll-my":[{"scroll-my":D()}],"scroll-ms":[{"scroll-ms":D()}],"scroll-me":[{"scroll-me":D()}],"scroll-mt":[{"scroll-mt":D()}],"scroll-mr":[{"scroll-mr":D()}],"scroll-mb":[{"scroll-mb":D()}],"scroll-ml":[{"scroll-ml":D()}],"scroll-p":[{"scroll-p":D()}],"scroll-px":[{"scroll-px":D()}],"scroll-py":[{"scroll-py":D()}],"scroll-ps":[{"scroll-ps":D()}],"scroll-pe":[{"scroll-pe":D()}],"scroll-pt":[{"scroll-pt":D()}],"scroll-pr":[{"scroll-pr":D()}],"scroll-pb":[{"scroll-pb":D()}],"scroll-pl":[{"scroll-pl":D()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",un]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[bo,Dy]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var pQ=eQ(mQ);let My;const gQ=new Uint8Array(16);function yQ(){if(!My&&(My=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!My))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return My(gQ)}const cs=[];for(let t=0;t<256;++t)cs.push((t+256).toString(16).slice(1));function xQ(t,e=0){return cs[t[e+0]]+cs[t[e+1]]+cs[t[e+2]]+cs[t[e+3]]+"-"+cs[t[e+4]]+cs[t[e+5]]+"-"+cs[t[e+6]]+cs[t[e+7]]+"-"+cs[t[e+8]]+cs[t[e+9]]+"-"+cs[t[e+10]]+cs[t[e+11]]+cs[t[e+12]]+cs[t[e+13]]+cs[t[e+14]]+cs[t[e+15]]}const vQ=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),ij={randomUUID:vQ};function wQ(t,e,n){if(ij.randomUUID&&!e&&!t)return ij.randomUUID();t=t||{};const r=t.random||(t.rng||yQ)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=r[s];return e}return xQ(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let bQ,_Q;function SQ(){return{geminiUrl:bQ,vertexUrl:_Q}}function CQ(t,e,n){var r,s,i;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=SQ();return t.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(i=o.geminiUrl)!==null&&i!==void 0?i:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class xg{}function qt(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const i=e[s];return i!=null?String(i):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function S(t,e,n){for(let i=0;i<e.length-1;i++){const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in t))if(Array.isArray(n))t[l]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[l])){const c=t[l];if(Array.isArray(n))for(let u=0;u<c.length;u++){const d=c[u];S(d,e.slice(i+1),n[u])}else for(const u of c)S(u,e.slice(i+1),n)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in t||(t[l]=[{}]);const c=t[l];S(c[0],e.slice(i+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],s=t[r];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function b(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in t){const i=t[s];return Array.isArray(i)?i.map(o=>b(o,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function or(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function R$(t,e){const n=or(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function j$(t,e){return Array.isArray(e)?e.map(n=>Hv(t,n)):[Hv(t,e)]}function Hv(t,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function EQ(t,e){const n=Hv(t,e);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function TQ(t,e){const n=Hv(t,e);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function oj(t,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function D$(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(n=>oj(t,n)):[oj(t,e)]}function hE(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function aj(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function lj(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function ui(t,e){if(e==null)throw new Error("ContentUnion is required");return hE(e)?e:{role:"user",parts:D$(t,e)}}function M$(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=ui(t,n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=ui(t,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>ui(t,n)):[ui(t,e)]}function Dc(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(aj(e)||lj(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[ui(t,e)]}const n=[],r=[],s=hE(e[0]);for(const i of e){const o=hE(i);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)n.push(i);else{if(aj(i)||lj(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(i)}}return s||n.push({role:"user",parts:D$(t,r)}),n}function L$(t,e){return e}function F$(t,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function T0(t,e){return e}function I0(t,e){if(!Array.isArray(e))throw new Error("tool is required and must be an array of Tools");return e}function IQ(t,e,n,r=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function Mc(t,e){if(typeof e!="string")throw new Error("name must be a string");return IQ(t,e,"cachedContents")}function O$(t,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Lc(t,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function NQ(t){return t!=null&&typeof t=="object"&&"name"in t}function PQ(t){return t!=null&&typeof t=="object"&&"video"in t}function AQ(t){return t!=null&&typeof t=="object"&&"uri"in t}function V$(t,e){var n;let r;if(NQ(e)&&(r=e.name),!(AQ(e)&&(r=e.uri,r===void 0))&&!(PQ(e)&&(r=(n=e.video)===null||n===void 0?void 0:n.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const i=r.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${r}`);r=i[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function $$(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function U$(t,e){for(const n of["models","tunedModels","publisherModels"])if(kQ(e,n))return e[n];return[]}function kQ(t,e){return t!==null&&typeof t=="object"&&e in t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function RQ(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function jQ(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],RQ(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function cj(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>jQ(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function DQ(){return{}}function MQ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function LQ(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],MQ(t,r)),n}function FQ(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],DQ());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],LQ(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function OQ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function VQ(t,e){const n={},r=b(e,["functionCallingConfig"]);if(r!=null&&S(n,["functionCallingConfig"],OQ(t,r)),b(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function $Q(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);n!==void 0&&i!=null&&S(n,["expireTime"],i);const o=b(e,["displayName"]);n!==void 0&&o!=null&&S(n,["displayName"],o);const l=b(e,["contents"]);if(n!==void 0&&l!=null){let h=Dc(t,l);Array.isArray(h)&&(h=h.map(f=>cj(t,f))),S(n,["contents"],h)}const c=b(e,["systemInstruction"]);n!==void 0&&c!=null&&S(n,["systemInstruction"],cj(t,ui(t,c)));const u=b(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>FQ(t,f))),S(n,["tools"],h)}const d=b(e,["toolConfig"]);return n!==void 0&&d!=null&&S(n,["toolConfig"],VQ(t,d)),r}function UQ(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],R$(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],$Q(t,s,n)),n}function BQ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Mc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function zQ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Mc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function GQ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);return n!==void 0&&i!=null&&S(n,["expireTime"],i),r}function WQ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Mc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],GQ(t,s,n)),n}function HQ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function qQ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],HQ(t,r,n)),n}function KQ(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function YQ(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],KQ(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function uj(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>YQ(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function JQ(){return{}}function XQ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function QQ(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],XQ(t,r)),n}function ZQ(){return{}}function eZ(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function tZ(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],eZ(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function nZ(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],tZ(t,r)),n}function rZ(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],JQ());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],QQ(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],ZQ());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],nZ(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function sZ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function iZ(t,e){const n={},r=b(e,["latitude"]);r!=null&&S(n,["latitude"],r);const s=b(e,["longitude"]);return s!=null&&S(n,["longitude"],s),n}function oZ(t,e){const n={},r=b(e,["latLng"]);return r!=null&&S(n,["latLng"],iZ(t,r)),n}function aZ(t,e){const n={},r=b(e,["functionCallingConfig"]);r!=null&&S(n,["functionCallingConfig"],sZ(t,r));const s=b(e,["retrievalConfig"]);return s!=null&&S(n,["retrievalConfig"],oZ(t,s)),n}function lZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);n!==void 0&&i!=null&&S(n,["expireTime"],i);const o=b(e,["displayName"]);n!==void 0&&o!=null&&S(n,["displayName"],o);const l=b(e,["contents"]);if(n!==void 0&&l!=null){let h=Dc(t,l);Array.isArray(h)&&(h=h.map(f=>uj(t,f))),S(n,["contents"],h)}const c=b(e,["systemInstruction"]);n!==void 0&&c!=null&&S(n,["systemInstruction"],uj(t,ui(t,c)));const u=b(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>rZ(t,f))),S(n,["tools"],h)}const d=b(e,["toolConfig"]);return n!==void 0&&d!=null&&S(n,["toolConfig"],aZ(t,d)),r}function cZ(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],R$(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],lZ(t,s,n)),n}function uZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Mc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function dZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Mc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function hZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);return n!==void 0&&i!=null&&S(n,["expireTime"],i),r}function fZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Mc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],hZ(t,s,n)),n}function mZ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function pZ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],mZ(t,r,n)),n}function Vx(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["model"]);i!=null&&S(n,["model"],i);const o=b(e,["createTime"]);o!=null&&S(n,["createTime"],o);const l=b(e,["updateTime"]);l!=null&&S(n,["updateTime"],l);const c=b(e,["expireTime"]);c!=null&&S(n,["expireTime"],c);const u=b(e,["usageMetadata"]);return u!=null&&S(n,["usageMetadata"],u),n}function gZ(){return{}}function yZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>Vx(t,o))),S(n,["cachedContents"],i)}return n}function $x(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["model"]);i!=null&&S(n,["model"],i);const o=b(e,["createTime"]);o!=null&&S(n,["createTime"],o);const l=b(e,["updateTime"]);l!=null&&S(n,["updateTime"],l);const c=b(e,["expireTime"]);c!=null&&S(n,["expireTime"],c);const u=b(e,["usageMetadata"]);return u!=null&&S(n,["usageMetadata"],u),n}function xZ(){return{}}function vZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>$x(t,o))),S(n,["cachedContents"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Gh;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Gh||(Gh={}));class N0{constructor(e,n,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,s)}init(e,n,r){var s,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(i=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var dj;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(dj||(dj={}));var hj;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(hj||(hj={}));var Nr;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Nr||(Nr={}));var fj;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(fj||(fj={}));var Pr;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Pr||(Pr={}));var mj;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(mj||(mj={}));var pj;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(pj||(pj={}));var rt;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT"})(rt||(rt={}));var gj;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY"})(gj||(gj={}));var yj;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(yj||(yj={}));var xj;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(xj||(xj={}));var vj;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(vj||(vj={}));var wj;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(wj||(wj={}));var wn;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(wn||(wn={}));var bj;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(bj||(bj={}));var fE;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(fE||(fE={}));var _j;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(_j||(_j={}));var Sj;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Sj||(Sj={}));var Cj;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Cj||(Cj={}));var Ej;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(Ej||(Ej={}));var Tj;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Tj||(Tj={}));var Ij;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Ij||(Ij={}));var Nj;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(Nj||(Nj={}));var Pj;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Pj||(Pj={}));var Aj;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Aj||(Aj={}));var kj;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(kj||(kj={}));var Rj;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(Rj||(Rj={}));var jj;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(jj||(jj={}));var Dj;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Dj||(Dj={}));var Mj;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Mj||(Mj={}));var Lj;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Lj||(Lj={}));var Fj;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Fj||(Fj={}));var Oj;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Oj||(Oj={}));var Vj;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(Vj||(Vj={}));class Ly{get text(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",d=!1;const h=[];for(const f of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[m,g]of Object.entries(f))m!=="text"&&m!=="thought"&&(g!==null||g!==void 0)&&h.push(m);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;d=!0,u+=f.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?u:void 0}get data(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const d=[];for(const h of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[f,m]of Object.entries(h))f!=="inlineData"&&(m!==null||m!==void 0)&&d.push(f);h.inlineData&&typeof h.inlineData.data=="string"&&(u+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.output}}class $j{}class Uj{}class wZ{}class bZ{}class Bj{}class zj{}class Gj{}class _Z{}class Wj{}class Hj{}class qj{}class SZ{}class mE{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class CZ{}class EZ{}class TZ{get text(){var e,n,r;let s="",i=!1;const o=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,u]of Object.entries(l))c!=="text"&&c!=="thought"&&u!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;i=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?s:void 0}get data(){var e,n,r;let s="";const i=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&i.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class IZ extends xg{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new N0(Gh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=cZ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>$x(this.apiClient,d))}else{const u=UQ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Vx(this.apiClient,d))}}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=uZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>$x(this.apiClient,d))}else{const u=BQ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Vx(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=dZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=xZ(),h=new Hj;return Object.assign(h,d),h})}else{const u=zQ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=gZ(),h=new Hj;return Object.assign(h,d),h})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=fZ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>$x(this.apiClient,d))}else{const u=WQ(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Vx(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=pZ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=vZ(this.apiClient,d),f=new qj;return Object.assign(f,h),f})}else{const u=qQ(this.apiClient,e);return l=qt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=yZ(this.apiClient,d),f=new qj;return Object.assign(f,h),f})}}}function Kj(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ns(t){return this instanceof Ns?(this.v=t,this):new Ns(t)}function qv(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(g){return Promise.resolve(g).then(m,h)}}function l(m,g){r[m]&&(s[m]=function(x){return new Promise(function(v,w){i.push([m,x,v,w])>1||c(m,x)})},g&&(s[m]=g(s[m])))}function c(m,g){try{u(r[m](g))}catch(x){f(i[0][3],x)}}function u(m){m.value instanceof Ns?Promise.resolve(m.value.v).then(d,h):f(i[0][2],m)}function d(m){c("next",m)}function h(m){c("throw",m)}function f(m,g){m(g),i.shift(),i.length&&c(i[0][0],i[0][1])}}function pE(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof Kj=="function"?Kj(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(l,c){o=t[i](o),s(l,c,o.done,o.value)})}}function s(i,o,l,c){Promise.resolve(c).then(function(u){i({value:u,done:l})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function NZ(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:B$(n)}function B$(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||e.text!==void 0&&e.text==="")return!1;return!0}function PZ(t){if(t.length!==0){if(t[0].role!=="user")throw new Error("History must start with a user turn.");for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function AZ(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0,s=t[0];for(;r<n;)if(t[r].role==="user")s=t[r],r++;else{const i=[];let o=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),o&&!B$(t[r])&&(o=!1),r++;o&&(e.push(s),e.push(...i))}return e}class kZ{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new RZ(this.apiClient,this.modelsModule,e.model,e.config,e.history)}}let RZ=class{constructor(e,n,r,s={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=s,this.history=i,this.sendPromise=Promise.resolve(),PZ(i)}async sendMessage(e){var n;await this.sendPromise;const r=ui(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,o;const c=(o=(i=(await s).candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content,u=c?[c]:[];this.recordHistory(r,u)})(),await this.sendPromise,s}async sendMessageStream(e){var n;await this.sendPromise;const r=ui(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const i=await s;return this.processStreamResponse(i,r)}getHistory(e=!1){return e?AZ(this.history):this.history}processStreamResponse(e,n){var r,s;return qv(this,arguments,function*(){var o,l,c,u;const d=[];try{for(var h=!0,f=pE(e),m;m=yield Ns(f.next()),o=m.done,!o;h=!0){u=m.value,h=!1;const g=u;if(NZ(g)){const x=(s=(r=g.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;x!==void 0&&d.push(x)}yield yield Ns(g)}}catch(g){l={error:g}}finally{try{!h&&!o&&(c=f.return)&&(yield Ns(c.call(f)))}finally{if(l)throw l.error}}this.recordHistory(n,d)})}recordHistory(e,n){let r=[];n.length>0&&n.every(s=>s.role==="model")?r=n:r.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...r)}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function jZ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function DZ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],jZ(t,r,n)),n}function MZ(t,e){const n={},r=b(e,["details"]);r!=null&&S(n,["details"],r);const s=b(e,["message"]);s!=null&&S(n,["message"],s);const i=b(e,["code"]);return i!=null&&S(n,["code"],i),n}function LZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["mimeType"]);i!=null&&S(n,["mimeType"],i);const o=b(e,["sizeBytes"]);o!=null&&S(n,["sizeBytes"],o);const l=b(e,["createTime"]);l!=null&&S(n,["createTime"],l);const c=b(e,["expirationTime"]);c!=null&&S(n,["expirationTime"],c);const u=b(e,["updateTime"]);u!=null&&S(n,["updateTime"],u);const d=b(e,["sha256Hash"]);d!=null&&S(n,["sha256Hash"],d);const h=b(e,["uri"]);h!=null&&S(n,["uri"],h);const f=b(e,["downloadUri"]);f!=null&&S(n,["downloadUri"],f);const m=b(e,["state"]);m!=null&&S(n,["state"],m);const g=b(e,["source"]);g!=null&&S(n,["source"],g);const x=b(e,["videoMetadata"]);x!=null&&S(n,["videoMetadata"],x);const v=b(e,["error"]);return v!=null&&S(n,["error"],MZ(t,v)),n}function FZ(t,e){const n={},r=b(e,["file"]);r!=null&&S(n,["file"],LZ(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function OZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","file"],V$(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function VZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","file"],V$(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function $Z(t,e){const n={},r=b(e,["details"]);r!=null&&S(n,["details"],r);const s=b(e,["message"]);s!=null&&S(n,["message"],s);const i=b(e,["code"]);return i!=null&&S(n,["code"],i),n}function gE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["mimeType"]);i!=null&&S(n,["mimeType"],i);const o=b(e,["sizeBytes"]);o!=null&&S(n,["sizeBytes"],o);const l=b(e,["createTime"]);l!=null&&S(n,["createTime"],l);const c=b(e,["expirationTime"]);c!=null&&S(n,["expirationTime"],c);const u=b(e,["updateTime"]);u!=null&&S(n,["updateTime"],u);const d=b(e,["sha256Hash"]);d!=null&&S(n,["sha256Hash"],d);const h=b(e,["uri"]);h!=null&&S(n,["uri"],h);const f=b(e,["downloadUri"]);f!=null&&S(n,["downloadUri"],f);const m=b(e,["state"]);m!=null&&S(n,["state"],m);const g=b(e,["source"]);g!=null&&S(n,["source"],g);const x=b(e,["videoMetadata"]);x!=null&&S(n,["videoMetadata"],x);const v=b(e,["error"]);return v!=null&&S(n,["error"],$Z(t,v)),n}function UZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["files"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>gE(t,o))),S(n,["files"],i)}return n}function BZ(){return{}}function zZ(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let GZ=class extends xg{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new N0(Gh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>gE(this.apiClient,n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=DZ(this.apiClient,e);return i=qt("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=UZ(this.apiClient,c),d=new SZ;return Object.assign(d,u),d})}}async createInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=FZ(this.apiClient,e);return i=qt("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=BZ(),u=new CZ;return Object.assign(u,c),u})}}async get(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=OZ(this.apiClient,e);return i=qt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>gE(this.apiClient,c))}}async delete(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=VZ(this.apiClient,e);return i=qt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=zZ(),u=new EZ;return Object.assign(u,c),u})}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function WZ(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function HZ(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function qZ(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],WZ(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function KZ(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],HZ(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function YZ(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>qZ(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function JZ(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>KZ(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function XZ(){return{}}function QZ(){return{}}function ZZ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function eee(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function tee(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],ZZ(t,r)),n}function nee(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],eee(t,r)),n}function ree(){return{}}function see(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function iee(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],see(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function oee(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],iee(t,r)),n}function aee(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],XZ());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],tee(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function lee(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],QZ());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],nee(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],ree());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],oee(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function cee(t,e){const n={},r=b(e,["handle"]);if(r!=null&&S(n,["handle"],r),b(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return n}function uee(t,e){const n={},r=b(e,["handle"]);r!=null&&S(n,["handle"],r);const s=b(e,["transparent"]);return s!=null&&S(n,["transparent"],s),n}function Yj(){return{}}function Jj(){return{}}function dee(t,e){const n={},r=b(e,["disabled"]);r!=null&&S(n,["disabled"],r);const s=b(e,["startOfSpeechSensitivity"]);s!=null&&S(n,["startOfSpeechSensitivity"],s);const i=b(e,["endOfSpeechSensitivity"]);i!=null&&S(n,["endOfSpeechSensitivity"],i);const o=b(e,["prefixPaddingMs"]);o!=null&&S(n,["prefixPaddingMs"],o);const l=b(e,["silenceDurationMs"]);return l!=null&&S(n,["silenceDurationMs"],l),n}function hee(t,e){const n={},r=b(e,["disabled"]);r!=null&&S(n,["disabled"],r);const s=b(e,["startOfSpeechSensitivity"]);s!=null&&S(n,["startOfSpeechSensitivity"],s);const i=b(e,["endOfSpeechSensitivity"]);i!=null&&S(n,["endOfSpeechSensitivity"],i);const o=b(e,["prefixPaddingMs"]);o!=null&&S(n,["prefixPaddingMs"],o);const l=b(e,["silenceDurationMs"]);return l!=null&&S(n,["silenceDurationMs"],l),n}function fee(t,e){const n={},r=b(e,["automaticActivityDetection"]);r!=null&&S(n,["automaticActivityDetection"],dee(t,r));const s=b(e,["activityHandling"]);s!=null&&S(n,["activityHandling"],s);const i=b(e,["turnCoverage"]);return i!=null&&S(n,["turnCoverage"],i),n}function mee(t,e){const n={},r=b(e,["automaticActivityDetection"]);r!=null&&S(n,["automaticActivityDetection"],hee(t,r));const s=b(e,["activityHandling"]);s!=null&&S(n,["activityHandling"],s);const i=b(e,["turnCoverage"]);return i!=null&&S(n,["turnCoverage"],i),n}function pee(t,e){const n={},r=b(e,["targetTokens"]);return r!=null&&S(n,["targetTokens"],r),n}function gee(t,e){const n={},r=b(e,["targetTokens"]);return r!=null&&S(n,["targetTokens"],r),n}function yee(t,e){const n={},r=b(e,["triggerTokens"]);r!=null&&S(n,["triggerTokens"],r);const s=b(e,["slidingWindow"]);return s!=null&&S(n,["slidingWindow"],pee(t,s)),n}function xee(t,e){const n={},r=b(e,["triggerTokens"]);r!=null&&S(n,["triggerTokens"],r);const s=b(e,["slidingWindow"]);return s!=null&&S(n,["slidingWindow"],gee(t,s)),n}function vee(t,e,n){const r={},s=b(e,["generationConfig"]);n!==void 0&&s!=null&&S(n,["setup","generationConfig"],s);const i=b(e,["responseModalities"]);n!==void 0&&i!=null&&S(n,["setup","generationConfig","responseModalities"],i);const o=b(e,["temperature"]);n!==void 0&&o!=null&&S(n,["setup","generationConfig","temperature"],o);const l=b(e,["topP"]);n!==void 0&&l!=null&&S(n,["setup","generationConfig","topP"],l);const c=b(e,["topK"]);n!==void 0&&c!=null&&S(n,["setup","generationConfig","topK"],c);const u=b(e,["maxOutputTokens"]);n!==void 0&&u!=null&&S(n,["setup","generationConfig","maxOutputTokens"],u);const d=b(e,["mediaResolution"]);n!==void 0&&d!=null&&S(n,["setup","generationConfig","mediaResolution"],d);const h=b(e,["seed"]);n!==void 0&&h!=null&&S(n,["setup","generationConfig","seed"],h);const f=b(e,["speechConfig"]);n!==void 0&&f!=null&&S(n,["setup","generationConfig","speechConfig"],f);const m=b(e,["systemInstruction"]);n!==void 0&&m!=null&&S(n,["setup","systemInstruction"],YZ(t,ui(t,m)));const g=b(e,["tools"]);if(n!==void 0&&g!=null){let T=I0(t,g);Array.isArray(T)&&(T=T.map(R=>aee(t,T0(t,R)))),S(n,["setup","tools"],T)}const x=b(e,["sessionResumption"]);n!==void 0&&x!=null&&S(n,["setup","sessionResumption"],cee(t,x));const v=b(e,["inputAudioTranscription"]);n!==void 0&&v!=null&&S(n,["setup","inputAudioTranscription"],Yj());const w=b(e,["outputAudioTranscription"]);n!==void 0&&w!=null&&S(n,["setup","outputAudioTranscription"],Yj());const _=b(e,["realtimeInputConfig"]);n!==void 0&&_!=null&&S(n,["setup","realtimeInputConfig"],fee(t,_));const C=b(e,["contextWindowCompression"]);return n!==void 0&&C!=null&&S(n,["setup","contextWindowCompression"],yee(t,C)),r}function wee(t,e,n){const r={},s=b(e,["generationConfig"]);n!==void 0&&s!=null&&S(n,["setup","generationConfig"],s);const i=b(e,["responseModalities"]);n!==void 0&&i!=null&&S(n,["setup","generationConfig","responseModalities"],i);const o=b(e,["temperature"]);n!==void 0&&o!=null&&S(n,["setup","generationConfig","temperature"],o);const l=b(e,["topP"]);n!==void 0&&l!=null&&S(n,["setup","generationConfig","topP"],l);const c=b(e,["topK"]);n!==void 0&&c!=null&&S(n,["setup","generationConfig","topK"],c);const u=b(e,["maxOutputTokens"]);n!==void 0&&u!=null&&S(n,["setup","generationConfig","maxOutputTokens"],u);const d=b(e,["mediaResolution"]);n!==void 0&&d!=null&&S(n,["setup","generationConfig","mediaResolution"],d);const h=b(e,["seed"]);n!==void 0&&h!=null&&S(n,["setup","generationConfig","seed"],h);const f=b(e,["speechConfig"]);n!==void 0&&f!=null&&S(n,["setup","generationConfig","speechConfig"],f);const m=b(e,["systemInstruction"]);n!==void 0&&m!=null&&S(n,["setup","systemInstruction"],JZ(t,ui(t,m)));const g=b(e,["tools"]);if(n!==void 0&&g!=null){let T=I0(t,g);Array.isArray(T)&&(T=T.map(R=>lee(t,T0(t,R)))),S(n,["setup","tools"],T)}const x=b(e,["sessionResumption"]);n!==void 0&&x!=null&&S(n,["setup","sessionResumption"],uee(t,x));const v=b(e,["inputAudioTranscription"]);n!==void 0&&v!=null&&S(n,["setup","inputAudioTranscription"],Jj());const w=b(e,["outputAudioTranscription"]);n!==void 0&&w!=null&&S(n,["setup","outputAudioTranscription"],Jj());const _=b(e,["realtimeInputConfig"]);n!==void 0&&_!=null&&S(n,["setup","realtimeInputConfig"],mee(t,_));const C=b(e,["contextWindowCompression"]);return n!==void 0&&C!=null&&S(n,["setup","contextWindowCompression"],xee(t,C)),r}function bee(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["setup","model"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],vee(t,s,n)),n}function _ee(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["setup","model"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],wee(t,s,n)),n}function See(){return{}}function Cee(){return{}}function Eee(){return{}}function Tee(){return{}}function Iee(t,e){const n={},r=b(e,["media"]);r!=null&&S(n,["mediaChunks"],j$(t,r));const s=b(e,["audio"]);s!=null&&S(n,["audio"],TQ(t,s));const i=b(e,["audioStreamEnd"]);i!=null&&S(n,["audioStreamEnd"],i);const o=b(e,["video"]);o!=null&&S(n,["video"],EQ(t,o));const l=b(e,["text"]);return l!=null&&S(n,["text"],l),b(e,["activityStart"])!=null&&S(n,["activityStart"],See()),b(e,["activityEnd"])!=null&&S(n,["activityEnd"],Eee()),n}function Nee(t,e){const n={},r=b(e,["media"]);if(r!=null&&S(n,["mediaChunks"],j$(t,r)),b(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=b(e,["audioStreamEnd"]);if(s!=null&&S(n,["audioStreamEnd"],s),b(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(b(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return b(e,["activityStart"])!=null&&S(n,["activityStart"],Cee()),b(e,["activityEnd"])!=null&&S(n,["activityEnd"],Tee()),n}function Pee(){return{}}function Aee(){return{}}function kee(t,e){const n={},r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function Ree(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function jee(t,e){const n={},r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],kee(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function Dee(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],Ree(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function Mee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>jee(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function Lee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Dee(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function Xj(t,e){const n={},r=b(e,["text"]);r!=null&&S(n,["text"],r);const s=b(e,["finished"]);return s!=null&&S(n,["finished"],s),n}function Qj(t,e){const n={},r=b(e,["text"]);r!=null&&S(n,["text"],r);const s=b(e,["finished"]);return s!=null&&S(n,["finished"],s),n}function Fee(t,e){const n={},r=b(e,["modelTurn"]);r!=null&&S(n,["modelTurn"],Mee(t,r));const s=b(e,["turnComplete"]);s!=null&&S(n,["turnComplete"],s);const i=b(e,["interrupted"]);i!=null&&S(n,["interrupted"],i);const o=b(e,["groundingMetadata"]);o!=null&&S(n,["groundingMetadata"],o);const l=b(e,["generationComplete"]);l!=null&&S(n,["generationComplete"],l);const c=b(e,["inputTranscription"]);c!=null&&S(n,["inputTranscription"],Xj(t,c));const u=b(e,["outputTranscription"]);return u!=null&&S(n,["outputTranscription"],Xj(t,u)),n}function Oee(t,e){const n={},r=b(e,["modelTurn"]);r!=null&&S(n,["modelTurn"],Lee(t,r));const s=b(e,["turnComplete"]);s!=null&&S(n,["turnComplete"],s);const i=b(e,["interrupted"]);i!=null&&S(n,["interrupted"],i);const o=b(e,["groundingMetadata"]);o!=null&&S(n,["groundingMetadata"],o);const l=b(e,["generationComplete"]);l!=null&&S(n,["generationComplete"],l);const c=b(e,["inputTranscription"]);c!=null&&S(n,["inputTranscription"],Qj(t,c));const u=b(e,["outputTranscription"]);return u!=null&&S(n,["outputTranscription"],Qj(t,u)),n}function Vee(t,e){const n={},r=b(e,["id"]);r!=null&&S(n,["id"],r);const s=b(e,["args"]);s!=null&&S(n,["args"],s);const i=b(e,["name"]);return i!=null&&S(n,["name"],i),n}function $ee(t,e){const n={},r=b(e,["args"]);r!=null&&S(n,["args"],r);const s=b(e,["name"]);return s!=null&&S(n,["name"],s),n}function Uee(t,e){const n={},r=b(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>Vee(t,i))),S(n,["functionCalls"],s)}return n}function Bee(t,e){const n={},r=b(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>$ee(t,i))),S(n,["functionCalls"],s)}return n}function zee(t,e){const n={},r=b(e,["ids"]);return r!=null&&S(n,["ids"],r),n}function Gee(t,e){const n={},r=b(e,["ids"]);return r!=null&&S(n,["ids"],r),n}function Fy(t,e){const n={},r=b(e,["modality"]);r!=null&&S(n,["modality"],r);const s=b(e,["tokenCount"]);return s!=null&&S(n,["tokenCount"],s),n}function Oy(t,e){const n={},r=b(e,["modality"]);r!=null&&S(n,["modality"],r);const s=b(e,["tokenCount"]);return s!=null&&S(n,["tokenCount"],s),n}function Wee(t,e){const n={},r=b(e,["promptTokenCount"]);r!=null&&S(n,["promptTokenCount"],r);const s=b(e,["cachedContentTokenCount"]);s!=null&&S(n,["cachedContentTokenCount"],s);const i=b(e,["responseTokenCount"]);i!=null&&S(n,["responseTokenCount"],i);const o=b(e,["toolUsePromptTokenCount"]);o!=null&&S(n,["toolUsePromptTokenCount"],o);const l=b(e,["thoughtsTokenCount"]);l!=null&&S(n,["thoughtsTokenCount"],l);const c=b(e,["totalTokenCount"]);c!=null&&S(n,["totalTokenCount"],c);const u=b(e,["promptTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>Fy(t,g))),S(n,["promptTokensDetails"],m)}const d=b(e,["cacheTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(g=>Fy(t,g))),S(n,["cacheTokensDetails"],m)}const h=b(e,["responseTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>Fy(t,g))),S(n,["responseTokensDetails"],m)}const f=b(e,["toolUsePromptTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>Fy(t,g))),S(n,["toolUsePromptTokensDetails"],m)}return n}function Hee(t,e){const n={},r=b(e,["promptTokenCount"]);r!=null&&S(n,["promptTokenCount"],r);const s=b(e,["cachedContentTokenCount"]);s!=null&&S(n,["cachedContentTokenCount"],s);const i=b(e,["candidatesTokenCount"]);i!=null&&S(n,["responseTokenCount"],i);const o=b(e,["toolUsePromptTokenCount"]);o!=null&&S(n,["toolUsePromptTokenCount"],o);const l=b(e,["thoughtsTokenCount"]);l!=null&&S(n,["thoughtsTokenCount"],l);const c=b(e,["totalTokenCount"]);c!=null&&S(n,["totalTokenCount"],c);const u=b(e,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(x=>Oy(t,x))),S(n,["promptTokensDetails"],g)}const d=b(e,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(x=>Oy(t,x))),S(n,["cacheTokensDetails"],g)}const h=b(e,["candidatesTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(x=>Oy(t,x))),S(n,["responseTokensDetails"],g)}const f=b(e,["toolUsePromptTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(x=>Oy(t,x))),S(n,["toolUsePromptTokensDetails"],g)}const m=b(e,["trafficType"]);return m!=null&&S(n,["trafficType"],m),n}function qee(t,e){const n={},r=b(e,["timeLeft"]);return r!=null&&S(n,["timeLeft"],r),n}function Kee(t,e){const n={},r=b(e,["timeLeft"]);return r!=null&&S(n,["timeLeft"],r),n}function Yee(t,e){const n={},r=b(e,["newHandle"]);r!=null&&S(n,["newHandle"],r);const s=b(e,["resumable"]);s!=null&&S(n,["resumable"],s);const i=b(e,["lastConsumedClientMessageIndex"]);return i!=null&&S(n,["lastConsumedClientMessageIndex"],i),n}function Jee(t,e){const n={},r=b(e,["newHandle"]);r!=null&&S(n,["newHandle"],r);const s=b(e,["resumable"]);s!=null&&S(n,["resumable"],s);const i=b(e,["lastConsumedClientMessageIndex"]);return i!=null&&S(n,["lastConsumedClientMessageIndex"],i),n}function Xee(t,e){const n={};b(e,["setupComplete"])!=null&&S(n,["setupComplete"],Pee());const s=b(e,["serverContent"]);s!=null&&S(n,["serverContent"],Fee(t,s));const i=b(e,["toolCall"]);i!=null&&S(n,["toolCall"],Uee(t,i));const o=b(e,["toolCallCancellation"]);o!=null&&S(n,["toolCallCancellation"],zee(t,o));const l=b(e,["usageMetadata"]);l!=null&&S(n,["usageMetadata"],Wee(t,l));const c=b(e,["goAway"]);c!=null&&S(n,["goAway"],qee(t,c));const u=b(e,["sessionResumptionUpdate"]);return u!=null&&S(n,["sessionResumptionUpdate"],Yee(t,u)),n}function Qee(t,e){const n={};b(e,["setupComplete"])!=null&&S(n,["setupComplete"],Aee());const s=b(e,["serverContent"]);s!=null&&S(n,["serverContent"],Oee(t,s));const i=b(e,["toolCall"]);i!=null&&S(n,["toolCall"],Bee(t,i));const o=b(e,["toolCallCancellation"]);o!=null&&S(n,["toolCallCancellation"],Gee(t,o));const l=b(e,["usageMetadata"]);l!=null&&S(n,["usageMetadata"],Hee(t,l));const c=b(e,["goAway"]);c!=null&&S(n,["goAway"],Kee(t,c));const u=b(e,["sessionResumptionUpdate"]);return u!=null&&S(n,["sessionResumptionUpdate"],Jee(t,u)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Zee(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function ete(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],Zee(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function P0(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>ete(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function tte(t,e){const n={};if(b(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=b(e,["category"]);r!=null&&S(n,["category"],r);const s=b(e,["threshold"]);return s!=null&&S(n,["threshold"],s),n}function nte(){return{}}function rte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function ste(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],rte(t,r)),n}function ite(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],nte());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],ste(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function ote(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function ate(t,e){const n={},r=b(e,["functionCallingConfig"]);if(r!=null&&S(n,["functionCallingConfig"],ote(t,r)),b(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function lte(t,e){const n={},r=b(e,["voiceName"]);return r!=null&&S(n,["voiceName"],r),n}function cte(t,e){const n={},r=b(e,["prebuiltVoiceConfig"]);return r!=null&&S(n,["prebuiltVoiceConfig"],lte(t,r)),n}function ute(t,e){const n={},r=b(e,["voiceConfig"]);r!=null&&S(n,["voiceConfig"],cte(t,r));const s=b(e,["languageCode"]);return s!=null&&S(n,["languageCode"],s),n}function dte(t,e){const n={},r=b(e,["includeThoughts"]);r!=null&&S(n,["includeThoughts"],r);const s=b(e,["thinkingBudget"]);return s!=null&&S(n,["thinkingBudget"],s),n}function hte(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],P0(t,ui(t,s)));const i=b(e,["temperature"]);i!=null&&S(r,["temperature"],i);const o=b(e,["topP"]);o!=null&&S(r,["topP"],o);const l=b(e,["topK"]);l!=null&&S(r,["topK"],l);const c=b(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const u=b(e,["maxOutputTokens"]);u!=null&&S(r,["maxOutputTokens"],u);const d=b(e,["stopSequences"]);d!=null&&S(r,["stopSequences"],d);const h=b(e,["responseLogprobs"]);h!=null&&S(r,["responseLogprobs"],h);const f=b(e,["logprobs"]);f!=null&&S(r,["logprobs"],f);const m=b(e,["presencePenalty"]);m!=null&&S(r,["presencePenalty"],m);const g=b(e,["frequencyPenalty"]);g!=null&&S(r,["frequencyPenalty"],g);const x=b(e,["seed"]);x!=null&&S(r,["seed"],x);const v=b(e,["responseMimeType"]);v!=null&&S(r,["responseMimeType"],v);const w=b(e,["responseSchema"]);if(w!=null&&S(r,["responseSchema"],L$(t,w)),b(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(b(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=b(e,["safetySettings"]);if(n!==void 0&&_!=null){let k=_;Array.isArray(k)&&(k=k.map(j=>tte(t,j))),S(n,["safetySettings"],k)}const C=b(e,["tools"]);if(n!==void 0&&C!=null){let k=I0(t,C);Array.isArray(k)&&(k=k.map(j=>ite(t,T0(t,j)))),S(n,["tools"],k)}const T=b(e,["toolConfig"]);if(n!==void 0&&T!=null&&S(n,["toolConfig"],ate(t,T)),b(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=b(e,["cachedContent"]);n!==void 0&&R!=null&&S(n,["cachedContent"],Mc(t,R));const A=b(e,["responseModalities"]);A!=null&&S(r,["responseModalities"],A);const E=b(e,["mediaResolution"]);E!=null&&S(r,["mediaResolution"],E);const I=b(e,["speechConfig"]);if(I!=null&&S(r,["speechConfig"],ute(t,F$(t,I))),b(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const N=b(e,["thinkingConfig"]);return N!=null&&S(r,["thinkingConfig"],dte(t,N)),r}function Zj(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);if(s!=null){let o=Dc(t,s);Array.isArray(o)&&(o=o.map(l=>P0(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["generationConfig"],hte(t,i,n)),n}function fte(t,e,n){const r={},s=b(e,["taskType"]);n!==void 0&&s!=null&&S(n,["requests[]","taskType"],s);const i=b(e,["title"]);n!==void 0&&i!=null&&S(n,["requests[]","title"],i);const o=b(e,["outputDimensionality"]);if(n!==void 0&&o!=null&&S(n,["requests[]","outputDimensionality"],o),b(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(b(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function mte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);s!=null&&S(n,["requests[]","content"],M$(t,s));const i=b(e,["config"]);i!=null&&S(n,["config"],fte(t,i,n));const o=b(e,["model"]);return o!==void 0&&S(n,["requests[]","model"],or(t,o)),n}function pte(t,e,n){const r={};if(b(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(b(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=b(e,["numberOfImages"]);n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s);const i=b(e,["aspectRatio"]);n!==void 0&&i!=null&&S(n,["parameters","aspectRatio"],i);const o=b(e,["guidanceScale"]);if(n!==void 0&&o!=null&&S(n,["parameters","guidanceScale"],o),b(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=b(e,["safetyFilterLevel"]);n!==void 0&&l!=null&&S(n,["parameters","safetySetting"],l);const c=b(e,["personGeneration"]);n!==void 0&&c!=null&&S(n,["parameters","personGeneration"],c);const u=b(e,["includeSafetyAttributes"]);n!==void 0&&u!=null&&S(n,["parameters","includeSafetyAttributes"],u);const d=b(e,["includeRaiReason"]);n!==void 0&&d!=null&&S(n,["parameters","includeRaiReason"],d);const h=b(e,["language"]);n!==void 0&&h!=null&&S(n,["parameters","language"],h);const f=b(e,["outputMimeType"]);n!==void 0&&f!=null&&S(n,["parameters","outputOptions","mimeType"],f);const m=b(e,["outputCompressionQuality"]);if(n!==void 0&&m!=null&&S(n,["parameters","outputOptions","compressionQuality"],m),b(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(b(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function gte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],pte(t,i,n)),n}function yte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function xte(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);n!==void 0&&o!=null&&S(n,["_query","filter"],o);const l=b(e,["queryBase"]);return n!==void 0&&l!=null&&S(n,["_url","models_url"],$$(t,l)),r}function vte(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],xte(t,r,n)),n}function wte(t,e,n){const r={},s=b(e,["displayName"]);n!==void 0&&s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);n!==void 0&&i!=null&&S(n,["description"],i);const o=b(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&S(n,["defaultCheckpointId"],o),r}function bte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],wte(t,s,n)),n}function _te(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Ste(t,e){const n={};if(b(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(b(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(b(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function Cte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);if(s!=null){let o=Dc(t,s);Array.isArray(o)&&(o=o.map(l=>P0(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],Ste(t,i)),n}function Ete(t,e){const n={};if(b(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=b(e,["imageBytes"]);r!=null&&S(n,["bytesBase64Encoded"],Lc(t,r));const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function Tte(t,e,n){const r={},s=b(e,["numberOfVideos"]);if(n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s),b(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(b(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=b(e,["durationSeconds"]);if(n!==void 0&&i!=null&&S(n,["parameters","durationSeconds"],i),b(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=b(e,["aspectRatio"]);if(n!==void 0&&o!=null&&S(n,["parameters","aspectRatio"],o),b(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=b(e,["personGeneration"]);if(n!==void 0&&l!=null&&S(n,["parameters","personGeneration"],l),b(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=b(e,["negativePrompt"]);if(n!==void 0&&c!=null&&S(n,["parameters","negativePrompt"],c),b(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Ite(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["image"]);i!=null&&S(n,["instances[0]","image"],Ete(t,i));const o=b(e,["config"]);return o!=null&&S(n,["config"],Tte(t,o,n)),n}function Nte(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Pte(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],Nte(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function wf(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Pte(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function Ate(t,e){const n={},r=b(e,["featureSelectionPreference"]);return r!=null&&S(n,["featureSelectionPreference"],r),n}function kte(t,e){const n={},r=b(e,["method"]);r!=null&&S(n,["method"],r);const s=b(e,["category"]);s!=null&&S(n,["category"],s);const i=b(e,["threshold"]);return i!=null&&S(n,["threshold"],i),n}function Rte(){return{}}function jte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function Dte(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],jte(t,r)),n}function Mte(){return{}}function Lte(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function Fte(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],Lte(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function Ote(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],Fte(t,r)),n}function z$(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],Rte());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],Dte(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],Mte());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],Ote(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function Vte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function $te(t,e){const n={},r=b(e,["latitude"]);r!=null&&S(n,["latitude"],r);const s=b(e,["longitude"]);return s!=null&&S(n,["longitude"],s),n}function Ute(t,e){const n={},r=b(e,["latLng"]);return r!=null&&S(n,["latLng"],$te(t,r)),n}function Bte(t,e){const n={},r=b(e,["functionCallingConfig"]);r!=null&&S(n,["functionCallingConfig"],Vte(t,r));const s=b(e,["retrievalConfig"]);return s!=null&&S(n,["retrievalConfig"],Ute(t,s)),n}function zte(t,e){const n={},r=b(e,["voiceName"]);return r!=null&&S(n,["voiceName"],r),n}function Gte(t,e){const n={},r=b(e,["prebuiltVoiceConfig"]);return r!=null&&S(n,["prebuiltVoiceConfig"],zte(t,r)),n}function Wte(t,e){const n={},r=b(e,["voiceConfig"]);r!=null&&S(n,["voiceConfig"],Gte(t,r));const s=b(e,["languageCode"]);return s!=null&&S(n,["languageCode"],s),n}function Hte(t,e){const n={},r=b(e,["includeThoughts"]);r!=null&&S(n,["includeThoughts"],r);const s=b(e,["thinkingBudget"]);return s!=null&&S(n,["thinkingBudget"],s),n}function qte(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],wf(t,ui(t,s)));const i=b(e,["temperature"]);i!=null&&S(r,["temperature"],i);const o=b(e,["topP"]);o!=null&&S(r,["topP"],o);const l=b(e,["topK"]);l!=null&&S(r,["topK"],l);const c=b(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const u=b(e,["maxOutputTokens"]);u!=null&&S(r,["maxOutputTokens"],u);const d=b(e,["stopSequences"]);d!=null&&S(r,["stopSequences"],d);const h=b(e,["responseLogprobs"]);h!=null&&S(r,["responseLogprobs"],h);const f=b(e,["logprobs"]);f!=null&&S(r,["logprobs"],f);const m=b(e,["presencePenalty"]);m!=null&&S(r,["presencePenalty"],m);const g=b(e,["frequencyPenalty"]);g!=null&&S(r,["frequencyPenalty"],g);const x=b(e,["seed"]);x!=null&&S(r,["seed"],x);const v=b(e,["responseMimeType"]);v!=null&&S(r,["responseMimeType"],v);const w=b(e,["responseSchema"]);w!=null&&S(r,["responseSchema"],L$(t,w));const _=b(e,["routingConfig"]);_!=null&&S(r,["routingConfig"],_);const C=b(e,["modelSelectionConfig"]);C!=null&&S(r,["modelConfig"],Ate(t,C));const T=b(e,["safetySettings"]);if(n!==void 0&&T!=null){let G=T;Array.isArray(G)&&(G=G.map(B=>kte(t,B))),S(n,["safetySettings"],G)}const R=b(e,["tools"]);if(n!==void 0&&R!=null){let G=I0(t,R);Array.isArray(G)&&(G=G.map(B=>z$(t,T0(t,B)))),S(n,["tools"],G)}const A=b(e,["toolConfig"]);n!==void 0&&A!=null&&S(n,["toolConfig"],Bte(t,A));const E=b(e,["labels"]);n!==void 0&&E!=null&&S(n,["labels"],E);const I=b(e,["cachedContent"]);n!==void 0&&I!=null&&S(n,["cachedContent"],Mc(t,I));const N=b(e,["responseModalities"]);N!=null&&S(r,["responseModalities"],N);const k=b(e,["mediaResolution"]);k!=null&&S(r,["mediaResolution"],k);const j=b(e,["speechConfig"]);j!=null&&S(r,["speechConfig"],Wte(t,F$(t,j)));const D=b(e,["audioTimestamp"]);D!=null&&S(r,["audioTimestamp"],D);const L=b(e,["thinkingConfig"]);return L!=null&&S(r,["thinkingConfig"],Hte(t,L)),r}function e2(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);if(s!=null){let o=Dc(t,s);Array.isArray(o)&&(o=o.map(l=>wf(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["generationConfig"],qte(t,i,n)),n}function Kte(t,e,n){const r={},s=b(e,["taskType"]);n!==void 0&&s!=null&&S(n,["instances[]","task_type"],s);const i=b(e,["title"]);n!==void 0&&i!=null&&S(n,["instances[]","title"],i);const o=b(e,["outputDimensionality"]);n!==void 0&&o!=null&&S(n,["parameters","outputDimensionality"],o);const l=b(e,["mimeType"]);n!==void 0&&l!=null&&S(n,["instances[]","mimeType"],l);const c=b(e,["autoTruncate"]);return n!==void 0&&c!=null&&S(n,["parameters","autoTruncate"],c),r}function Yte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);s!=null&&S(n,["instances[]","content"],M$(t,s));const i=b(e,["config"]);return i!=null&&S(n,["config"],Kte(t,i,n)),n}function Jte(t,e,n){const r={},s=b(e,["outputGcsUri"]);n!==void 0&&s!=null&&S(n,["parameters","storageUri"],s);const i=b(e,["negativePrompt"]);n!==void 0&&i!=null&&S(n,["parameters","negativePrompt"],i);const o=b(e,["numberOfImages"]);n!==void 0&&o!=null&&S(n,["parameters","sampleCount"],o);const l=b(e,["aspectRatio"]);n!==void 0&&l!=null&&S(n,["parameters","aspectRatio"],l);const c=b(e,["guidanceScale"]);n!==void 0&&c!=null&&S(n,["parameters","guidanceScale"],c);const u=b(e,["seed"]);n!==void 0&&u!=null&&S(n,["parameters","seed"],u);const d=b(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&S(n,["parameters","safetySetting"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&S(n,["parameters","includeSafetyAttributes"],f);const m=b(e,["includeRaiReason"]);n!==void 0&&m!=null&&S(n,["parameters","includeRaiReason"],m);const g=b(e,["language"]);n!==void 0&&g!=null&&S(n,["parameters","language"],g);const x=b(e,["outputMimeType"]);n!==void 0&&x!=null&&S(n,["parameters","outputOptions","mimeType"],x);const v=b(e,["outputCompressionQuality"]);n!==void 0&&v!=null&&S(n,["parameters","outputOptions","compressionQuality"],v);const w=b(e,["addWatermark"]);n!==void 0&&w!=null&&S(n,["parameters","addWatermark"],w);const _=b(e,["enhancePrompt"]);return n!==void 0&&_!=null&&S(n,["parameters","enhancePrompt"],_),r}function Xte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],Jte(t,i,n)),n}function hI(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["gcsUri"],r);const s=b(e,["imageBytes"]);s!=null&&S(n,["bytesBase64Encoded"],Lc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Qte(t,e){const n={},r=b(e,["maskMode"]);r!=null&&S(n,["maskMode"],r);const s=b(e,["segmentationClasses"]);s!=null&&S(n,["maskClasses"],s);const i=b(e,["maskDilation"]);return i!=null&&S(n,["dilation"],i),n}function Zte(t,e){const n={},r=b(e,["controlType"]);r!=null&&S(n,["controlType"],r);const s=b(e,["enableControlImageComputation"]);return s!=null&&S(n,["computeControl"],s),n}function ene(t,e){const n={},r=b(e,["styleDescription"]);return r!=null&&S(n,["styleDescription"],r),n}function tne(t,e){const n={},r=b(e,["subjectType"]);r!=null&&S(n,["subjectType"],r);const s=b(e,["subjectDescription"]);return s!=null&&S(n,["subjectDescription"],s),n}function nne(t,e){const n={},r=b(e,["referenceImage"]);r!=null&&S(n,["referenceImage"],hI(t,r));const s=b(e,["referenceId"]);s!=null&&S(n,["referenceId"],s);const i=b(e,["referenceType"]);i!=null&&S(n,["referenceType"],i);const o=b(e,["maskImageConfig"]);o!=null&&S(n,["maskImageConfig"],Qte(t,o));const l=b(e,["controlImageConfig"]);l!=null&&S(n,["controlImageConfig"],Zte(t,l));const c=b(e,["styleImageConfig"]);c!=null&&S(n,["styleImageConfig"],ene(t,c));const u=b(e,["subjectImageConfig"]);return u!=null&&S(n,["subjectImageConfig"],tne(t,u)),n}function rne(t,e,n){const r={},s=b(e,["outputGcsUri"]);n!==void 0&&s!=null&&S(n,["parameters","storageUri"],s);const i=b(e,["negativePrompt"]);n!==void 0&&i!=null&&S(n,["parameters","negativePrompt"],i);const o=b(e,["numberOfImages"]);n!==void 0&&o!=null&&S(n,["parameters","sampleCount"],o);const l=b(e,["aspectRatio"]);n!==void 0&&l!=null&&S(n,["parameters","aspectRatio"],l);const c=b(e,["guidanceScale"]);n!==void 0&&c!=null&&S(n,["parameters","guidanceScale"],c);const u=b(e,["seed"]);n!==void 0&&u!=null&&S(n,["parameters","seed"],u);const d=b(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&S(n,["parameters","safetySetting"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&S(n,["parameters","includeSafetyAttributes"],f);const m=b(e,["includeRaiReason"]);n!==void 0&&m!=null&&S(n,["parameters","includeRaiReason"],m);const g=b(e,["language"]);n!==void 0&&g!=null&&S(n,["parameters","language"],g);const x=b(e,["outputMimeType"]);n!==void 0&&x!=null&&S(n,["parameters","outputOptions","mimeType"],x);const v=b(e,["outputCompressionQuality"]);n!==void 0&&v!=null&&S(n,["parameters","outputOptions","compressionQuality"],v);const w=b(e,["editMode"]);n!==void 0&&w!=null&&S(n,["parameters","editMode"],w);const _=b(e,["baseSteps"]);return n!==void 0&&_!=null&&S(n,["parameters","editConfig","baseSteps"],_),r}function sne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["referenceImages"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>nne(t,c))),S(n,["instances[0]","referenceImages"],l)}const o=b(e,["config"]);return o!=null&&S(n,["config"],rne(t,o,n)),n}function ine(t,e,n){const r={},s=b(e,["includeRaiReason"]);n!==void 0&&s!=null&&S(n,["parameters","includeRaiReason"],s);const i=b(e,["outputMimeType"]);n!==void 0&&i!=null&&S(n,["parameters","outputOptions","mimeType"],i);const o=b(e,["outputCompressionQuality"]);n!==void 0&&o!=null&&S(n,["parameters","outputOptions","compressionQuality"],o);const l=b(e,["numberOfImages"]);n!==void 0&&l!=null&&S(n,["parameters","sampleCount"],l);const c=b(e,["mode"]);return n!==void 0&&c!=null&&S(n,["parameters","mode"],c),r}function one(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["image"]);s!=null&&S(n,["instances[0]","image"],hI(t,s));const i=b(e,["upscaleFactor"]);i!=null&&S(n,["parameters","upscaleConfig","upscaleFactor"],i);const o=b(e,["config"]);return o!=null&&S(n,["config"],ine(t,o,n)),n}function ane(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function lne(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);n!==void 0&&o!=null&&S(n,["_query","filter"],o);const l=b(e,["queryBase"]);return n!==void 0&&l!=null&&S(n,["_url","models_url"],$$(t,l)),r}function cne(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],lne(t,r,n)),n}function une(t,e,n){const r={},s=b(e,["displayName"]);n!==void 0&&s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);n!==void 0&&i!=null&&S(n,["description"],i);const o=b(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&S(n,["defaultCheckpointId"],o),r}function dne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],une(t,s,n)),n}function hne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],or(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function fne(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],wf(t,ui(t,s)));const i=b(e,["tools"]);if(n!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>z$(t,c))),S(n,["tools"],l)}const o=b(e,["generationConfig"]);return n!==void 0&&o!=null&&S(n,["generationConfig"],o),r}function mne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);if(s!=null){let o=Dc(t,s);Array.isArray(o)&&(o=o.map(l=>wf(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],fne(t,i,n)),n}function pne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["contents"]);if(s!=null){let o=Dc(t,s);Array.isArray(o)&&(o=o.map(l=>wf(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],i),n}function gne(t,e,n){const r={},s=b(e,["numberOfVideos"]);n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s);const i=b(e,["outputGcsUri"]);n!==void 0&&i!=null&&S(n,["parameters","storageUri"],i);const o=b(e,["fps"]);n!==void 0&&o!=null&&S(n,["parameters","fps"],o);const l=b(e,["durationSeconds"]);n!==void 0&&l!=null&&S(n,["parameters","durationSeconds"],l);const c=b(e,["seed"]);n!==void 0&&c!=null&&S(n,["parameters","seed"],c);const u=b(e,["aspectRatio"]);n!==void 0&&u!=null&&S(n,["parameters","aspectRatio"],u);const d=b(e,["resolution"]);n!==void 0&&d!=null&&S(n,["parameters","resolution"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["pubsubTopic"]);n!==void 0&&f!=null&&S(n,["parameters","pubsubTopic"],f);const m=b(e,["negativePrompt"]);n!==void 0&&m!=null&&S(n,["parameters","negativePrompt"],m);const g=b(e,["enhancePrompt"]);return n!==void 0&&g!=null&&S(n,["parameters","enhancePrompt"],g),r}function yne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],or(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["image"]);i!=null&&S(n,["instances[0]","image"],hI(t,i));const o=b(e,["config"]);return o!=null&&S(n,["config"],gne(t,o,n)),n}function xne(t,e){const n={},r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function vne(t,e){const n={},r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],xne(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function wne(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>vne(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function bne(t,e){const n={},r=b(e,["citationSources"]);return r!=null&&S(n,["citations"],r),n}function _ne(t,e){const n={},r=b(e,["content"]);r!=null&&S(n,["content"],wne(t,r));const s=b(e,["citationMetadata"]);s!=null&&S(n,["citationMetadata"],bne(t,s));const i=b(e,["tokenCount"]);i!=null&&S(n,["tokenCount"],i);const o=b(e,["finishReason"]);o!=null&&S(n,["finishReason"],o);const l=b(e,["avgLogprobs"]);l!=null&&S(n,["avgLogprobs"],l);const c=b(e,["groundingMetadata"]);c!=null&&S(n,["groundingMetadata"],c);const u=b(e,["index"]);u!=null&&S(n,["index"],u);const d=b(e,["logprobsResult"]);d!=null&&S(n,["logprobsResult"],d);const h=b(e,["safetyRatings"]);return h!=null&&S(n,["safetyRatings"],h),n}function t2(t,e){const n={},r=b(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>_ne(t,c))),S(n,["candidates"],l)}const s=b(e,["modelVersion"]);s!=null&&S(n,["modelVersion"],s);const i=b(e,["promptFeedback"]);i!=null&&S(n,["promptFeedback"],i);const o=b(e,["usageMetadata"]);return o!=null&&S(n,["usageMetadata"],o),n}function Sne(t,e){const n={},r=b(e,["values"]);return r!=null&&S(n,["values"],r),n}function Cne(){return{}}function Ene(t,e){const n={},r=b(e,["embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Sne(t,o))),S(n,["embeddings"],i)}return b(e,["metadata"])!=null&&S(n,["metadata"],Cne()),n}function Tne(t,e){const n={},r=b(e,["bytesBase64Encoded"]);r!=null&&S(n,["imageBytes"],Lc(t,r));const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function G$(t,e){const n={},r=b(e,["safetyAttributes","categories"]);r!=null&&S(n,["categories"],r);const s=b(e,["safetyAttributes","scores"]);s!=null&&S(n,["scores"],s);const i=b(e,["contentType"]);return i!=null&&S(n,["contentType"],i),n}function Ine(t,e){const n={},r=b(e,["_self"]);r!=null&&S(n,["image"],Tne(t,r));const s=b(e,["raiFilteredReason"]);s!=null&&S(n,["raiFilteredReason"],s);const i=b(e,["_self"]);return i!=null&&S(n,["safetyAttributes"],G$(t,i)),n}function Nne(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Ine(t,o))),S(n,["generatedImages"],i)}const s=b(e,["positivePromptSafetyAttributes"]);return s!=null&&S(n,["positivePromptSafetyAttributes"],G$(t,s)),n}function Pne(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["updateTime"]);return i!=null&&S(n,["updateTime"],i),n}function yE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);i!=null&&S(n,["description"],i);const o=b(e,["version"]);o!=null&&S(n,["version"],o);const l=b(e,["_self"]);l!=null&&S(n,["tunedModelInfo"],Pne(t,l));const c=b(e,["inputTokenLimit"]);c!=null&&S(n,["inputTokenLimit"],c);const u=b(e,["outputTokenLimit"]);u!=null&&S(n,["outputTokenLimit"],u);const d=b(e,["supportedGenerationMethods"]);return d!=null&&S(n,["supportedActions"],d),n}function Ane(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["_self"]);if(s!=null){let i=U$(t,s);Array.isArray(i)&&(i=i.map(o=>yE(t,o))),S(n,["models"],i)}return n}function kne(){return{}}function Rne(t,e){const n={},r=b(e,["totalTokens"]);r!=null&&S(n,["totalTokens"],r);const s=b(e,["cachedContentTokenCount"]);return s!=null&&S(n,["cachedContentTokenCount"],s),n}function jne(t,e){const n={},r=b(e,["video","uri"]);r!=null&&S(n,["uri"],r);const s=b(e,["video","encodedVideo"]);s!=null&&S(n,["videoBytes"],Lc(t,s));const i=b(e,["encoding"]);return i!=null&&S(n,["mimeType"],i),n}function Dne(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],jne(t,r)),n}function Mne(t,e){const n={},r=b(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Dne(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function Lne(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response","generateVideoResponse"]);return l!=null&&S(n,["response"],Mne(t,l)),n}function Fne(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function One(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],Fne(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function Vne(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>One(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function $ne(t,e){const n={},r=b(e,["citations"]);return r!=null&&S(n,["citations"],r),n}function Une(t,e){const n={},r=b(e,["content"]);r!=null&&S(n,["content"],Vne(t,r));const s=b(e,["citationMetadata"]);s!=null&&S(n,["citationMetadata"],$ne(t,s));const i=b(e,["finishMessage"]);i!=null&&S(n,["finishMessage"],i);const o=b(e,["finishReason"]);o!=null&&S(n,["finishReason"],o);const l=b(e,["avgLogprobs"]);l!=null&&S(n,["avgLogprobs"],l);const c=b(e,["groundingMetadata"]);c!=null&&S(n,["groundingMetadata"],c);const u=b(e,["index"]);u!=null&&S(n,["index"],u);const d=b(e,["logprobsResult"]);d!=null&&S(n,["logprobsResult"],d);const h=b(e,["safetyRatings"]);return h!=null&&S(n,["safetyRatings"],h),n}function n2(t,e){const n={},r=b(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>Une(t,d))),S(n,["candidates"],u)}const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["responseId"]);i!=null&&S(n,["responseId"],i);const o=b(e,["modelVersion"]);o!=null&&S(n,["modelVersion"],o);const l=b(e,["promptFeedback"]);l!=null&&S(n,["promptFeedback"],l);const c=b(e,["usageMetadata"]);return c!=null&&S(n,["usageMetadata"],c),n}function Bne(t,e){const n={},r=b(e,["truncated"]);r!=null&&S(n,["truncated"],r);const s=b(e,["token_count"]);return s!=null&&S(n,["tokenCount"],s),n}function zne(t,e){const n={},r=b(e,["values"]);r!=null&&S(n,["values"],r);const s=b(e,["statistics"]);return s!=null&&S(n,["statistics"],Bne(t,s)),n}function Gne(t,e){const n={},r=b(e,["billableCharacterCount"]);return r!=null&&S(n,["billableCharacterCount"],r),n}function Wne(t,e){const n={},r=b(e,["predictions[]","embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>zne(t,o))),S(n,["embeddings"],i)}const s=b(e,["metadata"]);return s!=null&&S(n,["metadata"],Gne(t,s)),n}function Hne(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["gcsUri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["imageBytes"],Lc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function W$(t,e){const n={},r=b(e,["safetyAttributes","categories"]);r!=null&&S(n,["categories"],r);const s=b(e,["safetyAttributes","scores"]);s!=null&&S(n,["scores"],s);const i=b(e,["contentType"]);return i!=null&&S(n,["contentType"],i),n}function fI(t,e){const n={},r=b(e,["_self"]);r!=null&&S(n,["image"],Hne(t,r));const s=b(e,["raiFilteredReason"]);s!=null&&S(n,["raiFilteredReason"],s);const i=b(e,["_self"]);i!=null&&S(n,["safetyAttributes"],W$(t,i));const o=b(e,["prompt"]);return o!=null&&S(n,["enhancedPrompt"],o),n}function qne(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>fI(t,o))),S(n,["generatedImages"],i)}const s=b(e,["positivePromptSafetyAttributes"]);return s!=null&&S(n,["positivePromptSafetyAttributes"],W$(t,s)),n}function Kne(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>fI(t,i))),S(n,["generatedImages"],s)}return n}function Yne(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>fI(t,i))),S(n,["generatedImages"],s)}return n}function Jne(t,e){const n={},r=b(e,["endpoint"]);r!=null&&S(n,["name"],r);const s=b(e,["deployedModelId"]);return s!=null&&S(n,["deployedModelId"],s),n}function Xne(t,e){const n={},r=b(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["updateTime"]);return i!=null&&S(n,["updateTime"],i),n}function Qne(t,e){const n={},r=b(e,["checkpointId"]);r!=null&&S(n,["checkpointId"],r);const s=b(e,["epoch"]);s!=null&&S(n,["epoch"],s);const i=b(e,["step"]);return i!=null&&S(n,["step"],i),n}function xE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);i!=null&&S(n,["description"],i);const o=b(e,["versionId"]);o!=null&&S(n,["version"],o);const l=b(e,["deployedModels"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>Jne(t,m))),S(n,["endpoints"],f)}const c=b(e,["labels"]);c!=null&&S(n,["labels"],c);const u=b(e,["_self"]);u!=null&&S(n,["tunedModelInfo"],Xne(t,u));const d=b(e,["defaultCheckpointId"]);d!=null&&S(n,["defaultCheckpointId"],d);const h=b(e,["checkpoints"]);if(h!=null){let f=h;Array.isArray(f)&&(f=f.map(m=>Qne(t,m))),S(n,["checkpoints"],f)}return n}function Zne(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["_self"]);if(s!=null){let i=U$(t,s);Array.isArray(i)&&(i=i.map(o=>xE(t,o))),S(n,["models"],i)}return n}function ere(){return{}}function tre(t,e){const n={},r=b(e,["totalTokens"]);return r!=null&&S(n,["totalTokens"],r),n}function nre(t,e){const n={},r=b(e,["tokensInfo"]);return r!=null&&S(n,["tokensInfo"],r),n}function rre(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["uri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["videoBytes"],Lc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function sre(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],rre(t,r)),n}function ire(t,e){const n={},r=b(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>sre(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function ore(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response"]);return l!=null&&S(n,["response"],ire(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const are="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function lre(t,e,n){const r=new TZ;let s;if(n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),t.isVertexAI()){const i=Qee(t,s);Object.assign(r,i)}else{const i=Xee(t,s);Object.assign(r,i)}e(r)}class cre{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r,s,i;const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let c;const u=fre(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())c=`${o}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const T=this.apiClient.getApiKey();c=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateContent?key=${T}`}let d=()=>{};const h=new Promise(T=>{d=T}),f=e.callbacks,m=function(){var T;(T=f==null?void 0:f.onopen)===null||T===void 0||T.call(f),d({})},g=this.apiClient,x={onopen:m,onmessage:T=>{lre(g,f.onmessage,T)},onerror:(n=f==null?void 0:f.onerror)!==null&&n!==void 0?n:function(T){},onclose:(r=f==null?void 0:f.onclose)!==null&&r!==void 0?r:function(T){}},v=this.webSocketFactory.create(c,hre(u),x);v.connect(),await h;let w=or(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&w.startsWith("publishers/")){const T=this.apiClient.getProject(),R=this.apiClient.getLocation();w=`projects/${T}/locations/${R}/`+w}let _={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[wn.AUDIO]}:e.config.responseModalities=[wn.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const C={model:w,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?_=_ee(this.apiClient,C):_=bee(this.apiClient,C),delete _.config,v.send(JSON.stringify(_)),new dre(v,this.apiClient)}}const ure={turnComplete:!0};class dre{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Dc(e,n.turns),e.isVertexAI()?r=r.map(s=>wf(e,s)):r=r.map(s=>P0(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(are)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},ure),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Nee(this.apiClient,e)}:n={realtimeInput:Iee(this.apiClient,e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function hre(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function fre(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let mre=class extends xg{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>await this.generateContentInternal(n),this.generateContentStream=async n=>await this.generateContentStreamInternal(n),this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var s;let i;const o=[];if(r!=null&&r.generatedImages)for(const c of r.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?i=c==null?void 0:c.safetyAttributes:o.push(c);let l;return i?l={generatedImages:o,positivePromptSafetyAttributes:i}:l={generatedImages:o},l}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new N0(Gh.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async generateContentInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=e2(this.apiClient,e);return l=qt("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=n2(this.apiClient,d),f=new Ly;return Object.assign(f,h),f})}else{const u=Zj(this.apiClient,e);return l=qt("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=t2(this.apiClient,d),f=new Ly;return Object.assign(f,h),f})}}async generateContentStreamInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=e2(this.apiClient,e);l=qt("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(h){return qv(this,arguments,function*(){var f,m,g,x;try{for(var v=!0,w=pE(h),_;_=yield Ns(w.next()),f=_.done,!f;v=!0){x=_.value,v=!1;const T=n2(d,yield Ns(x.json())),R=new Ly;Object.assign(R,T),yield yield Ns(R)}}catch(C){m={error:C}}finally{try{!v&&!f&&(g=w.return)&&(yield Ns(g.call(w)))}finally{if(m)throw m.error}}})})}else{const u=Zj(this.apiClient,e);l=qt("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(h){return qv(this,arguments,function*(){var f,m,g,x;try{for(var v=!0,w=pE(h),_;_=yield Ns(w.next()),f=_.done,!f;v=!0){x=_.value,v=!1;const T=t2(d,yield Ns(x.json())),R=new Ly;Object.assign(R,T),yield yield Ns(R)}}catch(C){m={error:C}}finally{try{!v&&!f&&(g=w.return)&&(yield Ns(g.call(w)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Yte(this.apiClient,e);return l=qt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Wne(this.apiClient,d),f=new $j;return Object.assign(f,h),f})}else{const u=mte(this.apiClient,e);return l=qt("{model}:batchEmbedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Ene(this.apiClient,d),f=new $j;return Object.assign(f,h),f})}}async generateImagesInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Xte(this.apiClient,e);return l=qt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=qne(this.apiClient,d),f=new Uj;return Object.assign(f,h),f})}else{const u=gte(this.apiClient,e);return l=qt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Nne(this.apiClient,d),f=new Uj;return Object.assign(f,h),f})}}async editImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=sne(this.apiClient,e);return i=qt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=Kne(this.apiClient,c),d=new wZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=one(this.apiClient,e);return i=qt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=Yne(this.apiClient,c),d=new bZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=ane(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>xE(this.apiClient,d))}else{const u=yte(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>yE(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=cne(this.apiClient,e);return l=qt("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Zne(this.apiClient,d),f=new Bj;return Object.assign(f,h),f})}else{const u=vte(this.apiClient,e);return l=qt("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Ane(this.apiClient,d),f=new Bj;return Object.assign(f,h),f})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=dne(this.apiClient,e);return l=qt("{model}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>xE(this.apiClient,d))}else{const u=bte(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>yE(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=hne(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=ere(),h=new zj;return Object.assign(h,d),h})}else{const u=_te(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=kne(),h=new zj;return Object.assign(h,d),h})}}async countTokens(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=mne(this.apiClient,e);return l=qt("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=tre(this.apiClient,d),f=new Gj;return Object.assign(f,h),f})}else{const u=Cte(this.apiClient,e);return l=qt("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Rne(this.apiClient,d),f=new Gj;return Object.assign(f,h),f})}}async computeTokens(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=pne(this.apiClient,e);return i=qt("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=nre(this.apiClient,c),d=new _Z;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=yne(this.apiClient,e);return l=qt("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>ore(this.apiClient,d))}else{const u=Ite(this.apiClient,e);return l=qt("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Lne(this.apiClient,d))}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pre(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["_url","operationName"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function gre(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["_url","operationName"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function yre(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["operationName"],r);const s=b(e,["resourceName"]);s!=null&&S(n,["_url","resourceName"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],i),n}function xre(t,e){const n={},r=b(e,["video","uri"]);r!=null&&S(n,["uri"],r);const s=b(e,["video","encodedVideo"]);s!=null&&S(n,["videoBytes"],Lc(t,s));const i=b(e,["encoding"]);return i!=null&&S(n,["mimeType"],i),n}function vre(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],xre(t,r)),n}function wre(t,e){const n={},r=b(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>vre(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function bre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response","generateVideoResponse"]);return l!=null&&S(n,["response"],wre(t,l)),n}function _re(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["uri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["videoBytes"],Lc(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Sre(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],_re(t,r)),n}function Cre(t,e){const n={},r=b(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Sre(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function r2(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response"]);return l!=null&&S(n,["response"],Cre(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ere extends xg{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let i;return r&&"httpOptions"in r&&(i=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=gre(this.apiClient,e);return l=qt("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>r2(this.apiClient,d))}else{const u=pre(this.apiClient,e);return l=qt("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>bre(this.apiClient,d))}}async fetchPredictVideosOperationInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=yre(this.apiClient,e);return i=qt("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>r2(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Tre="Content-Type",Ire="X-Server-Timeout",Nre="User-Agent",Pre="x-goog-api-client",Are="0.14.1",kre=`google-genai-sdk/${Are}`,Rre="v1beta1",jre="v1beta",s2=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class H$ extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class vE extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class Dre{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Rre,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:jre,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const s=[this.getRequestUrlInternal(n)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.unaryApiCall(s,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[s,i]of Object.entries(n))typeof i=="object"?r[s]=Object.assign(Object.assign({},r[s]),i):i!==void 0&&(r[s]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.streamApiCall(s,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const s=new AbortController,i=s.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>s.abort(),n.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=i}return e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await i2(s),new mE(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await i2(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var n;return qv(this,arguments,function*(){const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield Ns(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=i.decode(c);try{const h=JSON.parse(u);if("error"in h){const f=JSON.parse(JSON.stringify(h.error)),m=f.status,g=f.code,x=`got status: ${m}. ${JSON.stringify(h)}`;if(g>=400&&g<500)throw new H$(x);if(g>=500&&g<600)throw new vE(x)}}catch(h){const f=h;if(f.name==="ClientError"||f.name==="ServerError")throw h}o+=u;let d=o.match(s2);for(;d;){const h=d[1];try{const f=new Response(h,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield Ns(new mE(f)),o=o.slice(d[0].length),d=o.match(s2)}catch(f){throw new Error(`exception parsing stream chunk ${h}. ${f}`)}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=kre+" "+this.clientOptions.userAgentExtra;return e[Nre]=n,e[Pre]=n,e[Tre]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))n.append(r,s);e.timeout&&e.timeout>0&&n.append(Ire,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const i=this.clientOptions.uploader,o=await i.stat(e);s.sizeBytes=String(o.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,n);return i.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let s={};n!=null&&n.httpOptions?s=n.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},o=await this.request({path:qt("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:s});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function i2(t){var e;if(t===void 0)throw new vE("response is undefined");if(!t.ok){const n=t.status,r=t.statusText;let s;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await t.json():s={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=`got status: ${n} ${r}. ${JSON.stringify(s)}`;throw n>=400&&n<500?new H$(i):n>=500&&n<600?new vE(i):new Error(i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Mre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Lre(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);return n!==void 0&&o!=null&&S(n,["_query","filter"],o),r}function Fre(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],Lre(t,r,n)),n}function Ore(t,e){const n={},r=b(e,["textInput"]);r!=null&&S(n,["textInput"],r);const s=b(e,["output"]);return s!=null&&S(n,["output"],s),n}function Vre(t,e){const n={};if(b(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=b(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>Ore(t,i))),S(n,["examples","examples"],s)}return n}function $re(t,e,n){const r={};if(b(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=b(e,["tunedModelDisplayName"]);if(n!==void 0&&s!=null&&S(n,["displayName"],s),b(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=b(e,["epochCount"]);n!==void 0&&i!=null&&S(n,["tuningTask","hyperparameters","epochCount"],i);const o=b(e,["learningRateMultiplier"]);if(o!=null&&S(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),b(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(b(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=b(e,["batchSize"]);n!==void 0&&l!=null&&S(n,["tuningTask","hyperparameters","batchSize"],l);const c=b(e,["learningRate"]);return n!==void 0&&c!=null&&S(n,["tuningTask","hyperparameters","learningRate"],c),r}function Ure(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["trainingDataset"]);s!=null&&S(n,["tuningTask","trainingData"],Vre(t,s));const i=b(e,["config"]);return i!=null&&S(n,["config"],$re(t,i,n)),n}function Bre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function zre(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);return n!==void 0&&o!=null&&S(n,["_query","filter"],o),r}function Gre(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],zre(t,r,n)),n}function Wre(t,e,n){const r={},s=b(e,["gcsUri"]);if(n!==void 0&&s!=null&&S(n,["supervisedTuningSpec","trainingDatasetUri"],s),b(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function Hre(t,e){const n={},r=b(e,["gcsUri"]);return r!=null&&S(n,["validationDatasetUri"],r),n}function qre(t,e,n){const r={},s=b(e,["validationDataset"]);n!==void 0&&s!=null&&S(n,["supervisedTuningSpec"],Hre(t,s));const i=b(e,["tunedModelDisplayName"]);n!==void 0&&i!=null&&S(n,["tunedModelDisplayName"],i);const o=b(e,["description"]);n!==void 0&&o!=null&&S(n,["description"],o);const l=b(e,["epochCount"]);n!==void 0&&l!=null&&S(n,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=b(e,["learningRateMultiplier"]);n!==void 0&&c!=null&&S(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const u=b(e,["exportLastCheckpointOnly"]);n!==void 0&&u!=null&&S(n,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const d=b(e,["adapterSize"]);if(n!==void 0&&d!=null&&S(n,["supervisedTuningSpec","hyperParameters","adapterSize"],d),b(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(b(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function Kre(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["trainingDataset"]);s!=null&&S(n,["supervisedTuningSpec","trainingDatasetUri"],Wre(t,s,n));const i=b(e,["config"]);return i!=null&&S(n,["config"],qre(t,i,n)),n}function Yre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["model"],r);const s=b(e,["name"]);return s!=null&&S(n,["endpoint"],s),n}function q$(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["state"]);s!=null&&S(n,["state"],O$(t,s));const i=b(e,["createTime"]);i!=null&&S(n,["createTime"],i);const o=b(e,["tuningTask","startTime"]);o!=null&&S(n,["startTime"],o);const l=b(e,["tuningTask","completeTime"]);l!=null&&S(n,["endTime"],l);const c=b(e,["updateTime"]);c!=null&&S(n,["updateTime"],c);const u=b(e,["description"]);u!=null&&S(n,["description"],u);const d=b(e,["baseModel"]);d!=null&&S(n,["baseModel"],d);const h=b(e,["_self"]);h!=null&&S(n,["tunedModel"],Yre(t,h));const f=b(e,["distillationSpec"]);f!=null&&S(n,["distillationSpec"],f);const m=b(e,["experiment"]);m!=null&&S(n,["experiment"],m);const g=b(e,["labels"]);g!=null&&S(n,["labels"],g);const x=b(e,["pipelineJob"]);x!=null&&S(n,["pipelineJob"],x);const v=b(e,["tunedModelDisplayName"]);return v!=null&&S(n,["tunedModelDisplayName"],v),n}function Jre(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["tunedModels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>q$(t,o))),S(n,["tuningJobs"],i)}return n}function Xre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);return o!=null&&S(n,["error"],o),n}function Qre(t,e){const n={},r=b(e,["checkpointId"]);r!=null&&S(n,["checkpointId"],r);const s=b(e,["epoch"]);s!=null&&S(n,["epoch"],s);const i=b(e,["step"]);i!=null&&S(n,["step"],i);const o=b(e,["endpoint"]);return o!=null&&S(n,["endpoint"],o),n}function Zre(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],r);const s=b(e,["endpoint"]);s!=null&&S(n,["endpoint"],s);const i=b(e,["checkpoints"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>Qre(t,l))),S(n,["checkpoints"],o)}return n}function wE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["state"]);s!=null&&S(n,["state"],O$(t,s));const i=b(e,["createTime"]);i!=null&&S(n,["createTime"],i);const o=b(e,["startTime"]);o!=null&&S(n,["startTime"],o);const l=b(e,["endTime"]);l!=null&&S(n,["endTime"],l);const c=b(e,["updateTime"]);c!=null&&S(n,["updateTime"],c);const u=b(e,["error"]);u!=null&&S(n,["error"],u);const d=b(e,["description"]);d!=null&&S(n,["description"],d);const h=b(e,["baseModel"]);h!=null&&S(n,["baseModel"],h);const f=b(e,["tunedModel"]);f!=null&&S(n,["tunedModel"],Zre(t,f));const m=b(e,["supervisedTuningSpec"]);m!=null&&S(n,["supervisedTuningSpec"],m);const g=b(e,["tuningDataStats"]);g!=null&&S(n,["tuningDataStats"],g);const x=b(e,["encryptionSpec"]);x!=null&&S(n,["encryptionSpec"],x);const v=b(e,["partnerModelTuningSpec"]);v!=null&&S(n,["partnerModelTuningSpec"],v);const w=b(e,["distillationSpec"]);w!=null&&S(n,["distillationSpec"],w);const _=b(e,["experiment"]);_!=null&&S(n,["experiment"],_);const C=b(e,["labels"]);C!=null&&S(n,["labels"],C);const T=b(e,["pipelineJob"]);T!=null&&S(n,["pipelineJob"],T);const R=b(e,["tunedModelDisplayName"]);return R!=null&&S(n,["tunedModelDisplayName"],R),n}function ese(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["tuningJobs"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>wE(t,o))),S(n,["tuningJobs"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class tse extends xg{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new N0(Gh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:fE.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Bre(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>wE(this.apiClient,d))}else{const u=Mre(this.apiClient,e);return l=qt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>q$(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Gre(this.apiClient,e);return l=qt("tuningJobs",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=ese(this.apiClient,d),f=new Wj;return Object.assign(f,h),f})}else{const u=Fre(this.apiClient,e);return l=qt("tunedModels",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Jre(this.apiClient,d),f=new Wj;return Object.assign(f,h),f})}}async tuneInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Kre(this.apiClient,e);return i=qt("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>wE(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Ure(this.apiClient,e);return i=qt("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>Xre(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class nse{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const rse=1024*1024*8,sse=3,ise=1e3,ose=2,G_="x-goog-upload-status";async function ase(t,e,n){var r,s,i;let o=0,l=0,c=new mE(new Response),u="upload";for(o=t.size;l<o;){const h=Math.min(rse,o-l),f=t.slice(l,l+h);l+h>=o&&(u+=", finalize");let m=0,g=ise;for(;m<sse&&(c=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(h)}}}),!(!((r=c==null?void 0:c.headers)===null||r===void 0)&&r[G_]));)m++,await cse(g),g=g*ose;if(l+=h,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[G_])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(c==null?void 0:c.json());if(((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[G_])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function lse(t){return{size:t.size,type:t.type}}function cse(t){return new Promise(e=>setTimeout(e,t))}class use{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await ase(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await lse(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dse{create(e,n,r){return new hse(e,n,r)}}class hse{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const o2="x-goog-api-key";class fse{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(o2)===null&&e.append(o2,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const mse="gl-node/";class On{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=CQ(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new fse(this.apiKey);this.apiClient=new Dre({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:mse+"web",uploader:new use,downloader:new nse}),this.models=new mre(this.apiClient),this.live=new cre(this.apiClient,s,new dse),this.chats=new kZ(this.models,this.apiClient),this.caches=new IZ(this.apiClient),this.files=new GZ(this.apiClient),this.operations=new Ere(this.apiClient),this.tunings=new tse(this.apiClient)}}const yl="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s";async function mI(t){const e=new On({apiKey:yl}),n={type:rt.ARRAY,items:{type:rt.STRING},description:"An array of 3 creative and catchy store name suggestions."};try{const r=`Suggest 3 creative and catchy store name options based on the following store name: "${t}". The suggestions should be relevant and similar. Return exactly 3 suggestions.`,s=await e.models.generateContent({model:"gemini-2.0-flash-lite-preview-02-05",contents:[{role:"user",parts:[{text:r}]}],config:{responseMimeType:"application/json",responseSchema:n}}),i=s.text;if(typeof i!="string"||i.trim()==="")throw console.error("Model did not return a text response for store name suggestions. Response:",JSON.stringify(s)),new Error("Model response for store name suggestions was empty or not a string.");try{const o=JSON.parse(i);return Array.isArray(o)&&o.every(l=>typeof l=="string")?{suggestions:o.slice(0,3).map(l=>l.trim()).filter(l=>l.length>0)}:(console.error("Parsed store name suggestions are not an array of strings:",o),{error:"AI response was not in the expected format (array of strings).",rawResponse:i})}catch(o){return console.error("Failed to parse JSON response for store names:",i,"ParseError:",o),{error:"Failed to parse store name suggestions from AI.",rawResponse:i}}}catch(r){return console.error("Error generating store name suggestions:",r),{error:`Error generating suggestions: ${r.message}`}}}async function K$(t){const e=new On({apiKey:yl}),n={type:rt.OBJECT,properties:{heroTitle:{type:rt.STRING,description:"The catchy hero title for the store."},heroDescription:{type:rt.STRING,description:"A short (1-2 sentences) engaging hero description."}},required:["heroTitle","heroDescription"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t;let c=`Generate a compelling hero title and a short, engaging hero description for an online store.
Store Name: ${r||"N/A"}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and friendly"}

Return the hero title and description as a JSON object matching the schema.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:n}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for hero content. Response:",JSON.stringify(u)),new Error("Model response for hero content was empty or not a string.");try{const h=JSON.parse(d);return h&&typeof h.heroTitle=="string"&&typeof h.heroDescription=="string"?{heroTitle:h.heroTitle,heroDescription:h.heroDescription}:(console.error("Parsed hero content is not in the expected format:",h),{error:"AI response was not in the expected format for hero content.",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for hero content:",d,"ParseError:",h),{error:"Failed to parse hero content from AI.",rawResponse:d}}}catch(u){return console.error("Error generating hero content:",u),{error:`Error generating hero content: ${u.message}`}}}async function pse(t){if(!t||!t.name)return console.error("Product information (at least name) is required for image prompt suggestions."),{error:"Product information required."};const e=new On({apiKey:yl}),{name:n,description:r,niche:s,storeName:i}=t,o={type:rt.ARRAY,items:{type:rt.STRING},description:"An array of 6 diverse and creative text prompts for AI image generation related to a product."};let l=`product named "${n}"`;r&&(l+=` with description "${r}"`),i&&(l+=` from a store called "${i}"`),s&&(l+=` in the "${s}" niche`);const c=`Based on a ${l}, generate 6 diverse and creative text prompts suitable for AI image generation. These prompts should aim to create visually appealing images for marketing this product. Examples: "A dynamic shot of [product name] on a clean, modern background with soft lighting", "Lifestyle image of [product name] being used by a happy customer in a [relevant setting]", "Close-up detail of [product name]'s unique feature with artistic blur". Return exactly 6 prompt suggestions.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:o}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for image prompt suggestions. Response:",JSON.stringify(u)),new Error("Model response for image prompt suggestions was empty or not a string.");try{const h=JSON.parse(d);return Array.isArray(h)&&h.every(f=>typeof f=="string")?{suggestions:h.slice(0,6).map(f=>f.trim()).filter(f=>f.length>0)}:(console.error("Parsed image prompt suggestions are not an array of strings:",h),{error:"AI response was not in the expected format for image prompts (array of strings).",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for image prompt suggestions:",d,"ParseError:",h),{error:"Failed to parse image prompt suggestions from AI.",rawResponse:d}}}catch(u){return console.error("Error generating image prompt suggestions:",u),{error:`Error generating image prompt suggestions: ${u.message}`}}}async function gse(t){const e=new On({apiKey:yl}),n={name:"extract_store_name",description:`Extracts the desired store name if explicitly mentioned in the prompt using phrases like "store called 'My Store'", "named 'My Store'", or "store 'My Store'". The name should be the direct object of such phrases.`,parameters:{type:rt.OBJECT,properties:{storeName:{type:rt.STRING,description:"The explicitly mentioned name of the store."}},required:["storeName"]}};try{const i=(await e.getGenerativeModel({model:"gemini-pro"}).generateContent({contents:[{role:"user",parts:[{text:t}]}],tools:[{functionDeclarations:[n]}]})).response.functionCalls();return i&&i.length>0&&i[0].name==="extract_store_name"&&i[0].args&&i[0].args.storeName?(console.log(`[extractExplicitStoreName] Gemini identified store name: ${i[0].args.storeName}`),i[0].args.storeName):(console.log("[extractExplicitStoreName] Gemini did not identify an explicit store name via function call."),null)}catch(r){return console.error("Error during Gemini store name extraction:",r),null}}async function Y$(t){const e=new On({apiKey:yl}),n={type:rt.OBJECT,properties:{title:{type:rt.STRING,description:"The main title for 'The [StoreName] Way' section (e.g., 'The AwesomeStore Way')."},subtitle:{type:rt.STRING,description:"A short, engaging subtitle for this section (1-2 sentences)."},items:{type:rt.ARRAY,description:"An array of 3 to 4 items representing the store's core values or unique selling points.",items:{type:rt.OBJECT,properties:{emoji:{type:rt.STRING,description:"A single relevant emoji for the item (e.g., '', '')."},title:{type:rt.STRING,description:"A short title for the item (2-4 words)."},description:{type:rt.STRING,description:"A brief description of the item (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4}},required:["title","subtitle","items"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t,c=r||"Our Store";let u=`Generate content for "The ${c} Way" section of an online store. This section highlights the store's core values and what makes it unique.
Store Name: ${c}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of quality products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and customer-focused"}

The content should include:
1.  A main title (e.g., "The ${c} Way"). This title should dynamically incorporate the actual store name.
2.  A short subtitle (1-2 sentences) that is specific and engaging for this store.
3.  3 to 4 items, each with:
    *   A unique and highly relevant emoji that visually represents the item's theme and is specific to this store's niche/style/keywords. This emoji is mandatory and must not be a generic placeholder. For example, if the store sells coffee, an emoji like  or  (for organic beans) would be appropriate. If it's a tech store,  or .
    *   A short, catchy title for the item (2-4 words, e.g., "Artisanal Roasts", "Cutting-Edge Tech"). This title must be specific to the store's theme.
    *   A brief description (10-20 words) elaborating on the item's title, specific to the store's values and offerings.

Return this content as a JSON object matching the schema. Ensure all text content and emojis are distinct, creative, and directly reflect the store's unique characteristics and offerings. Do not use generic examples in the output.`;try{const d=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:u}]}],config:{responseMimeType:"application/json",responseSchema:n}}),h=d.text;if(typeof h!="string"||h.trim()==="")throw console.error("Model did not return a text response for store way content. Response:",JSON.stringify(d)),new Error("Model response for store way content was empty or not a string.");try{const f=JSON.parse(h);return f&&typeof f.title=="string"&&typeof f.subtitle=="string"&&Array.isArray(f.items)&&f.items.length>=3&&f.items.length<=4&&f.items.every(m=>typeof m.emoji=="string"&&m.emoji.length>0&&typeof m.title=="string"&&typeof m.description=="string")?(f.title=`The ${c} Way`,f):(console.error("Parsed store way content is not in the expected format:",f),{error:"AI response was not in the expected format for store way content.",rawResponse:h})}catch(f){return console.error("Failed to parse JSON response for store way content:",h,"ParseError:",f),{error:"Failed to parse store way content from AI.",rawResponse:h}}}catch(d){return console.error("Error generating store way content:",d),{error:`Error generating store way content: ${d.message}`}}}async function pI(t){const e=[{iconName:"Truck",title:"Fast Shipping",description:"Get your orders delivered quickly and reliably."},{iconName:"ShieldCheck",title:"Secure Payments",description:"Shop with confidence using our secure payment gateways."},{iconName:"MessageSquare",title:"24/7 Support",description:"Our dedicated team is here to help you around the clock."},{iconName:"Repeat",title:"Easy Returns",description:"Hassle-free return and exchange policy if you're not satisfied."},{iconName:"Award",title:"Quality Guaranteed",description:"We stand by the quality of our products."},{iconName:"Gift",title:"Gift Options",description:"Special gift wrapping and messaging available."}],n=[{iconName:"Users",number:"10K+",label:"Active Users"},{iconName:"Star",number:"4.8",label:"Avg. Rating"},{iconName:"PackageCheck",number:"20K+",label:"Orders Shipped"},{iconName:"ShieldCheck",number:"100%",label:"Secure Checkout"},{iconName:"ThumbsUp",number:"95%",label:"Positive Feedback"},{iconName:"Globe",number:"Worldwide",label:"Shipping"}],r=new On({apiKey:yl}),s={type:rt.OBJECT,properties:{title:{type:rt.STRING,description:"Main title for the features/experience section (e.g., 'An Exceptional Experience')."},subtitle:{type:rt.STRING,description:"Engaging subtitle for the features section (1-2 sentences)."},items:{type:rt.ARRAY,description:"An array of 3 to 4 feature items highlighting key store benefits.",items:{type:rt.OBJECT,properties:{emoji:{type:rt.STRING,description:"A single relevant emoji for the feature (e.g., '', '', '')."},title:{type:rt.STRING,description:"Short title for the feature (2-4 words, e.g., 'Secure Payments', 'Global Reach')."},description:{type:rt.STRING,description:"Brief description of the feature (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4},secondaryItems:{type:rt.ARRAY,description:"An array of up to 4 secondary feature items highlighting broader store benefits or values. The function will ensure 4 items are present by adding defaults if needed.",items:{type:rt.OBJECT,properties:{iconName:{type:rt.STRING,description:"Name of a Lucide icon (e.g., 'GlobeIcon', 'AwardIcon', 'UsersIcon', 'HeartIcon') for the secondary feature."},title:{type:rt.STRING,description:"Short title for the secondary feature (2-4 words, e.g., 'Global Shipping', 'Quality Assured')."},description:{type:rt.STRING,description:"Brief description of the secondary feature (10-15 words)."}},required:["iconName","title","description"]},minItems:0,maxItems:4},statsItems:{type:rt.ARRAY,description:"An array of exactly 4 stat items highlighting key metrics or achievements.",items:{type:rt.OBJECT,properties:{iconName:{type:rt.STRING,description:"Name of a Lucide icon for the stat (e.g., 'UsersIcon', 'StarIcon', 'ZapIcon')."},number:{type:rt.STRING,description:"The statistic value (e.g., '50K+', '99.9%', '4.9')."},label:{type:rt.STRING,description:"The label for the statistic (e.g., 'Happy Customers', 'Uptime', 'Average Rating')."}},required:["iconName","number","label"]},minItems:4,maxItems:4}},required:["title","subtitle","items","secondaryItems","statsItems"]},{name:i,niche:o,description:l,targetAudience:c,style:u}=t,d=i||"Our Store";let h=`Generate content for a store features section, often titled "An Exceptional Experience" or similar, for an online store named "${d}".
This section should highlight key benefits and unique selling propositions.
Store Name: ${d}
Niche: ${o||"General E-commerce"}
Description/Keywords: ${l||"A variety of quality products."}
Target Audience: ${c||"General consumers"}
Style/Vibe: ${u||"Modern and customer-focused"}

The content should include:
1.  A main title for the section (e.g., "Why Choose Us?", "Our Commitment to You", "An Exceptional Experience").
2.  A short, engaging subtitle (1-2 sentences).
3.  3 to 4 feature items, each with:
    *   A unique and highly relevant emoji that visually represents the feature (e.g.,  for innovation,  for eco-friendly,  for smart tech). This emoji is mandatory and must be specific to the feature's theme.
    *   A short, catchy, and descriptive title for the feature (2-5 words, e.g., "Innovative Designs", "Sustainable Materials", "Smart Home Solutions"). This title will be used to search for a relevant background video, so make it evocative.
    *   A brief description (10-20 words) explaining the benefit of the feature.
4.  Up to 4 secondary feature items (the system will ensure 4 by adding defaults if fewer are provided by AI), each with:
    *   An \`iconName\` string representing a Lucide icon (e.g., "GlobeIcon", "AwardIcon", "UsersIcon", "HeartIcon"). Choose an icon name that best fits the feature. Examples: GlobeIcon, AwardIcon, UsersIcon, HeartIcon, PackageIcon, ShieldIcon, ZapIcon.
    *   A short title for the secondary feature (2-4 words, e.g., "Global Shipping", "Quality Assured", "Community Love", "Eco-Friendly Focus").
    *   A brief description (10-15 words) for the secondary feature. These should highlight broader store values or benefits.
5.  Exactly 4 stat items, each with:
    *   An \`iconName\` string for a Lucide icon (e.g., "UsersIcon", "StarIcon", "ZapIcon", "PackageIcon").
    *   A \`number\` or key metric (e.g., "50K+", "99.9%", "4.9", "1M+"). Avoid including symbols like  in the number string itself.
    *   A descriptive \`label\` (e.g., "Happy Customers", "Uptime Guarantee", "Average Rating", "Units Sold").

Return this content as a JSON object matching the schema. Ensure all text content, emojis, and iconNames are distinct, creative, and directly reflect positive attributes of a store like "${d}". Do not use generic examples in the output. Examples of main features could be related to payment security, shipping, product quality, customer service. Secondary features could be about global reach, quality assurance, community, sustainability etc. Stats should reflect plausible achievements or service levels for a store selling "${o||"various items"}".`;try{const f=await r.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:h}]}],config:{responseMimeType:"application/json",responseSchema:s}}),m=f.text;if(typeof m!="string"||m.trim()==="")throw console.error("Model did not return a text response for store features content. Response:",JSON.stringify(f)),new Error("Model response for store features content was empty or not a string.");try{const g=JSON.parse(m);if(g&&typeof g.title=="string"&&typeof g.subtitle=="string"&&Array.isArray(g.items)&&g.items.length>=3&&g.items.length<=4&&g.items.every(x=>typeof x.emoji=="string"&&x.emoji.length>0&&typeof x.title=="string"&&typeof x.description=="string")){let x=[];g.secondaryItems&&Array.isArray(g.secondaryItems)&&(x=g.secondaryItems.filter(C=>C&&typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.title=="string"&&C.title.length>0&&typeof C.description=="string"&&C.description.length>0).slice(0,4));const v=4-x.length;if(v>0){const C=new Set(x.map(R=>R.title)),T=e.filter(R=>!C.has(R.title)).slice(0,v);x.push(...T)}g.secondaryItems=x.slice(0,4);let w=[];g.statsItems&&Array.isArray(g.statsItems)&&(w=g.statsItems.filter(C=>C&&typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.number=="string"&&C.number.length>0&&typeof C.label=="string"&&C.label.length>0).slice(0,4));const _=4-w.length;if(_>0){const C=new Set(w.map(R=>R.label)),T=n.filter(R=>!C.has(R.label)).slice(0,_);w.push(...T)}return g.statsItems=w.slice(0,4),Array.isArray(g.secondaryItems)&&g.secondaryItems.every(C=>typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.title=="string"&&typeof C.description=="string")&&Array.isArray(g.statsItems)&&g.statsItems.length===4&&g.statsItems.every(C=>typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.number=="string"&&C.number.length>0&&typeof C.label=="string"&&C.label.length>0)?g:(console.error("Parsed store features content is not in the expected format after padding/validation:",g),(!g.statsItems||g.statsItems.length!==4)&&(console.warn("Stats items still not 4, forcing defaults for stats."),g.statsItems=n.slice(0,4)),(!g.secondaryItems||g.secondaryItems.length===0)&&(console.warn("Secondary items empty, forcing defaults for secondary."),g.secondaryItems=e.slice(0,Math.min(4,e.length))),g.title&&g.subtitle&&g.items?g:{error:"AI response format error after final processing.",rawResponse:m,processedContent:g})}else return console.error("Initial parsed store features content structure is invalid:",g),{error:"AI response (initial structure) was not in the expected format for store features content.",rawResponse:m}}catch(g){return console.error("Failed to parse JSON response for store features content:",m,"ParseError:",g),{error:"Failed to parse store features content from AI.",rawResponse:m}}}catch(f){return console.error("Error generating store features content:",f),{error:`Error generating store features content: ${f.message}`}}}async function J$(t){const e=new On({apiKey:yl}),n={type:rt.OBJECT,properties:{title:{type:rt.STRING,description:"Catchy title for a section highlighting craftsmanship/quality (e.g., 'Our Commitment to Quality')."},subtitle:{type:rt.STRING,description:"Engaging subtitle (1-2 sentences) related to the title."},text:{type:rt.STRING,description:"Main descriptive text (2-3 sentences) about the store's dedication to quality, materials, or process."},listItems:{type:rt.ARRAY,description:"An array of 3-4 short bullet points (3-5 words each) highlighting key aspects (e.g., 'Premium Materials', 'Expert Craftsmanship').",items:{type:rt.STRING},minItems:3,maxItems:4},ctaText:{type:rt.STRING,description:"Call to action button text (e.g., 'Explore Our Process', 'Learn More')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`Key products include: ${t.productExamples}.`:"The store offers a range of specialized gear.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has an image on the right and text on the left, emphasizing the store's precision, quality, craftsmanship, or unique process.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"high-performance gear"}"
Store Description: "${i||"A store dedicated to excellence and precision."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 3-4 list items (3-5 words each), and a CTA button text.
The tone should be bold, confident, and precise, fitting a high-tech or tactical brand.
Focus on aspects like durability, advanced technology, expert design, or mission-readiness.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=3&&d.ctaText?d:(console.error("Invalid structure from AI for ImageRightSection:",d),{error:"AI response format error for ImageRightSection.",rawResponse:u})}catch(c){return console.error("Error generating ImageRightSection content:",c),{error:`Error generating ImageRightSection content: ${c.message}`}}}async function X$(t){const e=new On({apiKey:yl}),n={type:rt.OBJECT,properties:{title:{type:rt.STRING,description:"Catchy title for a section showcasing a product or brand story via video (e.g., 'Experience the Difference')."},subtitle:{type:rt.STRING,description:"Engaging subtitle (1-2 sentences) related to the video's theme."},text:{type:rt.STRING,description:"Main descriptive text (2-3 sentences) complementing the video."},listItems:{type:rt.ARRAY,description:"An array of 2-3 short bullet points (3-5 words each) highlighting key takeaways or features shown in a video.",items:{type:rt.STRING},minItems:2,maxItems:3},ctaText:{type:rt.STRING,description:"Call to action button text (e.g., 'Watch Now', 'See It In Action')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`The video might showcase products like: ${t.productExamples}.`:"The video showcases our innovative products.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has a video on the left and text on the right, aiming to engage users with a dynamic visual story or product demonstration.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"cutting-edge solutions"}"
Store Description: "${i||"A store focused on performance and innovation."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 2-3 list items (3-5 words each highlighting video takeaways), and a CTA button text.
The tone should be energetic, impactful, and forward-thinking, suitable for a high-performance brand.
Focus on action, benefits, or the experience the video portrays.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=2&&d.ctaText?d:(console.error("Invalid structure from AI for VideoLeftSection:",d),{error:"AI response format error for VideoLeftSection.",rawResponse:u})}catch(c){return console.error("Error generating VideoLeftSection content:",c),{error:`Error generating VideoLeftSection content: ${c.message}`}}}async function yse(t,e){const n=new On({apiKey:yl}),r={type:rt.OBJECT,properties:{description:{type:rt.STRING,description:"A compelling and SEO-friendly product description."}},required:["description"]},{name:s,description:i}=t,{name:o,niche:l,targetAudience:c,style:u}=e;let d=`Generate a compelling, engaging, and SEO-friendly product description.
Store Name: ${o||"N/A"}
Store Niche: ${l||"General E-commerce"}
Store Style: ${u||"Modern and friendly"}
Target Audience: ${c||"General consumers"}

Product Name: "${s}"
${i?`Existing Description (for context, improve upon it): "${i}"`:""}

The new description should be persuasive, highlight key benefits, and be written in a tone that matches the store's style. It should be between 50 and 150 words.
Return the description as a JSON object matching the schema.`;try{const h=await n.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:d}]}],config:{responseMimeType:"application/json",responseSchema:r}}),f=h.text;if(typeof f!="string"||f.trim()==="")throw console.error("Model did not return a text response for product description. Response:",JSON.stringify(h)),new Error("Model response for product description was empty or not a string.");try{const m=JSON.parse(f);return m&&typeof m.description=="string"?{description:m.description}:(console.error("Parsed product description is not in the expected format:",m),{error:"AI response was not in the expected format for product description.",rawResponse:f})}catch(m){return console.error("Failed to parse JSON response for product description:",f,"ParseError:",m),{error:"Failed to parse product description from AI.",rawResponse:f}}}catch(h){return console.error("Error generating product description:",h),{error:`Error generating product description: ${h.message}`}}}function bt(...t){return pQ(T$(t))}function Ft(){return wQ()}const xse="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t";console.log("[utils.jsx] VITE_PEXELS_API_KEY loaded:","Exists");const Q$=xse,vse="https://api.pexels.com/v1",wse="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s";console.log("[utils.jsx] VITE_GEMINI_API_KEY loaded:","Exists");const bse=wse,_se="your-shop-name.myshopify.com",ro=async(t,e=1,n="landscape")=>{const r=`${vse}/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:Q$}});if(!s.ok){const o=await s.json();throw console.error("Pexels API error:",o),new Error(`Pexels API request failed: ${s.statusText}`)}const i=await s.json();if(!i.photos||i.photos.length===0){console.warn(`No Pexels images found for query: "${t}". Attempting fallback.`);const o=(l,c,u)=>`https://via.placeholder.com/${l}x${c}.png?text=NoImage:${encodeURIComponent(u)}`;return Array(e).fill(null).map((l,c)=>({id:Ft(),src:{large:o(1200,800,`${t} ${c+1}`),medium:o(800,600,`${t} ${c+1}`),original:o(1920,1280,`${t} ${c+1}`),square:o(400,400,`${t} ${c+1}`),landscape:o(1200,800,`${t} ${c+1}`),portrait:o(800,1200,`${t} ${c+1}`),small:o(400,260,`${t} ${c+1}`),tiny:o(200,130,`${t} ${c+1}`)},photographer:"N/A",alt:`No image found for ${t} ${c+1}`}))}return i.photos.map(o=>({id:o.id,src:o.src,photographer:o.photographer,alt:o.alt||`Photo by ${o.photographer} of ${t}`}))}catch(s){console.error("Error fetching Pexels images:",s);const i=(o,l,c)=>`https://via.placeholder.com/${o}x${l}.png?text=${encodeURIComponent(c)}`;return Array(e).fill(null).map((o,l)=>({id:Ft(),src:{large:i(1200,800,`Error ${t} ${l+1}`),medium:i(800,600,`Error ${t} ${l+1}`),original:i(1920,1280,`Error ${t} ${l+1}`),square:i(400,400,`Error ${t} ${l+1}`),landscape:i(1200,800,`Error ${t} ${l+1}`),portrait:i(800,1200,`Error ${t} ${l+1}`),small:i(400,260,`Error ${t} ${l+1}`),tiny:i(200,130,`Error ${t} ${l+1}`)},photographer:"Placeholder Error",alt:`Placeholder Error for ${t} ${l+1}`}))}},La=async(t,e=1,n="landscape")=>{const r=`https://api.pexels.com/videos/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:Q$}});if(!s.ok){const o=await s.json();throw console.error("Pexels Videos API error:",o),new Error(`Pexels Videos API request failed: ${s.statusText}`)}const i=await s.json();return!i.videos||i.videos.length===0?(console.warn(`No Pexels videos found for query: "${t}".`),Array(e).fill(null).map((o,l)=>({id:Ft(),url:`https://videos.pexels.com/videos/no-video-${l+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=No+Video+Found+${encodeURIComponent(t)}`,alt:`No video found for ${t} ${l+1}`}))):i.videos.map(o=>{var c,u;const l=o.video_files.find(d=>d.quality==="hd"&&d.file_type==="video/mp4")||o.video_files.find(d=>d.file_type==="video/mp4")||o.video_files[0];return{id:o.id,url:l?l.link:null,image:((c=o.video_pictures[0])==null?void 0:c.picture)||`https://via.placeholder.com/1280x720.png?text=${encodeURIComponent(o.url||t)}`,duration:o.duration,user:o.user,alt:`Video of ${t} by ${((u=o.user)==null?void 0:u.name)||"Pexels Contributor"}`}})}catch(s){return console.error("Error fetching Pexels videos:",s),Array(e).fill(null).map((i,o)=>({id:Ft(),url:`https://videos.pexels.com/videos/error-video-${o+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=Video+Error+${encodeURIComponent(t)}`,alt:`Error fetching video for ${t} ${o+1}`}))}},A0=async t=>{try{const e=new On({apiKey:bse}),n=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}];console.log(`[utils.jsx/generateImageWithGemini] Calling Gemini with prompt: "${t}"`);const r=await e.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{text:t}],safetySettings:n,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let s=null,i="image/png";if(r.candidates&&r.candidates.length>0&&r.candidates[0].content&&r.candidates[0].content.parts){for(const o of r.candidates[0].content.parts)if(o.inlineData&&o.inlineData.data){s=o.inlineData.data,i=o.inlineData.mimeType||"image/png",console.log(`[utils.jsx/generateImageWithGemini] Image generated. MimeType: ${i}`);break}}if(s)return{url:`data:${i};base64,${s}`,alt:`AI Generated Image for: ${t}`};throw new Error("No image data found in Gemini response.")}catch(e){return console.error("[utils.jsx/generateImageWithGemini] Error generating image with Gemini:",e),{url:`https://via.placeholder.com/512x512.png?text=Error:${encodeURIComponent(t.substring(0,20))}`,alt:`Error generating image for: ${t}`}}},Sse=(t,e)=>{const n={fashion:[`Elevate your style with our ${e}. Crafted for comfort and a modern look.`,`The ${e} is a must-have for any fashion-forward wardrobe. Versatile and chic.`,`Discover the perfect blend of quality and design in our ${e}. Ideal for any occasion.`],electronics:[`Experience next-level technology with the ${e}. Packed with features for modern life.`,`The ${e} offers superior performance and sleek design. Upgrade your tech today.`,`Unleash innovation with the ${e}. Reliable, powerful, and built to last.`],food:[`Savor the rich flavors of our ${e}. Made with the freshest, high-quality ingredients.`,`Our ${e} is a delicious treat for any time of day. Wholesome and satisfying.`,`Indulge in the authentic taste of ${e}. Perfect for sharing or enjoying solo.`],jewelry:[`Adorn yourself with the exquisite ${e}. A timeless piece that radiates elegance.`,`The ${e} is a symbol of sophistication and luxury. Crafted with precision.`,`Make a statement with our stunning ${e}. Perfect for special moments.`],general:[`Discover the quality and utility of the ${e}. A great addition to your collection.`,`The ${e} is designed for excellence and everyday use. You'll love it.`,`Enhance your life with the versatile ${e}. Built for performance and style.`]},r=n[t]||n.general;return r[Math.floor(Math.random()*r.length)]},gI=async(t,e,n="")=>{const r={niche:t,name:e,description:n};let s={heroTitle:`Welcome to ${e}`,heroDescription:`Discover amazing products at ${e}.`,featuresSectionTitle:"Why Shop With Us?",featuresSectionSubtitle:"We are committed to providing you with the best shopping experience.",featureTitles:["Fast Worldwide Shipping","Secure Online Payments","24/7 Customer Support","Easy Returns & Exchanges"],featureDescriptions:["Get your orders delivered quickly and reliably, no matter where you are.","Shop with confidence using our encrypted and secure payment gateways.","Our dedicated team is here to help you around the clock with any queries.","Not satisfied? We offer a hassle-free return and exchange policy."],featuresVideoQuery:`${t} abstract`,newsletterHeading:`Join the ${e} Family`,newsletterText:"Sign up for our newsletter to receive exclusive offers, new product alerts, and style tips directly to your inbox. Don't miss out!"};try{const l=await pI(r);l&&!l.error&&l.items&&(s.featuresSectionTitle=l.title,s.featuresSectionSubtitle=l.subtitle,s.featureTitles=l.items.map(c=>c.title),s.featureDescriptions=l.items.map(c=>c.description),s.featureTitles.length>0&&(s.featuresVideoQuery=`${e} ${t} ${s.featureTitles[0]}`))}catch(l){console.error("Failed to generate dynamic features content, using fallback.",l)}const i={fashion:`Step Into Style at ${e}`,electronics:`${e}: Your Tech Universe`,food:`Taste the Difference with ${e}`,jewelry:`Shine Bright with ${e}`,general:`Welcome to ${e} - Quality Finds!`},o={fashion:`Explore the latest trends and timeless classics. ${e} offers curated fashion for every individual. Express yourself with our unique collection.`,electronics:`Discover cutting-edge gadgets and essential electronics at ${e}. We bring you innovation, performance, and value, all in one place.`,food:`From farm-fresh produce to gourmet delights, ${e} is your source for delicious and wholesome food. Quality ingredients for a healthier life.`,jewelry:`Find exquisite pieces that tell your story. ${e} presents a stunning collection of fine jewelry, perfect for gifting or treating yourself.`,general:`Your one-stop shop for amazing products. ${e} offers a diverse range of quality items to meet your everyday needs and special desires.`};return s.heroTitle=i[t]||i.general,s.heroDescription=o[t]||o.general,s};function Cse(t,e){const[n,r]=p.useState(t);return p.useEffect(()=>{const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t,e]),n}function gt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function a2(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function k0(...t){return e=>{let n=!1;const r=t.map(s=>{const i=a2(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():a2(t[s],null)}}}}function yn(...t){return p.useCallback(k0(...t),t)}function Ese(t,e){const n=p.createContext(e),r=i=>{const{children:o,...l}=i,c=p.useMemo(()=>l,Object.values(l));return a.jsx(n.Provider,{value:c,children:o})};r.displayName=t+"Provider";function s(i){const o=p.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function wi(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];const u=h=>{var w;const{scope:f,children:m,...g}=h,x=((w=f==null?void 0:f[t])==null?void 0:w[c])||l,v=p.useMemo(()=>g,Object.values(g));return a.jsx(x.Provider,{value:v,children:m})};u.displayName=i+"Provider";function d(h,f){var x;const m=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,Tse(s,...e)]}function Tse(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Gu(t){const e=Nse(t),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(Ase);if(c){const u=c.props.children,d=l.map(h=>h===c?p.Children.count(u)>1?p.Children.only(null):p.isValidElement(u)?u.props.children:null:h);return a.jsx(e,{...o,ref:s,children:p.isValidElement(u)?p.cloneElement(u,void 0,d):null})}return a.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var Ise=Gu("Slot");function Nse(t){const e=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=Rse(s),l=kse(i,s.props);return s.type!==p.Fragment&&(l.ref=r?k0(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Z$=Symbol("radix.slottable");function Pse(t){const e=({children:n})=>a.jsx(a.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=Z$,e}function Ase(t){return p.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Z$}function kse(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function Rse(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function yI(t){const e=t+"CollectionProvider",[n,r]=wi(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:v,children:w}=x,_=ht.useRef(null),C=ht.useRef(new Map).current;return a.jsx(s,{scope:v,itemMap:C,collectionRef:_,children:w})};o.displayName=e;const l=t+"CollectionSlot",c=Gu(l),u=ht.forwardRef((x,v)=>{const{scope:w,children:_}=x,C=i(l,w),T=yn(v,C.collectionRef);return a.jsx(c,{ref:T,children:_})});u.displayName=l;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=Gu(d),m=ht.forwardRef((x,v)=>{const{scope:w,children:_,...C}=x,T=ht.useRef(null),R=yn(v,T),A=i(d,w);return ht.useEffect(()=>(A.itemMap.set(T,{ref:T,...C}),()=>void A.itemMap.delete(T))),a.jsx(f,{[h]:"",ref:R,children:_})});m.displayName=d;function g(x){const v=i(t+"CollectionConsumer",x);return ht.useCallback(()=>{const _=v.collectionRef.current;if(!_)return[];const C=Array.from(_.querySelectorAll(`[${h}]`));return Array.from(v.itemMap.values()).sort((A,E)=>C.indexOf(A.ref.current)-C.indexOf(E.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},g,r]}var jse=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Yt=jse.reduce((t,e)=>{const n=Gu(`Primitive.${e}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function xI(t,e){t&&ml.flushSync(()=>t.dispatchEvent(e))}function Vr(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function Dse(t,e=globalThis==null?void 0:globalThis.document){const n=Vr(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var Mse="DismissableLayer",bE="dismissableLayer.update",Lse="dismissableLayer.pointerDownOutside",Fse="dismissableLayer.focusOutside",l2,e3=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),vg=p.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=t,u=p.useContext(e3),[d,h]=p.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=p.useState({}),g=yn(e,E=>h(E)),x=Array.from(u.layers),[v]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),w=x.indexOf(v),_=d?x.indexOf(d):-1,C=u.layersWithOutsidePointerEventsDisabled.size>0,T=_>=w,R=Vse(E=>{const I=E.target,N=[...u.branches].some(k=>k.contains(I));!T||N||(s==null||s(E),o==null||o(E),E.defaultPrevented||l==null||l())},f),A=$se(E=>{const I=E.target;[...u.branches].some(k=>k.contains(I))||(i==null||i(E),o==null||o(E),E.defaultPrevented||l==null||l())},f);return Dse(E=>{_===u.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&l&&(E.preventDefault(),l()))},f),p.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(l2=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),c2(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=l2)}},[d,f,n,u]),p.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),c2())},[d,u]),p.useEffect(()=>{const E=()=>m({});return document.addEventListener(bE,E),()=>document.removeEventListener(bE,E)},[]),a.jsx(Yt.div,{...c,ref:g,style:{pointerEvents:C?T?"auto":"none":void 0,...t.style},onFocusCapture:gt(t.onFocusCapture,A.onFocusCapture),onBlurCapture:gt(t.onBlurCapture,A.onBlurCapture),onPointerDownCapture:gt(t.onPointerDownCapture,R.onPointerDownCapture)})});vg.displayName=Mse;var Ose="DismissableLayerBranch",t3=p.forwardRef((t,e)=>{const n=p.useContext(e3),r=p.useRef(null),s=yn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),a.jsx(Yt.div,{...t,ref:s})});t3.displayName=Ose;function Vse(t,e=globalThis==null?void 0:globalThis.document){const n=Vr(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let c=function(){n3(Lse,n,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function $se(t,e=globalThis==null?void 0:globalThis.document){const n=Vr(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&n3(Fse,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function c2(){const t=new CustomEvent(bE);document.dispatchEvent(t)}function n3(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?xI(s,i):s.dispatchEvent(i)}var Use=vg,Bse=t3,va=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},zse="Portal",wg=p.forwardRef((t,e)=>{var l;const{container:n,...r}=t,[s,i]=p.useState(!1);va(()=>i(!0),[]);const o=n||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?aI.createPortal(a.jsx(Yt.div,{...r,ref:e}),o):null});wg.displayName=zse;function Gse(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var xs=t=>{const{present:e,children:n}=t,r=Wse(e),s=typeof n=="function"?n({present:r.isPresent}):p.Children.only(n),i=yn(r.ref,Hse(s));return typeof n=="function"||r.isPresent?p.cloneElement(s,{ref:i}):null};xs.displayName="Presence";function Wse(t){const[e,n]=p.useState(),r=p.useRef(null),s=p.useRef(t),i=p.useRef("none"),o=t?"mounted":"unmounted",[l,c]=Gse(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const u=Vy(r.current);i.current=l==="mounted"?u:"none"},[l]),va(()=>{const u=r.current,d=s.current;if(d!==t){const f=i.current,m=Vy(u);t?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),va(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=m=>{const x=Vy(r.current).includes(m.animationName);if(m.target===e&&x&&(c("ANIMATION_END"),!s.current)){const v=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=v)})}},f=m=>{m.target===e&&(i.current=Vy(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function Vy(t){return(t==null?void 0:t.animationName)||"none"}function Hse(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var qse=i0[" useInsertionEffect ".trim().toString()]||va;function Fc({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=Kse({defaultProp:e,onChange:n}),l=t!==void 0,c=l?t:s;{const d=p.useRef(t!==void 0);p.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,r])}const u=p.useCallback(d=>{var h;if(l){const f=Yse(d)?d(t):d;f!==t&&((h=o.current)==null||h.call(o,f))}else i(d)},[l,t,i,o]);return[c,u]}function Kse({defaultProp:t,onChange:e}){const[n,r]=p.useState(t),s=p.useRef(n),i=p.useRef(e);return qse(()=>{i.current=e},[e]),p.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function Yse(t){return typeof t=="function"}var Jse=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Xse="VisuallyHidden",vI=p.forwardRef((t,e)=>a.jsx(Yt.span,{...t,ref:e,style:{...Jse,...t.style}}));vI.displayName=Xse;var wI="ToastProvider",[bI,Qse,Zse]=yI("Toast"),[r3,XRe]=wi("Toast",[Zse]),[eie,R0]=r3(wI),s3=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[l,c]=p.useState(null),[u,d]=p.useState(0),h=p.useRef(!1),f=p.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${wI}\`. Expected non-empty \`string\`.`),a.jsx(bI.Provider,{scope:e,children:a.jsx(eie,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>d(m=>m+1),[]),onToastRemove:p.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};s3.displayName=wI;var i3="ToastViewport",tie=["F8"],_E="toast.viewportPause",SE="toast.viewportResume",o3=p.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=tie,label:s="Notifications ({hotkey})",...i}=t,o=R0(i3,n),l=Qse(n),c=p.useRef(null),u=p.useRef(null),d=p.useRef(null),h=p.useRef(null),f=yn(e,h,o.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;p.useEffect(()=>{const v=w=>{var C;r.length!==0&&r.every(T=>w[T]||w.code===T)&&((C=h.current)==null||C.focus())};return document.addEventListener("keydown",v),()=>document.removeEventListener("keydown",v)},[r]),p.useEffect(()=>{const v=c.current,w=h.current;if(g&&v&&w){const _=()=>{if(!o.isClosePausedRef.current){const A=new CustomEvent(_E);w.dispatchEvent(A),o.isClosePausedRef.current=!0}},C=()=>{if(o.isClosePausedRef.current){const A=new CustomEvent(SE);w.dispatchEvent(A),o.isClosePausedRef.current=!1}},T=A=>{!v.contains(A.relatedTarget)&&C()},R=()=>{v.contains(document.activeElement)||C()};return v.addEventListener("focusin",_),v.addEventListener("focusout",T),v.addEventListener("pointermove",_),v.addEventListener("pointerleave",R),window.addEventListener("blur",_),window.addEventListener("focus",C),()=>{v.removeEventListener("focusin",_),v.removeEventListener("focusout",T),v.removeEventListener("pointermove",_),v.removeEventListener("pointerleave",R),window.removeEventListener("blur",_),window.removeEventListener("focus",C)}}},[g,o.isClosePausedRef]);const x=p.useCallback(({tabbingDirection:v})=>{const _=l().map(C=>{const T=C.ref.current,R=[T,...mie(T)];return v==="forwards"?R:R.reverse()});return(v==="forwards"?_.reverse():_).flat()},[l]);return p.useEffect(()=>{const v=h.current;if(v){const w=_=>{var R,A,E;const C=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!C){const I=document.activeElement,N=_.shiftKey;if(_.target===v&&N){(R=u.current)==null||R.focus();return}const D=x({tabbingDirection:N?"backwards":"forwards"}),L=D.findIndex(G=>G===I);W_(D.slice(L+1))?_.preventDefault():N?(A=u.current)==null||A.focus():(E=d.current)==null||E.focus()}};return v.addEventListener("keydown",w),()=>v.removeEventListener("keydown",w)}},[l,x]),a.jsxs(Bse,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&a.jsx(CE,{ref:u,onFocusFromOutsideViewport:()=>{const v=x({tabbingDirection:"forwards"});W_(v)}}),a.jsx(bI.Slot,{scope:n,children:a.jsx(Yt.ol,{tabIndex:-1,...i,ref:f})}),g&&a.jsx(CE,{ref:d,onFocusFromOutsideViewport:()=>{const v=x({tabbingDirection:"backwards"});W_(v)}})]})});o3.displayName=i3;var a3="ToastFocusProxy",CE=p.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=R0(a3,n);return a.jsx(vI,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&r()}})});CE.displayName=a3;var bg="Toast",nie="toast.swipeStart",rie="toast.swipeMove",sie="toast.swipeCancel",iie="toast.swipeEnd",l3=p.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[l,c]=Fc({prop:r,defaultProp:s??!0,onChange:i,caller:bg});return a.jsx(xs,{present:n||l,children:a.jsx(lie,{open:l,...o,ref:e,onClose:()=>c(!1),onPause:Vr(t.onPause),onResume:Vr(t.onResume),onSwipeStart:gt(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:gt(t.onSwipeMove,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:gt(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:gt(t.onSwipeEnd,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});l3.displayName=bg;var[oie,aie]=r3(bg,{onClose(){}}),lie=p.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...g}=t,x=R0(bg,n),[v,w]=p.useState(null),_=yn(e,G=>w(G)),C=p.useRef(null),T=p.useRef(null),R=s||x.duration,A=p.useRef(0),E=p.useRef(R),I=p.useRef(0),{onToastAdd:N,onToastRemove:k}=x,j=Vr(()=>{var B;(v==null?void 0:v.contains(document.activeElement))&&((B=x.viewport)==null||B.focus()),o()}),D=p.useCallback(G=>{!G||G===1/0||(window.clearTimeout(I.current),A.current=new Date().getTime(),I.current=window.setTimeout(j,G))},[j]);p.useEffect(()=>{const G=x.viewport;if(G){const B=()=>{D(E.current),u==null||u()},W=()=>{const X=new Date().getTime()-A.current;E.current=E.current-X,window.clearTimeout(I.current),c==null||c()};return G.addEventListener(_E,W),G.addEventListener(SE,B),()=>{G.removeEventListener(_E,W),G.removeEventListener(SE,B)}}},[x.viewport,R,c,u,D]),p.useEffect(()=>{i&&!x.isClosePausedRef.current&&D(R)},[i,R,x.isClosePausedRef,D]),p.useEffect(()=>(N(),()=>k()),[N,k]);const L=p.useMemo(()=>v?p3(v):null,[v]);return x.viewport?a.jsxs(a.Fragment,{children:[L&&a.jsx(cie,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:L}),a.jsx(oie,{scope:n,onClose:j,children:ml.createPortal(a.jsx(bI.ItemSlot,{scope:n,children:a.jsx(Use,{asChild:!0,onEscapeKeyDown:gt(l,()=>{x.isFocusedToastEscapeKeyDownRef.current||j(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(Yt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":x.swipeDirection,...g,ref:_,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:gt(t.onKeyDown,G=>{G.key==="Escape"&&(l==null||l(G.nativeEvent),G.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,j()))}),onPointerDown:gt(t.onPointerDown,G=>{G.button===0&&(C.current={x:G.clientX,y:G.clientY})}),onPointerMove:gt(t.onPointerMove,G=>{if(!C.current)return;const B=G.clientX-C.current.x,W=G.clientY-C.current.y,X=!!T.current,H=["left","right"].includes(x.swipeDirection),K=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,V=H?K(0,B):0,$=H?0:K(0,W),z=G.pointerType==="touch"?10:2,F={x:V,y:$},Z={originalEvent:G,delta:F};X?(T.current=F,$y(rie,h,Z,{discrete:!1})):u2(F,x.swipeDirection,z)?(T.current=F,$y(nie,d,Z,{discrete:!1}),G.target.setPointerCapture(G.pointerId)):(Math.abs(B)>z||Math.abs(W)>z)&&(C.current=null)}),onPointerUp:gt(t.onPointerUp,G=>{const B=T.current,W=G.target;if(W.hasPointerCapture(G.pointerId)&&W.releasePointerCapture(G.pointerId),T.current=null,C.current=null,B){const X=G.currentTarget,H={originalEvent:G,delta:B};u2(B,x.swipeDirection,x.swipeThreshold)?$y(iie,m,H,{discrete:!0}):$y(sie,f,H,{discrete:!0}),X.addEventListener("click",K=>K.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),cie=t=>{const{__scopeToast:e,children:n,...r}=t,s=R0(bg,e),[i,o]=p.useState(!1),[l,c]=p.useState(!1);return hie(()=>o(!0)),p.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:a.jsx(wg,{asChild:!0,children:a.jsx(vI,{...r,children:i&&a.jsxs(a.Fragment,{children:[s.label," ",n]})})})},uie="ToastTitle",c3=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});c3.displayName=uie;var die="ToastDescription",u3=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});u3.displayName=die;var d3="ToastAction",h3=p.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?a.jsx(m3,{altText:n,asChild:!0,children:a.jsx(_I,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${d3}\`. Expected non-empty \`string\`.`),null)});h3.displayName=d3;var f3="ToastClose",_I=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=aie(f3,n);return a.jsx(m3,{asChild:!0,children:a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,s.onClose)})})});_I.displayName=f3;var m3=p.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return a.jsx(Yt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function p3(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),fie(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...p3(r))}}),e}function $y(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?xI(s,i):s.dispatchEvent(i)}var u2=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function hie(t=()=>{}){const e=Vr(t);va(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function fie(t){return t.nodeType===t.ELEMENT_NODE}function mie(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function W_(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var pie=s3,g3=o3,y3=l3,x3=c3,v3=u3,w3=h3,b3=_I;const d2=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,h2=T$,SI=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return h2(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=d2(d)||d2(h);return s[u][f]}),l=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:f,...m}=d;return Object.entries(m).every(g=>{let[x,v]=g;return Array.isArray(v)?v.includes({...i,...l}[x]):{...i,...l}[x]===v})?[...u,h,f]:u},[]);return h2(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};var gie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const yie=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),Ke=(t,e)=>{const n=p.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},u)=>p.createElement("svg",{ref:u,...gie,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${yie(t)}`,...c},[...e.map(([d,h])=>p.createElement(d,h)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${t}`,n},H_=Ke("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),_g=Ke("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Vo=Ke("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),ku=Ke("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),xie=Ke("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),vie=Ke("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Kv=Ke("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),wie=Ke("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),bie=Ke("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),CI=Ke("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),fa=Ke("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Sg=Ke("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Su=Ke("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),_ie=Ke("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),_3=Ke("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Sie=Ke("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),Cie=Ke("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),EI=Ke("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Po=Ke("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),f2=Ke("DownloadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]]),TI=Ke("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Wh=Ke("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Eie=Ke("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Tie=Ke("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),Sr=Ke("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),S3=Ke("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),Ru=Ke("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),q_=Ke("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),m2=Ke("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),C3=Ke("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Iie=Ke("ImageDown",[["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10.8",key:"sqts6f"}],["path",{d:"m21 15-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"1h47z9"}],["path",{d:"m14 19.5 3 3v-6",key:"1x9jmo"}],["path",{d:"m17 22.5 3-3",key:"xzuz0n"}]]),E3=Ke("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),EE=Ke("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Nie=Ke("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Ux=Ke("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Pie=Ke("Layers3",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m6.08 9.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1e5n1m"}],["path",{d:"m6.08 14.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1iwflc"}]]),Aie=Ke("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),kie=Ke("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),Rie=Ke("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),ft=Ke("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),T3=Ke("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),p2=Ke("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),oh=Ke("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),jie=Ke("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),Die=Ke("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),I3=Ke("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),Mie=Ke("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),Lie=Ke("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),TE=Ke("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),Fie=Ke("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]),N3=Ke("MoveDown",[["path",{d:"M8 18L12 22L16 18",key:"cskvfv"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),P3=Ke("MoveUp",[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),Mi=Ke("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Yv=Ke("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),Oie=Ke("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),Vie=Ke("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),Jv=Ke("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),Lp=Ke("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),g2=Ke("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),A3=Ke("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),$ie=Ke("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),Uie=Ke("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),II=Ke("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Li=Ke("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Cu=Ke("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),Xv=Ke("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),k3=Ke("Replace",[["path",{d:"M14 4c0-1.1.9-2 2-2",key:"1mvvbw"}],["path",{d:"M20 2c1.1 0 2 .9 2 2",key:"1mj6oe"}],["path",{d:"M22 8c0 1.1-.9 2-2 2",key:"v1wql3"}],["path",{d:"M16 10c-1.1 0-2-.9-2-2",key:"821ux0"}],["path",{d:"m3 7 3 3 3-3",key:"x25e72"}],["path",{d:"M6 10V5c0-1.7 1.3-3 3-3h1",key:"13af7h"}],["rect",{width:"8",height:"8",x:"2",y:"14",rx:"2",key:"17ihk4"}]]),Bie=Ke("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),K_=Ke("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),Qv=Ke("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),ju=Ke("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),zie=Ke("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),Gie=Ke("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),Sh=Ke("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),Wie=Ke("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),Hie=Ke("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),Fp=Ke("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Er=Ke("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),NI=Ke("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),qie=Ke("StopCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{width:"6",height:"6",x:"9",y:"9",key:"1wrtvo"}]]),Uy=Ke("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),IE=Ke("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Bm=Ke("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),R3=Ke("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Fn=Ke("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Xf=Ke("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Zv=Ke("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),Kie=Ke("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),Yie=Ke("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Lo=Ke("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]),j3=Ke("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Jie=Ke("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),j0=Ke("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),y2=Ke("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),wa=Ke("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),ma=Ke("Wand",[["path",{d:"M15 4V2",key:"z1p9b7"}],["path",{d:"M15 16v-2",key:"px0unx"}],["path",{d:"M8 9h2",key:"1g203m"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M17.8 11.8 19 13",key:"yihg8r"}],["path",{d:"M15 9h0",key:"kg5t1u"}],["path",{d:"M17.8 6.2 19 5",key:"fd4us0"}],["path",{d:"m3 21 9-9",key:"1jfql5"}],["path",{d:"M12.2 6.2 11 5",key:"i3da3b"}]]),ew=Ke("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Wi=Ke("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Xie=Ke("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),D3=Ke("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),Qie=pie,M3=ht.forwardRef(({className:t,...e},n)=>a.jsx(g3,{ref:n,className:bt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));M3.displayName=g3.displayName;const Zie=SI("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),L3=ht.forwardRef(({className:t,variant:e,...n},r)=>a.jsx(y3,{ref:r,className:bt(Zie({variant:e}),t),...n}));L3.displayName=y3.displayName;const eoe=ht.forwardRef(({className:t,...e},n)=>a.jsx(w3,{ref:n,className:bt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));eoe.displayName=w3.displayName;const F3=ht.forwardRef(({className:t,...e},n)=>a.jsx(b3,{ref:n,className:bt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:a.jsx(Wi,{className:"h-4 w-4"})}));F3.displayName=b3.displayName;const O3=ht.forwardRef(({className:t,...e},n)=>a.jsx(x3,{ref:n,className:bt("text-sm font-semibold",t),...e}));O3.displayName=x3.displayName;const V3=ht.forwardRef(({className:t,...e},n)=>a.jsx(v3,{ref:n,className:bt("text-sm opacity-90",t),...e}));V3.displayName=v3.displayName;const toe=1;let Y_=0;function noe(){return Y_=(Y_+1)%Number.MAX_VALUE,Y_.toString()}const Gs={state:{toasts:[]},listeners:[],getState:()=>Gs.state,setState:t=>{typeof t=="function"?Gs.state=t(Gs.state):Gs.state={...Gs.state,...t},Gs.listeners.forEach(e=>e(Gs.state))},subscribe:t=>(Gs.listeners.push(t),()=>{Gs.listeners=Gs.listeners.filter(e=>e!==t)})},roe=({...t})=>{const e=noe(),n=s=>Gs.setState(i=>({...i,toasts:i.toasts.map(o=>o.id===e?{...o,...s}:o)})),r=()=>Gs.setState(s=>({...s,toasts:s.toasts.filter(i=>i.id!==e)}));return Gs.setState(s=>({...s,toasts:[{...t,id:e,dismiss:r},...s.toasts].slice(0,toe)})),{id:e,dismiss:r,update:n}};function vs(){const[t,e]=p.useState(Gs.getState());return p.useEffect(()=>Gs.subscribe(r=>{e(r)}),[]),p.useEffect(()=>{const n=[];return t.toasts.forEach(r=>{if(r.duration===1/0)return;const s=setTimeout(()=>{r.dismiss()},r.duration||5e3);n.push(s)}),()=>{n.forEach(r=>clearTimeout(r))}},[t.toasts]),{toast:roe,toasts:t.toasts}}function soe(){const{toasts:t}=vs();return a.jsxs(Qie,{children:[t.map(({id:e,title:n,description:r,action:s,dismiss:i,...o})=>a.jsxs(L3,{...o,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(O3,{children:n}),r&&a.jsx(V3,{children:r})]}),s,a.jsx(F3,{})]},e)),a.jsx(M3,{})]})}var ioe=i0[" useId ".trim().toString()]||(()=>{}),ooe=0;function ic(t){const[e,n]=p.useState(ioe());return va(()=>{t||n(r=>r??String(ooe++))},[t]),t||(e?`radix-${e}`:"")}var J_="focusScope.autoFocusOnMount",X_="focusScope.autoFocusOnUnmount",x2={bubbles:!1,cancelable:!0},aoe="FocusScope",D0=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=Vr(s),d=Vr(i),h=p.useRef(null),f=yn(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(C){if(m.paused||!l)return;const T=C.target;l.contains(T)?h.current=T:jl(h.current,{select:!0})},v=function(C){if(m.paused||!l)return;const T=C.relatedTarget;T!==null&&(l.contains(T)||jl(h.current,{select:!0}))},w=function(C){if(document.activeElement===document.body)for(const R of C)R.removedNodes.length>0&&jl(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",v);const _=new MutationObserver(w);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",v),_.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){w2.add(m);const x=document.activeElement;if(!l.contains(x)){const w=new CustomEvent(J_,x2);l.addEventListener(J_,u),l.dispatchEvent(w),w.defaultPrevented||(loe(foe($3(l)),{select:!0}),document.activeElement===x&&jl(l))}return()=>{l.removeEventListener(J_,u),setTimeout(()=>{const w=new CustomEvent(X_,x2);l.addEventListener(X_,d),l.dispatchEvent(w),w.defaultPrevented||jl(x??document.body,{select:!0}),l.removeEventListener(X_,d),w2.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const v=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,w=document.activeElement;if(v&&w){const _=x.currentTarget,[C,T]=coe(_);C&&T?!x.shiftKey&&w===T?(x.preventDefault(),n&&jl(C,{select:!0})):x.shiftKey&&w===C&&(x.preventDefault(),n&&jl(T,{select:!0})):w===_&&x.preventDefault()}},[n,r,m.paused]);return a.jsx(Yt.div,{tabIndex:-1,...o,ref:f,onKeyDown:g})});D0.displayName=aoe;function loe(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(jl(r,{select:e}),document.activeElement!==n)return}function coe(t){const e=$3(t),n=v2(e,t),r=v2(e.reverse(),t);return[n,r]}function $3(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function v2(t,e){for(const n of t)if(!uoe(n,{upTo:e}))return n}function uoe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function doe(t){return t instanceof HTMLInputElement&&"select"in t}function jl(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&doe(t)&&e&&t.select()}}var w2=hoe();function hoe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=b2(t,e),t.unshift(e)},remove(e){var n;t=b2(t,e),(n=t[0])==null||n.resume()}}}function b2(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function foe(t){return t.filter(e=>e.tagName!=="A")}var Q_=0;function PI(){p.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??_2()),document.body.insertAdjacentElement("beforeend",t[1]??_2()),Q_++,()=>{Q_===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Q_--}},[])}function _2(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var ks=function(){return ks=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ks.apply(this,arguments)};function bf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function U3(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var zm="right-scroll-bar-position",Gm="width-before-scroll-bar",moe="with-scroll-bars-hidden",poe="--removed-body-scroll-bar-size";function Z_(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function goe(t,e){var n=p.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var yoe=typeof window<"u"?p.useLayoutEffect:p.useEffect,S2=new WeakMap;function B3(t,e){var n=goe(e||null,function(r){return t.forEach(function(s){return Z_(s,r)})});return yoe(function(){var r=S2.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(l){i.has(l)||Z_(l,null)}),i.forEach(function(l){s.has(l)||Z_(l,o)})}S2.set(n,t)},[t]),n}function xoe(t){return t}function voe(t,e){e===void 0&&(e=xoe);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(i),o=n}var c=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return s}function z3(t){t===void 0&&(t={});var e=voe(null);return e.options=ks({async:!0,ssr:!1},t),e}var G3=function(t){var e=t.sideCar,n=bf(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return p.createElement(r,ks({},n))};G3.isSideCarExport=!0;function W3(t,e){return t.useMedium(e),G3}var H3=z3(),eS=function(){},M0=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:eS,onWheelCapture:eS,onTouchMoveCapture:eS}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noRelative,g=t.noIsolation,x=t.inert,v=t.allowPinchZoom,w=t.as,_=w===void 0?"div":w,C=t.gapMode,T=bf(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),R=f,A=B3([n,e]),E=ks(ks({},T),s);return p.createElement(p.Fragment,null,d&&p.createElement(R,{sideCar:H3,removeScrollBar:u,shards:h,noRelative:m,noIsolation:g,inert:x,setCallbacks:i,allowPinchZoom:!!v,lockRef:n,gapMode:C}),o?p.cloneElement(p.Children.only(l),ks(ks({},E),{ref:A})):p.createElement(_,ks({},E,{className:c,ref:A}),l))});M0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};M0.classNames={fullWidth:Gm,zeroRight:zm};var C2,woe=function(){if(C2)return C2;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function boe(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=woe();return e&&t.setAttribute("nonce",e),t}function _oe(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Soe(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Coe=function(){var t=0,e=null;return{add:function(n){t==0&&(e=boe())&&(_oe(e,n),Soe(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Eoe=function(){var t=Coe();return function(e,n){p.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},AI=function(){var t=Eoe(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},Toe={left:0,top:0,right:0,gap:0},tS=function(t){return parseInt(t||"",10)||0},Ioe=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[tS(n),tS(r),tS(s)]},Noe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Toe;var e=Ioe(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},Poe=AI(),Ch="data-scroll-locked",Aoe=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,l=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(moe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(Ch,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zm,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Gm,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(zm," .").concat(zm,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Gm," .").concat(Gm,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ch,`] {
    `).concat(poe,": ").concat(l,`px;
  }
`)},E2=function(){var t=parseInt(document.body.getAttribute(Ch)||"0",10);return isFinite(t)?t:0},koe=function(){p.useEffect(function(){return document.body.setAttribute(Ch,(E2()+1).toString()),function(){var t=E2()-1;t<=0?document.body.removeAttribute(Ch):document.body.setAttribute(Ch,t.toString())}},[])},q3=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;koe();var i=p.useMemo(function(){return Noe(s)},[s]);return p.createElement(Poe,{styles:Aoe(i,!e,s,n?"":"!important")})},NE=!1;if(typeof window<"u")try{var By=Object.defineProperty({},"passive",{get:function(){return NE=!0,!0}});window.addEventListener("test",By,By),window.removeEventListener("test",By,By)}catch{NE=!1}var Cd=NE?{passive:!1}:!1,Roe=function(t){return t.tagName==="TEXTAREA"},K3=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Roe(t)&&n[e]==="visible")},joe=function(t){return K3(t,"overflowY")},Doe=function(t){return K3(t,"overflowX")},T2=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=Y3(t,r);if(s){var i=J3(t,r),o=i[1],l=i[2];if(o>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},Moe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},Loe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},Y3=function(t,e){return t==="v"?joe(e):Doe(e)},J3=function(t,e){return t==="v"?Moe(e):Loe(e)},Foe=function(t,e){return t==="h"&&e==="rtl"?-1:1},Ooe=function(t,e,n,r,s){var i=Foe(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=J3(t,l),g=m[0],x=m[1],v=m[2],w=x-v-i*g;(g||w)&&Y3(t,l)&&(h+=w,f+=g),l=l.parentNode.host||l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&Math.abs(h)<1||!s&&o>h)||!d&&(s&&Math.abs(f)<1||!s&&-o>f))&&(u=!0),u},zy=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},I2=function(t){return[t.deltaX,t.deltaY]},N2=function(t){return t&&"current"in t?t.current:t},Voe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},$oe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Uoe=0,Ed=[];function Boe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(Uoe++)[0],i=p.useState(AI)[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=U3([t.lockRef.current],(t.shards||[]).map(N2),!0).filter(Boolean);return x.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,v){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var w=zy(x),_=n.current,C="deltaX"in x?x.deltaX:_[0]-w[0],T="deltaY"in x?x.deltaY:_[1]-w[1],R,A=x.target,E=Math.abs(C)>Math.abs(T)?"h":"v";if("touches"in x&&E==="h"&&A.type==="range")return!1;var I=T2(E,A);if(!I)return!0;if(I?R=E:(R=E==="v"?"h":"v",I=T2(E,A)),!I)return!1;if(!r.current&&"changedTouches"in x&&(C||T)&&(r.current=R),!R)return!0;var N=r.current||R;return Ooe(N,v,x,N==="h"?C:T,!0)},[]),c=p.useCallback(function(x){var v=x;if(!(!Ed.length||Ed[Ed.length-1]!==i)){var w="deltaY"in v?I2(v):zy(v),_=e.current.filter(function(R){return R.name===v.type&&(R.target===v.target||v.target===R.shadowParent)&&Voe(R.delta,w)})[0];if(_&&_.should){v.cancelable&&v.preventDefault();return}if(!_){var C=(o.current.shards||[]).map(N2).filter(Boolean).filter(function(R){return R.contains(v.target)}),T=C.length>0?l(v,C[0]):!o.current.noIsolation;T&&v.cancelable&&v.preventDefault()}}},[]),u=p.useCallback(function(x,v,w,_){var C={name:x,delta:v,target:w,should:_,shadowParent:zoe(w)};e.current.push(C),setTimeout(function(){e.current=e.current.filter(function(T){return T!==C})},1)},[]),d=p.useCallback(function(x){n.current=zy(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,I2(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,zy(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return Ed.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Cd),document.addEventListener("touchmove",c,Cd),document.addEventListener("touchstart",d,Cd),function(){Ed=Ed.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,Cd),document.removeEventListener("touchmove",c,Cd),document.removeEventListener("touchstart",d,Cd)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:$oe(s)}):null,m?p.createElement(q3,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function zoe(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Goe=W3(H3,Boe);var X3=p.forwardRef(function(t,e){return p.createElement(M0,ks({},t,{ref:e,sideCar:Goe}))});X3.classNames=M0.classNames;const kI=X3;var Woe=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Td=new WeakMap,Gy=new WeakMap,Wy={},nS=0,Q3=function(t){return t&&(t.host||Q3(t.parentNode))},Hoe=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=Q3(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},qoe=function(t,e,n,r){var s=Hoe(e,Array.isArray(t)?t:[t]);Wy[n]||(Wy[n]=new WeakMap);var i=Wy[n],o=[],l=new Set,c=new Set(s),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};s.forEach(u);var d=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))d(f);else try{var m=f.getAttribute(r),g=m!==null&&m!=="false",x=(Td.get(f)||0)+1,v=(i.get(f)||0)+1;Td.set(f,x),i.set(f,v),o.push(f),x===1&&g&&Gy.set(f,!0),v===1&&f.setAttribute(n,"true"),g||f.setAttribute(r,"true")}catch(w){console.error("aria-hidden: cannot operate on ",f,w)}})};return d(e),l.clear(),nS++,function(){o.forEach(function(h){var f=Td.get(h)-1,m=i.get(h)-1;Td.set(h,f),i.set(h,m),f||(Gy.has(h)||h.removeAttribute(r),Gy.delete(h)),m||h.removeAttribute(n)}),nS--,nS||(Td=new WeakMap,Td=new WeakMap,Gy=new WeakMap,Wy={})}},L0=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=e||Woe(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),qoe(r,s,n,"aria-hidden")):function(){return null}},F0="Dialog",[Z3,eU]=wi(F0),[Koe,Go]=Z3(F0),tU=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,l=p.useRef(null),c=p.useRef(null),[u,d]=Fc({prop:r,defaultProp:s??!1,onChange:i,caller:F0});return a.jsx(Koe,{scope:e,triggerRef:l,contentRef:c,contentId:ic(),titleId:ic(),descriptionId:ic(),open:u,onOpenChange:d,onOpenToggle:p.useCallback(()=>d(h=>!h),[d]),modal:o,children:n})};tU.displayName=F0;var nU="DialogTrigger",rU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Go(nU,n),i=yn(e,s.triggerRef);return a.jsx(Yt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":DI(s.open),...r,ref:i,onClick:gt(t.onClick,s.onOpenToggle)})});rU.displayName=nU;var RI="DialogPortal",[Yoe,sU]=Z3(RI,{forceMount:void 0}),iU=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=Go(RI,e);return a.jsx(Yoe,{scope:e,forceMount:n,children:p.Children.map(r,o=>a.jsx(xs,{present:n||i.open,children:a.jsx(wg,{asChild:!0,container:s,children:o})}))})};iU.displayName=RI;var tw="DialogOverlay",oU=p.forwardRef((t,e)=>{const n=sU(tw,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Go(tw,t.__scopeDialog);return i.modal?a.jsx(xs,{present:r||i.open,children:a.jsx(Xoe,{...s,ref:e})}):null});oU.displayName=tw;var Joe=Gu("DialogOverlay.RemoveScroll"),Xoe=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Go(tw,n);return a.jsx(kI,{as:Joe,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(Yt.div,{"data-state":DI(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Wu="DialogContent",aU=p.forwardRef((t,e)=>{const n=sU(Wu,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Go(Wu,t.__scopeDialog);return a.jsx(xs,{present:r||i.open,children:i.modal?a.jsx(Qoe,{...s,ref:e}):a.jsx(Zoe,{...s,ref:e})})});aU.displayName=Wu;var Qoe=p.forwardRef((t,e)=>{const n=Go(Wu,t.__scopeDialog),r=p.useRef(null),s=yn(e,n.contentRef,r);return p.useEffect(()=>{const i=r.current;if(i)return L0(i)},[]),a.jsx(lU,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gt(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:gt(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:gt(t.onFocusOutside,i=>i.preventDefault())})}),Zoe=p.forwardRef((t,e)=>{const n=Go(Wu,t.__scopeDialog),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(lU,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),lU=p.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,l=Go(Wu,n),c=p.useRef(null),u=yn(e,c);return PI(),a.jsxs(a.Fragment,{children:[a.jsx(D0,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(vg,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":DI(l.open),...o,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(tae,{titleId:l.titleId}),a.jsx(rae,{contentRef:c,descriptionId:l.descriptionId})]})]})}),jI="DialogTitle",cU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Go(jI,n);return a.jsx(Yt.h2,{id:s.titleId,...r,ref:e})});cU.displayName=jI;var uU="DialogDescription",dU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Go(uU,n);return a.jsx(Yt.p,{id:s.descriptionId,...r,ref:e})});dU.displayName=uU;var hU="DialogClose",fU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Go(hU,n);return a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,()=>s.onOpenChange(!1))})});fU.displayName=hU;function DI(t){return t?"open":"closed"}var mU="DialogTitleWarning",[eae,pU]=Ese(mU,{contentName:Wu,titleName:jI,docsSlug:"dialog"}),tae=({titleId:t})=>{const e=pU(mU),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return p.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},nae="DialogDescriptionWarning",rae=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${pU(nae).contentName}}.`;return p.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},gU=tU,sae=rU,yU=iU,MI=oU,LI=aU,FI=cU,OI=dU,O0=fU;const Yr=gU,iae=yU,rl=O0,xU=ht.forwardRef(({className:t,...e},n)=>a.jsx(MI,{ref:n,className:bt("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));xU.displayName=MI.displayName;const $r=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(iae,{children:[a.jsx(xU,{}),a.jsxs(LI,{ref:r,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,a.jsxs(O0,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(Wi,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));$r.displayName=LI.displayName;const Ur=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Ur.displayName="DialogHeader";const Ar=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});Ar.displayName="DialogFooter";const Br=ht.forwardRef(({className:t,...e},n)=>a.jsx(FI,{ref:n,className:bt("text-lg font-semibold leading-none tracking-tight",t),...e}));Br.displayName=FI.displayName;const Ji=ht.forwardRef(({className:t,...e},n)=>a.jsx(OI,{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));Ji.displayName=OI.displayName;const VI=SI("inline-flex items-center justify-center rounded-xl text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-foreground text-primary-foreground hover:bg-foreground/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-xl px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10 rounded-xl"}},defaultVariants:{variant:"default",size:"default"}}),O=ht.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?Ise:"button";return a.jsx(o,{className:bt(VI({variant:e,size:n,className:t})),ref:i,...s})});O.displayName="Button";const Je=ht.forwardRef(({className:t,type:e,...n},r)=>a.jsx("input",{type:e,className:bt("flex h-10 w-full rounded-xl bg-white dark:bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));Je.displayName="Input";const En=ht.forwardRef(({className:t,...e},n)=>a.jsx("textarea",{className:bt("flex min-h-[80px] w-full rounded-xl bg-white dark:bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));En.displayName="Textarea";var oae="Label",vU=p.forwardRef((t,e)=>a.jsx(Yt.label,{...t,ref:e,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));vU.displayName=oae;var wU=vU;const Re=ht.forwardRef(({className:t,...e},n)=>a.jsx(wU,{ref:n,className:bt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...e}));Re.displayName=wU.displayName;var aae=p.createContext(void 0);function V0(t){const e=p.useContext(aae);return t||e||"ltr"}var rS="rovingFocusGroup.onEntryFocus",lae={bubbles:!1,cancelable:!0},Cg="RovingFocusGroup",[PE,bU,cae]=yI(Cg),[uae,$0]=wi(Cg,[cae]),[dae,hae]=uae(Cg),_U=p.forwardRef((t,e)=>a.jsx(PE.Provider,{scope:t.__scopeRovingFocusGroup,children:a.jsx(PE.Slot,{scope:t.__scopeRovingFocusGroup,children:a.jsx(fae,{...t,ref:e})})}));_U.displayName=Cg;var fae=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=p.useRef(null),m=yn(e,f),g=V0(i),[x,v]=Fc({prop:o,defaultProp:l??null,onChange:c,caller:Cg}),[w,_]=p.useState(!1),C=Vr(u),T=bU(n),R=p.useRef(!1),[A,E]=p.useState(0);return p.useEffect(()=>{const I=f.current;if(I)return I.addEventListener(rS,C),()=>I.removeEventListener(rS,C)},[C]),a.jsx(dae,{scope:n,orientation:r,dir:g,loop:s,currentTabStopId:x,onItemFocus:p.useCallback(I=>v(I),[v]),onItemShiftTab:p.useCallback(()=>_(!0),[]),onFocusableItemAdd:p.useCallback(()=>E(I=>I+1),[]),onFocusableItemRemove:p.useCallback(()=>E(I=>I-1),[]),children:a.jsx(Yt.div,{tabIndex:w||A===0?-1:0,"data-orientation":r,...h,ref:m,style:{outline:"none",...t.style},onMouseDown:gt(t.onMouseDown,()=>{R.current=!0}),onFocus:gt(t.onFocus,I=>{const N=!R.current;if(I.target===I.currentTarget&&N&&!w){const k=new CustomEvent(rS,lae);if(I.currentTarget.dispatchEvent(k),!k.defaultPrevented){const j=T().filter(W=>W.focusable),D=j.find(W=>W.active),L=j.find(W=>W.id===x),B=[D,L,...j].filter(Boolean).map(W=>W.ref.current);EU(B,d)}}R.current=!1}),onBlur:gt(t.onBlur,()=>_(!1))})})}),SU="RovingFocusGroupItem",CU=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:o,...l}=t,c=ic(),u=i||c,d=hae(SU,n),h=d.currentTabStopId===u,f=bU(n),{onFocusableItemAdd:m,onFocusableItemRemove:g,currentTabStopId:x}=d;return p.useEffect(()=>{if(r)return m(),()=>g()},[r,m,g]),a.jsx(PE.ItemSlot,{scope:n,id:u,focusable:r,active:s,children:a.jsx(Yt.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...l,ref:e,onMouseDown:gt(t.onMouseDown,v=>{r?d.onItemFocus(u):v.preventDefault()}),onFocus:gt(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:gt(t.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){d.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const w=gae(v,d.orientation,d.dir);if(w!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let C=f().filter(T=>T.focusable).map(T=>T.ref.current);if(w==="last")C.reverse();else if(w==="prev"||w==="next"){w==="prev"&&C.reverse();const T=C.indexOf(v.currentTarget);C=d.loop?yae(C,T+1):C.slice(T+1)}setTimeout(()=>EU(C))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:x!=null}):o})})});CU.displayName=SU;var mae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function pae(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function gae(t,e,n){const r=pae(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return mae[r]}function EU(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function yae(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var TU=_U,IU=CU,U0="Tabs",[xae,QRe]=wi(U0,[$0]),NU=$0(),[vae,$I]=xae(U0),PU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=t,d=V0(l),[h,f]=Fc({prop:r,onChange:s,defaultProp:i??"",caller:U0});return a.jsx(vae,{scope:n,baseId:ic(),value:h,onValueChange:f,orientation:o,dir:d,activationMode:c,children:a.jsx(Yt.div,{dir:d,"data-orientation":o,...u,ref:e})})});PU.displayName=U0;var AU="TabsList",kU=p.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...s}=t,i=$I(AU,n),o=NU(n);return a.jsx(TU,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:a.jsx(Yt.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});kU.displayName=AU;var RU="TabsTrigger",jU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=t,o=$I(RU,n),l=NU(n),c=LU(o.baseId,r),u=FU(o.baseId,r),d=r===o.value;return a.jsx(IU,{asChild:!0,...l,focusable:!s,active:d,children:a.jsx(Yt.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:e,onMouseDown:gt(t.onMouseDown,h=>{!s&&h.button===0&&h.ctrlKey===!1?o.onValueChange(r):h.preventDefault()}),onKeyDown:gt(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(r)}),onFocus:gt(t.onFocus,()=>{const h=o.activationMode!=="manual";!d&&!s&&h&&o.onValueChange(r)})})})});jU.displayName=RU;var DU="TabsContent",MU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...o}=t,l=$I(DU,n),c=LU(l.baseId,r),u=FU(l.baseId,r),d=r===l.value,h=p.useRef(d);return p.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(xs,{present:s||d,children:({present:f})=>a.jsx(Yt.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});MU.displayName=DU;function LU(t,e){return`${t}-trigger-${e}`}function FU(t,e){return`${t}-content-${e}`}var wae=PU,OU=kU,VU=jU,$U=MU;const bi=wae,ei=ht.forwardRef(({className:t,...e},n)=>a.jsx(OU,{ref:n,className:bt("inline-flex h-10 items-center justify-center rounded-[18px] bg-white dark:bg-[#1c1c1c] p-1 text-muted-foreground",t),...e}));ei.displayName=OU.displayName;const $t=ht.forwardRef(({className:t,...e},n)=>a.jsx(VU,{ref:n,className:bt("inline-flex items-center justify-center whitespace-nowrap rounded-xl px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-gray-100 data-[state=active]:dark:bg-zinc-700 data-[state=active]:text-foreground data-[state=active]:shadow-sm data-[state=active]:border data-[state=active]:border-[#8d9499] data-[state=active]:relative data-[state=active]:-top-px",t),...e}));$t.displayName=VU.displayName;const Ut=ht.forwardRef(({className:t,...e},n)=>a.jsx($U,{ref:n,className:bt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Ut.displayName=$U.displayName;var bae="Separator",P2="horizontal",_ae=["horizontal","vertical"],UU=p.forwardRef((t,e)=>{const{decorative:n,orientation:r=P2,...s}=t,i=Sae(r)?r:P2,l=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return a.jsx(Yt.div,{"data-orientation":i,...l,...s,ref:e})});UU.displayName=bae;function Sae(t){return _ae.includes(t)}var BU=UU;const Oi=ht.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...r},s)=>a.jsx(BU,{ref:s,decorative:n,orientation:e,className:bt("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));Oi.displayName=BU.displayName;const zU="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s";console.log("[geminiImageGeneration Module] VITE_GEMINI_API_KEY loaded:",`"${zU.substring(0,5)}..."`);const GU="YsU4YZtXedeyLPn6bQaNT8PD";console.log("[geminiImageGeneration Module] VITE_REMOVE_BG_API_KEY loaded:",`"${GU.substring(0,5)}..."`);const xl=zU,UI=GU,Ea=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_NONE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_NONE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_NONE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_NONE}];async function Cae(t,e,n){var r;try{const s=[{inlineData:{mimeType:e,data:t}},{text:"Describe the main colors of this logo. Is it primarily black, white, or colorful? If black or white, state which. If colorful, list the dominant colors."}],i=await n.models.generateContent({model:"gemini-2.0-flash",contents:s,safetySettings:Ea,config:{responseModalities:[wn.TEXT]}}),o=((r=i==null?void 0:i.text)==null?void 0:r.toLowerCase())||"";return console.log("[getLogoColorType] Gemini color description:",o),o.includes("primarily black")||o.includes("black logo")?"black":o.includes("primarily white")||o.includes("white logo")?"white":(o.includes("colorful")||o.includes("multiple colors")||o.includes("various colors")||console.warn("[getLogoColorType] Could not clearly determine logo color type. Defaulting to 'colored'. Desc:",o),"colored")}catch(s){return console.error("[getLogoColorType] Error analyzing logo color:",s),"colored"}}async function Eg(t,e=(n,r)=>console.log(`Logo Progress: ${n}%, Message: ${r||""}`)){var l,c,u,d;if(!t)throw new Error("Store name is required.");const n=new On({apiKey:xl}),r=`Create a modern, clean, and professional logo for an e-commerce store named "${t}". The logo should be suitable for a website header. Avoid text in the logo itself, or if text is present, ensure it is "${t}" and highly legible. Focus on an iconic and memorable design. Generate a square image. The main subject of the logo should be prominent.`;let s="",i=null,o=null;try{console.log("[generateLogoWithGemini] Generating initial logo for:",t),e(void 0,`Generating initial logo for ${t}...`);const h=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});if((u=(c=(l=h.candidates)==null?void 0:l[0])==null?void 0:c.content)!=null&&u.parts){for(const _ of h.candidates[0].content.parts)if(_.text)s+=_.text;else if((d=_.inlineData)!=null&&d.data){i=_.inlineData.data,o=_.inlineData.mimeType;break}}if(!i)throw new Error("Failed to generate initial image data. "+(s||"No text explanation."));console.log("[generateLogoWithGemini] Initial logo generated. MimeType:",o);let f=null,m=null,g=i,x=o;if(UI)try{console.log("[generateLogoWithGemini] Removing background."),e(void 0,"Removing logo background..."),g=await WU(i,o),x="image/png",console.log("[generateLogoWithGemini] Background removed."),e(void 0,"Background removed.")}catch(_){console.warn("[generateLogoWithGemini] BG removal failed, using original:",_.message),e(void 0,"Background removal failed.")}const v=await Cae(g,x,n),w=`data:${x};base64,${g}`;if(v==="black"){m=w;try{const _=await $o(g,x,"Convert this black logo to a white logo, maintaining transparency and all details precisely. Output only the modified image.");if(_.editedImageData)f=`data:${_.newMimeType};base64,${_.editedImageData}`;else throw new Error("Inversion to white failed.")}catch(_){console.warn("[generateLogoWithGemini] Failed to make white version:",_.message),f=w}}else if(v==="white"){f=w;try{const _=await $o(g,x,"Convert this white logo to a black logo, maintaining transparency and all details precisely. Output only the modified image.");if(_.editedImageData)m=`data:${_.newMimeType};base64,${_.editedImageData}`;else throw new Error("Inversion to black failed.")}catch(_){console.warn("[generateLogoWithGemini] Failed to make black version:",_.message),m=w}}else f=w,m=w;return{logoUrlLight:f,logoUrlDark:m,textResponse:s}}catch(h){throw console.error("[generateLogoWithGemini] Main error:",h.message,h.stack),new Error(`Logo generation failed: ${h.message||"Unknown error"}`)}}async function ia(t,e,n){return console.warn("Skipping image caption generation due to environment limitations."),["Generated image description."]}function Eae(t,e){const n=atob(t),r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return new Blob([new Uint8Array(r)],{type:e})}async function WU(t,e){const n=Eae(t,e),r=new FormData;r.append("size","auto"),r.append("image_file",n,"logo_temp"+(e.startsWith("image/")?"."+e.substring(6):".bin")),r.append("format","png");try{const s=await fetch("https://api.remove.bg/v1.0/removebg",{method:"POST",headers:{"X-Api-Key":UI},body:r});if(!s.ok){const o=await s.text();throw new Error(`Remove.bg API Error ${s.status}: ${o}`)}const i=await s.arrayBuffer();return btoa(new Uint8Array(i).reduce((o,l)=>o+String.fromCharCode(l),""))}catch(s){throw console.error("[removeBackgroundFromLogo] Error:",s.message),s}}async function $o(t,e,n){var i,o,l,c;if(!t||!e||!n)throw new Error("Image data, MIME type, and prompt required.");const r=new On({apiKey:xl}),s=[{text:n},{inlineData:{mimeType:e,data:t}}];try{const u=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:s,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let d=null,h="",f=e;if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)h+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,f=m.inlineData.mimeType||e;break}}if(!d)throw new Error("Failed to edit image. "+(h||"No text explanation."));return{editedImageData:d,newMimeType:f,editTextResponse:h}}catch(u){throw console.error("[editImageWithGemini] Error:",u.message),new Error(`Image editing failed: ${u.message||"Unknown error"}`)}}async function HU(t,e){var s,i,o,l;if(!t)throw new Error("Product name required.");const n=new On({apiKey:xl});let r=`Generate a clean, commercial-style product image for "${t}".`;e&&(r+=` Description: "${e}".`),r+=" Main focus on product, simple/neutral/white background for e-commerce. Square image.";try{const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let u=null,d="",h="image/png";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)d+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,h=f.inlineData.mimeType||"image/png";break}}if(!u)throw new Error("Failed to generate product image. "+(d||"No text explanation."));if(UI)try{return{imageData:await WU(u,h),textResponse:d}}catch(f){console.warn("[generateGenericProductImageWithGemini] BG removal failed, using original:",f.message)}return{imageData:u,textResponse:d}}catch(c){throw console.error("[generateGenericProductImageWithGemini] Error:",c.message),new Error(`Product image generation failed: ${c.message||"Unknown error"}`)}}async function Tg({prompt:t,referenceImage:e}){var i,o,l,c;if(!t)throw new Error("Prompt required.");const n=new On({apiKey:xl});let r;const s=`Generate visually appealing image/print design to place on a product based on the following user prompt for a store generator: "${t}". Solely the image/design alone that is intended to go on products (canvas, t-shirts, mugs) not the products themselves. Square image.`;e!=null&&e.base64Data&&(e!=null&&e.mimeType)?r=[{text:`Using the provided image as a reference, generate a new image based on the following concept: "${t}". Ensure the output is suitable for print-on-demand merchandise and is a square image.`},{inlineData:{mimeType:e.mimeType,data:e.base64Data}}]:r=s;try{const u=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let d=null,h=null,f="";if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)f+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,h=m.inlineData.mimeType;break}}if(!d)throw new Error("Failed to generate image from prompt. "+(f||"No text explanation."));return{imageData:d,imageMimeType:h,textResponse:f}}catch(u){throw console.error("[generateImageFromPromptForPod] Error:",u.message),new Error(`Image generation for POD failed: ${u.message||"Unknown error"}`)}}async function Tae(t){try{const e=await fetch(t);if(!e.ok)throw console.warn(`Direct fetch for ${t} failed with status ${e.status}. Retrying without proxy for now.`),new Error(`Failed to fetch image ${t}: ${e.statusText}`);const n=await e.blob(),r=n.type;if(!r.startsWith("image/"))throw new Error(`Fetched content from ${t} is not an image. MIME type: ${r}`);const s=await n.arrayBuffer();return{base64Data:btoa(new Uint8Array(s).reduce((o,l)=>o+String.fromCharCode(l),"")),mimeType:r}}catch(e){throw console.error(`Error in fetchImageAsBase64 for ${t}:`,e),e}}async function Op(t,e,n,r,s){var o,l,c,u;if(!t||!e||!n||!r||!s)throw console.error("[visualizeImageOnProductWithGemini] Missing required parameters."),new Error("Missing required parameters for product visualization.");const i=new On({apiKey:xl});try{console.log(`[visualizeImageOnProductWithGemini] Fetching base product image from: ${n}`);const{base64Data:d,mimeType:h}=await Tae(n);console.log(`[visualizeImageOnProductWithGemini] Fetched mockup: ${h}, length: ${d.length}`);const f={inlineData:{mimeType:e,data:t}},m={inlineData:{mimeType:h,data:d}},x=[{text:`You are an expert product visualization AI.
Task: Place the first provided image (the 'design') onto the second provided image (the '${s}' mockup).
Design Details: The design was conceptualized with the idea: "${r}".
Mockup: The mockup is a '${s}'.
Instructions:
1. Realistically superimpose the design onto the mockup.
2. Ensure the design conforms to the shape and texture of the mockup.
3. Maintain the original quality and details of both the design and the mockup where appropriate.
4. Output only the final visualized product image. Do not add any extra text or explanations in the image itself.
`},f,m];console.log(`[visualizeImageOnProductWithGemini] Calling Gemini API for ${s} with prompt: "${r}"`);const v=await i.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:x,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let w=null,_=null,C="";if((c=(l=(o=v.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const T of v.candidates[0].content.parts)if(T.text)C+=T.text;else if((u=T.inlineData)!=null&&u.data){w=T.inlineData.data,_=T.inlineData.mimeType;break}}if(console.log(`[visualizeImageOnProductWithGemini] API Text Response: ${C}`),!w)throw console.error("[visualizeImageOnProductWithGemini] Failed to get visualized image data from API.",C),new Error("Failed to visualize product. API did not return image data. "+(C||"No text explanation."));return console.log(`[visualizeImageOnProductWithGemini] Visualization successful for ${s}. MimeType: ${_}`),{visualizedImageData:w,visualizedImageMimeType:_,productDetails:{title:`Custom ${s} (Viz)`,price:24.99,description:`Unique ${s} featuring the design: "${r}".`},apiTextResponse:C}}catch(d){return console.error(`[visualizeImageOnProductWithGemini] Error visualizing ${s}:`,d),{visualizedImageData:null,visualizedImageMimeType:null,productDetails:{title:`Custom ${s}`,price:24.99,description:`Failed to visualize design on ${s}. Error: ${d.message}`},error:d.message}}}async function B0(t,e,n){var o,l,c,u;if(!t||!e||!n)throw new Error("Image data, MIME type, and product name required.");const r=new On({apiKey:xl}),s=[`Show this product, "${n}", from a slightly high front-left angle. Maintain product integrity.`,`Show this product, "${n}", from a direct side view. Maintain product integrity.`,`Show this product, "${n}", from a top-down perspective. Maintain product integrity.`],i=[];try{for(const d of s){const h=[{text:d},{inlineData:{mimeType:e,data:t}}],f=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:h,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let m=null;if((c=(l=(o=f.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const g of f.candidates[0].content.parts)if((u=g.inlineData)!=null&&u.data){m=`data:${g.inlineData.mimeType};base64,${g.inlineData.data}`,i.push(m);break}}m||console.warn("[generateDifferentAnglesFromImage] No image data for one angle.")}if(i.length===0)throw new Error("Failed to generate any additional angle images.");return i}catch(d){throw console.error("[generateDifferentAnglesFromImage] Error:",d.message),new Error(`Generating different angles failed: ${d.message||"Unknown error"}`)}}async function qU(t,e){var s,i,o,l;if(!t)throw new Error("Collection name is required to generate an image.");const n=new On({apiKey:xl});let r=`Generate a visually appealing banner image for an e-commerce collection named "${t}".`;e&&(r+=` The collection is described as: "${e}".`),r+=" The image should be thematic or abstract, suitable for a collection header or card. It should evoke the essence of the collection. Consider a wide aspect ratio like 16:9 or a square image if more appropriate for a card.";try{console.log(`[generateCollectionImageWithGemini] Generating image for collection: ${t}`);const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{role:"user",parts:[{text:r}]}],safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let u=null,d="image/png",h="";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)h+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,d=f.inlineData.mimeType||d;break}}if(!u)throw new Error("Failed to generate image data for the collection. "+(h||"No text explanation from AI."));return{imageData:u,imageMimeType:d,textResponse:h}}catch(c){throw console.error(`[generateCollectionImageWithGemini] Error generating image for collection "${t}":`,c),new Error(`Collection image generation failed for "${t}": ${c.message||"Unknown error"}`)}}async function KU(t,e=[]){var s,i,o,l;if(!t)throw new Error("Prompt is required.");const n=new On({apiKey:xl}),r=[{text:t}];e.forEach(c=>{r.push({inlineData:{mimeType:c.mimeType,data:c.data}})});try{const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let u=null,d="";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const h of c.candidates[0].content.parts)if(h.text)d+=h.text;else if((l=h.inlineData)!=null&&l.data){u=h.inlineData.data;break}}if(!u)throw new Error(d||"Failed to generate image. No image data returned.");return{imageData:u,text:d}}catch(c){throw console.error("[generateImage] Error:",c.message),new Error(`Image generation failed: ${c.message||"Unknown error"}`)}}async function AE(t,e,n,r=[]){var o,l,c,u;if(!t||!e||!n)throw new Error("Prompt, image data, and MIME type are required.");const s=new On({apiKey:xl}),i=[{text:t},{inlineData:{mimeType:n,data:e}}];r.forEach(d=>{i.push({inlineData:{mimeType:d.mimeType,data:d.data}})});try{const d=await s.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:i,safetySettings:Ea,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});let h=null,f="";if((c=(l=(o=d.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const m of d.candidates[0].content.parts)if(m.text)f+=m.text;else if((u=m.inlineData)!=null&&u.data){h=m.inlineData.data;break}}if(!h)throw new Error(f||"Failed to edit image. No image data returned.");return{imageData:h,text:f}}catch(d){throw console.error("[editImage] Error:",d.message),new Error(`Image editing failed: ${d.message||"Unknown error"}`)}}const Iae=Object.freeze(Object.defineProperty({__proto__:null,editImage:AE,editImageWithGemini:$o,generateCaptionForImageData:ia,generateCollectionImageWithGemini:qU,generateDifferentAnglesFromImage:B0,generateGenericProductImageWithGemini:HU,generateImage:KU,generateImageFromPromptForPod:Tg,generateLogoWithGemini:Eg,visualizeImageOnProductWithGemini:Op},Symbol.toStringTag,{value:"Module"})),BI="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",nw=new On({apiKey:BI}),Nae=async(t,e={})=>{var n,r,s;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");console.log(`Starting video generation with prompt: "${t}"`);try{let i=await nw.models.generateVideos({model:"veo-2.0-generate-001",prompt:t,config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...e}});for(console.log("Video generation operation started:",i.name);!i.done;)console.log(`Polling operation ${i.name}, current status: ${((n=i.metadata)==null?void 0:n.state)||"UNKNOWN"}`),await new Promise(l=>setTimeout(l,1e4)),i=await nw.operations.getVideosOperation({operation:i});if(console.log("Video generation operation completed:",i.name,"Done:",i.done),i.error)throw console.error("Error during video generation operation:",i.error),new Error(`Video generation failed: ${i.error.message||"Unknown error"}`);const o=(r=i.response)==null?void 0:r.generatedVideos;if(o&&o.length>0&&((s=o[0].video)!=null&&s.uri)){const c=`${o[0].video.uri}&key=${BI}`;return console.log("Generated video URI (with key appended):",c),c}else throw console.error("No video URI found in the response:",i.response),new Error("Video generation completed, but no video URI was returned.")}catch(i){throw console.error("Failed to generate video with Veo:",i),i.message&&i.message.includes("Quota")?new Error("Video generation failed due to quota limits. Please check your Google Cloud project quotas."):i.message&&i.message.includes("API key not valid")?new Error("Video generation failed due to an invalid API key. Please check your VITE_GEMINI_API_KEY."):i}},zI=async(t,e,n,r={})=>{var s,i,o;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");if(!e||typeof e!="string")throw new Error("Valid base64 image data string is required.");if(!n||typeof n!="string")throw new Error("Valid image MIME type string is required.");console.log(`Starting image-to-video generation with prompt: "${t}" and image (mimeType: ${n})`);try{const l={model:"veo-2.0-generate-001",prompt:t,image:{imageBytes:e,mimeType:n},config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...r}};console.log("Veo image-to-video payload (excluding imageBytes):",{...l,image:{mimeType:l.image.mimeType,imageBytes:"..."}});let c=await nw.models.generateVideos(l);for(console.log("Image-to-video generation operation started:",c.name);!c.done;)console.log(`Polling operation ${c.name}, current status: ${((s=c.metadata)==null?void 0:s.state)||"UNKNOWN"}`),await new Promise(d=>setTimeout(d,1e4)),c=await nw.operations.getVideosOperation({operation:c});if(console.log("Image-to-video generation operation completed:",c.name,"Done:",c.done),c.error)throw console.error("Error during image-to-video generation operation:",c.error),new Error(`Image-to-video generation failed: ${c.error.message||"Unknown error"}`);const u=(i=c.response)==null?void 0:i.generatedVideos;if(u&&u.length>0&&((o=u[0].video)!=null&&o.uri)){const h=`${u[0].video.uri}&key=${BI}`;return console.log("Generated image-to-video URI (with key appended):",h),h}else throw console.error("No video URI found in the image-to-video response:",c.response),new Error("Image-to-video generation completed, but no video URI was returned.")}catch(l){throw console.error("Failed to generate image-to-video with Veo:",l),l.message&&l.message.includes("Quota")?new Error("Image-to-video generation failed due to quota limits."):l.message&&l.message.includes("API key not valid")?new Error("Image-to-video generation failed due to an invalid API key."):l}},GI=p.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),z0=p.createContext({}),G0=p.createContext(null),W0=typeof document<"u",Ig=W0?p.useLayoutEffect:p.useEffect,YU=p.createContext({strict:!1}),WI=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),Pae="framerAppearId",JU="data-"+WI(Pae);function Aae(t,e,n,r){const{visualElement:s}=p.useContext(z0),i=p.useContext(YU),o=p.useContext(G0),l=p.useContext(GI).reducedMotion,c=p.useRef();r=r||i.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:s,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;p.useInsertionEffect(()=>{u&&u.update(n,o)});const d=p.useRef(!!(n[JU]&&!window.HandoffComplete));return Ig(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),p.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function ah(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function kae(t,e,n){return p.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):ah(n)&&(n.current=r))},[e])}function Vp(t){return typeof t=="string"||Array.isArray(t)}function H0(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const HI=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],qI=["initial",...HI];function q0(t){return H0(t.animate)||qI.some(e=>Vp(t[e]))}function XU(t){return!!(q0(t)||t.variants)}function Rae(t,e){if(q0(t)){const{initial:n,animate:r}=t;return{initial:n===!1||Vp(n)?n:void 0,animate:Vp(r)?r:void 0}}return t.inherit!==!1?e:{}}function jae(t){const{initial:e,animate:n}=Rae(t,p.useContext(z0));return p.useMemo(()=>({initial:e,animate:n}),[A2(e),A2(n)])}function A2(t){return Array.isArray(t)?t.join(" "):t}const k2={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},$p={};for(const t in k2)$p[t]={isEnabled:e=>k2[t].some(n=>!!e[n])};function Dae(t){for(const e in t)$p[e]={...$p[e],...t[e]}}const KI=p.createContext({}),QU=p.createContext({}),Mae=Symbol.for("motionComponentSymbol");function Lae({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){t&&Dae(t);function i(l,c){let u;const d={...p.useContext(GI),...l,layoutId:Fae(l)},{isStatic:h}=d,f=jae(l),m=r(l,h);if(!h&&W0){f.visualElement=Aae(s,m,d,e);const g=p.useContext(QU),x=p.useContext(YU).strict;f.visualElement&&(u=f.visualElement.loadFeatures(d,x,t,g))}return p.createElement(z0.Provider,{value:f},u&&f.visualElement?p.createElement(u,{visualElement:f.visualElement,...d}):null,n(s,l,kae(m,f.visualElement,c),m,h,f.visualElement))}const o=p.forwardRef(i);return o[Mae]=s,o}function Fae({layoutId:t}){const e=p.useContext(KI).id;return e&&t!==void 0?e+"-"+t:t}function Oae(t){function e(r,s={}){return Lae(t(r,s))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,s)=>(n.has(s)||n.set(s,e(s)),n.get(s))})}const Vae=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function YI(t){return typeof t!="string"||t.includes("-")?!1:!!(Vae.indexOf(t)>-1||/[A-Z]/.test(t))}const rw={};function $ae(t){Object.assign(rw,t)}const Ng=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],cd=new Set(Ng);function ZU(t,{layout:e,layoutId:n}){return cd.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!rw[t]||t==="opacity")}const xi=t=>!!(t&&t.getVelocity),Uae={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Bae=Ng.length;function zae(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,s){let i="";for(let o=0;o<Bae;o++){const l=Ng[o];if(t[l]!==void 0){const c=Uae[l]||l;i+=`${c}(${t[l]}) `}}return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(t,r?"":i):n&&r&&(i="none"),i}const e5=t=>e=>typeof e=="string"&&e.startsWith(t),t5=e5("--"),kE=e5("var(--"),Gae=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,Wae=(t,e)=>e&&typeof t=="number"?e.transform(t):t,wc=(t,e,n)=>Math.min(Math.max(n,t),e),ud={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Wm={...ud,transform:t=>wc(0,1,t)},Hy={...ud,default:1},Hm=t=>Math.round(t*1e5)/1e5,K0=/(-)?([\d]*\.?[\d])+/g,n5=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,Hae=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Pg(t){return typeof t=="string"}const Ag=t=>({test:e=>Pg(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Dl=Ag("deg"),pa=Ag("%"),Bt=Ag("px"),qae=Ag("vh"),Kae=Ag("vw"),R2={...pa,parse:t=>pa.parse(t)/100,transform:t=>pa.transform(t*100)},j2={...ud,transform:Math.round},r5={borderWidth:Bt,borderTopWidth:Bt,borderRightWidth:Bt,borderBottomWidth:Bt,borderLeftWidth:Bt,borderRadius:Bt,radius:Bt,borderTopLeftRadius:Bt,borderTopRightRadius:Bt,borderBottomRightRadius:Bt,borderBottomLeftRadius:Bt,width:Bt,maxWidth:Bt,height:Bt,maxHeight:Bt,size:Bt,top:Bt,right:Bt,bottom:Bt,left:Bt,padding:Bt,paddingTop:Bt,paddingRight:Bt,paddingBottom:Bt,paddingLeft:Bt,margin:Bt,marginTop:Bt,marginRight:Bt,marginBottom:Bt,marginLeft:Bt,rotate:Dl,rotateX:Dl,rotateY:Dl,rotateZ:Dl,scale:Hy,scaleX:Hy,scaleY:Hy,scaleZ:Hy,skew:Dl,skewX:Dl,skewY:Dl,distance:Bt,translateX:Bt,translateY:Bt,translateZ:Bt,x:Bt,y:Bt,z:Bt,perspective:Bt,transformPerspective:Bt,opacity:Wm,originX:R2,originY:R2,originZ:Bt,zIndex:j2,fillOpacity:Wm,strokeOpacity:Wm,numOctaves:j2};function JI(t,e,n,r){const{style:s,vars:i,transform:o,transformOrigin:l}=t;let c=!1,u=!1,d=!0;for(const h in e){const f=e[h];if(t5(h)){i[h]=f;continue}const m=r5[h],g=Wae(f,m);if(cd.has(h)){if(c=!0,o[h]=g,!d)continue;f!==(m.default||0)&&(d=!1)}else h.startsWith("origin")?(u=!0,l[h]=g):s[h]=g}if(e.transform||(c||r?s.transform=zae(t.transform,n,d,r):s.transform&&(s.transform="none")),u){const{originX:h="50%",originY:f="50%",originZ:m=0}=l;s.transformOrigin=`${h} ${f} ${m}`}}const XI=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function s5(t,e,n){for(const r in e)!xi(e[r])&&!ZU(r,n)&&(t[r]=e[r])}function Yae({transformTemplate:t},e,n){return p.useMemo(()=>{const r=XI();return JI(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function Jae(t,e,n){const r=t.style||{},s={};return s5(s,r,t),Object.assign(s,Yae(t,e,n)),t.transformValues?t.transformValues(s):s}function Xae(t,e,n){const r={},s=Jae(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=s,r}const Qae=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function sw(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Qae.has(t)}let i5=t=>!sw(t);function Zae(t){t&&(i5=e=>e.startsWith("on")?!sw(e):t(e))}try{Zae(require("@emotion/is-prop-valid").default)}catch{}function ele(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(i5(s)||n===!0&&sw(s)||!e&&!sw(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function D2(t,e,n){return typeof t=="string"?t:Bt.transform(e+n*t)}function tle(t,e,n){const r=D2(e,t.x,t.width),s=D2(n,t.y,t.height);return`${r} ${s}`}const nle={offset:"stroke-dashoffset",array:"stroke-dasharray"},rle={offset:"strokeDashoffset",array:"strokeDasharray"};function sle(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?nle:rle;t[i.offset]=Bt.transform(-r);const o=Bt.transform(e),l=Bt.transform(n);t[i.array]=`${o} ${l}`}function QI(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},d,h,f){if(JI(t,u,d,f),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:g,dimensions:x}=t;m.transform&&(x&&(g.transform=m.transform),delete m.transform),x&&(s!==void 0||i!==void 0||g.transform)&&(g.transformOrigin=tle(x,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(m.x=e),n!==void 0&&(m.y=n),r!==void 0&&(m.scale=r),o!==void 0&&sle(m,o,l,c,!1)}const o5=()=>({...XI(),attrs:{}}),ZI=t=>typeof t=="string"&&t.toLowerCase()==="svg";function ile(t,e,n,r){const s=p.useMemo(()=>{const i=o5();return QI(i,e,{enableHardwareAcceleration:!1},ZI(r),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};s5(i,t.style,t),s.style={...i,...s.style}}return s}function ole(t=!1){return(n,r,s,{latestValues:i},o)=>{const c=(YI(n)?ile:Xae)(r,i,o,n),d={...ele(r,typeof n=="string",t),...c,ref:s},{children:h}=r,f=p.useMemo(()=>xi(h)?h.get():h,[h]);return p.createElement(n,{...d,children:f})}}function a5(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const i in n)t.style.setProperty(i,n[i])}const l5=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function c5(t,e,n,r){a5(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(l5.has(s)?s:WI(s),e.attrs[s])}function eN(t,e){const{style:n}=t,r={};for(const s in n)(xi(n[s])||e.style&&xi(e.style[s])||ZU(s,t))&&(r[s]=n[s]);return r}function u5(t,e){const n=eN(t,e);for(const r in t)if(xi(t[r])||xi(e[r])){const s=Ng.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[s]=t[r]}return n}function tN(t,e,n,r={},s={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),e}function kg(t){const e=p.useRef(null);return e.current===null&&(e.current=t()),e.current}const iw=t=>Array.isArray(t),ale=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),lle=t=>iw(t)?t[t.length-1]||0:t;function Bx(t){const e=xi(t)?t.get():t;return ale(e)?e.toValue():e}function cle({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,s,i){const o={latestValues:ule(r,s,i,t),renderState:e()};return n&&(o.mount=l=>n(r,l,o)),o}const d5=t=>(e,n)=>{const r=p.useContext(z0),s=p.useContext(G0),i=()=>cle(t,e,r,s);return n?i():kg(i)};function ule(t,e,n,r){const s={},i=r(t,{});for(const f in i)s[f]=Bx(i[f]);let{initial:o,animate:l}=t;const c=q0(t),u=XU(t);e&&u&&!c&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let d=n?n.initial===!1:!1;d=d||o===!1;const h=d?l:o;return h&&typeof h!="boolean"&&!H0(h)&&(Array.isArray(h)?h:[h]).forEach(m=>{const g=tN(t,m);if(!g)return;const{transitionEnd:x,transition:v,...w}=g;for(const _ in w){let C=w[_];if(Array.isArray(C)){const T=d?C.length-1:0;C=C[T]}C!==null&&(s[_]=C)}for(const _ in x)s[_]=x[_]}),s}const Ir=t=>t;class M2{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function dle(t){let e=new M2,n=new M2,r=0,s=!1,i=!1;const o=new WeakSet,l={schedule:(c,u=!1,d=!1)=>{const h=d&&s,f=h?e:n;return u&&o.add(c),f.add(c)&&h&&s&&(r=e.order.length),c},cancel:c=>{n.remove(c),o.delete(c)},process:c=>{if(s){i=!0;return}if(s=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let u=0;u<r;u++){const d=e.order[u];d(c),o.has(d)&&(l.schedule(d),t())}s=!1,i&&(i=!1,l.process(c))}};return l}const qy=["prepare","read","update","preRender","render","postRender"],hle=40;function fle(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=qy.reduce((h,f)=>(h[f]=dle(()=>n=!0),h),{}),o=h=>i[h].process(s),l=()=>{const h=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(h-s.timestamp,hle),1),s.timestamp=h,s.isProcessing=!0,qy.forEach(o),s.isProcessing=!1,n&&e&&(r=!1,t(l))},c=()=>{n=!0,r=!0,s.isProcessing||t(l)};return{schedule:qy.reduce((h,f)=>{const m=i[f];return h[f]=(g,x=!1,v=!1)=>(n||c(),m.schedule(g,x,v)),h},{}),cancel:h=>qy.forEach(f=>i[f].cancel(h)),state:s,steps:i}}const{schedule:_n,cancel:Uo,state:ds,steps:sS}=fle(typeof requestAnimationFrame<"u"?requestAnimationFrame:Ir,!0),mle={useVisualState:d5({scrapeMotionValuesFromProps:u5,createRenderState:o5,onMount:(t,e,{renderState:n,latestValues:r})=>{_n.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),_n.render(()=>{QI(n,r,{enableHardwareAcceleration:!1},ZI(e.tagName),t.transformTemplate),c5(e,n)})}})},ple={useVisualState:d5({scrapeMotionValuesFromProps:eN,createRenderState:XI})};function gle(t,{forwardMotionProps:e=!1},n,r){return{...YI(t)?mle:ple,preloadedFeatures:n,useRender:ole(e),createVisualElement:r,Component:t}}function Ua(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const h5=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function Y0(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const yle=t=>e=>h5(e)&&t(e,Y0(e));function qa(t,e,n,r){return Ua(t,e,yle(n),r)}const xle=(t,e)=>n=>e(t(n)),oc=(...t)=>t.reduce(xle);function f5(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const L2=f5("dragHorizontal"),F2=f5("dragVertical");function m5(t){let e=!1;if(t==="y")e=F2();else if(t==="x")e=L2();else{const n=L2(),r=F2();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function p5(){const t=m5(!0);return t?(t(),!1):!0}class Oc{constructor(e){this.isMounted=!1,this.node=e}update(){}}function O2(t,e){const n="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),s=(i,o)=>{if(i.pointerType==="touch"||p5())return;const l=t.getProps();t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",e),l[r]&&_n.update(()=>l[r](i,o))};return qa(t.current,n,s,{passive:!t.getProps()[r]})}class vle extends Oc{mount(){this.unmount=oc(O2(this.node,!0),O2(this.node,!1))}unmount(){}}class wle extends Oc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=oc(Ua(this.node.current,"focus",()=>this.onFocus()),Ua(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const g5=(t,e)=>e?t===e?!0:g5(t,e.parentElement):!1;function iS(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,Y0(n))}class ble extends Oc{constructor(){super(...arguments),this.removeStartListeners=Ir,this.removeEndListeners=Ir,this.removeAccessibleListeners=Ir,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),i=qa(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:h}=this.node.getProps();_n.update(()=>{!h&&!g5(this.node.current,l.target)?d&&d(l,c):u&&u(l,c)})},{passive:!(r.onTap||r.onPointerUp)}),o=qa(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=oc(i,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||iS("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&_n.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=Ua(this.node.current,"keyup",o),iS("down",(l,c)=>{this.startPress(l,c)})},n=Ua(this.node.current,"keydown",e),r=()=>{this.isPressing&&iS("cancel",(i,o)=>this.cancelPress(i,o))},s=Ua(this.node.current,"blur",r);this.removeAccessibleListeners=oc(n,s)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&_n.update(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!p5()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&_n.update(()=>r(e,n))}mount(){const e=this.node.getProps(),n=qa(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=Ua(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=oc(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const RE=new WeakMap,oS=new WeakMap,_le=t=>{const e=RE.get(t.target);e&&e(t)},Sle=t=>{t.forEach(_le)};function Cle({root:t,...e}){const n=t||document;oS.has(n)||oS.set(n,{});const r=oS.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(Sle,{root:t,...e})),r[s]}function Ele(t,e,n){const r=Cle(e);return RE.set(t,n),r.observe(t),()=>{RE.delete(t),r.unobserve(t)}}const Tle={some:0,all:1};class Ile extends Oc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:Tle[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),f=u?d:h;f&&f(c)};return Ele(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(Nle(e,n))&&this.startObserver()}unmount(){}}function Nle({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const Ple={inView:{Feature:Ile},tap:{Feature:ble},focus:{Feature:wle},hover:{Feature:vle}};function y5(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function Ale(t){const e={};return t.values.forEach((n,r)=>e[r]=n.get()),e}function kle(t){const e={};return t.values.forEach((n,r)=>e[r]=n.getVelocity()),e}function J0(t,e,n){const r=t.getProps();return tN(r,e,n!==void 0?n:r.custom,Ale(t),kle(t))}let x5=Ir,X0=Ir;const ac=t=>t*1e3,Ka=t=>t/1e3,Rle={current:!1},v5=t=>Array.isArray(t)&&typeof t[0]=="number";function w5(t){return!!(!t||typeof t=="string"&&b5[t]||v5(t)||Array.isArray(t)&&t.every(w5))}const ym=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,b5={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ym([0,.65,.55,1]),circOut:ym([.55,0,1,.45]),backIn:ym([.31,.01,.66,-.59]),backOut:ym([.33,1.53,.69,.99])};function _5(t){if(t)return v5(t)?ym(t):Array.isArray(t)?t.map(_5):b5[t]}function jle(t,e,n,{delay:r=0,duration:s,repeat:i=0,repeatType:o="loop",ease:l,times:c}={}){const u={[e]:n};c&&(u.offset=c);const d=_5(l);return Array.isArray(d)&&(u.easing=d),t.animate(u,{delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function Dle(t,{repeat:e,repeatType:n="loop"}){const r=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[r]}const S5=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,Mle=1e-7,Lle=12;function Fle(t,e,n,r,s){let i,o,l=0;do o=e+(n-e)/2,i=S5(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>Mle&&++l<Lle);return o}function Rg(t,e,n,r){if(t===e&&n===r)return Ir;const s=i=>Fle(i,0,1,t,n);return i=>i===0||i===1?i:S5(s(i),e,r)}const Ole=Rg(.42,0,1,1),Vle=Rg(0,0,.58,1),C5=Rg(.42,0,.58,1),$le=t=>Array.isArray(t)&&typeof t[0]!="number",E5=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,T5=t=>e=>1-t(1-e),nN=t=>1-Math.sin(Math.acos(t)),I5=T5(nN),Ule=E5(nN),N5=Rg(.33,1.53,.69,.99),rN=T5(N5),Ble=E5(rN),zle=t=>(t*=2)<1?.5*rN(t):.5*(2-Math.pow(2,-10*(t-1))),Gle={linear:Ir,easeIn:Ole,easeInOut:C5,easeOut:Vle,circIn:nN,circInOut:Ule,circOut:I5,backIn:rN,backInOut:Ble,backOut:N5,anticipate:zle},V2=t=>{if(Array.isArray(t)){X0(t.length===4);const[e,n,r,s]=t;return Rg(e,n,r,s)}else if(typeof t=="string")return Gle[t];return t},sN=(t,e)=>n=>!!(Pg(n)&&Hae.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),P5=(t,e,n)=>r=>{if(!Pg(r))return r;const[s,i,o,l]=r.match(K0);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},Wle=t=>wc(0,255,t),aS={...ud,transform:t=>Math.round(Wle(t))},Eu={test:sN("rgb","red"),parse:P5("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+aS.transform(t)+", "+aS.transform(e)+", "+aS.transform(n)+", "+Hm(Wm.transform(r))+")"};function Hle(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const jE={test:sN("#"),parse:Hle,transform:Eu.transform},lh={test:sN("hsl","hue"),parse:P5("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+pa.transform(Hm(e))+", "+pa.transform(Hm(n))+", "+Hm(Wm.transform(r))+")"},Ws={test:t=>Eu.test(t)||jE.test(t)||lh.test(t),parse:t=>Eu.test(t)?Eu.parse(t):lh.test(t)?lh.parse(t):jE.parse(t),transform:t=>Pg(t)?t:t.hasOwnProperty("red")?Eu.transform(t):lh.transform(t)},fr=(t,e,n)=>-n*t+n*e+t;function lS(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function qle({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;s=lS(c,l,t+1/3),i=lS(c,l,t),o=lS(c,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}const cS=(t,e,n)=>{const r=t*t;return Math.sqrt(Math.max(0,n*(e*e-r)+r))},Kle=[jE,Eu,lh],Yle=t=>Kle.find(e=>e.test(t));function $2(t){const e=Yle(t);let n=e.parse(t);return e===lh&&(n=qle(n)),n}const A5=(t,e)=>{const n=$2(t),r=$2(e),s={...n};return i=>(s.red=cS(n.red,r.red,i),s.green=cS(n.green,r.green,i),s.blue=cS(n.blue,r.blue,i),s.alpha=fr(n.alpha,r.alpha,i),Eu.transform(s))};function Jle(t){var e,n;return isNaN(t)&&Pg(t)&&(((e=t.match(K0))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(n5))===null||n===void 0?void 0:n.length)||0)>0}const k5={regex:Gae,countKey:"Vars",token:"${v}",parse:Ir},R5={regex:n5,countKey:"Colors",token:"${c}",parse:Ws.parse},j5={regex:K0,countKey:"Numbers",token:"${n}",parse:ud.parse};function uS(t,{regex:e,countKey:n,token:r,parse:s}){const i=t.tokenised.match(e);i&&(t["num"+n]=i.length,t.tokenised=t.tokenised.replace(e,r),t.values.push(...i.map(s)))}function ow(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&uS(n,k5),uS(n,R5),uS(n,j5),n}function D5(t){return ow(t).values}function M5(t){const{values:e,numColors:n,numVars:r,tokenised:s}=ow(t),i=e.length;return o=>{let l=s;for(let c=0;c<i;c++)c<r?l=l.replace(k5.token,o[c]):c<r+n?l=l.replace(R5.token,Ws.transform(o[c])):l=l.replace(j5.token,Hm(o[c]));return l}}const Xle=t=>typeof t=="number"?0:t;function Qle(t){const e=D5(t);return M5(t)(e.map(Xle))}const bc={test:Jle,parse:D5,createTransformer:M5,getAnimatableNone:Qle},L5=(t,e)=>n=>`${n>0?e:t}`;function F5(t,e){return typeof t=="number"?n=>fr(t,e,n):Ws.test(t)?A5(t,e):t.startsWith("var(")?L5(t,e):V5(t,e)}const O5=(t,e)=>{const n=[...t],r=n.length,s=t.map((i,o)=>F5(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}},Zle=(t,e)=>{const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=F5(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}},V5=(t,e)=>{const n=bc.createTransformer(e),r=ow(t),s=ow(e);return r.numVars===s.numVars&&r.numColors===s.numColors&&r.numNumbers>=s.numNumbers?oc(O5(r.values,s.values),n):L5(t,e)},Hh=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},U2=(t,e)=>n=>fr(t,e,n);function ece(t){return typeof t=="number"?U2:typeof t=="string"?Ws.test(t)?A5:V5:Array.isArray(t)?O5:typeof t=="object"?Zle:U2}function tce(t,e,n){const r=[],s=n||ece(t[0]),i=t.length-1;for(let o=0;o<i;o++){let l=s(t[o],t[o+1]);if(e){const c=Array.isArray(e)?e[o]||Ir:e;l=oc(c,l)}r.push(l)}return r}function Q0(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(X0(i===e.length),i===1)return()=>e[0];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=tce(e,r,s),l=o.length,c=u=>{let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=Hh(t[d],t[d+1],u);return o[d](h)};return n?u=>c(wc(t[0],t[i-1],u)):c}function nce(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=Hh(0,e,r);t.push(fr(n,1,s))}}function $5(t){const e=[0];return nce(e,t.length-1),e}function rce(t,e){return t.map(n=>n*e)}function sce(t,e){return t.map(()=>e||C5).splice(0,t.length-1)}function aw({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=$le(r)?r.map(V2):V2(r),i={done:!1,value:e[0]},o=rce(n&&n.length===e.length?n:$5(e),t),l=Q0(o,e,{ease:Array.isArray(s)?s:sce(e,s)});return{calculatedDuration:t,next:c=>(i.value=l(c),i.done=c>=t,i)}}function iN(t,e){return e?t*(1e3/e):0}const ice=5;function U5(t,e,n){const r=Math.max(e-ice,0);return iN(n-t(r),e-r)}const dS=.001,oce=.01,B2=10,ace=.05,lce=1;function cce({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let s,i;x5(t<=ac(B2));let o=1-e;o=wc(ace,lce,o),t=wc(oce,B2,Ka(t)),o<1?(s=u=>{const d=u*o,h=d*t,f=d-n,m=DE(u,o),g=Math.exp(-h);return dS-f/m*g},i=u=>{const h=u*o*t,f=h*n+n,m=Math.pow(o,2)*Math.pow(u,2)*t,g=Math.exp(-h),x=DE(Math.pow(u,2),o);return(-s(u)+dS>0?-1:1)*((f-m)*g)/x}):(s=u=>{const d=Math.exp(-u*t),h=(u-n)*t+1;return-dS+d*h},i=u=>{const d=Math.exp(-u*t),h=(n-u)*(t*t);return d*h});const l=5/t,c=dce(s,i,l);if(t=ac(t),isNaN(c))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(c,2)*r;return{stiffness:u,damping:o*2*Math.sqrt(r*u),duration:t}}}const uce=12;function dce(t,e,n){let r=n;for(let s=1;s<uce;s++)r=r-t(r)/e(r);return r}function DE(t,e){return t*Math.sqrt(1-e*e)}const hce=["duration","bounce"],fce=["stiffness","damping","mass"];function z2(t,e){return e.some(n=>t[n]!==void 0)}function mce(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!z2(t,fce)&&z2(t,hce)){const n=cce(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function B5({keyframes:t,restDelta:e,restSpeed:n,...r}){const s=t[0],i=t[t.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=mce({...r,velocity:-Ka(r.velocity||0)}),m=h||0,g=c/(2*Math.sqrt(l*u)),x=i-s,v=Ka(Math.sqrt(l/u)),w=Math.abs(x)<5;n||(n=w?.01:2),e||(e=w?.005:.5);let _;if(g<1){const C=DE(v,g);_=T=>{const R=Math.exp(-g*v*T);return i-R*((m+g*v*x)/C*Math.sin(C*T)+x*Math.cos(C*T))}}else if(g===1)_=C=>i-Math.exp(-v*C)*(x+(m+v*x)*C);else{const C=v*Math.sqrt(g*g-1);_=T=>{const R=Math.exp(-g*v*T),A=Math.min(C*T,300);return i-R*((m+g*v*x)*Math.sinh(A)+C*x*Math.cosh(A))/C}}return{calculatedDuration:f&&d||null,next:C=>{const T=_(C);if(f)o.done=C>=d;else{let R=m;C!==0&&(g<1?R=U5(_,C,T):R=0);const A=Math.abs(R)<=n,E=Math.abs(i-T)<=e;o.done=A&&E}return o.value=o.done?i:T,o}}}function G2({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:d}){const h=t[0],f={done:!1,value:h},m=I=>l!==void 0&&I<l||c!==void 0&&I>c,g=I=>l===void 0?c:c===void 0||Math.abs(l-I)<Math.abs(c-I)?l:c;let x=n*e;const v=h+x,w=o===void 0?v:o(v);w!==v&&(x=w-h);const _=I=>-x*Math.exp(-I/r),C=I=>w+_(I),T=I=>{const N=_(I),k=C(I);f.done=Math.abs(N)<=u,f.value=f.done?w:k};let R,A;const E=I=>{m(f.value)&&(R=I,A=B5({keyframes:[f.value,g(f.value)],velocity:U5(C,I,f.value),damping:s,stiffness:i,restDelta:u,restSpeed:d}))};return E(0),{calculatedDuration:null,next:I=>{let N=!1;return!A&&R===void 0&&(N=!0,T(I),E(I)),R!==void 0&&I>R?A.next(I-R):(!N&&T(I),f)}}}const pce=t=>{const e=({timestamp:n})=>t(n);return{start:()=>_n.update(e,!0),stop:()=>Uo(e),now:()=>ds.isProcessing?ds.timestamp:performance.now()}},W2=2e4;function H2(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<W2;)e+=n,r=t.next(e);return e>=W2?1/0:e}const gce={decay:G2,inertia:G2,tween:aw,keyframes:aw,spring:B5};function lw({autoplay:t=!0,delay:e=0,driver:n=pce,keyframes:r,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:h,...f}){let m=1,g=!1,x,v;const w=()=>{v=new Promise($=>{x=$})};w();let _;const C=gce[s]||aw;let T;C!==aw&&typeof r[0]!="number"&&(T=Q0([0,100],r,{clamp:!1}),r=[0,100]);const R=C({...f,keyframes:r});let A;l==="mirror"&&(A=C({...f,keyframes:[...r].reverse(),velocity:-(f.velocity||0)}));let E="idle",I=null,N=null,k=null;R.calculatedDuration===null&&i&&(R.calculatedDuration=H2(R));const{calculatedDuration:j}=R;let D=1/0,L=1/0;j!==null&&(D=j+o,L=D*(i+1)-o);let G=0;const B=$=>{if(N===null)return;m>0&&(N=Math.min(N,$)),m<0&&(N=Math.min($-L/m,N)),I!==null?G=I:G=Math.round($-N)*m;const z=G-e*(m>=0?1:-1),F=m>=0?z<0:z>L;G=Math.max(z,0),E==="finished"&&I===null&&(G=L);let Z=G,ce=R;if(i){const $e=Math.min(G,L)/D;let Be=Math.floor($e),ue=$e%1;!ue&&$e>=1&&(ue=1),ue===1&&Be--,Be=Math.min(Be,i+1),!!(Be%2)&&(l==="reverse"?(ue=1-ue,o&&(ue-=o/D)):l==="mirror"&&(ce=A)),Z=wc(0,1,ue)*D}const le=F?{done:!1,value:r[0]}:ce.next(Z);T&&(le.value=T(le.value));let{done:he}=le;!F&&j!==null&&(he=m>=0?G>=L:G<=0);const Le=I===null&&(E==="finished"||E==="running"&&he);return h&&h(le.value),Le&&H(),le},W=()=>{_&&_.stop(),_=void 0},X=()=>{E="idle",W(),x(),w(),N=k=null},H=()=>{E="finished",d&&d(),W(),x()},K=()=>{if(g)return;_||(_=n(B));const $=_.now();c&&c(),I!==null?N=$-I:(!N||E==="finished")&&(N=$),E==="finished"&&w(),k=N,I=null,E="running",_.start()};t&&K();const V={then($,z){return v.then($,z)},get time(){return Ka(G)},set time($){$=ac($),G=$,I!==null||!_||m===0?I=$:N=_.now()-$/m},get duration(){const $=R.calculatedDuration===null?H2(R):R.calculatedDuration;return Ka($)},get speed(){return m},set speed($){$===m||!_||(m=$,V.time=Ka(G))},get state(){return E},play:K,pause:()=>{E="paused",I=G},stop:()=>{g=!0,E!=="idle"&&(E="idle",u&&u(),X())},cancel:()=>{k!==null&&B(k),X()},complete:()=>{E="finished"},sample:$=>(N=0,B($))};return V}function yce(t){let e;return()=>(e===void 0&&(e=t()),e)}const xce=yce(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),vce=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),Ky=10,wce=2e4,bce=(t,e)=>e.type==="spring"||t==="backgroundColor"||!w5(e.ease);function _ce(t,e,{onUpdate:n,onComplete:r,...s}){if(!(xce()&&vce.has(e)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,c,u=!1;const d=()=>{c=new Promise(C=>{l=C})};d();let{keyframes:h,duration:f=300,ease:m,times:g}=s;if(bce(e,s)){const C=lw({...s,repeat:0,delay:0});let T={done:!1,value:h[0]};const R=[];let A=0;for(;!T.done&&A<wce;)T=C.sample(A),R.push(T.value),A+=Ky;g=void 0,h=R,f=A-Ky,m="linear"}const x=jle(t.owner.current,e,h,{...s,duration:f,ease:m,times:g}),v=()=>{u=!1,x.cancel()},w=()=>{u=!0,_n.update(v),l(),d()};return x.onfinish=()=>{u||(t.set(Dle(h,s)),r&&r(),w())},{then(C,T){return c.then(C,T)},attachTimeline(C){return x.timeline=C,x.onfinish=null,Ir},get time(){return Ka(x.currentTime||0)},set time(C){x.currentTime=ac(C)},get speed(){return x.playbackRate},set speed(C){x.playbackRate=C},get duration(){return Ka(f)},play:()=>{o||(x.play(),Uo(v))},pause:()=>x.pause(),stop:()=>{if(o=!0,x.playState==="idle")return;const{currentTime:C}=x;if(C){const T=lw({...s,autoplay:!1});t.setWithVelocity(T.sample(C-Ky).value,T.sample(C).value,Ky)}w()},complete:()=>{u||x.finish()},cancel:w}}function Sce({keyframes:t,delay:e,onUpdate:n,onComplete:r}){const s=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:Ir,pause:Ir,stop:Ir,then:i=>(i(),Promise.resolve()),cancel:Ir,complete:Ir});return e?lw({keyframes:[0,1],duration:0,delay:e,onComplete:s}):s()}const Cce={type:"spring",stiffness:500,damping:25,restSpeed:10},Ece=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Tce={type:"keyframes",duration:.8},Ice={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},Nce=(t,{keyframes:e})=>e.length>2?Tce:cd.has(t)?t.startsWith("scale")?Ece(e[1]):Cce:Ice,ME=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(bc.test(e)||e==="0")&&!e.startsWith("url(")),Pce=new Set(["brightness","contrast","saturate","opacity"]);function Ace(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(K0)||[];if(!r)return t;const s=n.replace(r,"");let i=Pce.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const kce=/([a-z-]*)\(.*?\)/g,LE={...bc,getAnimatableNone:t=>{const e=t.match(kce);return e?e.map(Ace).join(" "):t}},Rce={...r5,color:Ws,backgroundColor:Ws,outlineColor:Ws,fill:Ws,stroke:Ws,borderColor:Ws,borderTopColor:Ws,borderRightColor:Ws,borderBottomColor:Ws,borderLeftColor:Ws,filter:LE,WebkitFilter:LE},oN=t=>Rce[t];function z5(t,e){let n=oN(t);return n!==LE&&(n=bc),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const G5=t=>/^0[^.\s]+$/.test(t);function jce(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||G5(t)}function Dce(t,e,n,r){const s=ME(e,n);let i;Array.isArray(n)?i=[...n]:i=[null,n];const o=r.from!==void 0?r.from:t.get();let l;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?o:i[u-1]),jce(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(l=i[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const d=c[u];i[d]=z5(e,l)}return i}function Mce({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function aN(t,e){return t[e]||t.default||t}const Lce={skipAnimations:!1},lN=(t,e,n,r={})=>s=>{const i=aN(r,t)||{},o=i.delay||r.delay||0;let{elapsed:l=0}=r;l=l-ac(o);const c=Dce(e,t,n,i),u=c[0],d=c[c.length-1],h=ME(t,u),f=ME(t,d);let m={keyframes:c,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:g=>{e.set(g),i.onUpdate&&i.onUpdate(g)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(Mce(i)||(m={...m,...Nce(t,m)}),m.duration&&(m.duration=ac(m.duration)),m.repeatDelay&&(m.repeatDelay=ac(m.repeatDelay)),!h||!f||Rle.current||i.type===!1||Lce.skipAnimations)return Sce(m);if(!r.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const g=_ce(e,t,m);if(g)return g}return lw(m)};function cw(t){return!!(xi(t)&&t.add)}const W5=t=>/^\-?\d*\.?\d+$/.test(t);function cN(t,e){t.indexOf(e)===-1&&t.push(e)}function uN(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class dN{constructor(){this.subscriptions=[]}add(e){return cN(this.subscriptions,e),()=>uN(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Fce=t=>!isNaN(parseFloat(t)),qm={current:void 0};class Oce{constructor(e,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,s=!0)=>{this.prev=this.current,this.current=r;const{delta:i,timestamp:o}=ds;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,_n.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>_n.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=Fce(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new dN);const r=this.events[e].add(n);return e==="change"?()=>{r(),_n.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return qm.current&&qm.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?iN(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Ao(t,e){return new Oce(t,e)}const H5=t=>e=>e.test(t),Vce={test:t=>t==="auto",parse:t=>t},q5=[ud,Bt,pa,Dl,Kae,qae,Vce],Qf=t=>q5.find(H5(t)),$ce=[...q5,Ws,bc],Uce=t=>$ce.find(H5(t));function Bce(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Ao(n))}function zce(t,e){const n=J0(t,e);let{transitionEnd:r={},transition:s={},...i}=n?t.makeTargetAnimatable(n,!1):{};i={...i,...r};for(const o in i){const l=lle(i[o]);Bce(t,o,l)}}function Gce(t,e,n){var r,s;const i=Object.keys(e).filter(l=>!t.hasValue(l)),o=i.length;if(o)for(let l=0;l<o;l++){const c=i[l],u=e[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(s=(r=n[c])!==null&&r!==void 0?r:t.readValue(c))!==null&&s!==void 0?s:e[c]),d!=null&&(typeof d=="string"&&(W5(d)||G5(d))?d=parseFloat(d):!Uce(d)&&bc.test(u)&&(d=z5(c,u)),t.addValue(c,Ao(d,{owner:t})),n[c]===void 0&&(n[c]=d),d!==null&&t.setBaseTarget(c,d))}}function Wce(t,e){return e?(e[t]||e.default||e).from:void 0}function Hce(t,e,n){const r={};for(const s in t){const i=Wce(s,e);if(i!==void 0)r[s]=i;else{const o=n.getValue(s);o&&(r[s]=o.get())}}return r}function qce({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function Kce(t,e){const n=t.get();if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]!==n)return!0}else return n!==e}function K5(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...l}=t.makeTargetAnimatable(e);const c=t.getValue("willChange");r&&(i=r);const u=[],d=s&&t.animationState&&t.animationState.getState()[s];for(const h in l){const f=t.getValue(h),m=l[h];if(!f||m===void 0||d&&qce(d,h))continue;const g={delay:n,elapsed:0,...aN(i||{},h)};if(window.HandoffAppearAnimations){const w=t.getProps()[JU];if(w){const _=window.HandoffAppearAnimations(w,h,f,_n);_!==null&&(g.elapsed=_,g.isHandoff=!0)}}let x=!g.isHandoff&&!Kce(f,m);if(g.type==="spring"&&(f.getVelocity()||g.velocity)&&(x=!1),f.animation&&(x=!1),x)continue;f.start(lN(h,f,m,t.shouldReduceMotion&&cd.has(h)?{type:!1}:g));const v=f.animation;cw(c)&&(c.add(h),v.then(()=>c.remove(h))),u.push(v)}return o&&Promise.all(u).then(()=>{o&&zce(t,o)}),u}function FE(t,e,n={}){const r=J0(t,e,n.custom);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(K5(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return Yce(t,e,u+c,d,h,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function Yce(t,e,n=0,r=0,s=1,i){const o=[],l=(t.variantChildren.size-1)*r,c=s===1?(u=0)=>u*r:(u=0)=>l-u*r;return Array.from(t.variantChildren).sort(Jce).forEach((u,d)=>{u.notify("AnimationStart",e),o.push(FE(u,e,{...i,delay:n+c(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function Jce(t,e){return t.sortNodePosition(e)}function Xce(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>FE(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=FE(t,e,n);else{const s=typeof e=="function"?J0(t,e,n.custom):e;r=Promise.all(K5(t,s,n))}return r.then(()=>t.notify("AnimationComplete",e))}const Qce=[...HI].reverse(),Zce=HI.length;function eue(t){return e=>Promise.all(e.map(({animation:n,options:r})=>Xce(t,n,r)))}function tue(t){let e=eue(t);const n=rue();let r=!0;const s=(c,u)=>{const d=J0(t,u);if(d){const{transition:h,transitionEnd:f,...m}=d;c={...c,...m,...f}}return c};function i(c){e=c(t)}function o(c,u){const d=t.getProps(),h=t.getVariantContext(!0)||{},f=[],m=new Set;let g={},x=1/0;for(let w=0;w<Zce;w++){const _=Qce[w],C=n[_],T=d[_]!==void 0?d[_]:h[_],R=Vp(T),A=_===u?C.isActive:null;A===!1&&(x=w);let E=T===h[_]&&T!==d[_]&&R;if(E&&r&&t.manuallyAnimateOnMount&&(E=!1),C.protectedKeys={...g},!C.isActive&&A===null||!T&&!C.prevProp||H0(T)||typeof T=="boolean")continue;let N=nue(C.prevProp,T)||_===u&&C.isActive&&!E&&R||w>x&&R,k=!1;const j=Array.isArray(T)?T:[T];let D=j.reduce(s,{});A===!1&&(D={});const{prevResolvedValues:L={}}=C,G={...L,...D},B=W=>{N=!0,m.has(W)&&(k=!0,m.delete(W)),C.needsAnimating[W]=!0};for(const W in G){const X=D[W],H=L[W];if(g.hasOwnProperty(W))continue;let K=!1;iw(X)&&iw(H)?K=!y5(X,H):K=X!==H,K?X!==void 0?B(W):m.add(W):X!==void 0&&m.has(W)?B(W):C.protectedKeys[W]=!0}C.prevProp=T,C.prevResolvedValues=D,C.isActive&&(g={...g,...D}),r&&t.blockInitialAnimation&&(N=!1),N&&(!E||k)&&f.push(...j.map(W=>({animation:W,options:{type:_,...c}})))}if(m.size){const w={};m.forEach(_=>{const C=t.getBaseTarget(_);C!==void 0&&(w[_]=C)}),f.push({animation:w})}let v=!!f.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(v=!1),r=!1,v?e(f):Promise.resolve()}function l(c,u,d){var h;if(n[c].isActive===u)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(c,u)}),n[c].isActive=u;const f=o(d,c);for(const m in n)n[m].protectedKeys={};return f}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>n}}function nue(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!y5(e,t):!1}function Zc(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function rue(){return{animate:Zc(!0),whileInView:Zc(),whileHover:Zc(),whileTap:Zc(),whileDrag:Zc(),whileFocus:Zc(),exit:Zc()}}class sue extends Oc{constructor(e){super(e),e.animationState||(e.animationState=tue(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),H0(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let iue=0;class oue extends Oc{constructor(){super(...arguments),this.id=iue++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const aue={animation:{Feature:sue},exit:{Feature:oue}},q2=(t,e)=>Math.abs(t-e);function lue(t,e){const n=q2(t.x,e.x),r=q2(t.y,e.y);return Math.sqrt(n**2+r**2)}class Y5{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=fS(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,m=lue(h.offset,{x:0,y:0})>=3;if(!f&&!m)return;const{point:g}=h,{timestamp:x}=ds;this.history.push({...g,timestamp:x});const{onStart:v,onMove:w}=this.handlers;f||(v&&v(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),w&&w(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=hS(f,this.transformPagePoint),_n.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=fS(h.type==="pointercancel"?this.lastMoveEventInfo:hS(f,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,v),g&&g(h,v)},!h5(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const o=Y0(e),l=hS(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=ds;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=n;d&&d(e,fS(l,this.history)),this.removeListeners=oc(qa(this.contextWindow,"pointermove",this.handlePointerMove),qa(this.contextWindow,"pointerup",this.handlePointerUp),qa(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Uo(this.updatePoint)}}function hS(t,e){return e?{point:e(t.point)}:t}function K2(t,e){return{x:t.x-e.x,y:t.y-e.y}}function fS({point:t},e){return{point:t,delta:K2(t,J5(e)),offset:K2(t,cue(e)),velocity:uue(e,.1)}}function cue(t){return t[0]}function J5(t){return t[t.length-1]}function uue(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=J5(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>ac(e)));)n--;if(!r)return{x:0,y:0};const i=Ka(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Hi(t){return t.max-t.min}function OE(t,e=0,n=.01){return Math.abs(t-e)<=n}function Y2(t,e,n,r=.5){t.origin=r,t.originPoint=fr(e.min,e.max,t.origin),t.scale=Hi(n)/Hi(e),(OE(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=fr(n.min,n.max,t.origin)-t.originPoint,(OE(t.translate)||isNaN(t.translate))&&(t.translate=0)}function Km(t,e,n,r){Y2(t.x,e.x,n.x,r?r.originX:void 0),Y2(t.y,e.y,n.y,r?r.originY:void 0)}function J2(t,e,n){t.min=n.min+e.min,t.max=t.min+Hi(e)}function due(t,e,n){J2(t.x,e.x,n.x),J2(t.y,e.y,n.y)}function X2(t,e,n){t.min=e.min-n.min,t.max=t.min+Hi(e)}function Ym(t,e,n){X2(t.x,e.x,n.x),X2(t.y,e.y,n.y)}function hue(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?fr(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?fr(n,t,r.max):Math.min(t,n)),t}function Q2(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function fue(t,{top:e,left:n,bottom:r,right:s}){return{x:Q2(t.x,n,s),y:Q2(t.y,e,r)}}function Z2(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function mue(t,e){return{x:Z2(t.x,e.x),y:Z2(t.y,e.y)}}function pue(t,e){let n=.5;const r=Hi(t),s=Hi(e);return s>r?n=Hh(e.min,e.max-r,t.min):r>s&&(n=Hh(t.min,t.max-s,e.min)),wc(0,1,n)}function gue(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const VE=.35;function yue(t=VE){return t===!1?t=0:t===!0&&(t=VE),{x:eD(t,"left","right"),y:eD(t,"top","bottom")}}function eD(t,e,n){return{min:tD(t,e),max:tD(t,n)}}function tD(t,e){return typeof t=="number"?t:t[e]||0}const nD=()=>({translate:0,scale:1,origin:0,originPoint:0}),ch=()=>({x:nD(),y:nD()}),rD=()=>({min:0,max:0}),Lr=()=>({x:rD(),y:rD()});function Qi(t){return[t("x"),t("y")]}function X5({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function xue({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function vue(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function mS(t){return t===void 0||t===1}function $E({scale:t,scaleX:e,scaleY:n}){return!mS(t)||!mS(e)||!mS(n)}function su(t){return $E(t)||Q5(t)||t.z||t.rotate||t.rotateX||t.rotateY}function Q5(t){return sD(t.x)||sD(t.y)}function sD(t){return t&&t!=="0%"}function uw(t,e,n){const r=t-n,s=e*r;return n+s}function iD(t,e,n,r,s){return s!==void 0&&(t=uw(t,s,r)),uw(t,n,r)+e}function UE(t,e=0,n=1,r,s){t.min=iD(t.min,e,n,r,s),t.max=iD(t.max,e,n,r,s)}function Z5(t,{x:e,y:n}){UE(t.x,e.translate,e.scale,e.originPoint),UE(t.y,n.translate,n.scale,n.originPoint)}function wue(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let l=0;l<s;l++){i=n[l],o=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&uh(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Z5(t,o)),r&&su(i.latestValues)&&uh(t,i.latestValues))}e.x=oD(e.x),e.y=oD(e.y)}function oD(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Vl(t,e){t.min=t.min+e,t.max=t.max+e}function aD(t,e,[n,r,s]){const i=e[s]!==void 0?e[s]:.5,o=fr(t.min,t.max,i);UE(t,e[n],e[r],o,e.scale)}const bue=["x","scaleX","originX"],_ue=["y","scaleY","originY"];function uh(t,e){aD(t.x,e,bue),aD(t.y,e,_ue)}function e6(t,e){return X5(vue(t.getBoundingClientRect(),e))}function Sue(t,e,n){const r=e6(t,n),{scroll:s}=e;return s&&(Vl(r.x,s.offset.x),Vl(r.y,s.offset.y)),r}const t6=({current:t})=>t?t.ownerDocument.defaultView:null,Cue=new WeakMap;class Eue{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Lr(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Y0(d,"page").point)},i=(d,h)=>{const{drag:f,dragPropagation:m,onDragStart:g}=this.getProps();if(f&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=m5(f),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Qi(v=>{let w=this.getAxisMotionValue(v).get()||0;if(pa.test(w)){const{projection:_}=this.visualElement;if(_&&_.layout){const C=_.layout.layoutBox[v];C&&(w=Hi(C)*(parseFloat(w)/100))}}this.originPoint[v]=w}),g&&_n.update(()=>g(d,h),!1,!0);const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(d,h)=>{const{dragPropagation:f,dragDirectionLock:m,onDirectionLock:g,onDrag:x}=this.getProps();if(!f&&!this.openGlobalLock)return;const{offset:v}=h;if(m&&this.currentDirection===null){this.currentDirection=Tue(v),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,v),this.updateAxis("y",h.point,v),this.visualElement.render(),x&&x(d,h)},l=(d,h)=>this.stop(d,h),c=()=>Qi(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Y5(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:t6(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&_n.update(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!Yy(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=hue(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&ah(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=fue(s.layoutBox,n):this.constraints=!1,this.elastic=yue(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&Qi(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=gue(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!ah(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=Sue(r,s.root,this.visualElement.getTransformPagePoint());let o=mue(s.layout.layoutBox,i);if(n){const l=n(xue(o));this.hasMutatedConstraints=!!l,l&&(o=X5(l))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=Qi(d=>{if(!Yy(d,n,this.currentDirection))return;let h=c&&c[d]||{};o&&(h={min:0,max:0});const f=s?200:1e6,m=s?40:1e7,g={type:"inertia",velocity:r?e[d]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(d,g)});return Promise.all(u).then(l)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return r.start(lN(e,r,0,n))}stopAnimation(){Qi(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Qi(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){Qi(n=>{const{drag:r}=this.getProps();if(!Yy(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[n];i.set(e[n]-fr(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!ah(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Qi(o=>{const l=this.getAxisMotionValue(o);if(l){const c=l.get();s[o]=pue({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Qi(o=>{if(!Yy(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(fr(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;Cue.set(this.visualElement,this);const e=this.visualElement.current,n=qa(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),r=()=>{const{dragConstraints:c}=this.getProps();ah(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),r();const o=Ua(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(Qi(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=c[d].translate,h.set(h.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=VE,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function Yy(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function Tue(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class Iue extends Oc{constructor(e){super(e),this.removeGroupControls=Ir,this.removeListeners=Ir,this.controls=new Eue(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Ir}unmount(){this.removeGroupControls(),this.removeListeners()}}const lD=t=>(e,n)=>{t&&_n.update(()=>t(e,n))};class Nue extends Oc{constructor(){super(...arguments),this.removePointerDownListener=Ir}onPointerDown(e){this.session=new Y5(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:t6(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:lD(e),onStart:lD(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&_n.update(()=>s(i,o))}}}mount(){this.removePointerDownListener=qa(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function Pue(){const t=p.useContext(G0);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,s=p.useId();return p.useEffect(()=>r(s),[]),!e&&n?[!1,()=>n&&n(s)]:[!0]}const zx={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function cD(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const Zf={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Bt.test(t))t=parseFloat(t);else return t;const n=cD(t,e.target.x),r=cD(t,e.target.y);return`${n}% ${r}%`}},Aue={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=bc.parse(t);if(s.length>5)return r;const i=bc.createTransformer(t),o=typeof s[0]!="number"?1:0,l=n.x.scale*e.x,c=n.y.scale*e.y;s[0+o]/=l,s[1+o]/=c;const u=fr(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),i(s)}};class kue extends ht.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;$ae(Rue),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),zx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,o=r.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||_n.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function n6(t){const[e,n]=Pue(),r=p.useContext(KI);return ht.createElement(kue,{...t,layoutGroup:r,switchLayoutGroup:p.useContext(QU),isPresent:e,safeToRemove:n})}const Rue={borderRadius:{...Zf,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Zf,borderTopRightRadius:Zf,borderBottomLeftRadius:Zf,borderBottomRightRadius:Zf,boxShadow:Aue},r6=["TopLeft","TopRight","BottomLeft","BottomRight"],jue=r6.length,uD=t=>typeof t=="string"?parseFloat(t):t,dD=t=>typeof t=="number"||Bt.test(t);function Due(t,e,n,r,s,i){s?(t.opacity=fr(0,n.opacity!==void 0?n.opacity:1,Mue(r)),t.opacityExit=fr(e.opacity!==void 0?e.opacity:1,0,Lue(r))):i&&(t.opacity=fr(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<jue;o++){const l=`border${r6[o]}Radius`;let c=hD(e,l),u=hD(n,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||dD(c)===dD(u)?(t[l]=Math.max(fr(uD(c),uD(u),r),0),(pa.test(u)||pa.test(c))&&(t[l]+="%")):t[l]=u}(e.rotate||n.rotate)&&(t.rotate=fr(e.rotate||0,n.rotate||0,r))}function hD(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const Mue=s6(0,.5,I5),Lue=s6(.5,.95,Ir);function s6(t,e,n){return r=>r<t?0:r>e?1:n(Hh(t,e,r))}function fD(t,e){t.min=e.min,t.max=e.max}function Xi(t,e){fD(t.x,e.x),fD(t.y,e.y)}function mD(t,e,n,r,s){return t-=e,t=uw(t,1/n,r),s!==void 0&&(t=uw(t,1/s,r)),t}function Fue(t,e=0,n=1,r=.5,s,i=t,o=t){if(pa.test(e)&&(e=parseFloat(e),e=fr(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=fr(i.min,i.max,r);t===i&&(l-=e),t.min=mD(t.min,e,n,l,s),t.max=mD(t.max,e,n,l,s)}function pD(t,e,[n,r,s],i,o){Fue(t,e[n],e[r],e[s],e.scale,i,o)}const Oue=["x","scaleX","originX"],Vue=["y","scaleY","originY"];function gD(t,e,n,r){pD(t.x,e,Oue,n?n.x:void 0,r?r.x:void 0),pD(t.y,e,Vue,n?n.y:void 0,r?r.y:void 0)}function yD(t){return t.translate===0&&t.scale===1}function i6(t){return yD(t.x)&&yD(t.y)}function $ue(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function o6(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function xD(t){return Hi(t.x)/Hi(t.y)}class Uue{constructor(){this.members=[]}add(e){cN(this.members,e),e.scheduleRender()}remove(e){if(uN(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function vD(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y;if((s||i)&&(r=`translate3d(${s}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:c,rotateX:u,rotateY:d}=n;c&&(r+=`rotate(${c}deg) `),u&&(r+=`rotateX(${u}deg) `),d&&(r+=`rotateY(${d}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const Bue=(t,e)=>t.depth-e.depth;class zue{constructor(){this.children=[],this.isDirty=!1}add(e){cN(this.children,e),this.isDirty=!0}remove(e){uN(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(Bue),this.isDirty=!1,this.children.forEach(e)}}function Gue(t,e){const n=performance.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(Uo(r),t(i-e))};return _n.read(r,!0),()=>Uo(r)}function Wue(t){window.MotionDebug&&window.MotionDebug.record(t)}function Hue(t){return t instanceof SVGElement&&t.tagName!=="svg"}function que(t,e,n){const r=xi(t)?t:Ao(t);return r.start(lN("",r,e,n)),r.animation}const wD=["","X","Y","Z"],Kue={visibility:"hidden"},bD=1e3;let Yue=0;const iu={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function a6({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},l=e==null?void 0:e()){this.id=Yue++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,iu.totalNodes=iu.resolvedTargetDeltas=iu.recalculatedProjection=0,this.nodes.forEach(Que),this.nodes.forEach(rde),this.nodes.forEach(sde),this.nodes.forEach(Zue),Wue(iu)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new zue)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new dN),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=Hue(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),t){let h;const f=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=Gue(f,250),zx.hasAnimatedSinceResize&&(zx.hasAnimatedSinceResize=!1,this.nodes.forEach(SD))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||d.getDefaultTransition()||cde,{onLayoutAnimationStart:v,onLayoutAnimationComplete:w}=d.getProps(),_=!this.targetLayout||!o6(this.targetLayout,g)||m,C=!f&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||C||f&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,C);const T={...aN(x,"layout"),onPlay:v,onComplete:w};(d.shouldReduceMotion||this.options.layoutRoot)&&(T.delay=0,T.type=!1),this.startAnimation(T)}else f||SD(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Uo(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(ide),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(_D);return}this.isUpdating||this.nodes.forEach(tde),this.isUpdating=!1,this.nodes.forEach(nde),this.nodes.forEach(Jue),this.nodes.forEach(Xue),this.clearAllSnapshots();const l=performance.now();ds.delta=wc(0,1e3/60,l-ds.timestamp),ds.timestamp=l,ds.isProcessing=!0,sS.update.process(ds),sS.preRender.process(ds),sS.render.process(ds),ds.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(ede),this.sharedNodes.forEach(ode)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,_n.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){_n.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Lr(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!i6(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(l||su(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),ude(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return Lr();const l=o.measureViewportBox(),{scroll:c}=this.root;return c&&(Vl(l.x,c.offset.x),Vl(l.y,c.offset.y)),l}removeElementScroll(o){const l=Lr();Xi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;if(u!==this.root&&d&&h.layoutScroll){if(d.isRoot){Xi(l,o);const{scroll:f}=this.root;f&&(Vl(l.x,-f.offset.x),Vl(l.y,-f.offset.y))}Vl(l.x,d.offset.x),Vl(l.y,d.offset.y)}}return l}applyTransform(o,l=!1){const c=Lr();Xi(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&uh(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),su(d.latestValues)&&uh(c,d.latestValues)}return su(this.latestValues)&&uh(c,this.latestValues),c}removeTransform(o){const l=Lr();Xi(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!su(u.latestValues))continue;$E(u.latestValues)&&u.updateSnapshot();const d=Lr(),h=u.measurePageBox();Xi(d,h),gD(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return su(this.latestValues)&&gD(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ds.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=ds.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Lr(),this.relativeTargetOrigin=Lr(),Ym(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Xi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=Lr(),this.targetWithTransforms=Lr()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),due(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Xi(this.target,this.layout.layoutBox),Z5(this.target,this.targetDelta)):Xi(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Lr(),this.relativeTargetOrigin=Lr(),Ym(this.relativeTargetOrigin,this.target,m.target),Xi(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}iu.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||$E(this.parent.latestValues)||Q5(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===ds.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;Xi(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;wue(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:g}=l;if(!g){this.projectionTransform&&(this.projectionDelta=ch(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=ch(),this.projectionDeltaWithTransform=ch());const x=this.projectionTransform;Km(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=vD(this.projectionDelta,this.treeScale),(this.projectionTransform!==x||this.treeScale.x!==f||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),iu.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},h=ch();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const f=Lr(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,x=m!==g,v=this.getStack(),w=!v||v.members.length<=1,_=!!(x&&!w&&this.options.crossfade===!0&&!this.path.some(lde));this.animationProgress=0;let C;this.mixTargetDelta=T=>{const R=T/1e3;CD(h.x,o.x,R),CD(h.y,o.y,R),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Ym(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),ade(this.relativeTarget,this.relativeTargetOrigin,f,R),C&&$ue(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=Lr()),Xi(C,this.relativeTarget)),x&&(this.animationValues=d,Due(d,u,this.latestValues,R,_,w)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=R},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Uo(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=_n.update(()=>{zx.hasAnimatedSinceResize=!0,this.currentAnimation=que(0,bD,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(bD),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&l6(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||Lr();const h=Hi(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+h;const f=Hi(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+f}Xi(l,c),uh(l,d),Km(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new Uue),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let d=0;d<wD.length;d++){const h="rotate"+wD[d];c[h]&&(u[h]=c[h],o.setStaticValue(h,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return Kue;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=Bx(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=Bx(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!su(this.latestValues)&&(x.transform=d?d({},""):"none",this.hasProjected=!1),x}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=vD(this.projectionDeltaWithTransform,this.treeScale,f),d&&(u.transform=d(f,u.transform));const{x:m,y:g}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,h.animationValues?u.opacity=h===this?(c=(l=f.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:u.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const x in rw){if(f[x]===void 0)continue;const{correct:v,applyTo:w}=rw[x],_=u.transform==="none"?f[x]:v(f[x],h);if(w){const C=w.length;for(let T=0;T<C;T++)u[w[T]]=_}else u[x]=_}return this.options.layoutId&&(u.pointerEvents=h===this?Bx(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(_D),this.root.sharedNodes.clear()}}}function Jue(t){t.updateLayout()}function Xue(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?Qi(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=Hi(f);f.min=r[h].min,f.max=f.min+m}):l6(i,n.layoutBox,r)&&Qi(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=Hi(r[h]);f.max=f.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const l=ch();Km(l,r,n.layoutBox);const c=ch();o?Km(c,t.applyTransform(s,!0),n.measuredBox):Km(c,r,n.layoutBox);const u=!i6(l);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const g=Lr();Ym(g,n.layoutBox,f.layoutBox);const x=Lr();Ym(x,r,m.layoutBox),o6(g,x)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=g,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Que(t){iu.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Zue(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function ede(t){t.clearSnapshot()}function _D(t){t.clearMeasurements()}function tde(t){t.isLayoutDirty=!1}function nde(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function SD(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function rde(t){t.resolveTargetDelta()}function sde(t){t.calcProjection()}function ide(t){t.resetRotation()}function ode(t){t.removeLeadSnapshot()}function CD(t,e,n){t.translate=fr(e.translate,0,n),t.scale=fr(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function ED(t,e,n,r){t.min=fr(e.min,n.min,r),t.max=fr(e.max,n.max,r)}function ade(t,e,n,r){ED(t.x,e.x,n.x,r),ED(t.y,e.y,n.y,r)}function lde(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const cde={duration:.45,ease:[.4,0,.1,1]},TD=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),ID=TD("applewebkit/")&&!TD("chrome/")?Math.round:Ir;function ND(t){t.min=ID(t.min),t.max=ID(t.max)}function ude(t){ND(t.x),ND(t.y)}function l6(t,e,n){return t==="position"||t==="preserve-aspect"&&!OE(xD(e),xD(n),.2)}const dde=a6({attachResizeListener:(t,e)=>Ua(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),pS={current:void 0},c6=a6({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!pS.current){const t=new dde({});t.mount(window),t.setOptions({layoutScroll:!0}),pS.current=t}return pS.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),hde={pan:{Feature:Nue},drag:{Feature:Iue,ProjectionNode:c6,MeasureLayout:n6}},fde=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function mde(t){const e=fde.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function BE(t,e,n=1){const[r,s]=mde(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return W5(o)?parseFloat(o):o}else return kE(s)?BE(s,e,n+1):s}function pde(t,{...e},n){const r=t.current;if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(s=>{const i=s.get();if(!kE(i))return;const o=BE(i,r);o&&s.set(o)});for(const s in e){const i=e[s];if(!kE(i))continue;const o=BE(i,r);o&&(e[s]=o,n||(n={}),n[s]===void 0&&(n[s]=i))}return{target:e,transitionEnd:n}}const gde=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),u6=t=>gde.has(t),yde=t=>Object.keys(t).some(u6),PD=t=>t===ud||t===Bt,AD=(t,e)=>parseFloat(t.split(", ")[e]),kD=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/);if(s)return AD(s[1],e);{const i=r.match(/^matrix\((.+)\)$/);return i?AD(i[1],t):0}},xde=new Set(["x","y","z"]),vde=Ng.filter(t=>!xde.has(t));function wde(t){const e=[];return vde.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const qh={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:kD(4,13),y:kD(5,14)};qh.translateX=qh.x;qh.translateY=qh.y;const bde=(t,e,n)=>{const r=e.measureViewportBox(),s=e.current,i=getComputedStyle(s),{display:o}=i,l={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(u=>{l[u]=qh[u](r,i)}),e.render();const c=e.measureViewportBox();return n.forEach(u=>{const d=e.getValue(u);d&&d.jump(l[u]),t[u]=qh[u](c,i)}),t},_de=(t,e,n={},r={})=>{e={...e},r={...r};const s=Object.keys(e).filter(u6);let i=[],o=!1;const l=[];if(s.forEach(c=>{const u=t.getValue(c);if(!t.hasValue(c))return;let d=n[c],h=Qf(d);const f=e[c];let m;if(iw(f)){const g=f.length,x=f[0]===null?1:0;d=f[x],h=Qf(d);for(let v=x;v<g&&f[v]!==null;v++)m?X0(Qf(f[v])===m):m=Qf(f[v])}else m=Qf(f);if(h!==m)if(PD(h)&&PD(m)){const g=u.get();typeof g=="string"&&u.set(parseFloat(g)),typeof f=="string"?e[c]=parseFloat(f):Array.isArray(f)&&m===Bt&&(e[c]=f.map(parseFloat))}else h!=null&&h.transform&&(m!=null&&m.transform)&&(d===0||f===0)?d===0?u.set(m.transform(d)):e[c]=h.transform(f):(o||(i=wde(t),o=!0),l.push(c),r[c]=r[c]!==void 0?r[c]:e[c],u.jump(f))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=bde(e,t,l);return i.length&&i.forEach(([d,h])=>{t.getValue(d).set(h)}),t.render(),W0&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:r}}else return{target:e,transitionEnd:r}};function Sde(t,e,n,r){return yde(e)?_de(t,e,n,r):{target:e,transitionEnd:r}}const Cde=(t,e,n,r)=>{const s=pde(t,e,r);return e=s.target,r=s.transitionEnd,Sde(t,e,n,r)},zE={current:null},d6={current:!1};function Ede(){if(d6.current=!0,!!W0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>zE.current=t.matches;t.addListener(e),e()}else zE.current=!1}function Tde(t,e,n){const{willChange:r}=e;for(const s in e){const i=e[s],o=n[s];if(xi(i))t.addValue(s,i),cw(r)&&r.add(s);else if(xi(o))t.addValue(s,Ao(i,{owner:t})),cw(r)&&r.remove(s);else if(o!==i)if(t.hasValue(s)){const l=t.getValue(s);!l.hasAnimated&&l.set(i)}else{const l=t.getStaticValue(s);t.addValue(s,Ao(l!==void 0?l:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const RD=new WeakMap,h6=Object.keys($p),Ide=h6.length,jD=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],Nde=qI.length;class Pde{constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>_n.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=q0(n),this.isVariantNode=XU(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{});for(const h in d){const f=d[h];l[h]!==void 0&&xi(f)&&(f.set(l[h],!1),cw(u)&&u.add(h))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,RD.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),d6.current||Ede(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:zE.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){RD.delete(this.current),this.projection&&this.projection.unmount(),Uo(this.notifyUpdate),Uo(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const r=cd.has(e),s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&_n.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{s(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,s,i){let o,l;for(let c=0;c<Ide;c++){const u=h6[c],{isEnabled:d,Feature:h,ProjectionNode:f,MeasureLayout:m}=$p[u];f&&(o=f),d(n)&&(!this.features[u]&&h&&(this.features[u]=new h(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:h,layoutScroll:f,layoutRoot:m}=n;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||h&&ah(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:f,layoutRoot:m})}return l}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Lr()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<jD.length;r++){const s=jD[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=e["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=Tde(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<Nde;r++){const s=qI[r],i=this.props[s];(Vp(i)||i===!1)&&(n[s]=i)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Ao(n,{owner:this}),this.addValue(e,r)),r}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props,s=typeof r=="string"||typeof r=="object"?(n=tN(this.props,r))===null||n===void 0?void 0:n[e]:void 0;if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!xi(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new dN),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class f6 extends Pde{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...r},{transformValues:s},i){let o=Hce(r,e||{},this);if(s&&(n&&(n=s(n)),r&&(r=s(r)),o&&(o=s(o))),i){Gce(this,r,o);const l=Cde(this,r,o,n);n=l.transitionEnd,r=l.target}return{transition:e,transitionEnd:n,...r}}}function Ade(t){return window.getComputedStyle(t)}class kde extends f6{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(cd.has(n)){const r=oN(n);return r&&r.default||0}else{const r=Ade(e),s=(t5(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return e6(e,n)}build(e,n,r,s){JI(e,n,r,s.transformTemplate)}scrapeMotionValuesFromProps(e,n){return eN(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;xi(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,s){a5(e,n,r,s)}}class Rde extends f6{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(cd.has(n)){const r=oN(n);return r&&r.default||0}return n=l5.has(n)?n:WI(n),e.getAttribute(n)}measureInstanceViewportBox(){return Lr()}scrapeMotionValuesFromProps(e,n){return u5(e,n)}build(e,n,r,s){QI(e,n,r,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,r,s){c5(e,n,r,s)}mount(e){this.isSVGTag=ZI(e.tagName),super.mount(e)}}const jde=(t,e)=>YI(t)?new Rde(e,{enableHardwareAcceleration:!1}):new kde(e,{enableHardwareAcceleration:!0}),Dde={layout:{ProjectionNode:c6,MeasureLayout:n6}},Mde={...aue,...Ple,...hde,...Dde},Pt=Oae((t,e)=>gle(t,e,Mde,jde));function m6(){const t=p.useRef(!1);return Ig(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function Lde(){const t=m6(),[e,n]=p.useState(0),r=p.useCallback(()=>{t.current&&n(e+1)},[e]);return[p.useCallback(()=>_n.postRender(r),[r]),e]}class Fde extends p.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function Ode({children:t,isPresent:e}){const n=p.useId(),r=p.useRef(null),s=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:i,height:o,top:l,left:c}=s.current;if(e||!r.current||!i||!o)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),p.createElement(Fde,{isPresent:e,childRef:r,sizeRef:s},p.cloneElement(t,{ref:r}))}const gS=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o})=>{const l=kg(Vde),c=p.useId(),u=p.useMemo(()=>({id:c,initial:e,isPresent:n,custom:s,onExitComplete:d=>{l.set(d,!0);for(const h of l.values())if(!h)return;r&&r()},register:d=>(l.set(d,!1),()=>l.delete(d))}),i?void 0:[n]);return p.useMemo(()=>{l.forEach((d,h)=>l.set(h,!1))},[n]),p.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),o==="popLayout"&&(t=p.createElement(Ode,{isPresent:n},t)),p.createElement(G0.Provider,{value:u},t)};function Vde(){return new Map}function $de(t){return p.useEffect(()=>()=>t(),[])}const ou=t=>t.key||"";function Ude(t,e){t.forEach(n=>{const r=ou(n);e.set(r,n)})}function Bde(t){const e=[];return p.Children.forEach(t,n=>{p.isValidElement(n)&&e.push(n)}),e}const _c=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const l=p.useContext(KI).forceRender||Lde()[0],c=m6(),u=Bde(t);let d=u;const h=p.useRef(new Map).current,f=p.useRef(d),m=p.useRef(new Map).current,g=p.useRef(!0);if(Ig(()=>{g.current=!1,Ude(u,m),f.current=d}),$de(()=>{g.current=!0,m.clear(),h.clear()}),g.current)return p.createElement(p.Fragment,null,d.map(_=>p.createElement(gS,{key:ou(_),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:o},_)));d=[...d];const x=f.current.map(ou),v=u.map(ou),w=x.length;for(let _=0;_<w;_++){const C=x[_];v.indexOf(C)===-1&&!h.has(C)&&h.set(C,void 0)}return o==="wait"&&h.size&&(d=[]),h.forEach((_,C)=>{if(v.indexOf(C)!==-1)return;const T=m.get(C);if(!T)return;const R=x.indexOf(C);let A=_;if(!A){const E=()=>{h.delete(C);const I=Array.from(m.keys()).filter(N=>!v.includes(N));if(I.forEach(N=>m.delete(N)),f.current=u.filter(N=>{const k=ou(N);return k===C||I.includes(k)}),!h.size){if(c.current===!1)return;l(),r&&r()}};A=p.createElement(gS,{key:ou(T),isPresent:!1,onExitComplete:E,custom:e,presenceAffectsLayout:i,mode:o},T),h.set(C,A)}d.splice(R,0,A)}),d=d.map(_=>{const C=_.key;return h.has(C)?_:p.createElement(gS,{key:ou(_),isPresent:!0,presenceAffectsLayout:i,mode:o},_)}),p.createElement(p.Fragment,null,h.size?d:d.map(_=>p.cloneElement(_)))};function zde(t){const e=kg(()=>Ao(t)),{isStatic:n}=p.useContext(GI);if(n){const[,r]=p.useState(t);p.useEffect(()=>e.on("change",r),[])}return e}const Gde=t=>t&&typeof t=="object"&&t.mix,Wde=t=>Gde(t)?t.mix:void 0;function Hde(...t){const e=!Array.isArray(t[0]),n=e?0:-1,r=t[0+n],s=t[1+n],i=t[2+n],o=t[3+n],l=Q0(s,i,{mixer:Wde(i[0]),...o});return e?l(r):l}function p6(t,e){const n=zde(e()),r=()=>n.set(e());return r(),Ig(()=>{const s=()=>_n.update(r,!1,!0),i=t.map(o=>o.on("change",s));return()=>{i.forEach(o=>o()),Uo(r)}}),n}function qde(t){qm.current=[],t();const e=p6(qm.current,t);return qm.current=void 0,e}function yS(t,e,n,r){if(typeof t=="function")return qde(t);const s=typeof e=="function"?e:Hde(e,n,r);return Array.isArray(t)?DD(t,s):DD([t],([i])=>s(i))}function DD(t,e){const n=kg(()=>[]);return p6(t,()=>{n.length=0;const r=t.length;for(let s=0;s<r;s++)n[s]=t[s].get();return e(n)})}function g6(t,e,n){var r;if(typeof t=="string"){let s=document;e&&(X0(!!e.current),s=e.current),n?((r=n[t])!==null&&r!==void 0||(n[t]=s.querySelectorAll(t)),t=n[t]):t=s.querySelectorAll(t)}else t instanceof Element&&(t=[t]);return Array.from(t||[])}const Gx=new WeakMap;let Ml;function Kde(t,e){if(e){const{inlineSize:n,blockSize:r}=e[0];return{width:n,height:r}}else return t instanceof SVGElement&&"getBBox"in t?t.getBBox():{width:t.offsetWidth,height:t.offsetHeight}}function Yde({target:t,contentRect:e,borderBoxSize:n}){var r;(r=Gx.get(t))===null||r===void 0||r.forEach(s=>{s({target:t,contentSize:e,get size(){return Kde(t,n)}})})}function Jde(t){t.forEach(Yde)}function Xde(){typeof ResizeObserver>"u"||(Ml=new ResizeObserver(Jde))}function Qde(t,e){Ml||Xde();const n=g6(t);return n.forEach(r=>{let s=Gx.get(r);s||(s=new Set,Gx.set(r,s)),s.add(e),Ml==null||Ml.observe(r)}),()=>{n.forEach(r=>{const s=Gx.get(r);s==null||s.delete(e),s!=null&&s.size||Ml==null||Ml.unobserve(r)})}}const Wx=new Set;let Jm;function Zde(){Jm=()=>{const t={width:window.innerWidth,height:window.innerHeight},e={target:window,size:t,contentSize:t};Wx.forEach(n=>n(e))},window.addEventListener("resize",Jm)}function ehe(t){return Wx.add(t),Jm||Zde(),()=>{Wx.delete(t),!Wx.size&&Jm&&(Jm=void 0)}}function the(t,e){return typeof t=="function"?ehe(t):Qde(t,e)}const nhe=50,MD=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),rhe=()=>({time:0,x:MD(),y:MD()}),she={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function LD(t,e,n,r){const s=n[e],{length:i,position:o}=she[e],l=s.current,c=n.time;s.current=t["scroll"+o],s.scrollLength=t["scroll"+i]-t["client"+i],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=Hh(0,s.scrollLength,s.current);const u=r-c;s.velocity=u>nhe?0:iN(s.current-l,u)}function ihe(t,e,n){LD(t,"x",e,n),LD(t,"y",e,n),e.time=n}function ohe(t,e){const n={x:0,y:0};let r=t;for(;r&&r!==e;)if(r instanceof HTMLElement)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;else if(r.tagName==="svg"){const s=r.getBoundingClientRect();r=r.parentElement;const i=r.getBoundingClientRect();n.x+=s.left-i.left,n.y+=s.top-i.top}else if(r instanceof SVGGraphicsElement){const{x:s,y:i}=r.getBBox();n.x+=s,n.y+=i;let o=null,l=r.parentNode;for(;!o;)l.tagName==="svg"&&(o=l),l=r.parentNode;r=o}else break;return n}const ahe={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},GE={start:0,center:.5,end:1};function FD(t,e,n=0){let r=0;if(GE[t]!==void 0&&(t=GE[t]),typeof t=="string"){const s=parseFloat(t);t.endsWith("px")?r=s:t.endsWith("%")?t=s/100:t.endsWith("vw")?r=s/100*document.documentElement.clientWidth:t.endsWith("vh")?r=s/100*document.documentElement.clientHeight:t=s}return typeof t=="number"&&(r=e*t),n+r}const lhe=[0,0];function che(t,e,n,r){let s=Array.isArray(t)?t:lhe,i=0,o=0;return typeof t=="number"?s=[t,t]:typeof t=="string"&&(t=t.trim(),t.includes(" ")?s=t.split(" "):s=[t,GE[t]?t:"0"]),i=FD(s[0],n,r),o=FD(s[1],e),i-o}const uhe={x:0,y:0};function dhe(t){return"getBBox"in t&&t.tagName!=="svg"?t.getBBox():{width:t.clientWidth,height:t.clientHeight}}function hhe(t,e,n){let{offset:r=ahe.All}=n;const{target:s=t,axis:i="y"}=n,o=i==="y"?"height":"width",l=s!==t?ohe(s,t):uhe,c=s===t?{width:t.scrollWidth,height:t.scrollHeight}:dhe(s),u={width:t.clientWidth,height:t.clientHeight};e[i].offset.length=0;let d=!e[i].interpolate;const h=r.length;for(let f=0;f<h;f++){const m=che(r[f],u[o],c[o],l[i]);!d&&m!==e[i].interpolatorOffsets[f]&&(d=!0),e[i].offset[f]=m}d&&(e[i].interpolate=Q0(e[i].offset,$5(r)),e[i].interpolatorOffsets=[...e[i].offset]),e[i].progress=e[i].interpolate(e[i].current)}function fhe(t,e=t,n){if(n.x.targetOffset=0,n.y.targetOffset=0,e!==t){let r=e;for(;r&&r!==t;)n.x.targetOffset+=r.offsetLeft,n.y.targetOffset+=r.offsetTop,r=r.offsetParent}n.x.targetLength=e===t?e.scrollWidth:e.clientWidth,n.y.targetLength=e===t?e.scrollHeight:e.clientHeight,n.x.containerLength=t.clientWidth,n.y.containerLength=t.clientHeight}function mhe(t,e,n,r={}){return{measure:()=>fhe(t,r.target,n),update:s=>{ihe(t,n,s),(r.offset||r.target)&&hhe(t,n,r)},notify:()=>e(n)}}const em=new WeakMap,OD=new WeakMap,xS=new WeakMap,VD=t=>t===document.documentElement?window:t;function phe(t,{container:e=document.documentElement,...n}={}){let r=xS.get(e);r||(r=new Set,xS.set(e,r));const s=rhe(),i=mhe(e,t,s,n);if(r.add(i),!em.has(e)){const l=()=>{for(const f of r)f.measure()},c=()=>{for(const f of r)f.update(ds.timestamp)},u=()=>{for(const f of r)f.notify()},d=()=>{_n.read(l,!1,!0),_n.read(c,!1,!0),_n.update(u,!1,!0)};em.set(e,d);const h=VD(e);window.addEventListener("resize",d,{passive:!0}),e!==document.documentElement&&OD.set(e,the(e,d)),h.addEventListener("scroll",d,{passive:!0})}const o=em.get(e);return _n.read(o,!1,!0),()=>{var l;Uo(o);const c=xS.get(e);if(!c||(c.delete(i),c.size))return;const u=em.get(e);em.delete(e),u&&(VD(e).removeEventListener("scroll",u),(l=OD.get(e))===null||l===void 0||l(),window.removeEventListener("resize",u))}}function $D(t,e){x5(!!(!e||e.current))}const ghe=()=>({scrollX:Ao(0),scrollY:Ao(0),scrollXProgress:Ao(0),scrollYProgress:Ao(0)});function yhe({container:t,target:e,layoutEffect:n=!0,...r}={}){const s=kg(ghe);return(n?Ig:p.useEffect)(()=>($D("target",e),$D("container",t),phe(({x:o,y:l})=>{s.scrollX.set(o.current),s.scrollXProgress.set(o.progress),s.scrollY.set(l.current),s.scrollYProgress.set(l.progress)},{...r,container:(t==null?void 0:t.current)||void 0,target:(e==null?void 0:e.current)||void 0})),[t,e,JSON.stringify(r.offset)]),s}const xhe={some:0,all:1};function vhe(t,e,{root:n,margin:r,amount:s="some"}={}){const i=g6(t),o=new WeakMap,l=u=>{u.forEach(d=>{const h=o.get(d.target);if(d.isIntersecting!==!!h)if(d.isIntersecting){const f=e(d);typeof f=="function"?o.set(d.target,f):c.unobserve(d.target)}else h&&(h(d),o.delete(d.target))})},c=new IntersectionObserver(l,{root:n,rootMargin:r,threshold:typeof s=="number"?s:xhe[s]});return i.forEach(u=>c.observe(u)),()=>c.disconnect()}function whe(t,{root:e,margin:n,amount:r,once:s=!1}={}){const[i,o]=p.useState(!1);return p.useEffect(()=>{if(!t.current||s&&i)return;const l=()=>(o(!0),s?void 0:()=>o(!1)),c={root:e&&e.current||void 0,margin:n,amount:r};return vhe(t.current,l,c)},[e,t,n,s,r]),i}function bhe(t,[e,n]){return Math.min(n,Math.max(e,t))}function _he(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var hN="ScrollArea",[y6,eje]=wi(hN),[She,go]=y6(hN),x6=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...o}=t,[l,c]=p.useState(null),[u,d]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(null),[x,v]=p.useState(null),[w,_]=p.useState(0),[C,T]=p.useState(0),[R,A]=p.useState(!1),[E,I]=p.useState(!1),N=yn(e,j=>c(j)),k=V0(s);return a.jsx(She,{scope:n,type:r,dir:k,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:d,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:g,scrollbarXEnabled:R,onScrollbarXEnabledChange:A,scrollbarY:x,onScrollbarYChange:v,scrollbarYEnabled:E,onScrollbarYEnabledChange:I,onCornerWidthChange:_,onCornerHeightChange:T,children:a.jsx(Yt.div,{dir:k,...o,ref:N,style:{position:"relative","--radix-scroll-area-corner-width":w+"px","--radix-scroll-area-corner-height":C+"px",...t.style}})})});x6.displayName=hN;var v6="ScrollAreaViewport",w6=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=t,o=go(v6,n),l=p.useRef(null),c=yn(e,l,o.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),a.jsx(Yt.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:a.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});w6.displayName=v6;var Ta="ScrollAreaScrollbar",fN=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=go(Ta,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=s,l=t.orientation==="horizontal";return p.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),s.type==="hover"?a.jsx(Che,{...r,ref:e,forceMount:n}):s.type==="scroll"?a.jsx(Ehe,{...r,ref:e,forceMount:n}):s.type==="auto"?a.jsx(b6,{...r,ref:e,forceMount:n}):s.type==="always"?a.jsx(mN,{...r,ref:e}):null});fN.displayName=Ta;var Che=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=go(Ta,t.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const l=s.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),o(!0)},d=()=>{c=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),a.jsx(xs,{present:n||i,children:a.jsx(b6,{"data-state":i?"visible":"hidden",...r,ref:e})})}),Ehe=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=go(Ta,t.__scopeScrollArea),i=t.orientation==="horizontal",o=eb(()=>c("SCROLL_END"),100),[l,c]=_he("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,s.scrollHideDelay,c]),p.useEffect(()=>{const u=s.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const f=()=>{const m=u[d];h!==m&&(c("SCROLL"),o()),h=m};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[s.viewport,i,c,o]),a.jsx(xs,{present:n||l!=="hidden",children:a.jsx(mN,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:gt(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:gt(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),b6=p.forwardRef((t,e)=>{const n=go(Ta,t.__scopeScrollArea),{forceMount:r,...s}=t,[i,o]=p.useState(!1),l=t.orientation==="horizontal",c=eb(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,d=n.viewport.offsetHeight<n.viewport.scrollHeight;o(l?u:d)}},10);return Kh(n.viewport,c),Kh(n.content,c),a.jsx(xs,{present:r||i,children:a.jsx(mN,{"data-state":i?"visible":"hidden",...s,ref:e})})}),mN=p.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,s=go(Ta,t.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[l,c]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=T6(l.viewport,l.content),d={...r,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return khe(f,o.current,l,m)}return n==="horizontal"?a.jsx(The,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollLeft,m=UD(f,l,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollLeft=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollLeft=h(f,s.dir))}}):n==="vertical"?a.jsx(Ihe,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollTop,m=UD(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollTop=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollTop=h(f))}}):null}),The=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=go(Ta,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=yn(e,c,i.onScrollbarXChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(S6,{"data-orientation":"horizontal",...s,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Z0(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.x),onDragScroll:d=>t.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+d.deltaX;t.onWheelScroll(f),N6(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:hw(o.paddingLeft),paddingEnd:hw(o.paddingRight)}})}})}),Ihe=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=go(Ta,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=yn(e,c,i.onScrollbarYChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(S6,{"data-orientation":"vertical",...s,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Z0(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.y),onDragScroll:d=>t.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollTop+d.deltaY;t.onWheelScroll(f),N6(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:hw(o.paddingTop),paddingEnd:hw(o.paddingBottom)}})}})}),[Nhe,_6]=y6(Ta),S6=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:h,...f}=t,m=go(Ta,n),[g,x]=p.useState(null),v=yn(e,N=>x(N)),w=p.useRef(null),_=p.useRef(""),C=m.viewport,T=r.content-r.viewport,R=Vr(d),A=Vr(c),E=eb(h,10);function I(N){if(w.current){const k=N.clientX-w.current.left,j=N.clientY-w.current.top;u({x:k,y:j})}}return p.useEffect(()=>{const N=k=>{const j=k.target;(g==null?void 0:g.contains(j))&&R(k,T)};return document.addEventListener("wheel",N,{passive:!1}),()=>document.removeEventListener("wheel",N,{passive:!1})},[C,g,T,R]),p.useEffect(A,[r,A]),Kh(g,E),Kh(m.content,E),a.jsx(Nhe,{scope:n,scrollbar:g,hasThumb:s,onThumbChange:Vr(i),onThumbPointerUp:Vr(o),onThumbPositionChange:A,onThumbPointerDown:Vr(l),children:a.jsx(Yt.div,{...f,ref:v,style:{position:"absolute",...f.style},onPointerDown:gt(t.onPointerDown,N=>{N.button===0&&(N.target.setPointerCapture(N.pointerId),w.current=g.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),I(N))}),onPointerMove:gt(t.onPointerMove,I),onPointerUp:gt(t.onPointerUp,N=>{const k=N.target;k.hasPointerCapture(N.pointerId)&&k.releasePointerCapture(N.pointerId),document.body.style.webkitUserSelect=_.current,m.viewport&&(m.viewport.style.scrollBehavior=""),w.current=null})})})}),dw="ScrollAreaThumb",C6=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=_6(dw,t.__scopeScrollArea);return a.jsx(xs,{present:n||s.hasThumb,children:a.jsx(Phe,{ref:e,...r})})}),Phe=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...s}=t,i=go(dw,n),o=_6(dw,n),{onThumbPositionChange:l}=o,c=yn(e,h=>o.onThumbChange(h)),u=p.useRef(void 0),d=eb(()=>{u.current&&(u.current(),u.current=void 0)},100);return p.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(d(),!u.current){const m=Rhe(h,l);u.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,d,l]),a.jsx(Yt.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:gt(t.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),g=h.clientX-m.left,x=h.clientY-m.top;o.onThumbPointerDown({x:g,y:x})}),onPointerUp:gt(t.onPointerUp,o.onThumbPointerUp)})});C6.displayName=dw;var pN="ScrollAreaCorner",E6=p.forwardRef((t,e)=>{const n=go(pN,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?a.jsx(Ahe,{...t,ref:e}):null});E6.displayName=pN;var Ahe=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,s=go(pN,n),[i,o]=p.useState(0),[l,c]=p.useState(0),u=!!(i&&l);return Kh(s.scrollbarX,()=>{var h;const d=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(d),c(d)}),Kh(s.scrollbarY,()=>{var h;const d=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(d),o(d)}),u?a.jsx(Yt.div,{...r,ref:e,style:{width:i,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function hw(t){return t?parseInt(t,10):0}function T6(t,e){const n=t/e;return isNaN(n)?0:n}function Z0(t){const e=T6(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function khe(t,e,n,r="ltr"){const s=Z0(n),i=s/2,o=e||i,l=s-o,c=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-l,d=n.content-n.viewport,h=r==="ltr"?[0,d]:[d*-1,0];return I6([c,u],h)(t)}function UD(t,e,n="ltr"){const r=Z0(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,o=e.content-e.viewport,l=i-r,c=n==="ltr"?[0,o]:[o*-1,0],u=bhe(t,c);return I6([0,o],[0,l])(u)}function I6(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function N6(t,e){return t>0&&t<e}var Rhe=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function s(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,l=n.top!==i.top;(o||l)&&e(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function eb(t,e){const n=Vr(t),r=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),p.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function Kh(t,e){const n=Vr(e);va(()=>{let r=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(t),()=>{window.cancelAnimationFrame(r),s.unobserve(t)}}},[t,n])}var P6=x6,jhe=w6,Dhe=E6;const Ls=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(P6,{ref:r,className:bt("relative overflow-hidden",t),...n,children:[a.jsx(jhe,{className:"h-full w-full rounded-[inherit]",children:e}),a.jsx(A6,{}),a.jsx(Dhe,{})]}));Ls.displayName=P6.displayName;const A6=ht.forwardRef(({className:t,orientation:e="vertical",...n},r)=>a.jsx(fN,{ref:r,orientation:e,className:bt("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:a.jsx(C6,{className:"relative flex-1 rounded-full bg-border"})}));A6.displayName=fN.displayName;const WE="RFC3986",HE={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},Mhe="RFC1738",Lhe=Array.isArray,Yo=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),vS=1024,Fhe=(t,e,n,r,s)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=vS){const c=i.length>=vS?i.slice(l,l+vS):i,u=[];for(let d=0;d<c.length;++d){let h=c.charCodeAt(d);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||s===Mhe&&(h===40||h===41)){u[u.length]=c.charAt(d);continue}if(h<128){u[u.length]=Yo[h];continue}if(h<2048){u[u.length]=Yo[192|h>>6]+Yo[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=Yo[224|h>>12]+Yo[128|h>>6&63]+Yo[128|h&63];continue}d+=1,h=65536+((h&1023)<<10|c.charCodeAt(d)&1023),u[u.length]=Yo[240|h>>18]+Yo[128|h>>12&63]+Yo[128|h>>6&63]+Yo[128|h&63]}o+=u.join("")}return o};function Ohe(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function BD(t,e){if(Lhe(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const Vhe=Object.prototype.hasOwnProperty,k6={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},ea=Array.isArray,$he=Array.prototype.push,R6=function(t,e){$he.apply(t,ea(e)?e:[e])},Uhe=Date.prototype.toISOString,Hr={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:Fhe,encodeValuesOnly:!1,format:WE,formatter:HE[WE],indices:!1,serializeDate(t){return Uhe.call(t)},skipNulls:!1,strictNullHandling:!1};function Bhe(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const wS={};function j6(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x,v,w){let _=t,C=w,T=0,R=!1;for(;(C=C.get(wS))!==void 0&&!R;){const k=C.get(t);if(T+=1,typeof k<"u"){if(k===T)throw new RangeError("Cyclic object value");R=!0}typeof C.get(wS)>"u"&&(T=0)}if(typeof u=="function"?_=u(e,_):_ instanceof Date?_=f==null?void 0:f(_):n==="comma"&&ea(_)&&(_=BD(_,function(k){return k instanceof Date?f==null?void 0:f(k):k})),_===null){if(i)return c&&!x?c(e,Hr.encoder,v,"key",m):e;_=""}if(Bhe(_)||Ohe(_)){if(c){const k=x?e:c(e,Hr.encoder,v,"key",m);return[(g==null?void 0:g(k))+"="+(g==null?void 0:g(c(_,Hr.encoder,v,"value",m)))]}return[(g==null?void 0:g(e))+"="+(g==null?void 0:g(String(_)))]}const A=[];if(typeof _>"u")return A;let E;if(n==="comma"&&ea(_))x&&c&&(_=BD(_,c)),E=[{value:_.length>0?_.join(",")||null:void 0}];else if(ea(u))E=u;else{const k=Object.keys(_);E=d?k.sort(d):k}const I=l?String(e).replace(/\./g,"%2E"):String(e),N=r&&ea(_)&&_.length===1?I+"[]":I;if(s&&ea(_)&&_.length===0)return N+"[]";for(let k=0;k<E.length;++k){const j=E[k],D=typeof j=="object"&&typeof j.value<"u"?j.value:_[j];if(o&&D===null)continue;const L=h&&l?j.replace(/\./g,"%2E"):j,G=ea(_)?typeof n=="function"?n(N,L):N:N+(h?"."+L:"["+L+"]");w.set(t,T);const B=new WeakMap;B.set(wS,w),R6(A,j6(D,G,n,r,s,i,o,l,n==="comma"&&x&&ea(_)?null:c,u,d,h,f,m,g,x,v,B))}return A}function zhe(t=Hr){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Hr.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=WE;if(typeof t.format<"u"){if(!Vhe.call(HE,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=HE[n];let s=Hr.filter;(typeof t.filter=="function"||ea(t.filter))&&(s=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in k6?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=Hr.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Hr.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Hr.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Hr.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Hr.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Hr.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Hr.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Hr.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Hr.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Hr.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Hr.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Hr.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Hr.strictNullHandling}}function Ghe(t,e={}){let n=t;const r=zhe(e);let s,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):ea(r.filter)&&(i=r.filter,s=i);const o=[];if(typeof n!="object"||n===null)return"";const l=k6[r.arrayFormat],c=l==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const u=new WeakMap;for(let f=0;f<s.length;++f){const m=s[f];r.skipNulls&&n[m]===null||R6(o,j6(n[m],m,l,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const d=o.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),d.length>0?h+d:""}const Ud="4.103.0";let zD=!1,Xm,D6,M6,qE,L6,F6,O6,V6,$6;function Whe(t,e={auto:!1}){if(zD)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(Xm)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${Xm}'\``);zD=e.auto,Xm=t.kind,D6=t.fetch,t.Request,t.Response,t.Headers,M6=t.FormData,t.Blob,qE=t.File,L6=t.ReadableStream,F6=t.getMultipartRequestOptions,O6=t.getDefaultAgent,V6=t.fileFromPath,$6=t.isFsReadStream}class Hhe{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function qhe({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new Hhe(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const U6=()=>{Xm||Whe(qhe(),{auto:!0})};U6();class zt extends Error{}class ys extends zt{constructor(e,n,r,s){super(`${ys.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new tb({message:r,cause:YE(n)});const i=n==null?void 0:n.error;return e===400?new B6(e,i,r,s):e===401?new z6(e,i,r,s):e===403?new G6(e,i,r,s):e===404?new W6(e,i,r,s):e===409?new H6(e,i,r,s):e===422?new q6(e,i,r,s):e===429?new K6(e,i,r,s):e>=500?new Y6(e,i,r,s):new ys(e,i,r,s)}}class io extends ys{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class tb extends ys{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class gN extends tb{constructor({message:e}={}){super({message:e??"Request timed out."})}}class B6 extends ys{}class z6 extends ys{}class G6 extends ys{}class W6 extends ys{}class H6 extends ys{}class q6 extends ys{}class K6 extends ys{}class Y6 extends ys{}class J6 extends zt{constructor(){super("Could not parse response content as the length limit was reached")}}class X6 extends zt{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var Jy=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},eu=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ii;class nb{constructor(){Ii.set(this,void 0),this.buffer=new Uint8Array,Jy(this,Ii,null,"f")}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+n.length);r.set(this.buffer),r.set(n,this.buffer.length),this.buffer=r;const s=[];let i;for(;(i=Khe(this.buffer,eu(this,Ii,"f")))!=null;){if(i.carriage&&eu(this,Ii,"f")==null){Jy(this,Ii,i.index,"f");continue}if(eu(this,Ii,"f")!=null&&(i.index!==eu(this,Ii,"f")+1||i.carriage)){s.push(this.decodeText(this.buffer.slice(0,eu(this,Ii,"f")-1))),this.buffer=this.buffer.slice(eu(this,Ii,"f")),Jy(this,Ii,null,"f");continue}const o=eu(this,Ii,"f")!==null?i.preceding-1:i.preceding,l=this.decodeText(this.buffer.slice(0,o));s.push(l),this.buffer=this.buffer.slice(i.index),Jy(this,Ii,null,"f")}return s}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new zt(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new zt(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new zt("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}Ii=new WeakMap;nb.NEWLINE_CHARS=new Set([`
`,"\r"]);nb.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function Khe(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function Yhe(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}function Q6(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class oa{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of Jhe(e,n))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(l&&l.error)throw new ys(void 0,l.error,void 0,iB(e.headers));yield l}else{let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(o.event=="error")throw new ys(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||n.abort()}}return new oa(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const o=new nb,l=Q6(e);for await(const c of l)for(const u of o.decode(c))yield u;for(const c of o.flush())yield c}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of s())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||n.abort()}}return new oa(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new oa(()=>s(e),this.controller),new oa(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new L6({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:o}=await n.next();if(o)return s.close();const l=r.encode(JSON.stringify(i)+`
`);s.enqueue(l)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*Jhe(t,e){if(!t.body)throw e.abort(),new zt("Attempted to iterate over a response with no body");const n=new Qhe,r=new nb,s=Q6(t.body);for await(const i of Xhe(s))for(const o of r.decode(i)){const l=n.decode(o);l&&(yield l)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*Xhe(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=Yhe(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class Qhe{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=Zhe(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function Zhe(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}const Z6=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",eB=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&rb(t),rb=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",efe=t=>eB(t)||Z6(t)||$6(t);async function tB(t,e,n){var s;if(t=await t,eB(t))return t;if(Z6(t)){const i=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=rb(i)?[await i.arrayBuffer()]:[i];return new qE(o,e,n)}const r=await tfe(t);if(e||(e=rfe(t)??"unknown_file"),!(n!=null&&n.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(n={...n,type:i})}return new qE(r,e,n)}async function tfe(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(rb(t))e.push(await t.arrayBuffer());else if(sfe(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${nfe(t)}`);return e}function nfe(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function rfe(t){var e;return bS(t.name)||bS(t.filename)||((e=bS(t.path))==null?void 0:e.split(/[\\/]/).pop())}const bS=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},sfe=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",GD=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Hu=async t=>{const e=await ife(t.body);return F6(e,t)},ife=async t=>{const e=new M6;return await Promise.all(Object.entries(t||{}).map(([n,r])=>KE(e,n,r))),e},KE=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(efe(n)){const r=await tB(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>KE(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>KE(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var ofe=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},afe=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Xy;U6();async function nB(t){var o;const{response:e}=t;if(t.options.stream)return lc("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):oa.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type"),r=(o=n==null?void 0:n.split(";")[0])==null?void 0:o.trim();if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.endsWith("+json"))){const l=await e.json();return lc("response",e.status,e.url,e.headers,l),rB(l,e)}const i=await e.text();return lc("response",e.status,e.url,e.headers,i),i}function rB(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class sb extends Promise{constructor(e,n=nB){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new sb(this.responsePromise,async n=>rB(e(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class lfe{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=_S("maxRetries",n),this.timeout=_S("timeout",r),this.httpAgent=s,this.fetch=i??D6}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...ffe(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${yfe()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&rb(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:n,...s,body:i}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:n=0}={}){var x;const r={...e},{method:s,path:i,query:o,headers:l={}}=r,c=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:GD(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,u=this.calculateContentLength(c),d=this.buildURL(i,o);"timeout"in r&&_S("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const h=r.httpAgent??this.httpAgent??O6(d),f=r.timeout+1e3;typeof((x=h==null?void 0:h.options)==null?void 0:x.timeout)=="number"&&f>(h.options.timeout??0)&&(h.options.timeout=f),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:r,headers:l,contentLength:u,retryCount:n});return{req:{method:s,...c&&{body:c},headers:m,...h&&{agent:h},signal:r.signal??null},url:d,timeout:r.timeout}}buildHeaders({options:e,headers:n,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(e);return KD(i,o),KD(i,n),GD(e.body)&&Xm!=="node"&&delete i["content-type"],Zy(o,"x-stainless-retry-count")===void 0&&Zy(n,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),Zy(o,"x-stainless-timeout")===void 0&&Zy(n,"x-stainless-timeout")===void 0&&e.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return ys.generate(e,n,r,s)}request(e,n=null){return new sb(this.makeRequest(e,n))}async makeRequest(e,n){var h,f;const r=await e,s=r.maxRetries??this.maxRetries;n==null&&(n=s),await this.prepareOptions(r);const{req:i,url:o,timeout:l}=this.buildRequest(r,{retryCount:s-n});if(await this.prepareRequest(i,{url:o,options:r}),lc("request",o,r,i.headers),(h=r.signal)!=null&&h.aborted)throw new io;const c=new AbortController,u=await this.fetchWithTimeout(o,i,l,c).catch(YE);if(u instanceof Error){if((f=r.signal)!=null&&f.aborted)throw new io;if(n)return this.retryRequest(r,n);throw u.name==="AbortError"?new gN:new tb({cause:u})}const d=iB(u.headers);if(!u.ok){if(n&&this.shouldRetry(u)){const _=`retrying, ${n} attempts remaining`;return lc(`response (error; ${_})`,u.status,o,d),this.retryRequest(r,n,d)}const m=await u.text().catch(_=>YE(_).message),g=mfe(m),x=g?void 0:m;throw lc(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,u.status,o,d,x),this.makeStatusError(u.status,g,x,d)}return{response:u,options:r,controller:c}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new cfe(this,r,e)}buildURL(e,n){const r=gfe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return oB(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new zt(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...o}=n||{};i&&i.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r),c={signal:s.signal,...o};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(l)})}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(s=l)}const o=r==null?void 0:r["retry-after"];if(o&&!s){const l=parseFloat(o);Number.isNaN(l)?s=Date.parse(o)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,l)}return await jg(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Ud}`}}class sB{constructor(e,n,r,s){Xy.set(this,void 0),ofe(this,Xy,e,"f"),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new zt("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await afe(this,Xy,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(Xy=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class cfe extends sb{constructor(e,n,r){super(n,async s=>new r(e,s.response,await nB(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const iB=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),ufe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},ar=t=>typeof t=="object"&&t!==null&&!oB(t)&&Object.keys(t).every(e=>aB(ufe,e)),dfe=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ud,"X-Stainless-OS":HD(Deno.build.os),"X-Stainless-Arch":WD(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ud,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ud,"X-Stainless-OS":HD(process.platform),"X-Stainless-Arch":WD(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=hfe();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ud,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Ud,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function hfe(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${i}.${o}`}}}return null}const WD=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",HD=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let qD;const ffe=()=>qD??(qD=dfe()),mfe=t=>{try{return JSON.parse(t)}catch{return}},pfe=/^[a-z][a-z0-9+.-]*:/i,gfe=t=>pfe.test(t),jg=t=>new Promise(e=>setTimeout(e,t)),_S=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new zt(`${t} must be an integer`);if(e<0)throw new zt(`${t} must be a positive integer`);return e},YE=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},Qy=t=>{var e,n,r,s,i;if(typeof process<"u")return((n=(e=process.env)==null?void 0:e[t])==null?void 0:n.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,t))==null?void 0:i.trim()};function oB(t){if(!t)return!0;for(const e in t)return!1;return!0}function aB(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function KD(t,e){for(const n in e){if(!aB(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}const YD=new Set(["authorization","api-key"]);function lc(t,...e){var n;if(typeof process<"u"&&((n=process==null?void 0:process.env)==null?void 0:n.DEBUG)==="true"){const r=e.map(s=>{if(!s)return s;if(s.headers){const o={...s,headers:{...s.headers}};for(const l in s.headers)YD.has(l.toLowerCase())&&(o.headers[l]="REDACTED");return o}let i=null;for(const o in s)YD.has(o.toLowerCase())&&(i??(i={...s}),i[o]="REDACTED");return i??s});console.log(`OpenAI:DEBUG:${t}`,...r)}}const yfe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),xfe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",vfe=t=>typeof(t==null?void 0:t.get)=="function",Zy=(t,e)=>{var r;const n=e.toLowerCase();if(vfe(t)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,o,l)=>o+l.toUpperCase());for(const i of[e,n,e.toUpperCase(),s]){const o=t.get(i);if(o)return o}}for(const[s,i]of Object.entries(t))if(s.toLowerCase()===n)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i},wfe=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};function SS(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class ib extends sB{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Xr extends sB{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class Ht{constructor(e){this._client=e}}let lB=class extends Ht{list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/chat/completions/${e}/messages`,bfe,{query:n,...r})}},ob=class extends Ht{constructor(){super(...arguments),this.messages=new lB(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/chat/completions",ab,{query:e,...n})}del(e,n){return this._client.delete(`/chat/completions/${e}`,n)}};class ab extends Xr{}class bfe extends Xr{}ob.ChatCompletionsPage=ab;ob.Messages=lB;let lb=class extends Ht{constructor(){super(...arguments),this.completions=new ob(this._client)}};lb.Completions=ob;lb.ChatCompletionsPage=ab;class cB extends Ht{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class uB extends Ht{create(e,n){return this._client.post("/audio/transcriptions",Hu({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}}))}}class dB extends Ht{create(e,n){return this._client.post("/audio/translations",Hu({body:e,...n,__metadata:{model:e.model}}))}}class Dg extends Ht{constructor(){super(...arguments),this.transcriptions=new uB(this._client),this.translations=new dB(this._client),this.speech=new cB(this._client)}}Dg.Transcriptions=uB;Dg.Translations=dB;Dg.Speech=cB;class yN extends Ht{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/batches",xN,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class xN extends Xr{}yN.BatchesPage=xN;var _o=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},dr=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},JE,Hx,qx,xm,vm,Kx,wm,Ra,bm,fw,mw,Bd,hB;class vN{constructor(){JE.add(this),this.controller=new AbortController,Hx.set(this,void 0),qx.set(this,()=>{}),xm.set(this,()=>{}),vm.set(this,void 0),Kx.set(this,()=>{}),wm.set(this,()=>{}),Ra.set(this,{}),bm.set(this,!1),fw.set(this,!1),mw.set(this,!1),Bd.set(this,!1),_o(this,Hx,new Promise((e,n)=>{_o(this,qx,e,"f"),_o(this,xm,n,"f")}),"f"),_o(this,vm,new Promise((e,n)=>{_o(this,Kx,e,"f"),_o(this,wm,n,"f")}),"f"),dr(this,Hx,"f").catch(()=>{}),dr(this,vm,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},dr(this,JE,"m",hB).bind(this))},0)}_connected(){this.ended||(dr(this,qx,"f").call(this),this._emit("connect"))}get ended(){return dr(this,bm,"f")}get errored(){return dr(this,fw,"f")}get aborted(){return dr(this,mw,"f")}abort(){this.controller.abort()}on(e,n){return(dr(this,Ra,"f")[e]||(dr(this,Ra,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=dr(this,Ra,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(dr(this,Ra,"f")[e]||(dr(this,Ra,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{_o(this,Bd,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){_o(this,Bd,!0,"f"),await dr(this,vm,"f")}_emit(e,...n){if(dr(this,bm,"f"))return;e==="end"&&(_o(this,bm,!0,"f"),dr(this,Kx,"f").call(this));const r=dr(this,Ra,"f")[e];if(r&&(dr(this,Ra,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!dr(this,Bd,"f")&&!(r!=null&&r.length)&&Promise.reject(s),dr(this,xm,"f").call(this,s),dr(this,wm,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!dr(this,Bd,"f")&&!(r!=null&&r.length)&&Promise.reject(s),dr(this,xm,"f").call(this,s),dr(this,wm,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Hx=new WeakMap,qx=new WeakMap,xm=new WeakMap,vm=new WeakMap,Kx=new WeakMap,wm=new WeakMap,Ra=new WeakMap,bm=new WeakMap,fw=new WeakMap,mw=new WeakMap,Bd=new WeakMap,JE=new WeakSet,hB=function(e){if(_o(this,fw,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new io),e instanceof io)return _o(this,mw,!0,"f"),this._emit("abort",e);if(e instanceof zt)return this._emit("error",e);if(e instanceof Error){const n=new zt(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new zt(String(e)))};var At=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ti=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},hs,XE,ta,Yx,Co,Tu,dh,hu,pw,Pi,Jx,Xx,Qm,_m,Sm,JD,XD,QD,ZD,eM,tM,nM;class ko extends vN{constructor(){super(...arguments),hs.add(this),XE.set(this,[]),ta.set(this,{}),Yx.set(this,{}),Co.set(this,void 0),Tu.set(this,void 0),dh.set(this,void 0),hu.set(this,void 0),pw.set(this,void 0),Pi.set(this,void 0),Jx.set(this,void 0),Xx.set(this,void 0),Qm.set(this,void 0)}[(XE=new WeakMap,ta=new WeakMap,Yx=new WeakMap,Co=new WeakMap,Tu=new WeakMap,dh=new WeakMap,hu=new WeakMap,pw=new WeakMap,Pi=new WeakMap,Jx=new WeakMap,Xx=new WeakMap,Qm=new WeakMap,hs=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new ko;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=oa.fromReadableStream(e,this.controller);for await(const o of s)At(this,hs,"m",_m).call(this,o);if((i=s.controller.signal)!=null&&i.aborted)throw new io;return this._addRun(At(this,hs,"m",Sm).call(this))}toReadableStream(){return new oa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const o=new ko;return o._run(()=>o._runToolAssistantStream(e,n,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,n,r,s,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...s,stream:!0},c=await e.submitToolOutputs(n,r,l,{...i,signal:this.controller.signal});this._connected();for await(const d of c)At(this,hs,"m",_m).call(this,d);if((u=c.controller.signal)!=null&&u.aborted)throw new io;return this._addRun(At(this,hs,"m",Sm).call(this))}static createThreadAssistantStream(e,n,r){const s=new ko;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new ko;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return At(this,Jx,"f")}currentRun(){return At(this,Xx,"f")}currentMessageSnapshot(){return At(this,Co,"f")}currentRunStepSnapshot(){return At(this,Qm,"f")}async finalRunSteps(){return await this.done(),Object.values(At(this,ta,"f"))}async finalMessages(){return await this.done(),Object.values(At(this,Yx,"f"))}async finalRun(){if(await this.done(),!At(this,Tu,"f"))throw Error("Final run was not received.");return At(this,Tu,"f")}async _createThreadAssistantStream(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const c of o)At(this,hs,"m",_m).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new io;return this._addRun(At(this,hs,"m",Sm).call(this))}async _createAssistantStream(e,n,r,s){var c;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.create(n,o,{...s,signal:this.controller.signal});this._connected();for await(const u of l)At(this,hs,"m",_m).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new io;return this._addRun(At(this,hs,"m",Sm).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(SS(i)&&SS(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...s);continue}for(const o of s){if(!SS(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const c=i[l];c==null?i.push(o):i[l]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}}_m=function(e){if(!this.ended)switch(Ti(this,Jx,e,"f"),At(this,hs,"m",QD).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":At(this,hs,"m",nM).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":At(this,hs,"m",XD).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":At(this,hs,"m",JD).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Sm=function(){if(this.ended)throw new zt("stream has ended, this shouldn't happen");if(!At(this,Tu,"f"))throw Error("Final run has not been received");return At(this,Tu,"f")},JD=function(e){const[n,r]=At(this,hs,"m",eM).call(this,e,At(this,Co,"f"));Ti(this,Co,n,"f"),At(this,Yx,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,o=n.content[s.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=At(this,dh,"f")){if(At(this,hu,"f"))switch(At(this,hu,"f").type){case"text":this._emit("textDone",At(this,hu,"f").text,At(this,Co,"f"));break;case"image_file":this._emit("imageFileDone",At(this,hu,"f").image_file,At(this,Co,"f"));break}Ti(this,dh,s.index,"f")}Ti(this,hu,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(At(this,dh,"f")!==void 0){const s=e.data.content[At(this,dh,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,At(this,Co,"f"));break;case"text":this._emit("textDone",s.text,At(this,Co,"f"));break}}At(this,Co,"f")&&this._emit("messageDone",e.data),Ti(this,Co,void 0,"f")}},XD=function(e){const n=At(this,hs,"m",ZD).call(this,e);switch(Ti(this,Qm,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==At(this,pw,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(At(this,Pi,"f")&&this._emit("toolCallDone",At(this,Pi,"f")),Ti(this,pw,i.index,"f"),Ti(this,Pi,n.step_details.tool_calls[i.index],"f"),At(this,Pi,"f")&&this._emit("toolCallCreated",At(this,Pi,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ti(this,Qm,void 0,"f"),e.data.step_details.type=="tool_calls"&&At(this,Pi,"f")&&(this._emit("toolCallDone",At(this,Pi,"f")),Ti(this,Pi,void 0,"f")),this._emit("runStepDone",e.data,n);break}},QD=function(e){At(this,XE,"f").push(e),this._emit("event",e)},ZD=function(e){switch(e.event){case"thread.run.step.created":return At(this,ta,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=At(this,ta,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=ko.accumulateDelta(n,r.delta);At(this,ta,"f")[e.data.id]=s}return At(this,ta,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":At(this,ta,"f")[e.data.id]=e.data;break}if(At(this,ta,"f")[e.data.id])return At(this,ta,"f")[e.data.id];throw new Error("No snapshot available")},eM=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=At(this,hs,"m",tM).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},tM=function(e,n){return ko.accumulateDelta(n,e)},nM=function(e){switch(Ti(this,Xx,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Ti(this,Tu,e.data,"f"),At(this,Pi,"f")&&(this._emit("toolCallDone",At(this,Pi,"f")),Ti(this,Pi,void 0,"f"));break}};class wN extends Ht{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/assistants",bN,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class bN extends Xr{}wN.AssistantsPage=bN;function rM(t){return typeof t.parse=="function"}const Eh=t=>(t==null?void 0:t.role)==="assistant",fB=t=>(t==null?void 0:t.role)==="function",mB=t=>(t==null?void 0:t.role)==="tool";function _N(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function Mg(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function _fe(t,e){return!e||!pB(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:SN(t,e)}function SN(t,e){const n=t.choices.map(r=>{var s;if(r.finish_reason==="length")throw new J6;if(r.finish_reason==="content_filter")throw new X6;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>Cfe(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?Sfe(e,r.message.content):null}}});return{...t,choices:n}}function Sfe(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function Cfe(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:Mg(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function Efe(t,e){var r;if(!t)return!1;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return Mg(n)||(n==null?void 0:n.function.strict)||!1}function pB(t){var e;return _N(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>Mg(n)||n.type==="function"&&n.function.strict===!0))??!1}function Tfe(t){for(const e of t??[]){if(e.type!=="function")throw new zt(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new zt(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var ii=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Is,QE,gw,ZE,eT,tT,gB,nT;const sM=10;class yB extends vN{constructor(){super(...arguments),Is.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(fB(e)||mB(e))&&e.content)this._emit("functionCallResult",e.content);else if(Eh(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Eh(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new zt("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),ii(this,Is,"m",QE).call(this)}async finalMessage(){return await this.done(),ii(this,Is,"m",gw).call(this)}async finalFunctionCall(){return await this.done(),ii(this,Is,"m",ZE).call(this)}async finalFunctionCallResult(){return await this.done(),ii(this,Is,"m",eT).call(this)}async totalUsage(){return await this.done(),ii(this,Is,"m",tT).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=ii(this,Is,"m",gw).call(this);n&&this._emit("finalMessage",n);const r=ii(this,Is,"m",QE).call(this);r&&this._emit("finalContent",r);const s=ii(this,Is,"m",ZE).call(this);s&&this._emit("finalFunctionCall",s);const i=ii(this,Is,"m",eT).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",ii(this,Is,"m",tT).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),ii(this,Is,"m",gB).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(SN(i,n))}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var f;const s="function",{function_call:i="auto",stream:o,...l}=n,c=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=sM}=r||{},d={};for(const m of n.functions)d[m.name||m.function.name]=m;const h=n.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(const m of n.messages)this._addMessage(m,!1);for(let m=0;m<u;++m){const x=(f=(await this._createChatCompletion(e,{...l,function_call:i,functions:h,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!x)throw new zt("missing message in ChatCompletion response");if(!x.function_call)return;const{name:v,arguments:w}=x.function_call,_=d[v];if(_){if(c&&c!==v){const A=`Invalid function_call: ${JSON.stringify(v)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:v,content:A});continue}}else{const A=`Invalid function_call: ${JSON.stringify(v)}. Available options are: ${h.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:v,content:A});continue}let C;try{C=rM(_)?await _.parse(w):w}catch(A){this._addMessage({role:s,name:v,content:A instanceof Error?A.message:String(A)});continue}const T=await _.function(C,this),R=ii(this,Is,"m",nT).call(this,T);if(this._addMessage({role:s,name:v,content:R}),c)return}}async _runTools(e,n,r){var m,g,x;const s="tool",{tool_choice:i="auto",stream:o,...l}=n,c=typeof i!="string"&&((m=i==null?void 0:i.function)==null?void 0:m.name),{maxChatCompletions:u=sM}=r||{},d=n.tools.map(v=>{if(Mg(v)){if(!v.$callback)throw new zt("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:v.$callback,name:v.function.name,description:v.function.description||"",parameters:v.function.parameters,parse:v.$parseRaw,strict:!0}}}return v}),h={};for(const v of d)v.type==="function"&&(h[v.function.name||v.function.function.name]=v.function);const f="tools"in n?d.map(v=>v.type==="function"?{type:"function",function:{name:v.function.name||v.function.function.name,parameters:v.function.parameters,description:v.function.description,strict:v.function.strict}}:v):void 0;for(const v of n.messages)this._addMessage(v,!1);for(let v=0;v<u;++v){const _=(g=(await this._createChatCompletion(e,{...l,tool_choice:i,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:g.message;if(!_)throw new zt("missing message in ChatCompletion response");if(!((x=_.tool_calls)!=null&&x.length))return;for(const C of _.tool_calls){if(C.type!=="function")continue;const T=C.id,{name:R,arguments:A}=C.function,E=h[R];if(E){if(c&&c!==R){const j=`Invalid tool_call: ${JSON.stringify(R)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:T,content:j});continue}}else{const j=`Invalid tool_call: ${JSON.stringify(R)}. Available options are: ${Object.keys(h).map(D=>JSON.stringify(D)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:T,content:j});continue}let I;try{I=rM(E)?await E.parse(A):A}catch(j){const D=j instanceof Error?j.message:String(j);this._addMessage({role:s,tool_call_id:T,content:D});continue}const N=await E.function(I,this),k=ii(this,Is,"m",nT).call(this,N);if(this._addMessage({role:s,tool_call_id:T,content:k}),c)return}}}}Is=new WeakSet,QE=function(){return ii(this,Is,"m",gw).call(this).content??null},gw=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Eh(n)){const{function_call:r,...s}=n,i={...s,content:n.content??null,refusal:n.refusal??null};return r&&(i.function_call=r),i}}throw new zt("stream ended without producing a ChatCompletionMessage with role=assistant")},ZE=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if(Eh(s)&&(s!=null&&s.function_call))return s.function_call;if(Eh(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.at(-1))==null?void 0:n.function}},eT=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(fB(n)&&n.content!=null||mB(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},tT=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},gB=function(e){if(e.n!=null&&e.n>1)throw new zt("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},nT=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class Up extends yB{static runFunctions(e,n,r){const s=new Up,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Up,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e,n=!0){super._addMessage(e,n),Eh(e)&&e.content&&this._emit("content",e.content)}}const xB=1,vB=2,wB=4,bB=8,_B=16,SB=32,CB=64,EB=128,TB=256,IB=EB|TB,NB=_B|SB|IB|CB,PB=xB|vB|NB,AB=wB|bB,Ife=PB|AB,ns={STR:xB,NUM:vB,ARR:wB,OBJ:bB,NULL:_B,BOOL:SB,NAN:CB,INFINITY:EB,MINUS_INFINITY:TB,INF:IB,SPECIAL:NB,ATOM:PB,COLLECTION:AB,ALL:Ife};class Nfe extends Error{}class Pfe extends Error{}function Afe(t,e=ns.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return kfe(t.trim(),e)}const kfe=(t,e)=>{const n=t.length;let r=0;const s=f=>{throw new Nfe(`${f} at position ${r}`)},i=f=>{throw new Pfe(`${f} at position ${r}`)},o=()=>(h(),r>=n&&s("Unexpected end of input"),t[r]==='"'?l():t[r]==="{"?c():t[r]==="["?u():t.substring(r,r+4)==="null"||ns.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||ns.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||ns.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||ns.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||ns.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||ns.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):d()),l=()=>{const f=r;let m=!1;for(r++;r<n&&(t[r]!=='"'||m&&t[r-1]==="\\");)m=t[r]==="\\"?!m:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(f,++r-Number(m)))}catch(g){i(String(g))}else if(ns.STR&e)try{return JSON.parse(t.substring(f,r-Number(m))+'"')}catch{return JSON.parse(t.substring(f,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,h();const f={};try{for(;t[r]!=="}";){if(h(),r>=n&&ns.OBJ&e)return f;const m=l();h(),r++;try{const g=o();Object.defineProperty(f,m,{value:g,writable:!0,enumerable:!0,configurable:!0})}catch(g){if(ns.OBJ&e)return f;throw g}h(),t[r]===","&&r++}}catch{if(ns.OBJ&e)return f;s("Expected '}' at end of object")}return r++,f},u=()=>{r++;const f=[];try{for(;t[r]!=="]";)f.push(o()),h(),t[r]===","&&r++}catch{if(ns.ARR&e)return f;s("Expected ']' at end of array")}return r++,f},d=()=>{if(r===0){t==="-"&&ns.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(m){if(ns.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(m))}}const f=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(ns.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(f,r))}catch{t.substring(f,r)==="-"&&ns.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(f,t.lastIndexOf("e")))}catch(g){i(String(g))}}},h=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return o()},iM=t=>Afe(t,ns.ALL^ns.NUM);var Id=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Ln=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Wr,ka,Nd,Cl,CS,ex,ES,TS,IS,tx,NS,oM;class Bp extends yB{constructor(e){super(),Wr.add(this),ka.set(this,void 0),Nd.set(this,void 0),Cl.set(this,void 0),Id(this,ka,e,"f"),Id(this,Nd,[],"f")}get currentChatCompletionSnapshot(){return Ln(this,Cl,"f")}static fromReadableStream(e){const n=new Bp(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new Bp(n);return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var o;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Ln(this,Wr,"m",CS).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of i)Ln(this,Wr,"m",ES).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new io;return this._addChatCompletion(Ln(this,Wr,"m",tx).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),Ln(this,Wr,"m",CS).call(this),this._connected();const s=oa.fromReadableStream(e,this.controller);let i;for await(const l of s)i&&i!==l.id&&this._addChatCompletion(Ln(this,Wr,"m",tx).call(this)),Ln(this,Wr,"m",ES).call(this,l),i=l.id;if((o=s.controller.signal)!=null&&o.aborted)throw new io;return this._addChatCompletion(Ln(this,Wr,"m",tx).call(this))}[(ka=new WeakMap,Nd=new WeakMap,Cl=new WeakMap,Wr=new WeakSet,CS=function(){this.ended||Id(this,Cl,void 0,"f")},ex=function(n){let r=Ln(this,Nd,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},Ln(this,Nd,"f")[n.index]=r,r)},ES=function(n){var s,i,o,l,c,u,d,h,f,m,g,x,v,w,_;if(this.ended)return;const r=Ln(this,Wr,"m",oM).call(this,n);this._emit("chunk",n,r);for(const C of n.choices){const T=r.choices[C.index];C.delta.content!=null&&((s=T.message)==null?void 0:s.role)==="assistant"&&((i=T.message)!=null&&i.content)&&(this._emit("content",C.delta.content,T.message.content),this._emit("content.delta",{delta:C.delta.content,snapshot:T.message.content,parsed:T.message.parsed})),C.delta.refusal!=null&&((o=T.message)==null?void 0:o.role)==="assistant"&&((l=T.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:C.delta.refusal,snapshot:T.message.refusal}),((c=C.logprobs)==null?void 0:c.content)!=null&&((u=T.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=C.logprobs)==null?void 0:d.content,snapshot:((h=T.logprobs)==null?void 0:h.content)??[]}),((f=C.logprobs)==null?void 0:f.refusal)!=null&&((m=T.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(g=C.logprobs)==null?void 0:g.refusal,snapshot:((x=T.logprobs)==null?void 0:x.refusal)??[]});const R=Ln(this,Wr,"m",ex).call(this,T);T.finish_reason&&(Ln(this,Wr,"m",IS).call(this,T),R.current_tool_call_index!=null&&Ln(this,Wr,"m",TS).call(this,T,R.current_tool_call_index));for(const A of C.delta.tool_calls??[])R.current_tool_call_index!==A.index&&(Ln(this,Wr,"m",IS).call(this,T),R.current_tool_call_index!=null&&Ln(this,Wr,"m",TS).call(this,T,R.current_tool_call_index)),R.current_tool_call_index=A.index;for(const A of C.delta.tool_calls??[]){const E=(v=T.message.tool_calls)==null?void 0:v[A.index];E!=null&&E.type&&((E==null?void 0:E.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(w=E.function)==null?void 0:w.name,index:A.index,arguments:E.function.arguments,parsed_arguments:E.function.parsed_arguments,arguments_delta:((_=A.function)==null?void 0:_.arguments)??""}):(E==null||E.type,void 0))}}},TS=function(n,r){var o,l,c;if(Ln(this,Wr,"m",ex).call(this,n).done_tool_calls.has(r))return;const i=(o=n.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(c=(l=Ln(this,ka,"f"))==null?void 0:l.tools)==null?void 0:c.find(d=>d.type==="function"&&d.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:Mg(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},IS=function(n){var s,i;const r=Ln(this,Wr,"m",ex).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=Ln(this,Wr,"m",NS).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(s=n.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},tx=function(){if(this.ended)throw new zt("stream has ended, this shouldn't happen");const n=Ln(this,Cl,"f");if(!n)throw new zt("request ended without sending any chunks");return Id(this,Cl,void 0,"f"),Id(this,Nd,[],"f"),Rfe(n,Ln(this,ka,"f"))},NS=function(){var r;const n=(r=Ln(this,ka,"f"))==null?void 0:r.response_format;return _N(n)?n:null},oM=function(n){var r,s,i,o;let l=Ln(this,Cl,"f");const{choices:c,...u}=n;l?Object.assign(l,u):l=Id(this,Cl,{...u,choices:[]},"f");for(const{delta:d,finish_reason:h,index:f,logprobs:m=null,...g}of n.choices){let x=l.choices[f];if(x||(x=l.choices[f]={finish_reason:h,index:f,message:{},logprobs:m,...g}),m)if(!x.logprobs)x.logprobs=Object.assign({},m);else{const{content:A,refusal:E,...I}=m;Object.assign(x.logprobs,I),A&&((r=x.logprobs).content??(r.content=[]),x.logprobs.content.push(...A)),E&&((s=x.logprobs).refusal??(s.refusal=[]),x.logprobs.refusal.push(...E))}if(h&&(x.finish_reason=h,Ln(this,ka,"f")&&pB(Ln(this,ka,"f")))){if(h==="length")throw new J6;if(h==="content_filter")throw new X6}if(Object.assign(x,g),!d)continue;const{content:v,refusal:w,function_call:_,role:C,tool_calls:T,...R}=d;if(Object.assign(x.message,R),w&&(x.message.refusal=(x.message.refusal||"")+w),C&&(x.message.role=C),_&&(x.message.function_call?(_.name&&(x.message.function_call.name=_.name),_.arguments&&((i=x.message.function_call).arguments??(i.arguments=""),x.message.function_call.arguments+=_.arguments)):x.message.function_call=_),v&&(x.message.content=(x.message.content||"")+v,!x.message.refusal&&Ln(this,Wr,"m",NS).call(this)&&(x.message.parsed=iM(x.message.content))),T){x.message.tool_calls||(x.message.tool_calls=[]);for(const{index:A,id:E,type:I,function:N,...k}of T){const j=(o=x.message.tool_calls)[A]??(o[A]={});Object.assign(j,k),E&&(j.id=E),I&&(j.type=I),N&&(j.function??(j.function={name:N.name??"",arguments:""})),N!=null&&N.name&&(j.function.name=N.name),N!=null&&N.arguments&&(j.function.arguments+=N.arguments,Efe(Ln(this,ka,"f"),j)&&(j.function.parsed_arguments=iM(j.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new oa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function Rfe(t,e){const{id:n,choices:r,created:s,model:i,system_fingerprint:o,...l}=t,c={...l,id:n,choices:r.map(({message:u,finish_reason:d,index:h,logprobs:f,...m})=>{if(!d)throw new zt(`missing finish_reason for choice ${h}`);const{content:g=null,function_call:x,tool_calls:v,...w}=u,_=u.role;if(!_)throw new zt(`missing role for choice ${h}`);if(x){const{arguments:C,name:T}=x;if(C==null)throw new zt(`missing function_call.arguments for choice ${h}`);if(!T)throw new zt(`missing function_call.name for choice ${h}`);return{...m,message:{content:g,function_call:{arguments:C,name:T},role:_,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}return v?{...m,index:h,finish_reason:d,logprobs:f,message:{...w,role:_,content:g,refusal:u.refusal??null,tool_calls:v.map((C,T)=>{const{function:R,type:A,id:E,...I}=C,{arguments:N,name:k,...j}=R||{};if(E==null)throw new zt(`missing choices[${h}].tool_calls[${T}].id
${nx(t)}`);if(A==null)throw new zt(`missing choices[${h}].tool_calls[${T}].type
${nx(t)}`);if(k==null)throw new zt(`missing choices[${h}].tool_calls[${T}].function.name
${nx(t)}`);if(N==null)throw new zt(`missing choices[${h}].tool_calls[${T}].function.arguments
${nx(t)}`);return{...I,id:E,type:A,function:{...j,name:k,arguments:N}}})}}:{...m,message:{...w,content:g,role:_,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}),created:s,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return _fe(c,e)}function nx(t){return JSON.stringify(t)}class Th extends Bp{static fromReadableStream(e){const n=new Th(null);return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new Th(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Th(n),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let kB=class extends Ht{parse(e,n){return Tfe(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>SN(r,e))}runFunctions(e,n){return e.stream?Th.runFunctions(this._client,e,n):Up.runFunctions(this._client,e,n)}runTools(e,n){return e.stream?Th.runTools(this._client,e,n):Up.runTools(this._client,e,n)}stream(e,n){return Bp.createChatCompletion(this._client,e,n)}};class rT extends Ht{constructor(){super(...arguments),this.completions=new kB(this._client)}}(function(t){t.Completions=kB})(rT||(rT={}));class RB extends Ht{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class jB extends Ht{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class cb extends Ht{constructor(){super(...arguments),this.sessions=new RB(this._client),this.transcriptionSessions=new jB(this._client)}}cb.Sessions=RB;cb.TranscriptionSessions=jB;class CN extends Ht{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,EN,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class EN extends Xr{}CN.MessagesPage=EN;class TN extends Ht{retrieve(e,n,r,s={},i){return ar(s)?this.retrieve(e,n,r,{},s):this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n,r={},s){return ar(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,IN,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class IN extends Xr{}TN.RunStepsPage=IN;let Lg=class extends Ht{constructor(){super(...arguments),this.steps=new TN(this._client)}create(e,n,r){const{include:s,...i}=n;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,NN,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return ko.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await jg(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return ko.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return ko.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}};class NN extends Xr{}Lg.RunsPage=NN;Lg.Steps=TN;Lg.RunStepsPage=IN;class _f extends Ht{constructor(){super(...arguments),this.runs=new Lg(this._client),this.messages=new CN(this._client)}create(e={},n){return ar(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return ko.createThreadAssistantStream(e,this._client.beta.threads,n)}}_f.Runs=Lg;_f.RunsPage=NN;_f.Messages=CN;_f.MessagesPage=EN;class Sf extends Ht{constructor(){super(...arguments),this.realtime=new cb(this._client),this.chat=new rT(this._client),this.assistants=new wN(this._client),this.threads=new _f(this._client)}}Sf.Realtime=cb;Sf.Assistants=wN;Sf.AssistantsPage=bN;Sf.Threads=_f;class DB extends Ht{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let MB=class extends Ht{retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}/content`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}},ub=class extends Ht{constructor(){super(...arguments),this.content=new MB(this._client)}create(e,n,r){return this._client.post(`/containers/${e}/files`,Hu({body:n,...r}))}retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}`,r)}list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/containers/${e}/files`,PN,{query:n,...r})}del(e,n,r){return this._client.delete(`/containers/${e}/files/${n}`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}};class PN extends Xr{}ub.FileListResponsesPage=PN;ub.Content=MB;class Fg extends Ht{constructor(){super(...arguments),this.files=new ub(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(`/containers/${e}`,n)}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/containers",AN,{query:e,...n})}del(e,n){return this._client.delete(`/containers/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class AN extends Xr{}Fg.ContainerListResponsesPage=AN;Fg.Files=ub;Fg.FileListResponsesPage=PN;class LB extends Ht{create(e,n){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&lc("Request","User defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:s},...n});return r?i:(lc("response","Decoding base64 embeddings to float32 array"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(l=>{const c=l.embedding;l.embedding=wfe(c)}),o)))}}class kN extends Ht{retrieve(e,n,r,s){return this._client.get(`/evals/${e}/runs/${n}/output_items/${r}`,s)}list(e,n,r={},s){return ar(r)?this.list(e,n,{},r):this._client.getAPIList(`/evals/${e}/runs/${n}/output_items`,RN,{query:r,...s})}}class RN extends Xr{}kN.OutputItemListResponsesPage=RN;class Og extends Ht{constructor(){super(...arguments),this.outputItems=new kN(this._client)}create(e,n,r){return this._client.post(`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){return this._client.get(`/evals/${e}/runs/${n}`,r)}list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/evals/${e}/runs`,jN,{query:n,...r})}del(e,n,r){return this._client.delete(`/evals/${e}/runs/${n}`,r)}cancel(e,n,r){return this._client.post(`/evals/${e}/runs/${n}`,r)}}class jN extends Xr{}Og.RunListResponsesPage=jN;Og.OutputItems=kN;Og.OutputItemListResponsesPage=RN;class Vg extends Ht{constructor(){super(...arguments),this.runs=new Og(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(`/evals/${e}`,n)}update(e,n,r){return this._client.post(`/evals/${e}`,{body:n,...r})}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/evals",DN,{query:e,...n})}del(e,n){return this._client.delete(`/evals/${e}`,n)}}class DN extends Xr{}Vg.EvalListResponsesPage=DN;Vg.Runs=Og;Vg.RunListResponsesPage=jN;let MN=class extends Ht{create(e,n){return this._client.post("/files",Hu({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/files",LN,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,n)}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await jg(n),o=await this.retrieve(e),Date.now()-i>r)throw new gN({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class LN extends Xr{}MN.FileObjectsPage=LN;class FB extends Ht{}let OB=class extends Ht{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class FN extends Ht{constructor(){super(...arguments),this.graders=new OB(this._client)}}FN.Graders=OB;class ON extends Ht{create(e,n,r){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,VN,{body:n,method:"post",...r})}retrieve(e,n={},r){return ar(n)?this.retrieve(e,{},n):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}del(e,n,r){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${n}`,r)}}class VN extends ib{}ON.PermissionCreateResponsesPage=VN;let db=class extends Ht{constructor(){super(...arguments),this.permissions=new ON(this._client)}};db.Permissions=ON;db.PermissionCreateResponsesPage=VN;class $N extends Ht{list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,UN,{query:n,...r})}}class UN extends Xr{}$N.FineTuningJobCheckpointsPage=UN;class Cf extends Ht{constructor(){super(...arguments),this.checkpoints=new $N(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",BN,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return ar(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,zN,{query:n,...r})}pause(e,n){return this._client.post(`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(`/fine_tuning/jobs/${e}/resume`,n)}}class BN extends Xr{}class zN extends Xr{}Cf.FineTuningJobsPage=BN;Cf.FineTuningJobEventsPage=zN;Cf.Checkpoints=$N;Cf.FineTuningJobCheckpointsPage=UN;class Vc extends Ht{constructor(){super(...arguments),this.methods=new FB(this._client),this.jobs=new Cf(this._client),this.checkpoints=new db(this._client),this.alpha=new FN(this._client)}}Vc.Methods=FB;Vc.Jobs=Cf;Vc.FineTuningJobsPage=BN;Vc.FineTuningJobEventsPage=zN;Vc.Checkpoints=db;Vc.Alpha=FN;class VB extends Ht{}class GN extends Ht{constructor(){super(...arguments),this.graderModels=new VB(this._client)}}GN.GraderModels=VB;class $B extends Ht{createVariation(e,n){return this._client.post("/images/variations",Hu({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",Hu({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}class WN extends Ht{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",HN,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class HN extends ib{}WN.ModelsPage=HN;class UB extends Ht{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function jfe(t,e){return!e||!Mfe(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:BB(t,e)}function BB(t,e){const n=t.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:Ofe(e,s)};if(s.type==="message"){const i=s.content.map(o=>o.type==="output_text"?{...o,parsed:Dfe(e,o.text)}:o);return{...s,content:i}}return s}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||sT(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const i of s.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function Dfe(t,e){var n,r,s,i;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=t.text)==null?void 0:s.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function Mfe(t){var e;return!!_N((e=t.text)==null?void 0:e.format)}function Lfe(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Ffe(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function Ofe(t,e){const n=Ffe(t.tools??[],e.name);return{...e,...e,parsed_arguments:Lfe(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function sT(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}class zB extends Ht{list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/responses/${e}/input_items`,$fe,{query:n,...r})}}var Pd=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},El=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ad,rx,Tl,sx,aM,lM,cM,uM;class qN extends vN{constructor(e){super(),Ad.add(this),rx.set(this,void 0),Tl.set(this,void 0),sx.set(this,void 0),Pd(this,rx,e,"f")}static createResponse(e,n,r){const s=new qN(n);return s._run(()=>s._createOrRetrieveResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),El(this,Ad,"m",aM).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const c of i)El(this,Ad,"m",lM).call(this,c,o);if((l=i.controller.signal)!=null&&l.aborted)throw new io;return El(this,Ad,"m",cM).call(this)}[(rx=new WeakMap,Tl=new WeakMap,sx=new WeakMap,Ad=new WeakSet,aM=function(){this.ended||Pd(this,Tl,void 0,"f")},lM=function(n,r){if(this.ended)return;const s=(o,l)=>{(r==null||l.sequence_number>r)&&this._emit(o,l)},i=El(this,Ad,"m",uM).call(this,n);switch(s("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new zt(`missing output at index ${n.output_index}`);if(o.type==="message"){const l=o.content[n.content_index];if(!l)throw new zt(`missing content at index ${n.content_index}`);if(l.type!=="output_text")throw new zt(`expected content to be 'output_text', got ${l.type}`);s("response.output_text.delta",{...n,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new zt(`missing output at index ${n.output_index}`);o.type==="function_call"&&s("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:s(n.type,n);break}},cM=function(){if(this.ended)throw new zt("stream has ended, this shouldn't happen");const n=El(this,Tl,"f");if(!n)throw new zt("request ended without sending any events");Pd(this,Tl,void 0,"f");const r=Vfe(n,El(this,rx,"f"));return Pd(this,sx,r,"f"),r},uM=function(n){let r=El(this,Tl,"f");if(!r){if(n.type!=="response.created")throw new zt(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=Pd(this,Tl,n.response,"f"),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const s=r.output[n.output_index];if(!s)throw new zt(`missing output at index ${n.output_index}`);s.type==="message"&&s.content.push(n.part);break}case"response.output_text.delta":{const s=r.output[n.output_index];if(!s)throw new zt(`missing output at index ${n.output_index}`);if(s.type==="message"){const i=s.content[n.content_index];if(!i)throw new zt(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new zt(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const s=r.output[n.output_index];if(!s)throw new zt(`missing output at index ${n.output_index}`);s.type==="function_call"&&(s.arguments+=n.delta);break}case"response.completed":{Pd(this,Tl,n.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=El(this,sx,"f");if(!e)throw new zt("stream ended without producing a ChatCompletion");return e}}function Vfe(t,e){return jfe(t,e)}class KN extends Ht{constructor(){super(...arguments),this.inputItems=new zB(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&sT(r),r))}retrieve(e,n={},r){return ar(n)&&r===void 0?this.retrieve(e,{},n):this._client.get(`/responses/${e}`,{query:n,...r,stream:n.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&sT(s),s))}del(e,n){return this._client.delete(`/responses/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>BB(r,e))}stream(e,n){return qN.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(`/responses/${e}/cancel`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class $fe extends Xr{}KN.InputItems=zB;class GB extends Ht{create(e,n,r){return this._client.post(`/uploads/${e}/parts`,Hu({body:n,...r}))}}class YN extends Ht{constructor(){super(...arguments),this.parts=new GB(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(`/uploads/${e}/complete`,{body:n,...r})}}YN.Parts=GB;const Ufe=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class hb extends Ht{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/vector_stores/${e}/files/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return ar(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,fb,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=i.response.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await jg(l);break;case"failed":case"completed":return o}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}content(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/files/${n}/content`,JN,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class fb extends Xr{}class JN extends ib{}hb.VectorStoreFilesPage=fb;hb.FileContentResponsesPage=JN;class WB extends Ht{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return ar(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,fb,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await jg(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(i,n.length),l=this._client,c=n.values(),u=[...r];async function d(f){for(let m of f){const g=await l.files.create({file:m,purpose:"assistants"},s);u.push(g.id)}}const h=Array(o).fill(c).map(d);return await Ufe(h),await this.createAndPoll(e,{file_ids:u})}}class $c extends Ht{constructor(){super(...arguments),this.files=new hb(this._client),this.fileBatches=new WB(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return ar(e)?this.list({},e):this._client.getAPIList("/vector_stores",XN,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}search(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/search`,QN,{body:n,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class XN extends Xr{}class QN extends ib{}$c.VectorStoresPage=XN;$c.VectorStoreSearchResponsesPage=QN;$c.Files=hb;$c.VectorStoreFilesPage=fb;$c.FileContentResponsesPage=JN;$c.FileBatches=WB;var HB;class Zt extends lfe{constructor({baseURL:e=Qy("OPENAI_BASE_URL"),apiKey:n=Qy("OPENAI_API_KEY"),organization:r=Qy("OPENAI_ORG_ID")??null,project:s=Qy("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new zt("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&xfe())throw new zt(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new DB(this),this.chat=new lb(this),this.embeddings=new LB(this),this.files=new MN(this),this.images=new $B(this),this.audio=new Dg(this),this.moderations=new UB(this),this.models=new WN(this),this.fineTuning=new Vc(this),this.graders=new GN(this),this.vectorStores=new $c(this),this.beta=new Sf(this),this.batches=new yN(this),this.uploads=new YN(this),this.responses=new KN(this),this.evals=new Vg(this),this.containers=new Fg(this),this._options=o,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return Ghe(e,{arrayFormat:"brackets"})}}HB=Zt;Zt.OpenAI=HB;Zt.DEFAULT_TIMEOUT=6e5;Zt.OpenAIError=zt;Zt.APIError=ys;Zt.APIConnectionError=tb;Zt.APIConnectionTimeoutError=gN;Zt.APIUserAbortError=io;Zt.NotFoundError=W6;Zt.ConflictError=H6;Zt.RateLimitError=K6;Zt.BadRequestError=B6;Zt.AuthenticationError=z6;Zt.InternalServerError=Y6;Zt.PermissionDeniedError=G6;Zt.UnprocessableEntityError=q6;Zt.toFile=tB;Zt.fileFromPath=V6;Zt.Completions=DB;Zt.Chat=lb;Zt.ChatCompletionsPage=ab;Zt.Embeddings=LB;Zt.Files=MN;Zt.FileObjectsPage=LN;Zt.Images=$B;Zt.Audio=Dg;Zt.Moderations=UB;Zt.Models=WN;Zt.ModelsPage=HN;Zt.FineTuning=Vc;Zt.Graders=GN;Zt.VectorStores=$c;Zt.VectorStoresPage=XN;Zt.VectorStoreSearchResponsesPage=QN;Zt.Beta=Sf;Zt.Batches=yN;Zt.BatchesPage=xN;Zt.Uploads=YN;Zt.Responses=KN;Zt.Evals=Vg;Zt.EvalListResponsesPage=DN;Zt.Containers=Fg;Zt.ContainerListResponsesPage=AN;const Bfe=Zt,zfe="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",Gfe=new Bfe({apiKey:zfe,dangerouslyAllowBrowser:!0});async function qB(t,e={}){if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required for OpenAI image generation.");console.log(`[OpenAI] Generating image with prompt: "${t}"`);try{const n=await Gfe.images.generate({model:"gpt-image-1",prompt:t,n:e.n||1,size:e.size||"1024x1024",quality:e.quality||"auto",response_format:"b64_json"});if(console.log("[OpenAI] Image generation response:",n),n.data&&n.data.length>0&&n.data[0].b64_json)return{b64_json:n.data[0].b64_json,alt:`OpenAI generated image for: ${t.substring(0,50)}`,revised_prompt:n.data[0].revised_prompt};throw new Error("No image data found in OpenAI response.")}catch(n){throw console.error("[OpenAI] Error generating image:",n),n.response&&n.response.data&&n.response.data.error?new Error(`OpenAI API Error: ${n.response.data.error.message}`):n}}const Wfe=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KB=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Hfe=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},YB={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let f=(l&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(KB(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Hfe(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new qfe;const f=i<<2|l>>4;if(r.push(f),u!==64){const m=l<<4&240|u>>2;if(r.push(m),h!==64){const g=u<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class qfe extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Kfe=function(t){const e=KB(t);return YB.encodeByteArray(e,!0)},yw=function(t){return Kfe(t).replace(/\./g,"")},JB=function(t){try{return YB.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XB(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yfe=()=>XB().__FIREBASE_DEFAULTS__,Jfe=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},Xfe=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&JB(t[1]);return e&&JSON.parse(e)},mb=()=>{try{return Wfe()||Yfe()||Jfe()||Xfe()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},QB=t=>{var e,n;return(n=(e=mb())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},ZN=t=>{const e=QB(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},ZB=()=>{var t;return(t=mb())===null||t===void 0?void 0:t.config},ez=t=>{var e;return(e=mb())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qfe{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uc(t){return t.endsWith(".cloudworkstations.dev")}async function pb(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tz(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[yw(JSON.stringify(n)),yw(JSON.stringify(o)),l].join(".")}const Zm={};function Zfe(){const t={prod:[],emulator:[]};for(const e of Object.keys(Zm))Zm[e]?t.emulator.push(e):t.prod.push(e);return t}function eme(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let dM=!1;function gb(t,e){if(typeof window>"u"||typeof document>"u"||!Uc(window.location.host)||Zm[t]===e||Zm[t]||dM)return;Zm[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=Zfe().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{dM=!0,o()},f}function d(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=eme(r),m=n("text"),g=document.getElementById(m)||document.createElement("span"),x=n("learnmore"),v=document.getElementById(x)||document.createElement("a"),w=n("preprendIcon"),_=document.getElementById(w)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const C=f.element;l(C),d(v,x);const T=u();c(_,w),C.append(_,g,v,T),document.body.appendChild(C)}i?(g.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tme(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Jr())}function nz(){var t;const e=(t=mb())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function nme(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rme(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function sme(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ime(){const t=Jr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function rz(){return!nz()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function sz(){return!nz()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function iz(){try{return typeof indexedDB=="object"}catch{return!1}}function ome(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ame="FirebaseError";class Wo extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=ame,Object.setPrototypeOf(this,Wo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,$g.prototype.create)}}class $g{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?lme(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Wo(s,l,r)}}function lme(t,e){return t.replace(cme,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const cme=/\{\$([^}]+)}/g;function ume(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function qu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(hM(i)&&hM(o)){if(!qu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function hM(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ug(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Cm(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Em(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function dme(t,e){const n=new hme(t,e);return n.subscribe.bind(n)}class hme{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");fme(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=PS),s.error===void 0&&(s.error=PS),s.complete===void 0&&(s.complete=PS);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fme(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function PS(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hn(t){return t&&t._delegate?t._delegate:t}class sl{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const au="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mme{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Qfe;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(gme(e))try{this.getOrInitializeService({instanceIdentifier:au})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=au){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=au){return this.instances.has(e)}getOptions(e=au){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:pme(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=au){return this.component?this.component.multipleInstances?e:au:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function pme(t){return t===au?void 0:t}function gme(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yme{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new mme(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dn;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(dn||(dn={}));const xme={debug:dn.DEBUG,verbose:dn.VERBOSE,info:dn.INFO,warn:dn.WARN,error:dn.ERROR,silent:dn.SILENT},vme=dn.INFO,wme={[dn.DEBUG]:"log",[dn.VERBOSE]:"log",[dn.INFO]:"info",[dn.WARN]:"warn",[dn.ERROR]:"error"},bme=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=wme[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class eP{constructor(e){this.name=e,this._logLevel=vme,this._logHandler=bme,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in dn))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xme[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,dn.DEBUG,...e),this._logHandler(this,dn.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,dn.VERBOSE,...e),this._logHandler(this,dn.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,dn.INFO,...e),this._logHandler(this,dn.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,dn.WARN,...e),this._logHandler(this,dn.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,dn.ERROR,...e),this._logHandler(this,dn.ERROR,...e)}}const _me=(t,e)=>e.some(n=>t instanceof n);let fM,mM;function Sme(){return fM||(fM=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Cme(){return mM||(mM=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const oz=new WeakMap,iT=new WeakMap,az=new WeakMap,AS=new WeakMap,tP=new WeakMap;function Eme(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(cc(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&oz.set(n,t)}).catch(()=>{}),tP.set(e,t),e}function Tme(t){if(iT.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});iT.set(t,e)}let oT={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return iT.get(t);if(e==="objectStoreNames")return t.objectStoreNames||az.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return cc(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Ime(t){oT=t(oT)}function Nme(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(kS(this),e,...n);return az.set(r,e.sort?e.sort():[e]),cc(r)}:Cme().includes(t)?function(...e){return t.apply(kS(this),e),cc(oz.get(this))}:function(...e){return cc(t.apply(kS(this),e))}}function Pme(t){return typeof t=="function"?Nme(t):(t instanceof IDBTransaction&&Tme(t),_me(t,Sme())?new Proxy(t,oT):t)}function cc(t){if(t instanceof IDBRequest)return Eme(t);if(AS.has(t))return AS.get(t);const e=Pme(t);return e!==t&&(AS.set(t,e),tP.set(e,t)),e}const kS=t=>tP.get(t);function Ame(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=cc(o);return r&&o.addEventListener("upgradeneeded",c=>{r(cc(o.result),c.oldVersion,c.newVersion,cc(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const kme=["get","getKey","getAll","getAllKeys","count"],Rme=["put","add","delete","clear"],RS=new Map;function pM(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(RS.get(e))return RS.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Rme.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||kme.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return RS.set(e,i),i}Ime(t=>({...t,get:(e,n,r)=>pM(e,n)||t.get(e,n,r),has:(e,n)=>!!pM(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jme{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(Dme(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function Dme(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const aT="@firebase/app",gM="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const il=new eP("@firebase/app"),Mme="@firebase/app-compat",Lme="@firebase/analytics-compat",Fme="@firebase/analytics",Ome="@firebase/app-check-compat",Vme="@firebase/app-check",$me="@firebase/auth",Ume="@firebase/auth-compat",Bme="@firebase/database",zme="@firebase/data-connect",Gme="@firebase/database-compat",Wme="@firebase/functions",Hme="@firebase/functions-compat",qme="@firebase/installations",Kme="@firebase/installations-compat",Yme="@firebase/messaging",Jme="@firebase/messaging-compat",Xme="@firebase/performance",Qme="@firebase/performance-compat",Zme="@firebase/remote-config",epe="@firebase/remote-config-compat",tpe="@firebase/storage",npe="@firebase/storage-compat",rpe="@firebase/firestore",spe="@firebase/ai",ipe="@firebase/firestore-compat",ope="firebase",ape="11.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const lT="[DEFAULT]",lpe={[aT]:"fire-core",[Mme]:"fire-core-compat",[Fme]:"fire-analytics",[Lme]:"fire-analytics-compat",[Vme]:"fire-app-check",[Ome]:"fire-app-check-compat",[$me]:"fire-auth",[Ume]:"fire-auth-compat",[Bme]:"fire-rtdb",[zme]:"fire-data-connect",[Gme]:"fire-rtdb-compat",[Wme]:"fire-fn",[Hme]:"fire-fn-compat",[qme]:"fire-iid",[Kme]:"fire-iid-compat",[Yme]:"fire-fcm",[Jme]:"fire-fcm-compat",[Xme]:"fire-perf",[Qme]:"fire-perf-compat",[Zme]:"fire-rc",[epe]:"fire-rc-compat",[tpe]:"fire-gcs",[npe]:"fire-gcs-compat",[rpe]:"fire-fst",[ipe]:"fire-fst-compat",[spe]:"fire-vertex","fire-js":"fire-js",[ope]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xw=new Map,cpe=new Map,cT=new Map;function yM(t,e){try{t.container.addComponent(e)}catch(n){il.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Sc(t){const e=t.name;if(cT.has(e))return il.debug(`There were multiple attempts to register component ${e}.`),!1;cT.set(e,t);for(const n of xw.values())yM(n,t);for(const n of cpe.values())yM(n,t);return!0}function Bg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function qs(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const upe={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},uc=new $g("app","Firebase",upe);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dpe{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new sl("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw uc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dd=ape;function lz(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:lT,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw uc.create("bad-app-name",{appName:String(s)});if(n||(n=ZB()),!n)throw uc.create("no-options");const i=xw.get(s);if(i){if(qu(n,i.options)&&qu(r,i.config))return i;throw uc.create("duplicate-app",{appName:s})}const o=new yme(s);for(const c of cT.values())o.addComponent(c);const l=new dpe(n,r,o);return xw.set(s,l),l}function yb(t=lT){const e=xw.get(t);if(!e&&t===lT&&ZB())return lz();if(!e)throw uc.create("no-app",{appName:t});return e}function lo(t,e,n){var r;let s=(r=lpe[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),il.warn(l.join(" "));return}Sc(new sl(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hpe="firebase-heartbeat-database",fpe=1,zp="firebase-heartbeat-store";let jS=null;function cz(){return jS||(jS=Ame(hpe,fpe,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(zp)}catch(n){console.warn(n)}}}}).catch(t=>{throw uc.create("idb-open",{originalErrorMessage:t.message})})),jS}async function mpe(t){try{const n=(await cz()).transaction(zp),r=await n.objectStore(zp).get(uz(t));return await n.done,r}catch(e){if(e instanceof Wo)il.warn(e.message);else{const n=uc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});il.warn(n.message)}}}async function xM(t,e){try{const r=(await cz()).transaction(zp,"readwrite");await r.objectStore(zp).put(e,uz(t)),await r.done}catch(n){if(n instanceof Wo)il.warn(n.message);else{const r=uc.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});il.warn(r.message)}}}function uz(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ppe=1024,gpe=30;class ype{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new vpe(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=vM();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>gpe){const o=wpe(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){il.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=vM(),{heartbeatsToSend:r,unsentEntries:s}=xpe(this._heartbeatsCache.heartbeats),i=yw(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return il.warn(n),""}}}function vM(){return new Date().toISOString().substring(0,10)}function xpe(t,e=ppe){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),wM(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),wM(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class vpe{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return iz()?ome().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await mpe(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return xM(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return xM(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function wM(t){return yw(JSON.stringify({version:2,heartbeats:t})).length}function wpe(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bpe(t){Sc(new sl("platform-logger",e=>new jme(e),"PRIVATE")),Sc(new sl("heartbeat",e=>new ype(e),"PRIVATE")),lo(aT,gM,t),lo(aT,gM,"esm2017"),lo("fire-js","")}bpe("");var _pe="firebase",Spe="11.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */lo(_pe,Spe,"app");function dz(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Cpe=dz,hz=new $g("auth","Firebase",dz());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vw=new eP("@firebase/auth");function Epe(t,...e){vw.logLevel<=dn.WARN&&vw.warn(`Auth (${dd}): ${t}`,...e)}function Qx(t,...e){vw.logLevel<=dn.ERROR&&vw.error(`Auth (${dd}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mo(t,...e){throw rP(t,...e)}function Fo(t,...e){return rP(t,...e)}function nP(t,e,n){const r=Object.assign(Object.assign({},Cpe()),{[e]:n});return new $g("auth","Firebase",r).create(e,{appName:t.name})}function Ya(t){return nP(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Tpe(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&mo(t,"argument-error"),nP(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function rP(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return hz.create(t,...e)}function Gt(t,e,...n){if(!t)throw rP(e,...n)}function Ba(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Qx(e),new Error(e)}function ol(t,e){t||Ba(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uT(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Ipe(){return bM()==="http:"||bM()==="https:"}function bM(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Npe(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Ipe()||rme()||"connection"in navigator)?navigator.onLine:!0}function Ppe(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zg{constructor(e,n){this.shortDelay=e,this.longDelay=n,ol(n>e,"Short delay should be less than long delay!"),this.isMobile=tme()||sme()}get(){return Npe()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sP(t,e){ol(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fz{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ba("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ba("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ba("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ape={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kpe=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Rpe=new zg(3e4,6e4);function Bc(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function zc(t,e,n,r,s={}){return mz(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Ug(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return nme()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Uc(t.emulatorConfig.host)&&(u.credentials="include"),fz.fetch()(await pz(t,t.config.apiHost,n,l),u)})}async function mz(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Ape),e);try{const s=new Dpe(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw ix(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw ix(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw ix(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw ix(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw nP(t,d,u);mo(t,d)}}catch(s){if(s instanceof Wo)throw s;mo(t,"network-request-failed",{message:String(s)})}}async function Gg(t,e,n,r,s={}){const i=await zc(t,e,n,r,s);return"mfaPendingCredential"in i&&mo(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function pz(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?sP(t.config,s):`${t.config.apiScheme}://${s}`;return kpe.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function jpe(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class Dpe{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Fo(this.auth,"network-request-failed")),Rpe.get())})}}function ix(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Fo(t,e,r);return s.customData._tokenResponse=n,s}function _M(t){return t!==void 0&&t.enterprise!==void 0}class Mpe{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return jpe(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Lpe(t,e){return zc(t,"GET","/v2/recaptchaConfig",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Fpe(t,e){return zc(t,"POST","/v1/accounts:delete",e)}async function ww(t,e){return zc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ep(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function Ope(t,e=!1){const n=Hn(t),r=await n.getIdToken(e),s=iP(r);Gt(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:ep(DS(s.auth_time)),issuedAtTime:ep(DS(s.iat)),expirationTime:ep(DS(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function DS(t){return Number(t)*1e3}function iP(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return Qx("JWT malformed, contained fewer than 3 sections"),null;try{const s=JB(n);return s?JSON.parse(s):(Qx("Failed to decode base64 JWT payload"),null)}catch(s){return Qx("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function SM(t){const e=iP(t);return Gt(e,"internal-error"),Gt(typeof e.exp<"u","internal-error"),Gt(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Gp(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Wo&&Vpe(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Vpe({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $pe{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dT{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=ep(this.lastLoginAt),this.creationTime=ep(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bw(t){var e;const n=t.auth,r=await t.getIdToken(),s=await Gp(t,ww(n,{idToken:r}));Gt(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?gz(i.providerUserInfo):[],l=Bpe(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new dT(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function Upe(t){const e=Hn(t);await bw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function Bpe(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function gz(t){return t.map(e=>{var{providerId:n}=e,r=bf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zpe(t,e){const n=await mz(t,{},async()=>{const r=Ug({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await pz(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",fz.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Gpe(t,e){return zc(t,"POST","/v2/accounts:revokeToken",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ih{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Gt(e.idToken,"internal-error"),Gt(typeof e.idToken<"u","internal-error"),Gt(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):SM(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Gt(e.length!==0,"internal-error");const n=SM(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Gt(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await zpe(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new Ih;return r&&(Gt(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&(Gt(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&(Gt(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Ih,this.toJSON())}_performRefresh(){return Ba("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Il(t,e){Gt(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Ro{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=bf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new $pe(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new dT(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await Gp(this,this.stsTokenManager.getToken(this.auth,e));return Gt(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return Ope(this,e)}reload(){return Upe(this)}_assign(e){this!==e&&(Gt(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Ro(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Gt(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await bw(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(qs(this.auth.app))return Promise.reject(Ya(this.auth));const e=await this.getIdToken();return await Gp(this,Fpe(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(s=n.email)!==null&&s!==void 0?s:void 0,m=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(l=n.tenantId)!==null&&l!==void 0?l:void 0,v=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,w=(u=n.createdAt)!==null&&u!==void 0?u:void 0,_=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:C,emailVerified:T,isAnonymous:R,providerData:A,stsTokenManager:E}=n;Gt(C&&E,e,"internal-error");const I=Ih.fromJSON(this.name,E);Gt(typeof C=="string",e,"internal-error"),Il(h,e.name),Il(f,e.name),Gt(typeof T=="boolean",e,"internal-error"),Gt(typeof R=="boolean",e,"internal-error"),Il(m,e.name),Il(g,e.name),Il(x,e.name),Il(v,e.name),Il(w,e.name),Il(_,e.name);const N=new Ro({uid:C,auth:e,email:f,emailVerified:T,displayName:h,isAnonymous:R,photoURL:g,phoneNumber:m,tenantId:x,stsTokenManager:I,createdAt:w,lastLoginAt:_});return A&&Array.isArray(A)&&(N.providerData=A.map(k=>Object.assign({},k))),v&&(N._redirectEventId=v),N}static async _fromIdTokenResponse(e,n,r=!1){const s=new Ih;s.updateFromServerResponse(n);const i=new Ro({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await bw(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];Gt(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?gz(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new Ih;l.updateFromIdToken(r);const c=new Ro({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new dT(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CM=new Map;function za(t){ol(t instanceof Function,"Expected a class definition");let e=CM.get(t);return e?(ol(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,CM.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yz{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}yz.type="NONE";const EM=yz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(t,e,n){return`firebase:${t}:${e}:${n}`}class Nh{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Zx(this.userKey,s.apiKey,i),this.fullPersistenceKey=Zx("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await ww(this.auth,{idToken:e}).catch(()=>{});return n?Ro._fromGetAccountInfoResponse(this.auth,n,e):null}return Ro._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Nh(za(EM),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||za(EM);const o=Zx(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){let h;if(typeof d=="string"){const f=await ww(e,{idToken:d}).catch(()=>{});if(!f)break;h=await Ro._fromGetAccountInfoResponse(e,f,d)}else h=Ro._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Nh(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Nh(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function TM(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(bz(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(xz(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(Sz(e))return"Blackberry";if(Cz(e))return"Webos";if(vz(e))return"Safari";if((e.includes("chrome/")||wz(e))&&!e.includes("edge/"))return"Chrome";if(_z(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function xz(t=Jr()){return/firefox\//i.test(t)}function vz(t=Jr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function wz(t=Jr()){return/crios\//i.test(t)}function bz(t=Jr()){return/iemobile/i.test(t)}function _z(t=Jr()){return/android/i.test(t)}function Sz(t=Jr()){return/blackberry/i.test(t)}function Cz(t=Jr()){return/webos/i.test(t)}function oP(t=Jr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Wpe(t=Jr()){var e;return oP(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Hpe(){return ime()&&document.documentMode===10}function Ez(t=Jr()){return oP(t)||_z(t)||Cz(t)||Sz(t)||/windows phone/i.test(t)||bz(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tz(t,e=[]){let n;switch(t){case"Browser":n=TM(Jr());break;case"Worker":n=`${TM(Jr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${dd}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qpe{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kpe(t,e={}){return zc(t,"GET","/v2/passwordPolicy",Bc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ype=6;class Jpe{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:Ype,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xpe{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new IM(this),this.idTokenSubscription=new IM(this),this.beforeStateQueue=new qpe(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=hz,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=za(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Nh.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await ww(this,{idToken:e}),r=await Ro._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(qs(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return Gt(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await bw(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Ppe()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(qs(this.app))return Promise.reject(Ya(this));const n=e?Hn(e):null;return n&&Gt(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Gt(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return qs(this.app)?Promise.reject(Ya(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return qs(this.app)?Promise.reject(Ya(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(za(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Kpe(this),n=new Jpe(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new $g("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Gpe(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&za(e)||this._popupRedirectResolver;Gt(n,this,"argument-error"),this.redirectPersistenceManager=await Nh.create(this,[za(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if(Gt(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Gt(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Tz(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(qs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Epe(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Gc(t){return Hn(t)}class IM{constructor(e){this.auth=e,this.observer=null,this.addObserver=dme(n=>this.observer=n)}get next(){return Gt(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let xb={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Qpe(t){xb=t}function Iz(t){return xb.loadJS(t)}function Zpe(){return xb.recaptchaEnterpriseScript}function ege(){return xb.gapiScript}function tge(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class nge{constructor(){this.enterprise=new rge}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class rge{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const sge="recaptcha-enterprise",Nz="NO_RECAPTCHA";class ige{constructor(e){this.type=sge,this.auth=Gc(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{Lpe(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Mpe(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;_M(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(Nz)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new nge().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&_M(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=Zpe();c.length!==0&&(c+=l),Iz(c).then(()=>{s(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function tm(t,e,n,r=!1,s=!1){const i=new ige(t);let o;if(s)o=Nz;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function hT(t,e,n,r,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await tm(t,e,n,n==="getOobCode");return r(t,l)}else return r(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await tm(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(l)});else if(s==="PHONE_PROVIDER")if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){const l=await tm(t,e,n);return r(t,l).catch(async c=>{var u;if(((u=t._getRecaptchaConfig())===null||u===void 0?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const d=await tm(t,e,n,!1,!0);return r(t,d)}return Promise.reject(c)})}else{const l=await tm(t,e,n,!1,!0);return r(t,l)}else return Promise.reject(s+" provider is not supported.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oge(t,e){const n=Bg(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(qu(i,e??{}))return s;mo(s,"already-initialized")}return n.initialize({options:e})}function age(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(za);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function lge(t,e,n){const r=Gc(t);Gt(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=Pz(e),{host:o,port:l}=cge(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},d=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){Gt(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Gt(qu(u,r.config.emulator)&&qu(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Uc(o)?(pb(`${i}//${o}${c}`),gb("Auth",!0)):s||uge()}function Pz(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function cge(t){const e=Pz(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:NM(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:NM(o)}}}function NM(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function uge(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aP{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ba("not implemented")}_getIdTokenResponse(e){return Ba("not implemented")}_linkToIdToken(e,n){return Ba("not implemented")}_getReauthenticationResolver(e){return Ba("not implemented")}}async function dge(t,e){return zc(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hge(t,e){return Gg(t,"POST","/v1/accounts:signInWithPassword",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fge(t,e){return Gg(t,"POST","/v1/accounts:signInWithEmailLink",Bc(t,e))}async function mge(t,e){return Gg(t,"POST","/v1/accounts:signInWithEmailLink",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wp extends aP{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Wp(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Wp(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hT(e,n,"signInWithPassword",hge,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return fge(e,{email:this._email,oobCode:this._password});default:mo(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return hT(e,r,"signUpPassword",dge,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return mge(e,{idToken:n,email:this._email,oobCode:this._password});default:mo(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Ph(t,e){return Gg(t,"POST","/v1/accounts:signInWithIdp",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pge="http://localhost";class Ku extends aP{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Ku(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):mo("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=bf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Ku(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Ph(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Ph(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Ph(e,n)}buildRequest(){const e={requestUri:pge,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Ug(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gge(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function yge(t){const e=Cm(Em(t)).link,n=e?Cm(Em(e)).deep_link_id:null,r=Cm(Em(t)).deep_link_id;return(r?Cm(Em(r)).link:null)||r||n||e||t}class lP{constructor(e){var n,r,s,i,o,l;const c=Cm(Em(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=gge((s=c.mode)!==null&&s!==void 0?s:null);Gt(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=yge(e);try{return new lP(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ef{constructor(){this.providerId=Ef.PROVIDER_ID}static credential(e,n){return Wp._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=lP.parseLink(n);return Gt(r,"argument-error"),Wp._fromEmailAndCode(e,r.code,r.tenantId)}}Ef.PROVIDER_ID="password";Ef.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ef.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cP{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wg extends cP{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bl extends Wg{constructor(){super("facebook.com")}static credential(e){return Ku._fromParams({providerId:Bl.PROVIDER_ID,signInMethod:Bl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Bl.credentialFromTaggedObject(e)}static credentialFromError(e){return Bl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Bl.credential(e.oauthAccessToken)}catch{return null}}}Bl.FACEBOOK_SIGN_IN_METHOD="facebook.com";Bl.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa extends Wg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Ku._fromParams({providerId:Fa.PROVIDER_ID,signInMethod:Fa.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Fa.credentialFromTaggedObject(e)}static credentialFromError(e){return Fa.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Fa.credential(n,r)}catch{return null}}}Fa.GOOGLE_SIGN_IN_METHOD="google.com";Fa.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zl extends Wg{constructor(){super("github.com")}static credential(e){return Ku._fromParams({providerId:zl.PROVIDER_ID,signInMethod:zl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return zl.credentialFromTaggedObject(e)}static credentialFromError(e){return zl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return zl.credential(e.oauthAccessToken)}catch{return null}}}zl.GITHUB_SIGN_IN_METHOD="github.com";zl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl extends Wg{constructor(){super("twitter.com")}static credential(e,n){return Ku._fromParams({providerId:Gl.PROVIDER_ID,signInMethod:Gl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Gl.credentialFromTaggedObject(e)}static credentialFromError(e){return Gl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Gl.credential(n,r)}catch{return null}}}Gl.TWITTER_SIGN_IN_METHOD="twitter.com";Gl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xge(t,e){return Gg(t,"POST","/v1/accounts:signUp",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Ro._fromIdTokenResponse(e,r,s),o=PM(r);return new Yu({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=PM(r);return new Yu({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function PM(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w extends Wo{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,_w.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new _w(e,n,r,s)}}function Az(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?_w._fromErrorAndOperation(t,i,e,r):i})}async function vge(t,e,n=!1){const r=await Gp(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Yu._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function wge(t,e,n=!1){const{auth:r}=t;if(qs(r.app))return Promise.reject(Ya(r));const s="reauthenticate";try{const i=await Gp(t,Az(r,s,e,t),n);Gt(i.idToken,r,"internal-error");const o=iP(i.idToken);Gt(o,r,"internal-error");const{sub:l}=o;return Gt(t.uid===l,r,"user-mismatch"),Yu._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&mo(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function kz(t,e,n=!1){if(qs(t.app))return Promise.reject(Ya(t));const r="signIn",s=await Az(t,r,e),i=await Yu._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function bge(t,e){return kz(Gc(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Rz(t){const e=Gc(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function _ge(t,e,n){if(qs(t.app))return Promise.reject(Ya(t));const r=Gc(t),o=await hT(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",xge,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Rz(t),c}),l=await Yu._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function Sge(t,e,n){return qs(t.app)?Promise.reject(Ya(t)):bge(Hn(t),Ef.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Rz(t),r})}function Cge(t,e,n,r){return Hn(t).onIdTokenChanged(e,n,r)}function Ege(t,e,n){return Hn(t).beforeAuthStateChanged(e,n)}function Tge(t,e,n,r){return Hn(t).onAuthStateChanged(e,n,r)}function Ige(t){return Hn(t).signOut()}const Sw="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jz{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(Sw,"1"),this.storage.removeItem(Sw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nge=1e3,Pge=10;class Dz extends jz{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=Ez(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Hpe()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Pge):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Nge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}Dz.type="LOCAL";const Age=Dz;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mz extends jz{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}Mz.type="SESSION";const Lz=Mz;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kge(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vb{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new vb(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await kge(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}vb.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uP(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rge{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=uP("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ga(){return window}function jge(t){ga().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fz(){return typeof ga().WorkerGlobalScope<"u"&&typeof ga().importScripts=="function"}async function Dge(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Mge(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Lge(){return Fz()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oz="firebaseLocalStorageDb",Fge=1,Cw="firebaseLocalStorage",Vz="fbase_key";class Hg{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function wb(t,e){return t.transaction([Cw],e?"readwrite":"readonly").objectStore(Cw)}function Oge(){const t=indexedDB.deleteDatabase(Oz);return new Hg(t).toPromise()}function fT(){const t=indexedDB.open(Oz,Fge);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(Cw,{keyPath:Vz})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(Cw)?e(r):(r.close(),await Oge(),e(await fT()))})})}async function AM(t,e,n){const r=wb(t,!0).put({[Vz]:e,value:n});return new Hg(r).toPromise()}async function Vge(t,e){const n=wb(t,!1).get(e),r=await new Hg(n).toPromise();return r===void 0?null:r.value}function kM(t,e){const n=wb(t,!0).delete(e);return new Hg(n).toPromise()}const $ge=800,Uge=3;class $z{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await fT(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Uge)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return Fz()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=vb._getInstance(Lge()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Dge(),!this.activeServiceWorker)return;this.sender=new Rge(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Mge()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await fT();return await AM(e,Sw,"1"),await kM(e,Sw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>AM(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Vge(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>kM(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=wb(s,!1).getAll();return new Hg(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),$ge)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}$z.type="LOCAL";const Bge=$z;new zg(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uz(t,e){return e?za(e):(Gt(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dP extends aP{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Ph(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Ph(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Ph(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function zge(t){return kz(t.auth,new dP(t),t.bypassAuthState)}function Gge(t){const{auth:e,user:n}=t;return Gt(n,e,"internal-error"),wge(n,new dP(t),t.bypassAuthState)}async function Wge(t){const{auth:e,user:n}=t;return Gt(n,e,"internal-error"),vge(n,new dP(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bz{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return zge;case"linkViaPopup":case"linkViaRedirect":return Wge;case"reauthViaPopup":case"reauthViaRedirect":return Gge;default:mo(this.auth,"internal-error")}}resolve(e){ol(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ol(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hge=new zg(2e3,1e4);async function qge(t,e,n){if(qs(t.app))return Promise.reject(Fo(t,"operation-not-supported-in-this-environment"));const r=Gc(t);Tpe(t,e,cP);const s=Uz(r,n);return new Iu(r,"signInViaPopup",e,s).executeNotNull()}class Iu extends Bz{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,Iu.currentPopupAction&&Iu.currentPopupAction.cancel(),Iu.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Gt(e,this.auth,"internal-error"),e}async onExecution(){ol(this.filter.length===1,"Popup operations only handle one event");const e=uP();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Fo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Fo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Iu.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Fo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Hge.get())};e()}}Iu.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kge="pendingRedirect",ev=new Map;class Yge extends Bz{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=ev.get(this.auth._key());if(!e){try{const r=await Jge(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}ev.set(this.auth._key(),e)}return this.bypassAuthState||ev.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Jge(t,e){const n=Zge(e),r=Qge(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function Xge(t,e){ev.set(t._key(),e)}function Qge(t){return za(t._redirectPersistence)}function Zge(t){return Zx(Kge,t.config.apiKey,t.name)}async function eye(t,e,n=!1){if(qs(t.app))return Promise.reject(Ya(t));const r=Gc(t),s=Uz(r,e),o=await new Yge(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tye=10*60*1e3;class nye{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!rye(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!zz(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Fo(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=tye&&this.cachedEventUids.clear(),this.cachedEventUids.has(RM(e))}saveEventToCache(e){this.cachedEventUids.add(RM(e)),this.lastProcessedEventTime=Date.now()}}function RM(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function zz({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function rye(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return zz(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function sye(t,e={}){return zc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iye=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,oye=/^https?/;async function aye(t){if(t.config.emulator)return;const{authorizedDomains:e}=await sye(t);for(const n of e)try{if(lye(n))return}catch{}mo(t,"unauthorized-domain")}function lye(t){const e=uT(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!oye.test(n))return!1;if(iye.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cye=new zg(3e4,6e4);function jM(){const t=ga().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function uye(t){return new Promise((e,n)=>{var r,s,i;function o(){jM(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{jM(),n(Fo(t,"network-request-failed"))},timeout:cye.get()})}if(!((s=(r=ga().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=ga().gapi)===null||i===void 0)&&i.load)o();else{const l=tge("iframefcb");return ga()[l]=()=>{gapi.load?o():n(Fo(t,"network-request-failed"))},Iz(`${ege()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw tv=null,e})}let tv=null;function dye(t){return tv=tv||uye(t),tv}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hye=new zg(5e3,15e3),fye="__/auth/iframe",mye="emulator/auth/iframe",pye={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},gye=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function yye(t){const e=t.config;Gt(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?sP(e,mye):`https://${t.config.authDomain}/${fye}`,r={apiKey:e.apiKey,appName:t.name,v:dd},s=gye.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Ug(r).slice(1)}`}async function xye(t){const e=await dye(t),n=ga().gapi;return Gt(n,t,"internal-error"),e.open({where:document.body,url:yye(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:pye,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Fo(t,"network-request-failed"),l=ga().setTimeout(()=>{i(o)},hye.get());function c(){ga().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vye={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},wye=500,bye=600,_ye="_blank",Sye="http://localhost";class DM{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Cye(t,e,n,r=wye,s=bye){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},vye),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Jr().toLowerCase();n&&(l=wz(u)?_ye:n),xz(u)&&(e=e||Sye,c.scrollbars="yes");const d=Object.entries(c).reduce((f,[m,g])=>`${f}${m}=${g},`,"");if(Wpe(u)&&l!=="_self")return Eye(e||"",l),new DM(null);const h=window.open(e||"",l,d);Gt(h,t,"popup-blocked");try{h.focus()}catch{}return new DM(h)}function Eye(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tye="__/auth/handler",Iye="emulator/auth/handler",Nye=encodeURIComponent("fac");async function MM(t,e,n,r,s,i){Gt(t.config.authDomain,t,"auth-domain-config-required"),Gt(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:dd,eventId:s};if(e instanceof cP){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",ume(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(i||{}))o[d]=h}if(e instanceof Wg){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${Nye}=${encodeURIComponent(c)}`:"";return`${Pye(t)}?${Ug(l).slice(1)}${u}`}function Pye({config:t}){return t.emulator?sP(t,Iye):`https://${t.authDomain}/${Tye}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MS="webStorageSupport";class Aye{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Lz,this._completeRedirectFn=eye,this._overrideRedirectResult=Xge}async _openPopup(e,n,r,s){var i;ol((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await MM(e,n,r,uT(),s);return Cye(e,o,uP())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await MM(e,n,r,uT(),s);return jge(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ol(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await xye(e),r=new nye(e);return n.register("authEvent",s=>(Gt(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(MS,{type:MS},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[MS];o!==void 0&&n(!!o),mo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=aye(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return Ez()||vz()||oP()}}const kye=Aye;var LM="@firebase/auth",FM="1.10.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rye{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Gt(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jye(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Dye(t){Sc(new sl("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;Gt(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Tz(t)},u=new Xpe(r,s,i,c);return age(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Sc(new sl("auth-internal",e=>{const n=Gc(e.getProvider("auth").getImmediate());return(r=>new Rye(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),lo(LM,FM,jye(t)),lo(LM,FM,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mye=5*60,Lye=ez("authIdTokenMaxAge")||Mye;let OM=null;const Fye=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Lye)return;const s=n==null?void 0:n.token;OM!==s&&(OM=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function Oye(t=yb()){const e=Bg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=oge(t,{popupRedirectResolver:kye,persistence:[Bge,Age,Lz]}),r=ez("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=Fye(i.toString());Ege(n,o,()=>o(n.currentUser)),Cge(n,l=>o(l))}}const s=QB("auth");return s&&lge(n,`http://${s}`),n}function Vye(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}Qpe({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Fo("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Vye().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Dye("Browser");var VM=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dc,Gz;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,I){function N(){}N.prototype=I.prototype,E.D=I.prototype,E.prototype=new N,E.prototype.constructor=E,E.C=function(k,j,D){for(var L=Array(arguments.length-2),G=2;G<arguments.length;G++)L[G-2]=arguments[G];return I.prototype[j].apply(k,L)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,I,N){N||(N=0);var k=Array(16);if(typeof I=="string")for(var j=0;16>j;++j)k[j]=I.charCodeAt(N++)|I.charCodeAt(N++)<<8|I.charCodeAt(N++)<<16|I.charCodeAt(N++)<<24;else for(j=0;16>j;++j)k[j]=I[N++]|I[N++]<<8|I[N++]<<16|I[N++]<<24;I=E.g[0],N=E.g[1],j=E.g[2];var D=E.g[3],L=I+(D^N&(j^D))+k[0]+3614090360&4294967295;I=N+(L<<7&4294967295|L>>>25),L=D+(j^I&(N^j))+k[1]+3905402710&4294967295,D=I+(L<<12&4294967295|L>>>20),L=j+(N^D&(I^N))+k[2]+606105819&4294967295,j=D+(L<<17&4294967295|L>>>15),L=N+(I^j&(D^I))+k[3]+3250441966&4294967295,N=j+(L<<22&4294967295|L>>>10),L=I+(D^N&(j^D))+k[4]+4118548399&4294967295,I=N+(L<<7&4294967295|L>>>25),L=D+(j^I&(N^j))+k[5]+1200080426&4294967295,D=I+(L<<12&4294967295|L>>>20),L=j+(N^D&(I^N))+k[6]+2821735955&4294967295,j=D+(L<<17&4294967295|L>>>15),L=N+(I^j&(D^I))+k[7]+4249261313&4294967295,N=j+(L<<22&4294967295|L>>>10),L=I+(D^N&(j^D))+k[8]+1770035416&4294967295,I=N+(L<<7&4294967295|L>>>25),L=D+(j^I&(N^j))+k[9]+2336552879&4294967295,D=I+(L<<12&4294967295|L>>>20),L=j+(N^D&(I^N))+k[10]+4294925233&4294967295,j=D+(L<<17&4294967295|L>>>15),L=N+(I^j&(D^I))+k[11]+2304563134&4294967295,N=j+(L<<22&4294967295|L>>>10),L=I+(D^N&(j^D))+k[12]+1804603682&4294967295,I=N+(L<<7&4294967295|L>>>25),L=D+(j^I&(N^j))+k[13]+4254626195&4294967295,D=I+(L<<12&4294967295|L>>>20),L=j+(N^D&(I^N))+k[14]+2792965006&4294967295,j=D+(L<<17&4294967295|L>>>15),L=N+(I^j&(D^I))+k[15]+1236535329&4294967295,N=j+(L<<22&4294967295|L>>>10),L=I+(j^D&(N^j))+k[1]+4129170786&4294967295,I=N+(L<<5&4294967295|L>>>27),L=D+(N^j&(I^N))+k[6]+3225465664&4294967295,D=I+(L<<9&4294967295|L>>>23),L=j+(I^N&(D^I))+k[11]+643717713&4294967295,j=D+(L<<14&4294967295|L>>>18),L=N+(D^I&(j^D))+k[0]+3921069994&4294967295,N=j+(L<<20&4294967295|L>>>12),L=I+(j^D&(N^j))+k[5]+3593408605&4294967295,I=N+(L<<5&4294967295|L>>>27),L=D+(N^j&(I^N))+k[10]+38016083&4294967295,D=I+(L<<9&4294967295|L>>>23),L=j+(I^N&(D^I))+k[15]+3634488961&4294967295,j=D+(L<<14&4294967295|L>>>18),L=N+(D^I&(j^D))+k[4]+3889429448&4294967295,N=j+(L<<20&4294967295|L>>>12),L=I+(j^D&(N^j))+k[9]+568446438&4294967295,I=N+(L<<5&4294967295|L>>>27),L=D+(N^j&(I^N))+k[14]+3275163606&4294967295,D=I+(L<<9&4294967295|L>>>23),L=j+(I^N&(D^I))+k[3]+4107603335&4294967295,j=D+(L<<14&4294967295|L>>>18),L=N+(D^I&(j^D))+k[8]+1163531501&4294967295,N=j+(L<<20&4294967295|L>>>12),L=I+(j^D&(N^j))+k[13]+2850285829&4294967295,I=N+(L<<5&4294967295|L>>>27),L=D+(N^j&(I^N))+k[2]+4243563512&4294967295,D=I+(L<<9&4294967295|L>>>23),L=j+(I^N&(D^I))+k[7]+1735328473&4294967295,j=D+(L<<14&4294967295|L>>>18),L=N+(D^I&(j^D))+k[12]+2368359562&4294967295,N=j+(L<<20&4294967295|L>>>12),L=I+(N^j^D)+k[5]+4294588738&4294967295,I=N+(L<<4&4294967295|L>>>28),L=D+(I^N^j)+k[8]+2272392833&4294967295,D=I+(L<<11&4294967295|L>>>21),L=j+(D^I^N)+k[11]+1839030562&4294967295,j=D+(L<<16&4294967295|L>>>16),L=N+(j^D^I)+k[14]+4259657740&4294967295,N=j+(L<<23&4294967295|L>>>9),L=I+(N^j^D)+k[1]+2763975236&4294967295,I=N+(L<<4&4294967295|L>>>28),L=D+(I^N^j)+k[4]+1272893353&4294967295,D=I+(L<<11&4294967295|L>>>21),L=j+(D^I^N)+k[7]+4139469664&4294967295,j=D+(L<<16&4294967295|L>>>16),L=N+(j^D^I)+k[10]+3200236656&4294967295,N=j+(L<<23&4294967295|L>>>9),L=I+(N^j^D)+k[13]+681279174&4294967295,I=N+(L<<4&4294967295|L>>>28),L=D+(I^N^j)+k[0]+3936430074&4294967295,D=I+(L<<11&4294967295|L>>>21),L=j+(D^I^N)+k[3]+3572445317&4294967295,j=D+(L<<16&4294967295|L>>>16),L=N+(j^D^I)+k[6]+76029189&4294967295,N=j+(L<<23&4294967295|L>>>9),L=I+(N^j^D)+k[9]+3654602809&4294967295,I=N+(L<<4&4294967295|L>>>28),L=D+(I^N^j)+k[12]+3873151461&4294967295,D=I+(L<<11&4294967295|L>>>21),L=j+(D^I^N)+k[15]+530742520&4294967295,j=D+(L<<16&4294967295|L>>>16),L=N+(j^D^I)+k[2]+3299628645&4294967295,N=j+(L<<23&4294967295|L>>>9),L=I+(j^(N|~D))+k[0]+4096336452&4294967295,I=N+(L<<6&4294967295|L>>>26),L=D+(N^(I|~j))+k[7]+1126891415&4294967295,D=I+(L<<10&4294967295|L>>>22),L=j+(I^(D|~N))+k[14]+2878612391&4294967295,j=D+(L<<15&4294967295|L>>>17),L=N+(D^(j|~I))+k[5]+4237533241&4294967295,N=j+(L<<21&4294967295|L>>>11),L=I+(j^(N|~D))+k[12]+1700485571&4294967295,I=N+(L<<6&4294967295|L>>>26),L=D+(N^(I|~j))+k[3]+2399980690&4294967295,D=I+(L<<10&4294967295|L>>>22),L=j+(I^(D|~N))+k[10]+4293915773&4294967295,j=D+(L<<15&4294967295|L>>>17),L=N+(D^(j|~I))+k[1]+2240044497&4294967295,N=j+(L<<21&4294967295|L>>>11),L=I+(j^(N|~D))+k[8]+1873313359&4294967295,I=N+(L<<6&4294967295|L>>>26),L=D+(N^(I|~j))+k[15]+4264355552&4294967295,D=I+(L<<10&4294967295|L>>>22),L=j+(I^(D|~N))+k[6]+2734768916&4294967295,j=D+(L<<15&4294967295|L>>>17),L=N+(D^(j|~I))+k[13]+1309151649&4294967295,N=j+(L<<21&4294967295|L>>>11),L=I+(j^(N|~D))+k[4]+4149444226&4294967295,I=N+(L<<6&4294967295|L>>>26),L=D+(N^(I|~j))+k[11]+3174756917&4294967295,D=I+(L<<10&4294967295|L>>>22),L=j+(I^(D|~N))+k[2]+718787259&4294967295,j=D+(L<<15&4294967295|L>>>17),L=N+(D^(j|~I))+k[9]+3951481745&4294967295,E.g[0]=E.g[0]+I&4294967295,E.g[1]=E.g[1]+(j+(L<<21&4294967295|L>>>11))&4294967295,E.g[2]=E.g[2]+j&4294967295,E.g[3]=E.g[3]+D&4294967295}r.prototype.u=function(E,I){I===void 0&&(I=E.length);for(var N=I-this.blockSize,k=this.B,j=this.h,D=0;D<I;){if(j==0)for(;D<=N;)s(this,E,D),D+=this.blockSize;if(typeof E=="string"){for(;D<I;)if(k[j++]=E.charCodeAt(D++),j==this.blockSize){s(this,k),j=0;break}}else for(;D<I;)if(k[j++]=E[D++],j==this.blockSize){s(this,k),j=0;break}}this.h=j,this.o+=I},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var I=1;I<E.length-8;++I)E[I]=0;var N=8*this.o;for(I=E.length-8;I<E.length;++I)E[I]=N&255,N/=256;for(this.u(E),E=Array(16),I=N=0;4>I;++I)for(var k=0;32>k;k+=8)E[N++]=this.g[I]>>>k&255;return E};function i(E,I){var N=l;return Object.prototype.hasOwnProperty.call(N,E)?N[E]:N[E]=I(E)}function o(E,I){this.h=I;for(var N=[],k=!0,j=E.length-1;0<=j;j--){var D=E[j]|0;k&&D==I||(N[j]=D,k=!1)}this.g=N}var l={};function c(E){return-128<=E&&128>E?i(E,function(I){return new o([I|0],0>I?-1:0)}):new o([E|0],0>E?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return h;if(0>E)return v(u(-E));for(var I=[],N=1,k=0;E>=N;k++)I[k]=E/N|0,N*=4294967296;return new o(I,0)}function d(E,I){if(E.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(E.charAt(0)=="-")return v(d(E.substring(1),I));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var N=u(Math.pow(I,8)),k=h,j=0;j<E.length;j+=8){var D=Math.min(8,E.length-j),L=parseInt(E.substring(j,j+D),I);8>D?(D=u(Math.pow(I,D)),k=k.j(D).add(u(L))):(k=k.j(N),k=k.add(u(L)))}return k}var h=c(0),f=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(x(this))return-v(this).m();for(var E=0,I=1,N=0;N<this.g.length;N++){var k=this.i(N);E+=(0<=k?k:4294967296+k)*I,I*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(g(this))return"0";if(x(this))return"-"+v(this).toString(E);for(var I=u(Math.pow(E,6)),N=this,k="";;){var j=T(N,I).g;N=w(N,j.j(I));var D=((0<N.g.length?N.g[0]:N.h)>>>0).toString(E);if(N=j,g(N))return D+k;for(;6>D.length;)D="0"+D;k=D+k}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function g(E){if(E.h!=0)return!1;for(var I=0;I<E.g.length;I++)if(E.g[I]!=0)return!1;return!0}function x(E){return E.h==-1}t.l=function(E){return E=w(this,E),x(E)?-1:g(E)?0:1};function v(E){for(var I=E.g.length,N=[],k=0;k<I;k++)N[k]=~E.g[k];return new o(N,~E.h).add(f)}t.abs=function(){return x(this)?v(this):this},t.add=function(E){for(var I=Math.max(this.g.length,E.g.length),N=[],k=0,j=0;j<=I;j++){var D=k+(this.i(j)&65535)+(E.i(j)&65535),L=(D>>>16)+(this.i(j)>>>16)+(E.i(j)>>>16);k=L>>>16,D&=65535,L&=65535,N[j]=L<<16|D}return new o(N,N[N.length-1]&-2147483648?-1:0)};function w(E,I){return E.add(v(I))}t.j=function(E){if(g(this)||g(E))return h;if(x(this))return x(E)?v(this).j(v(E)):v(v(this).j(E));if(x(E))return v(this.j(v(E)));if(0>this.l(m)&&0>E.l(m))return u(this.m()*E.m());for(var I=this.g.length+E.g.length,N=[],k=0;k<2*I;k++)N[k]=0;for(k=0;k<this.g.length;k++)for(var j=0;j<E.g.length;j++){var D=this.i(k)>>>16,L=this.i(k)&65535,G=E.i(j)>>>16,B=E.i(j)&65535;N[2*k+2*j]+=L*B,_(N,2*k+2*j),N[2*k+2*j+1]+=D*B,_(N,2*k+2*j+1),N[2*k+2*j+1]+=L*G,_(N,2*k+2*j+1),N[2*k+2*j+2]+=D*G,_(N,2*k+2*j+2)}for(k=0;k<I;k++)N[k]=N[2*k+1]<<16|N[2*k];for(k=I;k<2*I;k++)N[k]=0;return new o(N,0)};function _(E,I){for(;(E[I]&65535)!=E[I];)E[I+1]+=E[I]>>>16,E[I]&=65535,I++}function C(E,I){this.g=E,this.h=I}function T(E,I){if(g(I))throw Error("division by zero");if(g(E))return new C(h,h);if(x(E))return I=T(v(E),I),new C(v(I.g),v(I.h));if(x(I))return I=T(E,v(I)),new C(v(I.g),I.h);if(30<E.g.length){if(x(E)||x(I))throw Error("slowDivide_ only works with positive integers.");for(var N=f,k=I;0>=k.l(E);)N=R(N),k=R(k);var j=A(N,1),D=A(k,1);for(k=A(k,2),N=A(N,2);!g(k);){var L=D.add(k);0>=L.l(E)&&(j=j.add(N),D=L),k=A(k,1),N=A(N,1)}return I=w(E,j.j(I)),new C(j,I)}for(j=h;0<=E.l(I);){for(N=Math.max(1,Math.floor(E.m()/I.m())),k=Math.ceil(Math.log(N)/Math.LN2),k=48>=k?1:Math.pow(2,k-48),D=u(N),L=D.j(I);x(L)||0<L.l(E);)N-=k,D=u(N),L=D.j(I);g(D)&&(D=f),j=j.add(D),E=w(E,L)}return new C(j,E)}t.A=function(E){return T(this,E).h},t.and=function(E){for(var I=Math.max(this.g.length,E.g.length),N=[],k=0;k<I;k++)N[k]=this.i(k)&E.i(k);return new o(N,this.h&E.h)},t.or=function(E){for(var I=Math.max(this.g.length,E.g.length),N=[],k=0;k<I;k++)N[k]=this.i(k)|E.i(k);return new o(N,this.h|E.h)},t.xor=function(E){for(var I=Math.max(this.g.length,E.g.length),N=[],k=0;k<I;k++)N[k]=this.i(k)^E.i(k);return new o(N,this.h^E.h)};function R(E){for(var I=E.g.length+1,N=[],k=0;k<I;k++)N[k]=E.i(k)<<1|E.i(k-1)>>>31;return new o(N,E.h)}function A(E,I){var N=I>>5;I%=32;for(var k=E.g.length-N,j=[],D=0;D<k;D++)j[D]=0<I?E.i(D+N)>>>I|E.i(D+N+1)<<32-I:E.i(D+N);return new o(j,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,Gz=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,dc=o}).apply(typeof VM<"u"?VM:typeof self<"u"?self:typeof window<"u"?window:{});var ox=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Wz,Tm,Hz,nv,mT,qz,Kz,Yz;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,P,M){return y==Array.prototype||y==Object.prototype||(y[P]=M.value),y};function n(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof ox=="object"&&ox];for(var P=0;P<y.length;++P){var M=y[P];if(M&&M.Math==Math)return M}throw Error("Cannot find global object")}var r=n(this);function s(y,P){if(P)e:{var M=r;y=y.split(".");for(var U=0;U<y.length-1;U++){var fe=y[U];if(!(fe in M))break e;M=M[fe]}y=y[y.length-1],U=M[y],P=P(U),P!=U&&P!=null&&e(M,y,{configurable:!0,writable:!0,value:P})}}function i(y,P){y instanceof String&&(y+="");var M=0,U=!1,fe={next:function(){if(!U&&M<y.length){var ke=M++;return{value:P(ke,y[ke]),done:!1}}return U=!0,{done:!0,value:void 0}}};return fe[Symbol.iterator]=function(){return fe},fe}s("Array.prototype.values",function(y){return y||function(){return i(this,function(P,M){return M})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(y){var P=typeof y;return P=P!="object"?P:y?Array.isArray(y)?"array":P:"null",P=="array"||P=="object"&&typeof y.length=="number"}function u(y){var P=typeof y;return P=="object"&&y!=null||P=="function"}function d(y,P,M){return y.call.apply(y.bind,arguments)}function h(y,P,M){if(!y)throw Error();if(2<arguments.length){var U=Array.prototype.slice.call(arguments,2);return function(){var fe=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(fe,U),y.apply(P,fe)}}return function(){return y.apply(P,arguments)}}function f(y,P,M){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(y,P){var M=Array.prototype.slice.call(arguments,1);return function(){var U=M.slice();return U.push.apply(U,arguments),y.apply(this,U)}}function g(y,P){function M(){}M.prototype=P.prototype,y.aa=P.prototype,y.prototype=new M,y.prototype.constructor=y,y.Qb=function(U,fe,ke){for(var ot=Array(arguments.length-2),Un=2;Un<arguments.length;Un++)ot[Un-2]=arguments[Un];return P.prototype[fe].apply(U,ot)}}function x(y){const P=y.length;if(0<P){const M=Array(P);for(let U=0;U<P;U++)M[U]=y[U];return M}return[]}function v(y,P){for(let M=1;M<arguments.length;M++){const U=arguments[M];if(c(U)){const fe=y.length||0,ke=U.length||0;y.length=fe+ke;for(let ot=0;ot<ke;ot++)y[fe+ot]=U[ot]}else y.push(U)}}class w{constructor(P,M){this.i=P,this.j=M,this.h=0,this.g=null}get(){let P;return 0<this.h?(this.h--,P=this.g,this.g=P.next,P.next=null):P=this.i(),P}}function _(y){return/^[\s\xa0]*$/.test(y)}function C(){var y=l.navigator;return y&&(y=y.userAgent)?y:""}function T(y){return T[" "](y),y}T[" "]=function(){};var R=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function A(y,P,M){for(const U in y)P.call(M,y[U],U,y)}function E(y,P){for(const M in y)P.call(void 0,y[M],M,y)}function I(y){const P={};for(const M in y)P[M]=y[M];return P}const N="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function k(y,P){let M,U;for(let fe=1;fe<arguments.length;fe++){U=arguments[fe];for(M in U)y[M]=U[M];for(let ke=0;ke<N.length;ke++)M=N[ke],Object.prototype.hasOwnProperty.call(U,M)&&(y[M]=U[M])}}function j(y){var P=1;y=y.split(":");const M=[];for(;0<P&&y.length;)M.push(y.shift()),P--;return y.length&&M.push(y.join(":")),M}function D(y){l.setTimeout(()=>{throw y},0)}function L(){var y=K;let P=null;return y.g&&(P=y.g,y.g=y.g.next,y.g||(y.h=null),P.next=null),P}class G{constructor(){this.h=this.g=null}add(P,M){const U=B.get();U.set(P,M),this.h?this.h.next=U:this.g=U,this.h=U}}var B=new w(()=>new W,y=>y.reset());class W{constructor(){this.next=this.g=this.h=null}set(P,M){this.h=P,this.g=M,this.next=null}reset(){this.next=this.g=this.h=null}}let X,H=!1,K=new G,V=()=>{const y=l.Promise.resolve(void 0);X=()=>{y.then($)}};var $=()=>{for(var y;y=L();){try{y.h.call(y.g)}catch(M){D(M)}var P=B;P.j(y),100>P.h&&(P.h++,y.next=P.g,P.g=y)}H=!1};function z(){this.s=this.s,this.C=this.C}z.prototype.s=!1,z.prototype.ma=function(){this.s||(this.s=!0,this.N())},z.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function F(y,P){this.type=y,this.g=this.target=P,this.defaultPrevented=!1}F.prototype.h=function(){this.defaultPrevented=!0};var Z=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,P=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const M=()=>{};l.addEventListener("test",M,P),l.removeEventListener("test",M,P)}catch{}return y}();function ce(y,P){if(F.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var M=this.type=y.type,U=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=P,P=y.relatedTarget){if(R){e:{try{T(P.nodeName);var fe=!0;break e}catch{}fe=!1}fe||(P=null)}}else M=="mouseover"?P=y.fromElement:M=="mouseout"&&(P=y.toElement);this.relatedTarget=P,U?(this.clientX=U.clientX!==void 0?U.clientX:U.pageX,this.clientY=U.clientY!==void 0?U.clientY:U.pageY,this.screenX=U.screenX||0,this.screenY=U.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:le[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&ce.aa.h.call(this)}}g(ce,F);var le={2:"touch",3:"pen",4:"mouse"};ce.prototype.h=function(){ce.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var he="closure_listenable_"+(1e6*Math.random()|0),Le=0;function $e(y,P,M,U,fe){this.listener=y,this.proxy=null,this.src=P,this.type=M,this.capture=!!U,this.ha=fe,this.key=++Le,this.da=this.fa=!1}function Be(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function ue(y){this.src=y,this.g={},this.h=0}ue.prototype.add=function(y,P,M,U,fe){var ke=y.toString();y=this.g[ke],y||(y=this.g[ke]=[],this.h++);var ot=Ie(y,P,U,fe);return-1<ot?(P=y[ot],M||(P.fa=!1)):(P=new $e(P,this.src,ke,!!U,fe),P.fa=M,y.push(P)),P};function Ce(y,P){var M=P.type;if(M in y.g){var U=y.g[M],fe=Array.prototype.indexOf.call(U,P,void 0),ke;(ke=0<=fe)&&Array.prototype.splice.call(U,fe,1),ke&&(Be(P),y.g[M].length==0&&(delete y.g[M],y.h--))}}function Ie(y,P,M,U){for(var fe=0;fe<y.length;++fe){var ke=y[fe];if(!ke.da&&ke.listener==P&&ke.capture==!!M&&ke.ha==U)return fe}return-1}var ve="closure_lm_"+(1e6*Math.random()|0),ie={};function Me(y,P,M,U,fe){if(U&&U.once)return kt(y,P,M,U,fe);if(Array.isArray(P)){for(var ke=0;ke<P.length;ke++)Me(y,P[ke],M,U,fe);return null}return M=de(M),y&&y[he]?y.K(P,M,u(U)?!!U.capture:!!U,fe):He(y,P,M,!1,U,fe)}function He(y,P,M,U,fe,ke){if(!P)throw Error("Invalid event type");var ot=u(fe)?!!fe.capture:!!fe,Un=Ue(y);if(Un||(y[ve]=Un=new ue(y)),M=Un.add(P,M,U,ot,ke),M.proxy)return M;if(U=yt(),M.proxy=U,U.src=y,U.listener=M,y.addEventListener)Z||(fe=ot),fe===void 0&&(fe=!1),y.addEventListener(P.toString(),U,fe);else if(y.attachEvent)y.attachEvent(cn(P.toString()),U);else if(y.addListener&&y.removeListener)y.addListener(U);else throw Error("addEventListener and attachEvent are unavailable.");return M}function yt(){function y(M){return P.call(y.src,y.listener,M)}const P=fn;return y}function kt(y,P,M,U,fe){if(Array.isArray(P)){for(var ke=0;ke<P.length;ke++)kt(y,P[ke],M,U,fe);return null}return M=de(M),y&&y[he]?y.L(P,M,u(U)?!!U.capture:!!U,fe):He(y,P,M,!0,U,fe)}function en(y,P,M,U,fe){if(Array.isArray(P))for(var ke=0;ke<P.length;ke++)en(y,P[ke],M,U,fe);else U=u(U)?!!U.capture:!!U,M=de(M),y&&y[he]?(y=y.i,P=String(P).toString(),P in y.g&&(ke=y.g[P],M=Ie(ke,M,U,fe),-1<M&&(Be(ke[M]),Array.prototype.splice.call(ke,M,1),ke.length==0&&(delete y.g[P],y.h--)))):y&&(y=Ue(y))&&(P=y.g[P.toString()],y=-1,P&&(y=Ie(P,M,U,fe)),(M=-1<y?P[y]:null)&&mn(M))}function mn(y){if(typeof y!="number"&&y&&!y.da){var P=y.src;if(P&&P[he])Ce(P.i,y);else{var M=y.type,U=y.proxy;P.removeEventListener?P.removeEventListener(M,U,y.capture):P.detachEvent?P.detachEvent(cn(M),U):P.addListener&&P.removeListener&&P.removeListener(U),(M=Ue(P))?(Ce(M,y),M.h==0&&(M.src=null,P[ve]=null)):Be(y)}}}function cn(y){return y in ie?ie[y]:ie[y]="on"+y}function fn(y,P){if(y.da)y=!0;else{P=new ce(P,this);var M=y.listener,U=y.ha||y.src;y.fa&&mn(y),y=M.call(U,P)}return y}function Ue(y){return y=y[ve],y instanceof ue?y:null}var Et="__closure_events_fn_"+(1e9*Math.random()>>>0);function de(y){return typeof y=="function"?y:(y[Et]||(y[Et]=function(P){return y.handleEvent(P)}),y[Et])}function De(){z.call(this),this.i=new ue(this),this.M=this,this.F=null}g(De,z),De.prototype[he]=!0,De.prototype.removeEventListener=function(y,P,M,U){en(this,y,P,M,U)};function ee(y,P){var M,U=y.F;if(U)for(M=[];U;U=U.F)M.push(U);if(y=y.M,U=P.type||P,typeof P=="string")P=new F(P,y);else if(P instanceof F)P.target=P.target||y;else{var fe=P;P=new F(U,y),k(P,fe)}if(fe=!0,M)for(var ke=M.length-1;0<=ke;ke--){var ot=P.g=M[ke];fe=ae(ot,U,!0,P)&&fe}if(ot=P.g=y,fe=ae(ot,U,!0,P)&&fe,fe=ae(ot,U,!1,P)&&fe,M)for(ke=0;ke<M.length;ke++)ot=P.g=M[ke],fe=ae(ot,U,!1,P)&&fe}De.prototype.N=function(){if(De.aa.N.call(this),this.i){var y=this.i,P;for(P in y.g){for(var M=y.g[P],U=0;U<M.length;U++)Be(M[U]);delete y.g[P],y.h--}}this.F=null},De.prototype.K=function(y,P,M,U){return this.i.add(String(y),P,!1,M,U)},De.prototype.L=function(y,P,M,U){return this.i.add(String(y),P,!0,M,U)};function ae(y,P,M,U){if(P=y.i.g[String(P)],!P)return!0;P=P.concat();for(var fe=!0,ke=0;ke<P.length;++ke){var ot=P[ke];if(ot&&!ot.da&&ot.capture==M){var Un=ot.listener,ls=ot.ha||ot.src;ot.fa&&Ce(y.i,ot),fe=Un.call(ls,U)!==!1&&fe}}return fe&&!U.defaultPrevented}function Q(y,P,M){if(typeof y=="function")M&&(y=f(y,M));else if(y&&typeof y.handleEvent=="function")y=f(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(P)?-1:l.setTimeout(y,P||0)}function Pe(y){y.g=Q(()=>{y.g=null,y.i&&(y.i=!1,Pe(y))},y.l);const P=y.h;y.h=null,y.m.apply(null,P)}class Ae extends z{constructor(P,M){super(),this.m=P,this.l=M,this.h=null,this.i=!1,this.g=null}j(P){this.h=arguments,this.g?this.i=!0:Pe(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function Ve(y){z.call(this),this.h=y,this.g={}}g(Ve,z);var qe=[];function oe(y){A(y.g,function(P,M){this.g.hasOwnProperty(M)&&mn(P)},y),y.g={}}Ve.prototype.N=function(){Ve.aa.N.call(this),oe(this)},Ve.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var _e=l.JSON.stringify,ze=l.JSON.parse,Te=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function Tt(){}Tt.prototype.h=null;function wt(y){return y.h||(y.h=y.i())}function xt(){}var pt={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function Nt(){F.call(this,"d")}g(Nt,F);function jn(){F.call(this,"c")}g(jn,F);var Sn={},cr=null;function sn(){return cr=cr||new De}Sn.La="serverreachability";function Vt(y){F.call(this,Sn.La,y)}g(Vt,F);function tn(y){const P=sn();ee(P,new Vt(P))}Sn.STAT_EVENT="statevent";function Zn(y,P){F.call(this,Sn.STAT_EVENT,y),this.stat=P}g(Zn,F);function Y(y){const P=sn();ee(P,new Zn(P,y))}Sn.Ma="timingevent";function re(y,P){F.call(this,Sn.Ma,y),this.size=P}g(re,F);function ge(y,P){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},P)}function Oe(){this.g=!0}Oe.prototype.xa=function(){this.g=!1};function tt(y,P,M,U,fe,ke){y.info(function(){if(y.g)if(ke)for(var ot="",Un=ke.split("&"),ls=0;ls<Un.length;ls++){var vn=Un[ls].split("=");if(1<vn.length){var _s=vn[0];vn=vn[1];var Ss=_s.split("_");ot=2<=Ss.length&&Ss[1]=="type"?ot+(_s+"="+vn+"&"):ot+(_s+"=redacted&")}}else ot=null;else ot=ke;return"XMLHTTP REQ ("+U+") [attempt "+fe+"]: "+P+`
`+M+`
`+ot})}function J(y,P,M,U,fe,ke,ot){y.info(function(){return"XMLHTTP RESP ("+U+") [ attempt "+fe+"]: "+P+`
`+M+`
`+ke+" "+ot})}function te(y,P,M,U){y.info(function(){return"XMLHTTP TEXT ("+P+"): "+q(y,M)+(U?" "+U:"")})}function me(y,P){y.info(function(){return"TIMEOUT: "+P})}Oe.prototype.info=function(){};function q(y,P){if(!y.g)return P;if(!P)return null;try{var M=JSON.parse(P);if(M){for(y=0;y<M.length;y++)if(Array.isArray(M[y])){var U=M[y];if(!(2>U.length)){var fe=U[1];if(Array.isArray(fe)&&!(1>fe.length)){var ke=fe[0];if(ke!="noop"&&ke!="stop"&&ke!="close")for(var ot=1;ot<fe.length;ot++)fe[ot]=""}}}}return _e(M)}catch{return P}}var ne={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},be={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Ne;function Ge(){}g(Ge,Tt),Ge.prototype.g=function(){return new XMLHttpRequest},Ge.prototype.i=function(){return{}},Ne=new Ge;function Se(y,P,M,U){this.j=y,this.i=P,this.l=M,this.R=U||1,this.U=new Ve(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new it}function it(){this.i=null,this.g="",this.h=!1}var st={},Mt={};function xn(y,P,M){y.L=1,y.v=mt(Ee(P)),y.m=M,y.P=!0,Zr(y,null)}function Zr(y,P){y.F=Date.now(),bs(y),y.A=Ee(y.v);var M=y.A,U=y.R;Array.isArray(U)||(U=[String(U)]),as(M.i,"t",U),y.C=0,M=y.j.J,y.h=new it,y.g=bk(y.j,M?P:null,!y.m),0<y.O&&(y.M=new Ae(f(y.Y,y,y.g),y.O)),P=y.U,M=y.g,U=y.ca;var fe="readystatechange";Array.isArray(fe)||(fe&&(qe[0]=fe.toString()),fe=qe);for(var ke=0;ke<fe.length;ke++){var ot=Me(M,fe[ke],U||P.handleEvent,!1,P.h||P);if(!ot)break;P.g[ot.key]=ot}P=y.H?I(y.H):{},y.m?(y.u||(y.u="POST"),P["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,P)):(y.u="GET",y.g.ea(y.A,y.u,null,P)),tn(),tt(y.i,y.u,y.A,y.l,y.R,y.m)}Se.prototype.ca=function(y){y=y.target;const P=this.M;P&&Aa(y)==3?P.j():this.Y(y)},Se.prototype.Y=function(y){try{if(y==this.g)e:{const Ss=Aa(this.g);var P=this.g.Ba();const bd=this.g.Z();if(!(3>Ss)&&(Ss!=3||this.g&&(this.h.h||this.g.oa()||uk(this.g)))){this.J||Ss!=4||P==7||(P==8||0>=bd?tn(3):tn(2)),Vs(this);var M=this.g.Z();this.X=M;t:if(Dn(this)){var U=uk(this.g);y="";var fe=U.length,ke=Aa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){es(this),$s(this);var ot="";break t}this.h.i=new l.TextDecoder}for(P=0;P<fe;P++)this.h.h=!0,y+=this.h.i.decode(U[P],{stream:!(ke&&P==fe-1)});U.length=0,this.h.g+=y,this.C=0,ot=this.h.g}else ot=this.g.oa();if(this.o=M==200,J(this.i,this.u,this.A,this.l,this.R,Ss,M),this.o){if(this.T&&!this.K){t:{if(this.g){var Un,ls=this.g;if((Un=ls.g?ls.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(Un)){var vn=Un;break t}}vn=null}if(M=vn)te(this.i,this.l,M,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,nn(this,M);else{this.o=!1,this.s=3,Y(12),es(this),$s(this);break e}}if(this.P){M=!0;let vo;for(;!this.J&&this.C<ot.length;)if(vo=Gr(this,ot),vo==Mt){Ss==4&&(this.s=4,Y(14),M=!1),te(this.i,this.l,null,"[Incomplete Response]");break}else if(vo==st){this.s=4,Y(15),te(this.i,this.l,ot,"[Invalid Chunk]"),M=!1;break}else te(this.i,this.l,vo,null),nn(this,vo);if(Dn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ss!=4||ot.length!=0||this.h.h||(this.s=1,Y(16),M=!1),this.o=this.o&&M,!M)te(this.i,this.l,ot,"[Invalid Chunked Response]"),es(this),$s(this);else if(0<ot.length&&!this.W){this.W=!0;var _s=this.j;_s.g==this&&_s.ba&&!_s.M&&(_s.j.info("Great, no buffering proxy detected. Bytes received: "+ot.length),f_(_s),_s.M=!0,Y(11))}}else te(this.i,this.l,ot,null),nn(this,ot);Ss==4&&es(this),this.o&&!this.J&&(Ss==4?yk(this.j,this):(this.o=!1,bs(this)))}else Rq(this.g),M==400&&0<ot.indexOf("Unknown SID")?(this.s=3,Y(12)):(this.s=0,Y(13)),es(this),$s(this)}}}catch{}finally{}};function Dn(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function Gr(y,P){var M=y.C,U=P.indexOf(`
`,M);return U==-1?Mt:(M=Number(P.substring(M,U)),isNaN(M)?st:(U+=1,U+M>P.length?Mt:(P=P.slice(U,U+M),y.C=U+M,P)))}Se.prototype.cancel=function(){this.J=!0,es(this)};function bs(y){y.S=Date.now()+y.I,Si(y,y.I)}function Si(y,P){if(y.B!=null)throw Error("WatchDog timer not null");y.B=ge(f(y.ba,y),P)}function Vs(y){y.B&&(l.clearTimeout(y.B),y.B=null)}Se.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(me(this.i,this.A),this.L!=2&&(tn(),Y(17)),es(this),this.s=2,$s(this)):Si(this,this.S-y)};function $s(y){y.j.G==0||y.J||yk(y.j,y)}function es(y){Vs(y);var P=y.M;P&&typeof P.ma=="function"&&P.ma(),y.M=null,oe(y.U),y.g&&(P=y.g,y.g=null,P.abort(),P.ma())}function nn(y,P){try{var M=y.j;if(M.G!=0&&(M.g==y||Us(M.h,y))){if(!y.K&&Us(M.h,y)&&M.G==3){try{var U=M.Da.g.parse(P)}catch{U=null}if(Array.isArray(U)&&U.length==3){var fe=U;if(fe[0]==0){e:if(!M.u){if(M.g)if(M.g.F+3e3<y.F)fy(M),dy(M);else break e;h_(M),Y(18)}}else M.za=fe[1],0<M.za-M.T&&37500>fe[2]&&M.F&&M.v==0&&!M.C&&(M.C=ge(f(M.Za,M),6e3));if(1>=Mn(M.h)&&M.ca){try{M.ca()}catch{}M.ca=void 0}}else Qc(M,11)}else if((y.K||M.g==y)&&fy(M),!_(P))for(fe=M.Da.g.parse(P),P=0;P<fe.length;P++){let vn=fe[P];if(M.T=vn[0],vn=vn[1],M.G==2)if(vn[0]=="c"){M.K=vn[1],M.ia=vn[2];const _s=vn[3];_s!=null&&(M.la=_s,M.j.info("VER="+M.la));const Ss=vn[4];Ss!=null&&(M.Aa=Ss,M.j.info("SVER="+M.Aa));const bd=vn[5];bd!=null&&typeof bd=="number"&&0<bd&&(U=1.5*bd,M.L=U,M.j.info("backChannelRequestTimeoutMs_="+U)),U=M;const vo=y.g;if(vo){const py=vo.g?vo.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(py){var ke=U.h;ke.g||py.indexOf("spdy")==-1&&py.indexOf("quic")==-1&&py.indexOf("h2")==-1||(ke.j=ke.l,ke.g=new Set,ke.h&&(xo(ke,ke.h),ke.h=null))}if(U.D){const m_=vo.g?vo.g.getResponseHeader("X-HTTP-Session-Id"):null;m_&&(U.ya=m_,je(U.I,U.D,m_))}}M.G=3,M.l&&M.l.ua(),M.ba&&(M.R=Date.now()-y.F,M.j.info("Handshake RTT: "+M.R+"ms")),U=M;var ot=y;if(U.qa=wk(U,U.J?U.ia:null,U.W),ot.K){Ho(U.h,ot);var Un=ot,ls=U.L;ls&&(Un.I=ls),Un.B&&(Vs(Un),bs(Un)),U.g=ot}else pk(U);0<M.i.length&&hy(M)}else vn[0]!="stop"&&vn[0]!="close"||Qc(M,7);else M.G==3&&(vn[0]=="stop"||vn[0]=="close"?vn[0]=="stop"?Qc(M,7):d_(M):vn[0]!="noop"&&M.l&&M.l.ta(vn),M.v=0)}}tn(4)}catch{}}var Cn=class{constructor(y,P){this.g=y,this.map=P}};function ni(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function ri(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Mn(y){return y.h?1:y.g?y.g.size:0}function Us(y,P){return y.h?y.h==P:y.g?y.g.has(P):!1}function xo(y,P){y.g?y.g.add(P):y.h=P}function Ho(y,P){y.h&&y.h==P?y.h=null:y.g&&y.g.has(P)&&y.g.delete(P)}ni.prototype.cancel=function(){if(this.i=Jc(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function Jc(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let P=y.i;for(const M of y.g.values())P=P.concat(M.D);return P}return x(y.i)}function cy(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(c(y)){for(var P=[],M=y.length,U=0;U<M;U++)P.push(y[U]);return P}P=[],M=0;for(U in y)P[M++]=y[U];return P}function Na(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(c(y)||typeof y=="string"){var P=[];y=y.length;for(var M=0;M<y;M++)P.push(M);return P}P=[],M=0;for(const U in y)P[M++]=U;return P}}}function xe(y,P){if(y.forEach&&typeof y.forEach=="function")y.forEach(P,void 0);else if(c(y)||typeof y=="string")Array.prototype.forEach.call(y,P,void 0);else for(var M=Na(y),U=cy(y),fe=U.length,ke=0;ke<fe;ke++)P.call(void 0,U[ke],M&&M[ke],y)}var pe=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function we(y,P){if(y){y=y.split("&");for(var M=0;M<y.length;M++){var U=y[M].indexOf("="),fe=null;if(0<=U){var ke=y[M].substring(0,U);fe=y[M].substring(U+1)}else ke=y[M];P(ke,fe?decodeURIComponent(fe.replace(/\+/g," ")):"")}}}function se(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof se){this.h=y.h,We(this,y.j),this.o=y.o,this.g=y.g,nt(this,y.s),this.l=y.l;var P=y.i,M=new xr;M.i=P.i,P.g&&(M.g=new Map(P.g),M.h=P.h),Ye(this,M),this.m=y.m}else y&&(P=String(y).match(pe))?(this.h=!1,We(this,P[1]||"",!0),this.o=jt(P[2]||""),this.g=jt(P[3]||"",!0),nt(this,P[4]),this.l=jt(P[5]||"",!0),Ye(this,P[6]||"",!0),this.m=jt(P[7]||"")):(this.h=!1,this.i=new xr(null,this.h))}se.prototype.toString=function(){var y=[],P=this.j;P&&y.push(Dt(P,St,!0),":");var M=this.g;return(M||P=="file")&&(y.push("//"),(P=this.o)&&y.push(Dt(P,St,!0),"@"),y.push(encodeURIComponent(String(M)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),M=this.s,M!=null&&y.push(":",String(M))),(M=this.l)&&(this.g&&M.charAt(0)!="/"&&y.push("/"),y.push(Dt(M,M.charAt(0)=="/"?Lt:Jt,!0))),(M=this.i.toString())&&y.push("?",M),(M=this.m)&&y.push("#",Dt(M,er)),y.join("")};function Ee(y){return new se(y)}function We(y,P,M){y.j=M?jt(P,!0):P,y.j&&(y.j=y.j.replace(/:$/,""))}function nt(y,P){if(P){if(P=Number(P),isNaN(P)||0>P)throw Error("Bad port number "+P);y.s=P}else y.s=null}function Ye(y,P,M){P instanceof xr?(y.i=P,wr(y.i,y.h)):(M||(P=Dt(P,$n)),y.i=new xr(P,y.h))}function je(y,P,M){y.i.set(P,M)}function mt(y){return je(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function jt(y,P){return y?P?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function Dt(y,P,M){return typeof y=="string"?(y=encodeURI(y).replace(P,Nn),M&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function Nn(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var St=/[#\/\?@]/g,Jt=/[#\?:]/g,Lt=/[#\?]/g,$n=/[#\?@]/g,er=/#/g;function xr(y,P){this.h=this.g=null,this.i=y||null,this.j=!!P}function ur(y){y.g||(y.g=new Map,y.h=0,y.i&&we(y.i,function(P,M){y.add(decodeURIComponent(P.replace(/\+/g," ")),M)}))}t=xr.prototype,t.add=function(y,P){ur(this),this.i=null,y=Ci(this,y);var M=this.g.get(y);return M||this.g.set(y,M=[]),M.push(P),this.h+=1,this};function Ct(y,P){ur(y),P=Ci(y,P),y.g.has(P)&&(y.i=null,y.h-=y.g.get(P).length,y.g.delete(P))}function vr(y,P){return ur(y),P=Ci(y,P),y.g.has(P)}t.forEach=function(y,P){ur(this),this.g.forEach(function(M,U){M.forEach(function(fe){y.call(P,fe,U,this)},this)},this)},t.na=function(){ur(this);const y=Array.from(this.g.values()),P=Array.from(this.g.keys()),M=[];for(let U=0;U<P.length;U++){const fe=y[U];for(let ke=0;ke<fe.length;ke++)M.push(P[U])}return M},t.V=function(y){ur(this);let P=[];if(typeof y=="string")vr(this,y)&&(P=P.concat(this.g.get(Ci(this,y))));else{y=Array.from(this.g.values());for(let M=0;M<y.length;M++)P=P.concat(y[M])}return P},t.set=function(y,P){return ur(this),this.i=null,y=Ci(this,y),vr(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[P]),this.h+=1,this},t.get=function(y,P){return y?(y=this.V(y),0<y.length?String(y[0]):P):P};function as(y,P,M){Ct(y,P),0<M.length&&(y.i=null,y.g.set(Ci(y,P),x(M)),y.h+=M.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],P=Array.from(this.g.keys());for(var M=0;M<P.length;M++){var U=P[M];const ke=encodeURIComponent(String(U)),ot=this.V(U);for(U=0;U<ot.length;U++){var fe=ke;ot[U]!==""&&(fe+="="+encodeURIComponent(String(ot[U]))),y.push(fe)}}return this.i=y.join("&")};function Ci(y,P){return P=String(P),y.j&&(P=P.toLowerCase()),P}function wr(y,P){P&&!y.j&&(ur(y),y.i=null,y.g.forEach(function(M,U){var fe=U.toLowerCase();U!=fe&&(Ct(this,U),as(this,fe,M))},y)),y.j=P}function qn(y,P){const M=new Oe;if(l.Image){const U=new Image;U.onload=m(ts,M,"TestLoadImage: loaded",!0,P,U),U.onerror=m(ts,M,"TestLoadImage: error",!1,P,U),U.onabort=m(ts,M,"TestLoadImage: abort",!1,P,U),U.ontimeout=m(ts,M,"TestLoadImage: timeout",!1,P,U),l.setTimeout(function(){U.ontimeout&&U.ontimeout()},1e4),U.src=y}else P(!1)}function br(y,P){const M=new Oe,U=new AbortController,fe=setTimeout(()=>{U.abort(),ts(M,"TestPingServer: timeout",!1,P)},1e4);fetch(y,{signal:U.signal}).then(ke=>{clearTimeout(fe),ke.ok?ts(M,"TestPingServer: ok",!0,P):ts(M,"TestPingServer: server error",!1,P)}).catch(()=>{clearTimeout(fe),ts(M,"TestPingServer: error",!1,P)})}function ts(y,P,M,U,fe){try{fe&&(fe.onload=null,fe.onerror=null,fe.onabort=null,fe.ontimeout=null),U(M)}catch{}}function qo(){this.g=new Te}function Pa(y,P,M){const U=M||"";try{xe(y,function(fe,ke){let ot=fe;u(fe)&&(ot=_e(fe)),P.push(U+ke+"="+encodeURIComponent(ot))})}catch(fe){throw P.push(U+"type="+encodeURIComponent("_badmap")),fe}}function si(y){this.l=y.Ub||null,this.j=y.eb||!1}g(si,Tt),si.prototype.g=function(){return new Xc(this.l,this.j)},si.prototype.i=function(y){return function(){return y}}({});function Xc(y,P){De.call(this),this.D=y,this.o=P,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Xc,De),t=Xc.prototype,t.open=function(y,P){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=P,this.readyState=1,Mf(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const P={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(P.body=y),(this.D||l).fetch(new Request(this.A,P)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Df(this)),this.readyState=0},t.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,Mf(this)),this.g&&(this.readyState=3,Mf(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;sk(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function sk(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}t.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var P=y.value?y.value:new Uint8Array(0);(P=this.v.decode(P,{stream:!y.done}))&&(this.response=this.responseText+=P)}y.done?Df(this):Mf(this),this.readyState==3&&sk(this)}},t.Ra=function(y){this.g&&(this.response=this.responseText=y,Df(this))},t.Qa=function(y){this.g&&(this.response=y,Df(this))},t.ga=function(){this.g&&Df(this)};function Df(y){y.readyState=4,y.l=null,y.j=null,y.v=null,Mf(y)}t.setRequestHeader=function(y,P){this.u.append(y,P)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],P=this.h.entries();for(var M=P.next();!M.done;)M=M.value,y.push(M[0]+": "+M[1]),M=P.next();return y.join(`\r
`)};function Mf(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Xc.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function ik(y){let P="";return A(y,function(M,U){P+=U,P+=":",P+=M,P+=`\r
`}),P}function u_(y,P,M){e:{for(U in M){var U=!1;break e}U=!0}U||(M=ik(M),typeof y=="string"?M!=null&&encodeURIComponent(String(M)):je(y,P,M))}function _r(y){De.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(_r,De);var Aq=/^https?$/i,kq=["POST","PUT"];t=_r.prototype,t.Ha=function(y){this.J=y},t.ea=function(y,P,M,U){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);P=P?P.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Ne.g(),this.v=this.o?wt(this.o):wt(Ne),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(P,String(y),!0),this.B=!1}catch(ke){ok(this,ke);return}if(y=M||"",M=new Map(this.headers),U)if(Object.getPrototypeOf(U)===Object.prototype)for(var fe in U)M.set(fe,U[fe]);else if(typeof U.keys=="function"&&typeof U.get=="function")for(const ke of U.keys())M.set(ke,U.get(ke));else throw Error("Unknown input type for opt_headers: "+String(U));U=Array.from(M.keys()).find(ke=>ke.toLowerCase()=="content-type"),fe=l.FormData&&y instanceof l.FormData,!(0<=Array.prototype.indexOf.call(kq,P,void 0))||U||fe||M.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[ke,ot]of M)this.g.setRequestHeader(ke,ot);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{ck(this),this.u=!0,this.g.send(y),this.u=!1}catch(ke){ok(this,ke)}};function ok(y,P){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=P,y.m=5,ak(y),uy(y)}function ak(y){y.A||(y.A=!0,ee(y,"complete"),ee(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,ee(this,"complete"),ee(this,"abort"),uy(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),uy(this,!0)),_r.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?lk(this):this.bb())},t.bb=function(){lk(this)};function lk(y){if(y.h&&typeof o<"u"&&(!y.v[1]||Aa(y)!=4||y.Z()!=2)){if(y.u&&Aa(y)==4)Q(y.Ea,0,y);else if(ee(y,"readystatechange"),Aa(y)==4){y.h=!1;try{const ot=y.Z();e:switch(ot){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var P=!0;break e;default:P=!1}var M;if(!(M=P)){var U;if(U=ot===0){var fe=String(y.D).match(pe)[1]||null;!fe&&l.self&&l.self.location&&(fe=l.self.location.protocol.slice(0,-1)),U=!Aq.test(fe?fe.toLowerCase():"")}M=U}if(M)ee(y,"complete"),ee(y,"success");else{y.m=6;try{var ke=2<Aa(y)?y.g.statusText:""}catch{ke=""}y.l=ke+" ["+y.Z()+"]",ak(y)}}finally{uy(y)}}}}function uy(y,P){if(y.g){ck(y);const M=y.g,U=y.v[0]?()=>{}:null;y.g=null,y.v=null,P||ee(y,"ready");try{M.onreadystatechange=U}catch{}}}function ck(y){y.I&&(l.clearTimeout(y.I),y.I=null)}t.isActive=function(){return!!this.g};function Aa(y){return y.g?y.g.readyState:0}t.Z=function(){try{return 2<Aa(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(y){if(this.g){var P=this.g.responseText;return y&&P.indexOf(y)==0&&(P=P.substring(y.length)),ze(P)}};function uk(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function Rq(y){const P={};y=(y.g&&2<=Aa(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let U=0;U<y.length;U++){if(_(y[U]))continue;var M=j(y[U]);const fe=M[0];if(M=M[1],typeof M!="string")continue;M=M.trim();const ke=P[fe]||[];P[fe]=ke,ke.push(M)}E(P,function(U){return U.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Lf(y,P,M){return M&&M.internalChannelParams&&M.internalChannelParams[y]||P}function dk(y){this.Aa=0,this.i=[],this.j=new Oe,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Lf("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Lf("baseRetryDelayMs",5e3,y),this.cb=Lf("retryDelaySeedMs",1e4,y),this.Wa=Lf("forwardChannelMaxRetries",2,y),this.wa=Lf("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new ni(y&&y.concurrentRequestLimit),this.Da=new qo,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=dk.prototype,t.la=8,t.G=1,t.connect=function(y,P,M,U){Y(0),this.W=y,this.H=P||{},M&&U!==void 0&&(this.H.OSID=M,this.H.OAID=U),this.F=this.X,this.I=wk(this,null,this.W),hy(this)};function d_(y){if(hk(y),y.G==3){var P=y.U++,M=Ee(y.I);if(je(M,"SID",y.K),je(M,"RID",P),je(M,"TYPE","terminate"),Ff(y,M),P=new Se(y,y.j,P),P.L=2,P.v=mt(Ee(M)),M=!1,l.navigator&&l.navigator.sendBeacon)try{M=l.navigator.sendBeacon(P.v.toString(),"")}catch{}!M&&l.Image&&(new Image().src=P.v,M=!0),M||(P.g=bk(P.j,null),P.g.ea(P.v)),P.F=Date.now(),bs(P)}vk(y)}function dy(y){y.g&&(f_(y),y.g.cancel(),y.g=null)}function hk(y){dy(y),y.u&&(l.clearTimeout(y.u),y.u=null),fy(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&l.clearTimeout(y.s),y.s=null)}function hy(y){if(!ri(y.h)&&!y.s){y.s=!0;var P=y.Ga;X||V(),H||(X(),H=!0),K.add(P,y),y.B=0}}function jq(y,P){return Mn(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=P.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=ge(f(y.Ga,y,P),xk(y,y.B)),y.B++,!0)}t.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const fe=new Se(this,this.j,y);let ke=this.o;if(this.S&&(ke?(ke=I(ke),k(ke,this.S)):ke=this.S),this.m!==null||this.O||(fe.H=ke,ke=null),this.P)e:{for(var P=0,M=0;M<this.i.length;M++){t:{var U=this.i[M];if("__data__"in U.map&&(U=U.map.__data__,typeof U=="string")){U=U.length;break t}U=void 0}if(U===void 0)break;if(P+=U,4096<P){P=M;break e}if(P===4096||M===this.i.length-1){P=M+1;break e}}P=1e3}else P=1e3;P=mk(this,fe,P),M=Ee(this.I),je(M,"RID",y),je(M,"CVER",22),this.D&&je(M,"X-HTTP-Session-Id",this.D),Ff(this,M),ke&&(this.O?P="headers="+encodeURIComponent(String(ik(ke)))+"&"+P:this.m&&u_(M,this.m,ke)),xo(this.h,fe),this.Ua&&je(M,"TYPE","init"),this.P?(je(M,"$req",P),je(M,"SID","null"),fe.T=!0,xn(fe,M,null)):xn(fe,M,P),this.G=2}}else this.G==3&&(y?fk(this,y):this.i.length==0||ri(this.h)||fk(this))};function fk(y,P){var M;P?M=P.l:M=y.U++;const U=Ee(y.I);je(U,"SID",y.K),je(U,"RID",M),je(U,"AID",y.T),Ff(y,U),y.m&&y.o&&u_(U,y.m,y.o),M=new Se(y,y.j,M,y.B+1),y.m===null&&(M.H=y.o),P&&(y.i=P.D.concat(y.i)),P=mk(y,M,1e3),M.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),xo(y.h,M),xn(M,U,P)}function Ff(y,P){y.H&&A(y.H,function(M,U){je(P,U,M)}),y.l&&xe({},function(M,U){je(P,U,M)})}function mk(y,P,M){M=Math.min(y.i.length,M);var U=y.l?f(y.l.Na,y.l,y):null;e:{var fe=y.i;let ke=-1;for(;;){const ot=["count="+M];ke==-1?0<M?(ke=fe[0].g,ot.push("ofs="+ke)):ke=0:ot.push("ofs="+ke);let Un=!0;for(let ls=0;ls<M;ls++){let vn=fe[ls].g;const _s=fe[ls].map;if(vn-=ke,0>vn)ke=Math.max(0,fe[ls].g-100),Un=!1;else try{Pa(_s,ot,"req"+vn+"_")}catch{U&&U(_s)}}if(Un){U=ot.join("&");break e}}}return y=y.i.splice(0,M),P.D=y,U}function pk(y){if(!y.g&&!y.u){y.Y=1;var P=y.Fa;X||V(),H||(X(),H=!0),K.add(P,y),y.v=0}}function h_(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=ge(f(y.Fa,y),xk(y,y.v)),y.v++,!0)}t.Fa=function(){if(this.u=null,gk(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=ge(f(this.ab,this),y)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Y(10),dy(this),gk(this))};function f_(y){y.A!=null&&(l.clearTimeout(y.A),y.A=null)}function gk(y){y.g=new Se(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var P=Ee(y.qa);je(P,"RID","rpc"),je(P,"SID",y.K),je(P,"AID",y.T),je(P,"CI",y.F?"0":"1"),!y.F&&y.ja&&je(P,"TO",y.ja),je(P,"TYPE","xmlhttp"),Ff(y,P),y.m&&y.o&&u_(P,y.m,y.o),y.L&&(y.g.I=y.L);var M=y.g;y=y.ia,M.L=1,M.v=mt(Ee(P)),M.m=null,M.P=!0,Zr(M,y)}t.Za=function(){this.C!=null&&(this.C=null,dy(this),h_(this),Y(19))};function fy(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function yk(y,P){var M=null;if(y.g==P){fy(y),f_(y),y.g=null;var U=2}else if(Us(y.h,P))M=P.D,Ho(y.h,P),U=1;else return;if(y.G!=0){if(P.o)if(U==1){M=P.m?P.m.length:0,P=Date.now()-P.F;var fe=y.B;U=sn(),ee(U,new re(U,M)),hy(y)}else pk(y);else if(fe=P.s,fe==3||fe==0&&0<P.X||!(U==1&&jq(y,P)||U==2&&h_(y)))switch(M&&0<M.length&&(P=y.h,P.i=P.i.concat(M)),fe){case 1:Qc(y,5);break;case 4:Qc(y,10);break;case 3:Qc(y,6);break;default:Qc(y,2)}}}function xk(y,P){let M=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(M*=2),M*P}function Qc(y,P){if(y.j.info("Error code "+P),P==2){var M=f(y.fb,y),U=y.Xa;const fe=!U;U=new se(U||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||We(U,"https"),mt(U),fe?qn(U.toString(),M):br(U.toString(),M)}else Y(2);y.G=0,y.l&&y.l.sa(P),vk(y),hk(y)}t.fb=function(y){y?(this.j.info("Successfully pinged google.com"),Y(2)):(this.j.info("Failed to ping google.com"),Y(1))};function vk(y){if(y.G=0,y.ka=[],y.l){const P=Jc(y.h);(P.length!=0||y.i.length!=0)&&(v(y.ka,P),v(y.ka,y.i),y.h.i.length=0,x(y.i),y.i.length=0),y.l.ra()}}function wk(y,P,M){var U=M instanceof se?Ee(M):new se(M);if(U.g!="")P&&(U.g=P+"."+U.g),nt(U,U.s);else{var fe=l.location;U=fe.protocol,P=P?P+"."+fe.hostname:fe.hostname,fe=+fe.port;var ke=new se(null);U&&We(ke,U),P&&(ke.g=P),fe&&nt(ke,fe),M&&(ke.l=M),U=ke}return M=y.D,P=y.ya,M&&P&&je(U,M,P),je(U,"VER",y.la),Ff(y,U),U}function bk(y,P,M){if(P&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return P=y.Ca&&!y.pa?new _r(new si({eb:M})):new _r(y.pa),P.Ha(y.J),P}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function _k(){}t=_k.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function my(){}my.prototype.g=function(y,P){return new Ei(y,P)};function Ei(y,P){De.call(this),this.g=new dk(P),this.l=y,this.h=P&&P.messageUrlParams||null,y=P&&P.messageHeaders||null,P&&P.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=P&&P.initMessageHeaders||null,P&&P.messageContentType&&(y?y["X-WebChannel-Content-Type"]=P.messageContentType:y={"X-WebChannel-Content-Type":P.messageContentType}),P&&P.va&&(y?y["X-WebChannel-Client-Profile"]=P.va:y={"X-WebChannel-Client-Profile":P.va}),this.g.S=y,(y=P&&P.Sb)&&!_(y)&&(this.g.m=y),this.v=P&&P.supportsCrossDomainXhr||!1,this.u=P&&P.sendRawJson||!1,(P=P&&P.httpSessionIdParam)&&!_(P)&&(this.g.D=P,y=this.h,y!==null&&P in y&&(y=this.h,P in y&&delete y[P])),this.j=new wd(this)}g(Ei,De),Ei.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Ei.prototype.close=function(){d_(this.g)},Ei.prototype.o=function(y){var P=this.g;if(typeof y=="string"){var M={};M.__data__=y,y=M}else this.u&&(M={},M.__data__=_e(y),y=M);P.i.push(new Cn(P.Ya++,y)),P.G==3&&hy(P)},Ei.prototype.N=function(){this.g.l=null,delete this.j,d_(this.g),delete this.g,Ei.aa.N.call(this)};function Sk(y){Nt.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var P=y.__sm__;if(P){e:{for(const M in P){y=M;break e}y=void 0}(this.i=y)&&(y=this.i,P=P!==null&&y in P?P[y]:void 0),this.data=P}else this.data=y}g(Sk,Nt);function Ck(){jn.call(this),this.status=1}g(Ck,jn);function wd(y){this.g=y}g(wd,_k),wd.prototype.ua=function(){ee(this.g,"a")},wd.prototype.ta=function(y){ee(this.g,new Sk(y))},wd.prototype.sa=function(y){ee(this.g,new Ck)},wd.prototype.ra=function(){ee(this.g,"b")},my.prototype.createWebChannel=my.prototype.g,Ei.prototype.send=Ei.prototype.o,Ei.prototype.open=Ei.prototype.m,Ei.prototype.close=Ei.prototype.close,Yz=function(){return new my},Kz=function(){return sn()},qz=Sn,mT={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},ne.NO_ERROR=0,ne.TIMEOUT=8,ne.HTTP_ERROR=6,nv=ne,be.COMPLETE="complete",Hz=be,xt.EventType=pt,pt.OPEN="a",pt.CLOSE="b",pt.ERROR="c",pt.MESSAGE="d",De.prototype.listen=De.prototype.K,Tm=xt,_r.prototype.listenOnce=_r.prototype.L,_r.prototype.getLastError=_r.prototype.Ka,_r.prototype.getLastErrorCode=_r.prototype.Ba,_r.prototype.getStatus=_r.prototype.Z,_r.prototype.getResponseJson=_r.prototype.Oa,_r.prototype.getResponseText=_r.prototype.oa,_r.prototype.send=_r.prototype.ea,_r.prototype.setWithCredentials=_r.prototype.Ha,Wz=_r}).apply(typeof ox<"u"?ox:typeof self<"u"?self:typeof window<"u"?window:{});const $M="@firebase/firestore",UM="4.7.16";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}fs.UNAUTHENTICATED=new fs(null),fs.GOOGLE_CREDENTIALS=new fs("google-credentials-uid"),fs.FIRST_PARTY=new fs("first-party-uid"),fs.MOCK_USER=new fs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Tf="11.8.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ju=new eP("@firebase/firestore");function zd(){return Ju.logLevel}function Qe(t,...e){if(Ju.logLevel<=dn.DEBUG){const n=e.map(hP);Ju.debug(`Firestore (${Tf}): ${t}`,...n)}}function Ks(t,...e){if(Ju.logLevel<=dn.ERROR){const n=e.map(hP);Ju.error(`Firestore (${Tf}): ${t}`,...n)}}function Xu(t,...e){if(Ju.logLevel<=dn.WARN){const n=e.map(hP);Ju.warn(`Firestore (${Tf}): ${t}`,...n)}}function hP(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _t(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Jz(t,r,n)}function Jz(t,e,n){let r=`FIRESTORE (${Tf}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ks(r),new Error(r)}function It(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||Jz(e,s,r)}function Xt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class lt extends Wo{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ya{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xz{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class $ye{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(fs.UNAUTHENTICATED))}shutdown(){}}class Uye{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Bye{constructor(e){this.t=e,this.currentUser=fs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){It(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new ya;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new ya,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Qe("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Qe("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new ya)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Qe("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(It(typeof r.accessToken=="string",31837,{l:r}),new Xz(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return It(e===null||typeof e=="string",2055,{h:e}),new fs(e)}}class zye{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=fs.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Gye{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new zye(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(fs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class BM{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Wye{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,qs(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){It(this.o===void 0,3512);const r=i=>{i.error!=null&&Qe("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Qe("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Qe("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Qe("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new BM(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(It(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new BM(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hye(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Qz(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zz{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Hye(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Wt(t,e){return t<e?-1:t>e?1:0}function pT(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return Wt(r,s);{const i=Qz(),o=qye(i.encode(zM(t,n)),i.encode(zM(e,n)));return o!==0?o:Wt(r,s)}}n+=r>65535?2:1}return Wt(t.length,e.length)}function zM(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function qye(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Wt(t[n],e[n]);return Wt(t.length,e.length)}function Yh(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function e9(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const GM=-62135596800,WM=1e6;class gr{static now(){return gr.fromMillis(Date.now())}static fromDate(e){return gr.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*WM);return new gr(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new lt(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new lt(Fe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<GM)throw new lt(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new lt(Fe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/WM}_compareTo(e){return this.seconds===e.seconds?Wt(this.nanoseconds,e.nanoseconds):Wt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-GM;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rt{static fromTimestamp(e){return new Rt(e)}static min(){return new Rt(new gr(0,0))}static max(){return new Rt(new gr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const HM="__name__";class na{constructor(e,n,r){n===void 0?n=0:n>e.length&&_t(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&_t(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return na.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof na?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=na.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Wt(e.length,n.length)}static compareSegments(e,n){const r=na.isNumericId(e),s=na.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?na.extractNumericId(e).compare(na.extractNumericId(n)):pT(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return dc.fromString(e.substring(4,e.length-2))}}class Tn extends na{construct(e,n,r){return new Tn(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new lt(Fe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new Tn(n)}static emptyPath(){return new Tn([])}}const Kye=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class mr extends na{construct(e,n,r){return new mr(e,n,r)}static isValidIdentifier(e){return Kye.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),mr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===HM}static keyField(){return new mr([HM])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new lt(Fe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new lt(Fe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new lt(Fe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new lt(Fe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new mr(n)}static emptyPath(){return new mr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.path=e}static fromPath(e){return new dt(Tn.fromString(e))}static fromName(e){return new dt(Tn.fromString(e).popFirst(5))}static empty(){return new dt(Tn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&Tn.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return Tn.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new dt(new Tn(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hp=-1;class Ew{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function gT(t){return t.fields.find(e=>e.kind===2)}function lu(t){return t.fields.filter(e=>e.kind!==2)}Ew.UNKNOWN_ID=-1;class rv{constructor(e,n){this.fieldPath=e,this.kind=n}}class qp{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new qp(0,qi.min())}}function Yye(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=Rt.fromTimestamp(r===1e9?new gr(n+1,0):new gr(n,r));return new qi(s,dt.empty(),e)}function t9(t){return new qi(t.readTime,t.key,Hp)}class qi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new qi(Rt.min(),dt.empty(),Hp)}static max(){return new qi(Rt.max(),dt.empty(),Hp)}}function fP(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=dt.comparator(t.documentKey,e.documentKey),n!==0?n:Wt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n9="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class r9{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function hd(t){if(t.code!==Fe.FAILED_PRECONDITION||t.message!==n9)throw t;Qe("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ye{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&_t(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ye((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ye?n:ye.resolve(n)}catch(n){return ye.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ye.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ye.reject(n)}static resolve(e){return new ye((n,r)=>{n(e)})}static reject(e){return new ye((n,r)=>{r(e)})}static waitFor(e){return new ye((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=ye.resolve(!1);for(const r of e)n=n.next(s=>s?ye.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new ye((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new ye((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ji="SimpleDb";class bb{static open(e,n,r,s){try{return new bb(n,e.transaction(s,r))}catch(i){throw new tp(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new ya,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new tp(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=mP(r.target.error);this.S.reject(new tp(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Qe(ji,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new Xye(n)}}class hc{static delete(e){return Qe(ji,"Removing database:",e),fu(XB().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!iz())return!1;if(hc.F())return!0;const e=Jr(),n=hc.M(e),r=0<n&&n<10,s=s9(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.B=r,this.L=null,hc.M(Jr())===12.2&&Ks("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Qe(ji,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new tp(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new lt(Fe.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new lt(Fe.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new tp(e,o))},s.onupgradeneeded=i=>{Qe(ji,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;if(this.L!==null&&this.L!==i.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${i.oldVersion}, event.newVersion=${i.newVersion}, db.version=${o.version}`);this.B.q(o,s.transaction,i.oldVersion,this.version).next(()=>{Qe(ji,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",n=>{const r=n.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=n=>this.$(n)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const l=bb.open(this.db,e,i?"readonly":"readwrite",r),c=s(l).next(u=>(l.v(),u)).catch(u=>(l.abort(u),ye.reject(u))).toPromise();return c.catch(()=>{}),await l.D,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Qe(ji,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function s9(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Jye{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return fu(this.K.delete())}}class tp extends lt{constructor(e,n){super(Fe.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Wc(t){return t.name==="IndexedDbTransactionError"}class Xye{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Qe(ji,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(Qe(ji,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),fu(r)}add(e){return Qe(ji,"ADD",this.store.name,e,e),fu(this.store.add(e))}get(e){return fu(this.store.get(e)).next(n=>(n===void 0&&(n=null),Qe(ji,"GET",this.store.name,e,n),n))}delete(e){return Qe(ji,"DELETE",this.store.name,e),fu(this.store.delete(e))}count(){return Qe(ji,"COUNT",this.store.name),fu(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new ye((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.Y(i,(l,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new ye((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){Qe(ji,"DELETE ALL",this.store.name);const r=this.options(e,n);r.ee=!1;const s=this.cursor(r);return this.Y(s,(i,o,l)=>l.delete())}te(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.Y(s,n)}ne(e){const n=this.cursor({});return new ye((r,s)=>{n.onerror=i=>{const o=mP(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}Y(e,n){const r=[];return new ye((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new Jye(l),u=n(l.primaryKey,l.value,c);if(u instanceof ye){const d=u.catch(h=>(c.done(),ye.reject(h)));r.push(d)}c.isDone?s():c.j===null?l.continue():l.continue(c.j)}}).next(()=>ye.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function fu(t){return new ye((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=mP(r.target.error);n(s)}})}let qM=!1;function mP(t){const e=hc.M(Jr());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new lt("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return qM||(qM=!0,setTimeout(()=>{throw r},0)),r}}return t}const np="IndexBackfiller";class Qye{constructor(e,n){this.asyncQueue=e,this.re=n,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Qe(np,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.re.se();Qe(np,`Documents written: ${n}`)}catch(n){Wc(n)?Qe(np,"Ignoring IndexedDB error during index backfill: ",n):await hd(n)}await this.ie(6e4)})}}class Zye{constructor(e,n){this.localStore=e,this.persistence=n}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.oe(n,e))}oe(e,n){const r=new Set;let s=n,i=!0;return ye.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Qe(np,`Processing collection: ${o}`),this._e(e,o,s).next(l=>{s-=l,r.add(o)});i=!1})).next(()=>n-s)}_e(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(s,i)).next(l=>(Qe(np,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>o.size)}))}ae(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=t9(i);fP(o,r)>0&&(r=o)}),new qi(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oo{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}oo.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Du=-1;function _b(t){return t==null}function Kp(t){return t===0&&1/t==-1/0}function exe(t){return typeof t=="number"&&Number.isInteger(t)&&!Kp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tw="";function js(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=KM(e)),e=txe(t.get(n),e);return KM(e)}function txe(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case Tw:n+="";break;default:n+=i}}return n}function KM(t){return t+Tw+""}function aa(t){const e=t.length;if(It(e>=2,64408,{path:t}),e===2)return It(t.charAt(0)===Tw&&t.charAt(1)==="",56145,{path:t}),Tn.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(Tw,i);switch((o<0||o>n)&&_t(50515,{path:t}),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:_t(61167,{path:t})}i=o+2}return new Tn(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cu="remoteDocuments",qg="owner",kd="owner",Yp="mutationQueues",nxe="userId",Io="mutations",YM="batchId",Nu="userMutationsIndex",JM=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sv(t,e){return[t,js(e)]}function i9(t,e,n){return[t,js(e),n]}const rxe={},Jh="documentMutations",Iw="remoteDocumentsV14",sxe=["prefixPath","collectionGroup","readTime","documentId"],iv="documentKeyIndex",ixe=["prefixPath","collectionGroup","documentId"],o9="collectionGroupIndex",oxe=["collectionGroup","readTime","prefixPath","documentId"],Jp="remoteDocumentGlobal",yT="remoteDocumentGlobalKey",Xh="targets",a9="queryTargetsIndex",axe=["canonicalId","targetId"],Qh="targetDocuments",lxe=["targetId","path"],pP="documentTargetsIndex",cxe=["path","targetId"],Nw="targetGlobalKey",Mu="targetGlobal",Xp="collectionParents",uxe=["collectionId","parent"],Zh="clientMetadata",dxe="clientId",Sb="bundles",hxe="bundleId",Cb="namedQueries",fxe="name",gP="indexConfiguration",mxe="indexId",xT="collectionGroupIndex",pxe="collectionGroup",rp="indexState",gxe=["indexId","uid"],l9="sequenceNumberIndex",yxe=["uid","sequenceNumber"],sp="indexEntries",xxe=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],c9="documentKeyIndex",vxe=["indexId","uid","orderedDocumentKey"],Eb="documentOverlays",wxe=["userId","collectionPath","documentId"],vT="collectionPathOverlayIndex",bxe=["userId","collectionPath","largestBatchId"],u9="collectionGroupOverlayIndex",_xe=["userId","collectionGroup","largestBatchId"],yP="globals",Sxe="name",d9=[Yp,Io,Jh,cu,Xh,qg,Mu,Qh,Zh,Jp,Xp,Sb,Cb],Cxe=[...d9,Eb],h9=[Yp,Io,Jh,Iw,Xh,qg,Mu,Qh,Zh,Jp,Xp,Sb,Cb,Eb],f9=h9,xP=[...f9,gP,rp,sp],Exe=xP,m9=[...xP,yP],Txe=m9;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wT extends r9{constructor(e,n){super(),this.he=e,this.currentSequenceNumber=n}}function Qr(t,e){const n=Xt(t);return hc.N(n.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XM(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Hc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function p9(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lr{constructor(e,n){this.comparator=e,this.root=n||ms.EMPTY}insert(e,n){return new lr(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ms.BLACK,null,null))}remove(e){return new lr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ms.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new ax(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new ax(this.root,e,this.comparator,!1)}getReverseIterator(){return new ax(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new ax(this.root,e,this.comparator,!0)}}class ax{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ms{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ms.RED,this.left=s??ms.EMPTY,this.right=i??ms.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ms(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ms.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ms.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ms.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ms.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw _t(43730,{key:this.key,value:this.value});if(this.right.isRed())throw _t(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw _t(27949);return e+(this.isRed()?0:1)}}ms.EMPTY=null,ms.RED=!0,ms.BLACK=!1;ms.EMPTY=new class{constructor(){this.size=0}get key(){throw _t(57766)}get value(){throw _t(16141)}get color(){throw _t(16727)}get left(){throw _t(29726)}get right(){throw _t(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new ms(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rn{constructor(e){this.comparator=e,this.data=new lr(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new QM(this.data.getIterator())}getIteratorFrom(e){return new QM(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Rn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Rn(this.comparator);return n.data=e,n}}class QM{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Rd(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class di{constructor(e){this.fields=e,e.sort(mr.comparator)}static empty(){return new di([])}unionWith(e){let n=new Rn(mr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new di(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Yh(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class g9 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new g9("Invalid base64 string: "+i):i}}(e);return new zr(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new zr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Wt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}zr.EMPTY_BYTE_STRING=new zr("");const Ixe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function al(t){if(It(!!t,39018),typeof t=="string"){let e=0;const n=Ixe.exec(t);if(It(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:sr(t.seconds),nanos:sr(t.nanos)}}function sr(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function ll(t){return typeof t=="string"?zr.fromBase64String(t):zr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y9="server_timestamp",x9="__type__",v9="__previous_value__",w9="__local_write_time__";function vP(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[x9])===null||n===void 0?void 0:n.stringValue)===y9}function Tb(t){const e=t.mapValue.fields[v9];return vP(e)?Tb(e):e}function Qp(t){const e=al(t.mapValue.fields[w9].timestampValue);return new gr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nxe{constructor(e,n,r,s,i,o,l,c,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d}}const Pw="(default)";class Qu{constructor(e,n){this.projectId=e,this.database=n||Pw}static empty(){return new Qu("","")}get isDefaultDatabase(){return this.database===Pw}isEqual(e){return e instanceof Qu&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wP="__type__",b9="__max__",Jl={mapValue:{fields:{__type__:{stringValue:b9}}}},bP="__vector__",ef="value",ov={nullValue:"NULL_VALUE"};function Cc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?vP(t)?4:_9(t)?9007199254740991:Ib(t)?10:11:_t(28295,{value:t})}function ba(t,e){if(t===e)return!0;const n=Cc(t);if(n!==Cc(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Qp(t).isEqual(Qp(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=al(s.timestampValue),l=al(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return ll(s.bytesValue).isEqual(ll(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return sr(s.geoPointValue.latitude)===sr(i.geoPointValue.latitude)&&sr(s.geoPointValue.longitude)===sr(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return sr(s.integerValue)===sr(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=sr(s.doubleValue),l=sr(i.doubleValue);return o===l?Kp(o)===Kp(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return Yh(t.arrayValue.values||[],e.arrayValue.values||[],ba);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(XM(o)!==XM(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!ba(o[c],l[c])))return!1;return!0}(t,e);default:return _t(52216,{left:t})}}function Zp(t,e){return(t.values||[]).find(n=>ba(n,e))!==void 0}function Ec(t,e){if(t===e)return 0;const n=Cc(t),r=Cc(e);if(n!==r)return Wt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Wt(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=sr(i.integerValue||i.doubleValue),c=sr(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return ZM(t.timestampValue,e.timestampValue);case 4:return ZM(Qp(t),Qp(e));case 5:return pT(t.stringValue,e.stringValue);case 6:return function(i,o){const l=ll(i),c=ll(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Wt(l[u],c[u]);if(d!==0)return d}return Wt(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Wt(sr(i.latitude),sr(o.latitude));return l!==0?l:Wt(sr(i.longitude),sr(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return e4(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const h=i.fields||{},f=o.fields||{},m=(l=h[ef])===null||l===void 0?void 0:l.arrayValue,g=(c=f[ef])===null||c===void 0?void 0:c.arrayValue,x=Wt(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=g==null?void 0:g.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:e4(m,g)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Jl.mapValue&&o===Jl.mapValue)return 0;if(i===Jl.mapValue)return 1;if(o===Jl.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const f=pT(c[h],d[h]);if(f!==0)return f;const m=Ec(l[c[h]],u[d[h]]);if(m!==0)return m}return Wt(c.length,d.length)}(t.mapValue,e.mapValue);default:throw _t(23264,{Pe:n})}}function ZM(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Wt(t,e);const n=al(t),r=al(e),s=Wt(n.seconds,r.seconds);return s!==0?s:Wt(n.nanos,r.nanos)}function e4(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ec(n[s],r[s]);if(i)return i}return Wt(n.length,r.length)}function tf(t){return bT(t)}function bT(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=al(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return ll(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return dt.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=bT(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${bT(n.fields[o])}`;return s+"}"}(t.mapValue):_t(61005,{value:t})}function av(t){switch(Cc(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=Tb(t);return e?16+av(e):16;case 5:return 2*t.stringValue.length;case 6:return ll(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+av(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Hc(r.fields,(i,o)=>{s+=i.length+av(o)}),s}(t.mapValue);default:throw _t(13486,{value:t})}}function eg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function _T(t){return!!t&&"integerValue"in t}function tg(t){return!!t&&"arrayValue"in t}function t4(t){return!!t&&"nullValue"in t}function n4(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function lv(t){return!!t&&"mapValue"in t}function Ib(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[wP])===null||n===void 0?void 0:n.stringValue)===bP}function ip(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Hc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ip(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ip(t.arrayValue.values[n]);return e}return Object.assign({},t)}function _9(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===b9}const S9={mapValue:{fields:{[wP]:{stringValue:bP},[ef]:{arrayValue:{}}}}};function Pxe(t){return"nullValue"in t?ov:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?eg(Qu.empty(),dt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?Ib(t)?S9:{mapValue:{}}:_t(35942,{value:t})}function Axe(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?eg(Qu.empty(),dt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?S9:"mapValue"in t?Ib(t)?{mapValue:{}}:Jl:_t(61959,{value:t})}function r4(t,e){const n=Ec(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function s4(t,e){const n=Ec(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rs{constructor(e){this.value=e}static empty(){return new Rs({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!lv(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ip(n)}setAll(e){let n=mr.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=ip(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());lv(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return ba(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];lv(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Hc(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Rs(ip(this.value))}}function C9(t){const e=[];return Hc(t.fields,(n,r)=>{const s=new mr([n]);if(lv(r)){const i=C9(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new di(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tr{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Tr(e,0,Rt.min(),Rt.min(),Rt.min(),Rs.empty(),0)}static newFoundDocument(e,n,r,s){return new Tr(e,1,n,Rt.min(),r,s,0)}static newNoDocument(e,n){return new Tr(e,2,n,Rt.min(),Rt.min(),Rs.empty(),0)}static newUnknownDocument(e,n){return new Tr(e,3,n,Rt.min(),Rt.min(),Rs.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(Rt.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Rs.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Rs.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=Rt.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Tr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Tr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nf{constructor(e,n){this.position=e,this.inclusive=n}}function i4(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=dt.comparator(dt.fromName(o.referenceValue),n.key):r=Ec(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function o4(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!ba(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aw{constructor(e,n="asc"){this.field=e,this.dir=n}}function kxe(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E9{}class hn extends E9{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Rxe(e,n,r):n==="array-contains"?new Mxe(e,r):n==="in"?new k9(e,r):n==="not-in"?new Lxe(e,r):n==="array-contains-any"?new Fxe(e,r):new hn(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new jxe(e,r):new Dxe(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ec(n,this.value)):n!==null&&Cc(this.value)===Cc(n)&&this.matchesComparison(Ec(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return _t(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class An extends E9{constructor(e,n){super(),this.filters=e,this.op=n,this.Te=null}static create(e,n){return new An(e,n)}matches(e){return rf(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function rf(t){return t.op==="and"}function ST(t){return t.op==="or"}function _P(t){return T9(t)&&rf(t)}function T9(t){for(const e of t.filters)if(e instanceof An)return!1;return!0}function CT(t){if(t instanceof hn)return t.field.canonicalString()+t.op.toString()+tf(t.value);if(_P(t))return t.filters.map(e=>CT(e)).join(",");{const e=t.filters.map(n=>CT(n)).join(",");return`${t.op}(${e})`}}function I9(t,e){return t instanceof hn?function(r,s){return s instanceof hn&&r.op===s.op&&r.field.isEqual(s.field)&&ba(r.value,s.value)}(t,e):t instanceof An?function(r,s){return s instanceof An&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&I9(o,s.filters[l]),!0):!1}(t,e):void _t(19439)}function N9(t,e){const n=t.filters.concat(e);return An.create(n,t.op)}function P9(t){return t instanceof hn?function(n){return`${n.field.canonicalString()} ${n.op} ${tf(n.value)}`}(t):t instanceof An?function(n){return n.op.toString()+" {"+n.getFilters().map(P9).join(" ,")+"}"}(t):"Filter"}class Rxe extends hn{constructor(e,n,r){super(e,n,r),this.key=dt.fromName(r.referenceValue)}matches(e){const n=dt.comparator(e.key,this.key);return this.matchesComparison(n)}}class jxe extends hn{constructor(e,n){super(e,"in",n),this.keys=A9("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class Dxe extends hn{constructor(e,n){super(e,"not-in",n),this.keys=A9("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function A9(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>dt.fromName(r.referenceValue))}class Mxe extends hn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return tg(n)&&Zp(n.arrayValue,this.value)}}class k9 extends hn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Zp(this.value.arrayValue,n)}}class Lxe extends hn{constructor(e,n){super(e,"not-in",n)}matches(e){if(Zp(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Zp(this.value.arrayValue,n)}}class Fxe extends hn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!tg(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Zp(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oxe{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Ie=null}}function ET(t,e=null,n=[],r=[],s=null,i=null,o=null){return new Oxe(t,e,n,r,s,i,o)}function Zu(t){const e=Xt(t);if(e.Ie===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>CT(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),_b(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>tf(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>tf(r)).join(",")),e.Ie=n}return e.Ie}function Kg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!kxe(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!I9(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!o4(t.startAt,e.startAt)&&o4(t.endAt,e.endAt)}function kw(t){return dt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Rw(t,e){return t.filters.filter(n=>n instanceof hn&&n.field.isEqual(e))}function a4(t,e,n){let r=ov,s=!0;for(const i of Rw(t,e)){let o=ov,l=!0;switch(i.op){case"<":case"<=":o=Pxe(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=ov}r4({value:r,inclusive:s},{value:o,inclusive:l})<0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];r4({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function l4(t,e,n){let r=Jl,s=!0;for(const i of Rw(t,e)){let o=Jl,l=!0;switch(i.op){case">=":case">":o=Axe(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Jl}s4({value:r,inclusive:s},{value:o,inclusive:l})>0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];s4({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yg{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function Vxe(t,e,n,r,s,i,o,l){return new Yg(t,e,n,r,s,i,o,l)}function Jg(t){return new Yg(t)}function c4(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function R9(t){return t.collectionGroup!==null}function op(t){const e=Xt(t);if(e.Ee===null){e.Ee=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Rn(mr.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new Aw(i,r))}),n.has(mr.keyField().canonicalString())||e.Ee.push(new Aw(mr.keyField(),r))}return e.Ee}function co(t){const e=Xt(t);return e.de||(e.de=$xe(e,op(t))),e.de}function $xe(t,e){if(t.limitType==="F")return ET(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new Aw(s.field,i)});const n=t.endAt?new nf(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new nf(t.startAt.position,t.startAt.inclusive):null;return ET(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function TT(t,e){const n=t.filters.concat([e]);return new Yg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function jw(t,e,n){return new Yg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function Nb(t,e){return Kg(co(t),co(e))&&t.limitType===e.limitType}function j9(t){return`${Zu(co(t))}|lt:${t.limitType}`}function Gd(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>P9(s)).join(", ")}]`),_b(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>tf(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>tf(s)).join(",")),`Target(${r})`}(co(t))}; limitType=${t.limitType})`}function Xg(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):dt.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of op(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=i4(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,op(r),s)||r.endAt&&!function(o,l,c){const u=i4(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,op(r),s))}(t,e)}function Uxe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function D9(t){return(e,n)=>{let r=!1;for(const s of op(t)){const i=Bxe(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function Bxe(t,e,n){const r=t.field.isKeyField()?dt.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Ec(c,u):_t(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return _t(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vl{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Hc(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return p9(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const zxe=new lr(dt.comparator);function Vi(){return zxe}const M9=new lr(dt.comparator);function Im(...t){let e=M9;for(const n of t)e=e.insert(n.key,n);return e}function L9(t){let e=M9;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function la(){return ap()}function F9(){return ap()}function ap(){return new vl(t=>t.toString(),(t,e)=>t.isEqual(e))}const Gxe=new lr(dt.comparator),Wxe=new Rn(dt.comparator);function on(...t){let e=Wxe;for(const n of t)e=e.add(n);return e}const Hxe=new Rn(Wt);function qxe(){return Hxe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function SP(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Kp(e)?"-0":e}}function O9(t){return{integerValue:""+t}}function Kxe(t,e){return exe(e)?O9(e):SP(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pb{constructor(){this._=void 0}}function Yxe(t,e,n){return t instanceof ng?function(s,i){const o={fields:{[x9]:{stringValue:y9},[w9]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&vP(i)&&(i=Tb(i)),i&&(o.fields[v9]=i),{mapValue:o}}(n,e):t instanceof sf?$9(t,e):t instanceof of?U9(t,e):function(s,i){const o=V9(s,i),l=u4(o)+u4(s.Re);return _T(o)&&_T(s.Re)?O9(l):SP(s.serializer,l)}(t,e)}function Jxe(t,e,n){return t instanceof sf?$9(t,e):t instanceof of?U9(t,e):n}function V9(t,e){return t instanceof rg?function(r){return _T(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ng extends Pb{}class sf extends Pb{constructor(e){super(),this.elements=e}}function $9(t,e){const n=B9(e);for(const r of t.elements)n.some(s=>ba(s,r))||n.push(r);return{arrayValue:{values:n}}}class of extends Pb{constructor(e){super(),this.elements=e}}function U9(t,e){let n=B9(e);for(const r of t.elements)n=n.filter(s=>!ba(s,r));return{arrayValue:{values:n}}}class rg extends Pb{constructor(e,n){super(),this.serializer=e,this.Re=n}}function u4(t){return sr(t.integerValue||t.doubleValue)}function B9(t){return tg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xxe{constructor(e,n){this.field=e,this.transform=n}}function Qxe(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof sf&&s instanceof sf||r instanceof of&&s instanceof of?Yh(r.elements,s.elements,ba):r instanceof rg&&s instanceof rg?ba(r.Re,s.Re):r instanceof ng&&s instanceof ng}(t.transform,e.transform)}class Zxe{constructor(e,n){this.version=e,this.transformResults=n}}class Ys{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Ys}static exists(e){return new Ys(void 0,e)}static updateTime(e){return new Ys(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function cv(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class Ab{}function z9(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new kb(t.key,Ys.none()):new If(t.key,t.data,Ys.none());{const n=t.data,r=Rs.empty();let s=new Rn(mr.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new wl(t.key,r,new di(s.toArray()),Ys.none())}}function eve(t,e,n){t instanceof If?function(s,i,o){const l=s.value.clone(),c=h4(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof wl?function(s,i,o){if(!cv(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=h4(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(G9(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function lp(t,e,n,r){return t instanceof If?function(i,o,l,c){if(!cv(i.precondition,o))return l;const u=i.value.clone(),d=f4(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof wl?function(i,o,l,c){if(!cv(i.precondition,o))return l;const u=f4(i.fieldTransforms,c,o),d=o.data;return d.setAll(G9(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,l){return cv(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function tve(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=V9(r.transform,s||null);i!=null&&(n===null&&(n=Rs.empty()),n.set(r.field,i))}return n||null}function d4(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&Yh(r,s,(i,o)=>Qxe(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class If extends Ab{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class wl extends Ab{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function G9(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function h4(t,e,n){const r=new Map;It(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,Jxe(o,l,n[s]))}return r}function f4(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Yxe(i,o,e))}return r}class kb extends Ab{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class W9 extends Ab{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CP{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&eve(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=lp(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=lp(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=F9();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=z9(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(Rt.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),on())}isEqual(e){return this.batchId===e.batchId&&Yh(this.mutations,e.mutations,(n,r)=>d4(n,r))&&Yh(this.baseMutations,e.baseMutations,(n,r)=>d4(n,r))}}class EP{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){It(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return Gxe}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new EP(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TP{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nve{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Mr,pn;function rve(t){switch(t){case Fe.OK:return _t(64938);case Fe.CANCELLED:case Fe.UNKNOWN:case Fe.DEADLINE_EXCEEDED:case Fe.RESOURCE_EXHAUSTED:case Fe.INTERNAL:case Fe.UNAVAILABLE:case Fe.UNAUTHENTICATED:return!1;case Fe.INVALID_ARGUMENT:case Fe.NOT_FOUND:case Fe.ALREADY_EXISTS:case Fe.PERMISSION_DENIED:case Fe.FAILED_PRECONDITION:case Fe.ABORTED:case Fe.OUT_OF_RANGE:case Fe.UNIMPLEMENTED:case Fe.DATA_LOSS:return!0;default:return _t(15467,{code:t})}}function H9(t){if(t===void 0)return Ks("GRPC error has no .code"),Fe.UNKNOWN;switch(t){case Mr.OK:return Fe.OK;case Mr.CANCELLED:return Fe.CANCELLED;case Mr.UNKNOWN:return Fe.UNKNOWN;case Mr.DEADLINE_EXCEEDED:return Fe.DEADLINE_EXCEEDED;case Mr.RESOURCE_EXHAUSTED:return Fe.RESOURCE_EXHAUSTED;case Mr.INTERNAL:return Fe.INTERNAL;case Mr.UNAVAILABLE:return Fe.UNAVAILABLE;case Mr.UNAUTHENTICATED:return Fe.UNAUTHENTICATED;case Mr.INVALID_ARGUMENT:return Fe.INVALID_ARGUMENT;case Mr.NOT_FOUND:return Fe.NOT_FOUND;case Mr.ALREADY_EXISTS:return Fe.ALREADY_EXISTS;case Mr.PERMISSION_DENIED:return Fe.PERMISSION_DENIED;case Mr.FAILED_PRECONDITION:return Fe.FAILED_PRECONDITION;case Mr.ABORTED:return Fe.ABORTED;case Mr.OUT_OF_RANGE:return Fe.OUT_OF_RANGE;case Mr.UNIMPLEMENTED:return Fe.UNIMPLEMENTED;case Mr.DATA_LOSS:return Fe.DATA_LOSS;default:return _t(39323,{code:t})}}(pn=Mr||(Mr={}))[pn.OK=0]="OK",pn[pn.CANCELLED=1]="CANCELLED",pn[pn.UNKNOWN=2]="UNKNOWN",pn[pn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",pn[pn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",pn[pn.NOT_FOUND=5]="NOT_FOUND",pn[pn.ALREADY_EXISTS=6]="ALREADY_EXISTS",pn[pn.PERMISSION_DENIED=7]="PERMISSION_DENIED",pn[pn.UNAUTHENTICATED=16]="UNAUTHENTICATED",pn[pn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",pn[pn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",pn[pn.ABORTED=10]="ABORTED",pn[pn.OUT_OF_RANGE=11]="OUT_OF_RANGE",pn[pn.UNIMPLEMENTED=12]="UNIMPLEMENTED",pn[pn.INTERNAL=13]="INTERNAL",pn[pn.UNAVAILABLE=14]="UNAVAILABLE",pn[pn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const sve=new dc([4294967295,4294967295],0);function m4(t){const e=Qz().encode(t),n=new Gz;return n.update(e),new Uint8Array(n.digest())}function p4(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new dc([n,r],0),new dc([s,i],0)]}class IP{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new Nm(`Invalid padding: ${n}`);if(r<0)throw new Nm(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new Nm(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new Nm(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*e.length-n,this.ye=dc.fromNumber(this.pe)}we(e,n,r){let s=e.add(n.multiply(dc.fromNumber(r)));return s.compare(sve)===1&&(s=new dc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}Se(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const n=m4(e),[r,s]=p4(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);if(!this.Se(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new IP(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const n=m4(e),[r,s]=p4(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class Nm extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rb{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Qg.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new Rb(Rt.min(),s,new lr(Wt),Vi(),on())}}class Qg{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Qg(r,n,on(),on(),on())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uv{constructor(e,n,r,s){this.De=e,this.removedTargetIds=n,this.key=r,this.ve=s}}class q9{constructor(e,n){this.targetId=e,this.Ce=n}}class K9{constructor(e,n,r=zr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class g4{constructor(){this.Fe=0,this.Me=y4(),this.xe=zr.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=on(),n=on(),r=on();return this.Me.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:_t(38017,{changeType:i})}}),new Qg(this.xe,this.Oe,e,n,r)}Qe(){this.Ne=!1,this.Me=y4()}$e(e,n){this.Ne=!0,this.Me=this.Me.insert(e,n)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,It(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class ive{constructor(e){this.ze=e,this.je=new Map,this.He=Vi(),this.Je=lx(),this.Ye=lx(),this.Ze=new lr(Wt)}Xe(e){for(const n of e.De)e.ve&&e.ve.isFoundDocument()?this.et(n,e.ve):this.tt(n,e.key,e.ve);for(const n of e.removedTargetIds)this.tt(n,e.key,e.ve)}nt(e){this.forEachTarget(e,n=>{const r=this.rt(n);switch(e.state){case 0:this.it(n)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(e.resumeToken));break;default:_t(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.je.forEach((r,s)=>{this.it(s)&&n(s)})}ot(e){const n=e.targetId,r=e.Ce.count,s=this._t(n);if(s){const i=s.target;if(kw(i))if(r===0){const o=new dt(i.path);this.tt(n,o,Tr.newNoDocument(o,Rt.min()))}else It(r===1,20013,{expectedCount:r});else{const o=this.ut(n);if(o!==r){const l=this.ct(e),c=l?this.lt(l,e,o):1;if(c!==0){this.st(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,u)}}}}}ct(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=ll(r).toUint8Array()}catch(c){if(c instanceof g9)return Xu("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new IP(o,s,i)}catch(c){return Xu(c instanceof Nm?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.pe===0?null:l}lt(e,n,r){return n.Ce.count===r-this.Tt(e,n.targetId)?0:2}Tt(e,n){const r=this.ze.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.tt(n,i,null),s++)}),s}It(e){const n=new Map;this.je.forEach((i,o)=>{const l=this._t(o);if(l){if(i.current&&kw(l.target)){const c=new dt(l.target.path);this.Et(c).has(o)||this.dt(o,c)||this.tt(o,c,Tr.newNoDocument(c,e))}i.Le&&(n.set(o,i.qe()),i.Qe())}});let r=on();this.Ye.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this._t(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.He.forEach((i,o)=>o.setReadTime(e));const s=new Rb(e,n,this.Ze,this.He,r);return this.He=Vi(),this.Je=lx(),this.Ye=lx(),this.Ze=new lr(Wt),s}et(e,n){if(!this.it(e))return;const r=this.dt(e,n.key)?2:0;this.rt(e).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(e)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(e))}tt(e,n,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,n)?s.$e(n,1):s.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(e)),this.Ye=this.Ye.insert(n,this.At(n).add(e)),r&&(this.He=this.He.insert(n,r))}removeTarget(e){this.je.delete(e)}ut(e){const n=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let n=this.je.get(e);return n||(n=new g4,this.je.set(e,n)),n}At(e){let n=this.Ye.get(e);return n||(n=new Rn(Wt),this.Ye=this.Ye.insert(e,n)),n}Et(e){let n=this.Je.get(e);return n||(n=new Rn(Wt),this.Je=this.Je.insert(e,n)),n}it(e){const n=this._t(e)!==null;return n||Qe("WatchChangeAggregator","Detected inactive target",e),n}_t(e){const n=this.je.get(e);return n&&n.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new g4),this.ze.getRemoteKeysForTarget(e).forEach(n=>{this.tt(e,n,null)})}dt(e,n){return this.ze.getRemoteKeysForTarget(e).has(n)}}function lx(){return new lr(dt.comparator)}function y4(){return new lr(dt.comparator)}const ove=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),ave=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),lve=(()=>({and:"AND",or:"OR"}))();class cve{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function IT(t,e){return t.useProto3Json||_b(e)?e:{value:e}}function af(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function Y9(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function uve(t,e){return af(t,e.toTimestamp())}function Xs(t){return It(!!t,49232),Rt.fromTimestamp(function(n){const r=al(n);return new gr(r.seconds,r.nanos)}(t))}function NP(t,e){return NT(t,e).canonicalString()}function NT(t,e){const n=function(s){return new Tn(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function J9(t){const e=Tn.fromString(t);return It(i8(e),10190,{key:e.toString()}),e}function Dw(t,e){return NP(t.databaseId,e.path)}function Lu(t,e){const n=J9(e);if(n.get(1)!==t.databaseId.projectId)throw new lt(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new lt(Fe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new dt(Z9(n))}function X9(t,e){return NP(t.databaseId,e)}function Q9(t){const e=J9(t);return e.length===4?Tn.emptyPath():Z9(e)}function PT(t){return new Tn(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function Z9(t){return It(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function x4(t,e,n){return{name:Dw(t,e),fields:n.value.mapValue.fields}}function dve(t,e,n){const r=Lu(t,e.name),s=Xs(e.updateTime),i=e.createTime?Xs(e.createTime):Rt.min(),o=new Rs({mapValue:{fields:e.fields}}),l=Tr.newFoundDocument(r,s,i,o);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function hve(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:_t(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(It(d===void 0||typeof d=="string",58123),zr.fromBase64String(d||"")):(It(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),zr.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?Fe.UNKNOWN:H9(u.code);return new lt(d,u.message||"")}(o);n=new K9(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Lu(t,r.document.name),i=Xs(r.document.updateTime),o=r.document.createTime?Xs(r.document.createTime):Rt.min(),l=new Rs({mapValue:{fields:r.document.fields}}),c=Tr.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new uv(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Lu(t,r.document),i=r.readTime?Xs(r.readTime):Rt.min(),o=Tr.newNoDocument(s,i),l=r.removedTargetIds||[];n=new uv([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Lu(t,r.document),i=r.removedTargetIds||[];n=new uv([],i,s,null)}else{if(!("filter"in e))return _t(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new nve(s,i),l=r.targetId;n=new q9(l,o)}}return n}function Mw(t,e){let n;if(e instanceof If)n={update:x4(t,e.key,e.value)};else if(e instanceof kb)n={delete:Dw(t,e.key)};else if(e instanceof wl)n={update:x4(t,e.key,e.data),updateMask:xve(e.fieldMask)};else{if(!(e instanceof W9))return _t(16599,{ft:e.type});n={verify:Dw(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof ng)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof sf)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof of)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof rg)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw _t(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:uve(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:_t(27497)}(t,e.precondition)),n}function AT(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Ys.updateTime(Xs(i.updateTime)):i.exists!==void 0?Ys.exists(i.exists):Ys.none()}(e.currentDocument):Ys.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)It(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new ng;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new sf(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new of(d)}else"increment"in l?c=new rg(o,l.increment):_t(16584,{proto:l});const u=mr.fromServerFormat(l.fieldPath);return new Xxe(u,c)}(t,s)):[];if(e.update){e.update.name;const s=Lu(t,e.update.name),i=new Rs({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new di(u.map(d=>mr.fromServerFormat(d)))}(e.updateMask);return new wl(s,i,o,n,r)}return new If(s,i,n,r)}if(e.delete){const s=Lu(t,e.delete);return new kb(s,n)}if(e.verify){const s=Lu(t,e.verify);return new W9(s,n)}return _t(1463,{proto:e})}function fve(t,e){return t&&t.length>0?(It(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Xs(s.updateTime):Xs(i);return o.isEqual(Rt.min())&&(o=Xs(i)),new Zxe(o,s.transformResults||[])}(n,e))):[]}function e8(t,e){return{documents:[X9(t,e.path)]}}function t8(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=X9(t,s);const i=function(u){if(u.length!==0)return s8(An.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(f){return{field:Wd(f.field),direction:pve(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=IT(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{gt:n,parent:s}}function n8(t){let e=Q9(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){It(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(h){const f=r8(h);return f instanceof An&&_P(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(g){return new Aw(Hd(g.field),function(v){switch(v){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(f))}(n.orderBy));let l=null;n.limit&&(l=function(h){let f;return f=typeof h=="object"?h.value:h,_b(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(h){const f=!!h.before,m=h.values||[];return new nf(m,f)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const f=!h.before,m=h.values||[];return new nf(m,f)}(n.endAt)),Vxe(e,s,o,i,l,"F",c,u)}function mve(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return _t(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function r8(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Hd(n.unaryFilter.field);return hn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Hd(n.unaryFilter.field);return hn.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Hd(n.unaryFilter.field);return hn.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Hd(n.unaryFilter.field);return hn.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return _t(61313);default:return _t(60726)}}(t):t.fieldFilter!==void 0?function(n){return hn.create(Hd(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return _t(58110);default:return _t(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return An.create(n.compositeFilter.filters.map(r=>r8(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return _t(1026)}}(n.compositeFilter.op))}(t):_t(30097,{filter:t})}function pve(t){return ove[t]}function gve(t){return ave[t]}function yve(t){return lve[t]}function Wd(t){return{fieldPath:t.canonicalString()}}function Hd(t){return mr.fromServerFormat(t.fieldPath)}function s8(t){return t instanceof hn?function(n){if(n.op==="=="){if(n4(n.value))return{unaryFilter:{field:Wd(n.field),op:"IS_NAN"}};if(t4(n.value))return{unaryFilter:{field:Wd(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(n4(n.value))return{unaryFilter:{field:Wd(n.field),op:"IS_NOT_NAN"}};if(t4(n.value))return{unaryFilter:{field:Wd(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Wd(n.field),op:gve(n.op),value:n.value}}}(t):t instanceof An?function(n){const r=n.getFilters().map(s=>s8(s));return r.length===1?r[0]:{compositeFilter:{op:yve(n.op),filters:r}}}(t):_t(54877,{filter:t})}function xve(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function i8(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ga{constructor(e,n,r,s,i=Rt.min(),o=Rt.min(),l=zr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ga(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ga(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ga(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ga(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class o8{constructor(e){this.wt=e}}function vve(t,e){let n;if(e.document)n=dve(t.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=dt.fromSegments(e.noDocument.path),s=td(e.noDocument.readTime);n=Tr.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return _t(56709);{const r=dt.fromSegments(e.unknownDocument.path),s=td(e.unknownDocument.version);n=Tr.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new gr(s[0],s[1]);return Rt.fromTimestamp(i)}(e.readTime)),n}function v4(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Lw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Dw(i,o.key),fields:o.data.value.mapValue.fields,updateTime:af(i,o.version.toTimestamp()),createTime:af(i,o.createTime.toTimestamp())}}(t.wt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ed(e.version)};else{if(!e.isUnknownDocument())return _t(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:ed(e.version)}}return r}function Lw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function ed(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function td(t){const e=new gr(t.seconds,t.nanoseconds);return Rt.fromTimestamp(e)}function mu(t,e){const n=(e.baseMutations||[]).map(i=>AT(t.wt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>AT(t.wt,i)),s=gr.fromMillis(e.localWriteTimeMs);return new CP(e.batchId,s,n,r)}function Pm(t){const e=td(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?td(t.lastLimboFreeSnapshotVersion):Rt.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return It(o===1,1966,{count:o}),co(Jg(Q9(i.documents[0])))}(t.query):function(i){return co(n8(i))}(t.query),new Ga(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,zr.fromBase64String(t.resumeToken))}function a8(t,e){const n=ed(e.snapshotVersion),r=ed(e.lastLimboFreeSnapshotVersion);let s;s=kw(e.target)?e8(t.wt,e.target):t8(t.wt,e.target).gt;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:Zu(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function l8(t){const e=n8({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?jw(e,e.limit,"L"):e}function LS(t,e){return new TP(e.largestBatchId,AT(t.wt,e.overlayMutation))}function w4(t,e){const n=e.path.lastSegment();return[t,js(e.path.popLast()),n]}function b4(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:ed(r.readTime),documentKey:js(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wve{getBundleMetadata(e,n){return _4(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:td(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return _4(e).put(function(s){return{bundleId:s.id,createTime:ed(Xs(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return S4(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:l8(i.bundledQuery),readTime:td(i.readTime)}}(r)})}saveNamedQuery(e,n){return S4(e).put(function(s){return{name:s.name,readTime:ed(Xs(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function _4(t){return Qr(t,Sb)}function S4(t){return Qr(t,Cb)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jb{constructor(e,n){this.serializer=e,this.userId=n}static St(e,n){const r=n.uid||"";return new jb(e,r)}getOverlay(e,n){return nm(e).get(w4(this.userId,n)).next(r=>r?LS(this.serializer,r):null)}getOverlays(e,n){const r=la();return ye.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const l=new TP(n,o);s.push(this.bt(e,l))}),ye.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(js(o.getCollectionPath())));const i=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(nm(e).X(vT,l))}),ye.waitFor(i)}getOverlaysForCollection(e,n,r){const s=la(),i=js(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return nm(e).J(vT,o).next(l=>{for(const c of l){const u=LS(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=la();let o;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return nm(e).te({index:u9,range:l},(c,u,d)=>{const h=LS(this.serializer,u);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>i)}bt(e,n){return nm(e).put(function(s,i,o){const[l,c,u]=w4(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Mw(s.wt,o.mutation)}}(this.serializer,this.userId,n))}}function nm(t){return Qr(t,Eb)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bve{Dt(e){return Qr(e,yP)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?zr.fromUint8Array(r):zr.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Dt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pu{constructor(){}vt(e,n){this.Ct(e,n),n.Ft()}Ct(e,n){if("nullValue"in e)this.Mt(n,5);else if("booleanValue"in e)this.Mt(n,10),n.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(n,15),n.xt(sr(e.integerValue));else if("doubleValue"in e){const r=sr(e.doubleValue);isNaN(r)?this.Mt(n,13):(this.Mt(n,15),Kp(r)?n.xt(0):n.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(n,20),typeof r=="string"&&(r=al(r)),n.Ot(`${r.seconds||""}`),n.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,n),this.Bt(n);else if("bytesValue"in e)this.Mt(n,30),n.Lt(ll(e.bytesValue)),this.Bt(n);else if("referenceValue"in e)this.kt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(n,45),n.xt(r.latitude||0),n.xt(r.longitude||0)}else"mapValue"in e?_9(e)?this.Mt(n,Number.MAX_SAFE_INTEGER):Ib(e)?this.qt(e.mapValue,n):(this.Qt(e.mapValue,n),this.Bt(n)):"arrayValue"in e?(this.$t(e.arrayValue,n),this.Bt(n)):_t(19022,{Ut:e})}Nt(e,n){this.Mt(n,25),this.Kt(e,n)}Kt(e,n){n.Ot(e)}Qt(e,n){const r=e.fields||{};this.Mt(n,55);for(const s of Object.keys(r))this.Nt(s,n),this.Ct(r[s],n)}qt(e,n){var r,s;const i=e.fields||{};this.Mt(n,53);const o=ef,l=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Mt(n,15),n.xt(sr(l)),this.Nt(o,n),this.Ct(i[o],n)}$t(e,n){const r=e.values||[];this.Mt(n,50);for(const s of r)this.Ct(s,n)}kt(e,n){this.Mt(n,37),dt.fromName(e).path.forEach(r=>{this.Mt(n,60),this.Kt(r,n)})}Mt(e,n){e.xt(n)}Bt(e){e.xt(2)}}pu.Wt=new pu;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jd=255;function _ve(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function C4(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=_ve(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class Sve{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.zt(r.value),r=n.next();this.jt()}Ht(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Yt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const s=n.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const n=this.tn(e),r=C4(n);this.nn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}rn(e){const n=this.tn(e),r=C4(n);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}sn(){this._n(jd),this._n(255)}an(){this.un(jd),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}zt(e){const n=255&e;n===0?(this._n(0),this._n(255)):n===jd?(this._n(jd),this._n(0)):this._n(n)}Jt(e){const n=255&e;n===0?(this.un(0),this.un(255)):n===jd?(this.un(jd),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class Cve{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class Eve{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class rm{constructor(){this.ln=new Sve,this.hn=new Cve(this.ln),this.Pn=new Eve(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gu{constructor(e,n,r,s){this.In=e,this.En=n,this.dn=r,this.An=s}Rn(){const e=this.An.length,n=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.An,0),n!==e?r.set([0],this.An.length):++r[r.length-1],new gu(this.In,this.En,this.dn,r)}Vn(e,n,r){return{indexId:this.In,uid:e,arrayValue:dv(this.dn),directionalValue:dv(this.An),orderedDocumentKey:dv(n),documentKey:r.path.toArray()}}mn(e,n,r){const s=this.Vn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Nl(t,e){let n=t.In-e.In;return n!==0?n:(n=E4(t.dn,e.dn),n!==0?n:(n=E4(t.An,e.An),n!==0?n:dt.comparator(t.En,e.En)))}function E4(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function dv(t){return sz()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function T4(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class I4{constructor(e){this.fn=new Rn((n,r)=>mr.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const n of e.filters){const r=n;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(It(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const n=gT(e);if(n!==void 0&&!this.Sn(n))return!1;const r=lu(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.Sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=r[i];if(!this.bn(l,c)||!this.Dn(this.gn[o++],c))return!1}++i}for(;i<r.length;++i){const l=r[i];if(o>=this.gn.length||!this.Dn(this.gn[o++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new Rn(mr.comparator);const n=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new rv(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new rv(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new rv(r.field,r.dir==="asc"?0:1)));return new Ew(Ew.UNKNOWN_ID,this.collectionId,n,qp.empty())}Sn(e){for(const n of this.pn)if(this.bn(n,e))return!0;return!1}bn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}Dn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function c8(t){var e,n;if(It(t instanceof hn||t instanceof An,20012),t instanceof hn){if(t instanceof k9){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>hn.create(t.field,"==",i)))||[];return An.create(s,"or")}return t}const r=t.filters.map(s=>c8(s));return An.create(r,t.op)}function Tve(t){if(t.getFilters().length===0)return[];const e=jT(c8(t));return It(u8(e),7391),kT(e)||RT(e)?[e]:e.getFilters()}function kT(t){return t instanceof hn}function RT(t){return t instanceof An&&_P(t)}function u8(t){return kT(t)||RT(t)||function(n){if(n instanceof An&&ST(n)){for(const r of n.getFilters())if(!kT(r)&&!RT(r))return!1;return!0}return!1}(t)}function jT(t){if(It(t instanceof hn||t instanceof An,34018),t instanceof hn)return t;if(t.filters.length===1)return jT(t.filters[0]);const e=t.filters.map(r=>jT(r));let n=An.create(e,t.op);return n=Fw(n),u8(n)?n:(It(n instanceof An,64498),It(rf(n),40251),It(n.filters.length>1,57927),n.filters.reduce((r,s)=>PP(r,s)))}function PP(t,e){let n;return It(t instanceof hn||t instanceof An,38388),It(e instanceof hn||e instanceof An,25473),n=t instanceof hn?e instanceof hn?function(s,i){return An.create([s,i],"and")}(t,e):N4(t,e):e instanceof hn?N4(e,t):function(s,i){if(It(s.filters.length>0&&i.filters.length>0,48005),rf(s)&&rf(i))return N9(s,i.getFilters());const o=ST(s)?s:i,l=ST(s)?i:s,c=o.filters.map(u=>PP(u,l));return An.create(c,"or")}(t,e),Fw(n)}function N4(t,e){if(rf(e))return N9(e,t.getFilters());{const n=e.filters.map(r=>PP(t,r));return An.create(n,"or")}}function Fw(t){if(It(t instanceof hn||t instanceof An,11850),t instanceof hn)return t;const e=t.getFilters();if(e.length===1)return Fw(e[0]);if(T9(t))return t;const n=e.map(s=>Fw(s)),r=[];return n.forEach(s=>{s instanceof hn?r.push(s):s instanceof An&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:An.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ive{constructor(){this.Cn=new AP}addToCollectionParentIndex(e,n){return this.Cn.add(n),ye.resolve()}getCollectionParents(e,n){return ye.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ye.resolve()}deleteFieldIndex(e,n){return ye.resolve()}deleteAllFieldIndexes(e){return ye.resolve()}createTargetIndexes(e,n){return ye.resolve()}getDocumentsMatchingTarget(e,n){return ye.resolve(null)}getIndexType(e,n){return ye.resolve(0)}getFieldIndexes(e,n){return ye.resolve([])}getNextCollectionGroupToUpdate(e){return ye.resolve(null)}getMinOffset(e,n){return ye.resolve(qi.min())}getMinOffsetFromCollectionGroup(e,n){return ye.resolve(qi.min())}updateCollectionGroup(e,n,r){return ye.resolve()}updateIndexEntries(e,n){return ye.resolve()}}class AP{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Rn(Tn.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Rn(Tn.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const P4="IndexedDbIndexManager",cx=new Uint8Array(0);class Nve{constructor(e,n){this.databaseId=n,this.Fn=new AP,this.Mn=new vl(r=>Zu(r),(r,s)=>Kg(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Fn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Fn.add(n)});const i={collectionId:r,parent:js(s)};return A4(e).put(i)}return ye.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[e9(n),""],!1,!0);return A4(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(aa(o.parent))}return r})}addFieldIndex(e,n){const r=sm(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Md(e);return i.next(l=>{o.put(b4(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=sm(e),s=Md(e),i=Dd(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=sm(e),r=Dd(e),s=Md(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return ye.forEach(this.xn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new I4(r).vn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Dd(e);let s=!0;const i=new Map;return ye.forEach(this.xn(n),o=>this.On(e,o).next(l=>{s&&(s=!!l),i.set(o,l)})).next(()=>{if(s){let o=on();const l=[];return ye.forEach(i,(c,u)=>{Qe(P4,`Using index ${function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(T=>`${T.fieldPath}:${T.kind}`).join(",")}`}(c)} to execute ${Zu(n)}`);const d=function(C,T){const R=gT(T);if(R===void 0)return null;for(const A of Rw(C,R.fieldPath))switch(A.op){case"array-contains-any":return A.value.arrayValue.values||[];case"array-contains":return[A.value]}return null}(u,c),h=function(C,T){const R=new Map;for(const A of lu(T))for(const E of Rw(C,A.fieldPath))switch(E.op){case"==":case"in":R.set(A.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return R.set(A.fieldPath.canonicalString(),E.value),Array.from(R.values())}return null}(u,c),f=function(C,T){const R=[];let A=!0;for(const E of lu(T)){const I=E.kind===0?a4(C,E.fieldPath,C.startAt):l4(C,E.fieldPath,C.startAt);R.push(I.value),A&&(A=I.inclusive)}return new nf(R,A)}(u,c),m=function(C,T){const R=[];let A=!0;for(const E of lu(T)){const I=E.kind===0?l4(C,E.fieldPath,C.endAt):a4(C,E.fieldPath,C.endAt);R.push(I.value),A&&(A=I.inclusive)}return new nf(R,A)}(u,c),g=this.Nn(c,u,f),x=this.Nn(c,u,m),v=this.Bn(c,u,h),w=this.Ln(c.indexId,d,g,f.inclusive,x,m.inclusive,v);return ye.forEach(w,_=>r.Z(_,n.limit).next(C=>{C.forEach(T=>{const R=dt.fromSegments(T.documentKey);o.has(R)||(o=o.add(R),l.push(R))})}))}).next(()=>l)}return ye.resolve(null)})}xn(e){let n=this.Mn.get(e);return n||(e.filters.length===0?n=[e]:n=Tve(An.create(e.filters,"and")).map(r=>ET(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,n),n)}Ln(e,n,r,s,i,o,l){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),u=c/(n!=null?n.length:1),d=[];for(let h=0;h<c;++h){const f=n?this.kn(n[h/u]):cx,m=this.qn(e,f,r[h%u],s),g=this.Qn(e,f,i[h%u],o),x=l.map(v=>this.qn(e,f,v,!0));d.push(...this.createRange(m,g,x))}return d}qn(e,n,r,s){const i=new gu(e,dt.empty(),n,r);return s?i:i.Rn()}Qn(e,n,r,s){const i=new gu(e,dt.empty(),n,r);return s?i.Rn():i}On(e,n){const r=new I4(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const l of i)r.wn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,n){let r=2;const s=this.xn(n);return ye.forEach(s,i=>this.On(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Rn(mr.comparator),d=!1;for(const h of c.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?d=!0:u=u.add(f.field));for(const h of c.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}$n(e,n){const r=new rm;for(const s of lu(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Tn(s.kind);pu.Wt.vt(i,o)}return r.cn()}kn(e){const n=new rm;return pu.Wt.vt(e,n.Tn(0)),n.cn()}Un(e,n){const r=new rm;return pu.Wt.vt(eg(this.databaseId,n),r.Tn(function(i){const o=lu(i);return o.length===0?0:o[o.length-1].kind}(e))),r.cn()}Bn(e,n,r){if(r===null)return[];let s=[];s.push(new rm);let i=0;for(const o of lu(e)){const l=r[i++];for(const c of s)if(this.Kn(n,o.fieldPath)&&tg(l))s=this.Wn(s,o,l);else{const u=c.Tn(o.kind);pu.Wt.vt(l,u)}}return this.Gn(s)}Nn(e,n,r){return this.Bn(e,n,r.position)}Gn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].cn();return n}Wn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const l of s){const c=new rm;c.seed(l.cn()),pu.Wt.vt(o,c.Tn(n.kind)),i.push(c)}return i}Kn(e,n){return!!e.filters.find(r=>r instanceof hn&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=sm(e),s=Md(e);return(n?r.J(xT,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return ye.forEach(i,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(d,h){const f=h?new qp(h.sequenceNumber,new qi(td(h.readTime),new dt(aa(h.documentKey)),h.largestBatchId)):qp.empty(),m=d.fields.map(([g,x])=>new rv(mr.fromServerFormat(g),x));return new Ew(d.indexId,d.collectionGroup,m,f)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Wt(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=sm(e),i=Md(e);return this.zn(e).next(o=>s.J(xT,IDBKeyRange.bound(n,n)).next(l=>ye.forEach(l,c=>i.put(b4(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return ye.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?ye.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(r.set(s.collectionGroup,l),ye.forEach(l,c=>this.jn(e,s,c).next(u=>{const d=this.Hn(i,c);return u.isEqual(d)?ye.resolve():this.Jn(e,i,c,u,d)}))))})}Yn(e,n,r,s){return Dd(e).put(s.Vn(this.uid,this.Un(r,n.key),n.key))}Zn(e,n,r,s){return Dd(e).delete(s.mn(this.uid,this.Un(r,n.key),n.key))}jn(e,n,r){const s=Dd(e);let i=new Rn(Nl);return s.te({index:c9,range:IDBKeyRange.only([r.indexId,this.uid,dv(this.Un(r,n))])},(o,l)=>{i=i.add(new gu(r.indexId,n,T4(l.arrayValue),T4(l.directionalValue)))}).next(()=>i)}Hn(e,n){let r=new Rn(Nl);const s=this.$n(n,e);if(s==null)return r;const i=gT(n);if(i!=null){const o=e.data.field(i.fieldPath);if(tg(o))for(const l of o.arrayValue.values||[])r=r.add(new gu(n.indexId,e.key,this.kn(l),s))}else r=r.add(new gu(n.indexId,e.key,cx,s));return r}Jn(e,n,r,s,i){Qe(P4,"Updating index entries for document '%s'",n.key);const o=[];return function(c,u,d,h,f){const m=c.getIterator(),g=u.getIterator();let x=Rd(m),v=Rd(g);for(;x||v;){let w=!1,_=!1;if(x&&v){const C=d(x,v);C<0?_=!0:C>0&&(w=!0)}else x!=null?_=!0:w=!0;w?(h(v),v=Rd(g)):_?(f(x),x=Rd(m)):(x=Rd(m),v=Rd(g))}}(s,i,Nl,l=>{o.push(this.Yn(e,n,r,l))},l=>{o.push(this.Zn(e,n,r,l))}),ye.waitFor(o)}zn(e){let n=1;return Md(e).te({index:l9,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,l)=>Nl(o,l)).filter((o,l,c)=>!l||Nl(o,c[l-1])!==0);const s=[];s.push(e);for(const o of r){const l=Nl(o,e),c=Nl(o,n);if(l===0)s[0]=e.Rn();else if(l>0&&c<0)s.push(o),s.push(o.Rn());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Xn(s[o],s[o+1]))return[];const l=s[o].mn(this.uid,cx,dt.empty()),c=s[o+1].mn(this.uid,cx,dt.empty());i.push(IDBKeyRange.bound(l,c))}return i}Xn(e,n){return Nl(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(k4)}getMinOffset(e,n){return ye.mapArray(this.xn(n),r=>this.On(e,r).next(s=>s||_t(44426))).next(k4)}}function A4(t){return Qr(t,Xp)}function Dd(t){return Qr(t,sp)}function sm(t){return Qr(t,gP)}function Md(t){return Qr(t,rp)}function k4(t){It(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;fP(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new qi(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const R4={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},d8=41943040;class Ps{static withCacheSize(e){return new Ps(e,Ps.DEFAULT_COLLECTION_PERCENTILE,Ps.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function h8(t,e,n){const r=t.store(Io),s=t.store(Jh),i=[],o=IDBKeyRange.only(n.batchId);let l=0;const c=r.te({range:o},(d,h,f)=>(l++,f.delete()));i.push(c.next(()=>{It(l===1,47070,{batchId:n.batchId})}));const u=[];for(const d of n.mutations){const h=i9(e,d.key.path,n.batchId);i.push(s.delete(h)),u.push(d.key)}return ye.waitFor(i).next(()=>u)}function Ow(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw _t(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Ps.DEFAULT_COLLECTION_PERCENTILE=10,Ps.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Ps.DEFAULT=new Ps(d8,Ps.DEFAULT_COLLECTION_PERCENTILE,Ps.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ps.DISABLED=new Ps(-1,0,0);class Db{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.er={}}static St(e,n,r,s){It(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new Db(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Pl(e).te({index:Nu,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=qd(e),o=Pl(e);return o.add({}).next(l=>{It(typeof l=="number",49019);const c=new CP(l,n,r,s),u=function(m,g,x){const v=x.baseMutations.map(_=>Mw(m.wt,_)),w=x.mutations.map(_=>Mw(m.wt,_));return{userId:g,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:v,mutations:w}}(this.serializer,this.userId,c),d=[];let h=new Rn((f,m)=>Wt(f.canonicalString(),m.canonicalString()));for(const f of s){const m=i9(this.userId,f.key.path,l);h=h.add(f.key.path.popLast()),d.push(o.put(u)),d.push(i.put(m,rxe))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.er[l]=c.keys()}),ye.waitFor(d).next(()=>c)})}lookupMutationBatch(e,n){return Pl(e).get(n).next(r=>r?(It(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),mu(this.serializer,r)):null)}tr(e,n){return this.er[n]?ye.resolve(this.er[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.er[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Pl(e).te({index:Nu,range:s},(o,l,c)=>{l.userId===this.userId&&(It(l.batchId>=r,47524,{nr:r}),i=mu(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=Du;return Pl(e).te({index:Nu,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,Du],[this.userId,Number.POSITIVE_INFINITY]);return Pl(e).J(Nu,n).next(r=>r.map(s=>mu(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=sv(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return qd(e).te({range:s},(o,l,c)=>{const[u,d,h]=o,f=aa(d);if(u===this.userId&&n.path.isEqual(f))return Pl(e).get(h).next(m=>{if(!m)throw _t(61480,{rr:o,batchId:h});It(m.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:m.userId,batchId:h}),i.push(mu(this.serializer,m))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Rn(Wt);const s=[];return n.forEach(i=>{const o=sv(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=qd(e).te({range:l},(u,d,h)=>{const[f,m,g]=u,x=aa(m);f===this.userId&&i.path.isEqual(x)?r=r.add(g):h.done()});s.push(c)}),ye.waitFor(s).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=sv(this.userId,r),o=IDBKeyRange.lowerBound(i);let l=new Rn(Wt);return qd(e).te({range:o},(c,u,d)=>{const[h,f,m]=c,g=aa(f);h===this.userId&&r.isPrefixOf(g)?g.length===s&&(l=l.add(m)):d.done()}).next(()=>this.ir(e,l))}ir(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Pl(e).get(i).next(o=>{if(o===null)throw _t(35274,{batchId:i});It(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(mu(this.serializer,o))}))}),ye.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return h8(e.he,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.sr(n.batchId)}),ye.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return ye.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return qd(e).te({range:r},(i,o,l)=>{if(i[0]===this.userId){const c=aa(i[1]);s.push(c)}else l.done()}).next(()=>{It(s.length===0,56720,{_r:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return f8(e,this.userId,n)}ar(e){return m8(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:Du,lastStreamToken:""})}}function f8(t,e,n){const r=sv(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return qd(t).te({range:i,ee:!0},(l,c,u)=>{const[d,h,f]=l;d===e&&h===s&&(o=!0),u.done()}).next(()=>o)}function Pl(t){return Qr(t,Io)}function qd(t){return Qr(t,Jh)}function m8(t){return Qr(t,Yp)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nd{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new nd(0)}static lr(){return new nd(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pve{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.hr(e).next(n=>{const r=new nd(n.highestTargetId);return n.highestTargetId=r.next(),this.Pr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(n=>Rt.fromTimestamp(new gr(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.hr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Pr(e,s)))}addTargetData(e,n){return this.Tr(e,n).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(n,r),this.Pr(e,r))))}updateTargetData(e,n){return this.Tr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>Ld(e).delete(n.targetId)).next(()=>this.hr(e)).next(r=>(It(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return Ld(e).te((o,l)=>{const c=Pm(l);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>ye.waitFor(i)).next(()=>s)}forEachTarget(e,n){return Ld(e).te((r,s)=>{const i=Pm(s);n(i)})}hr(e){return j4(e).get(Nw).next(n=>(It(n!==null,2888),n))}Pr(e,n){return j4(e).put(Nw,n)}Tr(e,n){return Ld(e).put(a8(this.serializer,n))}Ir(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=Zu(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return Ld(e).te({range:s,index:a9},(o,l,c)=>{const u=Pm(l);Kg(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=Wl(e);return n.forEach(o=>{const l=js(o.path);s.push(i.put({targetId:r,path:l})),s.push(this.referenceDelegate.addReference(e,r,o))}),ye.waitFor(s)}removeMatchingKeys(e,n,r){const s=Wl(e);return ye.forEach(n,i=>{const o=js(i.path);return ye.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=Wl(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=Wl(e);let i=on();return s.te({range:r,ee:!0},(o,l,c)=>{const u=aa(o[1]),d=new dt(u);i=i.add(d)}).next(()=>i)}containsKey(e,n){const r=js(n.path),s=IDBKeyRange.bound([r],[e9(r)],!1,!0);let i=0;return Wl(e).te({index:pP,ee:!0,range:s},([o,l],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}Rt(e,n){return Ld(e).get(n).next(r=>r?Pm(r):null)}}function Ld(t){return Qr(t,Xh)}function j4(t){return Qr(t,Mu)}function Wl(t){return Qr(t,Qh)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const D4="LruGarbageCollector",Ave=1048576;function M4([t,e],[n,r]){const s=Wt(t,n);return s===0?Wt(e,r):s}class kve{constructor(e){this.Er=e,this.buffer=new Rn(M4),this.dr=0}Ar(){return++this.dr}Rr(e){const n=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();M4(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class p8{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Qe(D4,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Wc(n)?Qe(D4,"Ignoring IndexedDB error during garbage collection: ",n):await hd(n)}await this.mr(3e5)})}}class Rve{constructor(e,n){this.gr=e,this.params=n}calculateTargetCount(e,n){return this.gr.pr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ye.resolve(oo.le);const r=new kve(n);return this.gr.forEachTarget(e,s=>r.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>r.Rr(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.gr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.gr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Qe("LruGarbageCollector","Garbage collection skipped; disabled"),ye.resolve(R4)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Qe("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),R4):this.wr(e,n))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,n){let r,s,i,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Qe("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,l=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),zd()<=dn.DEBUG&&Qe("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),ye.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function g8(t,e){return new Rve(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jve{constructor(e,n){this.db=e,this.garbageCollector=g8(this,n)}pr(e){const n=this.Sr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}yr(e,n){return this.br(e,(r,s)=>n(s))}addReference(e,n,r){return ux(e,r)}removeReference(e,n,r){return ux(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return ux(e,n)}Dr(e,n){return function(s,i){let o=!1;return m8(s).ne(l=>f8(s,l,i).next(c=>(c&&(o=!0),ye.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.br(e,(o,l)=>{if(l<=n){const c=this.Dr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,Rt.min()),Wl(e).delete(function(h){return[0,js(h.path)]}(o))))});s.push(c)}}).next(()=>ye.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return ux(e,n)}br(e,n){const r=Wl(e);let s,i=oo.le;return r.te({index:pP},([o,l],{path:c,sequenceNumber:u})=>{o===0?(i!==oo.le&&n(new dt(aa(s)),i),i=u,s=c):i=oo.le}).next(()=>{i!==oo.le&&n(new dt(aa(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function ux(t,e){return Wl(t).put(function(r,s){return{targetId:0,path:js(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y8{constructor(){this.changes=new vl(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Tr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ye.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dve{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return tu(e).put(r)}removeEntry(e,n,r){return tu(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Lw(o),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.vr(e,r)))}getEntry(e,n){let r=Tr.newInvalidDocument(n);return tu(e).te({index:iv,range:IDBKeyRange.only(im(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}Fr(e,n){let r={size:0,document:Tr.newInvalidDocument(n)};return tu(e).te({index:iv,range:IDBKeyRange.only(im(n))},(s,i)=>{r={document:this.Cr(n,i),size:Ow(i)}}).next(()=>r)}getEntries(e,n){let r=Vi();return this.Mr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Or(e,n){let r=Vi(),s=new lr(dt.comparator);return this.Mr(e,n,(i,o)=>{const l=this.Cr(i,o);r=r.insert(i,l),s=s.insert(i,Ow(o))}).next(()=>({documents:r,Nr:s}))}Mr(e,n,r){if(n.isEmpty())return ye.resolve();let s=new Rn(O4);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(im(s.first()),im(s.last())),o=s.getIterator();let l=o.getNext();return tu(e).te({index:iv,range:i},(c,u,d)=>{const h=dt.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&O4(l,h)<0;)r(l,null),l=o.getNext();l&&l.isEqual(h)&&(r(l,u),l=o.hasNext()?o.getNext():null),l?d.H(im(l)):d.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,l=[o.popLast().toArray(),o.lastSegment(),Lw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return tu(e).J(IDBKeyRange.bound(l,c,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let d=Vi();for(const h of u){const f=this.Cr(dt.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(Xg(n,f)||s.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,n,r,s){let i=Vi();const o=F4(n,r),l=F4(n,qi.max());return tu(e).te({index:o9,range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const h=this.Cr(dt.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(h.key,h),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new Mve(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return L4(e).get(yT).next(n=>(It(!!n,20021),n))}vr(e,n){return L4(e).put(yT,n)}Cr(e,n){if(n){const r=vve(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(Rt.min())))return r}return Tr.newInvalidDocument(e)}}function x8(t){return new Dve(t)}class Mve extends y8{constructor(e,n){super(),this.Br=e,this.trackRemovals=n,this.Lr=new vl(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Rn((i,o)=>Wt(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Lr.get(i);if(n.push(this.Br.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=v4(this.Br.serializer,o);s=s.add(i.path.popLast());const u=Ow(c);r+=u-l.size,n.push(this.Br.addEntry(e,i,c))}else if(r-=l.size,this.trackRemovals){const c=v4(this.Br.serializer,o.convertToNoDocument(Rt.min()));n.push(this.Br.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Br.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Br.updateMetadata(e,r)),ye.waitFor(n)}getFromCache(e,n){return this.Br.Fr(e,n).next(r=>(this.Lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Br.Or(e,n).next(({documents:r,Nr:s})=>(s.forEach((i,o)=>{this.Lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function L4(t){return Qr(t,Jp)}function tu(t){return Qr(t,Iw)}function im(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function F4(t,e){const n=e.documentKey.path.toArray();return[t,Lw(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function O4(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Wt(n[i],r[i]),s)return s;return s=Wt(n.length,r.length),s||(s=Wt(n[n.length-2],r[r.length-2]),s||Wt(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lve{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v8{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&lp(r.mutation,s,di.empty(),gr.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,on()).next(()=>r))}getLocalViewOfDocuments(e,n,r=on()){const s=la();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Im();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=la();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,on()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Vi();const o=ap(),l=function(){return ap()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof wl)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),lp(d.mutation,u,d.mutation.getFieldMask(),gr.now())):o.set(u.key,di.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var h;return l.set(u,new Lve(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),l))}recalculateAndSaveOverlays(e,n){const r=ap();let s=new lr((o,l)=>o-l),i=on();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||di.empty();d=l.applyToLocalView(u,d),r.set(c,d);const h=(s.get(l.batchId)||on()).add(c);s=s.insert(l.batchId,h)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,h=F9();d.forEach(f=>{if(!i.has(f)){const m=z9(n.get(f),r.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return ye.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return dt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):R9(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):ye.resolve(la());let l=Hp,c=i;return o.next(u=>ye.forEach(u,(d,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),i.get(d)?ye.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{c=c.insert(d,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,on())).next(d=>({batchId:l,changes:L9(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new dt(n)).next(r=>{let s=Im();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Im();return this.indexManager.getCollectionParents(e,i).next(l=>ye.forEach(l,c=>{const u=function(h,f){return new Yg(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Tr.newInvalidDocument(d)))});let l=Im();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&lp(d.mutation,u,di.empty(),gr.now()),Xg(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fve{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,n){return ye.resolve(this.kr.get(n))}saveBundleMetadata(e,n){return this.kr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Xs(s.createTime)}}(n)),ye.resolve()}getNamedQuery(e,n){return ye.resolve(this.qr.get(n))}saveNamedQuery(e,n){return this.qr.set(n.name,function(s){return{name:s.name,query:l8(s.bundledQuery),readTime:Xs(s.readTime)}}(n)),ye.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ove{constructor(){this.overlays=new lr(dt.comparator),this.Qr=new Map}getOverlay(e,n){return ye.resolve(this.overlays.get(n))}getOverlays(e,n){const r=la();return ye.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),ye.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Qr.delete(r)),ye.resolve()}getOverlaysForCollection(e,n,r){const s=la(),i=n.length+1,o=new dt(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return ye.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new lr((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=la(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=la(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return ye.resolve(l)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Qr.get(s.largestBatchId).delete(r.key);this.Qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new TP(n,r));let i=this.Qr.get(n);i===void 0&&(i=on(),this.Qr.set(n,i)),this.Qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vve{constructor(){this.sessionToken=zr.EMPTY_BYTE_STRING}getSessionToken(e){return ye.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ye.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kP{constructor(){this.$r=new Rn(rs.Ur),this.Kr=new Rn(rs.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,n){const r=new rs(e,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.zr(new rs(e,n))}jr(e,n){e.forEach(r=>this.removeReference(r,n))}Hr(e){const n=new dt(new Tn([])),r=new rs(n,e),s=new rs(n,e+1),i=[];return this.Kr.forEachInRange([r,s],o=>{this.zr(o),i.push(o.key)}),i}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const n=new dt(new Tn([])),r=new rs(n,e),s=new rs(n,e+1);let i=on();return this.Kr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new rs(e,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class rs{constructor(e,n){this.key=e,this.Zr=n}static Ur(e,n){return dt.comparator(e.key,n.key)||Wt(e.Zr,n.Zr)}static Wr(e,n){return Wt(e.Zr,n.Zr)||dt.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $ve{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new Rn(rs.Ur)}checkEmpty(e){return ye.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new CP(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Xr=this.Xr.add(new rs(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ye.resolve(o)}lookupMutationBatch(e,n){return ye.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ti(r),i=s<0?0:s;return ye.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ye.resolve(this.mutationQueue.length===0?Du:this.nr-1)}getAllMutationBatches(e){return ye.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new rs(n,0),s=new rs(n,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([r,s],o=>{const l=this.ei(o.Zr);i.push(l)}),ye.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Rn(Wt);return n.forEach(s=>{const i=new rs(s,0),o=new rs(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([i,o],l=>{r=r.add(l.Zr)})}),ye.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;dt.isDocumentKey(i)||(i=i.child(""));const o=new rs(new dt(i),0);let l=new Rn(Wt);return this.Xr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Zr)),!0)},o),ye.resolve(this.ni(l))}ni(e){const n=[];return e.forEach(r=>{const s=this.ei(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){It(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return ye.forEach(n.mutations,s=>{const i=new rs(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,n){const r=new rs(n,0),s=this.Xr.firstAfterOrEqual(r);return ye.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ye.resolve()}ri(e,n){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const n=this.ti(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uve{constructor(e){this.ii=e,this.docs=function(){return new lr(dt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ye.resolve(r?r.document.mutableCopy():Tr.newInvalidDocument(n))}getEntries(e,n){let r=Vi();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Tr.newInvalidDocument(s))}),ye.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Vi();const o=n.path,l=new dt(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||fP(t9(d),r)<=0||(s.has(d.key)||Xg(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ye.resolve(i)}getAllFromCollectionGroup(e,n,r,s){_t(9500)}si(e,n){return ye.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Bve(this)}getSize(e){return ye.resolve(this.size)}}class Bve extends y8{constructor(e){super(),this.Br=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Br.addEntry(e,s)):this.Br.removeEntry(r)}),ye.waitFor(n)}getFromCache(e,n){return this.Br.getEntry(e,n)}getAllFromCache(e,n){return this.Br.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zve{constructor(e){this.persistence=e,this.oi=new vl(n=>Zu(n),Kg),this.lastRemoteSnapshotVersion=Rt.min(),this.highestTargetId=0,this._i=0,this.ai=new kP,this.targetCount=0,this.ui=nd.cr()}forEachTarget(e,n){return this.oi.forEach((r,s)=>n(s)),ye.resolve()}getLastRemoteSnapshotVersion(e){return ye.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ye.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ye.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),ye.resolve()}Tr(e){this.oi.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ui=new nd(n),this.highestTargetId=n),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,n){return this.Tr(n),this.targetCount+=1,ye.resolve()}updateTargetData(e,n){return this.Tr(n),ye.resolve()}removeTargetData(e,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,ye.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.oi.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),ye.waitFor(i).next(()=>s)}getTargetCount(e){return ye.resolve(this.targetCount)}getTargetData(e,n){const r=this.oi.get(n)||null;return ye.resolve(r)}addMatchingKeys(e,n,r){return this.ai.Gr(n,r),ye.resolve()}removeMatchingKeys(e,n,r){this.ai.jr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),ye.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ai.Hr(n),ye.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ai.Yr(n);return ye.resolve(r)}containsKey(e,n){return ye.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RP{constructor(e,n){this.ci={},this.overlays={},this.li=new oo(0),this.hi=!1,this.hi=!0,this.Pi=new Vve,this.referenceDelegate=e(this),this.Ti=new zve(this),this.indexManager=new Ive,this.remoteDocumentCache=function(s){return new Uve(s)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new o8(n),this.Ei=new Fve(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Ove,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ci[e.toKey()];return r||(r=new $ve(n,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,n,r){Qe("MemoryPersistence","Starting transaction:",e);const s=new Gve(this.li.next());return this.referenceDelegate.di(),r(s).next(i=>this.referenceDelegate.Ai(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ri(e,n){return ye.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,n)))}}class Gve extends r9{constructor(e){super(),this.currentSequenceNumber=e}}class Mb{constructor(e){this.persistence=e,this.Vi=new kP,this.mi=null}static fi(e){return new Mb(e)}get gi(){if(this.mi)return this.mi;throw _t(60996)}addReference(e,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),ye.resolve()}removeReference(e,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),ye.resolve()}markPotentiallyOrphaned(e,n){return this.gi.add(n.toString()),ye.resolve()}removeTarget(e,n){this.Vi.Hr(n.targetId).forEach(s=>this.gi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.gi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}di(){this.mi=new Set}Ai(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ye.forEach(this.gi,r=>{const s=dt.fromPath(r);return this.pi(e,s).next(i=>{i||n.removeEntry(s,Rt.min())})}).next(()=>(this.mi=null,n.apply(e)))}updateLimboDocument(e,n){return this.pi(e,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(e){return 0}pi(e,n){return ye.or([()=>ye.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ri(e,n)])}}class Vw{constructor(e,n){this.persistence=e,this.yi=new vl(r=>js(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=g8(this,n)}static fi(e,n){return new Vw(e,n)}di(){}Ai(e){return ye.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}pr(e){const n=this.Sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}yr(e,n){return ye.forEach(this.yi,(r,s)=>this.Dr(e,r,s).next(i=>i?ye.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.si(e,o=>this.Dr(e,o,n).next(l=>{l||(r++,i.removeEntry(o,Rt.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.yi.set(n,e.currentSequenceNumber),ye.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),ye.resolve()}removeReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),ye.resolve()}updateLimboDocument(e,n){return this.yi.set(n,e.currentSequenceNumber),ye.resolve()}Ii(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=av(e.data.value)),n}Dr(e,n,r){return ye.or([()=>this.persistence.Ri(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.yi.get(n);return ye.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wve{constructor(e){this.serializer=e}q(e,n,r,s){const i=new bb("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(qg)}(e),function(c){c.createObjectStore(Yp,{keyPath:nxe}),c.createObjectStore(Io,{keyPath:YM,autoIncrement:!0}).createIndex(Nu,JM,{unique:!0}),c.createObjectStore(Jh)}(e),V4(e),function(c){c.createObjectStore(cu)}(e));let o=ye.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(Qh),c.deleteObjectStore(Xh),c.deleteObjectStore(Mu)}(e),V4(e)),o=o.next(()=>function(c){const u=c.store(Mu),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:Rt.min().toTimestamp(),targetCount:0};return u.put(Nw,d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store(Io).J().next(h=>{c.deleteObjectStore(Io),c.createObjectStore(Io,{keyPath:YM,autoIncrement:!0}).createIndex(Nu,JM,{unique:!0});const f=u.store(Io),m=h.map(g=>f.put(g));return ye.waitFor(m)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(Zh,{keyPath:dxe})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.wi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(Jp)}(e),this.Si(i)))),r<7&&s>=7&&(o=o.next(()=>this.bi(i))),r<8&&s>=8&&(o=o.next(()=>this.Di(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Ci(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(Sb,{keyPath:hxe})})(e),function(c){c.createObjectStore(Cb,{keyPath:fxe})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore(Eb,{keyPath:wxe});u.createIndex(vT,bxe,{unique:!1}),u.createIndex(u9,_xe,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore(Iw,{keyPath:sxe});u.createIndex(iv,ixe),u.createIndex(o9,oxe)}(e)).next(()=>this.Fi(e,i)).next(()=>e.deleteObjectStore(cu))),r<14&&s>=14&&(o=o.next(()=>this.Mi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(gP,{keyPath:mxe,autoIncrement:!0}).createIndex(xT,pxe,{unique:!1}),c.createObjectStore(rp,{keyPath:gxe}).createIndex(l9,yxe,{unique:!1}),c.createObjectStore(sp,{keyPath:xxe}).createIndex(c9,vxe,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(rp).clear()}).next(()=>{n.objectStore(sp).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(yP,{keyPath:Sxe})})(e)})),r<18&&s>=18&&sz()&&(o=o.next(()=>{n.objectStore(rp).clear()}).next(()=>{n.objectStore(sp).clear()})),o}Si(e){let n=0;return e.store(cu).te((r,s)=>{n+=Ow(s)}).next(()=>{const r={byteSize:n};return e.store(Jp).put(yT,r)})}wi(e){const n=e.store(Yp),r=e.store(Io);return n.J().next(s=>ye.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,Du],[i.userId,i.lastAcknowledgedBatchId]);return r.J(Nu,o).next(l=>ye.forEach(l,c=>{It(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=mu(this.serializer,c);return h8(e,i.userId,u).next(()=>{})}))}))}bi(e){const n=e.store(Qh),r=e.store(cu);return e.store(Mu).get(Nw).next(s=>{const i=[];return r.te((o,l)=>{const c=new Tn(o),u=function(h){return[0,js(h)]}(c);i.push(n.get(u).next(d=>d?ye.resolve():(h=>n.put({targetId:0,path:js(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>ye.waitFor(i))})}Di(e,n){e.createObjectStore(Xp,{keyPath:uxe});const r=n.store(Xp),s=new AP,i=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return r.put({collectionId:l,parent:js(c)})}};return n.store(cu).te({ee:!0},(o,l)=>{const c=new Tn(o);return i(c.popLast())}).next(()=>n.store(Jh).te({ee:!0},([o,l,c],u)=>{const d=aa(l);return i(d.popLast())}))}Ci(e){const n=e.store(Xh);return n.te((r,s)=>{const i=Pm(s),o=a8(this.serializer,i);return n.put(o)})}Fi(e,n){const r=n.store(cu),s=[];return r.te((i,o)=>{const l=n.store(Iw),c=function(h){return h.document?new dt(Tn.fromString(h.document.name).popFirst(5)):h.noDocument?dt.fromSegments(h.noDocument.path):h.unknownDocument?dt.fromSegments(h.unknownDocument.path):_t(36783)}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(u))}).next(()=>ye.waitFor(s))}Mi(e,n){const r=n.store(Io),s=x8(this.serializer),i=new RP(Mb.fi,this.serializer.wt);return r.J().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:on();mu(this.serializer,c).keys().forEach(h=>d=d.add(h)),l.set(c.userId,d)}),ye.forEach(l,(c,u)=>{const d=new fs(u),h=jb.St(this.serializer,d),f=i.getIndexManager(d),m=Db.St(d,this.serializer,f,i.referenceDelegate);return new v8(s,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new wT(n,oo.le),c).next()})})}}function V4(t){t.createObjectStore(Qh,{keyPath:lxe}).createIndex(pP,cxe,{unique:!0}),t.createObjectStore(Xh,{keyPath:"targetId"}).createIndex(a9,axe,{unique:!0}),t.createObjectStore(Mu)}const Al="IndexedDbPersistence",FS=18e5,OS=5e3,VS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Hve="main";class jP{constructor(e,n,r,s,i,o,l,c,u,d,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.xi=i,this.window=o,this.document=l,this.Oi=u,this.Ni=d,this.Bi=h,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=f=>Promise.resolve(),!jP.C())throw new lt(Fe.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new jve(this,s),this.Ui=n+Hve,this.serializer=new o8(c),this.Ki=new hc(this.Ui,this.Bi,new Wve(this.serializer)),this.Pi=new bve,this.Ti=new Pve(this.referenceDelegate,this.serializer),this.remoteDocumentCache=x8(this.serializer),this.Ei=new wve,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,d===!1&&Ks(Al,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new lt(Fe.FAILED_PRECONDITION,VS);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new oo(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>dx(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(n=>{n||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(n=>this.isPrimary&&!n?this.Xi(e).next(()=>!1):!!n&&this.es(e).next(()=>!0))).catch(e=>{if(Wc(e))return Qe(Al,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Qe(Al,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return om(e).get(kd).next(n=>ye.resolve(this.ts(n)))}ns(e){return dx(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,FS)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Qr(n,Zh);return r.J().next(s=>{const i=this._s(s,FS),o=s.filter(l=>i.indexOf(l)===-1);return ye.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const n of e)this.Wi.removeItem(this.us(n.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?ye.resolve(!0):om(e).get(kd).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,OS)&&!this.cs(n.ownerId)){if(this.ts(n)&&this.networkEnabled)return!0;if(!this.ts(n)){if(!n.allowTabSynchronization)throw new lt(Fe.FAILED_PRECONDITION,VS);return!1}}return!(!this.networkEnabled||!this.inForeground)||dx(e).J().next(r=>this._s(r,OS).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Qe(Al,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[qg,Zh],e=>{const n=new wT(e,oo.le);return this.Xi(n).next(()=>this.ns(n))}),this.Ki.close(),this.Ts()}_s(e,n){return e.filter(r=>this.ss(r.updateTimeMs,n)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>dx(e).J().next(n=>this._s(n,FS).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,n){return Db.St(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new Nve(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return jb.St(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,n,r){Qe(Al,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?Txe:c===17?m9:c===16?Exe:c===15?xP:c===14?f9:c===13?h9:c===12?Cxe:c===11?d9:void _t(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,s,i,l=>(o=new wT(l,this.li?this.li.next():oo.le),n==="readwrite-primary"?this.Yi(o).next(c=>!!c||this.Zi(o)).next(c=>{if(!c)throw Ks(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new lt(Fe.FAILED_PRECONDITION,n9);return r(o)}).next(c=>this.es(o).next(()=>c)):this.Es(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Es(e){return om(e).get(kd).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,OS)&&!this.cs(n.ownerId)&&!this.ts(n)&&!(this.Ni||this.allowTabSynchronization&&n.allowTabSynchronization))throw new lt(Fe.FAILED_PRECONDITION,VS)})}es(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return om(e).put(kd,n)}static C(){return hc.C()}Xi(e){const n=om(e);return n.get(kd).next(r=>this.ts(r)?(Qe(Al,"Releasing primary lease."),n.delete(kd)):ye.resolve())}ss(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Ks(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const n=/(?:Version|Mobile)\/1[456]/;rz()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var n;try{const r=((n=this.Wi)===null||n===void 0?void 0:n.getItem(this.us(e)))!==null;return Qe(Al,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ks(Al,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Ks("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function om(t){return Qr(t,qg)}function dx(t){return Qr(t,Zh)}function qve(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class DP{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ds=r,this.As=s}static Rs(e,n){let r=on(),s=on();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new DP(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kve{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class w8{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return rz()?8:s9(Jr())>0?6:4}()}initialize(e,n){this.ys=e,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ws(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Ss(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new Kve;return this.bs(e,n,o).next(l=>{if(i.result=l,this.fs)return this.Ds(e,n,o,l.size)})}).next(()=>i.result)}Ds(e,n,r,s){return r.documentReadCount<this.gs?(zd()<=dn.DEBUG&&Qe("QueryEngine","SDK will not create cache indexes for query:",Gd(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ye.resolve()):(zd()<=dn.DEBUG&&Qe("QueryEngine","Query:",Gd(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ps*s?(zd()<=dn.DEBUG&&Qe("QueryEngine","The SDK decides to create cache indexes for query:",Gd(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,co(n))):ye.resolve())}ws(e,n){if(c4(n))return ye.resolve(null);let r=co(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=jw(n,null,"F"),r=co(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=on(...i);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.vs(n,l);return this.Cs(n,u,o,c.readTime)?this.ws(e,jw(n,null,"F")):this.Fs(e,u,n,c)}))})))}Ss(e,n,r,s){return c4(n)||s.isEqual(Rt.min())?ye.resolve(null):this.ys.getDocuments(e,r).next(i=>{const o=this.vs(n,i);return this.Cs(n,o,r,s)?ye.resolve(null):(zd()<=dn.DEBUG&&Qe("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Gd(n)),this.Fs(e,o,n,Yye(s,Hp)).next(l=>l))})}vs(e,n){let r=new Rn(D9(e));return n.forEach((s,i)=>{Xg(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}bs(e,n,r){return zd()<=dn.DEBUG&&Qe("QueryEngine","Using full collection scan to execute query:",Gd(n)),this.ys.getDocumentsMatchingQuery(e,n,qi.min(),r)}Fs(e,n,r,s){return this.ys.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const MP="LocalStore",Yve=3e8;class Jve{constructor(e,n,r,s){this.persistence=e,this.Ms=n,this.serializer=s,this.xs=new lr(Wt),this.Os=new vl(i=>Zu(i),Kg),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new v8(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.xs))}}function b8(t,e,n,r){return new Jve(t,e,n,r)}async function _8(t,e){const n=Xt(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=on();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({ks:u,removedBatchIds:o,addedBatchIds:l}))})})}function Xve(t,e){const n=Xt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Bs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const h=u.batch,f=h.keys();let m=ye.resolve();return f.forEach(g=>{m=m.next(()=>d.getEntry(c,g)).next(x=>{const v=u.docVersions.get(g);It(v!==null,48541),x.version.compareTo(v)<0&&(h.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),d.addEntry(x)))})}),m.next(()=>l.mutationQueue.removeMutationBatch(c,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=on();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function S8(t){const e=Xt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ti.getLastRemoteSnapshotVersion(n))}function Qve(t,e){const n=Xt(t),r=e.snapshotVersion;let s=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Bs.newChangeBuffer({trackRemovals:!0});s=n.xs;const l=[];e.targetChanges.forEach((d,h)=>{const f=s.get(h);if(!f)return;l.push(n.Ti.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.Ti.addMatchingKeys(i,d.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(zr.EMPTY_BYTE_STRING,Rt.min()).withLastLimboFreeSnapshotVersion(Rt.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),s=s.insert(h,m),function(x,v,w){return x.resumeToken.approximateByteSize()===0||v.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=Yve?!0:w.addedDocuments.size+w.modifiedDocuments.size+w.removedDocuments.size>0}(f,m,d)&&l.push(n.Ti.updateTargetData(i,m))});let c=Vi(),u=on();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(Zve(i,o,e.documentUpdates).next(d=>{c=d.qs,u=d.Qs})),!r.isEqual(Rt.min())){const d=n.Ti.getLastRemoteSnapshotVersion(i).next(h=>n.Ti.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return ye.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.xs=s,i))}function Zve(t,e,n){let r=on(),s=on();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Vi();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(Rt.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Qe(MP,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{qs:o,Qs:s}})}function ewe(t,e){const n=Xt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=Du),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function twe(t,e){const n=Xt(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ti.getTargetData(r,e).next(i=>i?(s=i,ye.resolve(s)):n.Ti.allocateTargetId(r).next(o=>(s=new Ga(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ti.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.xs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.xs=n.xs.insert(r.targetId,r),n.Os.set(e,r.targetId)),r})}async function DT(t,e,n){const r=Xt(t),s=r.xs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Wc(o))throw o;Qe(MP,`Failed to update sequence numbers for target ${e}: ${o}`)}r.xs=r.xs.remove(e),r.Os.delete(s.target)}function $4(t,e,n){const r=Xt(t);let s=Rt.min(),i=on();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const h=Xt(c),f=h.Os.get(d);return f!==void 0?ye.resolve(h.xs.get(f)):h.Ti.getTargetData(u,d)}(r,o,co(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,e,n?s:Rt.min(),n?i:on())).next(l=>(nwe(r,Uxe(e),l),{documents:l,$s:i})))}function nwe(t,e,n){let r=t.Ns.get(e)||Rt.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ns.set(e,r)}class U4{constructor(){this.activeTargetIds=qxe()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class C8{constructor(){this.xo=new U4,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,n,r){this.Oo[e]=n}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new U4,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rwe{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const B4="ConnectivityMonitor";class z4{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Qe(B4,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Qe(B4,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let hx=null;function MT(){return hx===null?hx=function(){return 268435456+Math.round(2147483648*Math.random())}():hx++,"0x"+hx.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $S="RestConnection",swe={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class iwe{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+e.host,this.Wo=`projects/${r}/databases/${s}`,this.Go=this.databaseId.database===Pw?`project_id=${r}`:`project_id=${r}&database_id=${s}`}zo(e,n,r,s,i){const o=MT(),l=this.jo(e,n.toUriEncodedString());Qe($S,`Sending RPC '${e}' ${o}:`,l,r);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,s,i);const{host:u}=new URL(l),d=Uc(u);return this.Jo(e,l,c,r,d).then(h=>(Qe($S,`Received RPC '${e}' ${o}: `,h),h),h=>{throw Xu($S,`RPC '${e}' ${o} failed with error: `,h,"url: ",l,"request:",r),h})}Yo(e,n,r,s,i,o){return this.zo(e,n,r,s,i)}Ho(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Tf}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}jo(e,n){const r=swe[e];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class owe{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ts="WebChannelConnection";class awe extends iwe{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=MT();return new Promise((l,c)=>{const u=new Wz;u.setWithCredentials(!0),u.listenOnce(Hz.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case nv.NO_ERROR:const h=u.getResponseJson();Qe(Ts,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),l(h);break;case nv.TIMEOUT:Qe(Ts,`RPC '${e}' ${o} timed out`),c(new lt(Fe.DEADLINE_EXCEEDED,"Request time out"));break;case nv.HTTP_ERROR:const f=u.getStatus();if(Qe(Ts,`RPC '${e}' ${o} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const x=function(w){const _=w.toLowerCase().replace(/_/g,"-");return Object.values(Fe).indexOf(_)>=0?_:Fe.UNKNOWN}(g.status);c(new lt(x,g.message))}else c(new lt(Fe.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new lt(Fe.UNAVAILABLE,"Connection failed."));break;default:_t(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Qe(Ts,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);Qe(Ts,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",d,r,15)})}T_(e,n,r){const s=MT(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=Yz(),l=Kz(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");Qe(Ts,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=o.createWebChannel(d,c);let f=!1,m=!1;const g=new owe({Zo:v=>{m?Qe(Ts,`Not sending because RPC '${e}' stream ${s} is closed:`,v):(f||(Qe(Ts,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),Qe(Ts,`RPC '${e}' stream ${s} sending:`,v),h.send(v))},Xo:()=>h.close()}),x=(v,w,_)=>{v.listen(w,C=>{try{_(C)}catch(T){setTimeout(()=>{throw T},0)}})};return x(h,Tm.EventType.OPEN,()=>{m||(Qe(Ts,`RPC '${e}' stream ${s} transport opened.`),g.__())}),x(h,Tm.EventType.CLOSE,()=>{m||(m=!0,Qe(Ts,`RPC '${e}' stream ${s} transport closed`),g.u_())}),x(h,Tm.EventType.ERROR,v=>{m||(m=!0,Xu(Ts,`RPC '${e}' stream ${s} transport errored. Name:`,v.name,"Message:",v.message),g.u_(new lt(Fe.UNAVAILABLE,"The operation could not be completed")))}),x(h,Tm.EventType.MESSAGE,v=>{var w;if(!m){const _=v.data[0];It(!!_,16349);const C=_,T=(C==null?void 0:C.error)||((w=C[0])===null||w===void 0?void 0:w.error);if(T){Qe(Ts,`RPC '${e}' stream ${s} received error:`,T);const R=T.status;let A=function(N){const k=Mr[N];if(k!==void 0)return H9(k)}(R),E=T.message;A===void 0&&(A=Fe.INTERNAL,E="Unknown error status: "+R+" with message "+T.message),m=!0,g.u_(new lt(A,E)),h.close()}else Qe(Ts,`RPC '${e}' stream ${s} received:`,_),g.c_(_)}}),x(l,qz.STAT_EVENT,v=>{v.stat===mT.PROXY?Qe(Ts,`RPC '${e}' stream ${s} detected buffering proxy`):v.stat===mT.NOPROXY&&Qe(Ts,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.a_()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lwe(){return typeof window<"u"?window:null}function hv(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lb(t){return new cve(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E8{constructor(e,n,r=1e3,s=1.5,i=6e4){this.xi=e,this.timerId=n,this.I_=r,this.E_=s,this.d_=i,this.A_=0,this.R_=null,this.V_=Date.now(),this.reset()}reset(){this.A_=0}m_(){this.A_=this.d_}f_(e){this.cancel();const n=Math.floor(this.A_+this.g_()),r=Math.max(0,Date.now()-this.V_),s=Math.max(0,n-r);s>0&&Qe("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.A_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.R_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.V_=Date.now(),e())),this.A_*=this.E_,this.A_<this.I_&&(this.A_=this.I_),this.A_>this.d_&&(this.A_=this.d_)}p_(){this.R_!==null&&(this.R_.skipDelay(),this.R_=null)}cancel(){this.R_!==null&&(this.R_.cancel(),this.R_=null)}g_(){return(Math.random()-.5)*this.A_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const G4="PersistentStream";class T8{constructor(e,n,r,s,i,o,l,c){this.xi=e,this.y_=r,this.w_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.S_=0,this.b_=null,this.D_=null,this.stream=null,this.v_=0,this.C_=new E8(e,n)}F_(){return this.state===1||this.state===5||this.M_()}M_(){return this.state===2||this.state===3}start(){this.v_=0,this.state!==4?this.auth():this.x_()}async stop(){this.F_()&&await this.close(0)}O_(){this.state=0,this.C_.reset()}N_(){this.M_()&&this.b_===null&&(this.b_=this.xi.enqueueAfterDelay(this.y_,6e4,()=>this.B_()))}L_(e){this.k_(),this.stream.send(e)}async B_(){if(this.M_())return this.close(0)}k_(){this.b_&&(this.b_.cancel(),this.b_=null)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}async close(e,n){this.k_(),this.q_(),this.C_.cancel(),this.S_++,e!==4?this.C_.reset():n&&n.code===Fe.RESOURCE_EXHAUSTED?(Ks(n.toString()),Ks("Using maximum backoff delay to prevent overloading the backend."),this.C_.m_()):n&&n.code===Fe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Q_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(n)}Q_(){}auth(){this.state=1;const e=this.U_(this.S_),n=this.S_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.S_===n&&this.K_(r,s)},r=>{e(()=>{const s=new lt(Fe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.W_(s)})})}K_(e,n){const r=this.U_(this.S_);this.stream=this.G_(e,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.D_=this.xi.enqueueAfterDelay(this.w_,1e4,()=>(this.M_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{r(()=>this.W_(s))}),this.stream.onMessage(s=>{r(()=>++this.v_==1?this.z_(s):this.onNext(s))})}x_(){this.state=5,this.C_.f_(async()=>{this.state=0,this.start()})}W_(e){return Qe(G4,`close with error: ${e}`),this.stream=null,this.close(4,e)}U_(e){return n=>{this.xi.enqueueAndForget(()=>this.S_===e?n():(Qe(G4,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class cwe extends T8{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}G_(e,n){return this.connection.T_("Listen",e,n)}z_(e){return this.onNext(e)}onNext(e){this.C_.reset();const n=hve(this.serializer,e),r=function(i){if(!("targetChange"in i))return Rt.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?Rt.min():o.readTime?Xs(o.readTime):Rt.min()}(e);return this.listener.j_(n,r)}H_(e){const n={};n.database=PT(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=kw(c)?{documents:e8(i,c)}:{query:t8(i,c).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=Y9(i,o.resumeToken);const u=IT(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(Rt.min())>0){l.readTime=af(i,o.snapshotVersion.toTimestamp());const u=IT(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=mve(this.serializer,e);r&&(n.labels=r),this.L_(n)}J_(e){const n={};n.database=PT(this.serializer),n.removeTarget=e,this.L_(n)}}class uwe extends T8{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.v_>0}start(){this.lastStreamToken=void 0,super.start()}Q_(){this.Y_&&this.Z_([])}G_(e,n){return this.connection.T_("Write",e,n)}z_(e){return It(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,It(!e.writeResults||e.writeResults.length===0,55816),this.listener.X_()}onNext(e){It(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.C_.reset();const n=fve(e.writeResults,e.commitTime),r=Xs(e.commitTime);return this.listener.ea(r,n)}ta(){const e={};e.database=PT(this.serializer),this.L_(e)}Z_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Mw(this.serializer,r))};this.L_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dwe{}class hwe extends dwe{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.na=!1}ra(){if(this.na)throw new lt(Fe.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,n,r,s){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.zo(e,NT(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new lt(Fe.UNKNOWN,i.toString())})}Yo(e,n,r,s,i){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,NT(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===Fe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new lt(Fe.UNKNOWN,o.toString())})}terminate(){this.na=!0,this.connection.terminate()}}class fwe{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.ia=0,this.sa=null,this.oa=!0}_a(){this.ia===0&&(this.aa("Unknown"),this.sa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.sa=null,this.ua("Backend didn't respond within 10 seconds."),this.aa("Offline"),Promise.resolve())))}ca(e){this.state==="Online"?this.aa("Unknown"):(this.ia++,this.ia>=1&&(this.la(),this.ua(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.aa("Offline")))}set(e){this.la(),this.ia=0,e==="Online"&&(this.oa=!1),this.aa(e)}aa(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ua(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.oa?(Ks(n),this.oa=!1):Qe("OnlineStateTracker",n)}la(){this.sa!==null&&(this.sa.cancel(),this.sa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rd="RemoteStore";class mwe{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.ha=[],this.Pa=new Map,this.Ta=new Set,this.Ia=[],this.Ea=i,this.Ea.No(o=>{r.enqueueAndForget(async()=>{fd(this)&&(Qe(rd,"Restarting streams for network reachability change."),await async function(c){const u=Xt(c);u.Ta.add(4),await Zg(u),u.da.set("Unknown"),u.Ta.delete(4),await Fb(u)}(this))})}),this.da=new fwe(r,s)}}async function Fb(t){if(fd(t))for(const e of t.Ia)await e(!0)}async function Zg(t){for(const e of t.Ia)await e(!1)}function I8(t,e){const n=Xt(t);n.Pa.has(e.targetId)||(n.Pa.set(e.targetId,e),VP(n)?OP(n):Nf(n).M_()&&FP(n,e))}function LP(t,e){const n=Xt(t),r=Nf(n);n.Pa.delete(e),r.M_()&&N8(n,e),n.Pa.size===0&&(r.M_()?r.N_():fd(n)&&n.da.set("Unknown"))}function FP(t,e){if(t.Aa.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(Rt.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Nf(t).H_(e)}function N8(t,e){t.Aa.Ke(e),Nf(t).J_(e)}function OP(t){t.Aa=new ive({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Pa.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),Nf(t).start(),t.da._a()}function VP(t){return fd(t)&&!Nf(t).F_()&&t.Pa.size>0}function fd(t){return Xt(t).Ta.size===0}function P8(t){t.Aa=void 0}async function pwe(t){t.da.set("Online")}async function gwe(t){t.Pa.forEach((e,n)=>{FP(t,e)})}async function ywe(t,e){P8(t),VP(t)?(t.da.ca(e),OP(t)):t.da.set("Unknown")}async function xwe(t,e,n){if(t.da.set("Online"),e instanceof K9&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Pa.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Pa.delete(l),s.Aa.removeTarget(l))}(t,e)}catch(r){Qe(rd,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await $w(t,r)}else if(e instanceof uv?t.Aa.Xe(e):e instanceof q9?t.Aa.ot(e):t.Aa.nt(e),!n.isEqual(Rt.min()))try{const r=await S8(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Aa.It(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.Pa.get(u);d&&i.Pa.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.Pa.get(c);if(!d)return;i.Pa.set(c,d.withResumeToken(zr.EMPTY_BYTE_STRING,d.snapshotVersion)),N8(i,c);const h=new Ga(d.target,c,u,d.sequenceNumber);FP(i,h)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Qe(rd,"Failed to raise snapshot:",r),await $w(t,r)}}async function $w(t,e,n){if(!Wc(e))throw e;t.Ta.add(1),await Zg(t),t.da.set("Offline"),n||(n=()=>S8(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Qe(rd,"Retrying IndexedDB access"),await n(),t.Ta.delete(1),await Fb(t)})}function A8(t,e){return e().catch(n=>$w(t,n,e))}async function ey(t){const e=Xt(t),n=Tc(e);let r=e.ha.length>0?e.ha[e.ha.length-1].batchId:Du;for(;vwe(e);)try{const s=await ewe(e.localStore,r);if(s===null){e.ha.length===0&&n.N_();break}r=s.batchId,wwe(e,s)}catch(s){await $w(e,s)}k8(e)&&R8(e)}function vwe(t){return fd(t)&&t.ha.length<10}function wwe(t,e){t.ha.push(e);const n=Tc(t);n.M_()&&n.Y_&&n.Z_(e.mutations)}function k8(t){return fd(t)&&!Tc(t).F_()&&t.ha.length>0}function R8(t){Tc(t).start()}async function bwe(t){Tc(t).ta()}async function _we(t){const e=Tc(t);for(const n of t.ha)e.Z_(n.mutations)}async function Swe(t,e,n){const r=t.ha.shift(),s=EP.from(r,e,n);await A8(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await ey(t)}async function Cwe(t,e){e&&Tc(t).Y_&&await async function(r,s){if(function(o){return rve(o)&&o!==Fe.ABORTED}(s.code)){const i=r.ha.shift();Tc(r).O_(),await A8(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await ey(r)}}(t,e),k8(t)&&R8(t)}async function W4(t,e){const n=Xt(t);n.asyncQueue.verifyOperationInProgress(),Qe(rd,"RemoteStore received new credentials");const r=fd(n);n.Ta.add(3),await Zg(n),r&&n.da.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ta.delete(3),await Fb(n)}async function Ewe(t,e){const n=Xt(t);e?(n.Ta.delete(2),await Fb(n)):e||(n.Ta.add(2),await Zg(n),n.da.set("Unknown"))}function Nf(t){return t.Ra||(t.Ra=function(n,r,s){const i=Xt(n);return i.ra(),new cwe(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:pwe.bind(null,t),n_:gwe.bind(null,t),i_:ywe.bind(null,t),j_:xwe.bind(null,t)}),t.Ia.push(async e=>{e?(t.Ra.O_(),VP(t)?OP(t):t.da.set("Unknown")):(await t.Ra.stop(),P8(t))})),t.Ra}function Tc(t){return t.Va||(t.Va=function(n,r,s){const i=Xt(n);return i.ra(),new uwe(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:bwe.bind(null,t),i_:Cwe.bind(null,t),X_:_we.bind(null,t),ea:Swe.bind(null,t)}),t.Ia.push(async e=>{e?(t.Va.O_(),await ey(t)):(await t.Va.stop(),t.ha.length>0&&(Qe(rd,`Stopping write stream with ${t.ha.length} pending writes`),t.ha=[]))})),t.Va}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $P{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new ya,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new $P(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new lt(Fe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function UP(t,e){if(Ks("AsyncQueue",`${e}: ${t}`),Wc(t))return new lt(Fe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ah{static emptySet(e){return new Ah(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||dt.comparator(n.key,r.key):(n,r)=>dt.comparator(n.key,r.key),this.keyedMap=Im(),this.sortedSet=new lr(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Ah)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Ah;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class H4{constructor(){this.ma=new lr(dt.comparator)}track(e){const n=e.doc.key,r=this.ma.get(n);r?e.type!==0&&r.type===3?this.ma=this.ma.insert(n,e):e.type===3&&r.type!==1?this.ma=this.ma.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ma=this.ma.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ma=this.ma.remove(n):e.type===1&&r.type===2?this.ma=this.ma.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):_t(63341,{Vt:e,fa:r}):this.ma=this.ma.insert(n,e)}ga(){const e=[];return this.ma.inorderTraversal((n,r)=>{e.push(r)}),e}}class lf{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new lf(e,n,Ah.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Nb(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Twe{constructor(){this.pa=void 0,this.ya=[]}wa(){return this.ya.some(e=>e.Sa())}}class Iwe{constructor(){this.queries=q4(),this.onlineState="Unknown",this.ba=new Set}terminate(){(function(n,r){const s=Xt(n),i=s.queries;s.queries=q4(),i.forEach((o,l)=>{for(const c of l.ya)c.onError(r)})})(this,new lt(Fe.ABORTED,"Firestore shutting down"))}}function q4(){return new vl(t=>j9(t),Nb)}async function BP(t,e){const n=Xt(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.wa()&&e.Sa()&&(r=2):(i=new Twe,r=e.Sa()?0:1);try{switch(r){case 0:i.pa=await n.onListen(s,!0);break;case 1:i.pa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=UP(o,`Initialization of query '${Gd(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.ya.push(e),e.Da(n.onlineState),i.pa&&e.va(i.pa)&&GP(n)}async function zP(t,e){const n=Xt(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ya.indexOf(e);o>=0&&(i.ya.splice(o,1),i.ya.length===0?s=e.Sa()?0:1:!i.wa()&&e.Sa()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Nwe(t,e){const n=Xt(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.ya)l.va(s)&&(r=!0);o.pa=s}}r&&GP(n)}function Pwe(t,e,n){const r=Xt(t),s=r.queries.get(e);if(s)for(const i of s.ya)i.onError(n);r.queries.delete(e)}function GP(t){t.ba.forEach(e=>{e.next()})}var LT,K4;(K4=LT||(LT={})).Ca="default",K4.Cache="cache";class WP{constructor(e,n,r){this.query=e,this.Fa=n,this.Ma=!1,this.xa=null,this.onlineState="Unknown",this.options=r||{}}va(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new lf(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Ma?this.Oa(e)&&(this.Fa.next(e),n=!0):this.Na(e,this.onlineState)&&(this.Ba(e),n=!0),this.xa=e,n}onError(e){this.Fa.error(e)}Da(e){this.onlineState=e;let n=!1;return this.xa&&!this.Ma&&this.Na(this.xa,e)&&(this.Ba(this.xa),n=!0),n}Na(e,n){if(!e.fromCache||!this.Sa())return!0;const r=n!=="Offline";return(!this.options.La||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Oa(e){if(e.docChanges.length>0)return!0;const n=this.xa&&this.xa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Ba(e){e=lf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Ma=!0,this.Fa.next(e)}Sa(){return this.options.source!==LT.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j8{constructor(e){this.key=e}}class D8{constructor(e){this.key=e}}class Awe{constructor(e,n){this.query=e,this.Ga=n,this.za=null,this.hasCachedResults=!1,this.current=!1,this.ja=on(),this.mutatedKeys=on(),this.Ha=D9(e),this.Ja=new Ah(this.Ha)}get Ya(){return this.Ga}Za(e,n){const r=n?n.Xa:new H4,s=n?n.Ja:this.Ja;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const f=s.get(d),m=Xg(this.query,h)?h:null,g=!!f&&this.mutatedKeys.has(f.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let v=!1;f&&m?f.data.isEqual(m.data)?g!==x&&(r.track({type:3,doc:m}),v=!0):this.eu(f,m)||(r.track({type:2,doc:m}),v=!0,(c&&this.Ha(m,c)>0||u&&this.Ha(m,u)<0)&&(l=!0)):!f&&m?(r.track({type:0,doc:m}),v=!0):f&&!m&&(r.track({type:1,doc:f}),v=!0,(c||u)&&(l=!0)),v&&(m?(o=o.add(m),i=x?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ja:o,Xa:r,Cs:l,mutatedKeys:i}}eu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ja;this.Ja=e.Ja,this.mutatedKeys=e.mutatedKeys;const o=e.Xa.ga();o.sort((d,h)=>function(m,g){const x=v=>{switch(v){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return _t(20277,{Vt:v})}};return x(m)-x(g)}(d.type,h.type)||this.Ha(d.doc,h.doc)),this.tu(r),s=s!=null&&s;const l=n&&!s?this.nu():[],c=this.ja.size===0&&this.current&&!s?1:0,u=c!==this.za;return this.za=c,o.length!==0||u?{snapshot:new lf(this.query,e.Ja,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ru:l}:{ru:l}}Da(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ja:this.Ja,Xa:new H4,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ru:[]}}iu(e){return!this.Ga.has(e)&&!!this.Ja.has(e)&&!this.Ja.get(e).hasLocalMutations}tu(e){e&&(e.addedDocuments.forEach(n=>this.Ga=this.Ga.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ga=this.Ga.delete(n)),this.current=e.current)}nu(){if(!this.current)return[];const e=this.ja;this.ja=on(),this.Ja.forEach(r=>{this.iu(r.key)&&(this.ja=this.ja.add(r.key))});const n=[];return e.forEach(r=>{this.ja.has(r)||n.push(new D8(r))}),this.ja.forEach(r=>{e.has(r)||n.push(new j8(r))}),n}su(e){this.Ga=e.$s,this.ja=on();const n=this.Za(e.documents);return this.applyChanges(n,!0)}ou(){return lf.fromInitialDocuments(this.query,this.Ja,this.mutatedKeys,this.za===0,this.hasCachedResults)}}const HP="SyncEngine";class kwe{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Rwe{constructor(e){this.key=e,this._u=!1}}class jwe{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.au={},this.uu=new vl(l=>j9(l),Nb),this.cu=new Map,this.lu=new Set,this.hu=new lr(dt.comparator),this.Pu=new Map,this.Tu=new kP,this.Iu={},this.Eu=new Map,this.du=nd.lr(),this.onlineState="Unknown",this.Au=void 0}get isPrimaryClient(){return this.Au===!0}}async function Dwe(t,e,n=!0){const r=$8(t);let s;const i=r.uu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ou()):s=await M8(r,e,n,!0),s}async function Mwe(t,e){const n=$8(t);await M8(n,e,!0,!1)}async function M8(t,e,n,r){const s=await twe(t.localStore,co(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await Lwe(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&I8(t.remoteStore,s),l}async function Lwe(t,e,n,r,s){t.Ru=(h,f,m)=>async function(x,v,w,_){let C=v.view.Za(w);C.Cs&&(C=await $4(x.localStore,v.query,!1).then(({documents:E})=>v.view.Za(E,C)));const T=_&&_.targetChanges.get(v.targetId),R=_&&_.targetMismatches.get(v.targetId)!=null,A=v.view.applyChanges(C,x.isPrimaryClient,T,R);return J4(x,v.targetId,A.ru),A.snapshot}(t,h,f,m);const i=await $4(t.localStore,e,!0),o=new Awe(e,i.$s),l=o.Za(i.documents),c=Qg.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);J4(t,n,u.ru);const d=new kwe(e,n,o);return t.uu.set(e,d),t.cu.has(n)?t.cu.get(n).push(e):t.cu.set(n,[e]),u.snapshot}async function Fwe(t,e,n){const r=Xt(t),s=r.uu.get(e),i=r.cu.get(s.targetId);if(i.length>1)return r.cu.set(s.targetId,i.filter(o=>!Nb(o,e))),void r.uu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await DT(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&LP(r.remoteStore,s.targetId),FT(r,s.targetId)}).catch(hd)):(FT(r,s.targetId),await DT(r.localStore,s.targetId,!0))}async function Owe(t,e){const n=Xt(t),r=n.uu.get(e),s=n.cu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),LP(n.remoteStore,r.targetId))}async function Vwe(t,e,n){const r=U8(t);try{const s=await function(o,l){const c=Xt(o),u=gr.now(),d=l.reduce((m,g)=>m.add(g.key),on());let h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Vi(),x=on();return c.Bs.getEntries(m,d).next(v=>{g=v,g.forEach((w,_)=>{_.isValidDocument()||(x=x.add(w))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(v=>{h=v;const w=[];for(const _ of l){const C=tve(_,h.get(_.key).overlayedDocument);C!=null&&w.push(new wl(_.key,C,C9(C.value.mapValue),Ys.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,w,l)}).next(v=>{f=v;const w=v.applyToLocalDocumentSet(h,x);return c.documentOverlayCache.saveOverlays(m,v.batchId,w)})}).then(()=>({batchId:f.batchId,changes:L9(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Iu[o.currentUser.toKey()];u||(u=new lr(Wt)),u=u.insert(l,c),o.Iu[o.currentUser.toKey()]=u}(r,s.batchId,n),await ty(r,s.changes),await ey(r.remoteStore)}catch(s){const i=UP(s,"Failed to persist write");n.reject(i)}}async function L8(t,e){const n=Xt(t);try{const r=await Qve(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Pu.get(i);o&&(It(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o._u=!0:s.modifiedDocuments.size>0?It(o._u,14607):s.removedDocuments.size>0&&(It(o._u,42227),o._u=!1))}),await ty(n,r,e)}catch(r){await hd(r)}}function Y4(t,e,n){const r=Xt(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.uu.forEach((i,o)=>{const l=o.view.Da(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=Xt(o);c.onlineState=l;let u=!1;c.queries.forEach((d,h)=>{for(const f of h.ya)f.Da(l)&&(u=!0)}),u&&GP(c)}(r.eventManager,e),s.length&&r.au.j_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function $we(t,e,n){const r=Xt(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Pu.get(e),i=s&&s.key;if(i){let o=new lr(dt.comparator);o=o.insert(i,Tr.newNoDocument(i,Rt.min()));const l=on().add(i),c=new Rb(Rt.min(),new Map,new lr(Wt),o,l);await L8(r,c),r.hu=r.hu.remove(i),r.Pu.delete(e),qP(r)}else await DT(r.localStore,e,!1).then(()=>FT(r,e,n)).catch(hd)}async function Uwe(t,e){const n=Xt(t),r=e.batch.batchId;try{const s=await Xve(n.localStore,e);O8(n,r,null),F8(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await ty(n,s)}catch(s){await hd(s)}}async function Bwe(t,e,n){const r=Xt(t);try{const s=await function(o,l){const c=Xt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(h=>(It(h!==null,37113),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);O8(r,e,n),F8(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await ty(r,s)}catch(s){await hd(s)}}function F8(t,e){(t.Eu.get(e)||[]).forEach(n=>{n.resolve()}),t.Eu.delete(e)}function O8(t,e,n){const r=Xt(t);let s=r.Iu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Iu[r.currentUser.toKey()]=s}}function FT(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.cu.get(e))t.uu.delete(r),n&&t.au.Vu(r,n);t.cu.delete(e),t.isPrimaryClient&&t.Tu.Hr(e).forEach(r=>{t.Tu.containsKey(r)||V8(t,r)})}function V8(t,e){t.lu.delete(e.path.canonicalString());const n=t.hu.get(e);n!==null&&(LP(t.remoteStore,n),t.hu=t.hu.remove(e),t.Pu.delete(n),qP(t))}function J4(t,e,n){for(const r of n)r instanceof j8?(t.Tu.addReference(r.key,e),zwe(t,r)):r instanceof D8?(Qe(HP,"Document no longer in limbo: "+r.key),t.Tu.removeReference(r.key,e),t.Tu.containsKey(r.key)||V8(t,r.key)):_t(19791,{mu:r})}function zwe(t,e){const n=e.key,r=n.path.canonicalString();t.hu.get(n)||t.lu.has(r)||(Qe(HP,"New document in limbo: "+n),t.lu.add(r),qP(t))}function qP(t){for(;t.lu.size>0&&t.hu.size<t.maxConcurrentLimboResolutions;){const e=t.lu.values().next().value;t.lu.delete(e);const n=new dt(Tn.fromString(e)),r=t.du.next();t.Pu.set(r,new Rwe(n)),t.hu=t.hu.insert(n,r),I8(t.remoteStore,new Ga(co(Jg(n.path)),r,"TargetPurposeLimboResolution",oo.le))}}async function ty(t,e,n){const r=Xt(t),s=[],i=[],o=[];r.uu.isEmpty()||(r.uu.forEach((l,c)=>{o.push(r.Ru(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const h=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=DP.Rs(c.targetId,u);i.push(h)}}))}),await Promise.all(o),r.au.j_(s),await async function(c,u){const d=Xt(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ye.forEach(u,f=>ye.forEach(f.ds,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>ye.forEach(f.As,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!Wc(h))throw h;Qe(MP,"Failed to update sequence numbers: "+h)}for(const h of u){const f=h.targetId;if(!h.fromCache){const m=d.xs.get(f),g=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(g);d.xs=d.xs.insert(f,x)}}}(r.localStore,i))}async function Gwe(t,e){const n=Xt(t);if(!n.currentUser.isEqual(e)){Qe(HP,"User change. New user:",e.toKey());const r=await _8(n.localStore,e);n.currentUser=e,function(i,o){i.Eu.forEach(l=>{l.forEach(c=>{c.reject(new lt(Fe.CANCELLED,o))})}),i.Eu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await ty(n,r.ks)}}function Wwe(t,e){const n=Xt(t),r=n.Pu.get(e);if(r&&r._u)return on().add(r.key);{let s=on();const i=n.cu.get(e);if(!i)return s;for(const o of i){const l=n.uu.get(o);s=s.unionWith(l.view.Ya)}return s}}function $8(t){const e=Xt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=L8.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Wwe.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=$we.bind(null,e),e.au.j_=Nwe.bind(null,e.eventManager),e.au.Vu=Pwe.bind(null,e.eventManager),e}function U8(t){const e=Xt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Uwe.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Bwe.bind(null,e),e}class sg{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Lb(e.databaseInfo.databaseId),this.sharedClientState=this.pu(e),this.persistence=this.yu(e),await this.persistence.start(),this.localStore=this.wu(e),this.gcScheduler=this.Su(e,this.localStore),this.indexBackfillerScheduler=this.bu(e,this.localStore)}Su(e,n){return null}bu(e,n){return null}wu(e){return b8(this.persistence,new w8,e.initialUser,this.serializer)}yu(e){return new RP(Mb.fi,this.serializer)}pu(e){return new C8}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}sg.provider={build:()=>new sg};class Hwe extends sg{constructor(e){super(),this.cacheSizeBytes=e}Su(e,n){It(this.persistence.referenceDelegate instanceof Vw,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new p8(r,e.asyncQueue,n)}yu(e){const n=this.cacheSizeBytes!==void 0?Ps.withCacheSize(this.cacheSizeBytes):Ps.DEFAULT;return new RP(r=>Vw.fi(r,n),this.serializer)}}class qwe extends sg{constructor(e,n,r){super(),this.Du=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Du.initialize(this,e),await U8(this.Du.syncEngine),await ey(this.Du.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wu(e){return b8(this.persistence,new w8,e.initialUser,this.serializer)}Su(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new p8(r,e.asyncQueue,n)}bu(e,n){const r=new Zye(n,this.persistence);return new Qye(e.asyncQueue,r)}yu(e){const n=qve(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Ps.withCacheSize(this.cacheSizeBytes):Ps.DEFAULT;return new jP(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,lwe(),hv(),this.serializer,this.sharedClientState,!!this.forceOwnership)}pu(e){return new C8}}class Uw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Y4(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Gwe.bind(null,this.syncEngine),await Ewe(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Iwe}()}createDatastore(e){const n=Lb(e.databaseInfo.databaseId),r=function(i){return new awe(i)}(e.databaseInfo);return function(i,o,l,c){return new hwe(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new mwe(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>Y4(this.syncEngine,n,0),function(){return z4.C()?new z4:new rwe}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const h=new jwe(s,i,o,l,c,u);return d&&(h.Au=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=Xt(s);Qe(rd,"RemoteStore shutting down."),i.Ta.add(5),await Zg(i),i.Ea.shutdown(),i.da.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Uw.provider={build:()=>new Uw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class KP{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.vu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.vu(this.observer.error,e):Ks("Uncaught Error in snapshot listener:",e.toString()))}Cu(){this.muted=!0}vu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ic="FirestoreClient";class Kwe{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=fs.UNAUTHENTICATED,this.clientId=Zz.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Qe(Ic,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Qe(Ic,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new ya;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=UP(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function US(t,e){t.asyncQueue.verifyOperationInProgress(),Qe(Ic,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await _8(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function X4(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Ywe(t);Qe(Ic,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>W4(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>W4(e.remoteStore,s)),t._onlineComponents=e}async function Ywe(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Qe(Ic,"Using user provided OfflineComponentProvider");try{await US(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===Fe.FAILED_PRECONDITION||s.code===Fe.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;Xu("Error using user provided cache. Falling back to memory cache: "+n),await US(t,new sg)}}else Qe(Ic,"Using default OfflineComponentProvider"),await US(t,new Hwe(void 0));return t._offlineComponents}async function B8(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Qe(Ic,"Using user provided OnlineComponentProvider"),await X4(t,t._uninitializedComponentsProvider._online)):(Qe(Ic,"Using default OnlineComponentProvider"),await X4(t,new Uw))),t._onlineComponents}function Jwe(t){return B8(t).then(e=>e.syncEngine)}async function Bw(t){const e=await B8(t),n=e.eventManager;return n.onListen=Dwe.bind(null,e.syncEngine),n.onUnlisten=Fwe.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Mwe.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Owe.bind(null,e.syncEngine),n}function Xwe(t,e,n={}){const r=new ya;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new KP({next:f=>{d.Cu(),o.enqueueAndForget(()=>zP(i,h));const m=f.docs.has(l);!m&&f.fromCache?u.reject(new lt(Fe.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&c&&c.source==="server"?u.reject(new lt(Fe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new WP(Jg(l.path),d,{includeMetadataChanges:!0,La:!0});return BP(i,h)}(await Bw(t),t.asyncQueue,e,n,r)),r.promise}function Qwe(t,e,n={}){const r=new ya;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new KP({next:f=>{d.Cu(),o.enqueueAndForget(()=>zP(i,h)),f.fromCache&&c.source==="server"?u.reject(new lt(Fe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new WP(l,d,{includeMetadataChanges:!0,La:!0});return BP(i,h)}(await Bw(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z8(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q4=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G8(t,e,n){if(!n)throw new lt(Fe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Zwe(t,e,n,r){if(e===!0&&r===!0)throw new lt(Fe.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function Z4(t){if(!dt.isDocumentKey(t))throw new lt(Fe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function eL(t){if(dt.isDocumentKey(t))throw new lt(Fe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function Ob(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":_t(12329,{type:typeof t})}function gi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new lt(Fe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=Ob(t);throw new lt(Fe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function e0e(t,e){if(e<=0)throw new lt(Fe.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const W8="firestore.googleapis.com",tL=!0;class nL{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new lt(Fe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=W8,this.ssl=tL}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:tL;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=d8;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<Ave)throw new lt(Fe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Zwe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=z8((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new lt(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new lt(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new lt(Fe.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Vb{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new nL({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new lt(Fe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new lt(Fe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new nL(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new $ye;switch(r.type){case"firstParty":return new Gye(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new lt(Fe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=Q4.get(n);r&&(Qe("ComponentProvider","Removing Datastore"),Q4.delete(n),r.terminate())}(this),Promise.resolve()}}function t0e(t,e,n,r={}){var s;t=gi(t,Vb);const i=Uc(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${n}`;i&&(pb(`https://${c}`),gb("Firestore",!0)),o.host!==W8&&o.host!==c&&Xu("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},o),{host:c,ssl:i,emulatorOptions:r});if(!qu(u,l)&&(t._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=fs.MOCK_USER;else{d=tz(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new lt(Fe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new fs(f)}t._authCredentials=new Uye(new Xz(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new qc(this.firestore,e,this._query)}}class Ds{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Ds(this.firestore,e,this._key)}}class fc extends qc{constructor(e,n,r){super(e,n,Jg(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Ds(this.firestore,null,new dt(e))}withConverter(e){return new fc(this.firestore,e,this._path)}}function Jo(t,e,...n){if(t=Hn(t),G8("collection","path",e),t instanceof Vb){const r=Tn.fromString(e,...n);return eL(r),new fc(t,null,r)}{if(!(t instanceof Ds||t instanceof fc))throw new lt(Fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Tn.fromString(e,...n));return eL(r),new fc(t.firestore,null,r)}}function Ai(t,e,...n){if(t=Hn(t),arguments.length===1&&(e=Zz.newId()),G8("doc","path",e),t instanceof Vb){const r=Tn.fromString(e,...n);return Z4(r),new Ds(t,null,new dt(r))}{if(!(t instanceof Ds||t instanceof fc))throw new lt(Fe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(Tn.fromString(e,...n));return Z4(r),new Ds(t.firestore,t instanceof fc?t.converter:null,new dt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rL="AsyncQueue";class sL{constructor(e=Promise.resolve()){this.zu=[],this.ju=!1,this.Hu=[],this.Ju=null,this.Yu=!1,this.Zu=!1,this.Xu=[],this.C_=new E8(this,"async_queue_retry"),this.ec=()=>{const r=hv();r&&Qe(rL,"Visibility state changed to "+r.visibilityState),this.C_.p_()},this.tc=e;const n=hv();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.ec)}get isShuttingDown(){return this.ju}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nc(),this.rc(e)}enterRestrictedMode(e){if(!this.ju){this.ju=!0,this.Zu=e||!1;const n=hv();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.ec)}}enqueue(e){if(this.nc(),this.ju)return new Promise(()=>{});const n=new ya;return this.rc(()=>this.ju&&this.Zu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.zu.push(e),this.sc()))}async sc(){if(this.zu.length!==0){try{await this.zu[0](),this.zu.shift(),this.C_.reset()}catch(e){if(!Wc(e))throw e;Qe(rL,"Operation failed with retryable error: "+e)}this.zu.length>0&&this.C_.f_(()=>this.sc())}}rc(e){const n=this.tc.then(()=>(this.Yu=!0,e().catch(r=>{throw this.Ju=r,this.Yu=!1,Ks("INTERNAL UNHANDLED ERROR: ",iL(r)),r}).then(r=>(this.Yu=!1,r))));return this.tc=n,n}enqueueAfterDelay(e,n,r){this.nc(),this.Xu.indexOf(e)>-1&&(n=0);const s=$P.createAndSchedule(this,e,n,r,i=>this.oc(i));return this.Hu.push(s),s}nc(){this.Ju&&_t(47125,{_c:iL(this.Ju)})}verifyOperationInProgress(){}async ac(){let e;do e=this.tc,await e;while(e!==this.tc)}uc(e){for(const n of this.Hu)if(n.timerId===e)return!0;return!1}cc(e){return this.ac().then(()=>{this.Hu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Hu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.ac()})}lc(e){this.Xu.push(e)}oc(e){const n=this.Hu.indexOf(e);this.Hu.splice(n,1)}}function iL(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oL(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n0e=-1;class cl extends Vb{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new sL,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new sL(e),this._firestoreClient=void 0,await e}}}function r0e(t,e){const n=typeof t=="object"?t:yb(),r=typeof t=="string"?t:e||Pw,s=Bg(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=ZN("firestore");i&&t0e(s,...i)}return s}function $b(t){if(t._terminated)throw new lt(Fe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||H8(t),t._firestoreClient}function H8(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new Nxe(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,z8(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new Kwe(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function s0e(t,e){Xu("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return i0e(t,Uw.provider,{build:r=>new qwe(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function i0e(t,e,n){if((t=gi(t,cl))._firestoreClient||t._terminated)throw new lt(Fe.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new lt(Fe.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},H8(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new cf(zr.fromBase64String(e))}catch(n){throw new lt(Fe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new cf(zr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ub{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new lt(Fe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new mr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YP{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class JP{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new lt(Fe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new lt(Fe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Wt(this._lat,e._lat)||Wt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XP{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const o0e=/^__.*__$/;class a0e{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new wl(e,this.data,this.fieldMask,n,this.fieldTransforms):new If(e,this.data,n,this.fieldTransforms)}}class q8{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new wl(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function K8(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw _t(40011,{hc:t})}}class QP{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Pc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get hc(){return this.settings.hc}Tc(e){return new QP(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ic(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.dc(e),s}Ac(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.Pc(),s}Rc(e){return this.Tc({path:void 0,Ec:!0})}Vc(e){return zw(e,this.settings.methodName,this.settings.mc||!1,this.path,this.settings.fc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pc(){if(this.path)for(let e=0;e<this.path.length;e++)this.dc(this.path.get(e))}dc(e){if(e.length===0)throw this.Vc("Document fields must not be empty");if(K8(this.hc)&&o0e.test(e))throw this.Vc('Document fields cannot begin and end with "__"')}}class l0e{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||Lb(e)}gc(e,n,r,s=!1){return new QP({hc:e,methodName:n,fc:r,path:mr.emptyPath(),Ec:!1,mc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function ZP(t){const e=t._freezeSettings(),n=Lb(t._databaseId);return new l0e(t._databaseId,!!e.ignoreUndefinedProperties,n)}function c0e(t,e,n,r,s,i={}){const o=t.gc(i.merge||i.mergeFields?2:0,e,n,s);eA("Data must be an object, but it was:",o,r);const l=Y8(r,o);let c,u;if(i.merge)c=new di(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const f=OT(e,h,n);if(!o.contains(f))throw new lt(Fe.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);X8(d,f)||d.push(f)}c=new di(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new a0e(new Rs(l),c,u)}class Bb extends YP{_toFieldTransform(e){if(e.hc!==2)throw e.hc===1?e.Vc(`${this._methodName}() can only appear at the top level of your update data`):e.Vc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Bb}}function u0e(t,e,n,r){const s=t.gc(1,e,n);eA("Data must be an object, but it was:",s,r);const i=[],o=Rs.empty();Hc(r,(c,u)=>{const d=tA(e,c,n);u=Hn(u);const h=s.Ac(d);if(u instanceof Bb)i.push(d);else{const f=ny(u,h);f!=null&&(i.push(d),o.set(d,f))}});const l=new di(i);return new q8(o,l,s.fieldTransforms)}function d0e(t,e,n,r,s,i){const o=t.gc(1,e,n),l=[OT(e,r,n)],c=[s];if(i.length%2!=0)throw new lt(Fe.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)l.push(OT(e,i[f])),c.push(i[f+1]);const u=[],d=Rs.empty();for(let f=l.length-1;f>=0;--f)if(!X8(u,l[f])){const m=l[f];let g=c[f];g=Hn(g);const x=o.Ac(m);if(g instanceof Bb)u.push(m);else{const v=ny(g,x);v!=null&&(u.push(m),d.set(m,v))}}const h=new di(u);return new q8(d,h,o.fieldTransforms)}function h0e(t,e,n,r=!1){return ny(n,t.gc(r?4:3,e))}function ny(t,e){if(J8(t=Hn(t)))return eA("Unsupported field value:",e,t),Y8(t,e);if(t instanceof YP)return function(r,s){if(!K8(s.hc))throw s.Vc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Vc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Ec&&e.hc!==4)throw e.Vc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=ny(l,s.Rc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Hn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Kxe(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=gr.fromDate(r);return{timestampValue:af(s.serializer,i)}}if(r instanceof gr){const i=new gr(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:af(s.serializer,i)}}if(r instanceof JP)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof cf)return{bytesValue:Y9(s.serializer,r._byteString)};if(r instanceof Ds){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Vc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:NP(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof XP)return function(o,l){return{mapValue:{fields:{[wP]:{stringValue:bP},[ef]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Vc("VectorValues must only contain numeric values.");return SP(l.serializer,u)})}}}}}}(r,s);throw s.Vc(`Unsupported field value: ${Ob(r)}`)}(t,e)}function Y8(t,e){const n={};return p9(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hc(t,(r,s)=>{const i=ny(s,e.Ic(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function J8(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof gr||t instanceof JP||t instanceof cf||t instanceof Ds||t instanceof YP||t instanceof XP)}function eA(t,e,n){if(!J8(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=Ob(n);throw r==="an object"?e.Vc(t+" a custom object"):e.Vc(t+" "+r)}}function OT(t,e,n){if((e=Hn(e))instanceof Ub)return e._internalPath;if(typeof e=="string")return tA(t,e);throw zw("Field path arguments must be of type string or ",t,!1,void 0,n)}const f0e=new RegExp("[~\\*/\\[\\]]");function tA(t,e,n){if(e.search(f0e)>=0)throw zw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Ub(...e.split("."))._internalPath}catch{throw zw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function zw(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new lt(Fe.INVALID_ARGUMENT,l+t+c)}function X8(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q8{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Ds(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new m0e(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(nA("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class m0e extends Q8{data(){return super.data()}}function nA(t,e){return typeof e=="string"?tA(t,e):e instanceof Ub?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Z8(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new lt(Fe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rA{}class eG extends rA{}function VT(t,e,...n){let r=[];e instanceof rA&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof sA).length,l=i.filter(c=>c instanceof zb).length;if(o>1||o>0&&l>0)throw new lt(Fe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class zb extends eG{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new zb(e,n,r)}_apply(e){const n=this._parse(e);return tG(e._query,n),new qc(e.firestore,e.converter,TT(e._query,n))}_parse(e){const n=ZP(e.firestore);return function(i,o,l,c,u,d,h){let f;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new lt(Fe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){lL(h,d);const g=[];for(const x of h)g.push(aL(c,i,x));f={arrayValue:{values:g}}}else f=aL(c,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||lL(h,d),f=h0e(l,o,h,d==="in"||d==="not-in");return hn.create(u,d,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function $T(t,e,n){const r=e,s=nA("where",t);return zb._create(s,r,n)}class sA extends rA{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new sA(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:An.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)tG(o,c),o=TT(o,c)}(e._query,n),new qc(e.firestore,e.converter,TT(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class iA extends eG{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new iA(e,n,r)}_apply(e){return new qc(e.firestore,e.converter,jw(e._query,this._limit,this._limitType))}}function p0e(t){return e0e("limit",t),iA._create("limit",t,"F")}function aL(t,e,n){if(typeof(n=Hn(n))=="string"){if(n==="")throw new lt(Fe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!R9(e)&&n.indexOf("/")!==-1)throw new lt(Fe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(Tn.fromString(n));if(!dt.isDocumentKey(r))throw new lt(Fe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return eg(t,new dt(r))}if(n instanceof Ds)return eg(t,n._key);throw new lt(Fe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Ob(n)}.`)}function lL(t,e){if(!Array.isArray(t)||t.length===0)throw new lt(Fe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function tG(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new lt(Fe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new lt(Fe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class g0e{convertValue(e,n="none"){switch(Cc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return sr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(ll(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw _t(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Hc(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[ef].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>sr(o.doubleValue));return new XP(i)}convertGeoPoint(e){return new JP(sr(e.latitude),sr(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=Tb(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Qp(e));default:return null}}convertTimestamp(e){const n=al(e);return new gr(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=Tn.fromString(e);It(i8(r),9688,{name:e});const s=new Qu(r.get(1),r.get(3)),i=new dt(r.popFirst(5));return s.isEqual(n)||Ks(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y0e(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Am{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class nG extends Q8{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new fv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(nA("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class fv extends nG{data(e={}){return super.data(e)}}class rG{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new Am(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new fv(this._firestore,this._userDataWriter,r.key,r,new Am(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new lt(Fe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new fv(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Am(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new fv(s._firestore,s._userDataWriter,l.doc.key,l.doc,new Am(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:x0e(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function x0e(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return _t(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function v0e(t){t=gi(t,Ds);const e=gi(t.firestore,cl);return Xwe($b(e),t._key).then(n=>sG(e,t,n))}class oA extends g0e{constructor(e){super(),this.firestore=e}convertBytes(e){return new cf(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Ds(this.firestore,null,n)}}function Xo(t){t=gi(t,qc);const e=gi(t.firestore,cl),n=$b(e),r=new oA(e);return Z8(t._query),Qwe(n,t._query).then(s=>new rG(e,r,t,s))}function cp(t,e,n){t=gi(t,Ds);const r=gi(t.firestore,cl),s=y0e(t.converter,e,n);return aA(r,[c0e(ZP(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Ys.none())])}function fx(t,e,n,...r){t=gi(t,Ds);const s=gi(t.firestore,cl),i=ZP(s);let o;return o=typeof(e=Hn(e))=="string"||e instanceof Ub?d0e(i,"updateDoc",t._key,e,n,r):u0e(i,"updateDoc",t._key,e),aA(s,[o.toMutation(t._key,Ys.exists(!0))])}function BS(t){return aA(gi(t.firestore,cl),[new kb(t._key,Ys.none())])}function w0e(t,...e){var n,r,s;t=Hn(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||oL(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(oL(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,u,d;if(t instanceof Ds)u=gi(t.firestore,cl),d=Jg(t._key.path),c={next:h=>{e[o]&&e[o](sG(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=gi(t,qc);u=gi(h.firestore,cl),d=h._query;const f=new oA(u);c={next:m=>{e[o]&&e[o](new rG(u,f,h,m))},error:e[o+1],complete:e[o+2]},Z8(t._query)}return function(f,m,g,x){const v=new KP(x),w=new WP(m,v,g);return f.asyncQueue.enqueueAndForget(async()=>BP(await Bw(f),w)),()=>{v.Cu(),f.asyncQueue.enqueueAndForget(async()=>zP(await Bw(f),w))}}($b(u),d,l,c)}function aA(t,e){return function(r,s){const i=new ya;return r.asyncQueue.enqueueAndForget(async()=>Vwe(await Jwe(r),s,i)),i.promise}($b(t),e)}function sG(t,e,n){const r=n.docs.get(e._key),s=new oA(t);return new nG(t,s,e._key,r,new Am(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(s){Tf=s})(dd),Sc(new sl("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new cl(new Bye(r.getProvider("auth-internal")),new Wye(o,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new lt(Fe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Qu(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),lo($M,UM,e),lo($M,UM,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iG="firebasestorage.googleapis.com",oG="storageBucket",b0e=2*60*1e3,_0e=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rr extends Wo{constructor(e,n,r=0){super(zS(e),`Firebase Storage: ${n} (${zS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Rr.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return zS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var kr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(kr||(kr={}));function zS(t){return"storage/"+t}function lA(){const t="An unknown error occurred, please check the error payload for server response.";return new Rr(kr.UNKNOWN,t)}function S0e(t){return new Rr(kr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function C0e(t){return new Rr(kr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function E0e(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Rr(kr.UNAUTHENTICATED,t)}function T0e(){return new Rr(kr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function I0e(t){return new Rr(kr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function N0e(){return new Rr(kr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function P0e(){return new Rr(kr.CANCELED,"User canceled the upload/download.")}function A0e(t){return new Rr(kr.INVALID_URL,"Invalid URL '"+t+"'.")}function k0e(t){return new Rr(kr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function R0e(){return new Rr(kr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+oG+"' property when initializing the app?")}function j0e(){return new Rr(kr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function D0e(){return new Rr(kr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function M0e(t){return new Rr(kr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function UT(t){return new Rr(kr.INVALID_ARGUMENT,t)}function aG(){return new Rr(kr.APP_DELETED,"The Firebase app was deleted.")}function L0e(t){return new Rr(kr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function up(t,e){return new Rr(kr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function am(t){throw new Rr(kr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=$i.makeFromUrl(e,n)}catch{return new $i(e,"")}if(r.path==="")return r;throw k0e(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(T){T.path.charAt(T.path.length-1)==="/"&&(T.path_=T.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(T){T.path_=decodeURIComponent(T.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${d}/b/${s}/o${f}`,"i"),g={bucket:1,path:3},x=n===iG?"(?:storage.googleapis.com|storage.cloud.google.com)":n,v="([^?#]*)",w=new RegExp(`^https?://${x}/${s}/${v}`,"i"),C=[{regex:l,indices:c,postModify:i},{regex:m,indices:g,postModify:u},{regex:w,indices:{bucket:1,path:2},postModify:u}];for(let T=0;T<C.length;T++){const R=C[T],A=R.regex.exec(e);if(A){const E=A[R.indices.bucket];let I=A[R.indices.path];I||(I=""),r=new $i(E,I),R.postModify(r);break}}if(r==null)throw A0e(e);return r}}class F0e{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O0e(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function d(...v){u||(u=!0,e.apply(null,v))}function h(v){s=setTimeout(()=>{s=null,t(m,c())},v)}function f(){i&&clearTimeout(i)}function m(v,...w){if(u){f();return}if(v){f(),d.call(null,v,...w);return}if(c()||o){f(),d.call(null,v,...w);return}r<64&&(r*=2);let C;l===1?(l=2,C=0):C=(r+Math.random())*1e3,h(C)}let g=!1;function x(v){g||(g=!0,f(),!u&&(s!==null?(v||(l=2),clearTimeout(s),h(0)):v||(l=1)))}return h(0),i=setTimeout(()=>{o=!0,x(!0)},n),x}function V0e(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $0e(t){return t!==void 0}function U0e(t){return typeof t=="object"&&!Array.isArray(t)}function cA(t){return typeof t=="string"||t instanceof String}function cL(t){return uA()&&t instanceof Blob}function uA(){return typeof Blob<"u"}function uL(t,e,n,r){if(r<e)throw UT(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw UT(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dA(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function lG(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Fu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Fu||(Fu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0e(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class z0e{constructor(e,n,r,s,i,o,l,c,u,d,h,f=!0,m=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,x)=>{this.resolve_=g,this.reject_=x,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new mx(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Fu.NO_ERROR,c=i.getStatus();if(!l||B0e(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Fu.ABORT;r(!1,new mx(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new mx(u,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());$0e(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=lA();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?aG():P0e();o(c)}else{const c=N0e();o(c)}};this.canceled_?n(!1,new mx(!1,null,!0)):this.backoffId_=O0e(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&V0e(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class mx{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function G0e(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function W0e(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function H0e(t,e){e&&(t["X-Firebase-GMPID"]=e)}function q0e(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function K0e(t,e,n,r,s,i,o=!0,l=!1){const c=lG(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return H0e(d,e),G0e(d,n),W0e(d,i),q0e(d,r),new z0e(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Y0e(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function J0e(...t){const e=Y0e();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(uA())return new Blob(t);throw new Rr(kr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function X0e(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Q0e(t){if(typeof atob>"u")throw M0e("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ca={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class GS{constructor(e,n){this.data=e,this.contentType=n||null}}function Z0e(t,e){switch(t){case ca.RAW:return new GS(cG(e));case ca.BASE64:case ca.BASE64URL:return new GS(uG(t,e));case ca.DATA_URL:return new GS(tbe(e),nbe(e))}throw lA()}function cG(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function ebe(t){let e;try{e=decodeURIComponent(t)}catch{throw up(ca.DATA_URL,"Malformed data URL.")}return cG(e)}function uG(t,e){switch(t){case ca.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw up(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case ca.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw up(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=Q0e(e)}catch(s){throw s.message.includes("polyfill")?s:up(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class dG{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw up(ca.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=rbe(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function tbe(t){const e=new dG(t);return e.base64?uG(ca.BASE64,e.rest):ebe(e.rest)}function nbe(t){return new dG(t).contentType}function rbe(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,n){let r=0,s="";cL(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(cL(this.data_)){const r=this.data_,s=X0e(r,e,n);return s===null?null:new Hl(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Hl(r,!0)}}static getBlob(...e){if(uA()){const n=e.map(r=>r instanceof Hl?r.data_:r);return new Hl(J0e.apply(null,n))}else{const n=e.map(o=>cA(o)?Z0e(ca.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new Hl(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hG(t){let e;try{e=JSON.parse(t)}catch{return null}return U0e(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sbe(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function ibe(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function fG(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function obe(t,e){return e}class Bs{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||obe}}let px=null;function abe(t){return!cA(t)||t.length<2?t:fG(t)}function mG(){if(px)return px;const t=[];t.push(new Bs("bucket")),t.push(new Bs("generation")),t.push(new Bs("metageneration")),t.push(new Bs("name","fullPath",!0));function e(i,o){return abe(o)}const n=new Bs("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new Bs("size");return s.xform=r,t.push(s),t.push(new Bs("timeCreated")),t.push(new Bs("updated")),t.push(new Bs("md5Hash",null,!0)),t.push(new Bs("cacheControl",null,!0)),t.push(new Bs("contentDisposition",null,!0)),t.push(new Bs("contentEncoding",null,!0)),t.push(new Bs("contentLanguage",null,!0)),t.push(new Bs("contentType",null,!0)),t.push(new Bs("metadata","customMetadata",!0)),px=t,px}function lbe(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new $i(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function cbe(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return lbe(r,t),r}function pG(t,e,n){const r=hG(e);return r===null?null:cbe(t,r,n)}function ube(t,e,n,r){const s=hG(e);if(s===null||!cA(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,h=t.fullPath,f="/b/"+o(d)+"/o/"+o(h),m=dA(f,n,r),g=lG({alt:"media",token:u});return m+g})[0]}function dbe(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class gG{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yG(t){if(!t)throw lA()}function hbe(t,e){function n(r,s){const i=pG(t,s,e);return yG(i!==null),i}return n}function fbe(t,e){function n(r,s){const i=pG(t,s,e);return yG(i!==null),ube(i,s,t.host,t._protocol)}return n}function xG(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=T0e():s=E0e():n.getStatus()===402?s=C0e(t.bucket):n.getStatus()===403?s=I0e(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function mbe(t){const e=xG(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=S0e(t.path)),i.serverResponse=s.serverResponse,i}return n}function pbe(t,e,n){const r=e.fullServerUrl(),s=dA(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new gG(s,i,fbe(t,n),o);return l.errorHandler=mbe(e),l}function gbe(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function ybe(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=gbe(null,e)),r}function xbe(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let C="";for(let T=0;T<2;T++)C=C+Math.random().toString().slice(2);return C}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=ybe(e,r,s),d=dbe(u,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,f=`\r
--`+c+"--",m=Hl.getBlob(h,r,f);if(m===null)throw j0e();const g={name:u.fullPath},x=dA(i,t.host,t._protocol),v="POST",w=t.maxUploadRetryTime,_=new gG(x,v,hbe(t,n),w);return _.urlParams=g,_.headers=o,_.body=m.uploadData(),_.errorHandler=xG(e),_}class vbe{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Fu.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Fu.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Fu.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw am("cannot .send() more than once");if(Uc(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw am("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw am("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw am("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw am("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class wbe extends vbe{initXhr(){this.xhr_.responseType="text"}}function vG(){return new wbe}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sd{constructor(e,n){this._service=e,n instanceof $i?this._location=n:this._location=$i.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new sd(e,n)}get root(){const e=new $i(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return fG(this._location.path)}get storage(){return this._service}get parent(){const e=sbe(this._location.path);if(e===null)return null;const n=new $i(this._location.bucket,e);return new sd(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw L0e(e)}}function bbe(t,e,n){t._throwIfRoot("uploadBytes");const r=xbe(t.storage,t._location,mG(),new Hl(e,!0),n);return t.storage.makeRequestWithTokens(r,vG).then(s=>({metadata:s,ref:t}))}function _be(t){t._throwIfRoot("getDownloadURL");const e=pbe(t.storage,t._location,mG());return t.storage.makeRequestWithTokens(e,vG).then(n=>{if(n===null)throw D0e();return n})}function Sbe(t,e){const n=ibe(t._location.path,e),r=new $i(t._location.bucket,n);return new sd(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cbe(t){return/^[A-Za-z]+:\/\//.test(t)}function Ebe(t,e){return new sd(t,e)}function wG(t,e){if(t instanceof hA){const n=t;if(n._bucket==null)throw R0e();const r=new sd(n,n._bucket);return e!=null?wG(r,e):r}else return e!==void 0?Sbe(t,e):t}function Tbe(t,e){if(e&&Cbe(e)){if(t instanceof hA)return Ebe(t,e);throw UT("To use ref(service, url), the first argument must be a Storage instance.")}else return wG(t,e)}function dL(t,e){const n=e==null?void 0:e[oG];return n==null?null:$i.makeFromBucketSpec(n,t)}function Ibe(t,e,n,r={}){t.host=`${e}:${n}`;const s=Uc(e);s&&(pb(`https://${t.host}`),gb("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:tz(i,t.app.options.projectId))}class hA{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=iG,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=b0e,this._maxUploadRetryTime=_0e,this._requests=new Set,s!=null?this._bucket=$i.makeFromBucketSpec(s,this._host):this._bucket=dL(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=$i.makeFromBucketSpec(this._url,e):this._bucket=dL(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){uL("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){uL("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(qs(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new sd(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new F0e(aG());{const o=K0e(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const hL="@firebase/storage",fL="0.13.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bG="storage";function hh(t,e,n){return t=Hn(t),bbe(t,e,n)}function fh(t){return t=Hn(t),_be(t)}function mh(t,e){return t=Hn(t),Tbe(t,e)}function Nbe(t=yb(),e){t=Hn(t);const r=Bg(t,bG).getImmediate({identifier:e}),s=ZN("storage");return s&&Pbe(r,...s),r}function Pbe(t,e,n,r={}){Ibe(t,e,n,r)}function Abe(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new hA(n,r,s,e,dd)}function kbe(){Sc(new sl(bG,Abe,"PUBLIC").setMultipleInstances(!0)),lo(hL,fL,""),lo(hL,fL,"esm2017")}kbe();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rbe="type.googleapis.com/google.protobuf.Int64Value",jbe="type.googleapis.com/google.protobuf.UInt64Value";function _G(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Gw(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Gw(e));if(typeof t=="function"||typeof t=="object")return _G(t,e=>Gw(e));throw new Error("Data cannot be encoded in JSON: "+t)}function uf(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case Rbe:case jbe:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>uf(e)):typeof t=="function"||typeof t=="object"?_G(t,e=>uf(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mL={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class hi extends Wo{constructor(e,n,r){super(`${fA}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,hi.prototype)}}function Dbe(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Ww(t,e){let n=Dbe(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!mL[o])return new hi("internal","internal");n=mL[o],r=o}const l=i.message;typeof l=="string"&&(r=l),s=i.details,s!==void 0&&(s=uf(s))}}catch{}return n==="ok"?null:new hi(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mbe{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,qs(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BT="us-central1",Lbe=/^data: (.*?)(?:\n|$)/;function Fbe(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new hi("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class Obe{constructor(e,n,r,s,i=BT,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new Mbe(e,n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=BT}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function Vbe(t,e,n){const r=Uc(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(pb(t.emulatorOrigin),gb("Functions",!0))}function $be(t,e,n){const r=s=>Bbe(t,e,s,n||{});return r.stream=(s,i)=>Gbe(t,e,s,i),r}async function Ube(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}async function SG(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function Bbe(t,e,n,r){const s=t._url(e);return zbe(t,s,n,r)}async function zbe(t,e,n,r){n=Gw(n);const s={data:n},i=await SG(t,r),o=r.timeout||7e4,l=Fbe(o),c=await Promise.race([Ube(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new hi("cancelled","Firebase Functions instance was deleted.");const u=Ww(c.status,c.json);if(u)throw u;if(!c.json)throw new hi("internal","Response is not valid JSON object.");let d=c.json.data;if(typeof d>"u"&&(d=c.json.result),typeof d>"u")throw new hi("internal","Response is missing data field.");return{data:uf(d)}}function Gbe(t,e,n,r){const s=t._url(e);return Wbe(t,s,n,r||{})}async function Wbe(t,e,n,r){var s;n=Gw(n);const i={data:n},o=await SG(t,r);o["Content-Type"]="application/json",o.Accept="text/event-stream";let l;try{l=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:o,signal:r==null?void 0:r.signal})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const x=new hi("cancelled","Request was cancelled.");return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}const g=Ww(0,null);return{data:Promise.reject(g),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(g)}}}}}}let c,u;const d=new Promise((m,g)=>{c=m,u=g});(s=r==null?void 0:r.signal)===null||s===void 0||s.addEventListener("abort",()=>{const m=new hi("cancelled","Request was cancelled.");u(m)});const h=l.body.getReader(),f=Hbe(h,c,u,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const m=f.getReader();return{async next(){const{value:g,done:x}=await m.read();return{value:g,done:x}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:d}}function Hbe(t,e,n,r){const s=(o,l)=>{const c=o.match(Lbe);if(!c)return;const u=c[1];try{const d=JSON.parse(u);if("result"in d){e(uf(d.result));return}if("message"in d){l.enqueue(uf(d.message));return}if("error"in d){const h=Ww(0,d);l.error(h),n(h);return}}catch(d){if(d instanceof hi){l.error(d),n(d);return}}},i=new TextDecoder;return new ReadableStream({start(o){let l="";return c();async function c(){if(r!=null&&r.aborted){const u=new hi("cancelled","Request was cancelled");return o.error(u),n(u),Promise.resolve()}try{const{value:u,done:d}=await t.read();if(d){l.trim()&&s(l.trim(),o),o.close();return}if(r!=null&&r.aborted){const f=new hi("cancelled","Request was cancelled");o.error(f),n(f),await t.cancel();return}l+=i.decode(u,{stream:!0});const h=l.split(`
`);l=h.pop()||"";for(const f of h)f.trim()&&s(f.trim(),o);return c()}catch(u){const d=u instanceof hi?u:Ww(0,null);o.error(d),n(d)}}},cancel(){return t.cancel()}})}const pL="@firebase/functions",gL="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qbe="auth-internal",Kbe="app-check-internal",Ybe="messaging-internal";function Jbe(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(qbe),o=n.getProvider(Ybe),l=n.getProvider(Kbe);return new Obe(s,i,o,l,r)};Sc(new sl(fA,e,"PUBLIC").setMultipleInstances(!0)),lo(pL,gL,t),lo(pL,gL,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hw(t=yb(),e=BT){const r=Bg(Hn(t),fA).getImmediate({identifier:e}),s=ZN("functions");return s&&Xbe(r,...s),r}function Xbe(t,e,n){Vbe(Hn(t),e,n)}function Ja(t,e,n){return $be(Hn(t),e,n)}Jbe();function mc(t){return t?t.toLowerCase().replace(/\s+/g,"-"):""}const Qbe={apiKey:"AIzaSyAI8iWuP1P20OZDIGsUNX6BluSCF40A7AU",authDomain:"freshfront-c3181.firebaseapp.com",projectId:"freshfront-c3181",storageBucket:"freshfront-c3181.firebasestorage.app",messagingSenderId:"925329325314",appId:"1:925329325314:web:67f69c02b9ff7580e6561b"},Gb=lz(Qbe),dp=Oye(Gb),CG=r0e(Gb),ph=Nbe(Gb),kh=Hw(Gb);try{s0e(CG,{cacheSizeBytes:n0e}).then(()=>{console.log("Firestore offline persistence enabled.")}).catch(t=>{t.code=="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other precondition failed.",t):t.code=="unimplemented"?console.warn("Firestore offline persistence failed: Browser does not support required features.",t):console.error("Firestore offline persistence failed with error: ",t)})}catch(t){console.error("Error enabling Firestore offline persistence: ",t)}const nr=CG;async function zT(t){if(!t||typeof t!="string"||t.trim()==="")return!1;const e=mc(t.trim());try{const n=Jo(nr,"stores"),r=VT(n,$T("urlSlug","==",e),p0e(1));return!(await Xo(r)).empty}catch(n){throw console.error("Error checking store name availability in Firestore:",n),new Error("Failed to check store name availability due to a database error.")}}const EG=p.createContext(),Zbe=({children:t})=>{const[e,n]=p.useState(null),[r,s]=p.useState(null),[i,o]=p.useState(null),[l,c]=p.useState(!0),[u,d]=p.useState(null);p.useEffect(()=>{let g=()=>{};const x=Tge(dp,async v=>{if(c(!0),n(v),s(v),g(),v){const w=Ai(nr,"profiles",v.uid);g=w0e(w,_=>{if(_.exists()){const C=_.data();o(C),d((C==null?void 0:C.role)||"store_owner"),console.log("AuthContext: Profile updated from snapshot:",C)}else console.warn("AuthContext: No profile found for user:",v.uid),o(null),d("store_owner");c(!1)},_=>{console.error("AuthContext: Error listening to profile:",_.message),o(null),d(null),c(!1)})}else o(null),d(null),c(!1)});return()=>{x(),g()}},[]);const m={user:e,session:r,profile:i,isAuthenticated:!!r&&!!e,userRole:u,loadingRole:l,logout:async()=>{try{await Ige(dp),console.log("User signed out successfully.")}catch(g){console.error("Error signing out: ",g)}},subscriptionStatus:"inactive"};return a.jsx(EG.Provider,{value:m,children:t})},yo=()=>{const t=p.useContext(EG);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},Zi=[{name:"Canvas",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Canvas.jpeg?alt=media&token=bfcade71-3242-4fc1-a623-1779f4b4773c",category:"Wall Art"},{name:"Hat",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Hat.jpeg?alt=media&token=e71e8dd0-2fc8-49ba-be13-98fd3909db3c",category:"Apparel"},{name:"Black hoodie",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Hoodie.jpeg?alt=media&token=90fee73f-96f5-4372-9f15-44e44403adca",category:"Apparel"},{name:"Mug",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Mug.png?alt=media&token=ff8dd2df-7dad-4ef7-8fa8-7867a6770dba",category:"Drinkware"},{name:"Notebook",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Notebook.jpeg?alt=media&token=807b6222-96ad-4179-a11a-16406c4b4509",category:"Stationery"},{name:"Pillow",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Pillow.webp?alt=media&token=50f5c317-8c39-4c48-b55c-d1da9216fa2e",category:"Home Decor"},{name:"Shirt",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Shirt.webp?alt=media&token=7c5f9b2f-6161-4a01-b9eb-1ae7813f3d6c",category:"Apparel"},{name:"Totebag",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Totebag.jpeg?alt=media&token=2d4dad9f-53d8-45b5-afce-5cef1a8e9f1c",category:"Accessories"},{name:"Travel mug",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Travelmug.jpeg?alt=media&token=312cd2d7-add0-4180-8872-355ec15ed00e",category:"Drinkware"},{name:"Blanket",imageUrl:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Bl.webp?alt=media&token=882cefc9-c725-40e7-a225-69f91d3ea2f6",category:"Home Decor"}],qw=[{value:"fashion",label:"Fashion & Apparel"},{value:"electronics",label:"Electronics & Gadgets"},{value:"food",label:"Food & Beverage"},{value:"jewelry",label:"Jewelry & Accessories"},{value:"homedecor",label:"Home Decor & Furnishings"},{value:"beauty",label:"Beauty & Personal Care"},{value:"books",label:"Books & Media"},{value:"sports",label:"Sports & Outdoors"},{value:"toys",label:"Toys & Games"},{value:"art_collectibles",label:"Art & Collectibles"},{value:"general",label:"General Merchandise"}],ig=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{const c=s.toDataURL("image/png").split(",")[1];e({base64ImageData:c,mimeType:"image/png"})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas."))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),e_e=t=>new Promise((e,n)=>{if(!t||!(t instanceof File))return n(new Error("Invalid file object provided."));const r=new FileReader;r.onload=()=>{const s=r.result;try{const i=s.split(",");if(i.length<2)throw new Error("Invalid data URL structure from FileReader.");const o=i[1];e({base64ImageData:o,mimeType:t.type})}catch(i){console.error("Error parsing data URL from FileReader:",s,i),n(new Error(`Invalid data URL format from FileReader: ${i.message}`))}},r.onerror=s=>{console.error("FileReader error:",s),n(new Error("Failed to read the file."))},r.readAsDataURL(t)}),t_e="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",n_e=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}],r_e=t=>{if(!t)return null;const e=t.split(",");if(e.length<2)return null;const n=e[0].match(/:(.*?);/);if(!n||n.length<2)return null;const r=n[1],s=atob(e[1]);let i=s.length;const o=new Uint8Array(i);for(;i--;)o[i]=s.charCodeAt(i);return new Blob([o],{type:r})};async function TG(t,e,n=null,r="image/png",s=[],i=(u,d)=>console.log(`ProductGen Progress: ${u}%, Message: ${d||""}`),o=0,l=5,c=""){if(!t||!e)throw new Error("Product type and store name are required to generate a product.");const u=new On({apiKey:t_e});let d=`You are an expert product creator for e-commerce stores.
Generate a product for a store named "${e}" that sells ${t}.
The overall theme and request for the store is: "${c}". Use this full prompt to ensure the product aligns well with the user's vision.

The product should include:
1. A catchy title.
2. A brief description (15-25 words).
3. A realistic price (e.g., 29.99, 45.00).
4. Relevant product options/variants (e.g., for a shirt: Size [S, M, L, XL], Color [White, Black, Blue]; for a shoe: Size [8, 9, 10], Color [Red, Grey]). Generate 1 to 2 variant types, each with 2 to 5 option values. If no variants are typically applicable for the product type, return an empty array for "variants".
5. A visually appealing product image.

Return the text details (title, description, price, variants) as a single JSON object in the text part of your response.
Your entire text response MUST be ONLY a valid JSON object. Do not include any other words, phrases, or conversational text before or after the JSON object.
The JSON object should strictly follow this format:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": [
    { "name": "Size", "values": ["S", "M", "L", "XL"] },
    { "name": "Color", "values": ["White", "Black", "Blue"] }
  ]
}
Or, if no variants apply:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": []
}


Generate an image for this product in the image part of your response.`,h=d;if(s&&s.length>0&&(h+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n){let _=d;s&&s.length>0&&(_+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n&&(_+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`),console.log(n?`[geminiProductGeneration Function] Generating product with logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`:`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}else{let _=d;s&&s.length>0&&(_+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),console.log(`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}let f=null,m=null,g="",x=0;const v=3;let w=[];for(;x<v;){x++,console.log(`[geminiProductGeneration Function] Attempt ${x} to generate content...`);const _=o+(x-1)/v*(l*.2);i(_,`Generating product (attempt ${x}/${v})...`);let C=d;s&&s.length>0&&(C+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),w.length>0&&(C+=`

ADDITIONALLY IMPORTANT: Avoid re-generating the following titles which were duplicates in previous attempts of THIS request: "${w.join('", "')}". Ensure the new title is truly novel and not similar to these.`),n&&(C+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`);const T=[{text:C}];if(n&&T.push({inlineData:{data:n,mimeType:r}}),x===1){const R=[...s,...w];console.log(`[geminiProductGeneration Function] Generating product for type: ${t}, store: ${e}. Initial exclusions (if any): ${R.join(", ")||"None"}. Logo: ${n?"Yes":"No"}`)}try{const R=await u.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:T,safetySettings:n_e,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});f=null,m=null;let A="";if(R.candidates&&R.candidates.length>0&&R.candidates[0].content&&R.candidates[0].content.parts)for(const E of R.candidates[0].content.parts)if(E.text){A+=E.text;try{const I=E.text.trim();let N=null;const k=I.match(/```json\s*([\s\S]*?)\s*```/);if(k&&k[1])N=k[1],console.log(`[geminiProductGeneration Function] Attempt ${x}: Found JSON in markdown block.`);else{const j=I.indexOf("{"),D=I.lastIndexOf("}");j!==-1&&D>j&&(N=I.substring(j,D+1),console.log(`[geminiProductGeneration Function] Attempt ${x}: Extracted potential JSON between first '{' and last '}'.`))}N?(f=JSON.parse(N),console.log(`[geminiProductGeneration Function] Attempt ${x}: Successfully parsed JSON.`)):E.text&&(E.text.includes("{")||E.text.includes("}"))?console.warn(`[geminiProductGeneration Function] Attempt ${x}: Text part contained braces but simple extraction failed. Text:`,E.text):E.text&&console.warn(`[geminiProductGeneration Function] Attempt ${x}: No JSON structure (markdown or simple braces) found in text part:`,E.text)}catch(I){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Error parsing JSON. Attempted to parse: "${typeof jsonStringToParse=="string"?jsonStringToParse:"[jsonStringToParse was not a string or was null]"}". Original text from part:`,E.text,"Error:",I.message),f=null}}else E.inlineData&&E.inlineData.data&&(m=E.inlineData.data,console.log(`[geminiProductGeneration Function] Attempt ${x}: Image data found.`));if(g+=(g?`
---
Attempt `+x+`:
`:"Attempt "+x+`:
`)+A,f&&f.title){const E=f.title.toLowerCase();i(o+l*.8,`Validating product details for "${f.title}"...`);const I=s.some(k=>k.toLowerCase()===E),N=w.some(k=>k.toLowerCase()===E);if(I||N)console.warn(`[geminiProductGeneration Function] Attempt ${x}: Generated title "${f.title}" is a duplicate. Adding to exclusion list for next attempt.`),w.push(f.title),f=null;else if(!f.price||typeof f.price!="string"&&typeof f.price!="number"||String(f.price).trim()==="")console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique, but price is missing or invalid. Price:`,f.price),f=null;else if(!f.variants||!Array.isArray(f.variants))console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique and price is valid, but variants are missing or not an array. Variants:`,f.variants),f=null;else for(const k of f.variants)if(!k.name||typeof k.name!="string"||!Array.isArray(k.values)||!k.values.every(j=>typeof j=="string")){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" has malformed variant entry. Variant:`,k),f=null;break}}if(f&&f.title&&(f.price||f.price===0)&&f.variants&&m){console.log(`[geminiProductGeneration Function] Successfully generated complete and unique product data (including variants) on attempt ${x}.`);break}else m||console.warn(`[geminiProductGeneration Function] Attempt ${x} missing image data.`),f?(f.title||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing title.`),!f.price&&f.price!==0&&console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing price.`),f.variants||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing variants or variants malformed.`)):console.warn(`[geminiProductGeneration Function] Attempt ${x} missing text details (or title was duplicate/price missing/variants malformed).`)}catch(R){console.error(`[geminiProductGeneration Function] Error during attempt ${x}:`,R.message,R.stack),g+=(g?`
---
`:"")+`Attempt ${x} Error: ${R.message}`}x>=v&&(!f||!m)&&console.error(`[geminiProductGeneration Function] Exhausted ${v} attempts. Product generation failed.`)}if(!f||!m){let _=`Failed to generate complete and unique product data after ${v} attempts. `;throw f||(_+="Text details (or unique title) missing. "),m||(_+="Image data missing. "),console.error(_,"Accumulated raw text responses:",g),new Error(_+`Last raw text (if any): ${g}`)}if(typeof f.title!="string"||typeof f.description!="string"||typeof f.price!="string"&&typeof f.price!="number"||!Array.isArray(f.variants)||!f.variants.every(_=>typeof _.name=="string"&&Array.isArray(_.values)&&_.values.every(C=>typeof C=="string")))throw console.error("[geminiProductGeneration Function] Parsed product details are not in the expected format:",f),new Error("AI response for product details was not in the expected format (title, description, price, variants).");if(f.price=String(f.price),console.log("[geminiProductGeneration Function] Successfully generated product details (including variants) and image data."),m){const _=`data:image/png;base64,${m}`,C=r_e(_);if(C){const T=Ft(),A=`product_images_generated/${`${e.replace(/\s+/g,"_").toLowerCase()}_${f.title.replace(/\s+/g,"_").toLowerCase().substring(0,20)}_${T}.png`}`,E=mh(ph,A);try{i(o+l*.9,`Uploading image for "${f.title}"...`),await hh(E,C);const I=await fh(E);return console.log(`[geminiProductGeneration Function] Image uploaded to Firebase Storage: ${I}`),i(o+l,`Product "${f.title}" generated successfully.`),{...f,images:[I]}}catch(I){throw console.error("[geminiProductGeneration Function] Error uploading image to Firebase Storage:",I),new Error(`Failed to upload generated image to Firebase Storage: ${I.message}`)}}else throw console.error("[geminiProductGeneration Function] Failed to convert base64 image data to Blob."),new Error("Failed to process generated image data for upload.")}else return i(o+l,`Product "${f.title}" generated (no image).`),{...f,images:[]}}const s_e="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",yL=new On({apiKey:s_e});async function IG(t,e,n,r=[],s=(l,c)=>console.log(`CollectionGen Progress: ${l}%, Message: ${c||""}`),i=0,o=5){const l=()=>null,c=n&&n.length>0?n.map(h=>`- ${h.name}: ${h.description||"No description."}`).filter(Boolean).join(`
`):"various items",u=r.length>0?`Do NOT use any of the following names: ${r.join(", ")}.`:"",d=`
    You are an AI assistant for an e-commerce store named "${e}" that sells "${t}".
    Based on the following products (name and description): 
${c}
Suggest a compelling and UNIQUE collection name and a short, engaging description (max 2 sentences) for a new collection.
    The collection should group related products or highlight a specific theme.
    ${u}
    Provide the output in a JSON format like this:
    {
      "name": "Collection Name",
      "description": "Collection Description",
      "product_names": ["Product Name 1", "Product Name 2"]
    }
    Ensure the collection name is concise, unique from the provided list (if any), and the description is appealing.
    The "product_names" array should contain a selection of 2 to 4 relevant product names from the provided product list that fit well within this new collection.
  `;s(i+o*.1,"Generating collection details...");try{const h=await yL.models.generateContent({model:"gemini-2.0-flash",contents:[{text:d}],config:{responseModalities:[wn.TEXT]}});let f="";if(h&&h.candidates&&h.candidates.length>0&&h.candidates[0].content&&h.candidates[0].content.parts&&h.candidates[0].content.parts.length>0)for(const _ of h.candidates[0].content.parts)_.text&&(f+=_.text);if(!f)return console.error("Gemini text generation did not return any text content. Full response:",h),console.warn("Returning fallback collection due to no text from AI."),l();let m;try{const _=f.match(/```json\n([\s\S]*?)\n```/);if(_&&_[1])m=JSON.parse(_[1]);else try{m=JSON.parse(f)}catch{console.warn("Failed to parse Gemini response as JSON directly, trying to extract from text:",f);const T=f.indexOf("{"),R=f.lastIndexOf("}");if(T!==-1&&R!==-1&&R>T){const A=f.substring(T,R+1);try{m=JSON.parse(A)}catch(E){throw console.error("Final attempt to parse extracted JSON failed:",A,E),E}}else throw new Error("No valid JSON structure found in response.")}}catch(_){return console.error("Failed to parse Gemini response as JSON:",f,_),console.warn("Returning fallback collection due to JSON parsing error."),l()}if(!m||!m.name||!m.description||!Array.isArray(m.product_names)||m.product_names.length===0)return console.error("AI did not return valid collection data (name, description, or non-empty product_names array):",m),console.warn("Returning fallback collection due to invalid/incomplete AI data."),s(i+o*.5,"Failed to get valid collection details."),l();s(i+o*.5,`Collection details "${m.name}" received.`);const g=_=>{if(typeof _!="string")return"";let C=_.toLowerCase();return C=C.replace(/\b(a|an|the)\b/g,""),C.endsWith("s")&&C.length>3&&(C=C.slice(0,-1)),C=C.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),C},x=[];m.product_names&&n&&m.product_names.forEach(_=>{const C=g(_);if(!C){console.warn(`AI product name "${_}" normalized to an empty string. Skipping.`);return}let T=null;T=n.find(R=>g(R.name)===C),T||(T=n.find(R=>{const A=g(R.name);return A.includes(C)||C.includes(A)})),T&&T.name?(x.push(T.name),console.log(`Matched AI product "${_}" (normalized: "${C}") to existing product "${T.name}" (using name as ID)`)):console.warn(`Product name "${_}" (normalized: "${C}") from AI response not found in provided product list or missing name after normalization and fallback search.`)});const v=`A vibrant and appealing e-commerce collection image for "${m.name}", described as "${m.description}", suitable for a store selling ${t}.`;let w=null;s(i+o*.6,`Generating image for collection "${m.name}"...`);try{const _=[{text:v}],C=await yL.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:_,config:{responseModalities:[wn.TEXT,wn.IMAGE]}});if(C&&C.candidates&&C.candidates.length>0&&C.candidates[0].content&&C.candidates[0].content.parts&&C.candidates[0].content.parts.length>0){for(const T of C.candidates[0].content.parts)if(T.inlineData&&T.inlineData.data){w=T.inlineData.data;break}}w?s(void 0,`Image generated for collection "${m.name}".`):(console.warn(`Gemini image generation did not return image data for collection: "${m.name}". Full Response:`,C),s(void 0,`Image generation failed for collection "${m.name}".`))}catch(_){console.error(`Error generating image for collection "${m.name}" with Gemini:`,_),s(void 0,`Error generating image for collection "${m.name}".`)}return s(i+o,`Collection "${m.name}" processing complete.`),{name:m.name,description:m.description,imageData:w,product_ids:x}}catch(h){return console.error("Error generating collection with Gemini:",h),console.warn("Returning fallback collection due to an unexpected error in generation process."),s(i+o,"Collection generation failed (unexpected error)."),l()}}const i_e="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",NG=async t=>{var i,o;if(!t||t.length===0)return{error:"No images provided for analysis."};const e=new On({apiKey:i_e}),n=t.map(l=>{if(!l.base64||!l.mimeType)throw console.error("Image object is missing base64 or mimeType:",l.name),new Error(`Image ${l.name} is missing data for AI processing.`);return{inlineData:{data:l.base64.startsWith("data:")?l.base64.split(",")[1]:l.base64,mimeType:l.mimeType}}}),r=`
    Analyze the following product images (${t.map(l=>l.name).join(", ")}). 
    Based on these images, provide the following details for setting up an e-commerce store.
    Please format your response as a single, valid JSON object with the exact keys specified below.

    1.  "productType": A concise category or niche for these products (e.g., "Handcrafted Leather Goods", "Vintage Streetwear", "Artisanal Coffee Beans").
    2.  "storeNameSuggestions": An array of 3-5 creative and relevant store name suggestions.
    3.  "logoDescription": A brief description of a suitable logo concept (e.g., "A minimalist line art of a coffee bean with earthy tones").
    4.  "products": An array of objects, one for each uploaded image. For each product, analyze its specific image content to generate the following:
        *   "originalImageName": The filename of the original image (use the names provided in this prompt, e.g., "${((i=t[0])==null?void 0:i.name)||"example_image.jpg"}").
        *   "name": A catchy and descriptive product name directly inspired by the visual details in THIS specific image.
        *   "price": A suggested retail price for THIS specific product, considering its appearance and likely category (e.g., "29.99"). Ensure this is a string representing a number.
        *   "description": A compelling product description (2-3 sentences) highlighting key visual features and benefits of THIS specific product shown in its image.
    5.  "collections": An array of 3 distinct collection suggestions, each with:
        *   "name": Collection name (e.g., "New Arrivals", "Essentials", "Gifts Under $50").
        *   "description": A brief description for the collection.
    6.  "storePrompt": A short paragraph describing the overall style, feel, and target audience for a store selling these products. This will be used as a base for further AI generation of store content.

    Example for a single product in the "products" array:
    {
      "originalImageName": "${((o=t[0])==null?void 0:o.name)||"example_image.jpg"}",
      "name": "Rustic Leather Wallet",
      "price": "45.00",
      "description": "Hand-stitched full-grain leather wallet with a timeless design. Perfect for everyday carry, offering both style and durability."
    }
  `,s={type:rt.OBJECT,properties:{productType:{type:rt.STRING},storeNameSuggestions:{type:rt.ARRAY,items:{type:rt.STRING}},logoDescription:{type:rt.STRING},products:{type:rt.ARRAY,items:{type:rt.OBJECT,properties:{originalImageName:{type:rt.STRING},name:{type:rt.STRING},price:{type:rt.STRING},description:{type:rt.STRING}},required:["originalImageName","name","price","description"]}},collections:{type:rt.ARRAY,items:{type:rt.OBJECT,properties:{name:{type:rt.STRING},description:{type:rt.STRING}},required:["name","description"]}},storePrompt:{type:rt.STRING}},required:["productType","storeNameSuggestions","logoDescription","products","collections","storePrompt"]};try{console.log("[geminiImageUnderstanding] Sending prompt to Gemini with images:",t.map(h=>h.name));const l=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:r},...n]}],config:{responseMimeType:"application/json",responseSchema:s}});if(console.log("[geminiImageUnderstanding] Full API call response object:",JSON.stringify(l,null,2)),!l||typeof l.text!="string"){let h="Invalid or missing response from API.";return l&&l.promptFeedback&&l.promptFeedback.blockReason?(h=`Request blocked: ${l.promptFeedback.blockReason}. ${l.promptFeedback.blockReasonMessage||""}`,console.error(`[geminiImageUnderstanding] Request blocked. Reason: ${l.promptFeedback.blockReason}, Message: ${l.promptFeedback.blockReasonMessage}`)):l&&l.candidates&&l.candidates.length>0&&l.candidates[0].finishReason!=="STOP"&&l.candidates[0].finishReason!=="MODEL_SPECIFIED_STOP"?(h=`Generation stopped for reason: ${l.candidates[0].finishReason}.`,console.error(`[geminiImageUnderstanding] Generation stopped. Reason: ${l.candidates[0].finishReason}`)):console.error("[geminiImageUnderstanding] API response is invalid or text property is missing/not a string. Full response:",l),{error:`AI analysis failed: ${h}`}}const c=l.text;if(c.trim()==="")return console.error("[geminiImageUnderstanding] Model did not return a text response (empty string). Full API Response:",JSON.stringify(l)),{error:"AI analysis failed: Model response was empty or not text."};let u;try{u=JSON.parse(c)}catch(h){return console.error("[geminiImageUnderstanding] Failed to parse Gemini JSON response:",c,"ParseError:",h),{error:"AI analysis failed: Could not understand the response from Gemini (invalid JSON)."}}if(!u.productType||!Array.isArray(u.storeNameSuggestions)||!Array.isArray(u.products)||!Array.isArray(u.collections)||!u.storePrompt)return console.error("[geminiImageUnderstanding] Gemini response missing required fields or incorrect types:",u),{error:"AI analysis failed: The response from Gemini was incomplete or malformed."};const d=u.products.map(h=>{let f=[],m="Untitled Product (AI)",g="0.00",x="No description provided by AI.",v=null;if(h&&typeof h=="object")if(m=h.name||m,g=h.price||g,x=h.description||x,v=h.originalImageName||null,typeof h.originalImageName=="string"){const w=t.find(_=>_&&_.name===h.originalImageName);w&&typeof w.base64=="string"?f=[w.base64]:console.warn(`[geminiImageUnderstanding] Original image or its base64 not found for product with AI-provided originalImageName: "${h.originalImageName}". AI Product Name: "${h.name}"`)}else console.warn("[geminiImageUnderstanding] Product item from AI is missing 'originalImageName' string or is invalid:",h);else console.warn("[geminiImageUnderstanding] Invalid product item received from AI (not an object):",h);return{...h&&typeof h=="object"?h:{},name:m,price:g,description:x,originalImageName:v,images:f}});return{productType:u.productType,storeNameSuggestions:u.storeNameSuggestions,logoDescription:u.logoDescription,products:d,collections:u.collections,storePrompt:u.storePrompt,error:null}}catch(l){return console.error("[geminiImageUnderstanding] Error calling Gemini API or processing response:",l),{error:`AI analysis API call failed: ${l.message}`}}},PG=new On({apiKey:"AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s"}),o_e=async t=>{if(!t)throw new Error("URL is required for analysis.");try{const e=PG.getGenerativeModel({model:"gemini-2.5-flash-preview-0514",tools:[{urlContext:{}}]}),n=`
      Analyze the content of the provided URL and extract the following information:
      1.  **Primary Topic/Theme:** What is the main subject of the page? (e.g., "E-commerce site for handmade leather goods", "Blog about minimalist interior design").
      2.  **Brand/Store Name:** Identify the name of the brand or store.
      3.  **Key Products/Services:** List the main products or services offered.
      4.  **Target Audience:** Describe the likely target audience.
      5.  **Visual Style/Aesthetics:** Describe the visual design, color palette, and overall aesthetic of the website.
      6.  **Key Marketing Phrases/Slogans:** Extract any prominent marketing messages or slogans.

      URL: ${t}
    `;return(await(await e.generateContent({contents:[{role:"user",parts:[{text:n}]}]})).response).text()}catch(e){throw console.error(`Error analyzing URL ${t}:`,e),new Error(`Failed to analyze content for URL: ${t}.`)}},a_e=async t=>{if(!t||t.length===0)return"";try{const e=await Promise.all(t.map(o=>o_e(o)));if(e.length===1)return e[0];const n=PG.getGenerativeModel({model:"gemini-2.5-flash-preview-0514"}),r=`
      You have been provided with analyses from multiple URLs. Synthesize this information into a single, coherent summary. 
      Identify common themes, brand identity, product categories, and target audience. 
      If there are conflicting details, note them. The goal is to create a unified creative brief that can be used to generate a new online store.

      Analyses:
      ${e.join(`

---

`)}
    `;return(await(await n.generateContent({contents:[{role:"user",parts:[{text:r}]}]})).response).text()}catch(e){throw console.error("Error synthesizing URL analyses:",e),new Error("Failed to synthesize analyses from multiple URLs.")}},l_e="2025-04",Wb=async(t,e,n,r={})=>{var l,c;if(!t||t==="your-shop-name.myshopify.com"||!e||e==="YOUR_SHOPIFY_STOREFRONT_ACCESS_TOKEN")throw new Error("Shopify domain or access token is not configured or is using placeholder values.");let s=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");s.includes(".")?!s.endsWith(".myshopify.com")&&s.includes("."):s=`${s}.myshopify.com`,s.includes(".")||(s=`${s}.myshopify.com`);let i=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");i.includes(".")||(i=`${i}.myshopify.com`);const o=`https://${i}/api/${l_e}/graphql.json`;try{const u=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":e},body:JSON.stringify({query:n,variables:r})});if(!u.ok){let h;try{h=await u.json()}catch{}const f=((c=(l=h==null?void 0:h.errors)==null?void 0:l[0])==null?void 0:c.message)||`Shopify API request failed: ${u.status} ${u.statusText}`;throw console.error("Shopify API Error:",h||u.statusText),new Error(f)}const d=await u.json();if(d.errors)throw console.error("Shopify GraphQL Errors:",d.errors),new Error(d.errors.map(h=>h.message).join(", "));return d.data}catch(u){throw console.error("Error fetching from Shopify Storefront API:",u),u}},c_e=`
  query GetShopMetadata {
    shop {
      name
      description 
      primaryDomain {
        host
        url
      }
      brand {
        logo {
          image { # Reverted to use image field
            url
            altText
          }
        }
        squareLogo { # Added, assuming similar structure
          image {
            url
            altText # Assuming altText is available, can be removed if not
          }
        }
        coverImage {
          image { # Reverted to use image field
            url
            altText
          }
        }
        slogan
        shortDescription # Added
        colors {
          primary {
            background
            foreground
          }
          secondary {
            background
            foreground
          }
        }
      }
    }
  }
`,u_e=`
  query GetProducts($first: Int = 10, $cursor: String) {
    products(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description # Changed from descriptionHtml
          handle
          tags
          images(first: 5) { # Changed from first: 1
            edges {
              node {
                url
                altText
              }
            }
          }
          variants(first: 5) { # Changed from first: 1
            edges {
              node {
                id # Added for variants
                title # Added for variants
                availableForSale # Added
                sku # Added from debug guide example
                price: priceV2 { # Changed from priceRange.minVariantPrice to priceV2, aliased to price
                    amount
                    currencyCode
                }
                image {
                   url
                   altText
                }
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,d_e=`
  query GetCollections($first: Int = 10, $cursor: String) {
    collections(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description
          handle
          products(first: 5) { # Example: fetch first 5 products in each collection
            edges {
              node {
                id
                title
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,h_e=`
  query GetLocalizationInfo @inContext(country: "US") { # Defaulting to US, can be parameterized
    localization {
      availableCountries {
        isoCode
        name
        currency {
          isoCode
          name
          symbol
        }
      }
      availableLanguages {
        isoCode
        name
        endonymName
      }
    }
  }
`,df=()=>["#3B82F6","#8B5CF6","#EC4899","#10B981","#F59E0B","#EF4444","#6366F1","#14B8A6","#F97316"][Math.floor(Math.random()*9)],mA=()=>["Inter","Roboto","Poppins","Montserrat","Open Sans"][Math.floor(Math.random()*5)],pA=()=>["grid","list"][Math.floor(Math.random()*2)],f_e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>{e({base64:r.result,mimeType:t.type,name:t.name})},r.onerror=s=>n(s)}),m_e=async(t,e,n,r,{fetchPexelsImages:s=ro,generateId:i=Ft}={})=>{const o=[],l={fashion:{min:20,max:200},electronics:{min:50,max:1300},food:{min:5,max:50},jewelry:{min:100,max:1e3},general:{min:10,max:300}},c=l[t]||l.general,u={fashion:["Classic Tee","Urban Jeans","Silk Scarf","Leather Boots","Summer Dress","Knit Sweater"],electronics:["HD Webcam","Noise-Cancelling Buds","Smart Display","Gaming Pad","Portable Drive","VR Headset"],food:["Artisan Bread","Gourmet Cheese","Organic Berries","Craft Coffee","Spiced Nuts","Dark Chocolate Bar"],jewelry:["Pearl Necklace","Sapphire Ring","Gold Hoops","Charm Bracelet","Silver Cufflinks","Diamond Studs"],general:["Utility Tool","Desk Organizer","Travel Mug","Yoga Mat","Scented Candle","Board Game"]},h=[...u[t]||u.general].sort(()=>.5-Math.random()).slice(0,e),f=h.map(g=>`${t} ${g} product shot`),m=await s(f.join(";"),e,"square");for(let g=0;g<e;g++){const x=h[g],v=m[g];let w;if(v&&v.src&&v.src.medium&&r)try{console.log(`[generateAIProductsData] Overlaying logo on Pexels image: ${v.src.medium}`),w=await overlayLogoOnProductImage(v.src.medium,r)}catch(_){console.error(`[generateAIProductsData] Failed to overlay logo on ${v.src.medium}, using original.`,_),w=v.src.medium}else v&&v.src&&v.src.medium?w=v.src.medium:w=`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(x)}`;o.push({id:`product-ai-${i()}`,name:x,price:parseFloat((Math.random()*(c.max-c.min)+c.min).toFixed(2)),description:Sse(t,x),rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,image:{id:v&&v.id||i(),src:{medium:w},alt:v&&v.alt||`Product image for ${x}`},storeName:n})}return o},p_e=async(t,{fetchPexelsImages:e=ro,generateId:n=Ft}={})=>{var T,R,A,E,I,N,k,j,D,L,G,B,W;const r=`store-wizard-${n()}`,{productType:s,storeName:i,logoUrl:o,products:l,prompt:c}=t;let u=[];(l.source==="ai"||l.source==="printOnDemand"||l.source==="manual")&&(u=l.items.map(X=>({id:X.id||`product-wizard-${n()}`,name:X.name,price:parseFloat(X.price)||0,description:X.description||"",images:X.images&&X.images.length>0?X.images:[`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(X.name||"Product")}`],image:{id:n(),src:{medium:X.images&&X.images.length>0?X.images[0]:`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(X.name||"Product")}`},alt:X.name||"Product Image"},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,isPrintOnDemand:X.isPrintOnDemand||!1,podDetails:X.podDetails||null,variants:X.variants||[]})));const d=3,h=await e(`${s} ${i} hero slideshow ${c}`,d,"landscape"),f=h.length>0?h[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},m=await La(`${s} ${i} store ambiance ${c}`,1,"landscape"),g=await gI(s,i,c),x=await La(g.featuresVideoQuery,1,"landscape");g.featuresVideoUrl=((T=x[0])==null?void 0:T.url)||null;const v=await e(`${i} ${s} abstract background`,1,"landscape"),w=((A=(R=v[0])==null?void 0:R.src)==null?void 0:A.large)||((I=(E=v[0])==null?void 0:E.src)==null?void 0:I.original)||"",_="v1";let C={...g,heroSlideshowImages:h.map(X=>({src:X.src.large,alt:X.alt||i+" hero image"})),...((N=t.content)==null?void 0:N.hero)&&{heroTitle:t.content.hero.heroTitle||g.heroTitle,heroDescription:t.content.hero.heroDescription||g.heroDescription},...((k=t.content)==null?void 0:k.storeWay)&&{storeWay:t.content.storeWay},imageRightSection:null,videoLeftSection:null};if(t.template_version==="sharp"){u.slice(0,3).map(V=>V.name).join(", ");const X={name:i,niche:s,description:c||`A ${s} store called ${i}`},H=await J$(X);if(H&&!H.error){const V=H.title||`${i} craftsmanship`,$=await e(V,1,"landscape");C.imageRightSection={...H,imageUrl:((D=(j=$[0])==null?void 0:j.src)==null?void 0:D.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const K=await X$(X);if(K&&!K.error){const V=K.title||`${i} product action`,$=await La(V,1,"landscape");C.videoLeftSection={...K,videoUrl:((L=$[0])==null?void 0:L.url)||null,videoPosterUrl:((G=$[0])==null?void 0:G.image)||null}}}return{id:r,name:i,template_version:_,type:s,description:C.heroDescription||g.heroDescription,prompt:c||`A ${s} store called ${i}`,products:u,collections:t.collections.items.map(X=>({id:X.id||`collection-wizard-${n()}`,name:X.name,description:X.description,imageUrl:X.imageUrl,product_ids:X.product_ids||[]})),hero_image:f,content:C,hero_video_url:((B=m[0])==null?void 0:B.url)||null,hero_video_poster_url:((W=m[0])==null?void 0:W.image)||null,logo_url:t.logoUrlDark||t.logoUrlLight||`https://via.placeholder.com/100x100.png?text=${i.substring(0,1)}`,logo_url_light:t.logoUrlLight||null,logo_url_dark:t.logoUrlDark||null,theme:{primaryColor:df(),secondaryColor:df(),fontFamily:mA(),layout:pA()},data_source:"wizard",card_background_url:w}},WS=async(t,{storeNameOverride:e=null,nicheDetails:n=null,isPrintOnDemand:r=!1,isDropshipping:s=!1,contextFiles:i=[],contextURLs:o=[],generateProducts:l=!0,fetchPexelsImages:c=ro,generateId:u=Ft}={},d=(h,f)=>{console.log(`Progress: ${h}%, Message: ${f||"(no message)"}`)})=>{var Be,ue,Ce,Ie,ve,ie,Me,He,yt,kt,en,mn,cn,fn;const h=(Ue,Et)=>{typeof Ue=="number"&&!isNaN(Ue)?d(Ue,Et):Et&&d(void 0,Et)};h(0,"Initializing store generation...");const f=`store-ai-${u()}`;let m=t,g=null,x=null;if(o&&o.length>0&&o.some(Ue=>Ue.trim()!=="")){h(2,"Analyzing context URLs...");try{const Ue=await a_e(o.filter(Et=>Et.trim()!==""));Ue?(m=`${t}

--- AI URL Analysis Context ---
${Ue}`,h(5,"URL analysis complete.")):h(5,"URL analysis did not return content.")}catch(Ue){console.error("[generateStoreFromPromptData] Error during URL analysis:",Ue),h(5,"URL analysis failed, continuing with prompt.")}}const v=i.filter(Ue=>Ue.type.startsWith("image/"));if(v.length>0){h(5,"Analyzing context images...");try{const Ue=v.map(f_e),Et=await Promise.all(Ue);g=await NG(Et),g&&!g.error?(console.log("[generateStoreFromPromptData] Image analysis successful:",g),h(10,"Image analysis complete."),m+=`

--- AI Image Analysis Context ---
${g.storePrompt}`,x=g.productType):(console.warn("[generateStoreFromPromptData] Image analysis failed or returned an error:",g==null?void 0:g.error),h(10,"Image analysis failed, continuing with prompt."))}catch(Ue){console.error("[generateStoreFromPromptData] Error during image analysis preparation:",Ue),h(10,"Image analysis failed, continuing with prompt.")}}const w=i.filter(Ue=>!Ue.type.startsWith("image/"));w.length>0&&(m+=`

--- Additional Context Files ---
`+w.map(Ue=>Ue.name).join(`
`));const _=m.toLowerCase().split(" ");let C="general";x?C=x:n&&n.name?C=n.name.toLowerCase().replace(/ /g,"-")||"general":_.some(Ue=>["clothing","fashion","apparel","wear"].includes(Ue))?C="fashion":_.some(Ue=>["tech","electronics","gadget","digital"].includes(Ue))?C="electronics":_.some(Ue=>["food","grocery","meal","organic"].includes(Ue))?C="food":_.some(Ue=>["jewelry","accessory","watch","luxury"].includes(Ue))&&(C="jewelry");let T=e,R=null;if(!T&&g&&g.storeNameSuggestions&&g.storeNameSuggestions.length>0&&(T=g.storeNameSuggestions[0],console.log(`[generateStoreFromPromptData] Using store name from image analysis: "${T}"`)),!T)try{R=await gse(t),R&&(T=R,console.log(`[generateStoreFromPromptData] Extracted store name via Gemini Function Calling: "${T}" (Raw response: "${R}")`))}catch(Ue){console.error("[generateStoreFromPromptData] Error during Gemini function call for name extraction:",Ue)}if(!T)try{console.log(`[generateStoreFromPromptData] No name from override or function call. Attempting AI name suggestion using prompt: "${t}"`),h(void 0,"Suggesting store names...");const Ue=await mI(t);if(Ue&&Ue.suggestions&&Ue.suggestions.length>0)T=Ue.suggestions[0],console.log(`[generateStoreFromPromptData] AI generated store name: ${T}`);else{console.warn("[generateStoreFromPromptData] AI name generation yielded no suggestions. Falling back to heuristic.");const Et=t.split(" ").filter(de=>de.charAt(0)===de.charAt(0).toUpperCase()&&de.length>2);Et.length>0&&(T=Et[0])}}catch(Ue){console.error("[generateStoreFromPromptData] Error during AI store name generation:",Ue);const Et=t.split(" ").filter(de=>de.charAt(0)===de.charAt(0).toUpperCase()&&de.length>2);Et.length>0&&(T=Et[0])}T||(T=`${C.charAt(0).toUpperCase()+C.slice(1)} Emporium ${u().substring(0,4)}`,console.log(`[generateStoreFromPromptData] Using final fallback store name: ${T}`)),T&&T.length>50&&(T=T.substring(0,50));let A=null,E=null,I=null,N=`https://via.placeholder.com/100x100.png?text=${T.substring(0,1)}`;try{console.log(`[generateStoreFromPromptData] Generating logo for: ${T}`),h(10,`Generating logo for ${T}...`);const Ue=(g==null?void 0:g.logoDescription)||m,Et=await Eg(Ue,h);if(Et){E=Et.logoUrlLight,I=Et.logoUrlDark,I?N=I:E&&(N=E);const de=E||I;if(de&&de.startsWith("data:image/")){const De=de.split(",");De.length===2&&(A=De[1])}console.log(`[generateStoreFromPromptData] Logos generated for ${T}. Light: ${!!E}, Dark: ${!!I}`),d(20,`${T} logo generated.`)}else console.warn(`[generateStoreFromPromptData] Logo generation did not return expected result for ${T}.`),h(20,`Logo generation issue for ${T}.`)}catch(Ue){console.error(`[generateStoreFromPromptData] Error generating logo for ${T}:`,Ue),h(20,`Error generating logo for ${T}.`)}h(25,`Generating ${C} products...`);const k=[],j=[],D=25,L=45;if(l)if(g&&g.products&&g.products.length>0)console.log("[generateStoreFromPromptData] Using products from image analysis."),h(25,"Populating products from image analysis..."),g.products.forEach(Ue=>{k.push({id:`product-img-analysis-${u()}`,name:Ue.name,price:parseFloat(Ue.price)||0,description:Ue.description,images:Ue.images,image:{id:u(),src:{medium:Ue.images[0]},alt:Ue.name},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,variants:[]}),j.push(Ue.name.toLowerCase().trim())}),h(D+L,`${k.length} products populated from analysis.`);else{let de=0;for(console.log(`[generateStoreFromPromptData] Attempting to generate 6 unique products for ${T} (type: ${C}).`);k.length<6&&de<12;){de++;const De=D+Math.floor(k.length/6*L);h(De,`Generating product ${k.length+1}/6...`);try{console.log(`[generateStoreFromPromptData] Generating product attempt ${de} (aiming for ${k.length+1}/6 unique products)... Excluding titles: ${j.join(", ")}`);const ee=await TG(C,T,A,"image/png",j,h,De,L/6,m);if(ee&&ee.images&&ee.images.length>0&&ee.title&&ee.title.trim()!==""&&typeof ee.price=="string"&&typeof ee.description=="string"){const ae=ee.title.toLowerCase().trim();if(j.includes(ae))console.warn(`[generateStoreFromPromptData] Duplicate product title generated and skipped: "${ee.title}". Attempt ${de}/12.`);else{let Q=ee.variants||[];if(C==="fashion"){const Pe=Q.some(Ve=>Ve.name.toLowerCase()==="size"),Ae=Q.some(Ve=>Ve.name.toLowerCase()==="color");Pe||Q.push({name:"Size",values:["S","M","L","XL"]}),Ae||Q.push({name:"Color",values:["White","Black","Blue","Red"]})}k.push({id:`product-gemini-${u()}`,name:ee.title,price:parseFloat(ee.price)||0,description:ee.description,images:ee.images,image:{id:u(),src:{medium:ee.images[0]},alt:ee.title},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,variants:Q}),j.push(ae),console.log(`[generateStoreFromPromptData] Product "${ee.title}" generated successfully and is unique. (${k.length}/6)`),h(D+Math.floor(k.length/6*L),`Product "${ee.title}" generated.`)}}else console.warn(`[generateStoreFromPromptData] Failed to generate complete data (or image) for product attempt ${de}. Data:`,ee)}catch(ee){console.error(`[generateStoreFromPromptData] Error during product generation attempt ${de}:`,ee)}}h(D+L,`${k.length} products generated.`),k.length<6&&console.warn(`[generateStoreFromPromptData] Could only generate ${k.length} unique products after 12 total attempts.`),k.length===0&&6>0&&console.warn("[generateStoreFromPromptData] No products were generated successfully. The store will be created with an empty product list.")}const G=3,B=await c(`${C} ${T} hero slideshow ${t}`,G,"landscape"),W=B.length>0?B[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},X=await La(`${C} ${T} store ambiance ${t}`,1,"landscape"),H=await La(`${T} ${C} product showcase`,1,"landscape");await La(`${T} ${C} craftsmanship process`,1,"landscape");const K={name:T,niche:C,description:m},V=await K$(K),$=await Y$(K),z=await pI(K),F=await gI(C,T,m),Z=await c(`${T} ${C} store background`,1,"landscape"),ce=((ue=(Be=Z[0])==null?void 0:Be.src)==null?void 0:ue.large)||((Ie=(Ce=Z[0])==null?void 0:Ce.src)==null?void 0:Ie.original)||"";let le="fresh";if(n&&n.templates&&n.templates.length>0){const Ue=n.templates.some(Et=>Et.toLowerCase()==="sharp");if(C==="technology"&&Ue)le="sharp";else{const Et=n.templates[0].toLowerCase();["classic","modern","v1"].includes(Et)?le="v1":Et==="premium"?le="premium":Et==="sharp"?le="sharp":Et==="sleek"&&(le="sleek")}}else t.toLowerCase().includes("modern")?le="v1":t.toLowerCase().includes("premium")?le="premium":t.toLowerCase().includes("sharp")?le="sharp":t.toLowerCase().includes("sleek")&&(le="sleek");le==="modern"&&(le="v1");let he={url:null,poster:null};if(le==="v2"){const Ue=await La(`${T} ${C} customer experience why choose us`,1,"landscape");he.url=((ve=Ue[0])==null?void 0:ve.url)||null,he.poster=((ie=Ue[0])==null?void 0:ie.image)||null}const Le=[];h(95,"Loading storefront...");let $e={id:f,name:T,template_version:le,type:C,description:V&&!V.error?V.heroDescription:F.heroDescription,prompt:m,products:k,collections:Le,hero_image:W,hero_video_url:((Me=X[0])==null?void 0:Me.url)||null,hero_video_poster_url:((He=X[0])==null?void 0:He.image)||null,logo_url:N,logo_url_light:E,logo_url_dark:I,theme:{primaryColor:(n==null?void 0:n.primaryColor)||df(),secondaryColor:(n==null?void 0:n.secondaryColor)||df(),fontFamily:mA(),layout:pA()},content:{...F,...V&&!V.error&&{heroTitle:V.heroTitle||F.heroTitle,heroDescription:V.heroDescription||F.heroDescription},...$&&!$.error&&{storeWay:$},...z&&!z.error&&{storeFeatures:z},heroSlideshowImages:B.map(Ue=>({src:Ue.src.large,alt:Ue.alt||T+" hero image"})),imageRightSection:null,videoLeftSection:null},data_source:"ai",card_background_url:ce};if(le==="sharp"){k.slice(0,3).map(de=>de.name).join(", ");const Ue=await J$(K);if(Ue&&!Ue.error){const de=Ue.title||`${T} craftsmanship`,De=await c(de,1,"landscape");$e.content.imageRightSection={...Ue,imageUrl:((kt=(yt=De[0])==null?void 0:yt.src)==null?void 0:kt.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const Et=await X$(K);if(Et&&!Et.error){const de=Et.title||`${T} product action`,De=await La(de,1,"landscape");$e.content.videoLeftSection={...Et,videoUrl:((en=De[0])==null?void 0:en.url)||null,videoPosterUrl:((mn=De[0])==null?void 0:mn.image)||null}}$e.content.heroFollowUpVideoUrl=((cn=H[0])==null?void 0:cn.url)||null,$e.content.heroFollowUpVideoPosterUrl=((fn=H[0])==null?void 0:fn.image)||null}else le==="fresh"&&($e.content.featuresVideoUrl=he.url,$e.content.featuresVideoPosterUrl=he.poster);return le!=="sharp"&&($e.content.heroFollowUpVideoUrl=null,$e.content.heroFollowUpVideoPosterUrl=null),le!=="fresh"&&($e.content.featuresVideoUrl=null,$e.content.featuresVideoPosterUrl=null),$e},HS=async(t,e,n,r,s,i,o,l,c)=>{var d,h;const u=[];if(n.length>0){const f=r||s?3:2,m=[],g=f*2;let x=0;for(i(o,"Generating collections for products..."),console.log(`[generateCollectionsForProducts] Attempting to generate ${f} collections for ${e}.`);u.length<f&&x<g;){x++;const v=o+Math.floor((u.length+1)/f*l);i(v,`Generating collection ${u.length+1}/${f} (Attempt ${x})...`);try{const w=await IG(t,e,n,m,i,v,l/f);if(w&&!w.error&&w.name){let _="";if(w.imageData)_=`data:image/png;base64,${w.imageData}`;else{const C=`${w.name} ${t} collection banner`;_=((h=(d=(await ro(C,1,"landscape"))[0])==null?void 0:d.src)==null?void 0:h.large)||`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(w.name||"Collection")}`}u.push({id:`collection-gemini-${c()}`,name:w.name,description:w.description,imageUrl:_,product_ids:w.product_ids||[]}),m.push(w.name),i(v,`Collection "${w.name}" generated.`)}else console.warn(w===null?`[generateCollectionsForProducts] Collection generation returned null (fallback prevented), attempt ${x}.`:`[generateCollectionsForProducts] Failed to generate complete data for collection attempt ${x}. Error: ${w==null?void 0:w.error}`)}catch(w){console.error(`[generateCollectionsForProducts] Error during collection generation attempt ${x}:`,w)}}i(o+l,`${u.length} collections generated.`)}else console.warn(`[generateCollectionsForProducts] Skipping collection generation as no products were provided for ${e}.`),i(o+l,"Skipped collection generation (no products).");return u},g_e=async(t,e)=>(await Wb(t,e,c_e)).shop,y_e=async(t,e,n=10,r=null)=>(await Wb(t,e,d_e,{first:n,cursor:r})).collections,x_e=async(t,e,n=10,r=null)=>(await Wb(t,e,u_e,{first:n,cursor:r})).products,v_e=async(t,e,n="US",r="EN")=>(await Wb(t,e,h_e,{})).localization,w_e=async(t,e,n,{generateId:r=Ft}={},s=null)=>{var h,f,m,g,x,v,w,_,C,T,R;console.log("Mapping BigCommerce Data:",{bcStoreSettings:t,bcProducts:e,domain:n,generatedLogoDataUrl:s});const i=e.map(A=>{var E,I,N,k,j,D,L;return{id:((E=A.entityId)==null?void 0:E.toString())||`bc-product-${r()}`,name:A.name||"Unnamed Product",description:A.description||`Product: ${A.name||"Unnamed Product"}`,price:parseFloat(((N=(I=A.prices)==null?void 0:I.price)==null?void 0:N.value)||0),currencyCode:((j=(k=A.prices)==null?void 0:k.price)==null?void 0:j.currencyCode)||"USD",image:{id:`bc-img-${r()}`,src:{medium:((D=A.defaultImage)==null?void 0:D.url)||`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(A.name||"Product")}`},alt:((L=A.defaultImage)==null?void 0:L.altText)||A.name||"Product Image"},sku:A.sku||"",rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*100)+10}}),o=s||((f=(h=t.logo)==null?void 0:h.image)==null?void 0:f.url)||`https://via.placeholder.com/100x100.png?text=${(t.storeName||"S").substring(0,1)}`,l=await gI("general",t.storeName||"My BigCommerce Store",t.description),c=await La(l.featuresVideoQuery,1,"landscape");l.featuresVideoUrl=((m=c[0])==null?void 0:m.url)||null;const u=await ro(`${t.storeName||"store"} background`,1,"landscape"),d=((x=(g=u[0])==null?void 0:g.src)==null?void 0:x.large)||((w=(v=u[0])==null?void 0:v.src)==null?void 0:w.original)||"";return{id:`store-bc-${(t.storeHash||n).replace(/[\.\/\:]/g,"-")}-${r()}`,name:t.storeName||"My BigCommerce Store",type:"bigcommerce-imported",description:t.description||`Store imported from ${n}`||l.heroDescription,products:i,hero_image:{id:r(),src:{large:((C=(_=t.logo)==null?void 0:_.image)==null?void 0:C.url)||`https://via.placeholder.com/1200x800.png?text=${encodeURIComponent(t.storeName||"Store")}`},alt:((R=(T=t.logo)==null?void 0:T.image)==null?void 0:R.altText)||t.storeName||"Store Hero"},logo_url:o,theme:{primaryColor:df(),secondaryColor:df(),fontFamily:mA(),layout:pA()},content:{...l,heroTitle:`Welcome to ${t.storeName||"Our Store"}`,heroDescription:t.description||l.heroDescription},data_source:"bigcommerce",card_background_url:d}};async function b_e(t,e){const n=`
    query StoreSettings {
      site {
        settings {
          storeName
          storeHash
          status
          logo {
            title
            image {
              url(width: 500)
              altText
            }
          }
        }
      }
    }
  `;if(typeof t!="string"||!t.trim()){const i=new TypeError("Invalid or empty storeDomain provided to fetchStoreSettings.");throw console.error(i.message,{storeDomain:t}),i}if(typeof e!="string"||!e.trim()){const i=new TypeError("Invalid or empty token provided to fetchStoreSettings.");throw console.error(i.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),i}const r=`https://${t}/graphql`,s={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})};console.log(`[fetchStoreSettings] Attempting to fetch: ${r}`,{domain:t,tokenProvided:!!e,queryLength:n.length});try{let i;try{i=await fetch(r,s)}catch(l){console.error(`[fetchStoreSettings] Initial fetch to ${r} failed:`,l);let c=`Initial fetch to ${r} failed.`;throw l.name==="TypeError"?c+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${l.message}`:c+=` Error: ${l.message||"Unknown network error"}`,new Error(c)}if(console.log(`[fetchStoreSettings] Response from ${r} - Status: ${i.status}, Complexity: ${i.headers.get("X-Bc-GraphQL-Complexity")}`),!i.ok){let l=`Could not retrieve error body (status: ${i.status}).`;try{l=await i.text()}catch(c){console.warn("Failed to read error response body:",c)}throw new Error(`HTTP error ${i.status} for ${r}: ${l}`)}let o;try{o=await i.json()}catch(l){let c="Could not retrieve raw response text after JSON parse failure.";try{c=await(await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})})).text()}catch(u){console.warn("Failed to re-fetch for raw text:",u)}throw console.error("Failed to parse JSON response from BigCommerce.",l,{graphqlUrl:r,rawTextPreview:c.substring(0,500)}),new Error(`Failed to parse JSON response from ${r}. Preview: ${c.substring(0,200)}...`)}if(o.errors)throw console.error("BigCommerce GraphQL errors (fetchStoreSettings):",o.errors,{graphqlUrl:r}),new Error(`GraphQL error: ${o.errors.map(l=>l.message).join(", ")}`);if(!o.data||!o.data.site||!o.data.site.settings)throw console.error("Invalid data structure in BigCommerce response (fetchStoreSettings):",o.data,{graphqlUrl:r}),new Error("Invalid data structure received from BigCommerce API for store settings.");return o.data.site.settings}catch(i){throw i.message.startsWith("Invalid or empty storeDomain")||i.message.startsWith("Invalid or empty token")||i.message.startsWith("HTTP error")||i.message.startsWith("GraphQL error")||i.message.startsWith("Failed to parse JSON")||i.message.startsWith("Network error")||console.error(`[fetchStoreSettings] Unexpected error for ${r}:`,i.name,i.message,i.stack,i),i}}async function xL(t,e){var l,c;let n=[],r=null,s=!0;if(typeof t!="string"||!t.trim()){const u=new TypeError("Invalid or empty storeDomain provided to fetchAllProducts.");throw console.error(u.message,{storeDomain:t}),u}if(typeof e!="string"||!e.trim()){const u=new TypeError("Invalid or empty token provided to fetchAllProducts.");throw console.error(u.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),u}const i=`https://${t}/graphql`,o=`
    query ProductsPage($first: Int!, $after: String) {
      site {
        products(first: $first, after: $after) {
          pageInfo {
            hasNextPage
            endCursor
          }
          edges {
            node {
              entityId
              name
              sku
              defaultImage {
                url(width: 800)
                altText
              }
              prices {
                price { value currencyCode }
                retailPrice { value currencyCode }
              }
            }
          }
        }
      }
    }
  `;console.log(`[fetchAllProducts] Starting to fetch products from: ${i}`,{domain:t,tokenProvided:!!e});try{let u=1;for(;s;){const d={first:50,after:r},h={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:o,variables:d})};let f;try{f=await fetch(i,h)}catch(x){console.error(`[fetchAllProducts] Initial fetch (Page ${u}) to ${i} failed:`,x);let v=`Initial fetch (Page ${u}) to ${i} failed.`;throw x.name==="TypeError"?v+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${x.message}`:v+=` Error: ${x.message||"Unknown network error"}`,new Error(v)}if(console.log(`[fetchAllProducts] Response (Page ${u}) from ${i} - Status: ${f.status}, Complexity: ${f.headers.get("X-Bc-GraphQL-Complexity")}`),u++,!f.ok){let x=`Could not retrieve error body (status: ${f.status}).`;try{x=await f.text()}catch(v){console.warn("[fetchAllProducts] Failed to read error response body:",v)}throw new Error(`HTTP error ${f.status} for ${i} (products): ${x}`)}let m;try{m=await f.json()}catch(x){let v="Could not retrieve raw response text after JSON parse failure (fetchAllProducts).";try{v=await(await fetch(i,h)).text()}catch{}throw console.error("[fetchAllProducts] Failed to parse JSON response from BigCommerce.",x,{graphqlUrl:i,rawTextPreview:v.substring(0,500)}),new Error(`Failed to parse JSON response from ${i} (products). Preview: ${v.substring(0,200)}...`)}if(m.errors)throw console.error("[fetchAllProducts] BigCommerce GraphQL errors:",m.errors,{graphqlUrl:i}),new Error(`GraphQL error (products): ${m.errors.map(x=>x.message).join(", ")}`);const g=(c=(l=m.data)==null?void 0:l.site)==null?void 0:c.products;if(!g||!g.edges||!g.pageInfo)throw console.error("[fetchAllProducts] Invalid data structure in BigCommerce response:",m.data,{graphqlUrl:i}),new Error("Invalid data structure received from BigCommerce API for products.");g.edges.forEach(x=>n.push(x.node)),s=g.pageInfo.hasNextPage,r=g.pageInfo.endCursor}return n}catch(u){throw u.message.startsWith("Invalid or empty storeDomain")||u.message.startsWith("Invalid or empty token")||u.message.startsWith("HTTP error")||u.message.startsWith("GraphQL error")||u.message.startsWith("Failed to parse JSON")||u.message.startsWith("Network error")||console.error(`[fetchAllProducts] Unexpected error for ${i}:`,u.name,u.message,u.stack,u),u}}const Xe=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("rounded-xl border bg-card text-card-foreground shadow-sm",t),...e}));Xe.displayName="Card";const ct=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("flex flex-col space-y-1.5 p-6",t),...e}));ct.displayName="CardHeader";const ut=ht.forwardRef(({className:t,...e},n)=>a.jsx("h3",{ref:n,className:bt("text-2xl font-semibold leading-none tracking-tight",t),...e}));ut.displayName="CardTitle";const Qt=ht.forwardRef(({className:t,...e},n)=>a.jsx("p",{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));Qt.displayName="CardDescription";const at=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("p-6 pt-0",t),...e}));at.displayName="CardContent";const md=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("flex items-center p-6 pt-0",t),...e}));md.displayName="CardFooter";const __e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),S_e=({isOpen:t,onClose:e,products:n,onFinalize:r})=>{const[s,i]=p.useState([]),[o,l]=p.useState(!1),[c,u]=p.useState({}),[d,h]=p.useState({}),[f,m]=p.useState(null),[g,x]=p.useState(!1),{toast:v}=vs(),{generatePodCollectionFromDesign:w,addPendingPodCollectionData:_,isGeneratingPodCollection:C,currentStore:T,isGenerating:R}=Vn();p.useEffect(()=>{n&&i(n.map($=>{var F,Z,ce;let z=[];if(Array.isArray($.images)?z=[...$.images]:(Z=(F=$.image)==null?void 0:F.src)!=null&&Z.medium&&(z=[$.image.src.medium]),$.isPrintOnDemand&&((ce=$.podDetails)!=null&&ce.originalDesignImageUrl)){const le=z.findIndex(he=>he!==$.podDetails.originalDesignImageUrl);if(le>0){const he=z.splice(le,1)[0];z.unshift(he)}}return{...$,images:z,variants:Array.isArray($.variants)?$.variants.map(le=>({...le,values:Array.isArray(le.values)?[...le.values]:[]})):[]}}))},[n]);const A=($,z,F)=>{i(Z=>{const ce=[...Z];return ce[$]={...ce[$],[z]:F},ce})},E=async($,z)=>{if(z)try{const F=await __e(z);i(Z=>{const ce=[...Z],le=Array.isArray(ce[$].images)?ce[$].images:[];return ce[$].images=[...le,F],ce})}catch(F){console.error("Error converting file to base64:",F),v({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},I=($,z)=>{i(F=>{const Z=[...F];return Z[$].images=Z[$].images.filter((ce,le)=>le!==z),Z})},N=async $=>{v({title:"Image Generation",description:"AI Image generation for this product is not yet implemented in this modal."}),console.log("Attempting to generate image for product at index:",$,s[$].name)},k=async $=>{const z=s[$];if(!z||!z.name){v({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const F=z.images&&z.images.length>0?z.images[0]:null;if(!F){v({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}u(Z=>({...Z,[$]:!0}));try{const{base64ImageData:Z,mimeType:ce}=await ig(F),le=z.name;let he=[];try{const $e=await B0(Z,ce,le);$e&&$e.length>0&&he.push(...$e.slice(0,2)),v({title:"Angles Generated",description:`${Math.min(2,($e==null?void 0:$e.length)||0)} angle images generated.`,variant:"success"})}catch($e){console.error("Error generating angles:",$e),v({title:"Angle Generation Failed",description:$e.message,variant:"destructive"})}const Le=[`Place this product, "${le}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${le}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const $e of Le)try{const Be=await $o(Z,ce,$e);Be&&Be.editedImageData&&he.push(`data:${Be.newMimeType};base64,${Be.editedImageData}`)}catch(Be){console.error(`Error generating context image with prompt "${$e}":`,Be),v({title:"Context Image Failed",description:`Failed for: ${$e.substring(0,30)}...`,variant:"destructive"})}v({title:"Context Images Attempted",description:`Attempted to generate ${Le.length} context images.`,variant:"success"}),he.length>0?i($e=>{const Be=[...$e],ue=Be[$],Ce=Array.isArray(ue.images)?ue.images:[],Ie=new Set(Ce),ve=he.filter(ie=>!Ie.has(ie));return ve.length>0?(ue.images=[...Ce,...ve],v({title:"Visuals Added",description:`${ve.length} new images added.`,variant:"success"})):v({title:"Visuals Generated",description:"Generated images were already present.",variant:"default"}),Be}):v({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"})}catch(Z){console.error("Error in handleGenerateMoreVisuals:",Z),v({title:"Visual Generation Error",description:Z.message,variant:"destructive"})}finally{u(Z=>({...Z,[$]:!1}))}},j=($,z,F)=>{i(Z=>{const ce=[...Z],le={...ce[$]};return le.variants=[...le.variants||[]],le.variants[z]={...le.variants[z],name:F},ce[$]=le,ce})},D=($,z,F,Z)=>{i(ce=>{const le=[...ce],he={...le[$]};he.variants=[...he.variants||[]];const Le={...he.variants[z]};return Le.values=[...Le.values||[]],Le.values[F]=Z,he.variants[z]=Le,le[$]=he,le})},L=($,z)=>{i(F=>{const Z=[...F],ce={...Z[$]};ce.variants=[...ce.variants||[]];const le={...ce.variants[z]};return le.values=[...le.values||[],""],ce.variants[z]=le,Z[$]=ce,Z})},G=($,z,F)=>{i(Z=>{const ce=[...Z],le={...ce[$]};le.variants=[...le.variants||[]];const he={...le.variants[z]};return he.values=(he.values||[]).filter((Le,$e)=>$e!==F),le.variants[z]=he,ce[$]=le,ce})},B=$=>{i(z=>{const F=[...z],Z={...F[$]};return Z.variants=[...Z.variants||[],{name:"",values:[""]}],F[$]=Z,F})},W=($,z)=>{i(F=>{const Z=[...F],ce={...Z[$]};return ce.variants=(ce.variants||[]).filter((le,he)=>he!==z),Z[$]=ce,Z})},X=()=>{if(!s.every(z=>z.name&&z.name.trim()!==""&&(z.price||z.price===0)&&String(z.price).trim()!=="")){v({title:"Missing Information",description:"Please ensure all products have a name and a valid price.",variant:"destructive"});return}r(s)},H=$=>{m($),x(!0)},K=async $=>{var he;const z=s[$];if(!z||!((he=z.podDetails)!=null&&he.originalDesignImageUrl)){v({title:"Error",description:"Product details or original design image missing for POD collection.",variant:"destructive"});return}const F=z.podDetails.originalDesignImageUrl,Z=z.podDetails.designPrompt||`Design based on ${z.name}`,ce=z.podDetails.baseProductName||z.name,le=await w(F,Z,ce);le&&le.newProducts&&le.newCollection?_({newProducts:le.newProducts,newCollection:le.newCollection}):console.error("POD Collection generation in modal failed or returned no data.")},V=async $=>{const z=s[$];if(!z||!z.name){v({title:"Missing Product Name",description:"Product name is required to generate a description.",variant:"destructive"});return}h(F=>({...F,[$]:!0}));try{const F={name:T==null?void 0:T.name,niche:T==null?void 0:T.niche,targetAudience:T==null?void 0:T.targetAudience,style:T==null?void 0:T.style},Z=await yse(z,F);if(Z.description)A($,"description",Z.description),v({title:"Description Generated",description:"The product description has been updated.",variant:"success"});else throw new Error(Z.error||"Failed to generate description.")}catch(F){console.error("Error generating product description:",F),v({title:"Description Generation Failed",description:F.message,variant:"destructive"})}finally{h(F=>({...F,[$]:!1}))}};return t?a.jsxs(a.Fragment,{children:[a.jsx(Yr,{open:t,onOpenChange:$=>!$&&e(),children:a.jsxs($r,{className:"max-w-3xl",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Finalize Your Products"}),a.jsx(Ji,{children:"Review and edit the AI-generated products before creating your store."})]}),a.jsx(Ls,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"space-y-6 pr-4",children:s.map(($,z)=>{var F;return a.jsxs(Xe,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productName-${z}`,children:"Product Name"}),a.jsx(Je,{id:`productName-${z}`,value:$.name,onChange:Z=>A(z,"name",Z.target.value),placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productPrice-${z}`,children:"Price (USD)"}),a.jsx(Je,{id:`productPrice-${z}`,type:"number",value:$.price,onChange:Z=>A(z,"price",Z.target.value),placeholder:"0.00"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{htmlFor:`productDescription-${z}`,children:"Description"}),a.jsx(En,{id:`productDescription-${z}`,value:$.description,onChange:Z=>A(z,"description",Z.target.value),placeholder:"Product Description",rows:3}),$.isDropshipping&&a.jsxs(O,{type:"button",variant:"outline",size:"sm",className:"absolute bottom-2 right-2 text-xs h-7",onClick:()=>V(z),disabled:d[z]||!$.name,children:[d[z]?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate"]})]}),a.jsxs("div",{className:"space-y-2 mb-[3px]",children:[a.jsx(Re,{children:"Product Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:($.images||[]).map((Z,ce)=>a.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>H(Z),children:[a.jsx("img",{src:Z,alt:`Product ${z+1} image ${ce+1}`,className:"w-full h-full object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>I(z,ce),children:a.jsx(Fn,{className:"h-3 w-3"})})]},ce))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${z}`).click(),children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsx(Je,{id:`productImageUpload-${z}`,type:"file",accept:"image/*",className:"hidden",onChange:Z=>E(z,Z.target.files[0])}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>N(z),disabled:o||!$.name,children:[o?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>k(z),disabled:c[z]||!$.name||!$.images||$.images.length===0,children:[c[z]?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"More Angles/Context"]})]}),$.isPrintOnDemand&&((F=$.podDetails)==null?void 0:F.originalDesignImageUrl)&&a.jsxs(O,{type:"button",variant:"outline",size:"sm",className:"mt-2 w-full",onClick:()=>K(z),disabled:c[z]||C,children:[C&&c[z]!==!0?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Pie,{className:"mr-2 h-4 w-4"}),"Create Full POD Collection"]})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),($.variants||[]).map((Z,ce)=>a.jsxs(Xe,{className:"p-2 space-y-2 bg-muted/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Re,{htmlFor:`variantName-${z}-${ce}`,className:"text-xs",children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>W(z,ce),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(Je,{id:`variantName-${z}-${ce}`,value:Z.name||"",onChange:le=>j(z,ce,le.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(Re,{className:"text-xs",children:"Option Values (comma-separated or add one by one)"}),(Z.values||[]).map((le,he)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Je,{value:le||"",onChange:Le=>D(z,ce,he,Le.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>G(z,ce,he),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]},he)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>L(z,ce),className:"text-xs h-7",children:[a.jsx(Li,{className:"mr-1 h-3 w-3"})," Add Value"]})]},ce)),a.jsxs(O,{variant:"outline",onClick:()=>B(z),className:"w-full text-sm h-8",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},$.id||z)})})}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",onClick:e,disabled:R,children:"Cancel"})}),a.jsxs(O,{type:"button",onClick:X,disabled:R,children:[R?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Finalize and Create Store"]})]})]})}),g&&f&&a.jsx(Yr,{open:g,onOpenChange:x,children:a.jsxs($r,{className:"max-w-xl max-h-[80vh]",children:[a.jsx(Ur,{children:a.jsx(Br,{children:"Enlarged Image"})}),a.jsx("div",{className:"flex justify-center items-center p-4 max-h-[70vh]",children:a.jsx("img",{src:f,alt:"Enlarged product",className:"max-w-full max-h-full object-contain"})})]})})]}):null};function In(){return In=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},In.apply(null,arguments)}function vL(t,[e,n]){return Math.min(n,Math.max(e,t))}function is(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function gA(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];function u(h){const{scope:f,children:m,...g}=h,x=(f==null?void 0:f[t][c])||l,v=p.useMemo(()=>g,Object.values(g));return p.createElement(x.Provider,{value:v},m)}function d(h,f){const m=(f==null?void 0:f[t][c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,C_e(s,...e)]}function C_e(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function E_e(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function AG(...t){return e=>t.forEach(n=>E_e(n,e))}function Fs(...t){return p.useCallback(AG(...t),t)}const og=p.forwardRef((t,e)=>{const{children:n,...r}=t,s=p.Children.toArray(n),i=s.find(I_e);if(i){const o=i.props.children,l=s.map(c=>c===i?p.Children.count(o)>1?p.Children.only(null):p.isValidElement(o)?o.props.children:null:c);return p.createElement(GT,In({},r,{ref:e}),p.isValidElement(o)?p.cloneElement(o,void 0,l):null)}return p.createElement(GT,In({},r,{ref:e}),n)});og.displayName="Slot";const GT=p.forwardRef((t,e)=>{const{children:n,...r}=t;return p.isValidElement(n)?p.cloneElement(n,{...N_e(r,n.props),ref:e?AG(e,n.ref):n.ref}):p.Children.count(n)>1?p.Children.only(null):null});GT.displayName="SlotClone";const T_e=({children:t})=>p.createElement(p.Fragment,null,t);function I_e(t){return p.isValidElement(t)&&t.type===T_e}function N_e(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{i(...l),s(...l)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function P_e(t){const e=t+"CollectionProvider",[n,r]=gA(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:g,children:x}=m,v=ht.useRef(null),w=ht.useRef(new Map).current;return ht.createElement(s,{scope:g,itemMap:w,collectionRef:v},x)},l=t+"CollectionSlot",c=ht.forwardRef((m,g)=>{const{scope:x,children:v}=m,w=i(l,x),_=Fs(g,w.collectionRef);return ht.createElement(og,{ref:_},v)}),u=t+"CollectionItemSlot",d="data-radix-collection-item",h=ht.forwardRef((m,g)=>{const{scope:x,children:v,...w}=m,_=ht.useRef(null),C=Fs(g,_),T=i(u,x);return ht.useEffect(()=>(T.itemMap.set(_,{ref:_,...w}),()=>void T.itemMap.delete(_))),ht.createElement(og,{[d]:"",ref:C},v)});function f(m){const g=i(t+"CollectionConsumer",m);return ht.useCallback(()=>{const v=g.collectionRef.current;if(!v)return[];const w=Array.from(v.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((T,R)=>w.indexOf(T.ref.current)-w.indexOf(R.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:c,ItemSlot:h},f,r]}const A_e=p.createContext(void 0);function k_e(t){const e=p.useContext(A_e);return t||e||"ltr"}const R_e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],ws=R_e.reduce((t,e)=>{const n=p.forwardRef((r,s)=>{const{asChild:i,...o}=r,l=i?og:e;return p.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),p.createElement(l,In({},o,{ref:s}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function j_e(t,e){t&&ml.flushSync(()=>t.dispatchEvent(e))}function ul(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...n)},[])}function D_e(t,e=globalThis==null?void 0:globalThis.document){const n=ul(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[n,e])}const WT="dismissableLayer.update",M_e="dismissableLayer.pointerDownOutside",L_e="dismissableLayer.focusOutside";let wL;const F_e=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),O_e=p.forwardRef((t,e)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...u}=t,d=p.useContext(F_e),[h,f]=p.useState(null),m=(n=h==null?void 0:h.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,g]=p.useState({}),x=Fs(e,I=>f(I)),v=Array.from(d.layers),[w]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),_=v.indexOf(w),C=h?v.indexOf(h):-1,T=d.layersWithOutsidePointerEventsDisabled.size>0,R=C>=_,A=V_e(I=>{const N=I.target,k=[...d.branches].some(j=>j.contains(N));!R||k||(i==null||i(I),l==null||l(I),I.defaultPrevented||c==null||c())},m),E=$_e(I=>{const N=I.target;[...d.branches].some(j=>j.contains(N))||(o==null||o(I),l==null||l(I),I.defaultPrevented||c==null||c())},m);return D_e(I=>{C===d.layers.size-1&&(s==null||s(I),!I.defaultPrevented&&c&&(I.preventDefault(),c()))},m),p.useEffect(()=>{if(h)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(wL=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),bL(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=wL)}},[h,m,r,d]),p.useEffect(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),bL())},[h,d]),p.useEffect(()=>{const I=()=>g({});return document.addEventListener(WT,I),()=>document.removeEventListener(WT,I)},[]),p.createElement(ws.div,In({},u,{ref:x,style:{pointerEvents:T?R?"auto":"none":void 0,...t.style},onFocusCapture:is(t.onFocusCapture,E.onFocusCapture),onBlurCapture:is(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:is(t.onPointerDownCapture,A.onPointerDownCapture)}))});function V_e(t,e=globalThis==null?void 0:globalThis.document){const n=ul(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let u=function(){kG(M_e,n,c,{discrete:!0})};const c={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=u,e.addEventListener("click",s.current,{once:!0})):u()}r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function $_e(t,e=globalThis==null?void 0:globalThis.document){const n=ul(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&kG(L_e,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function bL(){const t=new CustomEvent(WT);document.dispatchEvent(t)}function kG(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?j_e(s,i):s.dispatchEvent(i)}let qS=0;function U_e(){p.useEffect(()=>{var t,e;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=n[0])!==null&&t!==void 0?t:_L()),document.body.insertAdjacentElement("beforeend",(e=n[1])!==null&&e!==void 0?e:_L()),qS++,()=>{qS===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),qS--}},[])}function _L(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}const KS="focusScope.autoFocusOnMount",YS="focusScope.autoFocusOnUnmount",SL={bubbles:!1,cancelable:!0},B_e=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=ul(s),d=ul(i),h=p.useRef(null),f=Fs(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(C){if(m.paused||!l)return;const T=C.target;l.contains(T)?h.current=T:Ll(h.current,{select:!0})},v=function(C){if(m.paused||!l)return;const T=C.relatedTarget;T!==null&&(l.contains(T)||Ll(h.current,{select:!0}))},w=function(C){const T=document.activeElement;for(const R of C)R.removedNodes.length>0&&(l!=null&&l.contains(T)||Ll(l))};document.addEventListener("focusin",x),document.addEventListener("focusout",v);const _=new MutationObserver(w);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",v),_.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){EL.add(m);const x=document.activeElement;if(!l.contains(x)){const w=new CustomEvent(KS,SL);l.addEventListener(KS,u),l.dispatchEvent(w),w.defaultPrevented||(z_e(K_e(RG(l)),{select:!0}),document.activeElement===x&&Ll(l))}return()=>{l.removeEventListener(KS,u),setTimeout(()=>{const w=new CustomEvent(YS,SL);l.addEventListener(YS,d),l.dispatchEvent(w),w.defaultPrevented||Ll(x??document.body,{select:!0}),l.removeEventListener(YS,d),EL.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const v=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,w=document.activeElement;if(v&&w){const _=x.currentTarget,[C,T]=G_e(_);C&&T?!x.shiftKey&&w===T?(x.preventDefault(),n&&Ll(C,{select:!0})):x.shiftKey&&w===C&&(x.preventDefault(),n&&Ll(T,{select:!0})):w===_&&x.preventDefault()}},[n,r,m.paused]);return p.createElement(ws.div,In({tabIndex:-1},o,{ref:f,onKeyDown:g}))});function z_e(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ll(r,{select:e}),document.activeElement!==n)return}function G_e(t){const e=RG(t),n=CL(e,t),r=CL(e.reverse(),t);return[n,r]}function RG(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function CL(t,e){for(const n of t)if(!W_e(n,{upTo:e}))return n}function W_e(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function H_e(t){return t instanceof HTMLInputElement&&"select"in t}function Ll(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&H_e(t)&&e&&t.select()}}const EL=q_e();function q_e(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=TL(t,e),t.unshift(e)},remove(e){var n;t=TL(t,e),(n=t[0])===null||n===void 0||n.resume()}}}function TL(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function K_e(t){return t.filter(e=>e.tagName!=="A")}const po=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},Y_e=i0["useId".toString()]||(()=>{});let J_e=0;function jG(t){const[e,n]=p.useState(Y_e());return po(()=>{t||n(r=>r??String(J_e++))},[t]),t||(e?`radix-${e}`:"")}const X_e=["top","right","bottom","left"],Nc=Math.min,Di=Math.max,Kw=Math.round,gx=Math.floor,xa=t=>({x:t,y:t}),Q_e={left:"right",right:"left",bottom:"top",top:"bottom"},Z_e={start:"end",end:"start"};function HT(t,e,n){return Di(t,Nc(e,n))}function dl(t,e){return typeof t=="function"?t(e):t}function hl(t){return t.split("-")[0]}function Pf(t){return t.split("-")[1]}function yA(t){return t==="x"?"y":"x"}function xA(t){return t==="y"?"height":"width"}function ua(t){return["top","bottom"].includes(hl(t))?"y":"x"}function vA(t){return yA(ua(t))}function eSe(t,e,n){n===void 0&&(n=!1);const r=Pf(t),s=vA(t),i=xA(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=Yw(o)),[o,Yw(o)]}function tSe(t){const e=Yw(t);return[qT(t),e,qT(e)]}function qT(t){return t.replace(/start|end/g,e=>Z_e[e])}function nSe(t,e,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?i:o;default:return[]}}function rSe(t,e,n,r){const s=Pf(t);let i=nSe(hl(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(qT)))),i}function Yw(t){return t.replace(/left|right|bottom|top/g,e=>Q_e[e])}function sSe(t){return{top:0,right:0,bottom:0,left:0,...t}}function DG(t){return typeof t!="number"?sSe(t):{top:t,right:t,bottom:t,left:t}}function Jw(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function IL(t,e,n){let{reference:r,floating:s}=t;const i=ua(e),o=vA(e),l=xA(o),c=hl(e),u=i==="y",d=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[l]/2-s[l]/2;let m;switch(c){case"top":m={x:d,y:r.y-s.height};break;case"bottom":m={x:d,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:h};break;case"left":m={x:r.x-s.width,y:h};break;default:m={x:r.x,y:r.y}}switch(Pf(e)){case"start":m[o]-=f*(n&&u?-1:1);break;case"end":m[o]+=f*(n&&u?-1:1);break}return m}const iSe=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:d,y:h}=IL(u,r,c),f=r,m={},g=0;for(let x=0;x<l.length;x++){const{name:v,fn:w}=l[x],{x:_,y:C,data:T,reset:R}=await w({x:d,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:m,rects:u,platform:o,elements:{reference:t,floating:e}});d=_??d,h=C??h,m={...m,[v]:{...m[v],...T}},R&&g<=50&&(g++,typeof R=="object"&&(R.placement&&(f=R.placement),R.rects&&(u=R.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):R.rects),{x:d,y:h}=IL(u,f,c)),x=-1)}return{x:d,y:h,placement:f,strategy:s,middlewareData:m}};async function ag(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:l,strategy:c}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=dl(e,t),g=DG(m),v=l[f?h==="floating"?"reference":"floating":h],w=Jw(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),_=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,C=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),T=await(i.isElement==null?void 0:i.isElement(C))?await(i.getScale==null?void 0:i.getScale(C))||{x:1,y:1}:{x:1,y:1},R=Jw(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:_,offsetParent:C,strategy:c}):_);return{top:(w.top-R.top+g.top)/T.y,bottom:(R.bottom-w.bottom+g.bottom)/T.y,left:(w.left-R.left+g.left)/T.x,right:(R.right-w.right+g.right)/T.x}}const oSe=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:l,middlewareData:c}=e,{element:u,padding:d=0}=dl(t,e)||{};if(u==null)return{};const h=DG(d),f={x:n,y:r},m=vA(s),g=xA(m),x=await o.getDimensions(u),v=m==="y",w=v?"top":"left",_=v?"bottom":"right",C=v?"clientHeight":"clientWidth",T=i.reference[g]+i.reference[m]-f[m]-i.floating[g],R=f[m]-i.reference[m],A=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let E=A?A[C]:0;(!E||!await(o.isElement==null?void 0:o.isElement(A)))&&(E=l.floating[C]||i.floating[g]);const I=T/2-R/2,N=E/2-x[g]/2-1,k=Nc(h[w],N),j=Nc(h[_],N),D=k,L=E-x[g]-j,G=E/2-x[g]/2+I,B=HT(D,G,L),W=!c.arrow&&Pf(s)!=null&&G!==B&&i.reference[g]/2-(G<D?k:j)-x[g]/2<0,X=W?G<D?G-D:G-L:0;return{[m]:f[m]+X,data:{[m]:B,centerOffset:G-B-X,...W&&{alignmentOffset:X}},reset:W}}}),aSe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:x=!0,...v}=dl(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const w=hl(s),_=ua(l),C=hl(l)===l,T=await(c.isRTL==null?void 0:c.isRTL(u.floating)),R=f||(C||!x?[Yw(l)]:tSe(l)),A=g!=="none";!f&&A&&R.push(...rSe(l,x,g,T));const E=[l,...R],I=await ag(e,v),N=[];let k=((r=i.flip)==null?void 0:r.overflows)||[];if(d&&N.push(I[w]),h){const G=eSe(s,o,T);N.push(I[G[0]],I[G[1]])}if(k=[...k,{placement:s,overflows:N}],!N.every(G=>G<=0)){var j,D;const G=(((j=i.flip)==null?void 0:j.index)||0)+1,B=E[G];if(B&&(!(h==="alignment"?_!==ua(B):!1)||k.every(H=>H.overflows[0]>0&&ua(H.placement)===_)))return{data:{index:G,overflows:k},reset:{placement:B}};let W=(D=k.filter(X=>X.overflows[0]<=0).sort((X,H)=>X.overflows[1]-H.overflows[1])[0])==null?void 0:D.placement;if(!W)switch(m){case"bestFit":{var L;const X=(L=k.filter(H=>{if(A){const K=ua(H.placement);return K===_||K==="y"}return!0}).map(H=>[H.placement,H.overflows.filter(K=>K>0).reduce((K,V)=>K+V,0)]).sort((H,K)=>H[1]-K[1])[0])==null?void 0:L[0];X&&(W=X);break}case"initialPlacement":W=l;break}if(s!==W)return{reset:{placement:W}}}return{}}}};function NL(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function PL(t){return X_e.some(e=>t[e]>=0)}const lSe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=dl(t,e);switch(r){case"referenceHidden":{const i=await ag(e,{...s,elementContext:"reference"}),o=NL(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:PL(o)}}}case"escaped":{const i=await ag(e,{...s,altBoundary:!0}),o=NL(i,n.floating);return{data:{escapedOffsets:o,escaped:PL(o)}}}default:return{}}}}};async function cSe(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=hl(n),l=Pf(n),c=ua(n)==="y",u=["left","top"].includes(o)?-1:1,d=i&&c?-1:1,h=dl(e,t);let{mainAxis:f,crossAxis:m,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof g=="number"&&(m=l==="end"?g*-1:g),c?{x:m*d,y:f*u}:{x:f*u,y:m*d}}const uSe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:l}=e,c=await cSe(e,t);return o===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},dSe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:v=>{let{x:w,y:_}=v;return{x:w,y:_}}},...c}=dl(t,e),u={x:n,y:r},d=await ag(e,c),h=ua(hl(s)),f=yA(h);let m=u[f],g=u[h];if(i){const v=f==="y"?"top":"left",w=f==="y"?"bottom":"right",_=m+d[v],C=m-d[w];m=HT(_,m,C)}if(o){const v=h==="y"?"top":"left",w=h==="y"?"bottom":"right",_=g+d[v],C=g-d[w];g=HT(_,g,C)}const x=l.fn({...e,[f]:m,[h]:g});return{...x,data:{x:x.x-n,y:x.y-r,enabled:{[f]:i,[h]:o}}}}}},hSe=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=dl(t,e),d={x:n,y:r},h=ua(s),f=yA(h);let m=d[f],g=d[h];const x=dl(l,e),v=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(c){const C=f==="y"?"height":"width",T=i.reference[f]-i.floating[C]+v.mainAxis,R=i.reference[f]+i.reference[C]-v.mainAxis;m<T?m=T:m>R&&(m=R)}if(u){var w,_;const C=f==="y"?"width":"height",T=["top","left"].includes(hl(s)),R=i.reference[h]-i.floating[C]+(T&&((w=o.offset)==null?void 0:w[h])||0)+(T?0:v.crossAxis),A=i.reference[h]+i.reference[C]+(T?0:((_=o.offset)==null?void 0:_[h])||0)-(T?v.crossAxis:0);g<R?g=R:g>A&&(g=A)}return{[f]:m,[h]:g}}}},fSe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:l}=e,{apply:c=()=>{},...u}=dl(t,e),d=await ag(e,u),h=hl(s),f=Pf(s),m=ua(s)==="y",{width:g,height:x}=i.floating;let v,w;h==="top"||h==="bottom"?(v=h,w=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(w=h,v=f==="end"?"top":"bottom");const _=x-d.top-d.bottom,C=g-d.left-d.right,T=Nc(x-d[v],_),R=Nc(g-d[w],C),A=!e.middlewareData.shift;let E=T,I=R;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(I=C),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(E=_),A&&!f){const k=Di(d.left,0),j=Di(d.right,0),D=Di(d.top,0),L=Di(d.bottom,0);m?I=g-2*(k!==0||j!==0?k+j:Di(d.left,d.right)):E=x-2*(D!==0||L!==0?D+L:Di(d.top,d.bottom))}await c({...e,availableWidth:I,availableHeight:E});const N=await o.getDimensions(l.floating);return g!==N.width||x!==N.height?{reset:{rects:!0}}:{}}}};function Hb(){return typeof window<"u"}function Af(t){return MG(t)?(t.nodeName||"").toLowerCase():"#document"}function zi(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Ia(t){var e;return(e=(MG(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function MG(t){return Hb()?t instanceof Node||t instanceof zi(t).Node:!1}function Bo(t){return Hb()?t instanceof Element||t instanceof zi(t).Element:!1}function _a(t){return Hb()?t instanceof HTMLElement||t instanceof zi(t).HTMLElement:!1}function AL(t){return!Hb()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof zi(t).ShadowRoot}function ry(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=zo(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function mSe(t){return["table","td","th"].includes(Af(t))}function qb(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function wA(t){const e=bA(),n=Bo(t)?zo(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function pSe(t){let e=Pc(t);for(;_a(e)&&!hf(e);){if(wA(e))return e;if(qb(e))return null;e=Pc(e)}return null}function bA(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function hf(t){return["html","body","#document"].includes(Af(t))}function zo(t){return zi(t).getComputedStyle(t)}function Kb(t){return Bo(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Pc(t){if(Af(t)==="html")return t;const e=t.assignedSlot||t.parentNode||AL(t)&&t.host||Ia(t);return AL(e)?e.host:e}function LG(t){const e=Pc(t);return hf(e)?t.ownerDocument?t.ownerDocument.body:t.body:_a(e)&&ry(e)?e:LG(e)}function lg(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=LG(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=zi(s);if(i){const l=KT(o);return e.concat(o,o.visualViewport||[],ry(s)?s:[],l&&n?lg(l):[])}return e.concat(s,lg(s,[],n))}function KT(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function FG(t){const e=zo(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=_a(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,l=Kw(n)!==i||Kw(r)!==o;return l&&(n=i,r=o),{width:n,height:r,$:l}}function _A(t){return Bo(t)?t:t.contextElement}function Rh(t){const e=_A(t);if(!_a(e))return xa(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=FG(e);let o=(i?Kw(n.width):n.width)/r,l=(i?Kw(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const gSe=xa(0);function OG(t){const e=zi(t);return!bA()||!e.visualViewport?gSe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function ySe(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==zi(t)?!1:e}function id(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=_A(t);let o=xa(1);e&&(r?Bo(r)&&(o=Rh(r)):o=Rh(t));const l=ySe(i,n,r)?OG(i):xa(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,h=s.height/o.y;if(i){const f=zi(i),m=r&&Bo(r)?zi(r):r;let g=f,x=KT(g);for(;x&&r&&m!==g;){const v=Rh(x),w=x.getBoundingClientRect(),_=zo(x),C=w.left+(x.clientLeft+parseFloat(_.paddingLeft))*v.x,T=w.top+(x.clientTop+parseFloat(_.paddingTop))*v.y;c*=v.x,u*=v.y,d*=v.x,h*=v.y,c+=C,u+=T,g=zi(x),x=KT(g)}}return Jw({width:d,height:h,x:c,y:u})}function SA(t,e){const n=Kb(t).scrollLeft;return e?e.left+n:id(Ia(t)).left+n}function VG(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=r.left+e.scrollLeft-(n?0:SA(t,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function xSe(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=Ia(r),l=e?qb(e.floating):!1;if(r===o||l&&i)return n;let c={scrollLeft:0,scrollTop:0},u=xa(1);const d=xa(0),h=_a(r);if((h||!h&&!i)&&((Af(r)!=="body"||ry(o))&&(c=Kb(r)),_a(r))){const m=id(r);u=Rh(r),d.x=m.x+r.clientLeft,d.y=m.y+r.clientTop}const f=o&&!h&&!i?VG(o,c,!0):xa(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-c.scrollTop*u.y+d.y+f.y}}function vSe(t){return Array.from(t.getClientRects())}function wSe(t){const e=Ia(t),n=Kb(t),r=t.ownerDocument.body,s=Di(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Di(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+SA(t);const l=-n.scrollTop;return zo(r).direction==="rtl"&&(o+=Di(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:l}}function bSe(t,e){const n=zi(t),r=Ia(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const u=bA();(!u||u&&e==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:i,height:o,x:l,y:c}}function _Se(t,e){const n=id(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=_a(t)?Rh(t):xa(1),o=t.clientWidth*i.x,l=t.clientHeight*i.y,c=s*i.x,u=r*i.y;return{width:o,height:l,x:c,y:u}}function kL(t,e,n){let r;if(e==="viewport")r=bSe(t,n);else if(e==="document")r=wSe(Ia(t));else if(Bo(e))r=_Se(e,n);else{const s=OG(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Jw(r)}function $G(t,e){const n=Pc(t);return n===e||!Bo(n)||hf(n)?!1:zo(n).position==="fixed"||$G(n,e)}function SSe(t,e){const n=e.get(t);if(n)return n;let r=lg(t,[],!1).filter(l=>Bo(l)&&Af(l)!=="body"),s=null;const i=zo(t).position==="fixed";let o=i?Pc(t):t;for(;Bo(o)&&!hf(o);){const l=zo(o),c=wA(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||ry(o)&&!c&&$G(t,o))?r=r.filter(d=>d!==o):s=l,o=Pc(o)}return e.set(t,r),r}function CSe(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?qb(e)?[]:SSe(e,this._c):[].concat(n),r],l=o[0],c=o.reduce((u,d)=>{const h=kL(e,d,s);return u.top=Di(h.top,u.top),u.right=Nc(h.right,u.right),u.bottom=Nc(h.bottom,u.bottom),u.left=Di(h.left,u.left),u},kL(e,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function ESe(t){const{width:e,height:n}=FG(t);return{width:e,height:n}}function TSe(t,e,n){const r=_a(e),s=Ia(e),i=n==="fixed",o=id(t,!0,i,e);let l={scrollLeft:0,scrollTop:0};const c=xa(0);function u(){c.x=SA(s)}if(r||!r&&!i)if((Af(e)!=="body"||ry(s))&&(l=Kb(e)),r){const m=id(e,!0,i,e);c.x=m.x+e.clientLeft,c.y=m.y+e.clientTop}else s&&u();i&&!r&&s&&u();const d=s&&!r&&!i?VG(s,l):xa(0),h=o.left+l.scrollLeft-c.x-d.x,f=o.top+l.scrollTop-c.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function JS(t){return zo(t).position==="static"}function RL(t,e){if(!_a(t)||zo(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Ia(t)===n&&(n=n.ownerDocument.body),n}function UG(t,e){const n=zi(t);if(qb(t))return n;if(!_a(t)){let s=Pc(t);for(;s&&!hf(s);){if(Bo(s)&&!JS(s))return s;s=Pc(s)}return n}let r=RL(t,e);for(;r&&mSe(r)&&JS(r);)r=RL(r,e);return r&&hf(r)&&JS(r)&&!wA(r)?n:r||pSe(t)||n}const ISe=async function(t){const e=this.getOffsetParent||UG,n=this.getDimensions,r=await n(t.floating);return{reference:TSe(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function NSe(t){return zo(t).direction==="rtl"}const PSe={convertOffsetParentRelativeRectToViewportRelativeRect:xSe,getDocumentElement:Ia,getClippingRect:CSe,getOffsetParent:UG,getElementRects:ISe,getClientRects:vSe,getDimensions:ESe,getScale:Rh,isElement:Bo,isRTL:NSe};function BG(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function ASe(t,e){let n=null,r;const s=Ia(t);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:m}=u;if(l||e(),!f||!m)return;const g=gx(h),x=gx(s.clientWidth-(d+f)),v=gx(s.clientHeight-(h+m)),w=gx(d),C={rootMargin:-g+"px "+-x+"px "+-v+"px "+-w+"px",threshold:Di(0,Nc(1,c))||1};let T=!0;function R(A){const E=A[0].intersectionRatio;if(E!==c){if(!T)return o();E?o(!1,E):r=setTimeout(()=>{o(!1,1e-7)},1e3)}E===1&&!BG(u,t.getBoundingClientRect())&&o(),T=!1}try{n=new IntersectionObserver(R,{...C,root:s.ownerDocument})}catch{n=new IntersectionObserver(R,C)}n.observe(t)}return o(!0),i}function zG(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=_A(t),d=s||i?[...u?lg(u):[],...lg(e)]:[];d.forEach(w=>{s&&w.addEventListener("scroll",n,{passive:!0}),i&&w.addEventListener("resize",n)});const h=u&&l?ASe(u,n):null;let f=-1,m=null;o&&(m=new ResizeObserver(w=>{let[_]=w;_&&_.target===u&&m&&(m.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var C;(C=m)==null||C.observe(e)})),n()}),u&&!c&&m.observe(u),m.observe(e));let g,x=c?id(t):null;c&&v();function v(){const w=id(t);x&&!BG(x,w)&&n(),x=w,g=requestAnimationFrame(v)}return n(),()=>{var w;d.forEach(_=>{s&&_.removeEventListener("scroll",n),i&&_.removeEventListener("resize",n)}),h==null||h(),(w=m)==null||w.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const kSe=uSe,RSe=dSe,jSe=aSe,DSe=fSe,MSe=lSe,jL=oSe,LSe=hSe,FSe=(t,e,n)=>{const r=new Map,s={platform:PSe,...n},i={...s.platform,_c:r};return iSe(t,e,{...s,platform:i})};var OSe=typeof document<"u",VSe=function(){},mv=OSe?p.useLayoutEffect:VSe;function Xw(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Xw(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!Xw(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function GG(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function DL(t,e){const n=GG(t);return Math.round(e*n)/n}function XS(t){const e=p.useRef(t);return mv(()=>{e.current=t}),e}function WG(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[d,h]=p.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,m]=p.useState(r);Xw(f,r)||m(r);const[g,x]=p.useState(null),[v,w]=p.useState(null),_=p.useCallback(H=>{H!==A.current&&(A.current=H,x(H))},[]),C=p.useCallback(H=>{H!==E.current&&(E.current=H,w(H))},[]),T=i||g,R=o||v,A=p.useRef(null),E=p.useRef(null),I=p.useRef(d),N=c!=null,k=XS(c),j=XS(s),D=XS(u),L=p.useCallback(()=>{if(!A.current||!E.current)return;const H={placement:e,strategy:n,middleware:f};j.current&&(H.platform=j.current),FSe(A.current,E.current,H).then(K=>{const V={...K,isPositioned:D.current!==!1};G.current&&!Xw(I.current,V)&&(I.current=V,ml.flushSync(()=>{h(V)}))})},[f,e,n,j,D]);mv(()=>{u===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,h(H=>({...H,isPositioned:!1})))},[u]);const G=p.useRef(!1);mv(()=>(G.current=!0,()=>{G.current=!1}),[]),mv(()=>{if(T&&(A.current=T),R&&(E.current=R),T&&R){if(k.current)return k.current(T,R,L);L()}},[T,R,L,k,N]);const B=p.useMemo(()=>({reference:A,floating:E,setReference:_,setFloating:C}),[_,C]),W=p.useMemo(()=>({reference:T,floating:R}),[T,R]),X=p.useMemo(()=>{const H={position:n,left:0,top:0};if(!W.floating)return H;const K=DL(W.floating,d.x),V=DL(W.floating,d.y);return l?{...H,transform:"translate("+K+"px, "+V+"px)",...GG(W.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:K,top:V}},[n,l,W.floating,d.x,d.y]);return p.useMemo(()=>({...d,update:L,refs:B,elements:W,floatingStyles:X}),[d,L,B,W,X])}const $Se=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?jL({element:r.current,padding:s}).fn(n):{}:r?jL({element:r,padding:s}).fn(n):{}}}},HG=(t,e)=>({...kSe(t),options:[t,e]}),qG=(t,e)=>({...RSe(t),options:[t,e]}),KG=(t,e)=>({...LSe(t),options:[t,e]}),YG=(t,e)=>({...jSe(t),options:[t,e]}),JG=(t,e)=>({...DSe(t),options:[t,e]}),XG=(t,e)=>({...MSe(t),options:[t,e]}),QG=(t,e)=>({...$Se(t),options:[t,e]});function USe(t){const[e,n]=p.useState(void 0);return po(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}const ZG="Popper",[e7,t7]=gA(ZG),[BSe,n7]=e7(ZG),zSe=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return p.createElement(BSe,{scope:e,anchor:r,onAnchorChange:s},n)},GSe="PopperAnchor",WSe=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=n7(GSe,n),o=p.useRef(null),l=Fs(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:p.createElement(ws.div,In({},s,{ref:l}))}),r7="PopperContent",[HSe,gje]=e7(r7),qSe=p.forwardRef((t,e)=>{var n,r,s,i,o,l,c,u;const{__scopePopper:d,side:h="bottom",sideOffset:f=0,align:m="center",alignOffset:g=0,arrowPadding:x=0,collisionBoundary:v=[],collisionPadding:w=0,sticky:_="partial",hideWhenDetached:C=!1,avoidCollisions:T=!0,onPlaced:R,...A}=t,E=n7(r7,d),[I,N]=p.useState(null),k=Fs(e,ve=>N(ve)),[j,D]=p.useState(null),L=USe(j),G=(n=L==null?void 0:L.width)!==null&&n!==void 0?n:0,B=(r=L==null?void 0:L.height)!==null&&r!==void 0?r:0,W=h+(m!=="center"?"-"+m:""),X=typeof w=="number"?w:{top:0,right:0,bottom:0,left:0,...w},H=Array.isArray(v)?v:[v],K=H.length>0,V={padding:X,boundary:H.filter(KSe),altBoundary:K},{refs:$,floatingStyles:z,placement:F,isPositioned:Z,middlewareData:ce}=WG({strategy:"fixed",placement:W,whileElementsMounted:zG,elements:{reference:E.anchor},middleware:[HG({mainAxis:f+B,alignmentAxis:g}),T&&qG({mainAxis:!0,crossAxis:!1,limiter:_==="partial"?KG():void 0,...V}),T&&YG({...V}),JG({...V,apply:({elements:ve,rects:ie,availableWidth:Me,availableHeight:He})=>{const{width:yt,height:kt}=ie.reference,en=ve.floating.style;en.setProperty("--radix-popper-available-width",`${Me}px`),en.setProperty("--radix-popper-available-height",`${He}px`),en.setProperty("--radix-popper-anchor-width",`${yt}px`),en.setProperty("--radix-popper-anchor-height",`${kt}px`)}}),j&&QG({element:j,padding:x}),YSe({arrowWidth:G,arrowHeight:B}),C&&XG({strategy:"referenceHidden"})]}),[le,he]=s7(F),Le=ul(R);po(()=>{Z&&(Le==null||Le())},[Z,Le]);const $e=(s=ce.arrow)===null||s===void 0?void 0:s.x,Be=(i=ce.arrow)===null||i===void 0?void 0:i.y,ue=((o=ce.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[Ce,Ie]=p.useState();return po(()=>{I&&Ie(window.getComputedStyle(I).zIndex)},[I]),p.createElement("div",{ref:$.setFloating,"data-radix-popper-content-wrapper":"",style:{...z,transform:Z?z.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Ce,"--radix-popper-transform-origin":[(l=ce.transformOrigin)===null||l===void 0?void 0:l.x,(c=ce.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},p.createElement(HSe,{scope:d,placedSide:le,onArrowChange:D,arrowX:$e,arrowY:Be,shouldHideArrow:ue},p.createElement(ws.div,In({"data-side":le,"data-align":he},A,{ref:k,style:{...A.style,animation:Z?void 0:"none",opacity:(u=ce.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function KSe(t){return t!==null}const YSe=t=>({name:"transformOrigin",options:t,fn(e){var n,r,s,i,o;const{placement:l,rects:c,middlewareData:u}=e,h=((n=u.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,f=h?0:t.arrowWidth,m=h?0:t.arrowHeight,[g,x]=s7(l),v={start:"0%",center:"50%",end:"100%"}[x],w=((r=(s=u.arrow)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0)+f/2,_=((i=(o=u.arrow)===null||o===void 0?void 0:o.y)!==null&&i!==void 0?i:0)+m/2;let C="",T="";return g==="bottom"?(C=h?v:`${w}px`,T=`${-m}px`):g==="top"?(C=h?v:`${w}px`,T=`${c.floating.height+m}px`):g==="right"?(C=`${-m}px`,T=h?v:`${_}px`):g==="left"&&(C=`${c.floating.width+m}px`,T=h?v:`${_}px`),{data:{x:C,y:T}}}});function s7(t){const[e,n="center"]=t.split("-");return[e,n]}const JSe=zSe,XSe=WSe,QSe=qSe,ZSe=p.forwardRef((t,e)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...s}=t;return r?aI.createPortal(p.createElement(ws.div,In({},s,{ref:e})),r):null});function ML({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=eCe({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,l=ul(n),c=p.useCallback(u=>{if(i){const h=typeof u=="function"?u(t):u;h!==t&&l(h)}else s(u)},[i,t,s,l]);return[o,c]}function eCe({defaultProp:t,onChange:e}){const n=p.useState(t),[r]=n,s=p.useRef(r),i=ul(e);return p.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}function tCe(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}const nCe=p.forwardRef((t,e)=>p.createElement(ws.span,In({},t,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}})));var i7=z3(),QS=function(){},Yb=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:QS,onWheelCapture:QS,onTouchMoveCapture:QS}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noIsolation,g=t.inert,x=t.allowPinchZoom,v=t.as,w=v===void 0?"div":v,_=bf(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),C=f,T=B3([n,e]),R=ks(ks({},_),s);return p.createElement(p.Fragment,null,d&&p.createElement(C,{sideCar:i7,removeScrollBar:u,shards:h,noIsolation:m,inert:g,setCallbacks:i,allowPinchZoom:!!x,lockRef:n}),o?p.cloneElement(p.Children.only(l),ks(ks({},R),{ref:T})):p.createElement(w,ks({},R,{className:c,ref:T}),l))});Yb.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Yb.classNames={fullWidth:Gm,zeroRight:zm};var YT=!1;if(typeof window<"u")try{var yx=Object.defineProperty({},"passive",{get:function(){return YT=!0,!0}});window.addEventListener("test",yx,yx),window.removeEventListener("test",yx,yx)}catch{YT=!1}var Fd=YT?{passive:!1}:!1,rCe=function(t){return t.tagName==="TEXTAREA"},o7=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!rCe(t)&&n[e]==="visible")},sCe=function(t){return o7(t,"overflowY")},iCe=function(t){return o7(t,"overflowX")},LL=function(t,e){var n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=a7(t,n);if(r){var s=l7(t,n),i=s[1],o=s[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},oCe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},aCe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},a7=function(t,e){return t==="v"?sCe(e):iCe(e)},l7=function(t,e){return t==="v"?oCe(e):aCe(e)},lCe=function(t,e){return t==="h"&&e==="rtl"?-1:1},cCe=function(t,e,n,r,s){var i=lCe(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=l7(t,l),g=m[0],x=m[1],v=m[2],w=x-v-i*g;(g||w)&&a7(t,l)&&(h+=w,f+=g),l=l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&h===0||!s&&o>h)||!d&&(s&&f===0||!s&&-o>f))&&(u=!0),u},xx=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},FL=function(t){return[t.deltaX,t.deltaY]},OL=function(t){return t&&"current"in t?t.current:t},uCe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},dCe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},hCe=0,Od=[];function fCe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(hCe++)[0],i=p.useState(function(){return AI()})[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=U3([t.lockRef.current],(t.shards||[]).map(OL),!0).filter(Boolean);return x.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,v){if("touches"in x&&x.touches.length===2)return!o.current.allowPinchZoom;var w=xx(x),_=n.current,C="deltaX"in x?x.deltaX:_[0]-w[0],T="deltaY"in x?x.deltaY:_[1]-w[1],R,A=x.target,E=Math.abs(C)>Math.abs(T)?"h":"v";if("touches"in x&&E==="h"&&A.type==="range")return!1;var I=LL(E,A);if(!I)return!0;if(I?R=E:(R=E==="v"?"h":"v",I=LL(E,A)),!I)return!1;if(!r.current&&"changedTouches"in x&&(C||T)&&(r.current=R),!R)return!0;var N=r.current||R;return cCe(N,v,x,N==="h"?C:T,!0)},[]),c=p.useCallback(function(x){var v=x;if(!(!Od.length||Od[Od.length-1]!==i)){var w="deltaY"in v?FL(v):xx(v),_=e.current.filter(function(R){return R.name===v.type&&R.target===v.target&&uCe(R.delta,w)})[0];if(_&&_.should){v.cancelable&&v.preventDefault();return}if(!_){var C=(o.current.shards||[]).map(OL).filter(Boolean).filter(function(R){return R.contains(v.target)}),T=C.length>0?l(v,C[0]):!o.current.noIsolation;T&&v.cancelable&&v.preventDefault()}}},[]),u=p.useCallback(function(x,v,w,_){var C={name:x,delta:v,target:w,should:_};e.current.push(C),setTimeout(function(){e.current=e.current.filter(function(T){return T!==C})},1)},[]),d=p.useCallback(function(x){n.current=xx(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,FL(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,xx(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return Od.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Fd),document.addEventListener("touchmove",c,Fd),document.addEventListener("touchstart",d,Fd),function(){Od=Od.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,Fd),document.removeEventListener("touchmove",c,Fd),document.removeEventListener("touchstart",d,Fd)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:dCe(s)}):null,m?p.createElement(q3,{gapMode:"margin"}):null)}const mCe=W3(i7,fCe);var c7=p.forwardRef(function(t,e){return p.createElement(Yb,ks({},t,{ref:e,sideCar:mCe}))});c7.classNames=Yb.classNames;const pCe=c7,gCe=[" ","Enter","ArrowUp","ArrowDown"],yCe=[" ","Enter"],Jb="Select",[Xb,Qb,xCe]=P_e(Jb),[kf,yje]=gA(Jb,[xCe,t7]),CA=t7(),[vCe,pd]=kf(Jb),[wCe,bCe]=kf(Jb),_Ce=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:h,disabled:f,required:m}=t,g=CA(e),[x,v]=p.useState(null),[w,_]=p.useState(null),[C,T]=p.useState(!1),R=k_e(u),[A=!1,E]=ML({prop:r,defaultProp:s,onChange:i}),[I,N]=ML({prop:o,defaultProp:l,onChange:c}),k=p.useRef(null),j=x?!!x.closest("form"):!0,[D,L]=p.useState(new Set),G=Array.from(D).map(B=>B.props.value).join(";");return p.createElement(JSe,g,p.createElement(vCe,{required:m,scope:e,trigger:x,onTriggerChange:v,valueNode:w,onValueNodeChange:_,valueNodeHasChildren:C,onValueNodeHasChildrenChange:T,contentId:jG(),value:I,onValueChange:N,open:A,onOpenChange:E,dir:R,triggerPointerDownPosRef:k,disabled:f},p.createElement(Xb.Provider,{scope:e},p.createElement(wCe,{scope:t.__scopeSelect,onNativeOptionAdd:p.useCallback(B=>{L(W=>new Set(W).add(B))},[]),onNativeOptionRemove:p.useCallback(B=>{L(W=>{const X=new Set(W);return X.delete(B),X})},[])},n)),j?p.createElement(f7,{key:G,"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:h,value:I,onChange:B=>N(B.target.value),disabled:f},I===void 0?p.createElement("option",{value:""}):null,Array.from(D)):null))},SCe="SelectTrigger",CCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...s}=t,i=CA(n),o=pd(SCe,n),l=o.disabled||r,c=Fs(e,o.onTriggerChange),u=Qb(n),[d,h,f]=m7(g=>{const x=u().filter(_=>!_.disabled),v=x.find(_=>_.value===o.value),w=p7(x,g,v);w!==void 0&&o.onValueChange(w.value)}),m=()=>{l||(o.onOpenChange(!0),f())};return p.createElement(XSe,In({asChild:!0},i),p.createElement(ws.button,In({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":o.value===void 0?"":void 0},s,{ref:c,onClick:is(s.onClick,g=>{g.currentTarget.focus()}),onPointerDown:is(s.onPointerDown,g=>{const x=g.target;x.hasPointerCapture(g.pointerId)&&x.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&(m(),o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)},g.preventDefault())}),onKeyDown:is(s.onKeyDown,g=>{const x=d.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(x&&g.key===" ")&&gCe.includes(g.key)&&(m(),g.preventDefault())})})))}),ECe="SelectValue",TCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:o,...l}=t,c=pd(ECe,n),{onValueNodeHasChildrenChange:u}=c,d=i!==void 0,h=Fs(e,c.onValueNodeChange);return po(()=>{u(d)},[u,d]),p.createElement(ws.span,In({},l,{ref:h,style:{pointerEvents:"none"}}),c.value===void 0&&o!==void 0?o:i)}),ICe=p.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...s}=t;return p.createElement(ws.span,In({"aria-hidden":!0},s,{ref:e}),r||"")}),NCe=t=>p.createElement(ZSe,In({asChild:!0},t)),ff="SelectContent",PCe=p.forwardRef((t,e)=>{const n=pd(ff,t.__scopeSelect),[r,s]=p.useState();if(po(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?ml.createPortal(p.createElement(u7,{scope:t.__scopeSelect},p.createElement(Xb.Slot,{scope:t.__scopeSelect},p.createElement("div",null,t.children))),i):null}return p.createElement(ACe,In({},t,{ref:e}))}),Da=10,[u7,gd]=kf(ff),ACe=p.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:v,...w}=t,_=pd(ff,n),[C,T]=p.useState(null),[R,A]=p.useState(null),E=Fs(e,he=>T(he)),[I,N]=p.useState(null),[k,j]=p.useState(null),D=Qb(n),[L,G]=p.useState(!1),B=p.useRef(!1);p.useEffect(()=>{if(C)return L0(C)},[C]),U_e();const W=p.useCallback(he=>{const[Le,...$e]=D().map(Ce=>Ce.ref.current),[Be]=$e.slice(-1),ue=document.activeElement;for(const Ce of he)if(Ce===ue||(Ce==null||Ce.scrollIntoView({block:"nearest"}),Ce===Le&&R&&(R.scrollTop=0),Ce===Be&&R&&(R.scrollTop=R.scrollHeight),Ce==null||Ce.focus(),document.activeElement!==ue))return},[D,R]),X=p.useCallback(()=>W([I,C]),[W,I,C]);p.useEffect(()=>{L&&X()},[L,X]);const{onOpenChange:H,triggerPointerDownPosRef:K}=_;p.useEffect(()=>{if(C){let he={x:0,y:0};const Le=Be=>{var ue,Ce,Ie,ve;he={x:Math.abs(Math.round(Be.pageX)-((ue=(Ce=K.current)===null||Ce===void 0?void 0:Ce.x)!==null&&ue!==void 0?ue:0)),y:Math.abs(Math.round(Be.pageY)-((Ie=(ve=K.current)===null||ve===void 0?void 0:ve.y)!==null&&Ie!==void 0?Ie:0))}},$e=Be=>{he.x<=10&&he.y<=10?Be.preventDefault():C.contains(Be.target)||H(!1),document.removeEventListener("pointermove",Le),K.current=null};return K.current!==null&&(document.addEventListener("pointermove",Le),document.addEventListener("pointerup",$e,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Le),document.removeEventListener("pointerup",$e,{capture:!0})}}},[C,H,K]),p.useEffect(()=>{const he=()=>H(!1);return window.addEventListener("blur",he),window.addEventListener("resize",he),()=>{window.removeEventListener("blur",he),window.removeEventListener("resize",he)}},[H]);const[V,$]=m7(he=>{const Le=D().filter(ue=>!ue.disabled),$e=Le.find(ue=>ue.ref.current===document.activeElement),Be=p7(Le,he,$e);Be&&setTimeout(()=>Be.ref.current.focus())}),z=p.useCallback((he,Le,$e)=>{const Be=!B.current&&!$e;(_.value!==void 0&&_.value===Le||Be)&&(N(he),Be&&(B.current=!0))},[_.value]),F=p.useCallback(()=>C==null?void 0:C.focus(),[C]),Z=p.useCallback((he,Le,$e)=>{const Be=!B.current&&!$e;(_.value!==void 0&&_.value===Le||Be)&&j(he)},[_.value]),ce=r==="popper"?VL:kCe,le=ce===VL?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:v}:{};return p.createElement(u7,{scope:n,content:C,viewport:R,onViewportChange:A,itemRefCallback:z,selectedItem:I,onItemLeave:F,itemTextRefCallback:Z,focusSelectedItem:X,selectedItemText:k,position:r,isPositioned:L,searchRef:V},p.createElement(pCe,{as:og,allowPinchZoom:!0},p.createElement(B_e,{asChild:!0,trapped:_.open,onMountAutoFocus:he=>{he.preventDefault()},onUnmountAutoFocus:is(s,he=>{var Le;(Le=_.trigger)===null||Le===void 0||Le.focus({preventScroll:!0}),he.preventDefault()})},p.createElement(O_e,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:he=>he.preventDefault(),onDismiss:()=>_.onOpenChange(!1)},p.createElement(ce,In({role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:he=>he.preventDefault()},w,le,{onPlaced:()=>G(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...w.style},onKeyDown:is(w.onKeyDown,he=>{const Le=he.ctrlKey||he.altKey||he.metaKey;if(he.key==="Tab"&&he.preventDefault(),!Le&&he.key.length===1&&$(he.key),["ArrowUp","ArrowDown","Home","End"].includes(he.key)){let Be=D().filter(ue=>!ue.disabled).map(ue=>ue.ref.current);if(["ArrowUp","End"].includes(he.key)&&(Be=Be.slice().reverse()),["ArrowUp","ArrowDown"].includes(he.key)){const ue=he.target,Ce=Be.indexOf(ue);Be=Be.slice(Ce+1)}setTimeout(()=>W(Be)),he.preventDefault()}})}))))))}),kCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...s}=t,i=pd(ff,n),o=gd(ff,n),[l,c]=p.useState(null),[u,d]=p.useState(null),h=Fs(e,E=>d(E)),f=Qb(n),m=p.useRef(!1),g=p.useRef(!0),{viewport:x,selectedItem:v,selectedItemText:w,focusSelectedItem:_}=o,C=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&x&&v&&w){const E=i.trigger.getBoundingClientRect(),I=u.getBoundingClientRect(),N=i.valueNode.getBoundingClientRect(),k=w.getBoundingClientRect();if(i.dir!=="rtl"){const ue=k.left-I.left,Ce=N.left-ue,Ie=E.left-Ce,ve=E.width+Ie,ie=Math.max(ve,I.width),Me=window.innerWidth-Da,He=vL(Ce,[Da,Me-ie]);l.style.minWidth=ve+"px",l.style.left=He+"px"}else{const ue=I.right-k.right,Ce=window.innerWidth-N.right-ue,Ie=window.innerWidth-E.right-Ce,ve=E.width+Ie,ie=Math.max(ve,I.width),Me=window.innerWidth-Da,He=vL(Ce,[Da,Me-ie]);l.style.minWidth=ve+"px",l.style.right=He+"px"}const j=f(),D=window.innerHeight-Da*2,L=x.scrollHeight,G=window.getComputedStyle(u),B=parseInt(G.borderTopWidth,10),W=parseInt(G.paddingTop,10),X=parseInt(G.borderBottomWidth,10),H=parseInt(G.paddingBottom,10),K=B+W+L+H+X,V=Math.min(v.offsetHeight*5,K),$=window.getComputedStyle(x),z=parseInt($.paddingTop,10),F=parseInt($.paddingBottom,10),Z=E.top+E.height/2-Da,ce=D-Z,le=v.offsetHeight/2,he=v.offsetTop+le,Le=B+W+he,$e=K-Le;if(Le<=Z){const ue=v===j[j.length-1].ref.current;l.style.bottom="0px";const Ce=u.clientHeight-x.offsetTop-x.offsetHeight,Ie=Math.max(ce,le+(ue?F:0)+Ce+X),ve=Le+Ie;l.style.height=ve+"px"}else{const ue=v===j[0].ref.current;l.style.top="0px";const Ie=Math.max(Z,B+x.offsetTop+(ue?z:0)+le)+$e;l.style.height=Ie+"px",x.scrollTop=Le-Z+x.offsetTop}l.style.margin=`${Da}px 0`,l.style.minHeight=V+"px",l.style.maxHeight=D+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,u,x,v,w,i.dir,r]);po(()=>C(),[C]);const[T,R]=p.useState();po(()=>{u&&R(window.getComputedStyle(u).zIndex)},[u]);const A=p.useCallback(E=>{E&&g.current===!0&&(C(),_==null||_(),g.current=!1)},[C,_]);return p.createElement(RCe,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:A},p.createElement("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T}},p.createElement(ws.div,In({},s,{ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}}))))}),VL=p.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Da,...i}=t,o=CA(n);return p.createElement(QSe,In({},o,i,{ref:e,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[RCe,EA]=kf(ff,{}),$L="SelectViewport",jCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=gd($L,n),i=EA($L,n),o=Fs(e,s.onViewportChange),l=p.useRef(0);return p.createElement(p.Fragment,null,p.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),p.createElement(Xb.Slot,{scope:n},p.createElement(ws.div,In({"data-radix-select-viewport":"",role:"presentation"},r,{ref:o,style:{position:"relative",flex:1,overflow:"auto",...r.style},onScroll:is(r.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=i;if(h!=null&&h.current&&d){const f=Math.abs(l.current-u.scrollTop);if(f>0){const m=window.innerHeight-Da*2,g=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),v=Math.max(g,x);if(v<m){const w=v+f,_=Math.min(m,w),C=w-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=C>0?C:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})}))))}),DCe="SelectGroup",[xje,MCe]=kf(DCe),LCe="SelectLabel",FCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=MCe(LCe,n);return p.createElement(ws.div,In({id:s.id},r,{ref:e}))}),JT="SelectItem",[OCe,d7]=kf(JT),VCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...o}=t,l=pd(JT,n),c=gd(JT,n),u=l.value===r,[d,h]=p.useState(i??""),[f,m]=p.useState(!1),g=Fs(e,w=>{var _;return(_=c.itemRefCallback)===null||_===void 0?void 0:_.call(c,w,r,s)}),x=jG(),v=()=>{s||(l.onValueChange(r),l.onOpenChange(!1))};return p.createElement(OCe,{scope:n,value:r,disabled:s,textId:x,isSelected:u,onItemTextChange:p.useCallback(w=>{h(_=>{var C;return _||((C=w==null?void 0:w.textContent)!==null&&C!==void 0?C:"").trim()})},[])},p.createElement(Xb.ItemSlot,{scope:n,value:r,disabled:s,textValue:d},p.createElement(ws.div,In({role:"option","aria-labelledby":x,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1},o,{ref:g,onFocus:is(o.onFocus,()=>m(!0)),onBlur:is(o.onBlur,()=>m(!1)),onPointerUp:is(o.onPointerUp,v),onPointerMove:is(o.onPointerMove,w=>{if(s){var _;(_=c.onItemLeave)===null||_===void 0||_.call(c)}else w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:is(o.onPointerLeave,w=>{if(w.currentTarget===document.activeElement){var _;(_=c.onItemLeave)===null||_===void 0||_.call(c)}}),onKeyDown:is(o.onKeyDown,w=>{var _;((_=c.searchRef)===null||_===void 0?void 0:_.current)!==""&&w.key===" "||(yCe.includes(w.key)&&v(),w.key===" "&&w.preventDefault())})}))))}),vx="SelectItemText",$Ce=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,...i}=t,o=pd(vx,n),l=gd(vx,n),c=d7(vx,n),u=bCe(vx,n),[d,h]=p.useState(null),f=Fs(e,w=>h(w),c.onItemTextChange,w=>{var _;return(_=l.itemTextRefCallback)===null||_===void 0?void 0:_.call(l,w,c.value,c.disabled)}),m=d==null?void 0:d.textContent,g=p.useMemo(()=>p.createElement("option",{key:c.value,value:c.value,disabled:c.disabled},m),[c.disabled,c.value,m]),{onNativeOptionAdd:x,onNativeOptionRemove:v}=u;return po(()=>(x(g),()=>v(g)),[x,v,g]),p.createElement(p.Fragment,null,p.createElement(ws.span,In({id:c.textId},i,{ref:f})),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?ml.createPortal(i.children,o.valueNode):null)}),UCe="SelectItemIndicator",BCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return d7(UCe,n).isSelected?p.createElement(ws.span,In({"aria-hidden":!0},r,{ref:e})):null}),UL="SelectScrollUpButton",zCe=p.forwardRef((t,e)=>{const n=gd(UL,t.__scopeSelect),r=EA(UL,t.__scopeSelect),[s,i]=p.useState(!1),o=Fs(e,r.onScrollButtonChange);return po(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollTop>0;i(u)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(h7,In({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}})):null}),BL="SelectScrollDownButton",GCe=p.forwardRef((t,e)=>{const n=gd(BL,t.__scopeSelect),r=EA(BL,t.__scopeSelect),[s,i]=p.useState(!1),o=Fs(e,r.onScrollButtonChange);return po(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollHeight-l.clientHeight,d=Math.ceil(l.scrollTop)<u;i(d)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(h7,In({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}})):null}),h7=p.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=t,i=gd("SelectScrollButton",n),o=p.useRef(null),l=Qb(n),c=p.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),po(()=>{var u;const d=l().find(h=>h.ref.current===document.activeElement);d==null||(u=d.ref.current)===null||u===void 0||u.scrollIntoView({block:"nearest"})},[l]),p.createElement(ws.div,In({"aria-hidden":!0},s,{ref:e,style:{flexShrink:0,...s.style},onPointerDown:is(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:is(s.onPointerMove,()=>{var u;(u=i.onItemLeave)===null||u===void 0||u.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:is(s.onPointerLeave,()=>{c()})}))}),WCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return p.createElement(ws.div,In({"aria-hidden":!0},r,{ref:e}))}),f7=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=p.useRef(null),i=Fs(e,s),o=tCe(n);return p.useEffect(()=>{const l=s.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==n&&d){const h=new Event("change",{bubbles:!0});d.call(l,n),l.dispatchEvent(h)}},[o,n]),p.createElement(nCe,{asChild:!0},p.createElement("select",In({},r,{ref:i,defaultValue:n})))});f7.displayName="BubbleSelect";function m7(t){const e=ul(t),n=p.useRef(""),r=p.useRef(0),s=p.useCallback(o=>{const l=n.current+o;e(l),function c(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),i=p.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function p7(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=HCe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function HCe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}const qCe=_Ce,g7=CCe,KCe=TCe,YCe=ICe,JCe=NCe,y7=PCe,XCe=jCe,x7=FCe,v7=VCe,QCe=$Ce,ZCe=BCe,w7=zCe,b7=GCe,_7=WCe,pc=qCe,gc=KCe,Xa=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(g7,{ref:r,className:bt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,a.jsx(YCe,{asChild:!0,children:a.jsx(Su,{className:"h-4 w-4 opacity-50"})})]}));Xa.displayName=g7.displayName;const S7=ht.forwardRef(({className:t,...e},n)=>a.jsx(w7,{ref:n,className:bt("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(_3,{className:"h-4 w-4"})}));S7.displayName=w7.displayName;const C7=ht.forwardRef(({className:t,...e},n)=>a.jsx(b7,{ref:n,className:bt("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(Su,{className:"h-4 w-4"})}));C7.displayName=b7.displayName;const Qa=ht.forwardRef(({className:t,children:e,position:n="popper",...r},s)=>a.jsx(JCe,{children:a.jsxs(y7,{ref:s,className:bt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[a.jsx(S7,{}),a.jsx(XCe,{className:bt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),a.jsx(C7,{})]})}));Qa.displayName=y7.displayName;const eEe=ht.forwardRef(({className:t,...e},n)=>a.jsx(x7,{ref:n,className:bt("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));eEe.displayName=x7.displayName;const Jn=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(v7,{ref:r,className:bt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(ZCe,{children:a.jsx(Sg,{className:"h-4 w-4"})})}),a.jsx(QCe,{children:e})]}));Jn.displayName=v7.displayName;const tEe=ht.forwardRef(({className:t,...e},n)=>a.jsx(_7,{ref:n,className:bt("-mx-1 my-1 h-px bg-muted",t),...e}));tEe.displayName=_7.displayName;const nEe=({isOpen:t,onClose:e,designs:n,onContinue:r})=>{const[s,i]=p.useState([]),[o,l]=p.useState({}),[c,u]=p.useState(""),[d,h]=p.useState(null),{toast:f}=vs();p.useEffect(()=>{n&&i(n)},[n]);const m=(_,C)=>{const T=Zi.find(R=>R.name===C);T&&i(R=>{const A=[...R];return A[_].podProductInfo=T,A[_].name=T.name,A})},g=_=>{const C=s[_],T={...C,id:Ft()};i(R=>[...R,T]),f({title:"Design Duplicated",description:`A copy of ${C.name} has been added.`})},x=_=>{const C=s[_];i(T=>T.filter((R,A)=>A!==_)),f({title:"Design Removed",description:`${C.name} has been removed.`,variant:"destructive"})},v=async _=>{if(!c){f({title:"Prompt Required",description:"Please enter a prompt to edit the image.",variant:"destructive"});return}l({[_]:{edit:!0}});const C=s[_];try{const{base64ImageData:T,mimeType:R}=await ig(C.images[0]),A=await $o(T,R,c);if(A&&A.editedImageData){const E=[...s],I=`data:${A.newMimeType};base64,${A.editedImageData}`;E[_].images[0]=I,i(E),f({title:"Design Edited",description:"The design has been updated.",variant:"success"})}else throw new Error("Failed to get edited image data.")}catch(T){console.error("Error editing design:",T),f({title:"Edit Failed",description:T.message,variant:"destructive"})}finally{l({}),h(null),u("")}},w=async _=>{if(!c){f({title:"Prompt Required",description:"Please enter a prompt to replace the image.",variant:"destructive"});return}l({[_]:{replace:!0}});try{const C=await Tg({prompt:c});if(C&&C.imageData){const T=[...s],R=`data:${C.imageMimeType};base64,${C.imageData}`;T[_].images[0]=R,i(T),f({title:"Design Replaced",description:"A new design has been generated.",variant:"success"})}else throw new Error("Failed to get new image data.")}catch(C){console.error("Error replacing design:",C),f({title:"Replace Failed",description:C.message,variant:"destructive"})}finally{l({}),h(null),u("")}};return t?a.jsx(Yr,{open:t,onOpenChange:_=>!_&&e(),children:a.jsxs($r,{className:"max-w-4xl",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Review and Edit Your Designs"}),a.jsx(Ji,{children:"Modify the generated designs before we create your logo and products."})]}),a.jsx(Ls,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pr-4",children:s.map((_,C)=>{var T,R,A,E;return a.jsxs(Xe,{className:"p-4 space-y-3 flex flex-col",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:_.images[0],alt:`Design for ${_.name}`,className:"w-full h-48 object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6",onClick:()=>x(C),children:a.jsx(Fn,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow space-y-2",children:[a.jsx("h4",{className:"font-semibold",children:_.name}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:`product-type-${C}`,className:"text-sm font-medium",children:"Product Type"}),a.jsxs(pc,{value:_.podProductInfo.name,onValueChange:I=>m(C,I),children:[a.jsx(Xa,{children:a.jsx(gc,{placeholder:"Select product type"})}),a.jsx(Qa,{children:Zi.map(I=>a.jsx(Jn,{value:I.name,children:I.name},I.name))})]})]})]}),d===C?a.jsxs("div",{className:"space-y-2 mt-auto",children:[a.jsx(En,{placeholder:"Enter prompt to edit or replace...",value:c,onChange:I=>u(I.target.value)}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{onClick:()=>v(C),disabled:(T=o[C])==null?void 0:T.edit,children:[(R=o[C])!=null&&R.edit?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Lp,{className:"mr-2 h-4 w-4"}),"Apply Edit"]}),a.jsxs(O,{onClick:()=>w(C),disabled:(A=o[C])==null?void 0:A.replace,children:[(E=o[C])!=null&&E.replace?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(k3,{className:"mr-2 h-4 w-4"}),"Replace"]}),a.jsx(O,{variant:"ghost",onClick:()=>h(null),children:"Cancel"})]})]}):a.jsxs(O,{onClick:()=>{h(C),u("")},className:"w-full",children:[a.jsx(Er,{className:"mr-2 h-4 w-4"})," Edit or Replace"]}),a.jsxs(O,{onClick:()=>g(C),variant:"outline",className:"w-full mt-2",children:[a.jsx(EI,{className:"mr-2 h-4 w-4"})," Duplicate"]})]},_.id||C)})})}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel Generation"}),a.jsx(O,{type:"button",onClick:()=>r(s),children:"Continue with These Designs"})]})]})}):null},tr="/placeholder-image.png",E7=p.createContext(null),Vn=()=>{const t=p.useContext(E7);if(!t)throw new Error("useStore must be used within a StoreProvider");return t},zL="ecommerce-cart",rEe=({children:t})=>{const[e,n]=p.useState([]),[r,s]=p.useState(null),[i,o]=p.useState(!1),[l,c]=p.useState(0),[u,d]=p.useState(""),[h,f]=p.useState(!1),[m,g]=p.useState([]),[x,v]=p.useState("published"),{toast:w}=vs(),_=vi(),{user:C,session:T,profile:R}=yo(),A=xe=>{xe==="published"||xe==="edit"?v(xe):(console.warn(`Invalid view mode: ${xe}. Defaulting to 'published'.`),v("published"))},[E,I]=p.useState(0),[N,k]=p.useState(""),[j,D]=p.useState(""),[L,G]=p.useState(null),[B,W]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[X,H]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[K,V]=p.useState(null),[$,z]=p.useState(!1),[F,Z]=p.useState(null),[ce,le]=p.useState(null),[he,Le]=p.useState(!1),[$e,Be]=p.useState(null),[ue,Ce]=p.useState(null),[Ie,ve]=p.useState(!1),[ie,Me]=p.useState(!1),[He,yt]=p.useState(!1),[kt,en]=p.useState([]),[mn,cn]=p.useState(null),[fn,Ue]=p.useState(!1),[Et,de]=p.useState(!1),[De,ee]=p.useState([]),[ae,Q]=p.useState(null),[Pe,Ae]=p.useState(!1),Ve=p.useCallback(({newProducts:xe,newCollection:pe})=>{en(we=>[...we,...xe]),cn(we=>({...we,collections:[...(we==null?void 0:we.collections)||[],pe]})),w({title:"POD Items Added",description:`${xe.length} products and 1 collection are ready for finalization.`,variant:"success"})},[en,cn,w]),[qe,oe]=p.useState(0),[_e,ze]=p.useState(""),[Te,Tt]=p.useState(""),[wt,xt]=p.useState(null),[pt,Nt]=p.useState({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[jn,Sn]=p.useState(!1),[cr,sn]=p.useState(null),Vt=async(xe,pe)=>{if(!xe||!pe)return console.error("Missing base64 string or path for Firebase Storage upload."),null;const we=xe.split(",")[1];if(!we)return console.error("Invalid base64 string provided for upload."),null;const se=mh(ph,pe),Ee={contentType:"image/png"};try{const We=atob(we),nt=new Array(We.length);for(let jt=0;jt<We.length;jt++)nt[jt]=We.charCodeAt(jt);const Ye=new Uint8Array(nt),je=await hh(se,Ye,Ee),mt=await fh(je.ref);return console.log(`Uploaded ${pe} to Firebase Storage. URL: ${mt}`),mt}catch(We){throw console.error(`Error uploading ${pe} to Firebase Storage:`,We),We}},tn=xe=>xe?xe.map(pe=>{const we={...pe};if(we.logo_url&&we.logo_url.startsWith("data:image/")&&we.logo_url.length>2048&&(we.logo_url=`${we.logo_url.substring(0,30)}...[truncated]`),we.hero_image&&we.hero_image.src){const se={...we.hero_image.src};se.large&&se.large.startsWith("data:image/")&&se.large.length>2048&&(se.large=`${se.large.substring(0,30)}...[truncated]`),se.medium&&se.medium.startsWith("data:image/")&&se.medium.length>2048&&(se.medium=`${se.medium.substring(0,30)}...[truncated]`),we.hero_image={...we.hero_image,src:se}}return we.products&&Array.isArray(we.products)&&(we.products=we.products.map(se=>{const Ee={...se};if(Ee.image&&Ee.image.src){const We={...Ee.image.src};We.medium&&We.medium.startsWith("data:image/")&&We.medium.length>2048&&(We.medium=`${We.medium.substring(0,30)}...[truncated]`),We.large&&We.large.startsWith("data:image/")&&We.large.length>2048&&(We.large=`${We.large.substring(0,30)}...[truncated]`),Ee.image={...Ee.image,src:We}}return Ee})),we.collections&&Array.isArray(we.collections)&&(we.collections=we.collections.map(se=>{const{products:Ee,...We}=se;return We})),we}):[],Zn=p.useCallback(async()=>{f(!0),console.log("[StoreContext] loadStores called for all public stores.");let xe=[],pe=[];const we=localStorage.getItem("ecommerce-stores");if(we)try{xe=JSON.parse(we),console.log(`[StoreContext] Loaded ${xe.length} stores from localStorage.`)}catch(Ee){console.error("[StoreContext] Failed to parse localStorage stores:",Ee),w({title:"Local Cache Error",description:"Failed to load stores from local cache.",variant:"warning"}),xe=[]}n(xe),console.log("[StoreContext] Fetching all public stores from Firestore.");try{const Ee=Jo(nr,"stores"),We=await Xo(Ee);if(We.empty)console.log("[StoreContext] No public stores found in Firestore.");else{console.log(`[StoreContext] Fetched ${We.size} stores from Firestore. Processing details...`);const nt=We.docs.map(je=>({id:je.id,...je.data()}));pe=await Promise.all(nt.map(async je=>{var mt,jt;try{const Dt=Jo(nr,"stores",je.id,"products"),Jt=(await Xo(Dt)).docs.map(Ct=>({id:Ct.id,...Ct.data()})).map(Ct=>{let vr={src:{large:"",medium:""}};return Ct.images&&Array.isArray(Ct.images)&&Ct.images.length>0&&(vr.src.large=Ct.images[0],vr.src.medium=Ct.images[0]),{...Ct,price:Ct.priceAmount,image:vr,variants:Ct.variants||[]}}),Lt={...je,createdAt:((jt=(mt=je.created_at)==null?void 0:mt.toDate())==null?void 0:jt.toISOString())||new Date().toISOString()};let $n=[];const er=Jo(nr,"stores",je.id,"collections"),ur=(await Xo(er)).docs.map(Ct=>({id:Ct.id,...Ct.data()}));return ur&&ur.length>0&&($n=await Promise.all(ur.map(async Ct=>{let vr=[];return Ct.product_ids&&Ct.product_ids.length>0&&(vr=Jt.filter(as=>Ct.product_ids.includes(as.id))),{...Ct,image:{src:Ct.image_url||""},products:vr}}))),{...Lt,products:Jt,collections:$n}}catch(Dt){return console.error(`[StoreContext] Critical error processing details for store ${je.id}:`,Dt),{...je,products:[],collections:[]}}})),console.log(`[StoreContext] Finished processing details for ${pe.length} cloud stores.`)}}catch(Ee){console.error("[StoreContext] Overall critical error in fetching cloud stores:",Ee),w({title:"Cloud Loading Error",description:"A critical error occurred while fetching cloud store data.",variant:"destructive"})}const se=[...xe];pe.forEach(Ee=>{const We=se.findIndex(nt=>nt.id===Ee.id);We>-1?se[We]=Ee:se.push(Ee)}),se.sort((Ee,We)=>new Date(We.createdAt||We.created_at)-new Date(Ee.createdAt||Ee.created_at)),n(se);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(se))),console.log("[StoreContext] Updated localStorage with merged stores.")}catch(Ee){console.error("[StoreContext] Failed to save merged stores to localStorage:",Ee),w({title:"Local Cache Update Failed",description:"Could not update the local cache after cloud sync.",variant:"warning",duration:7e3})}f(!1),console.log(`[StoreContext] loadStores finished. isLoadingStores: false. Final stores count: ${e.length}`)},[w,nr,tn]),Y=p.useCallback(async(xe,pe)=>{var Ee,We;const we=e.find(nt=>nt.id===xe);if(!we){console.warn(`[StoreContext] updateStore: Store with ID ${xe} not found in current state.`),w({title:"Update Failed",description:"Store not found for update.",variant:"destructive"});return}const se={...we,...pe};if(console.log(`[StoreContext] updateStore: updatedLocalStore for store ${xe} - Products: ${((Ee=se.products)==null?void 0:Ee.length)||0}, Collections: ${((We=se.collections)==null?void 0:We.length)||0}`),n(nt=>{const Ye=nt.map(je=>je.id===xe?se:je);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(Ye))),console.log(`[StoreContext] updateStore: Saved ${Ye.length} stores to localStorage.`)}catch(je){console.error("Failed to save stores to localStorage during update:",je),w({title:"Local Cache Update Failed",description:"Could not update the local cache for the store.",variant:"warning",duration:7e3})}return Ye}),r&&r.id===xe&&(s(se),console.log(`[StoreContext] updateStore: currentStore updated for store ${xe}.`)),w({title:"Store Updated (Locally)",description:"Changes saved locally."}),C){f(!0);try{const{settings:nt,products:Ye,collections:je,user_id:mt,...jt}=pe,Dt=Ai(nr,"stores",xe);await fx(Dt,jt),console.log(`Store ${xe} synced to Firestore asynchronously.`)}catch(nt){console.error("Unexpected error during async Firestore updateStore:",nt),w({title:"Cloud Sync Error",description:"An unexpected error occurred during cloud sync.",variant:"destructive"})}finally{f(!1)}}},[e,C,w,r,s,n,f,tn]),re=p.useCallback(async(xe,pe)=>{if(!r||!r.id){w({title:"Error",description:"No current store selected to update.",variant:"destructive"});return}if(typeof xe!="string"||xe.trim()===""){w({title:"Error",description:"Invalid identifier for text content.",variant:"destructive"});return}const we=r.id,se=typeof r.content=="object"&&r.content!==null?r.content:{};let Ee=JSON.parse(JSON.stringify(se));const We=xe.split(".");let nt=Ee;for(let Ye=0;Ye<We.length-1;Ye++){const je=We[Ye];(!nt[je]||typeof nt[je]!="object")&&(nt[je]={}),nt=nt[je]}nt[We[We.length-1]]=pe,await Y(we,{content:Ee})},[r,Y,w]);p.useEffect(()=>{localStorage.setItem(zL,JSON.stringify(m))},[m]),p.useEffect(()=>{const xe=localStorage.getItem(zL);if(xe)try{g(JSON.parse(xe))}catch(pe){console.error("Failed to parse stored cart:",pe)}},[]);const ge=async xe=>{let pe={...xe};try{const St=pe.type||pe.name||"business",Jt=await ro(St,1);Jt.length>0&&(pe.card_background_url=Jt[0].src.large)}catch(St){console.error("Failed to fetch background image from Pexels:",St),pe.card_background_url=tr}const we=pe.name||`Store-${Ft().substring(0,6)}`;pe.name||(pe.name=we);const se=await Oe(we);if(!se.available){const St=se.error===!0?`Failed to verify store name "${we}". Please try again.`:`The store name "${we}" or a similar URL is already in use. Please choose a different name.`;throw w({title:"Store Name Unavailable",description:St,variant:"destructive"}),new Error(St)}pe.urlSlug=se.slug,pe.template_version||(pe.template_version="v1");const Ee=pe.id||Ft(),We={...pe,id:Ee,createdAt:new Date().toISOString()};let nt=We.products||[];const Ye=new Map;let je=[];if(nt=nt.map(St=>({...St,id:St.id||Ft()})),nt.forEach(St=>{Ye.set(St.name,St.id)}),C&&C.uid)try{const{id:St,settings:Jt,products:Lt,collections:$n,user_id:er,...xr}=We,ur=Ai(nr,"stores",St);let Ct=xr.logo_url;if(Ct&&Ct.startsWith("data:image/"))try{const wr=`store_logos/${St}/logo_${Ft()}.png`;Ct=await Vt(Ct,wr)}catch(wr){console.error("Error uploading store logo to Firebase Storage:",wr),w({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),Ct=tr}else Ct||(Ct=tr);let vr=xr.logo_url_light;if(vr&&vr.startsWith("data:image/"))try{const wr=`store_logos/${St}/logo_light_${Ft()}.png`;vr=await Vt(vr,wr)}catch(wr){console.error("Error uploading store logo to Firebase Storage:",wr),w({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),vr=tr}let as=xr.logo_url_dark;if(as&&as.startsWith("data:image/"))try{const wr=`store_logos/${St}/logo_dark_${Ft()}.png`;as=await Vt(as,wr)}catch(wr){console.error("Error uploading store logo to Firebase Storage:",wr),w({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),as=tr}const Ci={...xr,merchant_id:C.uid,created_at:new Date,logo_url:Ct||tr,logo_url_light:vr,logo_url_dark:as,urlSlug:We.urlSlug,card_background_url:We.card_background_url};if(await cp(ur,Ci),console.log(`Store ${St} saved to Firestore asynchronously.`),We.products&&We.products.length>0){const wr=[];for(const qn of We.products){let br=[];if(qn.images&&Array.isArray(qn.images))for(const Pa of qn.images)if(Pa.startsWith("data:image/"))try{const si=`store_products/${St}/${qn.id||Ft()}/${Ft()}.png`,Xc=await Vt(Pa,si);Xc?br.push(Xc):br.push(tr)}catch(si){console.error(`Error uploading product image for ${qn.name}:`,si),w({title:"Product Image Upload Failed",description:`Could not upload image for ${qn.name}.`,variant:"warning"}),br.push(tr)}else Pa?br.push(Pa):br.push(tr);br.length===0&&br.push(tr);const ts={store_id:St,name:qn.name||`Product ${Ft().substring(0,8)}`,description:qn.description||"No description available.",images:br,priceAmount:Number(qn.price)>=0?Number(qn.price):0,currency:"usd",variants:qn.variants||[],created_at:new Date},qo=Ai(nr,"stores",St,"products",qn.id||Ft());wr.push(cp(qo,ts)),Ye.set(qn.name,qo.id)}await Promise.all(wr)}if(We.collections&&We.collections.length>0){const wr=[];for(const qn of We.collections){let br=qn.imageUrl;if(br&&br.startsWith("data:image/"))try{const si=`store_collections/${St}/${qn.id||Ft()}/${Ft()}.png`;br=await Vt(br,si)}catch(si){console.error("Error uploading collection image to Firebase Storage:",si),w({title:"Collection Image Upload Failed",description:"Could not upload collection image.",variant:"warning"}),br=tr}else br||(br=tr);const ts=(qn.product_ids||[]).map(si=>Ye.get(si)).filter(Boolean),qo={store_id:St,name:qn.name,description:qn.description,image_url:br||tr,product_ids:ts,created_at:new Date},Pa=Ai(nr,"stores",St,"collections",qn.id||Ft());wr.push(cp(Pa,qo)),je.push({id:Pa.id,...qo})}await Promise.all(wr)}}catch(St){console.error("Overall async Firestore store creation error. Code:",St.code,"Message:",St.message,"Full Error:",St),setTimeout(()=>{w({title:"Cloud Sync Error",description:`Firestore error (${St.code||"Unknown Code"}): ${St.message}`,variant:"destructive"})},0)}else C&&!C.uid&&(console.error("Firestore save skipped: User object is present but user.uid is undefined."),setTimeout(()=>{w({title:"User UID Missing",description:"Cannot save to cloud: User UID is missing. Please try logging out and back in.",variant:"destructive"})},0));let mt=[];const jt=We.collections||[],Dt=nt.map(St=>{const Jt=Array.isArray(St.images)&&St.images.length>0?St.images[0]:tr;return{...St,image:{src:{medium:Jt,large:Jt}}}});jt.length>0&&(mt=jt.map(St=>{let Jt={};if(C&&je&&je.length>0){const er=je.find(xr=>xr.name===St.name);er&&(Jt=er)}let Lt=[];St.product_ids&&St.product_ids.length>0&&St.product_ids.forEach(er=>{const xr=Ye.get(er);let ur=null;xr?(ur=Dt.find(Ct=>Ct.id===xr),ur||er!==xr&&(ur=Dt.find(Ct=>Ct.id===er))):ur=Dt.find(Ct=>Ct.id===er),ur&&Lt.push(ur)});const $n=(Jt==null?void 0:Jt.image_url)||St.imageUrl||"";return{...St,...Jt,image:{src:$n},products:Lt}}));const Nn={...We,products:Dt,collections:mt};return n(St=>{const Jt=[Nn,...St.filter(Lt=>Lt.id!==Nn.id)];try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(Jt)))}catch(Lt){console.error("Failed to save stores to localStorage during store creation:",Lt),w({title:"Local Cache Update Failed",description:"Could not update the local cache after creating the store.",variant:"warning",duration:7e3})}return Jt}),s(Nn),Nn},Oe=async xe=>{if(!xe||typeof xe!="string"||xe.trim()==="")return{available:!0,slug:"",error:"Name cannot be empty."};const pe=mc(xe.trim());if(!pe)return{available:!0,slug:"",error:"Invalid name for URL generation."};try{const we=Jo(nr,"stores"),se=VT(we,$T("urlSlug","==",pe));return{available:(await Xo(se)).empty,slug:pe}}catch(we){return console.error("Error checking store name availability:",we),w({title:"Name Check Failed",description:"Could not verify store name uniqueness.",variant:"destructive"}),{available:!1,slug:pe,error:!0}}},tt=async xe=>{var pe,we;o(!0),c(0),d("Initializing wizard-based store generation...");try{const se=await p_e(xe,{fetchPexelsImages:ro,generateId:Ft}),Ee=await ge(se);return c(100),d("Store generation complete!"),Ee}catch(se){return console.error("Error generating store from wizard:",se),!((pe=se.message)!=null&&pe.includes("already in use"))&&!((we=se.message)!=null&&we.includes("Failed to verify store name"))&&w({title:"Wizard Generation Failed",description:se.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),null}finally{o(!1)}},J=async(xe,pe=null,we=null,se=[],Ee=!1,We=!1,nt=[],Ye=[])=>{o(!0),c(0),d("Initializing generation...");try{if(Ee){d("Generating initial designs...");const mt=[Zi.find(Dt=>Dt.name==="Canvas"),Zi.find(Dt=>Dt.name==="Hat"),Zi.find(Dt=>Dt.name==="Black hoodie"),Zi.find(Dt=>Dt.name==="Mug"),Zi.find(Dt=>Dt.name==="Notebook"),Zi.find(Dt=>Dt.name==="Pillow")].filter(Boolean);let jt=[];if(mt.length>0){const Dt=mt.slice(0,6);let Nn=null;if(nt&&nt.length>0){const St=nt.find(Jt=>Jt.file.type.startsWith("image/"));if(St)try{const{base64ImageData:Jt,mimeType:Lt}=await e_e(St.file);Nn={base64Data:Jt,mimeType:Lt},d("Processing reference image...")}catch(Jt){console.error("Error processing reference image:",Jt),w({title:"Image Error",description:"Could not process the uploaded reference image.",variant:"destructive"})}}for(const[St,Jt]of Dt.entries()){c(St/Dt.length*100),d(`Generating design for ${Jt.name}...`);const Lt=await Tg({prompt:xe,referenceImage:Nn});if(Lt&&Lt.imageData){const $n=`data:${Lt.imageMimeType};base64,${Lt.imageData}`;jt.push({id:Ft(),name:Jt.name,images:[$n],podProductInfo:Jt})}}}Q({prompt:xe,storeNameOverride:pe,productTypeOverride:we}),ee(jt),de(!0),o(!1);return}let je;if(Ye.length>0){const mt=(Nn,St)=>{c(Nn),St&&d(St)};je=await WS(xe,{storeNameOverride:pe,productTypeOverride:we,fetchPexelsImages:ro,generateId:Ft,isPrintOnDemand:!1,isDropshipping:!0,contextFiles:nt,contextURLs:[],generateProducts:!1},mt);const jt=Ye.map(Nn=>({id:String(Nn.product_id),name:Nn.product_title,description:Nn.product_description,price:parseFloat(Nn.target_sale_price)||0,images:Nn.product_photos,isDropshipping:!0}));je.products=jt;const Dt=await HS(je.type,je.name,jt,!1,!0,mt,70,20,Ft);je.collections=Dt}else{const mt=(jt,Dt)=>{c(jt),Dt&&d(Dt)};if(je=await WS(xe,{storeNameOverride:pe,productTypeOverride:we,fetchPexelsImages:ro,generateId:Ft,isPrintOnDemand:!1,contextFiles:nt,contextURLs:[]},mt),je.products.length>0){const jt=await HS(je.type,je.name,je.products,Ee,We,mt,70,20,Ft);je.collections=jt}}en(je.products||[]),cn(je),o(!1),yt(!0),d("Products generated. Please review and finalize."),c(90)}catch(je){console.error("Error generating store from prompt:",je),w({title:"Generation Failed",description:je.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),o(!1)}},te=async xe=>{de(!1),o(!0),c(0),d("Re-visualizing designs on products...");const{prompt:pe,storeNameOverride:we,productTypeOverride:se}=ae;let Ee=[];try{for(const[je,mt]of xe.entries()){const jt=je/xe.length*50;c(jt);const Dt=mt.podProductInfo,Nn=mt.images[0],{base64ImageData:St,mimeType:Jt}=await ig(Nn);d(`Visualizing design on ${Dt.name}...`);const Lt=await Op(St,Jt,Dt.imageUrl,pe,Dt.name);if(Lt&&Lt.visualizedImageData&&Lt.productDetails){const $n=`data:${Lt.visualizedImageMimeType};base64,${Lt.visualizedImageData}`;Ee.push({id:Ft(),name:Lt.productDetails.title||`${Dt.name} with design`,description:Lt.productDetails.description||`A unique ${Dt.name}.`,price:Lt.productDetails.price||"29.99",images:[Nn,$n],variants:Lt.productDetails.variants||[],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:Nn,designPrompt:pe,baseProductName:Dt.name,baseProductImageUrl:Dt.imageUrl},category:Dt.category||"Print on Demand"})}}const We=(je,mt)=>{c(50+je/2),mt&&d(mt)};let nt=await WS(pe,{storeNameOverride:we,productTypeOverride:se,fetchPexelsImages:ro,generateId:Ft,isPrintOnDemand:!0},We);const Ye=[...Ee,...nt.products||[]];if(nt.products=Ye,nt.products.length>0){const je=await HS(nt.type,nt.name,nt.products,!0,!1,We,80,10,Ft);nt.collections=je}en(Ye),cn(nt),o(!1),yt(!0),d("Products generated. Please review and finalize."),c(90)}catch(We){console.error("Error continuing store generation:",We),w({title:"Generation Failed",description:We.message||"Failed to continue store generation.",variant:"destructive"}),c(0),d("Generation failed."),o(!1)}},me=async(xe,pe,we,se=null)=>{if(!xe)return w({title:"Error",description:"Missing design image for POD collection generation.",variant:"destructive"}),null;if(se===null)console.log("Generating POD collection data for pre-finalization stage.");else{if(!se)return w({title:"Error",description:"Store ID is invalid for updating POD collection.",variant:"destructive"}),null;console.log(`Generating POD collection for existing store: ${se}`)}Ue(!0),w({title:"Generating POD Collection",description:"Applying design to all mockups..."});let Ee=[],We=`Collection from ${we} Design`;try{const{base64ImageData:nt,mimeType:Ye}=await ig(xe);for(const mt of Zi){if(mt.name===we){console.log(`Skipping visualization for base product: ${we}`);continue}console.log(`Visualizing design on mockup: ${mt.name}`);const jt=await Op(nt,Ye,mt.imageUrl,pe||`Product based on ${we} design`,mt.name);if(jt&&jt.visualizedImageData&&jt.productDetails){const Dt=`data:${jt.visualizedImageMimeType};base64,${jt.visualizedImageData}`;Ee.push({id:Ft(),name:jt.productDetails.title,price:parseFloat(jt.productDetails.price),description:jt.productDetails.description,images:[Dt],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:xe,designPrompt:pe,baseProductName:mt.name,baseProductImageUrl:mt.imageUrl},variants:jt.productDetails.variants||[]})}else console.warn(`Failed to visualize design on ${mt.name} for collection. Error: ${jt==null?void 0:jt.error}`)}if(Ee.length===0)return w({title:"Collection Generation Incomplete",description:"Could not create any new products for the collection.",variant:"warning"}),null;const je={id:Ft(),name:We,description:`A collection of products featuring the design from ${we}. Original design prompt: ${pe||"N/A"}`,imageUrl:Ee[0].images[0]||tr,product_ids:Ee.map(mt=>mt.id)};if(se||(je.products=[...Ee]),se){const mt=e.find(Nn=>Nn.id===se);if(!mt)throw new Error("Store not found to add the new collection.");const jt=[...mt.products||[],...Ee],Dt=[...mt.collections||[],je];return await Y(se,{products:jt,collections:Dt}),w({title:"POD Collection Created",description:`Collection "${We}" with ${Ee.length} products added to store.`,variant:"success"}),{success:!0}}else return w({title:"POD Items Generated",description:`${Ee.length} products and 1 collection ready.`,variant:"info"}),{newProducts:Ee,newCollection:je}}catch(nt){return console.error("Error generating POD collection from design:",nt),w({title:"POD Collection Error",description:nt.message,variant:"destructive"}),null}finally{Ue(!1)}},q=p.useCallback(()=>{I(0),k(""),D(""),G(null),W({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),H({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),V(null),z(!1),Z(null),le(null),Le(!1),Be(null)},[]),ne=p.useCallback(async(xe,pe)=>{k(xe),D(pe),z(!0),Z(null),G(null);try{w({title:"Connecting to Shopify...",description:"Fetching store information."});const we=await g_e(xe,pe);if(!we)throw new Error("Failed to fetch Shopify store metadata. The store might not exist or the token might be invalid.");return G(we),I(2),!0}catch(we){return console.error("Error starting Shopify import wizard (fetching metadata):",we),Z(we.message||"Failed to connect to Shopify and fetch store information."),w({title:"Connection Failed",description:we.message||"Could not fetch store information.",variant:"destructive"}),!1}finally{z(!1)}},[w,k,D,z,Z,G,I]),be=p.useCallback(()=>{oe(0),ze(""),Tt(""),xt(null),Nt({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),Sn(!1),sn(null)},[]),Ne=p.useCallback(async(xe,pe)=>{const we=xe||_e,se=pe||Te;if(!we||!se){sn("Domain or token missing for fetching BigCommerce settings.");return}z(!0),sn(null);try{const Ee=await b_e(we,se);xt(Ee)}catch(Ee){console.error("Error fetching BigCommerce settings for wizard:",Ee),sn(Ee.message||"Failed to fetch store settings."),w({title:"BigCommerce Settings Fetch Failed",description:Ee.message,variant:"destructive"})}finally{z(!1)}},[_e,Te,w,sn,xt,z]),Ge=p.useCallback(async(xe,pe)=>{ze(xe),Tt(pe),oe(2),await Ne(xe,pe)},[ze,Tt,oe,Ne]),Se=p.useCallback(async(xe=10)=>{if(!_e||!Te){sn("Domain or token missing for fetching BigCommerce products.");return}Sn(!0),sn(null);try{const pe=`
      query ProductsPreview($first: Int!) {
        site {
          products(first: $first) {
            edges {
              node {
                entityId name sku defaultImage { url(width: 200) altText }
                prices { price { value currencyCode } }
              }
            }
          }
        }
      }
    `,we={first:xe},Ee=await(await fetch(`https://${_e}/graphql`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${Te}`},body:JSON.stringify({query:pe,variables:we})})).json();if(Ee.errors)throw new Error(Ee.errors.map(We=>We.message).join(", "));Nt({items:Ee.data.site.products.edges.map(We=>We.node),pageInfo:{hasNextPage:!1,endCursor:null}})}catch(pe){console.error("Error fetching BigCommerce products for wizard:",pe),sn(pe.message||"Failed to fetch products."),w({title:"BigCommerce Product Fetch Failed",description:pe.message,variant:"destructive"})}finally{Sn(!1)}},[_e,Te,w,sn,Nt,Sn]),it=p.useCallback(async()=>{if(!wt||!_e||!Te)return w({title:"Import Error",description:"Missing BigCommerce data to finalize import.",variant:"destructive"}),!1;o(!0),sn(null);try{const xe=await xL(_e,Te),pe=w_e(wt,xe,_e,{generateId:Ft},null);return await ge(pe)?(be(),!0):!1}catch(xe){return console.error("Error finalizing BigCommerce import from wizard:",xe),sn(xe.message||"Failed to finalize BigCommerce import."),w({title:"BigCommerce Import Failed",description:xe.message,variant:"destructive"}),!1}finally{o(!1)}},[wt,_e,Te,ge,be,w,o,sn,xL]),st=p.useCallback(async(xe=10,pe=null)=>{if(!N||!j){Z("Domain or token missing for fetching products.");return}z(!0),Z(null);try{const we=await x_e(N,j,xe,pe);W(se=>({edges:pe?[...se.edges,...we.edges]:we.edges,pageInfo:we.pageInfo}))}catch(we){console.error("Error fetching Shopify products for wizard:",we),Z(we.message||"Failed to fetch products."),w({title:"Product Fetch Failed",description:we.message,variant:"destructive"})}finally{z(!1)}},[N,j,w,Z,W,z]),Mt=p.useCallback(async(xe=10,pe=null)=>{if(!N||!j){Z("Domain or token missing for fetching collections.");return}z(!0),Z(null);try{const we=await y_e(N,j,xe,pe);H(se=>({edges:pe?[...se.edges,...we.edges]:we.edges,pageInfo:we.pageInfo}))}catch(we){console.error("Error fetching Shopify collections for wizard:",we),Z(we.message||"Failed to fetch collections."),w({title:"Collection Fetch Failed",description:we.message,variant:"destructive"})}finally{z(!1)}},[N,j,w,Z,H,z]),xn=p.useCallback(async(xe="US",pe="EN")=>{if(!N||!j){Z("Domain or token missing for fetching localization.");return}z(!0),Z(null);try{const we=await v_e(N,j,xe,pe);V(we)}catch(we){console.error("Error fetching Shopify localization for wizard:",we),Z(we.message||"Failed to fetch localization info."),w({title:"Localization Info Fetch Failed",description:we.message,variant:"default"})}finally{z(!1)}},[N,j,w,Z,V,z]),Zr=p.useCallback(async()=>{if(console.log("[StoreContext] Attempting to generate Shopify store logo..."),!L||!L.name){console.warn("[StoreContext] Cannot generate logo: Shopify preview metadata or store name is missing.",L),Be("Store name is not available to generate a logo."),w({title:"Logo Generation Error",description:"Store name missing. Ensure Shopify store details were fetched correctly.",variant:"destructive"});return}const xe=L.name;console.log(`[StoreContext] Generating logo for store name: "${xe}"`),Le(!0),Be(null),le(null);try{console.log("[StoreContext] Calling generateLogoWithGemini...");const{imageData:pe,textResponse:we}=await Eg(xe);if(console.log("[StoreContext] generateLogoWithGemini response:",{imageData:pe?"imageData received (see next log)":"no imageData",textResponse:we}),pe)console.log("[StoreContext] imageData (first 50 chars):",pe.substring(0,50)),le(`data:image/png;base64,${pe}`),w({title:"Logo Generated!",description:"A new logo has been generated successfully."}),console.log("[StoreContext] Logo generated and state updated.");else throw console.error("[StoreContext] generateLogoWithGemini returned no imageData. Text response:",we),new Error(we||"Gemini did not return image data.")}catch(pe){console.error("[StoreContext] Error during Shopify store logo generation:",pe.message,pe.stack),Be(pe.message||"Failed to generate logo."),w({title:"Logo Generation Failed",description:`Error: ${pe.message}`,variant:"destructive"})}finally{Le(!1),console.log("[StoreContext] Finished logo generation attempt.")}},[L,w,Be,Le,le]),Dn=p.useCallback(async()=>{var xe,pe,we,se,Ee,We,nt,Ye,je,mt,jt,Dt,Nn,St;if(!L||!N||!j)return w({title:"Import Error",description:"Missing essential Shopify data to finalize import.",variant:"destructive"}),!1;o(!0),Z(null);try{const Jt=B.edges.map(Ct=>Ct.node),Lt=X.edges.map(Ct=>Ct.node);let $n=`Create a store named '${L.name}'.`;L.description&&($n+=` The store's description is: "${L.description}".`),(xe=L.brand)!=null&&xe.slogan&&($n+=` Slogan: "${L.brand.slogan}".`),Jt.length>0&&($n+=` It sells products like ${Jt.slice(0,3).map(Ct=>Ct.title).join(", ")}.`),Lt.length>0&&($n+=` Key collections include ${Lt.slice(0,2).map(Ct=>Ct.title).join(", ")}.`),(se=(we=(pe=L.brand)==null?void 0:pe.colors)==null?void 0:we.primary)!=null&&se.background&&($n+=` The primary brand color is ${L.brand.colors.primary.background}.`),(nt=(We=(Ee=L.brand)==null?void 0:Ee.colors)==null?void 0:We.secondary)!=null&&nt.background&&($n+=` The secondary brand color is ${L.brand.colors.secondary.background}.`);const er=Jt.map(Ct=>{var vr,as,Ci,wr,qn,br;return{name:Ct.title,price:((wr=(Ci=(as=(vr=Ct.variants)==null?void 0:vr.edges[0])==null?void 0:as.node)==null?void 0:Ci.price)==null?void 0:wr.amount)||"0",description:Ct.descriptionHtml?Ct.descriptionHtml.replace(/<[^>]*>?/gm,""):Ct.description||"",images:((qn=Ct.images)==null?void 0:qn.edges.map(ts=>ts.node.url))||[],variants:((br=Ct.variants)==null?void 0:br.edges.map(ts=>{var qo;return{id:ts.node.id,title:ts.node.title,price:((qo=ts.node.price)==null?void 0:qo.amount)||"0"}}))||[]}}),xr=Lt.map(Ct=>{var vr,as;return{name:Ct.title,description:Ct.descriptionHtml?Ct.descriptionHtml.replace(/<[^>]*>?/gm,""):Ct.description||"",imageUrl:((vr=Ct.image)==null?void 0:vr.url)||"",product_ids:((as=Ct.products)==null?void 0:as.edges.map(Ci=>Ci.node.id))||[]}}),ur={name:L.name,prompt:$n,logoUrl:ce||((mt=(je=(Ye=L==null?void 0:L.brand)==null?void 0:Ye.logo)==null?void 0:je.image)==null?void 0:mt.url)||((Nn=(Dt=(jt=L==null?void 0:L.brand)==null?void 0:jt.squareLogo)==null?void 0:Dt.image)==null?void 0:Nn.url),products:er,collections:xr,brandColors:(St=L.brand)==null?void 0:St.colors};return Ce(ur),ve(!0),q(),I(4),Me(!0),w({title:"Import Successful",description:"Store data imported. Proceed to configure and generate your store.",duration:5e3}),!0}catch(Jt){return console.error("Error preparing data for StoreGenerator from Shopify import:",Jt),Z(Jt.message||"Failed to process Shopify data for generator."),w({title:"Import Processing Failed",description:Jt.message||"Could not prepare imported data.",variant:"destructive"}),!1}finally{o(!1)}},[L,N,j,B,X,ce,ge,q,I,Me,Ce,ve,w,o,Z]),Gr=p.useCallback(()=>{Ce(null),ve(!1)},[]),bs=p.useCallback(xe=>{const pe=e.find(we=>we.id===xe);return pe?{...pe}:null},[e]),Si=p.useCallback(xe=>{const pe=e.find(we=>mc(we.name)===xe);return pe?{...pe}:null},[e]),Vs=async xe=>{console.log(`[StoreContext] getStoreBySlug called for slug: ${xe}`);try{const pe=Jo(nr,"stores"),we=VT(pe,$T("urlSlug","==",xe)),se=await Xo(we);if(se.empty)return console.log(`[StoreContext] No store found with slug: ${xe}`),null;const Ee=se.docs[0],We={id:Ee.id,...Ee.data()};console.log(`[StoreContext] Found store with slug ${xe}. Fetching details...`);const nt=Jo(nr,"stores",We.id,"products"),mt=(await Xo(nt)).docs.map(Lt=>({id:Lt.id,...Lt.data()})).map(Lt=>{var $n,er;return{...Lt,price:Lt.priceAmount,image:{src:{large:(($n=Lt.images)==null?void 0:$n[0])||"",medium:((er=Lt.images)==null?void 0:er[0])||""}},variants:Lt.variants||[]}}),jt=Jo(nr,"stores",We.id,"collections"),Nn=(await Xo(jt)).docs.map(Lt=>({id:Lt.id,...Lt.data()})),St=await Promise.all(Nn.map(async Lt=>{const $n=mt.filter(er=>{var xr;return(xr=Lt.product_ids)==null?void 0:xr.includes(er.id)});return{...Lt,image:{src:Lt.image_url||""},products:$n}})),Jt={...We,products:mt,collections:St};return n(Lt=>{const $n=Lt.findIndex(er=>er.id===Jt.id);if($n>-1){const er=[...Lt];return er[$n]=Jt,er}return[...Lt,Jt]}),Jt}catch(pe){return console.error(`[StoreContext] Error fetching store by slug ${xe}:`,pe),w({title:"Error Fetching Store",description:"Could not retrieve store data from the server.",variant:"destructive"}),null}},$s=p.useCallback((xe,pe)=>{const we=bs(xe),se=we==null?void 0:we.products.find(Ee=>Ee.id===pe);return se?{...se}:null},[bs]),es=async(xe,pe)=>{if(!C){w({title:"Authentication Required",description:"Please log in to set a pass key.",variant:"destructive"});return}f(!0);try{const we=Ai(nr,"stores",xe);await fx(we,{pass_key:pe}),n(se=>{const Ee=se.map(We=>We.id===xe?{...We,pass_key:pe}:We);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(Ee)))}catch(We){console.error("Failed to save stores to localStorage after pass key update:",We),w({title:"Local Cache Update Failed",description:"Could not update the local cache after pass key update.",variant:"warning",duration:7e3})}return Ee}),r&&r.id===xe&&s(se=>se?{...se,pass_key:pe}:null),w({title:"Store Pass Key Set",description:"The pass key for the store has been updated."})}catch(we){console.error("Unexpected error in updateStorePassKey:",we),w({title:"Pass Key Update Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},nn=async(xe,pe)=>{if(!C){w({title:"Authentication Required",description:"Please log in to assign a manager.",variant:"destructive"});return}if(!xe||!pe){w({title:"Missing Information",description:"Store ID and Manager Email are required.",variant:"destructive"});return}f(!0);try{console.warn("Assign Store Manager functionality needs to be migrated to a Firebase Cloud Function or direct Firestore logic."),w({title:"Manager Assignment (Placeholder)",description:"Functionality needs Firebase Cloud Function implementation.",variant:"info"}),w({title:"Store Manager Assigned",description:`Manager ${pe} assigned to store.`})}catch(we){console.error("Unexpected error in assignStoreManager:",we),w({title:"Manager Assignment Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},Cn=async(xe,pe,we)=>{if(!C){w({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const se=e.find(nt=>nt.id===xe);if(!se){console.warn(`[StoreContext] updateProductImage: Store with ID ${xe} not found.`),w({title:"Update Failed",description:"Store not found for updating product image.",variant:"destructive"});return}let Ee=we.src.large;if(Ee&&Ee.startsWith("data:image/"))try{const nt=`store_products/${xe}/${pe}/image_${Ft()}.png`,Ye=await Vt(Ee,nt);Ye?Ee=Ye:(Ee=Ee.startsWith("data:image/")?tr:Ee,w({title:"Image Upload Failed",description:"Could not upload new product image. Using placeholder or existing.",variant:"warning"}))}catch(nt){console.error(`Error uploading new product image for ${pe}:`,nt),w({title:"Image Upload Failed",description:"Could not upload new product image.",variant:"destructive"}),Ee=tr}else Ee||(Ee=tr);const We=se.products.map(nt=>nt.id===pe?{...nt,image:{...nt.image,src:{large:Ee,medium:Ee}},images:nt.images?[...nt.images.filter(Ye=>Ye!==nt.image.src.large),Ee]:[Ee]}:nt);try{const nt=Ai(nr,"stores",xe,"products",pe);await fx(nt,{images:We.find(Ye=>Ye.id===pe).images,image:{src:{large:Ee,medium:Ee}}}),w({title:"Product Image Updated",description:"The product image has been changed."})}catch(nt){console.error("Error updating product image in Firestore:",nt),w({title:"Cloud Sync Failed",description:`Failed to save product image to cloud: ${nt.message}`,variant:"destructive"});return}n(nt=>{const Ye=nt.map(je=>je.id===xe?{...je,products:We}:je);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(Ye)))}catch(je){console.error("Failed to save stores to localStorage during product image update:",je),w({title:"Local Cache Update Failed",description:"Could not update the local cache for product image.",variant:"warning",duration:7e3})}return Ye}),r&&r.id===xe&&s(nt=>nt?{...nt,products:We}:null)},ni=async xe=>{if(!C){w({title:"Authentication Required",description:"Please log in to delete a store.",variant:"destructive"});return}const pe=[...e];n(we=>{const se=we.filter(Ee=>Ee.id!==xe);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(se)))}catch(Ee){console.error("Failed to save stores to localStorage during optimistic delete:",Ee),w({title:"Local Cache Update Issue",description:"Could not update the local cache during store deletion. Cloud operation will proceed.",variant:"warning",duration:7e3})}return se}),r&&r.id===xe&&s(null);try{const we=Jo(nr,"stores",xe,"products"),se=await Xo(we),Ee=[];for(const mt of se.docs)Ee.push(BS(Ai(nr,"stores",xe,"products",mt.id)));await Promise.all(Ee),console.log(`Deleted ${se.size} products for store ${xe}.`);const We=Jo(nr,"stores",xe,"collections"),nt=await Xo(We),Ye=[];for(const mt of nt.docs)Ye.push(BS(Ai(nr,"stores",xe,"collections",mt.id)));await Promise.all(Ye),console.log(`Deleted ${nt.size} collections for store ${xe}.`);const je=Ai(nr,"stores",xe);await BS(je),console.log(`Store ${xe} deleted from Firestore.`),w({title:"Store Deleted",description:"Your store has been deleted."})}catch(we){console.error("Error deleting store from Firestore:",we),w({title:"Deletion Failed",description:we.message,variant:"destructive"}),n(pe);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(pe)))}catch(se){console.error("Failed to save stores to localStorage during delete rollback:",se),w({title:"Local Cache Revert Failed",description:"Could not revert local cache changes after a failed deletion.",variant:"error",duration:8e3})}pe.find(se=>se.id===xe)&&s(pe.find(se=>se.id===xe)||null);return}},ri=async(xe,pe,we)=>{if(!C){w({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const se=e.find(Ye=>Ye.id===xe);if(!se){console.warn(`[StoreContext] updateProductImagesArray: Store with ID ${xe} not found.`),w({title:"Update Failed",description:"Store not found for updating product images.",variant:"destructive"});return}let Ee=!1,We=[];for(const Ye of we)if(typeof Ye=="string"&&Ye.startsWith("data:image/"))try{const je=`store_products/${xe}/${pe}/gallery_${Ft()}.png`,mt=await Vt(Ye,je);mt?We.push(mt):We.push(tr)}catch(je){console.error(`Error uploading gallery image for product ${pe}:`,je),w({title:"Image Upload Failed",description:"Could not upload one or more product gallery images.",variant:"destructive"}),We.push(tr)}else typeof Ye=="string"&&Ye?We.push(Ye):(console.warn(`[StoreContext] updateProductImagesArray: Invalid or empty image in newImagesArray for product ${pe}`,Ye),We.push(tr));We.length===0&&we.length>0&&We.push(tr);const nt=se.products.map(Ye=>{var je,mt;if(Ye.id===pe){Ee=!0;const jt=We.length>0?We[0]:((mt=(je=Ye.image)==null?void 0:je.src)==null?void 0:mt.medium)||tr;return{...Ye,images:We.length>0?We:[tr],image:{...Ye.image||{id:Ft(),alt:Ye.name||"Product Image"},src:{medium:jt,large:jt}}}}return Ye});if(!Ee){console.warn(`[StoreContext] updateProductImagesArray: Product with ID ${pe} not found in store ${xe}.`),w({title:"Update Failed",description:"Product not found for updating images.",variant:"destructive"});return}try{const Ye=Ai(nr,"stores",xe,"products",pe),je=nt.find(mt=>mt.id===pe);if(je)await fx(Ye,{images:je.images,image:je.image}),w({title:"Product Images Updated",description:"The product's image gallery has been updated."});else throw new Error("Updated product data not found for Firestore update.")}catch(Ye){console.error("Error updating product images array in Firestore:",Ye),w({title:"Cloud Sync Failed",description:`Failed to save product images to cloud: ${Ye.message}`,variant:"destructive"});return}n(Ye=>{const je=Ye.map(mt=>mt.id===xe?{...mt,products:nt}:mt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(tn(je)))}catch(mt){console.error("Failed to save stores to localStorage during product images array update:",mt),w({title:"Local Cache Update Failed",description:"Could not update the local cache for product images array.",variant:"warning",duration:7e3})}return je}),r&&r.id===xe&&s(Ye=>Ye?{...Ye,products:nt}:null)},Mn=(xe,pe)=>{g(we=>we.find(Ee=>Ee.id===xe.id&&Ee.storeId===pe)?we.map(Ee=>Ee.id===xe.id&&Ee.storeId===pe?{...Ee,quantity:Ee.quantity+1}:Ee):[...we,{...xe,quantity:1,storeId:pe}]),w({title:"Added to Cart",description:`${xe.name} has been added to your cart.`})},Us=(xe,pe)=>{g(we=>we.filter(se=>!(se.id===xe&&se.storeId===pe))),w({title:"Removed from Cart",description:"Item removed from your cart.",variant:"destructive"})},xo=(xe,pe,we)=>{if(we<1){Us(xe,pe);return}g(se=>se.map(Ee=>Ee.id===xe&&Ee.storeId===pe?{...Ee,quantity:we}:Ee))},Ho=()=>{g([]),w({title:"Cart Cleared",description:"Your shopping cart is now empty."})},Jc=p.useCallback((xe,pe)=>{const we=e.find(We=>We.id===xe);if(!we)return console.warn(`[getUpdatesForVersion] Store with ID ${xe} not found.`),{template_version:pe};let se={template_version:pe};const Ee=we.theme||{};return we.template_version,pe==="v1"?["Montserrat","PremiumMain","SharpFont","FreshFont","SleekFont"].includes(Ee.fontFamily)||!Ee.fontFamily?se.theme={...Ee,fontFamily:"Inter"}:se.theme={...Ee}:pe==="premium"&&(se.theme={...Ee,fontFamily:"PremiumMain"}),se},[e]),Na={stores:e,currentStore:r,isGenerating:i,isLoadingStores:h,cart:m,user:C,progress:l,statusMessage:u,loadStores:Zn,generateStore:J,updateStoreTextContent:re,checkStoreNameAvailability:Oe,getStoreById:bs,getStoreByName:Si,getStoreBySlug:Vs,updateStore:Y,deleteStore:ni,setCurrentStore:s,updateStorePassKey:es,assignStoreManager:nn,updateStoreTemplateVersion:async(xe,pe)=>{if(!xe||!pe){w({title:"Error",description:"Store ID and new template version are required.",variant:"destructive"});return}const we=Jc(xe,pe);await Y(xe,we);let se=pe;pe==="v1"?se="Modern":pe==="premium"?se="Premium":pe==="sharp"?se="Sharp":pe==="fresh"?se="Fresh":pe==="sleek"?se="Sleek":se=pe.charAt(0).toUpperCase()+pe.slice(1),w({title:"Template Updated",description:`Store template is now ${se}.`})},getProductById:$s,updateProductImage:Cn,generateStoreFromWizard:tt,addToCart:Mn,removeFromCart:Us,updateQuantity:xo,clearCart:Ho,generateAIProducts:m_e,updateProductImagesArray:ri,generatePodCollectionFromDesign:me,addPendingPodCollectionData:Ve,isGeneratingPodCollection:fn,viewMode:x,setViewMode:A,shopifyWizardStep:E,setShopifyWizardStep:I,shopifyDomain:N,setShopifyDomain:k,shopifyToken:j,setShopifyToken:D,shopifyPreviewMetadata:L,shopifyPreviewProducts:B,shopifyPreviewCollections:X,shopifyLocalization:K,isFetchingShopifyPreviewData:$,shopifyImportError:F,generatedLogoImage:ce,isGeneratingLogo:he,logoGenerationError:$e,shopifyWizardShouldShowGenerator:ie,setShopifyWizardShouldShowGenerator:Me,startShopifyImportWizard:ne,fetchShopifyWizardProducts:st,importedStoreDataForGenerator:ue,isImportDataReadyForGenerator:Ie,clearImportedStoreDataForGenerator:Gr,fetchShopifyWizardCollections:Mt,fetchShopifyWizardLocalization:xn,generateShopifyStoreLogo:Zr,finalizeShopifyImportFromWizard:Dn,resetShopifyWizardState:q,updateShopifyPreviewMetadata:xe=>{G(xe)},updateShopifyPreviewProduct:xe=>{W(pe=>{const we=pe.edges.map(se=>se.node.id===xe.id?{...se,node:xe}:se);return{...pe,edges:we}})},updateShopifyPreviewCollection:xe=>{H(pe=>{const we=pe.edges.map(se=>se.node.id===xe.id?{...se,node:xe}:se);return{...pe,edges:we}})},isAuthModalOpen:Pe,openAuthModal:()=>Ae(!0),closeAuthModal:()=>Ae(!1),bigCommerceWizardStep:qe,setBigCommerceWizardStep:oe,bigCommerceStoreDomain:_e,bigCommerceApiToken:Te,bigCommercePreviewSettings:wt,bigCommercePreviewProducts:pt,isFetchingBigCommercePreviewData:jn,bigCommerceImportError:cr,startBigCommerceImportWizard:Ge,fetchBigCommerceWizardSettings:Ne,fetchBigCommerceWizardProducts:Se,finalizeBigCommerceImportFromWizard:it,resetBigCommerceWizardState:be,closeDesignEditModal:()=>{de(!1),ee([]),Q(null),o(!1),c(0),d("")},continueGenerationWithDesigns:te,openProductFinalizationModal:(xe,pe)=>{en(xe),cn(pe),yt(!0)},closeProductFinalizationModal:()=>{yt(!1),en([]),cn(null),o(!1),c(0),d("")},handleFinalizeProducts:async xe=>{if(!mn){w({title:"Error",description:"Store data for finalization is missing.",variant:"destructive"}),yt(!1),o(!1);return}o(!0),d("Finalizing store creation..."),c(95);const pe={...mn,products:xe};try{const we=await ge(pe);if(we)c(100),d("Store generation complete!"),w({title:"Store Created!",description:`Store "${we.name}" has been created.`}),_(`/${we.urlSlug||mc(we.name)}`);else throw new Error("Store creation returned no result after finalization.")}catch(we){console.error("Error during final store creation after product finalization:",we),w({title:"Finalization Failed",description:we.message||"Failed to create store after finalization.",variant:"destructive"}),c(0),d("Finalization failed.")}finally{yt(!1),en([]),cn(null),o(!1)}}};return a.jsxs(E7.Provider,{value:Na,children:[t,a.jsx(nEe,{isOpen:Et,onClose:Na.closeDesignEditModal,designs:De,onContinue:te}),a.jsx(S_e,{isOpen:He,onClose:Na.closeProductFinalizationModal,products:kt,onFinalize:Na.handleFinalizeProducts})]})},lm=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),sEe=({product:t,storeId:e,onContentCreated:n})=>{var ee,ae;const{toast:r}=vs(),{storeName:s}=E0(),i=gl(),o=(ee=i.state)==null?void 0:ee.product,l=(ae=i.state)==null?void 0:ae.storeData,c=t||o,{getStoreById:u,getStoreByName:d}=Vn(),[h,f]=p.useState("text-to-image"),[m,g]=p.useState(""),[x,v]=p.useState(""),[w,_]=p.useState(!1),[C,T]=p.useState(!1),[R,A]=p.useState(null),[E,I]=p.useState([]),[N,k]=p.useState(!1),[j,D]=p.useState(""),[L,G]=p.useState(null),[B,W]=p.useState(!1),[X,H]=p.useState(null),[K,V]=p.useState([]),[$,z]=p.useState(""),[F,Z]=p.useState(!1),[ce,le]=p.useState(null),[he,Le]=p.useState(!1),[$e,Be]=p.useState([]),[ue,Ce]=p.useState(!1),[Ie,ve]=p.useState(!1),[ie,Me]=p.useState(null),He=async()=>{var Q,Pe;if(!(!ie||!ie.url))try{const Ae=document.createElement("a");let Ve="download";if(ie.url.startsWith("data:")){const qe=ie.url.match(/:(.*?);/),_e=(qe?qe[1]:"application/octet-stream").split("/")[1]||"bin";Ve=`${((Q=ie.caption)==null?void 0:Q.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${_e}`,Ae.href=ie.url}else{const oe=await(await fetch(ie.url)).blob();Ae.href=URL.createObjectURL(oe);const _e=ie.url.substring(ie.url.lastIndexOf("/")+1).split("?")[0],ze=_e.includes(".")?_e.substring(_e.lastIndexOf(".")+1):"",Te=ie.type==="video"?"mp4":"png";Ve=_e||`${((Pe=ie.caption)==null?void 0:Pe.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${ze||Te}`}Ae.download=Ve,document.body.appendChild(Ae),Ae.click(),document.body.removeChild(Ae),ie.url.startsWith("data:")||URL.revokeObjectURL(Ae.href),r({title:"Download Started",description:`Downloading ${Ve}`})}catch(Ae){console.error("Error downloading media:",Ae),r({title:"Download Failed",description:Ae.message,variant:"destructive"})}};p.useEffect(()=>{let Q=l;if(Q||(s?Q=d(s):e?Q=u(e):c&&c.store_id&&(Q=u(c.store_id))),Q&&Q.products){Ce(!0);const Pe=Q.products.map(Ae=>{var Ve,qe,oe;return{id:Ae.id,name:Ae.name,image:{src:{medium:((qe=(Ve=Ae.image)==null?void 0:Ve.src)==null?void 0:qe.medium)||`https://via.placeholder.com/100x100.png?text=${encodeURIComponent(((oe=Ae.name)==null?void 0:oe.substring(0,10))||"P")}`}}}});Be(Pe),Ce(!1)}else console.warn("[ContentCreationPage] No current store products found. Falling back to sample product catalog."),Be([{id:"sample_prod_1",name:"Sample Product Alpha",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Alpha"}}},{id:"sample_prod_2",name:"Sample Product Beta",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Beta"}}},{id:"sample_prod_3",name:"Sample Product Gamma",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Gamma"}}}]),Ce(!1);c&&c.name&&(g(`A captivating image of ${c.name}`),(async()=>{k(!0);try{const Ae={name:c.name,description:c.description||"",niche:(Q==null?void 0:Q.type)||c.niche||"",storeName:(Q==null?void 0:Q.name)||c.storeName||""},Ve=await pse(Ae);Ve.suggestions&&Ve.suggestions.length>0?I(Ve.suggestions):Ve.error&&console.warn("Could not fetch prompt suggestions:",Ve.error)}catch(Ae){console.error("Error fetching prompt suggestions:",Ae)}finally{k(!1)}})())},[c,l,s,e,u,d]);const yt=async()=>{if(!m.trim()){r({title:"Error",description:"Please enter a prompt for image generation",variant:"destructive"});return}_(!0),A(null),z("");try{const Q=await A0(m);let Pe=Q.alt?[Q.alt]:[`Image for: ${m.substring(0,30)}`];if(Q.url)try{const{base64ImageData:Ae,mimeType:Ve}=await lm(Q.url);Pe=await ia(Ae,Ve,`Image of ${m}`)}catch(Ae){console.error("Error generating caption for Gemini image:",Ae),Pe=[`Failed to generate caption for: ${m.substring(0,30)}`]}A({url:Q.url,captions:Pe,sourceApi:"gemini"}),Pe&&Pe.length>0&&z(Pe[0])}catch(Q){console.error("Error generating image with Gemini:",Q),r({title:"Image Generation Failed",description:Q.message,variant:"destructive"})}finally{_(!1)}},kt=async()=>{if(!x.trim()){r({title:"Error",description:"Please enter a prompt for OpenAI image generation",variant:"destructive"});return}T(!0),A(null),z("");try{const Q=await qB(x),Pe=`data:image/png;base64,${Q.b64_json}`;let Ae=Q.alt?[Q.alt]:[`OpenAI image for: ${x.substring(0,30)}`];try{const{base64ImageData:Ve,mimeType:qe}=await lm(Pe);Ae=await ia(Ve,qe,`OpenAI-generated image of ${x}`)}catch(Ve){console.error("Error generating caption for OpenAI image:",Ve),Ae=[`Failed to generate caption for: ${x.substring(0,30)}`]}A({url:Pe,captions:Ae,sourceApi:"openai"}),Ae&&Ae.length>0&&z(Ae[0]),r({title:"Image Generated (OpenAI)",description:"Image successfully generated using OpenAI."})}catch(Q){console.error("Error generating image with OpenAI:",Q),r({title:"OpenAI Image Generation Failed",description:Q.message,variant:"destructive"})}finally{T(!1)}},en=async(Q,Pe)=>{if(!Q||!Q.url){r({title:"Error",description:"No image selected to edit with Gemini.",variant:"destructive"});return}if(!Pe.trim()){r({title:"Error",description:"Please enter an edit prompt for Gemini.",variant:"destructive"});return}W(!0),H(null),z("");try{const{base64ImageData:Ae,mimeType:Ve}=await lm(Q.url),qe=await $o(Ae,Ve,Pe);if(qe&&qe.editedImageData){const oe=`data:${qe.newMimeType};base64,${qe.editedImageData}`;let _e=qe.editTextResponse?[qe.editTextResponse]:[`Edited with Gemini: ${Q.caption||Q.id}`];try{_e=await ia(qe.editedImageData,qe.newMimeType,`Edited image based on: ${Pe}`)}catch(ze){console.error("Error generating caption for Gemini edited image:",ze)}H({url:oe,captions:_e,sourceApi:"gemini"}),_e&&_e.length>0&&z(_e[0]),r({title:"Image Edited (Gemini)",description:"Image successfully edited with Gemini."})}else throw new Error("Gemini image edit did not return image data.")}catch(Ae){console.error("Error editing image with Gemini:",Ae),r({title:"Gemini Edit Failed",description:Ae.message,variant:"destructive"})}finally{W(!1)}},mn=async Q=>{const Pe=Q.target.files[0];if(Pe){Le(!0),le(null),z("");try{const Ae=new FileReader;Ae.onload=async Ve=>{const qe=Ve.target.result,oe=Pe.type.startsWith("video/")?"video":"image";let _e=[Pe.name];if(oe==="image")try{const{base64ImageData:ze,mimeType:Te}=await lm(qe);_e=await ia(ze,Te,"Uploaded image caption")}catch(ze){console.error("Error generating caption for uploaded image:",ze)}else _e=[`Uploaded video: ${Pe.name}`];le({url:qe,captions:_e,type:oe}),_e&&_e.length>0&&z(_e[0]),Le(!1)},Ae.onerror=()=>{r({title:"Upload Failed",description:"Failed to read the selected file",variant:"destructive"}),Le(!1)},Ae.readAsDataURL(Pe)}catch(Ae){console.error("Error processing uploaded file:",Ae),r({title:"Upload Failed",description:Ae.message,variant:"destructive"}),Le(!1)}}},cn=(Q,Pe,Ae="image")=>{if(!Q){r({title:"Cannot Add",description:"Item URL is missing.",variant:"destructive"});return}const Ve={id:Ft(),type:Ae,url:Q,caption:Pe||`Item ${K.length+1}`,isVideo:Ae==="video"};V(qe=>[...qe,Ve]),r({title:"Added to Timeline",description:`${Ae==="video"?"Video":"Image"} added to your content timeline.`}),A(null),H(null),le(null),G(null),z("")},fn=(Q,Pe)=>{const Ae=[...K],Ve=Ae[Q],qe=Q+Pe;qe<0||qe>=Ae.length||(Ae.splice(Q,1),Ae.splice(qe,0,Ve),V(Ae))},Ue=Q=>{V(Pe=>Pe.filter(Ae=>Ae.id!==Q)),r({title:"Removed from Timeline",description:"Item removed."})},Et=async(Q,Pe)=>{if(Q.isVideo){r({title:"Already a Video",description:"This item is already a video."});return}Z(!0);try{const{base64ImageData:Ae,mimeType:Ve}=await lm(Q.url),qe=Q.caption||`Create a short video from this image: ${c?c.name:"product showcase"}`,oe=await zI(qe,Ae,Ve),_e=[...K];_e[Pe]={...Q,url:oe,isVideo:!0,type:"video",caption:Q.caption+" (Veo Video)"},V(_e),r({title:"Veo Video Generated",description:"Image converted to video using Veo."})}catch(Ae){console.error("Error converting to Veo video:",Ae),r({title:"Veo Conversion Failed",description:Ae.message,variant:"destructive"})}finally{Z(!1)}},de=Q=>{const Pe=K.find(Ve=>Ve.id===Q);if(!Pe)return;const Ae=prompt("Edit caption:",Pe.caption);Ae!==null&&Ae.trim()!==Pe.caption&&(V(Ve=>Ve.map(qe=>qe.id===Q?{...qe,caption:Ae.trim()}:qe)),r({title:"Caption Updated"}))},De=Q=>{if(Q.image&&Q.image.src&&Q.image.src.medium){const Pe=`Product: ${Q.name}`;cn(Q.image.src.medium,Pe,"image")}else r({title:"No Image",description:`Product ${Q.name} has no image.`,variant:"destructive"});ve(!1)};return a.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-8 bg-background",children:[" ",a.jsxs("header",{className:"relative text-center pb-4",children:[a.jsx(Xn,{to:"/",className:"absolute left-0 top-0",children:a.jsxs(O,{variant:"outline",size:"icon",children:[a.jsx(Vo,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to Home"})]})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"AI Content Creation Studio"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"Generate images, edit them, create videos, and build your content sequence."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 xl:gap-8",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[a.jsxs(bi,{value:h,onValueChange:f,className:"w-full",children:[a.jsxs(ei,{className:"grid w-full grid-cols-3",children:[a.jsxs($t,{value:"text-to-image",children:[a.jsx(ma,{className:"mr-1 h-4 w-4 inline-block"}),"Gen Image"]}),a.jsxs($t,{value:"image-edit",children:[a.jsx(Qv,{className:"mr-1 h-4 w-4 inline-block"}),"Edit Image"]}),a.jsxs($t,{value:"upload",children:[a.jsx(j3,{className:"mr-1 h-4 w-4 inline-block"}),"Upload"]})]}),a.jsxs(Ut,{value:"text-to-image",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(Re,{htmlFor:"text-prompt-model1",className:"text-lg font-semibold",children:"Text-to-Image (Quick)"}),a.jsx(En,{id:"text-prompt-model1",placeholder:"e.g., 'A futuristic cityscape at sunset'",value:m,onChange:Q=>g(Q.target.value),rows:3,className:"mt-2",disabled:w||C}),N&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading prompt suggestions..."}),E.length>0&&!N&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:E.map((Q,Pe)=>a.jsx(O,{variant:"outline",size:"xs",onClick:()=>g(Q),className:"text-xs",children:Q.length>40?Q.substring(0,37)+"...":Q},Pe))})]}),a.jsxs(O,{onClick:yt,disabled:w||C||!m.trim(),className:"w-full mt-3",children:[w?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ma,{className:"mr-2 h-4 w-4"}),"Generate with Quick"]}),a.jsx(Oi,{className:"my-4"}),a.jsx(Re,{htmlFor:"text-prompt-model2",className:"text-lg font-semibold",children:"Text-to-Image (Quality)"}),a.jsx(En,{id:"text-prompt-model2",placeholder:"e.g., 'A photorealistic cat astronaut'",value:x,onChange:Q=>v(Q.target.value),rows:3,className:"mt-2",disabled:w||C}),a.jsxs(O,{onClick:kt,disabled:w||C||!x.trim(),className:"w-full mt-3",children:[C?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(E3,{className:"mr-2 h-4 w-4"}),"Generate with Quality"]}),R&&R.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:R.url,alt:`Generated by ${R.sourceApi==="gemini"?"Quick":R.sourceApi==="openai"?"Quality":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",R.sourceApi==="gemini"?"Quick":R.sourceApi==="openai"?"Quality":"AI"]}),a.jsx(Re,{className:"text-sm font-medium",children:"Choose a caption:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(R.captions||[]).map((Q,Pe)=>a.jsx(O,{variant:$===Q?"default":"outline",size:"sm",onClick:()=>z(Q),className:"text-xs",children:Q},Pe))}),a.jsxs(O,{onClick:()=>cn(R.url,$),size:"sm",className:"w-full mt-2",disabled:!$,children:[a.jsx(Cu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]}),a.jsxs(Ut,{value:"image-edit",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(Re,{className:"text-lg font-semibold",children:"Image Editing"}),!L&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select an image from the timeline to enable editing."}),L&&a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Editing: ",a.jsx("span",{className:"text-primary truncate",children:L.caption})]}),a.jsx("img",{src:L.url,alt:"Selected for editing",className:"w-full rounded-md object-contain max-h-48 border"}),a.jsx(Re,{htmlFor:"edit-prompt-model1",children:"Edit with Quick"}),a.jsx(En,{id:"edit-prompt-model1",placeholder:"Describe edits (e.g., 'change background to a beach')",value:j,onChange:Q=>D(Q.target.value),rows:2,disabled:B}),a.jsxs(O,{onClick:()=>en(L,j),disabled:B||!j.trim(),className:"w-full",children:[B?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ma,{className:"mr-2 h-4 w-4"}),"Edit with Quick"]})]}),X&&X.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:X.url,alt:`Edited by ${X.sourceApi==="gemini"?"Quick":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",X.sourceApi==="gemini"?"Quick":"AI"]}),a.jsx(Re,{className:"text-sm font-medium",children:"Choose a caption for the edited image:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(X.captions||[]).map((Q,Pe)=>a.jsx(O,{variant:$===Q?"default":"outline",size:"sm",onClick:()=>z(Q),className:"text-xs",children:Q},Pe))}),a.jsxs(O,{onClick:()=>cn(X.url,$),size:"sm",className:"w-full mt-2",disabled:!$,children:[a.jsx(Cu,{className:"mr-2 h-4 w-4"})," Add Edited to Timeline"]})]})]}),a.jsxs(Ut,{value:"upload",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(Re,{htmlFor:"file-upload",className:"text-lg font-semibold",children:"Upload Image or Video"}),a.jsx(Je,{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:mn,className:"mt-2",disabled:he}),he&&a.jsxs("div",{className:"mt-2 flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}),ce&&ce.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[ce.type==="image"?a.jsx("img",{src:ce.url,alt:"Uploaded content",className:"w-full rounded-md object-contain max-h-96"}):a.jsx("video",{src:ce.url,controls:!0,className:"w-full rounded-md max-h-96",children:"Your browser does not support the video tag."}),a.jsx(Re,{className:"text-sm font-medium",children:"Choose a caption for the uploaded content:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(ce.captions||[]).map((Q,Pe)=>a.jsx(O,{variant:$===Q?"default":"outline",size:"sm",onClick:()=>z(Q),className:"text-xs",children:Q},Pe))}),a.jsxs(O,{onClick:()=>cn(ce.url,$,ce.type),size:"sm",className:"w-full mt-2",disabled:!$,children:[a.jsx(Cu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Product Catalog"}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>ve(!Ie),children:[Ie?"Hide":"Show"," Products ",a.jsx(Sie,{className:"ml-2 h-4 w-4"})]})]}),Ie&&a.jsx(Ls,{className:"mt-2 h-48 border rounded-md p-2",children:a.jsx("div",{className:"space-y-2",children:$e.map(Q=>{var Pe,Ae;return a.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md hover:bg-muted cursor-pointer",onClick:()=>De(Q),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:(Ae=(Pe=Q.image)==null?void 0:Pe.src)==null?void 0:Ae.medium,alt:Q.name,className:"w-10 h-10 object-cover rounded"}),a.jsx("span",{className:"text-sm",children:Q.name})]}),a.jsx(O,{size:"xs",variant:"ghost",children:a.jsx(Cu,{className:"h-4 w-4"})})]},Q.id)})})})]})]}),a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"p-4 md:p-6 border rounded-lg bg-card shadow min-h-[400px]",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Content Timeline"}),a.jsx(Ls,{className:"h-[calc(100vh-350px)] min-h-[300px] pr-3",children:K.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[a.jsx(S3,{className:"h-12 w-12 mb-3"}),a.jsx("p",{children:"Your timeline is empty."}),a.jsx("p",{className:"text-sm",children:"Generate or upload content to get started."})]}):a.jsx(_c,{children:K.map((Q,Pe)=>a.jsxs(Pt.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{type:"spring",stiffness:300,damping:30},className:"mb-3 p-3 border rounded-md flex items-start gap-3 hover:shadow-md transition-shadow bg-background cursor-pointer",onClick:()=>Me(Q),children:[a.jsxs("div",{className:"w-24 h-24 flex-shrink-0 relative rounded overflow-hidden group bg-muted",children:[Q.isVideo?a.jsx("video",{src:Q.url,className:"w-full h-full object-cover",controls:!1,muted:!0,loop:!0,onMouseOver:Ae=>Ae.target.play(),onMouseOut:Ae=>Ae.target.pause()}):a.jsx("img",{src:Q.url,alt:Q.caption,className:"w-full h-full object-cover"}),!Q.isVideo&&a.jsx(O,{size:"icon",variant:"secondary",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Ae=>{Ae.stopPropagation(),Et(Q,Pe)},disabled:F,title:"Convert to Veo Video",children:F?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(II,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"outline",className:"absolute bottom-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Ae=>{Ae.stopPropagation(),G(Q),f("image-edit")},disabled:Q.isVideo,title:"Edit this image",children:a.jsx(Qv,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:`text-xs font-semibold px-1.5 py-0.5 rounded-sm ${Q.isVideo?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:[Q.isVideo?"Video":"Image"," ",Pe+1]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(O,{size:"icon",variant:"ghost",onClick:Ae=>{Ae.stopPropagation(),fn(Pe,-1)},disabled:Pe===0,className:"h-7 w-7",children:a.jsx(P3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ae=>{Ae.stopPropagation(),fn(Pe,1)},disabled:Pe===K.length-1,className:"h-7 w-7",children:a.jsx(N3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ae=>{Ae.stopPropagation(),de(Q.id)},className:"h-7 w-7",children:a.jsx(A3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ae=>{Ae.stopPropagation(),Ue(Q.id)},className:"h-7 w-7 text-destructive",children:a.jsx(Fn,{className:"h-4 w-4"})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-muted-foreground line-clamp-3",title:Q.caption,children:Q.caption})]})]},Q.id))})}),K.length>0&&a.jsx(Oi,{className:"my-4"}),ie&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Media Viewer"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(O,{variant:"outline",size:"sm",onClick:He,children:[a.jsx(TI,{className:"mr-2 h-4 w-4"}),"Download"]}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>Me(null),children:a.jsx(Wi,{className:"h-5 w-5"})})]})]}),ie.type==="image"||!ie.isVideo?a.jsx("img",{src:ie.url,alt:ie.caption||"Viewing media",className:"w-full max-h-[60vh] rounded-md object-contain border"}):a.jsx("video",{src:ie.url,controls:!0,className:"w-full max-h-[60vh] rounded-md border bg-black",children:"Your browser does not support the video tag."}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:ie.caption})]})]})})]})]})};function T7(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function TA(t){const[e,n]=p.useState(void 0);return va(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var Zb="Switch",[iEe,vje]=wi(Zb),[oEe,aEe]=iEe(Zb),I7=p.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...h}=t,[f,m]=p.useState(null),g=yn(e,C=>m(C)),x=p.useRef(!1),v=f?d||!!f.closest("form"):!0,[w,_]=Fc({prop:s,defaultProp:i??!1,onChange:u,caller:Zb});return a.jsxs(oEe,{scope:n,checked:w,disabled:l,children:[a.jsx(Yt.button,{type:"button",role:"switch","aria-checked":w,"aria-required":o,"data-state":k7(w),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:g,onClick:gt(t.onClick,C=>{_(T=>!T),v&&(x.current=C.isPropagationStopped(),x.current||C.stopPropagation())})}),v&&a.jsx(A7,{control:f,bubbles:!x.current,name:r,value:c,checked:w,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});I7.displayName=Zb;var N7="SwitchThumb",P7=p.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,s=aEe(N7,n);return a.jsx(Yt.span,{"data-state":k7(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:e})});P7.displayName=N7;var lEe="SwitchBubbleInput",A7=p.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...s},i)=>{const o=p.useRef(null),l=yn(o,i),c=T7(n),u=TA(e);return p.useEffect(()=>{const d=o.current;if(!d)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==n&&m){const g=new Event("click",{bubbles:r});m.call(d,n),d.dispatchEvent(g)}},[c,n,r]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});A7.displayName=lEe;function k7(t){return t?"checked":"unchecked"}var R7=I7,cEe=P7;const jo=ht.forwardRef(({className:t,...e},n)=>a.jsx(R7,{className:bt("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:n,children:a.jsx(cEe,{className:bt("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));jo.displayName=R7.displayName;var uEe="Arrow",j7=p.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return a.jsx(Yt.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});j7.displayName=uEe;var dEe=j7,IA="Popper",[D7,e_]=wi(IA),[hEe,M7]=D7(IA),L7=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return a.jsx(hEe,{scope:e,anchor:r,onAnchorChange:s,children:n})};L7.displayName=IA;var F7="PopperAnchor",O7=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=M7(F7,n),o=p.useRef(null),l=yn(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:a.jsx(Yt.div,{...s,ref:l})});O7.displayName=F7;var NA="PopperContent",[fEe,mEe]=D7(NA),V7=p.forwardRef((t,e)=>{var he,Le,$e,Be,ue,Ce;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:g,...x}=t,v=M7(NA,n),[w,_]=p.useState(null),C=yn(e,Ie=>_(Ie)),[T,R]=p.useState(null),A=TA(T),E=(A==null?void 0:A.width)??0,I=(A==null?void 0:A.height)??0,N=r+(i!=="center"?"-"+i:""),k=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},j=Array.isArray(u)?u:[u],D=j.length>0,L={padding:k,boundary:j.filter(gEe),altBoundary:D},{refs:G,floatingStyles:B,placement:W,isPositioned:X,middlewareData:H}=WG({strategy:"fixed",placement:N,whileElementsMounted:(...Ie)=>zG(...Ie,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[HG({mainAxis:s+I,alignmentAxis:o}),c&&qG({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?KG():void 0,...L}),c&&YG({...L}),JG({...L,apply:({elements:Ie,rects:ve,availableWidth:ie,availableHeight:Me})=>{const{width:He,height:yt}=ve.reference,kt=Ie.floating.style;kt.setProperty("--radix-popper-available-width",`${ie}px`),kt.setProperty("--radix-popper-available-height",`${Me}px`),kt.setProperty("--radix-popper-anchor-width",`${He}px`),kt.setProperty("--radix-popper-anchor-height",`${yt}px`)}}),T&&QG({element:T,padding:l}),yEe({arrowWidth:E,arrowHeight:I}),f&&XG({strategy:"referenceHidden",...L})]}),[K,V]=B7(W),$=Vr(g);va(()=>{X&&($==null||$())},[X,$]);const z=(he=H.arrow)==null?void 0:he.x,F=(Le=H.arrow)==null?void 0:Le.y,Z=(($e=H.arrow)==null?void 0:$e.centerOffset)!==0,[ce,le]=p.useState();return va(()=>{w&&le(window.getComputedStyle(w).zIndex)},[w]),a.jsx("div",{ref:G.setFloating,"data-radix-popper-content-wrapper":"",style:{...B,transform:X?B.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(Be=H.transformOrigin)==null?void 0:Be.x,(ue=H.transformOrigin)==null?void 0:ue.y].join(" "),...((Ce=H.hide)==null?void 0:Ce.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:a.jsx(fEe,{scope:n,placedSide:K,onArrowChange:R,arrowX:z,arrowY:F,shouldHideArrow:Z,children:a.jsx(Yt.div,{"data-side":K,"data-align":V,...x,ref:C,style:{...x.style,animation:X?void 0:"none"}})})})});V7.displayName=NA;var $7="PopperArrow",pEe={top:"bottom",right:"left",bottom:"top",left:"right"},U7=p.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=mEe($7,r),o=pEe[i.placedSide];return a.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:a.jsx(dEe,{...s,ref:n,style:{...s.style,display:"block"}})})});U7.displayName=$7;function gEe(t){return t!==null}var yEe=t=>({name:"transformOrigin",options:t,fn(e){var v,w,_;const{placement:n,rects:r,middlewareData:s}=e,o=((v=s.arrow)==null?void 0:v.centerOffset)!==0,l=o?0:t.arrowWidth,c=o?0:t.arrowHeight,[u,d]=B7(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((w=s.arrow)==null?void 0:w.x)??0)+l/2,m=(((_=s.arrow)==null?void 0:_.y)??0)+c/2;let g="",x="";return u==="bottom"?(g=o?h:`${f}px`,x=`${-c}px`):u==="top"?(g=o?h:`${f}px`,x=`${r.floating.height+c}px`):u==="right"?(g=`${-c}px`,x=o?h:`${m}px`):u==="left"&&(g=`${r.floating.width+c}px`,x=o?h:`${m}px`),{data:{x:g,y:x}}}});function B7(t){const[e,n="center"]=t.split("-");return[e,n]}var z7=L7,PA=O7,G7=V7,W7=U7,XT=["Enter"," "],xEe=["ArrowDown","PageUp","Home"],H7=["ArrowUp","PageDown","End"],vEe=[...xEe,...H7],wEe={ltr:[...XT,"ArrowRight"],rtl:[...XT,"ArrowLeft"]},bEe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},sy="Menu",[cg,_Ee,SEe]=yI(sy),[yd,q7]=wi(sy,[SEe,e_,$0]),t_=e_(),K7=$0(),[CEe,xd]=yd(sy),[EEe,iy]=yd(sy),Y7=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=t,l=t_(e),[c,u]=p.useState(null),d=p.useRef(!1),h=Vr(i),f=V0(s);return p.useEffect(()=>{const m=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),a.jsx(z7,{...l,children:a.jsx(CEe,{scope:e,open:n,onOpenChange:h,content:c,onContentChange:u,children:a.jsx(EEe,{scope:e,onClose:p.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:r})})})};Y7.displayName=sy;var TEe="MenuAnchor",AA=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=t_(n);return a.jsx(PA,{...s,...r,ref:e})});AA.displayName=TEe;var kA="MenuPortal",[IEe,J7]=yd(kA,{forceMount:void 0}),X7=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:s}=t,i=xd(kA,e);return a.jsx(IEe,{scope:e,forceMount:n,children:a.jsx(xs,{present:n||i.open,children:a.jsx(wg,{asChild:!0,container:s,children:r})})})};X7.displayName=kA;var uo="MenuContent",[NEe,RA]=yd(uo),Q7=p.forwardRef((t,e)=>{const n=J7(uo,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=xd(uo,t.__scopeMenu),o=iy(uo,t.__scopeMenu);return a.jsx(cg.Provider,{scope:t.__scopeMenu,children:a.jsx(xs,{present:r||i.open,children:a.jsx(cg.Slot,{scope:t.__scopeMenu,children:o.modal?a.jsx(PEe,{...s,ref:e}):a.jsx(AEe,{...s,ref:e})})})})}),PEe=p.forwardRef((t,e)=>{const n=xd(uo,t.__scopeMenu),r=p.useRef(null),s=yn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return L0(i)},[]),a.jsx(jA,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:gt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),AEe=p.forwardRef((t,e)=>{const n=xd(uo,t.__scopeMenu);return a.jsx(jA,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),kEe=Gu("MenuContent.ScrollLock"),jA=p.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:g,...x}=t,v=xd(uo,n),w=iy(uo,n),_=t_(n),C=K7(n),T=_Ee(n),[R,A]=p.useState(null),E=p.useRef(null),I=yn(e,E,v.onContentChange),N=p.useRef(0),k=p.useRef(""),j=p.useRef(0),D=p.useRef(null),L=p.useRef("right"),G=p.useRef(0),B=g?kI:p.Fragment,W=g?{as:kEe,allowPinchZoom:!0}:void 0,X=K=>{var he,Le;const V=k.current+K,$=T().filter($e=>!$e.disabled),z=document.activeElement,F=(he=$.find($e=>$e.ref.current===z))==null?void 0:he.textValue,Z=$.map($e=>$e.textValue),ce=zEe(Z,V,F),le=(Le=$.find($e=>$e.textValue===ce))==null?void 0:Le.ref.current;(function $e(Be){k.current=Be,window.clearTimeout(N.current),Be!==""&&(N.current=window.setTimeout(()=>$e(""),1e3))})(V),le&&setTimeout(()=>le.focus())};p.useEffect(()=>()=>window.clearTimeout(N.current),[]),PI();const H=p.useCallback(K=>{var $,z;return L.current===(($=D.current)==null?void 0:$.side)&&WEe(K,(z=D.current)==null?void 0:z.area)},[]);return a.jsx(NEe,{scope:n,searchRef:k,onItemEnter:p.useCallback(K=>{H(K)&&K.preventDefault()},[H]),onItemLeave:p.useCallback(K=>{var V;H(K)||((V=E.current)==null||V.focus(),A(null))},[H]),onTriggerLeave:p.useCallback(K=>{H(K)&&K.preventDefault()},[H]),pointerGraceTimerRef:j,onPointerGraceIntentChange:p.useCallback(K=>{D.current=K},[]),children:a.jsx(B,{...W,children:a.jsx(D0,{asChild:!0,trapped:s,onMountAutoFocus:gt(i,K=>{var V;K.preventDefault(),(V=E.current)==null||V.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:a.jsx(vg,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:a.jsx(TU,{asChild:!0,...C,dir:w.dir,orientation:"vertical",loop:r,currentTabStopId:R,onCurrentTabStopIdChange:A,onEntryFocus:gt(c,K=>{w.isUsingKeyboardRef.current||K.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(G7,{role:"menu","aria-orientation":"vertical","data-state":mW(v.open),"data-radix-menu-content":"",dir:w.dir,..._,...x,ref:I,style:{outline:"none",...x.style},onKeyDown:gt(x.onKeyDown,K=>{const $=K.target.closest("[data-radix-menu-content]")===K.currentTarget,z=K.ctrlKey||K.altKey||K.metaKey,F=K.key.length===1;$&&(K.key==="Tab"&&K.preventDefault(),!z&&F&&X(K.key));const Z=E.current;if(K.target!==Z||!vEe.includes(K.key))return;K.preventDefault();const le=T().filter(he=>!he.disabled).map(he=>he.ref.current);H7.includes(K.key)&&le.reverse(),UEe(le)}),onBlur:gt(t.onBlur,K=>{K.currentTarget.contains(K.target)||(window.clearTimeout(N.current),k.current="")}),onPointerMove:gt(t.onPointerMove,ug(K=>{const V=K.target,$=G.current!==K.clientX;if(K.currentTarget.contains(V)&&$){const z=K.clientX>G.current?"right":"left";L.current=z,G.current=K.clientX}}))})})})})})})});Q7.displayName=uo;var REe="MenuGroup",DA=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{role:"group",...r,ref:e})});DA.displayName=REe;var jEe="MenuLabel",Z7=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{...r,ref:e})});Z7.displayName=jEe;var Qw="MenuItem",GL="menu.itemSelect",n_=p.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...s}=t,i=p.useRef(null),o=iy(Qw,t.__scopeMenu),l=RA(Qw,t.__scopeMenu),c=yn(e,i),u=p.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(GL,{bubbles:!0,cancelable:!0});h.addEventListener(GL,m=>r==null?void 0:r(m),{once:!0}),xI(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return a.jsx(eW,{...s,ref:c,disabled:n,onClick:gt(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:gt(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:gt(t.onKeyDown,h=>{const f=l.searchRef.current!=="";n||f&&h.key===" "||XT.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});n_.displayName=Qw;var eW=p.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=t,o=RA(Qw,n),l=K7(n),c=p.useRef(null),u=yn(e,c),[d,h]=p.useState(!1),[f,m]=p.useState("");return p.useEffect(()=>{const g=c.current;g&&m((g.textContent??"").trim())},[i.children]),a.jsx(cg.ItemSlot,{scope:n,disabled:r,textValue:s??f,children:a.jsx(IU,{asChild:!0,...l,focusable:!r,children:a.jsx(Yt.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:u,onPointerMove:gt(t.onPointerMove,ug(g=>{r?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:gt(t.onPointerLeave,ug(g=>o.onItemLeave(g))),onFocus:gt(t.onFocus,()=>h(!0)),onBlur:gt(t.onBlur,()=>h(!1))})})})}),DEe="MenuCheckboxItem",tW=p.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...s}=t;return a.jsx(oW,{scope:t.__scopeMenu,checked:n,children:a.jsx(n_,{role:"menuitemcheckbox","aria-checked":Zw(n)?"mixed":n,...s,ref:e,"data-state":LA(n),onSelect:gt(s.onSelect,()=>r==null?void 0:r(Zw(n)?!0:!n),{checkForDefaultPrevented:!1})})})});tW.displayName=DEe;var nW="MenuRadioGroup",[MEe,LEe]=yd(nW,{value:void 0,onValueChange:()=>{}}),rW=p.forwardRef((t,e)=>{const{value:n,onValueChange:r,...s}=t,i=Vr(r);return a.jsx(MEe,{scope:t.__scopeMenu,value:n,onValueChange:i,children:a.jsx(DA,{...s,ref:e})})});rW.displayName=nW;var sW="MenuRadioItem",iW=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=LEe(sW,t.__scopeMenu),i=n===s.value;return a.jsx(oW,{scope:t.__scopeMenu,checked:i,children:a.jsx(n_,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":LA(i),onSelect:gt(r.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});iW.displayName=sW;var MA="MenuItemIndicator",[oW,FEe]=yd(MA,{checked:!1}),aW=p.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...s}=t,i=FEe(MA,n);return a.jsx(xs,{present:r||Zw(i.checked)||i.checked===!0,children:a.jsx(Yt.span,{...s,ref:e,"data-state":LA(i.checked)})})});aW.displayName=MA;var OEe="MenuSeparator",lW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Yt.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});lW.displayName=OEe;var VEe="MenuArrow",cW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=t_(n);return a.jsx(W7,{...s,...r,ref:e})});cW.displayName=VEe;var $Ee="MenuSub",[wje,uW]=yd($Ee),km="MenuSubTrigger",dW=p.forwardRef((t,e)=>{const n=xd(km,t.__scopeMenu),r=iy(km,t.__scopeMenu),s=uW(km,t.__scopeMenu),i=RA(km,t.__scopeMenu),o=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:t.__scopeMenu},d=p.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return p.useEffect(()=>d,[d]),p.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),a.jsx(AA,{asChild:!0,...u,children:a.jsx(eW,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":mW(n.open),...t,ref:k0(e,s.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:gt(t.onPointerMove,ug(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:gt(t.onPointerLeave,ug(h=>{var m,g;d();const f=(m=n.content)==null?void 0:m.getBoundingClientRect();if(f){const x=(g=n.content)==null?void 0:g.dataset.side,v=x==="right",w=v?-5:5,_=f[v?"left":"right"],C=f[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+w,y:h.clientY},{x:_,y:f.top},{x:C,y:f.top},{x:C,y:f.bottom},{x:_,y:f.bottom}],side:x}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:gt(t.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||wEe[r.dir].includes(h.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),h.preventDefault())})})})});dW.displayName=km;var hW="MenuSubContent",fW=p.forwardRef((t,e)=>{const n=J7(uo,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=xd(uo,t.__scopeMenu),o=iy(uo,t.__scopeMenu),l=uW(hW,t.__scopeMenu),c=p.useRef(null),u=yn(e,c);return a.jsx(cg.Provider,{scope:t.__scopeMenu,children:a.jsx(xs,{present:r||i.open,children:a.jsx(cg.Slot,{scope:t.__scopeMenu,children:a.jsx(jA,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:gt(t.onFocusOutside,d=>{d.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:gt(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:gt(t.onKeyDown,d=>{var m;const h=d.currentTarget.contains(d.target),f=bEe[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),d.preventDefault())})})})})})});fW.displayName=hW;function mW(t){return t?"open":"closed"}function Zw(t){return t==="indeterminate"}function LA(t){return Zw(t)?"indeterminate":t?"checked":"unchecked"}function UEe(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function BEe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function zEe(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=BEe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function GEe(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const l=e[i],c=e[o],u=l.x,d=l.y,h=c.x,f=c.y;d>r!=f>r&&n<(h-u)*(r-d)/(f-d)+u&&(s=!s)}return s}function WEe(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return GEe(n,e)}function ug(t){return e=>e.pointerType==="mouse"?t(e):void 0}var HEe=Y7,qEe=AA,KEe=X7,YEe=Q7,JEe=DA,XEe=Z7,QEe=n_,ZEe=tW,eTe=rW,tTe=iW,nTe=aW,rTe=lW,sTe=cW,iTe=dW,oTe=fW,r_="DropdownMenu",[aTe,bje]=wi(r_,[q7]),ti=q7(),[lTe,pW]=aTe(r_),gW=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=t,c=ti(e),u=p.useRef(null),[d,h]=Fc({prop:s,defaultProp:i??!1,onChange:o,caller:r_});return a.jsx(lTe,{scope:e,triggerId:ic(),triggerRef:u,contentId:ic(),open:d,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(f=>!f),[h]),modal:l,children:a.jsx(HEe,{...c,open:d,onOpenChange:h,dir:r,modal:l,children:n})})};gW.displayName=r_;var yW="DropdownMenuTrigger",xW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=t,i=pW(yW,n),o=ti(n);return a.jsx(qEe,{asChild:!0,...o,children:a.jsx(Yt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:k0(e,i.triggerRef),onPointerDown:gt(t.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:gt(t.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});xW.displayName=yW;var cTe="DropdownMenuPortal",vW=t=>{const{__scopeDropdownMenu:e,...n}=t,r=ti(e);return a.jsx(KEe,{...r,...n})};vW.displayName=cTe;var wW="DropdownMenuContent",bW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=pW(wW,n),i=ti(n),o=p.useRef(!1);return a.jsx(YEe,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:e,onCloseAutoFocus:gt(t.onCloseAutoFocus,l=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:gt(t.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!s.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});bW.displayName=wW;var uTe="DropdownMenuGroup",dTe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(JEe,{...s,...r,ref:e})});dTe.displayName=uTe;var hTe="DropdownMenuLabel",_W=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(XEe,{...s,...r,ref:e})});_W.displayName=hTe;var fTe="DropdownMenuItem",SW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(QEe,{...s,...r,ref:e})});SW.displayName=fTe;var mTe="DropdownMenuCheckboxItem",CW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(ZEe,{...s,...r,ref:e})});CW.displayName=mTe;var pTe="DropdownMenuRadioGroup",gTe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(eTe,{...s,...r,ref:e})});gTe.displayName=pTe;var yTe="DropdownMenuRadioItem",EW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(tTe,{...s,...r,ref:e})});EW.displayName=yTe;var xTe="DropdownMenuItemIndicator",TW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(nTe,{...s,...r,ref:e})});TW.displayName=xTe;var vTe="DropdownMenuSeparator",IW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(rTe,{...s,...r,ref:e})});IW.displayName=vTe;var wTe="DropdownMenuArrow",bTe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(sTe,{...s,...r,ref:e})});bTe.displayName=wTe;var _Te="DropdownMenuSubTrigger",NW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(iTe,{...s,...r,ref:e})});NW.displayName=_Te;var STe="DropdownMenuSubContent",PW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ti(n);return a.jsx(oTe,{...s,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});PW.displayName=STe;var CTe=gW,ETe=xW,TTe=vW,AW=bW,kW=_W,RW=SW,jW=CW,DW=EW,MW=TW,LW=IW,FW=NW,OW=PW;const wx=CTe,bx=ETe,ITe=p.forwardRef(({className:t,inset:e,children:n,...r},s)=>a.jsxs(FW,{ref:s,className:bt("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...r,children:[n,a.jsx(_ie,{className:"ml-auto"})]}));ITe.displayName=FW.displayName;const NTe=p.forwardRef(({className:t,...e},n)=>a.jsx(OW,{ref:n,className:bt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...e}));NTe.displayName=OW.displayName;const Rm=p.forwardRef(({className:t,sideOffset:e=4,...n},r)=>a.jsx(TTe,{children:a.jsx(AW,{ref:r,sideOffset:e,className:bt("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}));Rm.displayName=AW.displayName;const zs=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(RW,{ref:r,className:bt("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",e&&"pl-8",t),...n}));zs.displayName=RW.displayName;const PTe=p.forwardRef(({className:t,children:e,checked:n,...r},s)=>a.jsxs(jW,{ref:s,className:bt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(MW,{children:a.jsx(Sg,{className:"h-4 w-4"})})}),e]}));PTe.displayName=jW.displayName;const ATe=p.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(DW,{ref:r,className:bt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(MW,{children:a.jsx(Cie,{className:"h-2 w-2 fill-current"})})}),e]}));ATe.displayName=DW.displayName;const QT=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(kW,{ref:r,className:bt("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));QT.displayName=kW.displayName;const ZT=p.forwardRef(({className:t,...e},n)=>a.jsx(LW,{ref:n,className:bt("-mx-1 my-1 h-px bg-muted",t),...e}));ZT.displayName=LW.displayName;const WL=()=>{const{user:t}=yo(),[e,n]=p.useState(!1),[r,s]=p.useState(null),i=async()=>{if(!t){s("You must be logged in to create a business account.");return}n(!0),s(null);try{const c=(await Ja(kh,"createConnectAccount")({email:t.email})).data;if(c&&c.accountLinkUrl)window.location.href=c.accountLinkUrl;else throw new Error("Failed to retrieve the Stripe onboarding URL.")}catch(o){console.error("Stripe Connect onboarding error:",o),s(o.message||"An unexpected error occurred."),n(!1)}};return a.jsxs("button",{onClick:i,disabled:e,className:"w-full flex items-center",children:[a.jsx(Wh,{className:"mr-2 h-4 w-4"}),e?"Processing...":"Create Business Account",r&&a.jsx("p",{className:"text-xs text-destructive ml-2",children:r})]})},HL=()=>{const{profile:t}=yo(),[e,n]=p.useState(!1),[r,s]=p.useState(null);if(!(t!=null&&t.stripe_account_id)||!(t!=null&&t.stripe_charges_enabled))return null;const i=async()=>{n(!0),s(null);try{const c=(await Ja(kh,"createLoginLink")({stripeAccountId:t.stripe_account_id})).data;if(c&&c.loginLinkUrl)window.location.href=c.loginLinkUrl;else throw new Error("Failed to retrieve the Stripe dashboard link.")}catch(o){console.error("Stripe dashboard link error:",o),s(o.message||"An unexpected error occurred."),n(!1)}};return a.jsxs("button",{onClick:i,disabled:e,className:"w-full flex items-center",children:[a.jsx(Wh,{className:"mr-2 h-4 w-4"}),e?"Loading...":"Dashboard",r&&a.jsx("p",{className:"text-xs text-destructive ml-2",children:r})]})},FA=()=>{const{isAuthenticated:t,user:e,logout:n,session:r,subscriptionStatus:s,loadingProfile:i,profile:o}=yo(),l=vi(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),[g,x]=p.useState(!1),v=s==="active",w=(o==null?void 0:o.stripe_account_id)&&(o==null?void 0:o.stripe_account_details_submitted);p.useEffect(()=>{const E=localStorage.getItem("theme"),I=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;E==="dark"||!E&&I?(document.documentElement.classList.add("dark"),m(!0)):(document.documentElement.classList.remove("dark"),m(!1))},[]);const _=()=>{f?(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")),m(!f)},C=async()=>{try{await n(),l("/auth")}catch(E){console.error("Error logging out:",E)}},T=async()=>{if(!e){h("Authentication required. Please log in again.");return}u(!0),h(null);try{const N=(await Ja(kh,"stripeCreatePortalSession")()).data;if(N&&N.url)window.location.href=N.url;else throw new Error(N.error||"Failed to create portal session URL.")}catch(E){console.error("Portal session error:",E),h(E.message||"An unexpected error occurred.")}finally{u(!1)}},R=async()=>{if(!e){h("Authentication required.");return}try{const N=(await Ja(kh,"createConnectAccount")({email:e.email})).data;if(N&&N.accountLinkUrl)window.location.href=N.accountLinkUrl;else throw new Error("Failed to retrieve the Stripe onboarding URL.")}catch(E){console.error("Stripe Connect onboarding error:",E),h(E.message||"An unexpected error occurred.")}},A=async()=>{if(!e){h("Authentication required.");return}try{const N=(await Ja(kh,"createSubscriptionCheckout")({priceId:"price_1RPDinDktew9heHOLkkL3ZDv"})).data;if(N&&N.url)window.location.href=N.url;else throw new Error("Failed to retrieve the Stripe checkout URL.")}catch(E){console.error("Stripe subscription error:",E),h(E.message||"An unexpected error occurred.")}};return a.jsxs(a.Fragment,{children:[!i&&t&&!(o!=null&&o.stripe_account_id&&(o!=null&&o.stripe_account_details_submitted))&&a.jsx("div",{className:"bg-foreground text-background py-2 px-4 text-center text-sm dark:bg-blue-700 dark:text-white",children:a.jsxs("button",{onClick:R,className:"relative hover:underline focus:outline-none",children:["Create Your Business",a.jsx(Fie,{className:"absolute bottom-[-10px] right-[-13px] h-4 w-4 text-white"})]})}),a.jsxs(Pt.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full py-4 px-6 flex justify-between items-center sticky top-0 z-50 bg-background/80 backdrop-blur-md border-b",children:[a.jsxs(Xn,{to:"/",className:"flex items-center gap-2",children:[a.jsx("img",{src:f?"https://static.wixstatic.com/media/bd2e29_20f2a8a94b7e492a9d76e0b8b14e623b~mv2.png":"https://static.wixstatic.com/media/bd2e29_695f70787cc24db4891e63da7e7529b3~mv2.png",alt:"FreshFront Logo",className:"h-10 sm:h-[60px] w-auto transition-all"}),a.jsx("span",{className:"font-bold text-lg sm:text-xl transition-all",children:"FreshFront"})]}),a.jsxs("nav",{className:"hidden md:flex items-center gap-3",children:[!v&&a.jsx(O,{onClick:A,children:"Subscribe to Pro"}),a.jsxs(wx,{children:[a.jsx(bx,{asChild:!0,children:a.jsxs(O,{variant:"ghost",size:"sm",children:["Create ",a.jsx(Su,{className:"ml-1 h-4 w-4"})]})}),a.jsxs(Rm,{align:"end",children:[a.jsx(zs,{asChild:!0,children:a.jsx(Xn,{to:"/designer",children:"Designer"})}),a.jsx(zs,{asChild:!0,children:a.jsx("a",{href:"https://www.musicmigo.com",target:"_blank",rel:"noopener noreferrer",children:"Music"})}),a.jsx(zs,{asChild:!0,children:a.jsx(Xn,{to:"/podcast",children:"Podcast"})}),a.jsx(zs,{asChild:!0,children:a.jsx(Xn,{to:"/video",children:"Video"})})]})]}),t&&!i&&a.jsx(a.Fragment,{children:a.jsxs(wx,{children:[a.jsx(bx,{asChild:!0,children:a.jsxs(O,{variant:"outline",size:"sm",className:"rounded-full px-3 py-1.5 text-sm font-medium",children:[a.jsx(bie,{className:"mr-2 h-4 w-4"})," Business ",a.jsx(Su,{className:"ml-1 h-4 w-4"})]})}),a.jsxs(Rm,{align:"end",children:[a.jsx(QT,{children:"Stripe Connect"}),a.jsx(ZT,{}),w?a.jsx(zs,{children:a.jsx(HL,{})}):a.jsx(zs,{children:a.jsx(WL,{})}),v&&a.jsxs(zs,{onClick:T,disabled:c,children:[a.jsx(Sh,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Billing"]}),d&&a.jsx(zs,{disabled:!0,children:a.jsx("p",{className:"text-xs text-destructive",children:d})})]})]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(jo,{id:"theme-switcher-desktop",checked:f,onCheckedChange:_,"aria-label":"Toggle dark mode"}),f?a.jsx(TE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(IE,{className:"h-5 w-5 text-muted-foreground"})]}),t?a.jsxs(wx,{children:[a.jsx(bx,{asChild:!0,children:a.jsxs(O,{variant:"ghost",className:"flex items-center gap-2",children:[(e==null?void 0:e.photoURL)&&a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-6 w-6 rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground hidden lg:inline",children:e==null?void 0:e.email}),a.jsx(Su,{className:"h-4 w-4"})]})}),a.jsxs(Rm,{align:"end",children:[a.jsx(QT,{children:"My Account"}),a.jsx(ZT,{}),v&&a.jsxs(zs,{onClick:T,disabled:c,children:[a.jsx(Sh,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Billing"]}),a.jsxs(zs,{onClick:C,children:[a.jsx(p2,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(Xn,{to:"/auth",children:a.jsx(O,{variant:"ghost",size:"sm",children:"Log In"})}),a.jsx(Xn,{to:"/auth",children:a.jsx(O,{size:"sm",children:"Sign Up"})})]})]}),a.jsx("div",{className:"md:hidden",children:a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>x(!g),children:g?a.jsx(Wi,{className:"h-6 w-6"}):a.jsx(I3,{className:"h-6 w-6"})})})]}),a.jsx(_c,{children:g&&a.jsx(Pt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"md:hidden fixed inset-x-0 top-[117px] z-40 bg-background/95 backdrop-blur-sm p-6 border-b shadow-lg",children:a.jsxs("nav",{className:"flex flex-col gap-4",children:[a.jsxs(wx,{children:[a.jsx(bx,{asChild:!0,children:a.jsxs(O,{variant:"ghost",className:"w-full justify-start px-3 py-2 text-base",children:["Create ",a.jsx(Su,{className:"ml-auto h-4 w-4"})]})}),a.jsxs(Rm,{align:"end",children:[a.jsx(zs,{asChild:!0,children:a.jsx(Xn,{to:"/designer",children:"Designer"})}),a.jsx(zs,{asChild:!0,children:a.jsx("a",{href:"https://www.musicmigo.com",target:"_blank",rel:"noopener noreferrer",children:"Music"})}),a.jsx(zs,{asChild:!0,children:a.jsx(Xn,{to:"/podcast",children:"Podcast"})}),a.jsx(zs,{asChild:!0,children:a.jsx(Xn,{to:"/video",children:"Video"})})]})]}),t&&!i&&a.jsxs(a.Fragment,{children:[w?a.jsx(HL,{}):a.jsx(WL,{}),v&&a.jsxs(O,{variant:"outline",onClick:T,disabled:c,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(Sh,{className:"mr-2 h-4 w-4"})," ",c?"Loading...":"Manage Billing"]}),d&&a.jsx("p",{className:"text-xs text-destructive px-3 py-1",children:d})]}),a.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[a.jsx("span",{className:"text-base",children:"Dark Mode"}),a.jsx(jo,{id:"theme-switcher-mobile",checked:f,onCheckedChange:_,"aria-label":"Toggle dark mode"})]}),t?a.jsxs(a.Fragment,{children:[(e==null?void 0:e.photoURL)&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",children:[a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-8 w-8 rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email})]}),a.jsxs(O,{variant:"outline",onClick:C,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(p2,{className:"mr-2 h-4 w-4"})," Logout"]})]}):a.jsxs(a.Fragment,{children:[a.jsx(Xn,{to:"/auth",className:"w-full",children:a.jsx(O,{variant:"ghost",className:"w-full justify-start px-3 py-2 text-base",children:"Log In"})}),a.jsx(Xn,{to:"/auth",className:"w-full",children:a.jsx(O,{className:"w-full justify-start px-3 py-2 text-base",children:"Sign Up"})})]})]})})})]})},kTe=({rating:t})=>{const n=Math.round(t);return a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((r,s)=>a.jsx(NI,{className:`h-4 w-4 ${s<n?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},s))})},RTe=({isOpen:t,onClose:e,onAddProducts:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState(!1),[l,c]=p.useState([]),[u,d]=p.useState([]),[h,f]=p.useState({}),m=async()=>{if(r.trim()){o(!0),c([]);try{const w=await(await fetch(`https://us-central1-freshfront-c3181.cloudfunctions.net/aliexpressProxy?keywords=${encodeURIComponent(r)}`)).json();w&&w.products&&Array.isArray(w.products.product)?c(w.products.product):(console.warn("Unexpected API response structure:",w),c([]))}catch(v){console.error("Error fetching from AliExpress API:",v),c([])}finally{o(!1)}}},g=async v=>{if(u.some(_=>_.product_id===v.product_id))d(_=>_.filter(C=>C.product_id!==v.product_id));else if(d(_=>[..._,v]),!h[v.product_id])try{const C=await(await fetch(`https://us-central1-freshfront-c3181.cloudfunctions.net/aliexpressProxy?productId=${v.product_id}`)).json();C&&C.product_description&&f(T=>({...T,[v.product_id]:C}))}catch(_){console.error("Error fetching product details:",_)}},x=()=>{const v=u.map(w=>{const _=h[w.product_id]||{};return{...w,..._,product_photos:_.product_photos||[w.product_main_image_url]}});n(v),e()};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs($r,{className:"max-w-4xl h-[80vh] flex flex-col",children:[a.jsx(Ur,{children:a.jsx(Br,{children:"Search AliExpress Products"})}),a.jsxs("div",{className:"flex gap-2 p-4 border-b",children:[a.jsx(Je,{placeholder:"Search for products...",value:r,onChange:v=>s(v.target.value),onKeyPress:v=>v.key==="Enter"&&m(),className:"flex-grow"}),a.jsx(O,{onClick:m,disabled:i,children:i?a.jsx(ft,{className:"animate-spin"}):a.jsx(ju,{})})]}),a.jsxs("div",{className:"flex-grow overflow-y-auto p-4",children:[i&&a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(ft,{className:"animate-spin h-8 w-8"})}),!i&&l.length===0&&a.jsx("div",{className:"text-center text-gray-500",children:"No products found."}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:l.map(v=>{const w=parseFloat(v.target_sale_price),_=(w*1.5).toFixed(2),C=(_-w).toFixed(2);return a.jsxs("div",{className:`border rounded-lg p-2 cursor-pointer ${u.some(T=>T.product_id===v.product_id)?"border-blue-500 ring-2 ring-blue-500":""}`,onClick:()=>g(v),children:[a.jsx("img",{src:v.product_main_image_url,alt:v.product_title,className:"w-full h-40 object-cover rounded-md mb-2"}),a.jsx("h3",{className:"text-sm font-semibold truncate",children:v.product_title}),a.jsxs("div",{className:"text-lg font-bold text-blue-600",children:[a.jsxs("span",{children:["$",_]}),a.jsxs("span",{className:"text-sm text-green-500 ml-2",children:["(Profit: $",C,")"]})]}),a.jsxs("p",{className:"text-xs text-gray-500 truncate",children:["by ",v.shop_name]}),a.jsxs("div",{className:"flex items-center mt-1",children:[a.jsx(kTe,{rating:parseFloat(v.evaluate_rate)/20}),a.jsxs("span",{className:"text-xs text-gray-500 ml-1",children:["(",v.evaluate_rate,")"]})]}),a.jsx(O,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:T=>{T.stopPropagation(),window.open(v.product_detail_url,"_blank")},children:"Visit"})]},v.product_id)})})]}),a.jsxs(Ar,{className:"p-4 border-t",children:[a.jsx(O,{variant:"outline",onClick:e,children:"Cancel"}),a.jsxs(O,{onClick:x,disabled:u.length===0,children:["Add ",u.length," Products to Store"]})]})]})})};var OA="Progress",VA=100,[jTe,_je]=wi(OA),[DTe,MTe]=jTe(OA),VW=p.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=LTe,...o}=t;(s||s===0)&&!qL(s)&&console.error(FTe(`${s}`,"Progress"));const l=qL(s)?s:VA;r!==null&&!KL(r,l)&&console.error(OTe(`${r}`,"Progress"));const c=KL(r,l)?r:null,u=e0(c)?i(c,l):void 0;return a.jsx(DTe,{scope:n,value:c,max:l,children:a.jsx(Yt.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":e0(c)?c:void 0,"aria-valuetext":u,role:"progressbar","data-state":BW(c,l),"data-value":c??void 0,"data-max":l,...o,ref:e})})});VW.displayName=OA;var $W="ProgressIndicator",UW=p.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,s=MTe($W,n);return a.jsx(Yt.div,{"data-state":BW(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:e})});UW.displayName=$W;function LTe(t,e){return`${Math.round(t/e*100)}%`}function BW(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function e0(t){return typeof t=="number"}function qL(t){return e0(t)&&!isNaN(t)&&t>0}function KL(t,e){return e0(t)&&!isNaN(t)&&t<=e&&t>=0}function FTe(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${VA}\`.`}function OTe(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${VA} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var zW=VW,VTe=UW;const Oa=p.forwardRef(({className:t,value:e,...n},r)=>a.jsx(zW,{ref:r,className:bt("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:a.jsx(VTe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));Oa.displayName=zW.displayName;const $Te=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),UTe=({isOpen:t,onClose:e,product:n,onSave:r,storeId:s,theme:i})=>{const[o,l]=p.useState(null),[c,u]=p.useState(!1),[d,h]=p.useState(!1),[f,m]=p.useState(null),[g,x]=p.useState(!1),{toast:v}=vs();p.useEffect(()=>{n&&l({...n,name:n.name||n.product_title,description:n.description||n.product_description||"",price:n.price||n.target_sale_price*1.5,cost:n.cost||n.target_sale_price,shipping:n.shipping||n.shipping_cost||0,images:n.images||[n.product_main_image_url],variants:n.variants||[],inventory_count:n.inventory_count||0})},[n]);const w=(B,W)=>{l(X=>({...X,[B]:W}))},_=async B=>{if(B)try{const W=await $Te(B);l(X=>{const H=Array.isArray(X.images)?X.images:[];return{...X,images:[...H,W]}})}catch(W){console.error("Error converting file to base64:",W),v({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},C=B=>{l(W=>({...W,images:W.images.filter((X,H)=>H!==B)}))},T=async()=>{if(!o||!o.name){v({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const B=o.images&&o.images.length>0?o.images[0]:null;if(!B){v({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}h(!0);try{const{base64ImageData:W,mimeType:X}=await ig(B),H=o.name;let K=[];try{const $=await B0(W,X,H);$&&$.length>0&&K.push(...$.slice(0,2)),v({title:"Angles Generated",description:`${Math.min(2,($==null?void 0:$.length)||0)} angle images generated.`,variant:"success"})}catch($){console.error("Error generating angles:",$),v({title:"Angle Generation Failed",description:$.message,variant:"destructive"})}const V=[`Place this product, "${H}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${H}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const $ of V)try{const z=await $o(W,X,$);z&&z.editedImageData&&K.push(`data:${z.newMimeType};base64,${z.editedImageData}`)}catch(z){console.error(`Error generating context image with prompt "${$}":`,z),v({title:"Context Image Failed",description:`Failed for: ${$.substring(0,30)}...`,variant:"destructive"})}v({title:"Context Images Attempted",description:`Attempted to generate ${V.length} context images.`,variant:"success"}),K.length>0?l($=>{const z=Array.isArray($.images)?$.images:[],F=new Set(z),Z=K.filter(ce=>!F.has(ce));return Z.length>0?{...$,images:[...z,...Z]}:(v({title:"Visuals Generated",description:"Generated images were already present.",variant:"default"}),$)}):v({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"})}catch(W){console.error("Error in handleGenerateMoreVisuals:",W),v({title:"Visual Generation Error",description:W.message,variant:"destructive"})}finally{h(!1)}},R=(B,W)=>{l(X=>{const H=[...X.variants||[]];return H[B]={...H[B],name:W},{...X,variants:H}})},A=(B,W,X)=>{l(H=>{const K=[...H.variants||[]],V={...K[B]};return V.values=[...V.values||[]],V.values[W]=X,K[B]=V,{...H,variants:K}})},E=B=>{l(W=>{const X=[...W.variants||[]],H={...X[B]};return H.values=[...H.values||[],""],X[B]=H,{...W,variants:X}})},I=(B,W)=>{l(X=>{const H=[...X.variants||[]],K={...H[B]};return K.values=(K.values||[]).filter((V,$)=>$!==W),H[B]=K,{...X,variants:H}})},N=()=>{l(B=>({...B,variants:[...B.variants||[],{name:"",values:[""]}]}))},k=B=>{l(W=>({...W,variants:(W.variants||[]).filter((X,H)=>H!==B)}))},j=async()=>{if(u(!0),!o.name||o.name.trim()===""||o.price===void 0||String(o.price).trim()===""){v({title:"Missing Information",description:"Please ensure the product has a name and a valid price.",variant:"destructive"}),u(!1);return}try{const B={...o,product_title:o.name,product_description:o.description,sale_price:o.price,target_sale_price:o.cost,shipping_cost:o.shipping,product_main_image_url:o.images[0]};await r(B),e()}catch{v({title:"Save Error",description:"Could not save product changes.",variant:"destructive"})}finally{u(!1)}},D=B=>{m(B),x(!0)};if(!t||!o)return null;const L=o.price-o.cost-o.shipping,G=o.price>0?L/o.price*100:0;return a.jsxs(a.Fragment,{children:[a.jsx(Yr,{open:t,onOpenChange:B=>!B&&e(),children:a.jsxs($r,{className:"max-w-2xl",children:[a.jsxs(Ur,{children:[a.jsxs(Br,{children:["Edit Product: ",n.product_title]}),a.jsx(Ji,{children:"Make changes to the product details below."})]}),a.jsx(Ls,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"space-y-4 pr-4",children:a.jsxs(Xe,{className:"p-4 space-y-3",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"productName-edit",children:"Product Name"}),a.jsx(Je,{id:"productName-edit",value:o.name,onChange:B=>w("name",B.target.value),placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"productDescription-edit",children:"Description"}),a.jsx(En,{id:"productDescription-edit",value:o.description,onChange:B=>w("description",B.target.value),placeholder:"Product Description",rows:3})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(Re,{htmlFor:"productPrice-edit",children:["Price (",o.currencyCode||"USD",")"]}),a.jsx(Je,{id:"productPrice-edit",type:"number",value:o.price,onChange:B=>w("price",parseFloat(B.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx(Oa,{value:100,className:"h-2"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Re,{htmlFor:"productCost-edit",children:"Cost"}),a.jsx(Je,{id:"productCost-edit",type:"number",value:o.cost,onChange:B=>w("cost",parseFloat(B.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx(Oa,{value:o.price>0?o.cost/o.price*100:0,className:"h-2 [&>div]:bg-red-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Re,{htmlFor:"productShipping-edit",children:"Shipping"}),a.jsx(Je,{id:"productShipping-edit",type:"number",value:o.shipping,onChange:B=>w("shipping",parseFloat(B.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx(Oa,{value:o.price>0?o.shipping/o.price*100:0,className:"h-2 [&>div]:bg-orange-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Re,{children:"Profit"}),a.jsx(Je,{value:L.toFixed(2),disabled:!0,className:"w-24 text-right"})]}),a.jsx(Oa,{value:G,className:"h-2 [&>div]:bg-green-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Re,{children:"Profit Margin"}),a.jsx(Je,{value:`${G.toFixed(2)}%`,disabled:!0,className:"w-24 text-right"})]}),a.jsx(Oa,{value:G,className:"h-2 [&>div]:bg-green-500"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{children:"Product Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(o.images||[]).map((B,W)=>a.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>D(B),children:[a.jsx("img",{src:B,alt:`Product image ${W+1}`,className:"w-full h-full object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:X=>{X.stopPropagation(),C(W)},children:a.jsx(Fn,{className:"h-3 w-3"})})]},W))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById("productImageUpload-edit").click(),children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsx(Je,{id:"productImageUpload-edit",type:"file",accept:"image/*",className:"hidden",onChange:B=>_(B.target.files[0])}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:T,disabled:c||d||!o.name||!o.images||o.images.length===0,children:[d?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"More Angles/Context (AI)"]})]})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(o.variants||[]).map((B,W)=>a.jsxs(Xe,{className:"p-2 space-y-2 bg-muted/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Re,{htmlFor:`variantName-edit-${W}`,className:"text-xs",children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>k(W),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(Je,{id:`variantName-edit-${W}`,value:B.name||"",onChange:X=>R(W,X.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(Re,{className:"text-xs",children:"Option Values"}),(B.values||[]).map((X,H)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Je,{value:X||"",onChange:K=>A(W,H,K.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>I(W,H),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]},H)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>E(W),className:"text-xs h-7",children:[a.jsx(Li,{className:"mr-1 h-3 w-3"})," Add Value"]})]},W)),a.jsxs(O,{variant:"outline",onClick:N,className:"w-full text-sm h-8",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]}),a.jsxs("div",{className:"pt-3 border-t mt-3",children:[a.jsx(Re,{htmlFor:"productInventory-edit",children:"Inventory Count"}),a.jsx(Je,{id:"productInventory-edit",type:"number",value:o.inventory_count||"",onChange:B=>w("inventory_count",parseInt(B.target.value)||0),placeholder:"0"})]})]})})}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsxs(O,{type:"button",onClick:j,disabled:c,children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save Changes"]})]})]})}),g&&f&&a.jsx(Yr,{open:g,onOpenChange:x,children:a.jsxs($r,{className:"max-w-xl max-h-[80vh]",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Enlarged Image"}),a.jsx(rl,{asChild:!0,children:a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:()=>x(!1),children:a.jsx(Li,{className:"h-4 w-4 rotate-45"})})})]}),a.jsx("div",{className:"flex justify-center items-center p-4",children:a.jsx("img",{src:f,alt:"Enlarged product",className:"max-w-full max-h-[70vh] object-contain"})})]})})]})},YL=["Create a luxury jewelry store called 'Elegance' with diamond rings and gold necklaces, featuring a dark, sophisticated theme.","Build a tech gadget store named 'FutureTech' with the latest smartphones and accessories, using a futuristic blue and silver color scheme.","Design an organic food market 'GreenHarvest' with fresh produce and healthy snacks, emphasizing natural textures and earthy tones.","Make a trendy fashion boutique 'Urban Threads' with summer dresses and casual wear, aiming for a bright, minimalist aesthetic."],ZS={"Healthy Food":{keywords:["healthy food","organic food","greenharvest","fresh produce","natural food","health store"],primaryColor:"green",secondaryColor:"orange",templates:["Classic","Fresh","Sleek"]},"Fast Food":{keywords:["fast food","burgers","fries","pizza","takeaway","quick serve"],primaryColor:"red",secondaryColor:"orange",templates:["Premium","Modern","Classic","Fresh","Sleek"]},Technology:{keywords:["tech","gadget","electronics","software","computer","phone","futuretech"],primaryColor:"blue",secondaryColor:"purple",templates:["Classic","Fresh","Sleek","Sharp","Premium","Modern"]},"General Store":{keywords:["general store","variety store","convenience store","department store"],primaryColor:"navy",secondaryColor:"grey",templates:["Classic","Fresh","Sleek","Premium","Modern"]},"Female Fashion/Beauty":{keywords:["female fashion","beauty","cosmetics","makeup","women's clothing","boutique","urban threads"],primaryColor:"peach",secondaryColor:"purple",templates:["Classic","Fresh","Sleek"]},Jewelry:{keywords:["jewelry","rings","necklaces","earrings","diamonds","gold","elegance"],primaryColor:"grey",secondaryColor:"darkpurple",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Fashion:{keywords:["fashion","clothing","apparel","style","wear"],primaryColor:"navyblue",secondaryColor:"mediumred",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Furniture:{keywords:["furniture","home decor","sofa","table","chair","furnishings"],primaryColor:"brown",secondaryColor:"darkgrey",templates:["Classic","Fresh","Sleek"]},Default:{keywords:[],primaryColor:"blue",secondaryColor:"gray",templates:["Fresh","Classic","Sleek","Modern"]}},BTe=t=>{const e=t.toLowerCase();for(const n in ZS){if(n==="Default")continue;const r=ZS[n];if(r.keywords.some(s=>e.includes(s.toLowerCase())))return{...r,name:n}}return{...ZS.Default,name:"General Store"}},zTe=({generatedImage:t})=>{const[e,n]=p.useState(""),[r,s]=p.useState(""),[i,o]=p.useState(null),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState(!1),[m,g]=p.useState([]),[x,v]=p.useState(null),[w,_]=p.useState(!1),[C,T]=p.useState([]),R=p.useRef(null),{generateStore:A,isGenerating:E,importedStoreDataForGenerator:I,isImportDataReadyForGenerator:N,clearImportedStoreDataForGenerator:k,stores:j,openAuthModal:D}=Vn(),{isAuthenticated:L}=yo(),[G,B]=p.useState(!1),[W,X]=p.useState(null),[H,K]=p.useState([]),[V,$]=p.useState(!1),[z,F]=p.useState(null),Z=Cse(e,500);p.useEffect(()=>{if(t){const ie=atob(t.split(",")[1]),Me=t.split(",")[0].split(":")[1].split(";")[0],He=new ArrayBuffer(ie.length),yt=new Uint8Array(He);for(let mn=0;mn<ie.length;mn++)yt[mn]=ie.charCodeAt(mn);const kt=new Blob([He],{type:Me}),en=new File([kt],"design.png",{type:Me});T([{file:en,previewUrl:t}])}},[t]),p.useEffect(()=>{(async()=>{if(!Z.trim()||V)return;$(!0),F(null),K([]);const Me=await mI(Z);Me.suggestions?K(Me.suggestions):F(Me.error||"Failed to get suggestions."),$(!1)})()},[Z]),p.useEffect(()=>()=>{C.forEach(ie=>{ie.previewUrl&&URL.revokeObjectURL(ie.previewUrl)})},[C]),p.useEffect(()=>{N&&I&&(n(I.name||""),s(I.prompt||""),I.name&&he(I.name),k())},[N,I,k]);const ce=ie=>{n(ie.target.value),X(null),K([]),F(null)},le=ie=>{n(ie),K([]),X(null),setTimeout(()=>he(ie),0)},he=p.useCallback(async ie=>{const Me=ie||e;if(!Me.trim())return X({status:"error",message:"Store name cannot be empty."}),!1;B(!0),X(null);try{return await zT(Me.trim())?(X({status:"claimed",message:"Not available"}),!1):(X({status:"available",message:"Available"}),!0)}catch(He){return console.error("Store name availability check failed in StoreGenerator:",He),X({status:"error",message:He.message||"Failed to check name. Please try again."}),!1}finally{B(!1)}},[e]),Le=ie=>{o(ie);const Me=YL[ie],He=Me.match(/(?:store called|store named|market|boutique) '([^']+)'/i),yt=He&&He[1]?He[1]:"";n(yt),s(Me),X(null),yt&&setTimeout(()=>he(yt),0)},$e=async ie=>{if(ie.preventDefault(),!L&&j.length>=1){D();return}let Me=!1;if(W&&W.status==="available"?Me=!0:e.trim()?Me=await he(e):X({status:"error",message:"Store name cannot be empty."}),!Me)return;if(!r.trim()){alert("Please provide a description for your store.");return}if(E||G)return;const He=BTe(r);try{await A(r,e,He,[],l,u,C,m)}catch(yt){console.error("Error calling generateStore from StoreGenerator:",yt),alert(`An error occurred during the store generation step: ${yt.message}`)}},Be=ie=>{const He=Array.from(ie.target.files).map(yt=>({file:yt,previewUrl:yt.type.startsWith("image/")?URL.createObjectURL(yt):null}));T(yt=>[...yt,...He])},ue=ie=>{const Me=C[ie];Me.previewUrl&&URL.revokeObjectURL(Me.previewUrl),T(He=>He.filter((yt,kt)=>kt!==ie))},Ce=ie=>{g(ie)},Ie=ie=>{v(ie),_(!0)},ve=ie=>{g(m.map(Me=>Me.product_id===ie.product_id?ie:Me)),_(!1)};return a.jsxs(Pt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full",children:[a.jsxs("form",{onSubmit:$e,children:[a.jsxs("div",{className:"mb-[13px]",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"storeName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 ml-[6px]",children:"Store Name"}),a.jsxs("div",{className:"relative flex items-center",children:[a.jsx(Je,{id:"storeName",type:"text",placeholder:"ex. Future Furniture",className:bt("text-base flex-grow",(W==null?void 0:W.status)==="claimed"&&"border-red-500 focus:border-red-500 dark:border-red-500 dark:focus:border-red-500",(W==null?void 0:W.status)==="error"&&"border-yellow-500 focus:border-yellow-500 dark:border-yellow-500 dark:focus:border-yellow-500",(W==null?void 0:W.status)==="available"&&"border-green-500 focus:border-green-500 dark:border-green-500 dark:focus:border-green-500","pr-24"),value:e,onChange:ce,disabled:E||G}),a.jsxs(O,{type:"button",variant:"ghost",size:"sm",onClick:()=>he(),disabled:!e.trim()||G,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[G?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(fa,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs("div",{className:"mt-1",children:[" ",G&&e.trim()&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(ft,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),W&&e.trim()&&!G&&a.jsxs("p",{className:`text-sm font-medium flex items-center ${W.status==="available"?"text-green-600":W.status==="claimed"?"text-red-600":W.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[W.status==="available"&&a.jsx(fa,{className:"h-4 w-4 mr-1"}),W.status==="claimed"&&a.jsx(H_,{className:"h-4 w-4 mr-1"}),W.status==="error"&&a.jsx(H_,{className:"h-4 w-4 mr-1"}),W.message]})]}),(V||H.length>0||z)&&a.jsxs("div",{className:"mt-[7px] mb-[13px]",children:[V&&a.jsxs("div",{className:"flex items-center space-x-2 animate-pulse h-8",children:[a.jsx("div",{className:"h-8 w-28 bg-gray-200 dark:bg-gray-700 rounded-md"}),a.jsx("div",{className:"h-8 w-32 bg-gray-200 dark:bg-gray-700 rounded-md"}),a.jsx("div",{className:"h-8 w-24 bg-gray-200 dark:bg-gray-700 rounded-md"})]}),!V&&H.length>0&&a.jsxs(Pt.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-wrap gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground mr-2 self-center",children:"Suggestions:"}),H.map((ie,Me)=>a.jsx(O,{type:"button",variant:"outline",size:"sm",onClick:()=>le(ie),className:"bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 dark:border-gray-600 saturate-0",children:ie},Me))]}),z&&a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(H_,{className:"h-4 w-4 mr-1"})," ",z]})]})]}),a.jsxs("div",{className:"pt-0 mt-[14px] mb-[13px]",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{htmlFor:"storePrompt",className:"text-sm font-medium text-gray-700 dark:text-gray-300 ml-[6px]",children:"Prompt"}),a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"printOnDemandCheckbox",checked:l,onChange:ie=>c(ie.target.checked),className:bt("appearance-none h-4 w-4 border rounded-full checked:border-transparent focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-gray-900 cursor-pointer","border-gray-400 dark:border-gray-500","focus:ring-orange-500",l&&"bg-orange-500 border-orange-500 animate-radiate-orange")}),a.jsx("label",{htmlFor:"printOnDemandCheckbox",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Print on Demand"})]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[a.jsx("input",{type:"checkbox",id:"dropshippingCheckbox",checked:u,onChange:ie=>{d(ie.target.checked),ie.target.checked&&f(!0)},className:bt("appearance-none h-4 w-4 border rounded-full checked:border-transparent focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-gray-900 cursor-pointer","border-gray-400 dark:border-gray-500","focus:ring-blue-500",u&&"bg-blue-500 border-blue-500 animate-radiate-blue")}),a.jsx("label",{htmlFor:"dropshippingCheckbox",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Dropshipping"})]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(En,{id:"storePrompt",placeholder:"ex. 'A modern furniture store specializing in sustainable and innovative designs for the contemporary home. Focus on minimalist aesthetics and smart functionality.'",className:"min-h-[120px] text-base resize-none w-full pr-12",value:r,onChange:ie=>s(ie.target.value),disabled:E}),a.jsxs("div",{className:"absolute bottom-2 right-2 flex items-center",children:[a.jsx("div",{className:"flex items-center gap-2 mr-2",children:C.map((ie,Me)=>a.jsxs("div",{className:"relative group",children:[ie.previewUrl?a.jsx("img",{src:ie.previewUrl,alt:"Preview",className:"h-8 w-8 rounded-md object-cover"}):a.jsx("div",{className:"h-8 w-8 rounded-md bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:a.jsx(Sr,{className:"h-5 w-5 text-gray-500"})}),a.jsx(O,{variant:"ghost",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 rounded-full bg-red-500 text-white opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>ue(Me),children:a.jsx(Wi,{className:"h-3 w-3"})})]},Me))}),a.jsx(O,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",onClick:()=>R.current.click(),disabled:E,children:a.jsx(Oie,{className:"h-5 w-5"})})]}),a.jsx("input",{type:"file",ref:R,multiple:!0,onChange:Be,className:"hidden",accept:"application/pdf,image/*"})]})]}),m.length>0&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Selected Dropshipping Products"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:m.map(ie=>a.jsxs("div",{className:"border rounded-lg p-2 cursor-pointer",onClick:()=>Ie(ie),children:[a.jsx("img",{src:ie.product_main_image_url,alt:ie.product_title,className:"w-full h-24 object-cover rounded-md mb-2"}),a.jsx("p",{className:"text-sm truncate",children:ie.product_title})]},ie.product_id))})]})]}),a.jsx(O,{type:"submit",disabled:!e.trim()||!r.trim()||E||G||W&&W.status!=="available",className:"w-full bg-gradient-to-r from-green-600 to-cyan-600 hover:from-green-700 hover:to-cyan-700 text-white mt-6",size:"lg",children:E?a.jsxs(a.Fragment,{children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Store..."]}):a.jsxs(a.Fragment,{children:[a.jsx(wa,{className:"mr-2 h-4 w-4"}),"Generate Store"]})}),a.jsxs("div",{className:"space-y-2 mt-6",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Or try one of these examples for inspiration:"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:YL.map((ie,Me)=>a.jsx(O,{type:"button",variant:"outline",className:bt("h-auto py-2 px-3 justify-start text-left text-sm font-normal",i===Me?"bg-[#c9ccd1] text-black hover:bg-[#c9ccd1] dark:bg-[#242424] dark:text-gray-300 dark:hover:bg-[#242424]":"hover:bg-accent hover:text-accent-foreground"),onClick:()=>Le(Me),disabled:E,children:ie},Me))})]})]}),a.jsx(RTe,{isOpen:h,onClose:()=>f(!1),onAddProducts:Ce}),x&&a.jsx(UTe,{isOpen:w,onClose:()=>_(!1),product:x,onSave:ve})]})};var GW="AlertDialog",[GTe,Sje]=wi(GW,[eU]),bl=eU(),WW=t=>{const{__scopeAlertDialog:e,...n}=t,r=bl(e);return a.jsx(gU,{...r,...n,modal:!0})};WW.displayName=GW;var WTe="AlertDialogTrigger",HW=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=bl(n);return a.jsx(sae,{...s,...r,ref:e})});HW.displayName=WTe;var HTe="AlertDialogPortal",qW=t=>{const{__scopeAlertDialog:e,...n}=t,r=bl(e);return a.jsx(yU,{...r,...n})};qW.displayName=HTe;var qTe="AlertDialogOverlay",KW=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=bl(n);return a.jsx(MI,{...s,...r,ref:e})});KW.displayName=qTe;var jh="AlertDialogContent",[KTe,YTe]=GTe(jh),JTe=Pse("AlertDialogContent"),YW=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,children:r,...s}=t,i=bl(n),o=p.useRef(null),l=yn(e,o),c=p.useRef(null);return a.jsx(eae,{contentName:jh,titleName:JW,docsSlug:"alert-dialog",children:a.jsx(KTe,{scope:n,cancelRef:c,children:a.jsxs(LI,{role:"alertdialog",...i,...s,ref:l,onOpenAutoFocus:gt(s.onOpenAutoFocus,u=>{var d;u.preventDefault(),(d=c.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[a.jsx(JTe,{children:r}),a.jsx(QTe,{contentRef:o})]})})})});YW.displayName=jh;var JW="AlertDialogTitle",XW=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=bl(n);return a.jsx(FI,{...s,...r,ref:e})});XW.displayName=JW;var QW="AlertDialogDescription",ZW=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=bl(n);return a.jsx(OI,{...s,...r,ref:e})});ZW.displayName=QW;var XTe="AlertDialogAction",eH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=bl(n);return a.jsx(O0,{...s,...r,ref:e})});eH.displayName=XTe;var tH="AlertDialogCancel",nH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,{cancelRef:s}=YTe(tH,n),i=bl(n),o=yn(e,s);return a.jsx(O0,{...i,...r,ref:o})});nH.displayName=tH;var QTe=({contentRef:t})=>{const e=`\`${jh}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${jh}\` by passing a \`${QW}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${jh}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(e)},[e,t]),null},ZTe=WW,e1e=HW,t1e=qW,rH=KW,sH=YW,iH=eH,oH=nH,aH=XW,lH=ZW;const n1e=ZTe,r1e=e1e,s1e=t1e,cH=ht.forwardRef(({className:t,...e},n)=>a.jsx(rH,{className:bt("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));cH.displayName=rH.displayName;const uH=ht.forwardRef(({className:t,...e},n)=>a.jsxs(s1e,{children:[a.jsx(cH,{}),a.jsx(sH,{ref:n,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e})]}));uH.displayName=sH.displayName;const dH=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col space-y-2 text-center sm:text-left",t),...e});dH.displayName="AlertDialogHeader";const hH=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});hH.displayName="AlertDialogFooter";const fH=ht.forwardRef(({className:t,...e},n)=>a.jsx(aH,{ref:n,className:bt("text-lg font-semibold",t),...e}));fH.displayName=aH.displayName;const mH=ht.forwardRef(({className:t,...e},n)=>a.jsx(lH,{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));mH.displayName=lH.displayName;const pH=ht.forwardRef(({className:t,...e},n)=>a.jsx(iH,{ref:n,className:bt(VI(),t),...e}));pH.displayName=iH.displayName;const gH=ht.forwardRef(({className:t,...e},n)=>a.jsx(oH,{ref:n,className:bt(VI({variant:"outline"}),"mt-2 sm:mt-0",t),...e}));gH.displayName=oH.displayName;const i1e=({store:t})=>{const e=vi(),{deleteStore:n,updateStorePassKey:r,assignStoreManager:s,updateStoreTemplateVersion:i}=Vn(),[o,l]=ht.useState(""),[c,u]=ht.useState(""),[d,h]=ht.useState(!1),f=()=>{r&&o&&t.id&&r(t.id,o)},m=()=>{s&&c&&t.id&&s(t.id,c)},g=v=>{if(!v)return"N/A";try{const w=new Date(v);return isNaN(w.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(w)}catch(w){return console.error("Error formatting date:",v,w),"Error Date"}},x=v=>{switch(v){case"fashion":return a.jsx(Hie,{className:"h-5 w-5 text-pink-500"});case"electronics":return a.jsx(Uy,{className:"h-5 w-5 text-blue-500"});case"food":return a.jsx(Uy,{className:"h-5 w-5 text-green-500"});case"jewelry":return a.jsx(Uy,{className:"h-5 w-5 text-amber-500"});default:return a.jsx(Uy,{className:"h-5 w-5 text-gray-500"})}};return a.jsx(Pt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"store-preview relative bg-cover bg-center rounded-[15px] overflow-hidden",style:t.card_background_url?{backgroundImage:`url(${t.card_background_url})`}:{backgroundColor:"#374151"},children:a.jsxs(Xe,{className:"h-full overflow-hidden border-2 border-white/20 hover:border-primary/50 transition-all duration-300 bg-black/30 backdrop-blur-sm text-white rounded-[15px]",children:[" ",a.jsxs("div",{className:"relative z-10 p-1 rounded-[15px]",children:[" ",a.jsxs(ct,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[t.logo_url?a.jsx("img",{src:t.logo_url,alt:`${t.name} logo`,className:"h-6 w-6 rounded-sm object-contain bg-white/30 p-0.5"}):x(t.type),a.jsx(ut,{className:"text-xl text-white drop-shadow-md",children:t.name})]}),a.jsx("span",{className:"px-2 py-1 bg-white/10 text-gray-200 text-xs rounded-full backdrop-blur-xs",children:t.type.charAt(0).toUpperCase()+t.type.slice(1)})]}),a.jsx(Qt,{className:"line-clamp-2 mt-1 text-gray-300 drop-shadow-sm",children:t.description})]}),a.jsxs(at,{className:"pb-2",children:[a.jsxs("div",{className:"flex items-center text-sm text-gray-300 drop-shadow-sm gap-1 mb-3",children:[a.jsx(CI,{className:"h-3.5 w-3.5 mr-1 text-gray-400"}),"Created on ",g(t.created_at||t.createdAt)]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:t&&t.products&&Array.isArray(t.products)&&t.products.length>0?t.products.slice(0,4).map(v=>a.jsxs("div",{className:"bg-white/10 p-2 rounded-md text-xs flex flex-col backdrop-blur-xs",children:[a.jsx("span",{className:"font-medium truncate text-gray-200",children:v.name||"Unnamed Product"}),a.jsxs("span",{className:"text-sky-300",children:[" ",typeof v.price=="number"?`$${v.price.toFixed(2)}`:"Price N/A"]})]},v.id)):a.jsx("p",{className:"text-xs text-gray-400 col-span-2",children:t&&t.products&&t.products.length===0?"No products yet.":"Product data unavailable."})})]}),a.jsxs(md,{className:"flex flex-col items-start gap-2 pt-2",children:[a.jsxs("div",{className:"flex w-full justify-between items-center",children:[a.jsx(O,{variant:"outline",size:"sm",className:"bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:()=>{t&&t.name?e(`/${mc(t.name)}`):console.error("Store name is missing, cannot navigate to preview.")},children:"Preview"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-300 hover:text-white hover:bg-white/10",onClick:()=>t&&t.name&&e(`/${mc(t.name)}?edit=true`),children:[a.jsx(Lp,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Edit"})]}),a.jsxs(n1e,{children:[a.jsx(r1e,{asChild:!0,children:a.jsxs(O,{variant:"ghost",size:"icon",className:"h-8 w-8 text-red-400 hover:text-red-300 hover:bg-red-500/10",children:[a.jsx(Fn,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Delete"})]})}),a.jsxs(uH,{children:[a.jsxs(dH,{children:[a.jsx(fH,{children:"Are you sure?"}),a.jsxs(mH,{children:['This will permanently delete the "',t.name,'" store and all its data. This action cannot be undone.']})]}),a.jsxs(hH,{children:[a.jsx(gH,{children:"Cancel"}),a.jsx(pH,{className:"bg-red-500 text-white hover:bg-red-600",onClick:()=>n(t.id),children:"Delete"})]})]})]})]})]}),a.jsxs("div",{className:"flex w-full items-center gap-2 mt-2",children:[a.jsx(Je,{type:"password",placeholder:"Set Pass Key",value:o,onChange:v=>l(v.target.value),className:"h-8 text-xs flex-grow bg-neutral-700/60 dark:bg-neutral-800/60 border-neutral-500 dark:border-neutral-600 placeholder-zinc-400 text-white focus:outline-none"}),a.jsxs(O,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:f,disabled:!o.trim(),children:[a.jsx(T3,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Set Pass Key"})]})]}),a.jsxs("div",{className:"w-full mt-2",children:[a.jsx(O,{variant:"outline",size:"sm",className:"w-full bg-white/10 hover:bg-white/20 text-gray-200 border-gray-500 hover:border-gray-400",onClick:()=>h(!d),children:d?"Cancel Assignment":"Assign Manager"}),d&&a.jsxs("div",{className:"flex w-full items-center gap-2 mt-2",children:[a.jsx(Je,{type:"email",placeholder:"Manager Email",value:c,onChange:v=>u(v.target.value),className:"h-8 text-xs flex-grow bg-neutral-700/60 dark:bg-neutral-800/60 border-neutral-500 dark:border-neutral-600 placeholder-zinc-400 text-white focus:outline-none"}),a.jsxs(O,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:()=>{m()},disabled:!c.trim(),children:[a.jsx(Jie,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Confirm Assign Manager"})]})]})]})]})]})]})})},o1e=()=>{const{stores:t,loadStores:e,isLoadingStores:n}=Vn(),{user:r}=yo(),s=()=>{console.log("[StoreList] handleRefreshStores called. User:",r),r&&r.uid?(console.log(`[StoreList] Calling loadStores for user UID: ${r.uid}`),e(r.uid)):console.warn("[StoreList] handleRefreshStores: No user or user.uid found, cannot refresh stores.")};return a.jsxs(Pt.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"w-full max-w-6xl mx-auto mt-8",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-2xl font-bold",children:"Browse Stores"}),a.jsxs(O,{onClick:s,variant:"outline",disabled:!r||n,children:[a.jsx(Xv,{className:`mr-2 h-4 w-4 ${n?"animate-spin":""}`}),n?"Loading...":"Load Stores"]})]}),n&&t.length===0&&a.jsx("div",{className:"text-center py-10",children:a.jsx("p",{className:"text-muted-foreground",children:"Loading your stores..."})}),!n&&t.length===0&&a.jsx("div",{className:"text-center py-10",children:a.jsx("p",{className:"text-muted-foreground",children:"You haven't created any stores yet. Get started by generating a new store!"})}),t.length>0&&a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map(i=>a.jsx(i1e,{store:i},i.id))})]})},a1e=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState(""),{startShopifyImportWizard:l,isFetchingShopifyPreviewData:c,shopifyImportError:u,setShopifyWizardStep:d}=Vn(),h=async f=>{if(f.preventDefault(),!r||!i){alert("Please enter both Shopify domain and access token.");return}await l(r,i)&&n&&n()};return a.jsx(Yr,{open:t,onOpenChange:f=>{e(f)},children:a.jsxs($r,{className:"sm:max-w-[425px] sm:rounded-xl",children:[" ",a.jsxs(Ur,{children:[a.jsx(Br,{children:"Connect to Shopify"}),a.jsxs(Ji,{className:"text-slate-500 dark:text-slate-400",children:[" ","Enter your Shopify store domain and Storefront Access Token to begin importing."]})]}),a.jsxs("form",{onSubmit:h,className:"grid gap-4 py-4",children:[u&&a.jsx("div",{className:"col-span-4 p-2 text-sm text-red-600 bg-red-100 border border-red-300 rounded",children:u}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"domain",className:"text-right",children:"Domain"}),a.jsx(Je,{id:"domain",value:r,onChange:f=>s(f.target.value),placeholder:_se,className:"col-span-3",disabled:c})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"token",className:"text-right",children:"Token"}),a.jsx(Je,{id:"token",type:"password",value:i,onChange:f=>o(f.target.value),placeholder:"Storefront Access Token",className:"col-span-3",disabled:c})]}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",disabled:c,onClick:()=>e(!1),children:"Cancel"}),a.jsx(O,{type:"submit",disabled:c||!r||!i,children:c?a.jsxs(a.Fragment,{children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):"Connect & Fetch Info"})]})]})]})})},l1e=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState("");p.useState(!1),p.useState(null),p.useState("");const{startBigCommerceImportWizard:l,bigCommerceImportError:c,isFetchingBigCommercePreviewData:u}=Vn(),d=async h=>{if(h.preventDefault(),!r||!i){alert("Both Store Domain and API Token are required.");return}await l(r,i),n&&n({storeDomain:r,apiToken:i})};return t?a.jsx("div",{className:"w-full",children:a.jsxs("form",{onSubmit:d,children:[a.jsxs(at,{className:"space-y-4 pt-6",children:[" ",a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"bc-store-domain",children:"Store Domain"}),a.jsx(Je,{id:"bc-store-domain",type:"text",placeholder:"e.g., mystore.mybigcommerce.com",value:r,onChange:h=>s(h.target.value.trim()),disabled:u})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"bc-api-token",children:"Storefront API Token"}),a.jsx(Je,{id:"bc-api-token",type:"password",placeholder:"Enter your Storefront API Token",value:i,onChange:h=>o(h.target.value.trim()),disabled:u})]}),c&&a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(ew,{className:"mr-2 h-4 w-4"})," ",c]})]}),a.jsx(md,{className:"flex flex-col space-y-2",children:a.jsxs(O,{type:"submit",className:"w-full",disabled:u,children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(fa,{className:"mr-2 h-4 w-4"}),u?"Connecting...":"Connect to BigCommerce"]})})]})}):null},c1e="modulepreload",u1e=function(t){return"/"+t},JL={},Ot=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=u1e(i),i in JL)return;JL[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":c1e,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},d1e="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",h1e=[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}],f1e=["Shirt","Mug","Hat","Totebag","Poster"];async function m1e(t,e){var l;if(!t)return console.warn("[geminiPromptAnalysis] User store prompt is empty. Defaulting to standard strategy."),{strategy:"standard",theme:"General",requestedProductTypes:[],isPod:!1,podConfidence:0,suggestedPodProducts:[]};const r=new On({apiKey:d1e}).getGenerativeModel({model:"gemini-2.5-flash-latest",safetySettings:h1e}),s=Zi.map(c=>c.name).join(", "),i=((l=qw.find(c=>c.value===e))==null?void 0:l.label)||e||"General",o=`
    Analyze the following user prompt for an e-commerce store and the store's product niche.
    User Prompt: "${t}"
    Product Niche: "${i}"
    Available Print-on-Demand (POD) base product types: ${s}.

    Your goal is to determine the best product generation strategy.

    Consider these scenarios:
    1.  If the prompt explicitly mentions "print on demand", "POD", "custom designs on products", "merch", or implies selling items like t-shirts, mugs, posters with custom graphics, or a store themed around a concept (e.g., "Spiderman store", "cat lovers store") where designs are applied to standard products.
    2.  If the prompt requests specific products that are typically print-on-demand (e.g., "I want to sell t-shirts and hoodies with my art", "custom phone cases").
    3.  If the prompt describes a theme (e.g., "a store for coffee lovers", "a store about space exploration") but doesn't specify products, AND the niche is NOT typically print-on-demand (e.g., food, high-end jewelry, complex electronics, furniture). In this case, a POD strategy might be appropriate to offer themed merchandise.
    4.  If the prompt requests products that are clearly NOT print-on-demand (e.g., "gourmet chocolates", "handmade silver necklaces", "custom-built drones", "artisanal wooden tables"), or if the niche itself strongly indicates non-POD products (e.g., "Restaurant", "Tech Repair Service").
    5.  If the prompt is very generic or doesn't give enough information to lean towards POD.

    Based on your analysis, return a JSON object with the following structure:
    {
      "isPod": boolean, // True if the store is likely print-on-demand focused or should use POD products.
      "podConfidence": number, // Confidence score (0.0 to 1.0) for isPod.
      "theme": "string", // A concise theme extracted from the prompt (e.g., "Vintage Cars", "Abstract Art", "Funny Quotes", "Spiderman"). If no clear theme, use "General".
      "requestedProductTypes": ["string"], // Array of specific product names mentioned in the prompt that match or are very similar to the available POD base product types. (e.g., ["Shirt", "Mug"]). Empty if none.
      "suggestedPodProducts": ["string"], // If isPod is true and requestedProductTypes is empty, suggest 3-5 relevant POD base product types from the available list based on the theme/niche. (e.g., ["Shirt", "Mug", "Poster"]). Empty otherwise.
      "generationStrategy": "string" // One of: "standard", "pod_theme_visualization", "pod_specific_products", "error"
    }

    Strategy decision logic:
    -   If "isPod" is true AND "requestedProductTypes" has items: "generationStrategy" should be "pod_specific_products".
    -   If "isPod" is true AND "requestedProductTypes" is empty (implying a themed POD store but no specific products mentioned by user): "generationStrategy" should be "pod_theme_visualization". Use "suggestedPodProducts" for this.
    -   If "isPod" is false: "generationStrategy" should be "standard".
    -   If the niche is something like food, complex tech, high-end jewelry, furniture, and the prompt doesn't strongly push for POD merch, lean towards "standard" even if a theme is mentioned. For example, a "Spiderman themed restaurant" is still "standard" for food products. A "Spiderman store" (general merch) is "pod_theme_visualization".

    Example 1 (Specific POD products):
    User Prompt: "I want to create a store selling t-shirts and coffee mugs with cool dog designs."
    Product Niche: "Fashion & Apparel"
    Expected Output: { "isPod": true, "podConfidence": 0.9, "theme": "Cool Dog Designs", "requestedProductTypes": ["Shirt", "Mug"], "suggestedPodProducts": [], "generationStrategy": "pod_specific_products" }

    Example 2 (Themed POD store, no specific products):
    User Prompt: "A store for fans of classic horror movies, with iconic imagery."
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": true, "podConfidence": 0.8, "theme": "Classic Horror Movies", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug", "Canvas"], "generationStrategy": "pod_theme_visualization" }

    Example 3 (Standard store, non-POD niche):
    User Prompt: "Selling delicious artisanal cookies and pastries."
    Product Niche: "Food & Beverage"
    Expected Output: { "isPod": false, "podConfidence": 0.1, "theme": "Artisanal Cookies and Pastries", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 4 (Themed store, but niche is non-POD, so standard products for niche, POD for merch):
    User Prompt: "A high-tech gadget store with a cyberpunk theme."
    Product Niche: "Electronics & Gadgets"
    Expected Output: { "isPod": false, "podConfidence": 0.3, "theme": "Cyberpunk", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }
    (Note: The task description implies if niche is non-POD but theme is present, we *should* call POD flow. Let's adjust this example's expectation for the AI)
    Revised Example 4 (Themed store, niche non-POD, but POD for merch is desired):
    User Prompt: "A high-tech gadget store with a cyberpunk theme. I want some cool merch too."
    Product Niche: "Electronics & Gadgets"
    Expected Output: { "isPod": true, "podConfidence": 0.7, "theme": "Cyberpunk", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug"], "generationStrategy": "pod_theme_visualization" }


    Example 5 (Unique products, not POD):
    User Prompt: "I craft unique, handmade wooden sculptures."
    Product Niche: "Art & Collectibles"
    Expected Output: { "isPod": false, "podConfidence": 0.05, "theme": "Handmade Wooden Sculptures", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 6 (Generic prompt, default to standard):
    User Prompt: "My new online shop"
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": false, "podConfidence": 0.2, "theme": "General", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 7 (Store theme implies POD, niche is general):
    User Prompt: "A store for all things Spiderman!"
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": true, "podConfidence": 0.9, "theme": "Spiderman", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug", "Hat", "Canvas"], "generationStrategy": "pod_theme_visualization" }

    Ensure the "theme" is concise. If "requestedProductTypes" are found, "suggestedPodProducts" should usually be empty. If "isPod" is true and "requestedProductTypes" is empty, "suggestedPodProducts" MUST be populated with 3-5 relevant items from the available POD list.
    The entire response MUST be a single JSON object.
  `;try{const d=(await r.generateContent(o)).response.text();let h;const f=d.match(/```json\s*([\s\S]*?)\s*```/);if(f&&f[1])h=JSON.parse(f[1]);else{const m=d.indexOf("{"),g=d.lastIndexOf("}");if(m!==-1&&g>m)h=JSON.parse(d.substring(m,g+1));else throw new Error("No JSON object found in response.")}return h.isPod&&(!h.requestedProductTypes||h.requestedProductTypes.length===0)&&(!h.suggestedPodProducts||h.suggestedPodProducts.length===0)&&(h.suggestedPodProducts=f1e.slice(0,Math.floor(Math.random()*3)+3),console.warn(`[geminiPromptAnalysis] POD strategy indicated but no specific or suggested POD products returned by AI. Defaulting suggestions: ${h.suggestedPodProducts.join(", ")}`)),h.strategy||(h.isPod&&h.requestedProductTypes&&h.requestedProductTypes.length>0?h.strategy="pod_specific_products":h.isPod?h.strategy="pod_theme_visualization":h.strategy="standard"),console.log("[geminiPromptAnalysis] Analysis result:",h),h}catch(c){return console.error("[geminiPromptAnalysis] Error analyzing store prompt:",c),{error:c.message,strategy:"error",theme:"General",requestedProductTypes:[],isPod:!1,podConfidence:0,suggestedPodProducts:[]}}}const p1e=SI("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function dg({className:t,variant:e,...n}){return a.jsx("div",{className:bt(p1e({variant:e}),t),...n})}var s_="Checkbox",[g1e,Cje]=wi(s_),[y1e,$A]=g1e(s_);function x1e(t){const{__scopeCheckbox:e,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:l,onCheckedChange:c,required:u,value:d="on",internal_do_not_use_render:h}=t,[f,m]=Fc({prop:n,defaultProp:s??!1,onChange:c,caller:s_}),[g,x]=p.useState(null),[v,w]=p.useState(null),_=p.useRef(!1),C=g?!!o||!!g.closest("form"):!0,T={checked:f,disabled:i,setChecked:m,control:g,setControl:x,name:l,form:o,value:d,hasConsumerStoppedPropagationRef:_,required:u,defaultChecked:yc(s)?!1:s,isFormControl:C,bubbleInput:v,setBubbleInput:w};return a.jsx(y1e,{scope:e,...T,children:v1e(h)?h(T):r})}var yH="CheckboxTrigger",xH=p.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...r},s)=>{const{control:i,value:o,disabled:l,checked:c,required:u,setControl:d,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:g}=$A(yH,t),x=yn(s,d),v=p.useRef(c);return p.useEffect(()=>{const w=i==null?void 0:i.form;if(w){const _=()=>h(v.current);return w.addEventListener("reset",_),()=>w.removeEventListener("reset",_)}},[i,h]),a.jsx(Yt.button,{type:"button",role:"checkbox","aria-checked":yc(c)?"mixed":c,"aria-required":u,"data-state":SH(c),"data-disabled":l?"":void 0,disabled:l,value:o,...r,ref:x,onKeyDown:gt(e,w=>{w.key==="Enter"&&w.preventDefault()}),onClick:gt(n,w=>{h(_=>yc(_)?!0:!_),g&&m&&(f.current=w.isPropagationStopped(),f.current||w.stopPropagation())})})});xH.displayName=yH;var UA=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:u,form:d,...h}=t;return a.jsx(x1e,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:l,required:o,onCheckedChange:u,name:r,form:d,value:c,internal_do_not_use_render:({isFormControl:f})=>a.jsxs(a.Fragment,{children:[a.jsx(xH,{...h,ref:e,__scopeCheckbox:n}),f&&a.jsx(_H,{__scopeCheckbox:n})]})})});UA.displayName=s_;var vH="CheckboxIndicator",wH=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...s}=t,i=$A(vH,n);return a.jsx(xs,{present:r||yc(i.checked)||i.checked===!0,children:a.jsx(Yt.span,{"data-state":SH(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});wH.displayName=vH;var bH="CheckboxBubbleInput",_H=p.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:l,disabled:c,name:u,value:d,form:h,bubbleInput:f,setBubbleInput:m}=$A(bH,t),g=yn(n,m),x=T7(i),v=TA(r);p.useEffect(()=>{const _=f;if(!_)return;const C=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(C,"checked").set,A=!s.current;if(x!==i&&R){const E=new Event("click",{bubbles:A});_.indeterminate=yc(i),R.call(_,yc(i)?!1:i),_.dispatchEvent(E)}},[f,x,i,s]);const w=p.useRef(yc(i)?!1:i);return a.jsx(Yt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??w.current,required:l,disabled:c,name:u,value:d,form:h,...e,tabIndex:-1,ref:g,style:{...e.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});_H.displayName=bH;function v1e(t){return typeof t=="function"}function yc(t){return t==="indeterminate"}function SH(t){return yc(t)?"indeterminate":t?"checked":"unchecked"}const CH=p.forwardRef(({className:t,...e},n)=>a.jsx(UA,{ref:n,className:bt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:a.jsx(wH,{className:bt("flex items-center justify-center text-current"),children:a.jsx(Sg,{className:"h-4 w-4"})})}));CH.displayName=UA.displayName;const w1e=({isOpen:t,onClose:e,collection:n,allProducts:r,onSave:s})=>{const[i,o]=p.useState([]),[l,c]=p.useState("");if(p.useEffect(()=>{n&&n.product_ids?o(n.product_ids):o([])},[n]),!n)return null;const u=h=>{o(f=>f.includes(h)?f.filter(m=>m!==h):[...f,h])},d=()=>{s(n.id??n.name,i),e()};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs($r,{className:"sm:max-w-[525px]",children:[a.jsxs(Ur,{children:[a.jsxs(Br,{children:['Manage Products for "',n.name||"Unnamed Collection",'"']}),a.jsx(Ji,{children:"Select or unselect products to include in this collection. Use the search bar to filter products."})]}),a.jsxs("div",{className:"py-4",children:[a.jsx(Je,{type:"text",placeholder:"Search products...",value:l,onChange:h=>c(h.target.value),className:"mb-4"}),r&&r.length>0?a.jsxs(Ls,{className:"h-[250px] pr-4",children:[" ",a.jsx("div",{className:"space-y-3",children:r.filter(h=>h.name.toLowerCase().includes(l.toLowerCase())).map(h=>a.jsxs("div",{className:"flex items-center space-x-3 p-3 border rounded-md hover:bg-muted/50 transition-colors",children:[a.jsx(CH,{id:`product-${n.id??n.name}-${h.id??h.name}`,checked:i.includes(h.id??h.name),onCheckedChange:()=>u(h.id??h.name)}),a.jsx(Re,{htmlFor:`product-${n.id??n.name}-${h.id??h.name}`,className:"flex-1 cursor-pointer",children:a.jsxs("div",{className:"flex items-center gap-3",children:[h.images&&h.images.length>0?a.jsx("img",{src:h.images[0],alt:h.name,className:"w-12 h-12 object-cover rounded-sm"}):a.jsx("div",{className:"w-12 h-12 bg-muted rounded-sm flex items-center justify-center text-xs text-muted-foreground",children:"No Img"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:h.name||"Untitled Product"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",h.price||"0.00"]})]})]})})]},h.id??h.name))})]}):a.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No products available to add to this collection. Please add products to your store first."})]}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",children:"Cancel"})}),a.jsx(O,{type:"button",onClick:d,disabled:!r||r.length===0,children:"Save Changes"})]})]})})},b1e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),_1e=({isOpen:t,onClose:e,product:n,onSave:r,onGenerateMainImage:s,onGenerateMoreAngles:i,productIndexInWizard:o,isGeneratingProductImage:l,isGeneratingAngles:c})=>{const[u,d]=p.useState(null),{toast:h}=vs();p.useEffect(()=>{if(n){const N=n.variants?n.variants.map(D=>({...D,values:Array.isArray(D.values)?[...D.values]:typeof D.values=="string"?D.values.split(",").map(L=>L.trim()).filter(L=>L):[]})):[],k=Array.isArray(n.images)?[...n.images]:[],j={...n,variants:N,images:k};k.length===0&&n.imageUrl&&(j.images=[n.imageUrl]),d(j)}else d(null)},[n,t]);const f=N=>{const{name:k,value:j,type:D}=N.target;d(L=>({...L,[k]:D==="number"?parseFloat(j)||0:j}))},m=N=>{d(k=>({...k,images:N}))},g=async N=>{if(N.target.files&&N.target.files.length>0){const j=Array.from(N.target.files).map(D=>b1e(D));try{const D=await Promise.all(j);m([...u.images||[],...D])}catch{h({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}},x=N=>{m((u.images||[]).filter((k,j)=>j!==N))},v=async()=>{s&&o!==null&&u&&await s(o,u)},w=async()=>{i&&o!==null&&u&&u.images&&u.images.length>0?await i(o,u):h({title:"Cannot Generate Angles",description:"A main image is required first.",variant:"warning"})},_=(N,k,j)=>{d(D=>{const L=[...D.variants||[]];return L[N]={...L[N],[k]:j},{...D,variants:L}})},C=(N,k,j)=>{d(D=>{const L=[...D.variants||[]],G=[...L[N].values];return G[k]=j,L[N]={...L[N],values:G},{...D,variants:L}})},T=N=>{d(k=>{const j=[...k.variants||[]],D=[...j[N].values,""];return j[N]={...j[N],values:D},{...k,variants:j}})},R=(N,k)=>{d(j=>{const D=[...j.variants||[]],L=D[N].values.filter((G,B)=>B!==k);return D[N]={...D[N],values:L},L.length===0&&h({title:"Info",description:`Variant option "${D[N].name}" has no values.`,variant:"default"}),{...j,variants:D}})},A=()=>{d(N=>({...N,variants:[...N.variants||[],{name:"",values:[""]}]}))},E=N=>{d(k=>({...k,variants:(k.variants||[]).filter((j,D)=>D!==N)}))},I=()=>{if(!u.name||u.name.trim()===""){h({title:"Validation Error",description:"Product name cannot be empty.",variant:"destructive"});return}if(u.price===void 0||u.price===null||isNaN(parseFloat(u.price))||parseFloat(u.price)<0){h({title:"Validation Error",description:"Product price must be a valid non-negative number.",variant:"destructive"});return}const N=u.variants?u.variants.map(k=>({...k,name:k.name.trim(),values:k.values.map(j=>j.trim()).filter(j=>j!=="")})).filter(k=>k.name!==""&&k.values.length>0):[];r({...u,variants:N}),e()};return!t||!u?null:a.jsx(Yr,{open:t,onOpenChange:N=>{N||e()},children:a.jsxs($r,{className:"sm:max-w-2xl",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Edit AI Generated Product"}),a.jsx(Ji,{children:"Modify the details of the generated product below."})]}),a.jsx(Ls,{className:"max-h-[70vh] p-1 pr-3",children:a.jsxs("div",{className:"space-y-4 py-4 pr-2",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"name",children:"Product Name"}),a.jsx(Je,{id:"name",name:"name",value:u.name||"",onChange:f})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"price",children:"Price (USD)"}),a.jsx(Je,{id:"price",name:"price",type:"number",value:u.price||0,onChange:f})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"description",children:"Description"}),a.jsx(En,{id:"description",name:"description",value:u.description||"",onChange:f,rows:4})]}),a.jsxs("div",{className:"space-y-2 border p-3 rounded-md",children:[a.jsx(Re,{className:"text-md font-semibold",children:"Product Images"}),u.images&&u.images.length>0?a.jsx("div",{className:"overflow-x-auto py-2",children:a.jsx("div",{className:"flex flex-row gap-2 mb-2 min-w-max",children:u.images.map((N,k)=>a.jsxs("div",{className:"relative group flex-shrink-0",children:[a.jsx("img",{src:N,alt:`Product image ${k+1}`,className:"w-24 h-24 object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>x(k),children:a.jsx(Fn,{className:"h-3.5 w-3.5"})})]},`${N}-${k}`))})}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No images yet."}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>document.getElementById("editAiProductImageUpload").click(),children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),a.jsx(Je,{id:"editAiProductImageUpload",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:g}),a.jsxs(O,{variant:"outline",size:"sm",onClick:v,disabled:l||!u.name,children:[l?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),u.images&&u.images.length>0?"Regenerate Main":"Generate Main"]}),u.images&&u.images.length>0&&a.jsxs(O,{variant:"outline",size:"sm",onClick:w,disabled:c,children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"More Angles"]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Variants"}),(u.variants||[]).map((N,k)=>a.jsxs(Xe,{className:"p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Re,{htmlFor:`variantName-${k}`,children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>E(k),className:"h-7 w-7",children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})})]}),a.jsx(Je,{id:`variantName-${k}`,value:N.name||"",onChange:j=>_(k,"name",j.target.value),placeholder:"e.g., Color, Size"}),a.jsx(Re,{children:"Option Values"}),N.values.map((j,D)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{value:j||"",onChange:L=>C(k,D,L.target.value),placeholder:"e.g., Red, Large"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>R(k,D),className:"h-7 w-7",children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})})]},D)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>T(k),children:[a.jsx(Li,{className:"mr-2 h-4 w-4"})," Add Value"]})]},k)),a.jsxs(O,{variant:"outline",onClick:A,className:"w-full",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]})}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsx(O,{type:"button",onClick:I,children:"Save Changes"})]})]})})},Vd=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),XL=(t,e)=>{const{formData:n,setFormData:r,handleInputChange:s,handleProductTypeChange:i,handleProductSourceChange:o,handleProductCountChange:l,handleManualProductChange:c,addManualProduct:u,removeManualProduct:d,suggestStoreName:h,generateLogo:f,generateAiProducts:m,generateAiCollections:g,handleGenerateManualProductImage:x,handleGenerateMoreAngles:v,isProcessing:w,isGeneratingProductImageForIndex:_,productImageGenerationError:C,isGeneratingAnglesForIndex:T,angleGenerationError:R,storeNameSuggestions:A,handleSuggestionClick:E,suggestionError:I,handleInitialImportMethodChange:N,handleProductPhotoUpload:k,uploadedProductPhotos:j,removeUploadedProductPhoto:D,isProcessingPhotos:L,handleGenerateCollectionImage:G,isGeneratingCollectionImageForIndex:B,collectionImageGenerationError:W,isCheckingStoreName:X,storeNameAvailability:H,handleManualStoreNameCheck:K}=e,[V,$]=p.useState(""),[z,F]=p.useState(""),[Z,ce]=p.useState(null),[le,he]=p.useState(null),[Le,$e]=p.useState(""),[Be,ue]=p.useState(""),[Ce,Ie]=p.useState([]),[ve,ie]=p.useState([]);p.useState(null);const[Me,He]=p.useState([]),[yt,kt]=p.useState(!1),[en,mn]=p.useState(!1),[cn,fn]=p.useState(""),{toast:Ue}=vs(),[Et,de]=p.useState(!1),[De,ee]=p.useState(null),[ae,Q]=p.useState(null),Pe=(J,te,me)=>{r(q=>{const ne=[...q.products.items],be={...ne[J]};return be.variants=[...be.variants||[]],be.variants[te]={...be.variants[te],name:me},ne[J]=be,{...q,products:{...q.products,items:ne}}})},Ae=(J,te,me,q)=>{r(ne=>{const be=[...ne.products.items],Ne={...be[J]};Ne.variants=[...Ne.variants||[]];const Ge={...Ne.variants[te]};return Ge.values=[...Ge.values||[]],Ge.values[me]=q,Ne.variants[te]=Ge,be[J]=Ne,{...ne,products:{...ne.products,items:be}}})},Ve=(J,te)=>{r(me=>{const q=[...me.products.items],ne={...q[J]};ne.variants=[...ne.variants||[]];const be={...ne.variants[te]};return be.values=[...be.values||[],""],ne.variants[te]=be,q[J]=ne,{...me,products:{...me.products,items:q}}})},qe=(J,te,me)=>{r(q=>{const ne=[...q.products.items],be={...ne[J]};be.variants=[...be.variants||[]];const Ne={...be.variants[te]};return Ne.values=(Ne.values||[]).filter((Ge,Se)=>Se!==me),be.variants[te]=Ne,Ne.values.length===0&&Ue({title:"Info",description:`Variant option "${Ne.name}" has no values. Consider removing the option or adding values.`,variant:"default"}),ne[J]=be,{...q,products:{...q.products,items:ne}}})},oe=J=>{r(te=>{const me=[...te.products.items],q={...me[J]};return q.variants=[...q.variants||[],{name:"",values:[""]}],me[J]=q,{...te,products:{...te.products,items:me}}})},_e=(J,te)=>{r(me=>{const q=[...me.products.items],ne={...q[J]};return ne.variants=(ne.variants||[]).filter((be,Ne)=>Ne!==te),q[J]=ne,{...me,products:{...me.products,items:q}}})},ze=async J=>{const te=J.target.files[0];if(te){fn(""),ce(te);try{const me=await Vd(te);F(me),$(""),Ue({title:"Image Uploaded",description:"Your image is ready for visualization."})}catch(me){console.error("Error converting uploaded file to base64:",me),fn("Failed to load uploaded image. Please try again."),Ue({variant:"destructive",title:"Upload Failed",description:"Could not process the uploaded image."}),F(""),ce(null)}}},Te=()=>{F(""),ce(null),$(""),fn("");const J=document.getElementById("podImageUpload");J&&(J.value="")},Tt=async J=>{const te=J.target.files[0];if(te){fn(""),he(te);try{const me=await Vd(te);$e(me),Ue({title:"Reference Image Added",description:"This image will be used with your prompt for generation."})}catch(me){console.error("Error converting reference file to base64:",me),fn("Failed to load reference image. Please try again."),Ue({variant:"destructive",title:"Reference Image Load Failed",description:"Could not process the reference image."}),$e(""),he(null)}}},wt=()=>{$e(""),he(null),fn("");const J=document.getElementById("podReferenceImageUpload");J&&(J.value="")},xt=async()=>{if(!V){Ue({title:"Missing Prompt",description:"Please enter a prompt for image generation.",variant:"destructive"});return}if(Z){Ue({title:"Image Already Uploaded",description:"An image has already been uploaded. Clear it if you want to generate a new one.",variant:"warning"});return}kt(!0),fn(""),F("");let J={prompt:V};if(le&&Le){const[te,me]=Le.split(","),q=te.match(/:(.*?);/)[1];J.referenceImage={base64Data:me,mimeType:q,fileName:le.name},console.log("Attempting to generate POD image preview with prompt and reference image:",V,le.name)}else console.log("Attempting to generate POD image preview for prompt:",V);try{const te=await Tg(J);if(te.imageData&&te.imageMimeType){const me=`data:${te.imageMimeType};base64,${te.imageData}`;F(me),console.log("POD Image preview generated successfully.")}else throw new Error(te.textResponse||"Image data not returned from API.")}catch(te){console.error("Error generating POD image preview:",te);const me=te.message||"Failed to generate image preview.";fn(me),Ue({variant:"destructive",title:"Image Generation Failed",description:me})}finally{kt(!1)}},pt=J=>{const te=J.target.value;ue(te),Ie(te?Zi.filter(me=>me.name.toLowerCase().includes(te.toLowerCase())):[])},Nt=J=>{ie(te=>te.some(q=>q.name===J.name)?te.filter(q=>q.name!==J.name):[...te,J])},jn=async()=>{if(!z||ve.length===0){Ue({title:"Missing Selections",description:"Please provide an image (generate or upload) and select at least one product type to visualize.",variant:"destructive"});return}let J;if(Z&&Z.name?J=`Uploaded: ${Z.name}`:V?J=V:J="Custom design",!Z&&!V){Ue({title:"Missing Prompt",description:"If not uploading an image, please enter a prompt to generate an image first.",variant:"destructive"});return}mn(!0),fn(""),He([]);const[te,me]=z.split(","),q=te.match(/:(.*?);/)[1];let ne=!0;const be=[];for(const Ne of ve)try{console.log("Attempting to visualize POD product:",Ne.name);const Ge=await Op(me,q,Ne.imageUrl,J,Ne.name);if(Ge.visualizedImageData&&Ge.productDetails){const Se=`data:${Ge.visualizedImageMimeType};base64,${Ge.visualizedImageData}`;be.push({title:Ge.productDetails.title,price:parseFloat(Ge.productDetails.price).toFixed(2),description:Ge.productDetails.description,finalImageUrl:Se,baseProductName:Ne.name,generatedImagePrompt:J,baseProductImageUrl:Ne.imageUrl,sourceImageUsedForVisualization:z,tempId:`${Ne.name}-${Date.now()}`}),console.log("POD Product visualized successfully:",Ne.name)}else ne=!1,console.error("Visualization failed for product:",Ne.name,Ge),fn(Se=>Se+`Visualization failed for ${Ne.name}. `)}catch(Ge){ne=!1,console.error("Error visualizing POD product:",Ne.name,Ge);const Se=Ge.message||`Failed to visualize ${Ne.name}.`;fn(it=>it+Se+" ")}He(be),ne?be.length>0&&Ue({title:"Visualization Complete",description:`${be.length} product(s) visualized. You can now add them to your store.`}):Ue({variant:"destructive",title:"Some Visualizations Failed",description:"Check errors below. Some products may not have visualized correctly."}),mn(!1)},Sn=J=>{if(!J)return;const te={name:J.title,price:J.price,description:J.description,imageUrl:J.finalImageUrl,isPrintOnDemand:!0,podDetails:{...J}};delete te.podDetails.tempId,r(me=>({...me,products:{...me.products,items:[...me.products.items,te]}})),He(me=>me.filter(q=>q.tempId!==J.tempId)),Me.length===1&&Me[0].tempId===J.tempId&&(ie([]),ue("")),Ue({title:"Product Added",description:`"${te.name}" added to your store's products.`})},cr=J=>{r(te=>({...te,products:{...te.products,items:te.products.items.filter((me,q)=>q!==J)}})),Ue({title:"Product Removed",description:"The Print on Demand product has been removed from your list.",variant:"destructive"})},[sn,Vt]=p.useState(!1),[tn,Zn]=p.useState(null),Y=(J,te,me)=>{r(q=>{const ne=[...q.collections.items];return ne[J][te]=me,{...q,collections:{...q.collections,items:ne}}})},re=()=>{r(J=>({...J,collections:{...J.collections,items:[...J.collections.items,{name:"",description:"",imageUrl:""}]}}))},ge=J=>{r(te=>{const me=te.collections.items.filter((q,ne)=>ne!==J);return{...te,collections:{...te.collections,items:me}}})},Oe=J=>{Zn(J),Vt(!0)},tt=(J,te)=>{r(me=>{const q=me.collections.items.map(ne=>ne.id&&ne.id===J||ne.name===J?{...ne,product_ids:te}:ne);return{...me,collections:{...me.collections,items:q}}}),Vt(!1),Zn(null)};switch(t){case 1:return a.jsxs(Pt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"initialImportMethod",className:"text-lg font-semibold",children:"How would you like to start?"}),a.jsxs(pc,{onValueChange:N,value:n.initialImportMethod||"productType",children:[a.jsx(Xa,{id:"initialImportMethod",className:"mt-2",children:a.jsx(gc,{placeholder:"Choose starting method..."})}),a.jsxs(Qa,{children:[a.jsx(Jn,{value:"productType",children:"Describe Product Type"}),a.jsx(Jn,{value:"photos",children:"Start from Product Photos"})]})]})]}),n.initialImportMethod==="productType"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(Re,{htmlFor:"productType",className:"text-md font-medium",children:"What kind of products will your store sell?"}),a.jsx(Je,{id:"productType",name:"productType",value:n.productType,onChange:J=>i(J.target.value),placeholder:"e.g., Fashion, Electronics, Home Decor",list:"productTypeSuggestions"}),a.jsx("datalist",{id:"productTypeSuggestions",children:qw.map(J=>a.jsx("option",{value:J.label},J.value))}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This helps us tailor product suggestions and store design. Type to see suggestions."})]}),n.initialImportMethod==="photos"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(Re,{htmlFor:"productPhotosUpload",className:"text-md font-medium",children:"Upload Product Photos"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload multiple photos of your products. We'll use AI to understand them and pre-fill store details."}),a.jsx(Je,{id:"productPhotosUpload",type:"file",multiple:!0,accept:"image/*",onChange:k,className:`block w-full text-sm text-slate-500
                  file:mr-4 file:py-2 file:px-4
                  file:rounded-full file:border-0
                  file:text-sm file:font-semibold
                  file:bg-primary/10 file:text-primary
                  hover:file:bg-primary/20`,disabled:L}),L&&a.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing uploaded photos..."]}),j&&j.length>0&&a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Uploaded Photos (",j.length,"):"]}),a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3",children:j.map((J,te)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:J.previewUrl||J,alt:`Uploaded product ${te+1}`,className:"w-full aspect-square object-cover rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:()=>D(te),disabled:L,children:a.jsx(Fn,{className:"h-3.5 w-3.5"})})]},te))})]})]})]},"step1");case 2:return a.jsxs(Pt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(Re,{htmlFor:"storeName",className:"text-lg font-semibold",children:"What's your store name?"}),a.jsxs("div",{className:"relative flex items-center gap-2",children:[a.jsx(Je,{id:"storeName",name:"storeName",value:n.storeName,onChange:s,placeholder:"e.g., 'The Cozy Corner Bookstore'",className:"flex-grow pr-20"}),a.jsxs(O,{type:"button",variant:"ghost",size:"sm",onClick:K,disabled:!n.storeName||X,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[X?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(fa,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs(O,{type:"button",variant:"outline",onClick:h,disabled:w||X||!n.productType,className:"w-full mt-2 sm:w-auto sm:mt-0",children:[w&&!X?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Er,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2",children:"Suggest Names"})]}),a.jsxs("div",{className:"h-5 mt-1",children:[" ",X&&n.storeName&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(ft,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),H&&n.storeName&&!X&&a.jsxs("p",{className:`text-sm font-medium ${H.status==="available"?"text-green-600":H.status==="claimed"?"text-red-600":H.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[H.message==="Available"?a.jsx(fa,{className:"inline h-4 w-4 mr-1"}):"",H.message]})]}),!n.storeName&&!X&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:'Choose a catchy name or let us suggest one. Click "Check" to verify availability.'}),I&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),A&&A.length>0&&a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:A.map((J,te)=>a.jsx(O,{variant:"outline",size:"sm",onClick:()=>E(J),className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:J},te))})]})]},"step2");case 3:return a.jsxs(Pt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(Re,{className:"text-lg font-semibold",children:"Design a logo for your store"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center p-4 border rounded-md",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(Re,{className:"text-sm mb-2",children:"For Light Backgrounds"}),n.logoUrlDark?a.jsx("img",{src:n.logoUrlDark,alt:"Logo for light backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-white"}):a.jsx("div",{className:"w-48 h-48 bg-gray-100 rounded-md flex items-center justify-center text-muted-foreground",children:"Light Bg Preview"})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(Re,{className:"text-sm mb-2",children:"For Dark Backgrounds"}),n.logoUrlLight?a.jsx("img",{src:n.logoUrlLight,alt:"Logo for dark backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-gray-800"}):a.jsx("div",{className:"w-48 h-48 bg-gray-700 rounded-md flex items-center justify-center text-gray-400",children:"Dark Bg Preview"})]})]}),a.jsxs(O,{type:"button",onClick:f,disabled:w||!n.storeName,className:"w-full",children:[w?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(wa,{className:"mr-2 h-4 w-4"}),"Generate Logo with AI (Light & Dark Versions)"]}),a.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"AI will generate a logo, remove its background, and attempt to create light/dark mode versions."}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(Re,{className:"text-sm",children:"Manually set logos (optional):"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"logoUrlDarkUpload",className:"text-xs",children:"Logo for Light Background (e.g., black logo)"}),a.jsx(Je,{id:"logoUrlDarkUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async J=>{if(J.target.files&&J.target.files[0]){const te=J.target.files[0];try{const me=await Vd(te);r(q=>({...q,logoUrlDark:me}))}catch(me){console.error("Error converting file for logoUrlDark:",me)}}}})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"logoUrlLightUpload",className:"text-xs",children:"Logo for Dark Background (e.g., white logo)"}),a.jsx(Je,{id:"logoUrlLightUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async J=>{if(J.target.files&&J.target.files[0]){const te=J.target.files[0];try{const me=await Vd(te);r(q=>({...q,logoUrlLight:me}))}catch(me){console.error("Error converting file for logoUrlLight:",me)}}}})]})]})]}),(n.logoUrlLight||n.logoUrlDark)&&a.jsxs(O,{variant:"destructive",size:"sm",onClick:()=>r(J=>({...J,logoUrlLight:"",logoUrlDark:""})),className:"mt-4 w-full",children:[a.jsx(Fn,{className:"mr-2 h-4 w-4"})," Remove All Logos"]})]},"step3");case 4:return a.jsxs(Pt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(Re,{className:"text-lg font-semibold",children:"How do you want to add products?"}),a.jsxs(pc,{onValueChange:o,value:n.products.source,children:[a.jsx(Xa,{children:a.jsx(gc,{placeholder:"Choose product source..."})}),a.jsxs(Qa,{children:[a.jsx(Jn,{value:"ai",children:"Generate with AI"}),a.jsx(Jn,{value:"manual",children:"Add Manually"}),a.jsx(Jn,{value:"printOnDemand",children:"Print on Demand"}),a.jsx(Jn,{value:"csv",disabled:!0,children:"Upload CSV (Coming Soon)"})]})]}),n.products.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"productCount",children:"Number of AI Products to Generate"}),a.jsx(Je,{id:"productCount",type:"number",min:"1",max:"5",value:n.products.count,onChange:l})]}),a.jsxs(O,{type:"button",onClick:m,disabled:w||!n.productType||!n.storeName,className:"w-full",children:[w?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Products with AI"]}),I&&n.products.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),n.products.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[" ",a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Products:"}),n.products.items.map((J,te)=>a.jsxs(Xe,{className:"p-4 flex gap-4 items-start relative",children:[J.images&&J.images.length>0?a.jsx("img",{src:J.images[0],alt:J.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:J.name||"Untitled Product"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["$",J.price||"0.00"]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:J.description||"No description."}),J.variants&&J.variants.length>0&&a.jsx("div",{className:"mt-1.5",children:J.variants.map((me,q)=>a.jsxs("div",{className:"text-xs",children:[a.jsxs("span",{className:"font-medium text-muted-foreground",children:[me.name,": "]}),a.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:Array.isArray(me.values)?me.values.join(", "):me.values})]},q))})]}),a.jsx(O,{variant:"outline",size:"icon",className:"absolute top-2 right-2 h-8 w-8",onClick:()=>{ee({...J}),Q(te),de(!0)},children:a.jsx(Jv,{className:"h-4 w-4"})})]},te))]})]}),Et&&ae!==null&&n.products.items[ae]&&a.jsx(_1e,{isOpen:Et,onClose:()=>{de(!1),Q(null)},product:n.products.items[ae],onSave:J=>{r(te=>{const me=[...te.products.items];return ae!==null&&me[ae]&&(me[ae]=J),{...te,products:{...te.products,items:me}}}),de(!1),ee(null),Q(null),Ue({title:"Product Updated",description:`"${J.name}" has been updated.`})},onGenerateMainImage:x,onGenerateMoreAngles:v,productIndexInWizard:ae,isGeneratingProductImage:_===ae,isGeneratingAngles:T===ae}),n.products.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[" ",n.products.items.map((J,te)=>a.jsxs(Xe,{className:"p-4 space-y-3 relative",children:[a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>d(te),disabled:n.products.items.length<=1,children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productName-${te}`,children:"Product Name"}),a.jsx(Je,{id:`productName-${te}`,value:J.name,onChange:me=>c(te,"name",me.target.value),placeholder:"e.g., 'Handmade Coffee Mug'"})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productPrice-${te}`,children:"Price (USD)"}),a.jsx(Je,{id:`productPrice-${te}`,type:"number",value:J.price,onChange:me=>c(te,"price",me.target.value),placeholder:"e.g., '24.99'"})]})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`productDescription-${te}`,children:"Short Description (Optional)"}),a.jsx(En,{id:`productDescription-${te}`,value:J.description,onChange:me=>c(te,"description",me.target.value),placeholder:"e.g., 'Beautifully crafted ceramic mug, perfect for your morning coffee.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[J.images&&J.images.length>0?a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:J.images.map((me,q)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:me,alt:`${J.name||"Product"} image ${q+1}`,className:"w-20 h-20 object-contain rounded-md border"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{const ne=J.images.filter((be,Ne)=>Ne!==q);c(te,"images",ne)},children:a.jsx(Fn,{className:"h-3 w-3"})})]},q))}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground mb-2",children:"No Images"}),a.jsx(Re,{htmlFor:`productImageUpload-${te}`,className:"text-sm sr-only",children:"Upload Product Images"}),a.jsx(Je,{id:`productImageUpload-${te}`,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:async me=>{if(me.target.files&&me.target.files.length>0){const ne=Array.from(me.target.files).map(be=>Vd(be));try{const be=await Promise.all(ne),Ne=[...J.images||[],...be];c(te,"images",Ne)}catch(be){console.error("Error converting files to base64:",be),Ue({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${te}`).click(),children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),J.images&&J.images.length>0&&a.jsxs(O,{variant:"destructive",size:"sm",onClick:()=>c(te,"images",[]),children:[a.jsx(Fn,{className:"mr-2 h-4 w-4"})," Remove All"]}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>x(te),disabled:_===te||!J.name,children:[_===te?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Main Image"]}),J.images&&J.images.length>0&&a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>v(te),disabled:T===te,children:[T===te?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate More Angles"]})]}),C&&_===te&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:C}),R&&T===te&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:R})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(J.variants||[]).map((me,q)=>a.jsxs(Xe,{className:"p-2 space-y-2 bg-muted/50",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(Re,{htmlFor:`manualVariantName-${te}-${q}`,className:"text-xs",children:"Option Name"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>_e(te,q),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(Je,{id:`manualVariantName-${te}-${q}`,value:me.name||"",onChange:ne=>Pe(te,q,ne.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(Re,{className:"text-xs",children:"Option Values"}),(me.values||[]).map((ne,be)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Je,{value:ne||"",onChange:Ne=>Ae(te,q,be,Ne.target.value),placeholder:"e.g., Red, Large",className:"text-sm h-8"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>qe(te,q,be),className:"h-6 w-6",children:a.jsx(Fn,{className:"h-3 w-3 text-destructive"})})]},be)),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>Ve(te,q),className:"text-xs h-7",children:[a.jsx(Li,{className:"mr-1 h-3 w-3"})," Add Value"]})]},q)),a.jsxs(O,{variant:"outline",onClick:()=>oe(te),className:"w-full text-sm h-8",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},te)),a.jsxs(O,{type:"button",variant:"outline",onClick:()=>{u()},className:"w-full",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"})," Add Another Product"]})]}),n.products.source==="printOnDemand"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-md font-semibold",children:"Configure Print on Demand Product"}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"podImagePrompt",children:"Image Generation Prompt"}),a.jsx(En,{id:"podImagePrompt",placeholder:"e.g., A majestic wolf howling at a vibrant aurora borealis",value:V,onChange:J=>$(J.target.value),rows:2}),a.jsxs(O,{type:"button",onClick:xt,disabled:w||yt||!V||!!Z,className:"mt-2",variant:"outline",children:[yt?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs(O,{type:"button",variant:"outline",className:"mt-2 ml-2",onClick:()=>document.getElementById("podReferenceImageUpload").click(),disabled:w||yt||!!Z,children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Add Ref. Image"]}),a.jsx(Je,{id:"podReferenceImageUpload",type:"file",accept:"image/*",className:"hidden",onChange:Tt})]}),Le&&a.jsxs("div",{className:"mt-2 flex flex-col items-start text-sm",children:[a.jsx(Re,{className:"mb-1",children:"Reference Image:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:Le,alt:"Reference preview",className:"w-16 h-16 object-contain rounded-md border bg-muted"}),a.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:le==null?void 0:le.name}),a.jsx(O,{type:"button",variant:"ghost",size:"icon",onClick:wt,className:"h-7 w-7",children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})})]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx(Re,{htmlFor:"podImageUpload",children:"Or Upload Final Image for Product"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(Je,{id:"podImageUpload",type:"file",accept:"image/*",onChange:ze,className:"flex-grow",disabled:yt}),z&&Z&&a.jsx(O,{type:"button",variant:"ghost",size:"icon",onClick:Te,className:"h-9 w-9",children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"If you upload an image, it will be used instead of the generated one."})]}),cn&&a.jsxs("div",{className:"mt-2 p-2 bg-destructive/10 border border-destructive/50 rounded-md text-destructive text-sm flex items-center gap-2",children:[a.jsx(_g,{className:"h-5 w-5"}),a.jsx("p",{children:cn})]}),z&&a.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[a.jsx(Re,{className:"mb-1",children:"Image Preview:"}),a.jsx("img",{src:z,alt:"Generated preview",className:"w-40 h-40 object-contain rounded-md border bg-muted"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Re,{htmlFor:"podProductSearch",children:"Search Print on Demand Products"}),a.jsx(Je,{id:"podProductSearch",placeholder:"e.g., T-shirt, Mug",value:Be,onChange:pt,disabled:!z}),Ce.length>0&&a.jsx(Xe,{className:"absolute z-10 w-full mt-1 max-h-48 overflow-y-auto border bg-background shadow-lg",children:Ce.map(J=>{const te=ve.some(me=>me.name===J.name);return a.jsxs("div",{className:`p-2 hover:bg-muted cursor-pointer flex items-center gap-2 ${te?"bg-primary/10":""}`,onClick:()=>Nt(J),children:[a.jsx("img",{src:J.imageUrl,alt:J.name,className:"w-8 h-8 object-contain rounded-sm"}),a.jsx("span",{children:J.name}),te&&a.jsx(fa,{className:"h-4 w-4 text-primary ml-auto"})]},J.name)})})]}),ve.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsx(Re,{className:"text-sm mb-1 block",children:"Selected Product Types:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ve.map(J=>a.jsxs(dg,{variant:"secondary",className:"flex items-center gap-1.5 pr-1",children:[J.name,a.jsx(O,{variant:"ghost",size:"icon",className:"h-5 w-5 hover:bg-destructive/20",onClick:()=>Nt(J),children:a.jsx(Wi,{className:"h-3 w-3 text-destructive"})})]},J.name))})]}),a.jsxs(O,{type:"button",onClick:jn,disabled:w||en||!z||ve.length===0,className:"w-full mt-2",children:[en?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(wa,{className:"mr-2 h-4 w-4"}),`Visualize Design on ${ve.length} Product(s)`]}),Me.length>0&&a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsx("h4",{className:"font-semibold text-md",children:"Visualized Products:"}),Me.map(J=>a.jsxs(Xe,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"flex gap-4 items-start",children:[a.jsx("img",{src:J.finalImageUrl,alt:J.title,className:"w-24 h-24 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("p",{className:"font-semibold",children:J.title}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Base: ",J.baseProductName]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Price: $",J.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-3",children:J.description})]})]}),a.jsxs(O,{type:"button",onClick:()=>Sn(J),className:"w-full bg-green-600 hover:bg-green-700",disabled:w,children:[a.jsx(Li,{className:"mr-2 h-4 w-4"}),"Add This Product to Store"]})]},J.tempId))]}),n.products.items.filter(J=>J.isPrintOnDemand).length>0&&a.jsxs("div",{className:"mt-6 space-y-3",children:[a.jsx("p",{className:"text-md font-semibold",children:"Added Print on Demand Products:"}),a.jsxs("div",{className:"max-h-96 overflow-y-auto pr-2 space-y-3",children:[" ",n.products.items.map((J,te)=>J.isPrintOnDemand?a.jsxs(Xe,{className:"p-3 flex gap-3 items-start relative",children:[a.jsx("img",{src:J.imageUrl,alt:J.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-sm",children:J.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",J.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:J.description})]}),a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>cr(te),children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})})]},`pod-item-${te}`):null)]})]})]})]},"step4");case 5:return a.jsxs(Pt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(Re,{className:"text-lg font-semibold",children:"How do you want to add collections?"}),a.jsxs(pc,{onValueChange:J=>r(te=>({...te,collections:{...te.collections,source:J}})),value:n.collections.source,children:[a.jsx(Xa,{children:a.jsx(gc,{placeholder:"Choose collection source..."})}),a.jsxs(Qa,{children:[a.jsx(Jn,{value:"ai",children:"Generate with AI"}),a.jsx(Jn,{value:"manual",children:"Add Manually"})]})]}),I&&n.collections.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),W&&n.collections.source==="manual"&&B===null&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:W}),n.collections.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"collectionCount",children:"Number of AI Collections to Generate"}),a.jsx(Je,{id:"collectionCount",type:"number",min:"1",max:"5",value:n.collections.count,onChange:J=>r(te=>({...te,collections:{...te.collections,count:parseInt(J.target.value)||1}}))})]}),a.jsxs(O,{type:"button",onClick:g,disabled:w||!n.productType||!n.storeName||n.products.items.length===0,className:"w-full",children:[w?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate Collections with AI"]}),n.collections.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Collections:"}),n.collections.items.map((J,te)=>a.jsxs(Xe,{className:"p-4 flex gap-4 items-start",children:[J.imageUrl?a.jsx("img",{src:J.imageUrl,alt:J.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:J.name||"Untitled Collection"}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:J.description||"No description."})]}),a.jsx("div",{className:"flex flex-col gap-1",children:a.jsx(O,{variant:"outline",size:"sm",className:"text-xs h-auto py-1 mt-2",onClick:()=>Oe(J),children:"Manage Products"})})]},te))]}),tn&&a.jsx(w1e,{isOpen:sn,onClose:()=>{Vt(!1),Zn(null)},collection:tn,allProducts:n.products.items,onSave:tt})]}),n.collections.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Your Collections:"}),n.collections.items.map((J,te)=>a.jsxs(Xe,{className:"p-4 space-y-3 relative",children:[a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>ge(te),disabled:n.collections.items.length<=1&&!J.name&&!J.description&&!J.imageUrl,children:a.jsx(Fn,{className:"h-4 w-4 text-destructive"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`collectionName-${te}`,children:"Collection Name"}),a.jsx(Je,{id:`collectionName-${te}`,value:J.name,onChange:me=>Y(te,"name",me.target.value),placeholder:"e.g., 'Summer Collection'"})]})}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`collectionDescription-${te}`,children:"Short Description (Optional)"}),a.jsx(En,{id:`collectionDescription-${te}`,value:J.description,onChange:me=>Y(te,"description",me.target.value),placeholder:"e.g., 'A curated selection of products perfect for the summer season.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[J.imageUrl?a.jsx("img",{src:J.imageUrl,alt:J.name||"Collection image",className:"w-24 h-24 object-contain rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsx(Re,{htmlFor:`collectionImageUpload-${te}`,className:"text-sm sr-only",children:"Upload Collection Image"}),a.jsx(Je,{id:`collectionImageUpload-${te}`,type:"file",accept:"image/*",className:"hidden",onChange:async me=>{if(me.target.files&&me.target.files[0]){const q=me.target.files[0];try{const ne=await Vd(q);Y(te,"imageUrl",ne)}catch(ne){console.error("Error converting file to base64:",ne)}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`collectionImageUpload-${te}`).click(),children:[a.jsx(Lo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsxs(O,{type:"button",variant:"outline",size:"sm",onClick:()=>G(te),disabled:B===te||!J.name,children:[B===te?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate"]}),J.imageUrl&&a.jsxs(O,{variant:"destructive",size:"sm",onClick:()=>Y(te,"imageUrl",""),children:[a.jsx(Fn,{className:"mr-1 h-3 w-3"})," Remove Img"]})]})]}),W&&B===te&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:W})]},te)),a.jsxs(O,{type:"button",variant:"outline",onClick:re,className:"w-full",children:[a.jsx(Li,{className:"mr-2 h-4 w-4"})," Add Another Collection"]})]})]},"step5");case 6:return a.jsxs(Pt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(Re,{htmlFor:"prompt",className:"text-lg font-semibold",children:"Describe your store's overall style and feel"}),a.jsx(En,{id:"prompt",name:"prompt",value:n.prompt,onChange:s,placeholder:"e.g., 'A minimalist and modern design with a focus on high-quality product imagery. Use a cool color palette.' OR 'A vibrant and playful store with bold colors and fun animations.'",className:"min-h-[100px]"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This will influence the theme, layout, and imagery. Your store name, logo, and products are already included. You can also pick from the examples below."}),a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsx(Re,{className:"text-md font-semibold",children:"AI Prompt Examples:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"elegance",displayName:"Elegance",storeName:"Elegant Finds",promptText:"A sophisticated and elegant store experience, focusing on timeless design and high-quality craftsmanship. The aesthetic is refined, with a clean layout and luxurious feel, using a palette of soft neutrals, gold accents, and rich textures."},{key:"futuretech",displayName:"FutureTech",storeName:"Nexus Innovations",promptText:"A cutting-edge, futuristic store specializing in the latest technology and gadgets. The design is sleek, minimalist, and dark-themed with neon blue or cyan accents, interactive elements, and a high-tech vibe."},{key:"greenharvest",displayName:"GreenHarvest",storeName:"Evergreen Market",promptText:"An eco-friendly and organic store focusing on sustainable and natural products. The design should feel earthy, warm, and inviting, using natural materials, green and brown tones, and imagery of nature."},{key:"urbanthreads",displayName:"UrbanThreads",storeName:"Metro Threads Co.",promptText:"A trendy, urban streetwear store with a gritty yet stylish aesthetic. Think industrial-chic, graffiti art influences, bold typography, and a dynamic, energetic feel. Muted colors with pops of vibrant color."}].map(J=>a.jsx(O,{variant:"outline",size:"sm",onClick:()=>{e.setFormData(te=>({...te,storeName:J.storeName,prompt:J.promptText}))},className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:J.displayName},J.key))})]})]},"step6");default:return null}},QL=(t,e,n)=>!!(t===1&&(e.initialImportMethod==="productType"&&!e.productType||e.initialImportMethod==="photos"&&(!n||n.length===0))||t===2&&!e.storeName||t===4&&(e.products.source==="manual"&&e.products.items.some(r=>!r.name||!r.price)||e.products.source==="ai"&&e.products.items.length===0&&e.products.count>0)||t===5&&(e.collections.source==="ai"&&e.collections.items.length===0&&e.collections.count>0||e.collections.source==="manual"&&e.collections.items.some(r=>!r.name))||t===6&&!e.prompt),EH=({isEmbedded:t=!1,onGenerationComplete:e,initialDataFromImport:n=null})=>{const r=vi(),[s,i]=p.useState(1),[o,l]=p.useState([]),[c,u]=p.useState({initialImportMethod:"productType",productType:"",storeName:"",logoUrlLight:"",logoUrlDark:"",products:{source:"ai",count:3,items:[]},collections:{source:"ai",count:3,items:[]},prompt:""}),[d,h]=p.useState([]),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[v,w]=p.useState(null),[_,C]=p.useState(null),[T,R]=p.useState(null),[A,E]=p.useState(null),[I,N]=p.useState(null),[k,j]=p.useState(null),[D,L]=p.useState(null),[G,B]=p.useState(!1),[W,X]=p.useState(null),{generateStoreFromWizard:H,isGenerating:K,checkStoreNameAvailability:V,importedStoreDataForGenerator:$,isImportDataReadyForGenerator:z,clearImportedStoreDataForGenerator:F}=Vn();p.useEffect(()=>{t&&z&&$?(console.log("StoreWizard (Embedded) consuming imported data:",$),u(ee=>({...ee,storeName:$.name||ee.storeName,prompt:$.prompt||ee.prompt,logoUrlLight:$.logoUrl||ee.logoUrlLight,logoUrlDark:$.logoUrl||ee.logoUrlDark,products:$.products&&$.products.length>0?{source:"manual",count:$.products.length,items:$.products.map(ae=>({name:ae.name||"",price:ae.price||"",description:ae.description||"",images:ae.images||[],variants:ae.variants||[]}))}:ee.products,collections:$.collections&&$.collections.length>0?{source:"manual",count:$.collections.length,items:$.collections.map(ae=>({name:ae.name||"",description:ae.description||"",imageUrl:ae.imageUrl||"",product_ids:ae.product_ids||[]}))}:ee.collections})),$.name&&Z($.name),F()):n&&(u(ee=>({...ee,storeName:n.name||ee.storeName,prompt:n.prompt||ee.prompt,logoUrlLight:n.logoUrl||ee.logoUrlLight,logoUrlDark:n.logoUrl||ee.logoUrlDark,products:n.products&&n.products.length>0?{source:"manual",count:n.products.length,items:n.products.map(ae=>({name:ae.name||"",price:ae.price||"",description:ae.description||"",images:ae.images||[],variants:ae.variants||[]}))}:ee.products,collections:n.collections&&n.collections.length>0?{source:"manual",count:n.collections.length,items:n.collections.map(ae=>({name:ae.name||"",description:ae.description||"",imageUrl:ae.imageUrl||"",product_ids:ae.product_ids||[]}))}:ee.collections})),n.name&&Z(n.name))},[t,z,$,F,n]);const Z=async ee=>{if(!(ee||c.storeName)){X({status:"error",message:"Please enter a store name to check."});return}B(!0),X(null),w(null);try{const Q=await zT(c.storeName);X(Q?{status:"claimed",message:"Not available"}:{status:"available",message:"Available"})}catch(Q){console.error("Store name availability check failed:",Q),X({status:"error",message:Q.message||"Could not check store name. Please try again."})}finally{B(!1)}};p.useEffect(()=>{if(c.storeName&&v){const ee=v.toLowerCase();ee.includes("store name")&&(ee.includes("empty")||ee.includes("required"))&&w(null)}if(c.storeName&&s===2){const ee=setTimeout(async()=>{B(!0),X(null),w(null);try{const ae=await zT(c.storeName);X(ae?{status:"claimed",message:"This store name is already taken."}:{status:"available",message:"Store name is available!"})}catch(ae){console.error("Store name availability check failed:",ae),X({status:"error",message:ae.message||"Could not check store name. Please try again."})}finally{B(!1)}},750);return()=>{clearTimeout(ee)}}else!c.storeName&&s===2&&X(null)},[c.storeName,s,v]);const ce=ee=>{u(ae=>({...ae,initialImportMethod:ee,productType:ee==="photos"?"":ae.productType})),ee==="productType"&&h([])},le=ee=>new Promise((ae,Q)=>{const Pe=new FileReader;Pe.onload=()=>ae(Pe.result),Pe.onerror=Q,Pe.readAsDataURL(ee)}),he=async ee=>{const ae=Array.from(ee.target.files);if(ae.length===0)return;const Q=10;if(d.length+ae.length>Q){w(`You can upload a maximum of ${Q} photos.`);return}w(null);const Pe=ae.map(async Ve=>{try{const qe=await le(Ve);return{file:Ve,previewUrl:URL.createObjectURL(Ve),base64:qe,name:Ve.name,type:Ve.type}}catch(qe){return console.error("Error processing file:",Ve.name,qe),null}}),Ae=(await Promise.all(Pe)).filter(Boolean);if(h(Ve=>{const qe=[...Ve,...Ae];return Ve.forEach(oe=>{oe.previewUrl&&oe.previewUrl.startsWith("blob:")}),qe}),c.initialImportMethod==="photos"&&Ae.length>0){m(!0),w(null);try{const Ve=d.concat(Ae).map(oe=>({base64:oe.base64,mimeType:oe.type,name:oe.name})),qe=await NG(Ve);qe.error?w(qe.error):(u(oe=>({...oe,productType:qe.productType||oe.productType,storeName:qe.storeNameSuggestions&&qe.storeNameSuggestions.length>0?qe.storeNameSuggestions[0]:oe.storeName,products:{source:"manual",count:qe.products.length,items:qe.products.map(_e=>({name:_e.name||"",price:_e.price||"",description:_e.description||"",images:_e.images||[],variants:[],isFromPhotoAI:!0}))},collections:{source:"manual",count:qe.collections.length,items:qe.collections.map(_e=>({name:_e.name||"",description:_e.description||"",imageUrl:"",product_ids:[],isFromPhotoAI:!0}))},prompt:qe.storePrompt||oe.prompt})),qe.storeNameSuggestions&&qe.storeNameSuggestions.length>0&&l(qe.storeNameSuggestions),qe.logoDescription&&console.log("AI Logo Description:",qe.logoDescription))}catch(Ve){console.error("Error processing photos with AI:",Ve),w(`Failed to process images with AI: ${Ve.message}`)}finally{m(!1)}}},Le=ee=>{h(ae=>{const Q=ae[ee];return Q&&Q.previewUrl&&Q.previewUrl.startsWith("blob:")&&URL.revokeObjectURL(Q.previewUrl),ae.filter((Pe,Ae)=>Ae!==ee)})},$e=ee=>{const{name:ae,value:Q}=ee.target;u(Pe=>({...Pe,[ae]:Q}))},Be=ee=>{u(ae=>({...ae,productType:ee}))},ue=ee=>{u(ae=>({...ae,products:{...ae.products,source:ee}}))},Ce=ee=>{u(ae=>({...ae,products:{...ae.products,count:parseInt(ee.target.value)||1}}))},Ie=(ee,ae,Q)=>{const Pe=[...c.products.items];Pe[ee][ae]=Q,u(Ae=>({...Ae,products:{...Ae.products,items:Pe}}))},ve=()=>{u(ee=>({...ee,products:{...ee.products,items:[...ee.products.items,{name:"",price:"",description:"",images:[]}]}}))},ie=ee=>{const ae=c.products.items.filter((Q,Pe)=>Pe!==ee);u(Q=>({...Q,products:{...Q.products,items:ae}}))},Me=async()=>{var ee;if(!c.productType){w("Please select a product type first.");return}x(!0),l([]),w(null);try{const ae=((ee=qw.find(Pe=>Pe.value===c.productType))==null?void 0:ee.label)||c.productType,Q=await mI(ae);Q.error?(console.error("Failed to suggest store names:",Q.error),w(Q.error),l([])):Q.suggestions&&Q.suggestions.length>0?l(Q.suggestions):(w("No suggestions received, or response was empty."),l([]))}catch(ae){console.error("Error in suggestStoreNameHandler:",ae),w(`An unexpected error occurred: ${ae.message}`),l([])}x(!1)},He=ee=>{u(ae=>({...ae,storeName:ee})),l([])},yt=async()=>{if(!c.storeName){console.warn("Store name is required to generate a logo."),w("Please ensure a store name is set before generating a logo.");return}x(!0),w(null);try{const ee=await Eg(c.storeName);ee&&(ee.logoUrlLight||ee.logoUrlDark)?(u(ae=>({...ae,logoUrlLight:ee.logoUrlLight||"",logoUrlDark:ee.logoUrlDark||""})),console.log("Logos generated and URLs set:",ee),ee.textResponse&&console.log("Gemini text response for logo generation:",ee.textResponse)):(console.error("Failed to generate logos: No image data received for either version."),w("Failed to generate logo. The AI did not return sufficient image data."))}catch(ee){console.error("Failed to generate logos:",ee),w(`Logo generation failed: ${ee.message}`)}x(!1)},kt=async()=>{if(!c.productType||!c.storeName){w("Please provide a product type and store name before generating AI products.");return}x(!0),w(null);let ee=[];try{const ae=await m1e(c.prompt,c.productType);if(console.log("Prompt Analysis Result:",ae),ae.error||ae.strategy==="error"){w(ae.error||"Failed to analyze store prompt for product strategy."),x(!1);return}let Q=null,Pe="image/png";const Ae=c.logoUrlLight||c.logoUrlDark;if(Ae&&Ae.startsWith("data:")){const Ve=Ae.split(",");if(Ve.length===2){Q=Ve[1];const qe=Ve[0].match(/:(.*?);/);qe&&qe[1]&&(Pe=qe[1])}}if(ae.strategy==="standard"){console.log("Strategy: Standard Product Generation");for(let Ve=0;Ve<c.products.count;Ve++){console.log(`Generating AI product ${Ve+1} of ${c.products.count}...`);const qe=await TG(c.productType,c.storeName,Q,Pe,ee.map(oe=>oe.name),void 0,void 0,void 0,c.prompt);qe&&qe.images&&qe.images.length>0?ee.push({name:qe.title,description:qe.description,price:qe.price,images:qe.images,variants:qe.variants||[]}):console.warn(`Failed to generate full data for standard product ${Ve+1}. Skipping.`)}}else if(ae.strategy==="pod_theme_visualization"||ae.strategy==="pod_specific_products"){console.log(`Strategy: Print on Demand - ${ae.strategy}`);const Ve=ae.theme&&ae.theme!=="General"?`Design for print-on-demand products for a store themed '${ae.theme}'. Store name: ${c.storeName}. User prompt: ${c.prompt}`:`Versatile design for print-on-demand products based on store prompt: "${c.prompt}". Store name: ${c.storeName}.`,qe=6;let oe=[];for(let Te=0;Te<qe;Te++){const Tt=`${Ve} (Design variation ${Te+1} of ${qe}, ensure it's distinct from previous designs for this store if any were made).`;console.log(`Generating POD design ${Te+1}/${qe}...`);const wt=await Tg({prompt:Tt});wt&&wt.imageData?oe.push({base64:wt.imageData,mimeType:wt.imageMimeType||"image/png",prompt:Tt}):console.warn(`Failed to generate POD design ${Te+1}.`)}if(oe.length===0){w("Failed to generate any base designs for POD products."),x(!1);return}let _e=[...Zi],ze=[];for(let Te=0;Te<Math.min(oe.length,_e.length);Te++){const Tt=Math.floor(Math.random()*_e.length);ze.push(_e.splice(Tt,1)[0])}if(ze.length===0){w("No POD mockup products available for visualization."),x(!1);return}for(let Te=0;Te<Math.min(oe.length,ze.length);Te++){const Tt=oe[Te],wt=ze[Te];console.log(`Visualizing design ${Te+1} on ${wt.name}...`);const xt=await Op(Tt.base64,Tt.mimeType,wt.imageUrl,ae.theme||c.prompt,wt.name);if(xt&&xt.visualizedImageData&&xt.productDetails){const pt=`data:${Tt.mimeType};base64,${Tt.base64}`,Nt=`data:${xt.visualizedImageMimeType};base64,${xt.visualizedImageData}`;ee.push({name:xt.productDetails.title,price:parseFloat(xt.productDetails.price).toFixed(2),description:xt.productDetails.description,images:[pt,Nt],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:pt,designPrompt:Tt.prompt,baseProductName:wt.name,baseProductImageUrl:wt.imageUrl},variants:xt.productDetails.variants||[]})}else console.warn(`Failed to visualize design ${Te+1} on ${wt.name}. Skipping.`)}}u(Ve=>({...Ve,products:{...Ve.products,items:ee}})),ee.length===0&&c.products.count>0&&w("AI failed to generate any products with the selected strategy. Please try again or adjust settings.")}catch(ae){console.error("Error generating AI products:",ae),w(`Failed to generate AI products: ${ae.message}`)}x(!1)},en=async()=>{if(!c.productType||!c.storeName||c.products.items.length===0){w("Please ensure product type, store name, and at least one product are set before generating AI collections.");return}x(!0),w(null);const ee=[],ae=c.collections.items.map(Q=>Q.name);try{for(let Q=0;Q<c.collections.count;Q++){console.log(`Generating AI collection ${Q+1} of ${c.collections.count}...`);const Pe=await IG(c.productType,c.storeName,c.products.items,ae);if(Pe&&!Pe.error&&Pe.name&&Pe.description&&Pe.product_ids){let Ae=`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(Pe.name||"Collection")}`;Pe.imageData&&(Ae=`data:image/png;base64,${Pe.imageData}`),ee.push({name:Pe.name,description:Pe.description,imageUrl:Ae,product_ids:Pe.product_ids}),Pe.name&&ae.push(Pe.name)}else console.warn(`Failed to generate full data for collection ${Q+1}. Skipping.`)}u(Q=>({...Q,collections:{...Q.collections,items:ee}})),ee.length===0&&c.collections.count>0&&w("AI failed to generate any collections. Please try again or adjust settings.")}catch(Q){console.error("Error generating AI collections:",Q),w(`Failed to generate AI collections: ${Q.message}`)}x(!1)},mn=async ee=>{const ae=c.products.items[ee];if(!ae||!ae.name){R("Product name is required to generate an image.");return}C(ee),R(null);try{const Q=await HU(ae.name,ae.description);if(Q&&Q.imageData){const Pe=`data:image/png;base64,${Q.imageData}`,Ae=[...c.products.items];Ae[ee].images=[Pe],u(Ve=>({...Ve,products:{...Ve.products,items:Ae}}))}else throw new Error(Q.textResponse||"Failed to generate product image data.")}catch(Q){console.error(`Error generating image for product ${ee}:`,Q),R(Q.message)}finally{C(null)}},cn=async ee=>{const ae=c.products.items[ee];if(!ae||!ae.images||ae.images.length===0){N("At least one image must be uploaded or generated first to create more angles.");return}const Q=ae.images[0];E(ee),N(null);try{const{generateDifferentAnglesFromImage:Pe}=await Ot(()=>Promise.resolve().then(()=>Iae),void 0),Ae=Q.split(",");if(Ae.length!==2)throw new Error("Invalid base image URL format for angle generation.");const Ve=Ae[0],qe=Ae[1],oe=Ve.match(/:(.*?);/);if(!oe||!oe[1])throw new Error("Could not determine mime type from base image URL.");const _e=oe[1],ze=await Pe(qe,_e,ae.name||"Product"),Te=[...c.products.items],Tt=Te[ee].images||[];Te[ee].images=[...Tt,...ze.filter(wt=>!Tt.includes(wt))],u(wt=>({...wt,products:{...wt.products,items:Te}}))}catch(Pe){console.error(`Error generating more angles for product ${ee}:`,Pe),N(Pe.message||"Failed to generate additional angles.")}finally{E(null)}},fn=async ee=>{const ae=c.collections.items[ee];if(!ae||!ae.name){L("Collection name is required to generate an image.");return}j(ee),L(null),w(null);try{const Q=await qU(ae.name,ae.description);if(Q&&Q.imageData&&Q.imageMimeType){const Pe=`data:${Q.imageMimeType};base64,${Q.imageData}`,Ae=[...c.collections.items];Ae[ee].imageUrl=Pe,u(Ve=>({...Ve,collections:{...Ve.collections,items:Ae}}))}else throw new Error(Q.textResponse||"Failed to generate collection image data.")}catch(Q){console.error(`Error generating image for collection ${ee} ("${ae.name}"):`,Q),L(Q.message||"Unknown error during collection image generation.");const Pe=[...c.collections.items];Pe[ee].imageUrl="",u(Ae=>({...Ae,collections:{...Ae.collections,items:Pe}}))}finally{j(null)}},Ue=()=>i(ee=>ee+1),Et=()=>i(ee=>ee-1),de=async()=>{x(!0),w(null);try{const ee={name:c.storeName,niche:c.productType,description:c.prompt},ae=await K$(ee);ae.error&&console.warn("Failed to generate hero content:",ae.error);const Q=await Y$(ee);Q.error&&console.warn("Failed to generate store way content:",Q.error);const Pe=await pI(ee);Pe.error&&console.warn("Failed to generate store features content:",Pe.error);const Ae={...c,content:{...c.content||{},hero:ae&&!ae.error?ae:void 0,storeWay:Q&&!Q.error?Q:void 0,storeFeatures:Pe&&!Pe.error?Pe:void 0}},Ve=await H(Ae);if(Ve){if(t&&e)e(Ve);else if(!t){const qe=`/${Ve.urlSlug||mc(Ve.name)}`;r(qe)}}}catch(ee){console.error("Error during final store generation steps or navigation:",ee),w(`An error occurred during final store setup: ${ee.message}`)}finally{x(!1)}},De={formData:c,setFormData:u,handleInputChange:$e,handleProductTypeChange:Be,handleProductSourceChange:ue,handleProductCountChange:Ce,handleManualProductChange:Ie,addManualProduct:ve,removeManualProduct:ie,suggestStoreName:Me,generateLogo:yt,generateAiProducts:kt,generateAiCollections:en,handleGenerateManualProductImage:mn,handleGenerateMoreAngles:cn,isProcessing:g,isGeneratingProductImageForIndex:_,productImageGenerationError:T,isGeneratingAnglesForIndex:A,angleGenerationError:I,productTypeOptions:qw,storeNameSuggestions:o,handleSuggestionClick:He,suggestionError:v,handleInitialImportMethodChange:ce,handleProductPhotoUpload:he,uploadedProductPhotos:d,removeUploadedProductPhoto:Le,isProcessingPhotos:f,handleGenerateCollectionImage:fn,isGeneratingCollectionImageForIndex:k,collectionImageGenerationError:D,isCheckingStoreName:G,storeNameAvailability:W,handleManualStoreNameCheck:Z};return t?a.jsxs("div",{className:"w-full p-2",children:[" ",a.jsx(_c,{mode:"wait",children:XL(s,De)}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs(O,{variant:"outline",onClick:Et,disabled:s===1||K||f,children:[a.jsx(Vo,{className:"mr-2 h-4 w-4"})," Previous"]}),s<6?a.jsxs(O,{onClick:Ue,disabled:QL(s,c,d)||K||f,children:["Next ",a.jsx(ku,{className:"ml-2 h-4 w-4"})]}):a.jsxs(O,{onClick:de,disabled:g||K||f||!c.prompt,className:"bg-primary hover:bg-primary/90",children:[g||K?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(wa,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]}):a.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[" ",a.jsxs(ct,{children:[a.jsx(ut,{className:"text-2xl font-bold",children:"Store Creation Wizard"}),a.jsxs(Qt,{children:["Step ",s," of 6: Let's build your online store together!"]}),a.jsx("div",{className:"w-full bg-green-200 dark:bg-green-800 rounded-full h-2.5 mt-2",children:a.jsx(Pt.div,{className:"bg-green-600 dark:bg-green-500 h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${s/6*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(at,{className:"min-h-[250px] flex items-center",children:a.jsx(_c,{mode:"wait",children:XL(s,De)})}),a.jsxs(md,{className:"flex justify-between",children:[a.jsxs(O,{variant:"outline",onClick:Et,disabled:s===1||K||f,children:[a.jsx(Vo,{className:"mr-2 h-4 w-4"})," Previous"]}),s<6?a.jsxs(O,{onClick:Ue,disabled:QL(s,c,d)||K||f,children:["Next ",a.jsx(ku,{className:"ml-2 h-4 w-4"})]}):a.jsxs(O,{onClick:de,disabled:g||K||f||!c.prompt,children:[g||K?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(wa,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]})},S1e=({isOpen:t,onClose:e,product:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{var d,h,f,m,g,x,v;if(n){const w=(h=(d=n.variants)==null?void 0:d.edges[0])==null?void 0:h.node;i({...n,name:n.title||"",price:((f=w==null?void 0:w.price)==null?void 0:f.amount)||0,currencyCode:((m=w==null?void 0:w.price)==null?void 0:m.currencyCode)||"USD",imageUrl:((v=(x=(g=n.images)==null?void 0:g.edges[0])==null?void 0:x.node)==null?void 0:v.url)||""})}else i(null)},[n]),!t||!s)return null;const o=d=>{const{name:h,value:f}=d.target;i(m=>({...m,[h]:f}))},l=d=>{const{value:h}=d.target;i(f=>({...f,price:parseFloat(h)||0}))},c=d=>{const{value:h}=d.target;i(f=>({...f,imageUrl:h}))},u=()=>{var h,f,m,g;const d={...s,title:s.name,images:{edges:[{node:{url:s.imageUrl,altText:s.name}}]},variants:{...s.variants,edges:[{node:{...((f=(h=s.variants)==null?void 0:h.edges[0])==null?void 0:f.node)||{},price:{amount:s.price,currencyCode:s.currencyCode}}},...((g=(m=s.variants)==null?void 0:m.edges)==null?void 0:g.slice(1))||[]]}};r(d),e()};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs($r,{className:"sm:max-w-lg",children:[a.jsxs(Ur,{children:[a.jsxs(Br,{children:["Edit Product: ",n.title]}),a.jsx(Ji,{children:"Make changes to the product details below."})]}),a.jsx(Ls,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(Je,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(En,{id:"description",name:"description",value:s.description,onChange:o,className:"col-span-3",rows:4})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"price",className:"text-right",children:"Price"}),a.jsx(Je,{id:"price",name:"price",type:"number",value:s.price,onChange:l,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"imageUrl",className:"text-right",children:"Image URL"}),a.jsx(Je,{id:"imageUrl",name:"imageUrl",value:s.imageUrl,onChange:c,className:"col-span-3"})]})]})}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx(O,{type:"button",onClick:u,children:"Save Changes"})]})]})})},C1e=({isOpen:t,onClose:e,collection:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{i(n?{...n,name:n.title||""}:null)},[n]),!t||!s)return null;const o=c=>{const{name:u,value:d}=c.target;i(h=>({...h,[u]:d}))},l=()=>{const c={...s,title:s.name};r(c),e()};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs($r,{className:"sm:max-w-lg",children:[a.jsxs(Ur,{children:[a.jsxs(Br,{children:["Edit Collection: ",n.title]}),a.jsx(Ji,{children:"Make changes to the collection details below."})]}),a.jsx(Ls,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(Je,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(Re,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(En,{id:"description",name:"description",value:s.description||"",onChange:o,className:"col-span-3",rows:4})]})]})}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx(O,{type:"button",onClick:l,children:"Save Changes"})]})]})})},E1e=()=>{var x,v,w,_,C,T,R,A,E,I,N,k,j,D,L;const{shopifyPreviewMetadata:t,isFetchingShopifyPreviewData:e,shopifyImportError:n,updateShopifyPreviewMetadata:r}=Vn(),[s,i]=p.useState(((w=(v=(x=t==null?void 0:t.brand)==null?void 0:x.colors)==null?void 0:v.primary)==null?void 0:w.background)||"#000000"),[o,l]=p.useState(((T=(C=(_=t==null?void 0:t.brand)==null?void 0:_.colors)==null?void 0:C.secondary)==null?void 0:T.background)||"#ffffff");ht.useEffect(()=>{var G,B,W;(G=t==null?void 0:t.brand)!=null&&G.colors&&(i(((B=t.brand.colors.primary)==null?void 0:B.background)||"#000000"),l(((W=t.brand.colors.secondary)==null?void 0:W.background)||"#ffffff"))},[t]);const c=G=>{var W,X,H;const B=G.target.value;i(B),r&&r({...t,brand:{...t.brand,colors:{...(W=t.brand)==null?void 0:W.colors,primary:{...(H=(X=t.brand)==null?void 0:X.colors)==null?void 0:H.primary,background:B}}}})},u=G=>{var W,X,H;const B=G.target.value;l(B),r&&r({...t,brand:{...t.brand,colors:{...(W=t.brand)==null?void 0:W.colors,secondary:{...(H=(X=t.brand)==null?void 0:X.colors)==null?void 0:H.secondary,background:B}}}})};if(e&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Fetching store information..."})]});if(n&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-destructive",children:[a.jsx(_g,{className:"h-12 w-12 mb-4"}),a.jsx("p",{className:"font-semibold",children:"Error Fetching Store Info"}),a.jsx("p",{className:"text-sm text-center",children:n})]});if(!t)return a.jsx("div",{className:"text-center text-muted-foreground",children:"No store metadata to display."});const{name:d,description:h,primaryDomain:f,brand:m}=t,g=((A=(R=m==null?void 0:m.logo)==null?void 0:R.image)==null?void 0:A.url)||((I=(E=m==null?void 0:m.squareLogo)==null?void 0:E.image)==null?void 0:I.url);return a.jsxs("div",{className:"w-full p-4",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Store Preview"}),a.jsxs(Xe,{className:"mb-4",children:[a.jsx(ct,{children:a.jsxs("div",{className:"flex items-center space-x-4",children:[g?a.jsx("img",{src:g,alt:`${d} logo`,className:"h-16 w-16 object-contain rounded border"}):a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(EE,{size:32})}),a.jsxs("div",{children:[a.jsx(ut,{children:d||"N/A"}),(f==null?void 0:f.host)&&a.jsx(Qt,{children:f.host})]})]})}),a.jsxs(at,{children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Slogan:"})," ",(m==null?void 0:m.slogan)||"N/A"]}),a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Description:"})," ",h||(m==null?void 0:m.shortDescription)||"N/A"]}),((N=m==null?void 0:m.coverImage)==null?void 0:N.url)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Cover Image:"}),a.jsx("img",{src:m.coverImage.url,alt:"Store cover",className:"rounded max-h-40 w-auto mx-auto border"})]})]})]}),(m==null?void 0:m.colors)&&a.jsxs(Xe,{className:"mt-4",children:[a.jsx(ct,{children:a.jsx(ut,{className:"text-lg",children:"Brand Colors"})}),a.jsxs(at,{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"primaryColorPicker",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Primary Color"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"color",id:"primaryColorPicker",value:s,onChange:c,className:"h-10 w-10 rounded border cursor-pointer"}),a.jsx("div",{className:"w-12 h-10 rounded border",style:{backgroundColor:s},title:`Primary Background: ${s}`}),a.jsx("span",{className:"text-sm",children:s})]}),((j=(k=m==null?void 0:m.colors)==null?void 0:k.primary)==null?void 0:j.foreground)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Text/Icon Color (from Shopify):"}),a.jsx("div",{className:"w-full h-6 rounded border mt-1",style:{backgroundColor:m.colors.primary.foreground},title:`Primary Foreground: ${m.colors.primary.foreground}`})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"secondaryColorPicker",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Secondary Color"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"color",id:"secondaryColorPicker",value:o,onChange:u,className:"h-10 w-10 rounded border cursor-pointer"}),a.jsx("div",{className:"w-12 h-10 rounded border",style:{backgroundColor:o},title:`Secondary Background: ${o}`}),a.jsx("span",{className:"text-sm",children:o})]}),((L=(D=m==null?void 0:m.colors)==null?void 0:D.secondary)==null?void 0:L.foreground)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Text/Icon Color (from Shopify):"}),a.jsx("div",{className:"w-full h-6 rounded border mt-1",style:{backgroundColor:m.colors.secondary.foreground},title:`Secondary Foreground: ${m.colors.secondary.foreground}`})]})]})]})]})]})},T1e=()=>{var B,W,X,H,K,V;const{shopifyPreviewProducts:t,shopifyPreviewCollections:e,fetchShopifyWizardProducts:n,fetchShopifyWizardCollections:r,isFetchingShopifyPreviewData:s,shopifyImportError:i,shopifyPreviewMetadata:o,generatedLogoImage:l,isGeneratingLogo:c,logoGenerationError:u,generateShopifyStoreLogo:d,updateShopifyPreviewProduct:h,updateShopifyPreviewCollection:f}=Vn(),[m,g]=p.useState(!1),[x,v]=p.useState(null),[w,_]=p.useState(!1),[C,T]=p.useState(null),R=$=>{v($),g(!0)},A=()=>{g(!1),v(null)},E=$=>{h($)},I=$=>{T($),_(!0)},N=()=>{_(!1),T(null)},k=$=>{f($)},j=()=>{t.pageInfo.hasNextPage&&n(10,t.pageInfo.endCursor)},D=()=>{e.pageInfo.hasNextPage&&r(10,e.pageInfo.endCursor)},L=(o==null?void 0:o.name)||"Your Store",G=((X=(W=(B=o==null?void 0:o.brand)==null?void 0:B.logo)==null?void 0:W.image)==null?void 0:X.url)||((V=(K=(H=o==null?void 0:o.brand)==null?void 0:H.squareLogo)==null?void 0:K.image)==null?void 0:V.url);return a.jsxs("div",{className:"w-full p-4 space-y-6",children:[a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Generate Store Logo"}),a.jsxs(Qt,{children:['Optionally, generate a new logo for "',L,'" using AI. The generated logo will be used for your new store if you proceed.']})]}),a.jsxs(at,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Current Shopify Logo (if any):"}),G?a.jsx("img",{src:G,alt:`${L} current logo`,className:"h-48 w-auto object-contain"}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No logo found in Shopify data."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Generated Logo Preview:"}),c&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary"})," "]}),!c&&l&&a.jsx("div",{className:"h-48 w-auto flex items-center justify-center",children:a.jsx("img",{src:l,alt:`${L} AI generated logo`,className:"h-full w-auto object-contain"})}),!c&&!l&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center text-muted-foreground",children:[a.jsx(EE,{className:"h-12 w-12 mr-2"})," ",a.jsx("span",{children:"Logo will appear here"})]})]})]}),a.jsxs(O,{onClick:d,disabled:c||!(o!=null&&o.name),className:"w-full md:w-auto",children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Generate New Logo with AI"]}),u&&a.jsxs("p",{className:"text-sm text-destructive text-center mt-2",children:[a.jsx(_g,{className:"inline h-4 w-4 mr-1"}),u]}),!(o!=null&&o.name)&&a.jsx("p",{className:"text-sm text-amber-600 text-center mt-2",children:"Store name from Shopify is required to generate a logo."})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Products (",t.edges.length," loaded)"]}),i&&i.includes("products")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(Ls,{className:"h-60 border rounded p-2",children:[t.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No products loaded yet or none found."}),t.edges.map(({node:$})=>{var z,F,Z,ce,le,he,Le,$e,Be;return a.jsx("div",{className:"p-3 border-b last:border-b-0",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[((Z=(F=(z=$.images)==null?void 0:z.edges[0])==null?void 0:F.node)==null?void 0:Z.url)&&a.jsx("img",{src:$.images.edges[0].node.url,alt:$.title,className:"h-16 w-16 rounded object-cover border"}),!((he=(le=(ce=$.images)==null?void 0:ce.edges[0])==null?void 0:le.node)!=null&&he.url)&&a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(EE,{size:24})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm",children:$.title}),((Be=($e=(Le=$.variants)==null?void 0:Le.edges[0])==null?void 0:$e.node)==null?void 0:Be.price)&&a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: ",$.variants.edges[0].node.price.amount," ",$.variants.edges[0].node.price.currencyCode]}),$.description&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1 truncate",title:$.description,children:["Desc: ",$.description.substring(0,50),$.description.length>50?"...":""]}),$.tags&&$.tags.length>0&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Tags: ",$.tags.join(", ")]})]}),a.jsx(O,{variant:"ghost",size:"sm",onClick:()=>R($),className:"ml-auto",children:a.jsx(Jv,{className:"h-4 w-4"})})]})},$.id)}),s&&t.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(ft,{className:"h-5 w-5 animate-spin"})})]}),t.pageInfo.hasNextPage&&a.jsx(O,{onClick:j,disabled:s,className:"mt-2 w-full",children:s?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Products"}),!t.pageInfo.hasNextPage&&t.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All products loaded."})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Collections (",e.edges.length," loaded)"]}),i&&i.includes("collections")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(Ls,{className:"h-60 border rounded p-2",children:[e.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No collections loaded yet or none found."}),e.edges.map(({node:$})=>a.jsxs("div",{className:"p-2 border-b text-sm flex justify-between items-center",children:[a.jsx("span",{children:$.title}),a.jsx(O,{variant:"ghost",size:"sm",onClick:()=>I($),children:a.jsx(Jv,{className:"h-4 w-4"})})]},$.id)),s&&e.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(ft,{className:"h-5 w-5 animate-spin"})})]}),e.pageInfo.hasNextPage&&a.jsx(O,{onClick:D,disabled:s,className:"mt-2 w-full",children:s?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Collections"}),!e.pageInfo.hasNextPage&&e.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All collections loaded."})]})]}),x&&a.jsx(S1e,{isOpen:m,onClose:A,product:x,onSave:E}),C&&a.jsx(C1e,{isOpen:w,onClose:N,collection:C,onSave:k})]})},I1e=()=>{var r,s;const{bigCommercePreviewSettings:t,isFetchingBigCommercePreviewData:e,bigCommerceImportError:n}=Vn();return e&&!t?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching store settings..."})]}):n&&!t?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error: ",n]}):t?a.jsxs(Xe,{className:"w-full",children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Store Settings Preview (BigCommerce)"}),a.jsx(Qt,{children:"Review your BigCommerce store's basic information."})]}),a.jsxs(at,{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Store Name:"})," ",t.storeName||"N/A"]}),((s=(r=t.logo)==null?void 0:r.image)==null?void 0:s.url)&&a.jsxs("div",{children:[a.jsx("strong",{children:"Logo:"}),a.jsx("img",{src:t.logo.image.url,alt:t.logo.image.altText||"Store Logo",className:"mt-2 max-w-xs max-h-24 object-contain border rounded"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Store Hash:"})," ",t.storeHash||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Status:"})," ",t.status||"N/A"]})]})]}):a.jsx("div",{className:"text-center p-4",children:"Connect to BigCommerce to see store settings, or settings are being fetched."})},N1e=()=>{const{bigCommercePreviewProducts:t,fetchBigCommerceWizardProducts:e,isFetchingBigCommercePreviewData:n,bigCommerceImportError:r}=Vn(),s=(t==null?void 0:t.items)||[];return n&&s.length===0?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching products..."})]}):r&&s.length===0?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error fetching products: ",r]}):s.length===0?a.jsxs("div",{className:"text-center p-4",children:[a.jsx("p",{className:"mb-4",children:"No products loaded yet for BigCommerce."}),a.jsxs(O,{onClick:()=>e(10),disabled:n,children:[n?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Load Products Preview"]})]}):a.jsxs(Xe,{className:"w-full",children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Products Preview (BigCommerce)"}),a.jsx(Qt,{children:"A sample of products from your BigCommerce store."})]}),a.jsxs(at,{children:[a.jsx("ul",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.slice(0,10).map(i=>{var o,l,c,u,d;return a.jsxs("li",{className:"p-2 border rounded text-sm flex justify-between items-center",children:[a.jsxs("div",{children:[i.name," - ",(l=(o=i.prices)==null?void 0:o.price)==null?void 0:l.value," ",(u=(c=i.prices)==null?void 0:c.price)==null?void 0:u.currencyCode]}),((d=i.defaultImage)==null?void 0:d.url)&&a.jsx("img",{src:i.defaultImage.url,alt:i.defaultImage.altText||i.name,className:"w-12 h-12 object-cover rounded ml-2"})]},i.entityId)})}),s.length>10&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Showing 10 of ",s.length," products fetched for preview."]})]})]})},P1e=({isOpen:t,onClose:e,initialImportSource:n="shopify"})=>{const r=vi(),[s,i]=p.useState(n),{shopifyWizardStep:o,setShopifyWizardStep:l,resetShopifyWizardState:c,shopifyPreviewMetadata:u,shopifyPreviewProducts:d,shopifyPreviewCollections:h,isFetchingShopifyPreviewData:f,shopifyImportError:m,fetchShopifyWizardProducts:g,fetchShopifyWizardCollections:x,finalizeShopifyImportFromWizard:v,shopifyWizardShouldShowGenerator:w,setShopifyWizardShouldShowGenerator:_,bigCommerceWizardStep:C,setBigCommerceWizardStep:T,resetBigCommerceWizardState:R,bigCommercePreviewSettings:A,bigCommercePreviewProducts:E,isFetchingBigCommercePreviewData:I,bigCommerceImportError:N,fetchBigCommerceWizardProducts:k,finalizeBigCommerceImportFromWizard:j,isGenerating:D,generateStoreFromWizard:L}=Vn(),G={shopify:{wizardStep:o,setWizardStep:l,resetWizardState:c,previewMetadata:u,previewProducts:d,previewCollections:h,isFetchingPreviewData:f,importError:m,fetchWizardProducts:g,fetchWizardCollections:x,finalizeImportFromWizard:v,ConnectFormComponent:a1e,MetadataPreviewComponent:E1e,ItemsPreviewComponent:T1e,wizardShouldShowGenerator:w,setWizardShouldShowGenerator:_,totalSteps:5},bigcommerce:{wizardStep:C,setWizardStep:T,resetWizardState:R,previewMetadata:A,previewProducts:E,isFetchingPreviewData:I,importError:N,fetchWizardProducts:k,finalizeImportFromWizard:j,ConnectFormComponent:l1e,MetadataPreviewComponent:I1e,ItemsPreviewComponent:N1e,totalSteps:4}},B=G[s],{wizardStep:W,setWizardStep:X,resetWizardState:H,previewMetadata:K,previewProducts:V,previewCollections:$,isFetchingPreviewData:z,importError:F,fetchWizardProducts:Z,fetchWizardCollections:ce,finalizeImportFromWizard:le,ConnectFormComponent:he,MetadataPreviewComponent:Le,ItemsPreviewComponent:$e,totalSteps:Be,wizardShouldShowGenerator:ue,setWizardShouldShowGenerator:Ce}=B;if(p.useEffect(()=>{i(n),n==="shopify"&&G.bigcommerce.resetWizardState&&G.bigcommerce.resetWizardState(),n==="bigcommerce"&&G.shopify.resetWizardState&&G.shopify.resetWizardState()},[n,G.bigcommerce,G.shopify]),p.useEffect(()=>{t&&W===0&&X(1),!t&&W!==0&&H()},[t,W,X,H]),!t||W===0)return null;const Ie=async()=>{W<Be&&(s==="shopify"?W===2?((!V||V.edges.length===0)&&await Z(10),(!$||$.edges.length===0)&&await ce(10),X(3)):W===3&&await le():s==="bigcommerce"&&(W===1||(W===2?((!V||V.items.length===0)&&await Z(10),X(3)):W===3&&await Me())))},ve=()=>{W>1&&X(W-1)},ie=()=>{H(),Ce&&Ce(!1),e&&e()},Me=async()=>{await le()&&e&&e()},He=()=>{switch(W){case 1:return a.jsx(he,{open:W===1,onOpenChange:kt=>{kt||ie()},onSuccessfulConnect:kt=>{s==="shopify"&&startShopifyImportWizard(kt.domain,kt.token)}});case 2:return a.jsx(Le,{});case 3:return a.jsx($e,{});case 4:return s==="shopify"&&ue?a.jsx(EH,{isEmbedded:!0,onGenerationComplete:kt=>{if(kt&&(kt.urlSlug||kt.name)){const en=`/${kt.urlSlug||mc(kt.name)}`;r(en)}e&&e(),Ce&&Ce(!1)}}):a.jsx("div",{children:"Loading generator..."});default:return W===Be&&D?a.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin mb-4"})," ",a.jsx("p",{children:"Processing..."})]}):a.jsxs("div",{children:["Invalid Wizard Step or processing... (",W,")"]})}};if(W===1&&s==="shopify")return He();const yt=s==="shopify"?"Import from Shopify":s==="bigcommerce"?"Import from BigCommerce":"Import Store Data";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs(Xe,{className:"w-full max-w-2xl mx-auto shadow-xl",children:[a.jsxs(ct,{children:[a.jsx(ut,{className:"text-2xl font-bold",children:W===1&&s==="bigcommerce"?"Connect to BigCommerce":yt}),a.jsx(Qt,{children:W===1&&s==="bigcommerce"?"Enter your store domain and API token.":W===4&&s==="shopify"?"Configure and generate your new store.":`Step ${W} of ${Be-1}`}),a.jsx("div",{className:"w-full bg-muted rounded-full h-2.5 mt-2",children:a.jsx(Pt.div,{className:"bg-primary h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${W/Be*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(at,{className:"min-h-[250px] max-h-[60vh] overflow-y-auto flex items-center justify-center",children:He()}),a.jsxs(md,{className:"flex justify-between",children:[W>1&&W!==4&&a.jsxs(O,{variant:"outline",onClick:ie,disabled:D||z,children:[a.jsx(ew,{className:"mr-2 h-4 w-4"})," Cancel"]}),W===4&&s==="shopify"&&a.jsxs(O,{variant:"outline",onClick:ie,disabled:D||z,children:[a.jsx(ew,{className:"mr-2 h-4 w-4"})," Cancel Import"]}),a.jsxs("div",{children:[W>1&&W<Be-1&&a.jsxs(O,{variant:"outline",onClick:ve,disabled:D||z,className:"mr-2",children:[a.jsx(Vo,{className:"mr-2 h-4 w-4"})," Previous"]}),W===1&&s==="bigcommerce"&&a.jsxs(O,{onClick:Ie,disabled:D||z,children:["Next ",a.jsx(ku,{className:"ml-2 h-4 w-4"})]}),W===2&&a.jsxs(O,{onClick:Ie,disabled:D||z,children:["Next ",a.jsx(ku,{className:"ml-2 h-4 w-4"})]}),W===3&&a.jsxs(O,{onClick:Ie,disabled:D||z,children:[D?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ku,{className:"ml-2 h-4 w-4"}),"Configure Store"]}),W===Be&&D&&a.jsxs(O,{disabled:!0,children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]})]})]})]})})},A1e=({onSelectSource:t,onClose:e})=>a.jsxs(Xe,{className:"w-full max-w-md mx-auto relative",children:[" ",a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 text-muted-foreground hover:text-foreground",onClick:e,children:a.jsx(Wi,{className:"h-5 w-5"})}),a.jsxs(ct,{children:[a.jsx(ut,{children:"Import Store Data"}),a.jsxs(Qt,{className:"text-slate-500 dark:text-slate-400",children:[" ","Select your e-commerce platform to begin importing your store and product data."]})]}),a.jsx(at,{children:a.jsxs(bi,{defaultValue:"shopify",className:"w-full",children:[a.jsxs(ei,{className:"grid w-full grid-cols-2",children:[a.jsx($t,{value:"shopify",children:"Shopify"}),a.jsx($t,{value:"bigcommerce",children:"BigCommerce"})]}),a.jsxs(Ut,{value:"shopify",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your Shopify store to import your shop details, products, and collections."]}),a.jsx(O,{className:"w-full",onClick:()=>t("shopify"),children:"Connect Shopify"})]}),a.jsxs(Ut,{value:"bigcommerce",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your BigCommerce store to import your store settings and product catalog."]}),a.jsx(O,{className:"w-full",onClick:()=>t("bigcommerce"),children:"Connect BigCommerce"})]})]})}),a.jsx(md,{children:a.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[" ","You will be guided through a few steps to connect and confirm the data to be imported."]})})]}),k1e=({onClose:t})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-8 max-w-sm w-full text-center",children:[a.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800 dark:hover:text-gray-200",children:a.jsx(Wi,{size:24})}),a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Unlimited Stores"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Sign up or log in to create more stores and unlock all features."}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(Xn,{to:"/auth",children:a.jsx(O,{size:"lg",className:"w-full",children:"Sign Up"})}),a.jsx(Xn,{to:"/auth",children:a.jsx(O,{variant:"outline",size:"lg",className:"w-full",children:"Log In"})})]})]})}),R1e=()=>{var w;const t=gl(),[e,n]=p.useState(!1),[r,s]=p.useState(!1),[i,o]=p.useState(null),[l,c]=p.useState("ai-prompt"),[u,d]=p.useState(!1),{isAuthModalOpen:h,closeAuthModal:f}=Vn(),m=()=>{n(!0)},g=()=>{n(!1)},x=_=>{o(_),n(!1),s(!0)},v=()=>{s(!1),o(null)};return p.useEffect(()=>{let _,C;return _=setInterval(()=>{d(!0),C=setTimeout(()=>{d(!1)},2500)},5e3),()=>{clearInterval(_),clearTimeout(C)}},[]),a.jsxs("div",{className:"min-h-screen flex flex-col bg-[#ededed] dark:bg-[#131314]",children:[" ",a.jsx(FA,{}),a.jsxs(Pt.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"flex-1 container mx-auto px-4 py-8",children:[a.jsxs(Pt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-10",children:[a.jsx("h1",{className:`text-4xl md:text-5xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-gray-600 to-gray-200 dark:from-gray-500 dark:to-gray-300 ${u?"animate-shimmer bg-200%":"bg-auto"}`,children:"Start Fresh"}),a.jsxs("p",{className:"text-lg font-inter text-muted-foreground max-w-3xl mx-auto",children:["You can create a store 3 ways: ",a.jsx("br",{})," Prompt, Steps or Import."]})]}),a.jsxs(bi,{value:l,onValueChange:c,className:"w-full max-w-3xl mx-auto mb-12",children:[a.jsxs(ei,{className:"grid w-full grid-cols-2 md:grid-cols-3 mb-6",children:[a.jsxs($t,{value:"ai-prompt",children:[a.jsx("span",{className:"hidden sm:inline",children:"AI Prompt"}),a.jsx("span",{className:"sm:hidden",children:"AI Prompt"})]}),a.jsxs($t,{value:"wizard",children:[a.jsx("span",{className:"hidden sm:inline",children:"Step-by-Step"}),a.jsx("span",{className:"sm:hidden",children:"Steps"})]}),a.jsx($t,{value:"store-import",className:"hidden md:inline-flex",onClick:m,children:"Import Store"})]}),a.jsx(Ut,{value:"ai-prompt",children:a.jsx(zTe,{generatedImage:(w=t.state)==null?void 0:w.generatedImage})}),a.jsx(Ut,{value:"wizard",children:a.jsx(EH,{})}),a.jsxs(Ut,{value:"store-import",className:"text-center py-8",children:[" ",a.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Import data from Shopify or BigCommerce."})," ",a.jsxs(O,{onClick:m,variant:"default",size:"lg",children:[a.jsx(f2,{className:"mr-2 h-5 w-5"}),"Select Import Source"]})]})]}),a.jsxs("div",{className:"mb-8 flex justify-center md:hidden",children:[" ",a.jsxs(O,{onClick:m,variant:"outline",size:"lg",className:"w-full max-w-xs",children:[a.jsx(f2,{className:"mr-2 h-5 w-5"}),"Import Store Data"]})]}),a.jsx(o1e,{})]}),a.jsx("footer",{className:"mt-auto py-6 text-center text-sm text-muted-foreground",children:a.jsxs("p",{children:[" ",new Date().getFullYear()," FreshFront. All rights reserved."]})}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx(A1e,{onSelectSource:x,onClose:g})}),i&&a.jsx(P1e,{isOpen:r,onClose:v,initialImportSource:i}),h&&a.jsx(k1e,{onClose:f})]})};var i_="Popover",[TH,Eje]=wi(i_,[e_]),oy=e_(),[j1e,Kc]=TH(i_),IH=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!1}=t,l=oy(e),c=p.useRef(null),[u,d]=p.useState(!1),[h,f]=Fc({prop:r,defaultProp:s??!1,onChange:i,caller:i_});return a.jsx(z7,{...l,children:a.jsx(j1e,{scope:e,contentId:ic(),triggerRef:c,open:h,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(m=>!m),[f]),hasCustomAnchor:u,onCustomAnchorAdd:p.useCallback(()=>d(!0),[]),onCustomAnchorRemove:p.useCallback(()=>d(!1),[]),modal:o,children:n})})};IH.displayName=i_;var NH="PopoverAnchor",D1e=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Kc(NH,n),i=oy(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=s;return p.useEffect(()=>(o(),()=>l()),[o,l]),a.jsx(PA,{...i,...r,ref:e})});D1e.displayName=NH;var PH="PopoverTrigger",AH=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Kc(PH,n),i=oy(n),o=yn(e,s.triggerRef),l=a.jsx(Yt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":MH(s.open),...r,ref:o,onClick:gt(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:a.jsx(PA,{asChild:!0,...i,children:l})});AH.displayName=PH;var BA="PopoverPortal",[M1e,L1e]=TH(BA,{forceMount:void 0}),kH=t=>{const{__scopePopover:e,forceMount:n,children:r,container:s}=t,i=Kc(BA,e);return a.jsx(M1e,{scope:e,forceMount:n,children:a.jsx(xs,{present:n||i.open,children:a.jsx(wg,{asChild:!0,container:s,children:r})})})};kH.displayName=BA;var mf="PopoverContent",RH=p.forwardRef((t,e)=>{const n=L1e(mf,t.__scopePopover),{forceMount:r=n.forceMount,...s}=t,i=Kc(mf,t.__scopePopover);return a.jsx(xs,{present:r||i.open,children:i.modal?a.jsx(O1e,{...s,ref:e}):a.jsx(V1e,{...s,ref:e})})});RH.displayName=mf;var F1e=Gu("PopoverContent.RemoveScroll"),O1e=p.forwardRef((t,e)=>{const n=Kc(mf,t.__scopePopover),r=p.useRef(null),s=yn(e,r),i=p.useRef(!1);return p.useEffect(()=>{const o=r.current;if(o)return L0(o)},[]),a.jsx(kI,{as:F1e,allowPinchZoom:!0,children:a.jsx(jH,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gt(t.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=n.triggerRef.current)==null||l.focus()}),onPointerDownOutside:gt(t.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:gt(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),V1e=p.forwardRef((t,e)=>{const n=Kc(mf,t.__scopePopover),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(jH,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),jH=p.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...h}=t,f=Kc(mf,n),m=oy(n);return PI(),a.jsx(D0,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(vg,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>f.onOpenChange(!1),children:a.jsx(G7,{"data-state":MH(f.open),role:"dialog",id:f.contentId,...m,...h,ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),DH="PopoverClose",$1e=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Kc(DH,n);return a.jsx(Yt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,()=>s.onOpenChange(!1))})});$1e.displayName=DH;var U1e="PopoverArrow",B1e=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=oy(n);return a.jsx(W7,{...s,...r,ref:e})});B1e.displayName=U1e;function MH(t){return t?"open":"closed"}var z1e=IH,G1e=AH,W1e=kH,LH=RH;const ZL=z1e,eF=G1e,e1=p.forwardRef(({className:t,align:e="center",sideOffset:n=4,...r},s)=>a.jsx(W1e,{children:a.jsx(LH,{ref:s,align:e,sideOffset:n,className:bt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));e1.displayName=LH.displayName;const H1e=({store:t,onEdit:e,currentTemplate:n,onTemplateChange:r,availableTemplates:s=[]})=>{const i=vi(),{toast:o}=vs(),{viewMode:l,setViewMode:c,currentStore:u,updateStore:d,updateStoreTemplateVersion:h,user:f}=Vn(),m=async()=>{if(!f||!f.email){o({title:"Authentication Error",description:"You must be logged in with a valid email to onboard with Stripe.",variant:"destructive"});return}o({title:"Redirecting to Stripe...",description:"Please wait while we connect you to Stripe for onboarding."});try{const R=Hw(),E=await Ja(R,"stripeCreateConnectAccount")({email:f.email}),{accountLinkUrl:I}=E.data;if(I)window.location.href=I;else throw new Error("Account link URL not returned from function.")}catch(R){console.error("Error creating Stripe Connect account link:",R),o({title:"Error",description:"Could not initiate Stripe onboarding. Please try again.",variant:"destructive"})}},g=async()=>{if(!(!u||!u.stripe_account_id)){o({title:"Generating Dashboard Link...",description:"Please wait while we connect you to Stripe."});try{const R=Hw(),E=await Ja(R,"stripeCreateLoginLink")({stripeAccountId:u.stripe_account_id}),{loginLinkUrl:I}=E.data;if(I)window.open(I,"_blank");else throw new Error("Login link URL not returned from function.")}catch(R){console.error("Error creating Stripe login link:",R),o({title:"Error",description:"Could not create a link to the Stripe dashboard. Please try again.",variant:"destructive"})}}},x=()=>{t&&t.name?(navigator.clipboard.writeText(`${window.location.origin}/${t.name}`),o({title:"Link Copied",description:"Store link has been copied to clipboard."})):o({title:"Error",description:"Could not copy link: Store name not available.",variant:"destructive"})},v=()=>{const R=l==="edit"?"published":"edit";c(R),o({title:`Switched to ${R==="published"?"Consumer View":"Admin View"}`,description:`Store is now in ${R==="published"?"consumer":"admin editing"} mode.`})},w=R=>{r&&r(R)},_=async R=>{let A=R;if(R==="classic"&&(A="v1"),t&&t.id&&A&&A!==t.template_version)try{await h(t.id,A),o({title:"Template Saved",description:`Store template successfully changed to ${R}.`,className:"bg-green-500 text-white"})}catch(E){console.error("Failed to save template:",E),o({title:"Save Failed",description:"Could not save the template change. Please try again.",variant:"destructive"})}else A===t.template_version&&o({title:"No Change",description:`Store is already using the ${R} template.`})},C=()=>{l!=="edit"&&c("edit"),e()},T=async()=>{if(t&&t.id)try{await d(t.id,{published_at:new Date().toISOString(),status:"published"}),o({title:"Store Published!",description:`${t.name} is now live.`,className:"bg-green-500 text-white"})}catch(R){console.error("Failed to publish store:",R),o({title:"Publish Failed",description:"Could not publish the store. Please try again.",variant:"destructive"})}};return l==="published"?a.jsx("button",{onClick:()=>c("edit"),className:"fixed bottom-4 left-4 p-2 z-50 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Open Admin Controls","aria-label":"Open Admin Controls",children:a.jsx(Sh,{className:"h-6 w-6 text-gray-500 opacity-50 hover:opacity-75 dark:text-gray-400"})}):a.jsx(Pt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-md border-t z-50 py-3",children:a.jsxs("div",{className:"container mx-auto px-4 flex items-center justify-between overflow-x-auto",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{variant:"outline",size:"icon",className:"aspect-square",onClick:()=>i("/"),title:"Back",children:a.jsx(Vo,{className:"h-4 w-4"})}),a.jsxs("div",{className:"hidden sm:flex items-center gap-1",children:[a.jsxs(pc,{value:n||"",onValueChange:w,children:[a.jsxs(Xa,{className:"w-[180px] h-9 text-sm",children:[a.jsx(Yv,{className:"mr-2 h-4 w-4"}),a.jsx(gc,{placeholder:"Switch Template"})]}),a.jsx(Qa,{children:s.map(R=>a.jsx(Jn,{value:R,children:R.charAt(0).toUpperCase()+R.slice(1)},R))})]}),n&&n!==(t==null?void 0:t.template_version)&&a.jsx(O,{variant:"outline",size:"icon",className:"h-9 w-9 border-green-500 text-green-500 hover:bg-green-50 hover:text-green-600",onClick:()=>_(n),title:`Save ${n.charAt(0).toUpperCase()+n.slice(1)} Template`,children:a.jsx(Sg,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"sm:hidden",children:a.jsxs(ZL,{children:[a.jsx(eF,{asChild:!0,children:a.jsx(O,{variant:"outline",size:"icon",children:a.jsx(Yv,{className:"h-4 w-4"})})}),a.jsx(e1,{className:"w-48",children:a.jsx("div",{className:"grid gap-2",children:s.map(R=>a.jsx(O,{variant:n===R?"solid":"ghost",onClick:()=>w(R),className:"w-full justify-start",children:R.charAt(0).toUpperCase()+R.slice(1)},R))})})]})}),a.jsx(O,{variant:"outline",size:"icon",onClick:x,title:"Copy Link",children:a.jsx(EI,{className:"h-4 w-4"})}),u&&u.stripe_account_id?a.jsxs(O,{variant:"outline",size:"sm",onClick:g,children:[a.jsx("span",{className:"hidden sm:inline",children:"Dashboard"}),a.jsx(Wh,{className:"sm:ml-2 h-4 w-4"})]}):a.jsxs(ZL,{children:[a.jsx(eF,{asChild:!0,children:a.jsxs(O,{variant:"outline",size:"sm",children:[a.jsx("span",{className:"hidden sm:inline",children:"Dashboard"}),a.jsx(Wh,{className:"sm:ml-2 h-4 w-4"})]})}),a.jsx(e1,{className:"w-80",children:a.jsxs("div",{className:"grid gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-medium leading-none",children:"No active business account"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect with Stripe to manage your payments and payouts."})]}),a.jsxs(O,{onClick:m,children:["Onboard with ",a.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/freshfront-c3181.firebasestorage.app/o/Stripelogo.PNG?alt=media&token=7b989f42-b2c9-4a3c-a7e1-9ed280b6a9ea",alt:"Stripe",className:"inline-block h-4 ml-2"})]})]})})]}),a.jsx(O,{asChild:!0,size:"sm",variant:"outline",disabled:!u||!u.name,children:a.jsxs(Xn,{to:u&&u.name?`/${u.name}/content-creation`:"#",state:{storeData:u},children:[a.jsx(Er,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Create"})]})}),a.jsxs(O,{size:"sm",onClick:C,children:[a.jsx(Lp,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs(O,{size:"sm",onClick:v,variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-50 hover:text-green-700",children:[a.jsx(Eie,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Customer"})]}),a.jsxs(O,{size:"sm",onClick:T,className:"bg-green-500 hover:bg-green-600 text-white hidden sm:flex",children:[a.jsx(Lo,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Publish"})]})]})]})})},q1e=({store:t,open:e,onOpenChange:n})=>{var h;vi();const{updateStore:r,isLoadingStores:s}=Vn(),[i,o]=p.useState({name:t.name,description:t.description,type:t.type,theme:{primaryColor:t.theme.primaryColor,secondaryColor:t.theme.secondaryColor,fontFamily:t.theme.fontFamily,layout:t.theme.layout},settings:{showThemeToggle:((h=t.settings)==null?void 0:h.showThemeToggle)??!0}}),l=f=>{const{name:m,value:g}=f.target;o(x=>({...x,[m]:g}))},c=(f,m)=>{o(g=>({...g,theme:{...g.theme,[f]:m}}))},u=(f,m)=>{o(g=>({...g,settings:{...g.settings,[f]:m}}))},d=f=>{f.preventDefault();const m={name:i.name,description:i.description,type:i.type,theme:i.theme,settings:i.settings};r(t.id,m),n(!1)};return a.jsx(Yr,{open:e,onOpenChange:n,children:a.jsxs($r,{className:"sm:max-w-[600px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Edit Store"}),a.jsx(Ji,{children:"Customize your store's details and appearance."})]}),a.jsxs("form",{onSubmit:d,className:"space-y-6 py-4",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"name",children:"Store Name"}),a.jsx(Je,{id:"name",name:"name",value:i.name,onChange:l,required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"description",children:"Description"}),a.jsx(En,{id:"description",name:"description",value:i.description,onChange:l,rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"type",children:"Store Type"}),a.jsxs(pc,{value:i.type,onValueChange:f=>o(m=>({...m,type:f})),children:[a.jsx(Xa,{id:"type",children:a.jsx(gc,{placeholder:"Select store type"})}),a.jsxs(Qa,{children:[a.jsx(Jn,{value:"fashion",children:"Fashion"}),a.jsx(Jn,{value:"electronics",children:"Electronics"}),a.jsx(Jn,{value:"food",children:"Food"}),a.jsx(Jn,{value:"jewelry",children:"Jewelry"}),a.jsx(Jn,{value:"general",children:"General"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Theme Settings"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"primaryColor",children:"Primary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{id:"primaryColor",name:"primaryColor",type:"color",value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(Je,{value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"secondaryColor",children:"Secondary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{id:"secondaryColor",name:"secondaryColor",type:"color",value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(Je,{value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"fontFamily",children:"Font Family"}),a.jsxs(pc,{value:i.theme.fontFamily,onValueChange:f=>c("fontFamily",f),children:[a.jsx(Xa,{id:"fontFamily",children:a.jsx(gc,{placeholder:"Select font"})}),a.jsxs(Qa,{children:[a.jsx(Jn,{value:"Inter",children:"Inter"}),a.jsx(Jn,{value:"Roboto",children:"Roboto"}),a.jsx(Jn,{value:"Poppins",children:"Poppins"}),a.jsx(Jn,{value:"Montserrat",children:"Montserrat"}),a.jsx(Jn,{value:"Open Sans",children:"Open Sans"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"layout",children:"Layout Style"}),a.jsxs(pc,{value:i.theme.layout,onValueChange:f=>c("layout",f),children:[a.jsx(Xa,{id:"layout",children:a.jsx(gc,{placeholder:"Select layout"})}),a.jsxs(Qa,{children:[a.jsx(Jn,{value:"grid",children:"Grid"}),a.jsx(Jn,{value:"list",children:"List"}),a.jsx(Jn,{value:"masonry",children:"Masonry"}),a.jsx(Jn,{value:"carousel",children:"Carousel"})]})]})]}),a.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[a.jsx(Re,{htmlFor:"showThemeToggle",className:"flex items-center",children:"Show Light/Dark Mode Toggle in Store Header"}),a.jsx(jo,{id:"showThemeToggle",checked:i.settings.showThemeToggle,onCheckedChange:f=>u("showThemeToggle",f),disabled:s}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Allows customers to switch between light and dark themes on your store page."})]})]})]})]}),a.jsx(Ar,{children:a.jsx(O,{type:"submit",disabled:s,children:"Save Changes"})})]})]})})};function K1e(t,e){const n=e||{};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const Y1e=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,J1e=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,X1e={};function tF(t,e){return((e||X1e).jsx?J1e:Y1e).test(t)}const Q1e=/[ \t\n\f\r]/g;function Z1e(t){return typeof t=="object"?t.type==="text"?nF(t.value):!1:nF(t)}function nF(t){return t.replace(Q1e,"")===""}class ay{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}ay.prototype.normal={};ay.prototype.property={};ay.prototype.space=void 0;function FH(t,e){const n={},r={};for(const s of t)Object.assign(n,s.property),Object.assign(r,s.normal);return new ay(n,r,e)}function t1(t){return t.toLowerCase()}class _i{constructor(e,n){this.attribute=n,this.property=e}}_i.prototype.attribute="";_i.prototype.booleanish=!1;_i.prototype.boolean=!1;_i.prototype.commaOrSpaceSeparated=!1;_i.prototype.commaSeparated=!1;_i.prototype.defined=!1;_i.prototype.mustUseProperty=!1;_i.prototype.number=!1;_i.prototype.overloadedBoolean=!1;_i.prototype.property="";_i.prototype.spaceSeparated=!1;_i.prototype.space=void 0;let eIe=0;const rn=vd(),Fr=vd(),n1=vd(),et=vd(),Bn=vd(),Dh=vd(),Ni=vd();function vd(){return 2**++eIe}const r1=Object.freeze(Object.defineProperty({__proto__:null,boolean:rn,booleanish:Fr,commaOrSpaceSeparated:Ni,commaSeparated:Dh,number:et,overloadedBoolean:n1,spaceSeparated:Bn},Symbol.toStringTag,{value:"Module"})),eC=Object.keys(r1);class zA extends _i{constructor(e,n,r,s){let i=-1;if(super(e,n),rF(this,"space",s),typeof r=="number")for(;++i<eC.length;){const o=eC[i];rF(this,eC[i],(r&r1[o])===r1[o])}}}zA.prototype.defined=!0;function rF(t,e,n){n&&(t[e]=n)}function Rf(t){const e={},n={};for(const[r,s]of Object.entries(t.properties)){const i=new zA(r,t.transform(t.attributes||{},r),s,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),e[r]=i,n[t1(r)]=r,n[t1(i.attribute)]=r}return new ay(e,n,t.space)}const OH=Rf({properties:{ariaActiveDescendant:null,ariaAtomic:Fr,ariaAutoComplete:null,ariaBusy:Fr,ariaChecked:Fr,ariaColCount:et,ariaColIndex:et,ariaColSpan:et,ariaControls:Bn,ariaCurrent:null,ariaDescribedBy:Bn,ariaDetails:null,ariaDisabled:Fr,ariaDropEffect:Bn,ariaErrorMessage:null,ariaExpanded:Fr,ariaFlowTo:Bn,ariaGrabbed:Fr,ariaHasPopup:null,ariaHidden:Fr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Bn,ariaLevel:et,ariaLive:null,ariaModal:Fr,ariaMultiLine:Fr,ariaMultiSelectable:Fr,ariaOrientation:null,ariaOwns:Bn,ariaPlaceholder:null,ariaPosInSet:et,ariaPressed:Fr,ariaReadOnly:Fr,ariaRelevant:null,ariaRequired:Fr,ariaRoleDescription:Bn,ariaRowCount:et,ariaRowIndex:et,ariaRowSpan:et,ariaSelected:Fr,ariaSetSize:et,ariaSort:null,ariaValueMax:et,ariaValueMin:et,ariaValueNow:et,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function VH(t,e){return e in t?t[e]:e}function $H(t,e){return VH(t,e.toLowerCase())}const tIe=Rf({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:Dh,acceptCharset:Bn,accessKey:Bn,action:null,allow:null,allowFullScreen:rn,allowPaymentRequest:rn,allowUserMedia:rn,alt:null,as:null,async:rn,autoCapitalize:null,autoComplete:Bn,autoFocus:rn,autoPlay:rn,blocking:Bn,capture:null,charSet:null,checked:rn,cite:null,className:Bn,cols:et,colSpan:null,content:null,contentEditable:Fr,controls:rn,controlsList:Bn,coords:et|Dh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:rn,defer:rn,dir:null,dirName:null,disabled:rn,download:n1,draggable:Fr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:rn,formTarget:null,headers:Bn,height:et,hidden:n1,high:et,href:null,hrefLang:null,htmlFor:Bn,httpEquiv:Bn,id:null,imageSizes:null,imageSrcSet:null,inert:rn,inputMode:null,integrity:null,is:null,isMap:rn,itemId:null,itemProp:Bn,itemRef:Bn,itemScope:rn,itemType:Bn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:rn,low:et,manifest:null,max:null,maxLength:et,media:null,method:null,min:null,minLength:et,multiple:rn,muted:rn,name:null,nonce:null,noModule:rn,noValidate:rn,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:rn,optimum:et,pattern:null,ping:Bn,placeholder:null,playsInline:rn,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:rn,referrerPolicy:null,rel:Bn,required:rn,reversed:rn,rows:et,rowSpan:et,sandbox:Bn,scope:null,scoped:rn,seamless:rn,selected:rn,shadowRootClonable:rn,shadowRootDelegatesFocus:rn,shadowRootMode:null,shape:null,size:et,sizes:null,slot:null,span:et,spellCheck:Fr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:et,step:null,style:null,tabIndex:et,target:null,title:null,translate:null,type:null,typeMustMatch:rn,useMap:null,value:Fr,width:et,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Bn,axis:null,background:null,bgColor:null,border:et,borderColor:null,bottomMargin:et,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:rn,declare:rn,event:null,face:null,frame:null,frameBorder:null,hSpace:et,leftMargin:et,link:null,longDesc:null,lowSrc:null,marginHeight:et,marginWidth:et,noResize:rn,noHref:rn,noShade:rn,noWrap:rn,object:null,profile:null,prompt:null,rev:null,rightMargin:et,rules:null,scheme:null,scrolling:Fr,standby:null,summary:null,text:null,topMargin:et,valueType:null,version:null,vAlign:null,vLink:null,vSpace:et,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:rn,disableRemotePlayback:rn,prefix:null,property:null,results:et,security:null,unselectable:null},space:"html",transform:$H}),nIe=Rf({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Ni,accentHeight:et,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:et,amplitude:et,arabicForm:null,ascent:et,attributeName:null,attributeType:null,azimuth:et,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:et,by:null,calcMode:null,capHeight:et,className:Bn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:et,diffuseConstant:et,direction:null,display:null,dur:null,divisor:et,dominantBaseline:null,download:rn,dx:null,dy:null,edgeMode:null,editable:null,elevation:et,enableBackground:null,end:null,event:null,exponent:et,externalResourcesRequired:null,fill:null,fillOpacity:et,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:Dh,g2:Dh,glyphName:Dh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:et,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:et,horizOriginX:et,horizOriginY:et,id:null,ideographic:et,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:et,k:et,k1:et,k2:et,k3:et,k4:et,kernelMatrix:Ni,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:et,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:et,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:et,overlineThickness:et,paintOrder:null,panose1:null,path:null,pathLength:et,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Bn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:et,pointsAtY:et,pointsAtZ:et,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Ni,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Ni,rev:Ni,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Ni,requiredFeatures:Ni,requiredFonts:Ni,requiredFormats:Ni,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:et,specularExponent:et,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:et,strikethroughThickness:et,string:null,stroke:null,strokeDashArray:Ni,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:et,strokeOpacity:et,strokeWidth:null,style:null,surfaceScale:et,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Ni,tabIndex:et,tableValues:null,target:null,targetX:et,targetY:et,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Ni,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:et,underlineThickness:et,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:et,values:null,vAlphabetic:et,vMathematical:et,vectorEffect:null,vHanging:et,vIdeographic:et,version:null,vertAdvY:et,vertOriginX:et,vertOriginY:et,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:et,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:VH}),UH=Rf({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),BH=Rf({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:$H}),zH=Rf({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),rIe={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},sIe=/[A-Z]/g,sF=/-[a-z]/g,iIe=/^data[-\w.:]+$/i;function oIe(t,e){const n=t1(e);let r=e,s=_i;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&iIe.test(e)){if(e.charAt(4)==="-"){const i=e.slice(5).replace(sF,lIe);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=e.slice(4);if(!sF.test(i)){let o=i.replace(sIe,aIe);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}s=zA}return new s(r,e)}function aIe(t){return"-"+t.toLowerCase()}function lIe(t){return t.charAt(1).toUpperCase()}const cIe=FH([OH,tIe,UH,BH,zH],"html"),GA=FH([OH,nIe,UH,BH,zH],"svg");function uIe(t){return t.join(" ").trim()}var WA={},iF=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,dIe=/\n/g,hIe=/^\s*/,fIe=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,mIe=/^:\s*/,pIe=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,gIe=/^[;\s]*/,yIe=/^\s+|\s+$/g,xIe=`
`,oF="/",aF="*",yu="",vIe="comment",wIe="declaration",bIe=function(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var n=1,r=1;function s(g){var x=g.match(dIe);x&&(n+=x.length);var v=g.lastIndexOf(xIe);r=~v?g.length-v:r+g.length}function i(){var g={line:n,column:r};return function(x){return x.position=new o(g),u(),x}}function o(g){this.start=g,this.end={line:n,column:r},this.source=e.source}o.prototype.content=t;function l(g){var x=new Error(e.source+":"+n+":"+r+": "+g);if(x.reason=g,x.filename=e.source,x.line=n,x.column=r,x.source=t,!e.silent)throw x}function c(g){var x=g.exec(t);if(x){var v=x[0];return s(v),t=t.slice(v.length),x}}function u(){c(hIe)}function d(g){var x;for(g=g||[];x=h();)x!==!1&&g.push(x);return g}function h(){var g=i();if(!(oF!=t.charAt(0)||aF!=t.charAt(1))){for(var x=2;yu!=t.charAt(x)&&(aF!=t.charAt(x)||oF!=t.charAt(x+1));)++x;if(x+=2,yu===t.charAt(x-1))return l("End of comment missing");var v=t.slice(2,x-2);return r+=2,s(v),t=t.slice(x),r+=2,g({type:vIe,comment:v})}}function f(){var g=i(),x=c(fIe);if(x){if(h(),!c(mIe))return l("property missing ':'");var v=c(pIe),w=g({type:wIe,property:lF(x[0].replace(iF,yu)),value:v?lF(v[0].replace(iF,yu)):yu});return c(gIe),w}}function m(){var g=[];d(g);for(var x;x=f();)x!==!1&&(g.push(x),d(g));return g}return u(),m()};function lF(t){return t?t.replace(yIe,yu):yu}var _Ie=xv&&xv.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(WA,"__esModule",{value:!0});WA.default=CIe;var SIe=_Ie(bIe);function CIe(t,e){var n=null;if(!t||typeof t!="string")return n;var r=(0,SIe.default)(t),s=typeof e=="function";return r.forEach(function(i){if(i.type==="declaration"){var o=i.property,l=i.value;s?e(o,l,i):l&&(n=n||{},n[o]=l)}}),n}var o_={};Object.defineProperty(o_,"__esModule",{value:!0});o_.camelCase=void 0;var EIe=/^--[a-zA-Z0-9_-]+$/,TIe=/-([a-z])/g,IIe=/^[^-]+$/,NIe=/^-(webkit|moz|ms|o|khtml)-/,PIe=/^-(ms)-/,AIe=function(t){return!t||IIe.test(t)||EIe.test(t)},kIe=function(t,e){return e.toUpperCase()},cF=function(t,e){return"".concat(e,"-")},RIe=function(t,e){return e===void 0&&(e={}),AIe(t)?t:(t=t.toLowerCase(),e.reactCompat?t=t.replace(PIe,cF):t=t.replace(NIe,cF),t.replace(TIe,kIe))};o_.camelCase=RIe;var jIe=xv&&xv.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},DIe=jIe(WA),MIe=o_;function s1(t,e){var n={};return!t||typeof t!="string"||(0,DIe.default)(t,function(r,s){r&&s&&(n[(0,MIe.camelCase)(r,e)]=s)}),n}s1.default=s1;var LIe=s1;const FIe=r0(LIe),GH=WH("end"),HA=WH("start");function WH(t){return e;function e(n){const r=n&&n.position&&n.position[t]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function OIe(t){const e=HA(t),n=GH(t);if(e&&n)return{start:e,end:n}}function hp(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?uF(t.position):"start"in t||"end"in t?uF(t):"line"in t||"column"in t?i1(t):""}function i1(t){return dF(t&&t.line)+":"+dF(t&&t.column)}function uF(t){return i1(t&&t.start)+"-"+i1(t&&t.end)}function dF(t){return t&&typeof t=="number"?t:1}class Os extends Error{constructor(e,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let s="",i={},o=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof e=="string"?s=e:!i.cause&&e&&(o=!0,s=e.message,i.cause=e),!i.ruleId&&!i.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?i.ruleId=r:(i.source=r.slice(0,c),i.ruleId=r.slice(c+1))}if(!i.place&&i.ancestors&&i.ancestors){const c=i.ancestors[i.ancestors.length-1];c&&(i.place=c.position)}const l=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=l?l.line:void 0,this.name=hp(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=o&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}Os.prototype.file="";Os.prototype.name="";Os.prototype.reason="";Os.prototype.message="";Os.prototype.stack="";Os.prototype.column=void 0;Os.prototype.line=void 0;Os.prototype.ancestors=void 0;Os.prototype.cause=void 0;Os.prototype.fatal=void 0;Os.prototype.place=void 0;Os.prototype.ruleId=void 0;Os.prototype.source=void 0;const qA={}.hasOwnProperty,VIe=new Map,$Ie=/[A-Z]/g,UIe=new Set(["table","tbody","thead","tfoot","tr"]),BIe=new Set(["td","th"]),HH="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function zIe(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=XIe(n,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=JIe(n,e.jsx,e.jsxs)}const s={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?GA:cIe,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},i=qH(s,t,void 0);return i&&typeof i!="string"?i:s.create(t,s.Fragment,{children:i||void 0},void 0)}function qH(t,e,n){if(e.type==="element")return GIe(t,e,n);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return WIe(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return qIe(t,e,n);if(e.type==="mdxjsEsm")return HIe(t,e);if(e.type==="root")return KIe(t,e,n);if(e.type==="text")return YIe(t,e)}function GIe(t,e,n){const r=t.schema;let s=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(s=GA,t.schema=s),t.ancestors.push(e);const i=YH(t,e.tagName,!1),o=QIe(t,e);let l=YA(t,e);return UIe.has(e.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!Z1e(c):!0})),KH(t,o,i,e),KA(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function WIe(t,e){if(e.data&&e.data.estree&&t.evaluater){const r=e.data.estree.body[0];return r.type,t.evaluater.evaluateExpression(r.expression)}hg(t,e.position)}function HIe(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);hg(t,e.position)}function qIe(t,e,n){const r=t.schema;let s=r;e.name==="svg"&&r.space==="html"&&(s=GA,t.schema=s),t.ancestors.push(e);const i=e.name===null?t.Fragment:YH(t,e.name,!0),o=ZIe(t,e),l=YA(t,e);return KH(t,o,i,e),KA(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function KIe(t,e,n){const r={};return KA(r,YA(t,e)),t.create(e,t.Fragment,r,n)}function YIe(t,e){return e.value}function KH(t,e,n,r){typeof n!="string"&&n!==t.Fragment&&t.passNode&&(e.node=r)}function KA(t,e){if(e.length>0){const n=e.length>1?e:e[0];n&&(t.children=n)}}function JIe(t,e,n){return r;function r(s,i,o,l){const u=Array.isArray(o.children)?n:e;return l?u(i,o,l):u(i,o)}}function XIe(t,e){return n;function n(r,s,i,o){const l=Array.isArray(i.children),c=HA(r);return e(s,i,o,l,{columnNumber:c?c.column-1:void 0,fileName:t,lineNumber:c?c.line:void 0},void 0)}}function QIe(t,e){const n={};let r,s;for(s in e.properties)if(s!=="children"&&qA.call(e.properties,s)){const i=eNe(t,s,e.properties[s]);if(i){const[o,l]=i;t.tableCellAlignToStyle&&o==="align"&&typeof l=="string"&&BIe.has(e.tagName)?r=l:n[o]=l}}if(r){const i=n.style||(n.style={});i[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function ZIe(t,e){const n={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&t.evaluater){const i=r.data.estree.body[0];i.type;const o=i.expression;o.type;const l=o.properties[0];l.type,Object.assign(n,t.evaluater.evaluateExpression(l.argument))}else hg(t,e.position);else{const s=r.name;let i;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&t.evaluater){const l=r.value.data.estree.body[0];l.type,i=t.evaluater.evaluateExpression(l.expression)}else hg(t,e.position);else i=r.value===null?!0:r.value;n[s]=i}return n}function YA(t,e){const n=[];let r=-1;const s=t.passKeys?new Map:VIe;for(;++r<e.children.length;){const i=e.children[r];let o;if(t.passKeys){const c=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(c){const u=s.get(c)||0;o=c+"-"+u,s.set(c,u+1)}}const l=qH(t,i,o);l!==void 0&&n.push(l)}return n}function eNe(t,e,n){const r=oIe(t.schema,e);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?K1e(n):uIe(n)),r.property==="style"){let s=typeof n=="object"?n:tNe(t,String(n));return t.stylePropertyNameCase==="css"&&(s=nNe(s)),["style",s]}return[t.elementAttributeNameCase==="react"&&r.space?rIe[r.property]||r.property:r.attribute,n]}}function tNe(t,e){try{return FIe(e,{reactCompat:!0})}catch(n){if(t.ignoreInvalidStyle)return{};const r=n,s=new Os("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=t.filePath||void 0,s.url=HH+"#cannot-parse-style-attribute",s}}function YH(t,e,n){let r;if(!n)r={type:"Literal",value:e};else if(e.includes(".")){const s=e.split(".");let i=-1,o;for(;++i<s.length;){const l=tF(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};o=o?{type:"MemberExpression",object:o,property:l,computed:!!(i&&l.type==="Literal"),optional:!1}:l}r=o}else r=tF(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const s=r.value;return qA.call(t.components,s)?t.components[s]:s}if(t.evaluater)return t.evaluater.evaluateExpression(r);hg(t)}function hg(t,e){const n=new Os("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=t.filePath||void 0,n.url=HH+"#cannot-handle-mdx-estrees-without-createevaluater",n}function nNe(t){const e={};let n;for(n in t)qA.call(t,n)&&(e[rNe(n)]=t[n]);return e}function rNe(t){let e=t.replace($Ie,sNe);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function sNe(t){return"-"+t.toLowerCase()}const tC={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},iNe={};function oNe(t,e){const n=e||iNe,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,s=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return JH(t,r,s)}function JH(t,e,n){if(aNe(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return hF(t.children,e,n)}return Array.isArray(t)?hF(t,e,n):""}function hF(t,e,n){const r=[];let s=-1;for(;++s<t.length;)r[s]=JH(t[s],e,n);return r.join("")}function aNe(t){return!!(t&&typeof t=="object")}const fF=document.createElement("i");function JA(t){const e="&"+t+";";fF.innerHTML=e;const n=fF.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function Sa(t,e,n,r){const s=t.length;let i=0,o;if(e<0?e=-e>s?0:s+e:e=e>s?s:e,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(e,n),t.splice(...o);else for(n&&t.splice(e,n);i<r.length;)o=r.slice(i,i+1e4),o.unshift(e,0),t.splice(...o),i+=1e4,e+=1e4}function no(t,e){return t.length>0?(Sa(t,t.length,0,e),t):e}const mF={}.hasOwnProperty;function lNe(t){const e={};let n=-1;for(;++n<t.length;)cNe(e,t[n]);return e}function cNe(t,e){let n;for(n in e){const s=(mF.call(t,n)?t[n]:void 0)||(t[n]={}),i=e[n];let o;if(i)for(o in i){mF.call(s,o)||(s[o]=[]);const l=i[o];uNe(s[o],Array.isArray(l)?l:l?[l]:[])}}}function uNe(t,e){let n=-1;const r=[];for(;++n<e.length;)(e[n].add==="after"?t:r).push(e[n]);Sa(t,0,0,r)}function XH(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"":String.fromCodePoint(n)}function Mh(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const sa=Yc(/[A-Za-z]/),Ui=Yc(/[\dA-Za-z]/),dNe=Yc(/[#-'*+\--9=?A-Z^-~]/);function o1(t){return t!==null&&(t<32||t===127)}const a1=Yc(/\d/),hNe=Yc(/[\dA-Fa-f]/),fNe=Yc(/[!-/:-@[-`{-~]/);function Kt(t){return t!==null&&t<-2}function yi(t){return t!==null&&(t<0||t===32)}function bn(t){return t===-2||t===-1||t===32}const mNe=Yc(/\p{P}|\p{S}/u),pNe=Yc(/\s/);function Yc(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function jf(t){const e=[];let n=-1,r=0,s=0;for(;++n<t.length;){const i=t.charCodeAt(n);let o="";if(i===37&&Ui(t.charCodeAt(n+1))&&Ui(t.charCodeAt(n+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(o=String.fromCharCode(i));else if(i>55295&&i<57344){const l=t.charCodeAt(n+1);i<56320&&l>56319&&l<57344?(o=String.fromCharCode(i,l),s=1):o=""}else o=String.fromCharCode(i);o&&(e.push(t.slice(r,n),encodeURIComponent(o)),r=n+s+1,o=""),s&&(n+=s,s=0)}return e.join("")+t.slice(r)}function Wn(t,e,n,r){const s=r?r-1:Number.POSITIVE_INFINITY;let i=0;return o;function o(c){return bn(c)?(t.enter(n),l(c)):e(c)}function l(c){return bn(c)&&i++<s?(t.consume(c),l):(t.exit(n),e(c))}}const gNe={tokenize:yNe};function yNe(t){const e=t.attempt(this.parser.constructs.contentInitial,r,s);let n;return e;function r(l){if(l===null){t.consume(l);return}return t.enter("lineEnding"),t.consume(l),t.exit("lineEnding"),Wn(t,e,"linePrefix")}function s(l){return t.enter("paragraph"),i(l)}function i(l){const c=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,o(l)}function o(l){if(l===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(l);return}return Kt(l)?(t.consume(l),t.exit("chunkText"),i):(t.consume(l),o)}}const xNe={tokenize:vNe},pF={tokenize:wNe};function vNe(t){const e=this,n=[];let r=0,s,i,o;return l;function l(C){if(r<n.length){const T=n[r];return e.containerState=T[1],t.attempt(T[0].continuation,c,u)(C)}return u(C)}function c(C){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,s&&_();const T=e.events.length;let R=T,A;for(;R--;)if(e.events[R][0]==="exit"&&e.events[R][1].type==="chunkFlow"){A=e.events[R][1].end;break}w(r);let E=T;for(;E<e.events.length;)e.events[E][1].end={...A},E++;return Sa(e.events,R+1,0,e.events.slice(T)),e.events.length=E,u(C)}return l(C)}function u(C){if(r===n.length){if(!s)return f(C);if(s.currentConstruct&&s.currentConstruct.concrete)return g(C);e.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(pF,d,h)(C)}function d(C){return s&&_(),w(r),f(C)}function h(C){return e.parser.lazy[e.now().line]=r!==n.length,o=e.now().offset,g(C)}function f(C){return e.containerState={},t.attempt(pF,m,g)(C)}function m(C){return r++,n.push([e.currentConstruct,e.containerState]),f(C)}function g(C){if(C===null){s&&_(),w(0),t.consume(C);return}return s=s||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),x(C)}function x(C){if(C===null){v(t.exit("chunkFlow"),!0),w(0),t.consume(C);return}return Kt(C)?(t.consume(C),v(t.exit("chunkFlow")),r=0,e.interrupt=void 0,l):(t.consume(C),x)}function v(C,T){const R=e.sliceStream(C);if(T&&R.push(null),C.previous=i,i&&(i.next=C),i=C,s.defineSkip(C.start),s.write(R),e.parser.lazy[C.start.line]){let A=s.events.length;for(;A--;)if(s.events[A][1].start.offset<o&&(!s.events[A][1].end||s.events[A][1].end.offset>o))return;const E=e.events.length;let I=E,N,k;for(;I--;)if(e.events[I][0]==="exit"&&e.events[I][1].type==="chunkFlow"){if(N){k=e.events[I][1].end;break}N=!0}for(w(r),A=E;A<e.events.length;)e.events[A][1].end={...k},A++;Sa(e.events,I+1,0,e.events.slice(E)),e.events.length=A}}function w(C){let T=n.length;for(;T-- >C;){const R=n[T];e.containerState=R[1],R[0].exit.call(e,t)}n.length=C}function _(){s.write([null]),i=void 0,s=void 0,e.containerState._closeFlow=void 0}}function wNe(t,e,n){return Wn(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function gF(t){if(t===null||yi(t)||pNe(t))return 1;if(mNe(t))return 2}function XA(t,e,n){const r=[];let s=-1;for(;++s<t.length;){const i=t[s].resolveAll;i&&!r.includes(i)&&(e=i(e,n),r.push(i))}return e}const l1={name:"attention",resolveAll:bNe,tokenize:_Ne};function bNe(t,e){let n=-1,r,s,i,o,l,c,u,d;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;c=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const h={...t[r][1].end},f={...t[n][1].start};yF(h,-c),yF(f,c),o={type:c>1?"strongSequence":"emphasisSequence",start:h,end:{...t[r][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:f},i={type:c>1?"strongText":"emphasisText",start:{...t[r][1].end},end:{...t[n][1].start}},s={type:c>1?"strong":"emphasis",start:{...o.start},end:{...l.end}},t[r][1].end={...o.start},t[n][1].start={...l.end},u=[],t[r][1].end.offset-t[r][1].start.offset&&(u=no(u,[["enter",t[r][1],e],["exit",t[r][1],e]])),u=no(u,[["enter",s,e],["enter",o,e],["exit",o,e],["enter",i,e]]),u=no(u,XA(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),u=no(u,[["exit",i,e],["enter",l,e],["exit",l,e],["exit",s,e]]),t[n][1].end.offset-t[n][1].start.offset?(d=2,u=no(u,[["enter",t[n][1],e],["exit",t[n][1],e]])):d=0,Sa(t,r-1,n-r+3,u),n=r+u.length-d-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function _Ne(t,e){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,s=gF(r);let i;return o;function o(c){return i=c,t.enter("attentionSequence"),l(c)}function l(c){if(c===i)return t.consume(c),l;const u=t.exit("attentionSequence"),d=gF(c),h=!d||d===2&&s||n.includes(c),f=!s||s===2&&d||n.includes(r);return u._open=!!(i===42?h:h&&(s||!f)),u._close=!!(i===42?f:f&&(d||!h)),e(c)}}function yF(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const SNe={name:"autolink",tokenize:CNe};function CNe(t,e,n){let r=0;return s;function s(m){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),i}function i(m){return sa(m)?(t.consume(m),o):m===64?n(m):u(m)}function o(m){return m===43||m===45||m===46||Ui(m)?(r=1,l(m)):u(m)}function l(m){return m===58?(t.consume(m),r=0,c):(m===43||m===45||m===46||Ui(m))&&r++<32?(t.consume(m),l):(r=0,u(m))}function c(m){return m===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):m===null||m===32||m===60||o1(m)?n(m):(t.consume(m),c)}function u(m){return m===64?(t.consume(m),d):dNe(m)?(t.consume(m),u):n(m)}function d(m){return Ui(m)?h(m):n(m)}function h(m){return m===46?(t.consume(m),r=0,d):m===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):f(m)}function f(m){if((m===45||Ui(m))&&r++<63){const g=m===45?f:h;return t.consume(m),g}return n(m)}}const a_={partial:!0,tokenize:ENe};function ENe(t,e,n){return r;function r(i){return bn(i)?Wn(t,s,"linePrefix")(i):s(i)}function s(i){return i===null||Kt(i)?e(i):n(i)}}const QH={continuation:{tokenize:INe},exit:NNe,name:"blockQuote",tokenize:TNe};function TNe(t,e,n){const r=this;return s;function s(o){if(o===62){const l=r.containerState;return l.open||(t.enter("blockQuote",{_container:!0}),l.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(o),t.exit("blockQuoteMarker"),i}return n(o)}function i(o){return bn(o)?(t.enter("blockQuotePrefixWhitespace"),t.consume(o),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(o))}}function INe(t,e,n){const r=this;return s;function s(o){return bn(o)?Wn(t,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):i(o)}function i(o){return t.attempt(QH,e,n)(o)}}function NNe(t){t.exit("blockQuote")}const ZH={name:"characterEscape",tokenize:PNe};function PNe(t,e,n){return r;function r(i){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(i),t.exit("escapeMarker"),s}function s(i){return fNe(i)?(t.enter("characterEscapeValue"),t.consume(i),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(i)}}const eq={name:"characterReference",tokenize:ANe};function ANe(t,e,n){const r=this;let s=0,i,o;return l;function l(h){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),c}function c(h){return h===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(h),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),i=31,o=Ui,d(h))}function u(h){return h===88||h===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(h),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),i=6,o=hNe,d):(t.enter("characterReferenceValue"),i=7,o=a1,d(h))}function d(h){if(h===59&&s){const f=t.exit("characterReferenceValue");return o===Ui&&!JA(r.sliceSerialize(f))?n(h):(t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return o(h)&&s++<i?(t.consume(h),d):n(h)}}const xF={partial:!0,tokenize:RNe},vF={concrete:!0,name:"codeFenced",tokenize:kNe};function kNe(t,e,n){const r=this,s={partial:!0,tokenize:R};let i=0,o=0,l;return c;function c(A){return u(A)}function u(A){const E=r.events[r.events.length-1];return i=E&&E[1].type==="linePrefix"?E[2].sliceSerialize(E[1],!0).length:0,l=A,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),d(A)}function d(A){return A===l?(o++,t.consume(A),d):o<3?n(A):(t.exit("codeFencedFenceSequence"),bn(A)?Wn(t,h,"whitespace")(A):h(A))}function h(A){return A===null||Kt(A)?(t.exit("codeFencedFence"),r.interrupt?e(A):t.check(xF,x,T)(A)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),f(A))}function f(A){return A===null||Kt(A)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),h(A)):bn(A)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Wn(t,m,"whitespace")(A)):A===96&&A===l?n(A):(t.consume(A),f)}function m(A){return A===null||Kt(A)?h(A):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),g(A))}function g(A){return A===null||Kt(A)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),h(A)):A===96&&A===l?n(A):(t.consume(A),g)}function x(A){return t.attempt(s,T,v)(A)}function v(A){return t.enter("lineEnding"),t.consume(A),t.exit("lineEnding"),w}function w(A){return i>0&&bn(A)?Wn(t,_,"linePrefix",i+1)(A):_(A)}function _(A){return A===null||Kt(A)?t.check(xF,x,T)(A):(t.enter("codeFlowValue"),C(A))}function C(A){return A===null||Kt(A)?(t.exit("codeFlowValue"),_(A)):(t.consume(A),C)}function T(A){return t.exit("codeFenced"),e(A)}function R(A,E,I){let N=0;return k;function k(B){return A.enter("lineEnding"),A.consume(B),A.exit("lineEnding"),j}function j(B){return A.enter("codeFencedFence"),bn(B)?Wn(A,D,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(B):D(B)}function D(B){return B===l?(A.enter("codeFencedFenceSequence"),L(B)):I(B)}function L(B){return B===l?(N++,A.consume(B),L):N>=o?(A.exit("codeFencedFenceSequence"),bn(B)?Wn(A,G,"whitespace")(B):G(B)):I(B)}function G(B){return B===null||Kt(B)?(A.exit("codeFencedFence"),E(B)):I(B)}}}function RNe(t,e,n){const r=this;return s;function s(o){return o===null?n(o):(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}const nC={name:"codeIndented",tokenize:DNe},jNe={partial:!0,tokenize:MNe};function DNe(t,e,n){const r=this;return s;function s(u){return t.enter("codeIndented"),Wn(t,i,"linePrefix",4+1)(u)}function i(u){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?c(u):Kt(u)?t.attempt(jNe,o,c)(u):(t.enter("codeFlowValue"),l(u))}function l(u){return u===null||Kt(u)?(t.exit("codeFlowValue"),o(u)):(t.consume(u),l)}function c(u){return t.exit("codeIndented"),e(u)}}function MNe(t,e,n){const r=this;return s;function s(o){return r.parser.lazy[r.now().line]?n(o):Kt(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s):Wn(t,i,"linePrefix",4+1)(o)}function i(o){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):Kt(o)?s(o):n(o)}}const LNe={name:"codeText",previous:ONe,resolve:FNe,tokenize:VNe};function FNe(t){let e=t.length-4,n=3,r,s;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)s===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(s=r):(r===e||t[r][1].type==="lineEnding")&&(t[s][1].type="codeTextData",r!==s+2&&(t[s][1].end=t[r-1][1].end,t.splice(s+2,r-s-2),e-=r-s-2,r=s+2),s=void 0);return t}function ONe(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function VNe(t,e,n){let r=0,s,i;return o;function o(h){return t.enter("codeText"),t.enter("codeTextSequence"),l(h)}function l(h){return h===96?(t.consume(h),r++,l):(t.exit("codeTextSequence"),c(h))}function c(h){return h===null?n(h):h===32?(t.enter("space"),t.consume(h),t.exit("space"),c):h===96?(i=t.enter("codeTextSequence"),s=0,d(h)):Kt(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),c):(t.enter("codeTextData"),u(h))}function u(h){return h===null||h===32||h===96||Kt(h)?(t.exit("codeTextData"),c(h)):(t.consume(h),u)}function d(h){return h===96?(t.consume(h),s++,d):s===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(h)):(i.type="codeTextData",u(h))}}class $Ne{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,n,r){const s=n||0;this.setCursor(Math.trunc(e));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return r&&cm(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),cm(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),cm(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);cm(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);cm(this.left,n.reverse())}}}function cm(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function tq(t){const e={};let n=-1,r,s,i,o,l,c,u;const d=new $Ne(t);for(;++n<d.length;){for(;n in e;)n=e[n];if(r=d.get(n),n&&r[1].type==="chunkFlow"&&d.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,i=0,i<c.length&&c[i][1].type==="lineEndingBlank"&&(i+=2),i<c.length&&c[i][1].type==="content"))for(;++i<c.length&&c[i][1].type!=="content";)c[i][1].type==="chunkText"&&(c[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,UNe(d,n)),n=e[n],u=!0);else if(r[1]._container){for(i=n,s=void 0;i--;)if(o=d.get(i),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),o[1].type="lineEnding",s=i);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;s&&(r[1].end={...d.get(s)[1].start},l=d.slice(s,n),l.unshift(r),d.splice(s,n-s+1,l))}}return Sa(t,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function UNe(t,e){const n=t.get(e)[1],r=t.get(e)[2];let s=e-1;const i=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const l=o.events,c=[],u={};let d,h,f=-1,m=n,g=0,x=0;const v=[x];for(;m;){for(;t.get(++s)[1]!==m;);i.push(s),m._tokenizer||(d=r.sliceStream(m),m.next||d.push(null),h&&o.defineSkip(m.start),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),h=m,m=m.next}for(m=n;++f<l.length;)l[f][0]==="exit"&&l[f-1][0]==="enter"&&l[f][1].type===l[f-1][1].type&&l[f][1].start.line!==l[f][1].end.line&&(x=f+1,v.push(x),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(o.events=[],m?(m._tokenizer=void 0,m.previous=void 0):v.pop(),f=v.length;f--;){const w=l.slice(v[f],v[f+1]),_=i.pop();c.push([_,_+w.length-1]),t.splice(_,2,w)}for(c.reverse(),f=-1;++f<c.length;)u[g+c[f][0]]=g+c[f][1],g+=c[f][1]-c[f][0]-1;return u}const BNe={resolve:GNe,tokenize:WNe},zNe={partial:!0,tokenize:HNe};function GNe(t){return tq(t),t}function WNe(t,e){let n;return r;function r(l){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),s(l)}function s(l){return l===null?i(l):Kt(l)?t.check(zNe,o,i)(l):(t.consume(l),s)}function i(l){return t.exit("chunkContent"),t.exit("content"),e(l)}function o(l){return t.consume(l),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,s}}function HNe(t,e,n){const r=this;return s;function s(o){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),Wn(t,i,"linePrefix")}function i(o){if(o===null||Kt(o))return n(o);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):t.interrupt(r.parser.constructs.flow,n,e)(o)}}function nq(t,e,n,r,s,i,o,l,c){const u=c||Number.POSITIVE_INFINITY;let d=0;return h;function h(w){return w===60?(t.enter(r),t.enter(s),t.enter(i),t.consume(w),t.exit(i),f):w===null||w===32||w===41||o1(w)?n(w):(t.enter(r),t.enter(o),t.enter(l),t.enter("chunkString",{contentType:"string"}),x(w))}function f(w){return w===62?(t.enter(i),t.consume(w),t.exit(i),t.exit(s),t.exit(r),e):(t.enter(l),t.enter("chunkString",{contentType:"string"}),m(w))}function m(w){return w===62?(t.exit("chunkString"),t.exit(l),f(w)):w===null||w===60||Kt(w)?n(w):(t.consume(w),w===92?g:m)}function g(w){return w===60||w===62||w===92?(t.consume(w),m):m(w)}function x(w){return!d&&(w===null||w===41||yi(w))?(t.exit("chunkString"),t.exit(l),t.exit(o),t.exit(r),e(w)):d<u&&w===40?(t.consume(w),d++,x):w===41?(t.consume(w),d--,x):w===null||w===32||w===40||o1(w)?n(w):(t.consume(w),w===92?v:x)}function v(w){return w===40||w===41||w===92?(t.consume(w),x):x(w)}}function rq(t,e,n,r,s,i){const o=this;let l=0,c;return u;function u(m){return t.enter(r),t.enter(s),t.consume(m),t.exit(s),t.enter(i),d}function d(m){return l>999||m===null||m===91||m===93&&!c||m===94&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?n(m):m===93?(t.exit(i),t.enter(s),t.consume(m),t.exit(s),t.exit(r),e):Kt(m)?(t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),d):(t.enter("chunkString",{contentType:"string"}),h(m))}function h(m){return m===null||m===91||m===93||Kt(m)||l++>999?(t.exit("chunkString"),d(m)):(t.consume(m),c||(c=!bn(m)),m===92?f:h)}function f(m){return m===91||m===92||m===93?(t.consume(m),l++,h):h(m)}}function sq(t,e,n,r,s,i){let o;return l;function l(f){return f===34||f===39||f===40?(t.enter(r),t.enter(s),t.consume(f),t.exit(s),o=f===40?41:f,c):n(f)}function c(f){return f===o?(t.enter(s),t.consume(f),t.exit(s),t.exit(r),e):(t.enter(i),u(f))}function u(f){return f===o?(t.exit(i),c(o)):f===null?n(f):Kt(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),Wn(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===o||f===null||Kt(f)?(t.exit("chunkString"),u(f)):(t.consume(f),f===92?h:d)}function h(f){return f===o||f===92?(t.consume(f),d):d(f)}}function fp(t,e){let n;return r;function r(s){return Kt(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),n=!0,r):bn(s)?Wn(t,r,n?"linePrefix":"lineSuffix")(s):e(s)}}const qNe={name:"definition",tokenize:YNe},KNe={partial:!0,tokenize:JNe};function YNe(t,e,n){const r=this;let s;return i;function i(m){return t.enter("definition"),o(m)}function o(m){return rq.call(r,t,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function l(m){return s=Mh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),m===58?(t.enter("definitionMarker"),t.consume(m),t.exit("definitionMarker"),c):n(m)}function c(m){return yi(m)?fp(t,u)(m):u(m)}function u(m){return nq(t,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function d(m){return t.attempt(KNe,h,h)(m)}function h(m){return bn(m)?Wn(t,f,"whitespace")(m):f(m)}function f(m){return m===null||Kt(m)?(t.exit("definition"),r.parser.defined.push(s),e(m)):n(m)}}function JNe(t,e,n){return r;function r(l){return yi(l)?fp(t,s)(l):n(l)}function s(l){return sq(t,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function i(l){return bn(l)?Wn(t,o,"whitespace")(l):o(l)}function o(l){return l===null||Kt(l)?e(l):n(l)}}const XNe={name:"hardBreakEscape",tokenize:QNe};function QNe(t,e,n){return r;function r(i){return t.enter("hardBreakEscape"),t.consume(i),s}function s(i){return Kt(i)?(t.exit("hardBreakEscape"),e(i)):n(i)}}const ZNe={name:"headingAtx",resolve:ePe,tokenize:tPe};function ePe(t,e){let n=t.length-2,r=3,s,i;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(s={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},i={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},Sa(t,r,n-r+1,[["enter",s,e],["enter",i,e],["exit",i,e],["exit",s,e]])),t}function tPe(t,e,n){let r=0;return s;function s(d){return t.enter("atxHeading"),i(d)}function i(d){return t.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&r++<6?(t.consume(d),o):d===null||yi(d)?(t.exit("atxHeadingSequence"),l(d)):n(d)}function l(d){return d===35?(t.enter("atxHeadingSequence"),c(d)):d===null||Kt(d)?(t.exit("atxHeading"),e(d)):bn(d)?Wn(t,l,"whitespace")(d):(t.enter("atxHeadingText"),u(d))}function c(d){return d===35?(t.consume(d),c):(t.exit("atxHeadingSequence"),l(d))}function u(d){return d===null||d===35||yi(d)?(t.exit("atxHeadingText"),l(d)):(t.consume(d),u)}}const nPe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],wF=["pre","script","style","textarea"],rPe={concrete:!0,name:"htmlFlow",resolveTo:oPe,tokenize:aPe},sPe={partial:!0,tokenize:cPe},iPe={partial:!0,tokenize:lPe};function oPe(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function aPe(t,e,n){const r=this;let s,i,o,l,c;return u;function u(F){return d(F)}function d(F){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(F),h}function h(F){return F===33?(t.consume(F),f):F===47?(t.consume(F),i=!0,x):F===63?(t.consume(F),s=3,r.interrupt?e:V):sa(F)?(t.consume(F),o=String.fromCharCode(F),v):n(F)}function f(F){return F===45?(t.consume(F),s=2,m):F===91?(t.consume(F),s=5,l=0,g):sa(F)?(t.consume(F),s=4,r.interrupt?e:V):n(F)}function m(F){return F===45?(t.consume(F),r.interrupt?e:V):n(F)}function g(F){const Z="CDATA[";return F===Z.charCodeAt(l++)?(t.consume(F),l===Z.length?r.interrupt?e:D:g):n(F)}function x(F){return sa(F)?(t.consume(F),o=String.fromCharCode(F),v):n(F)}function v(F){if(F===null||F===47||F===62||yi(F)){const Z=F===47,ce=o.toLowerCase();return!Z&&!i&&wF.includes(ce)?(s=1,r.interrupt?e(F):D(F)):nPe.includes(o.toLowerCase())?(s=6,Z?(t.consume(F),w):r.interrupt?e(F):D(F)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(F):i?_(F):C(F))}return F===45||Ui(F)?(t.consume(F),o+=String.fromCharCode(F),v):n(F)}function w(F){return F===62?(t.consume(F),r.interrupt?e:D):n(F)}function _(F){return bn(F)?(t.consume(F),_):k(F)}function C(F){return F===47?(t.consume(F),k):F===58||F===95||sa(F)?(t.consume(F),T):bn(F)?(t.consume(F),C):k(F)}function T(F){return F===45||F===46||F===58||F===95||Ui(F)?(t.consume(F),T):R(F)}function R(F){return F===61?(t.consume(F),A):bn(F)?(t.consume(F),R):C(F)}function A(F){return F===null||F===60||F===61||F===62||F===96?n(F):F===34||F===39?(t.consume(F),c=F,E):bn(F)?(t.consume(F),A):I(F)}function E(F){return F===c?(t.consume(F),c=null,N):F===null||Kt(F)?n(F):(t.consume(F),E)}function I(F){return F===null||F===34||F===39||F===47||F===60||F===61||F===62||F===96||yi(F)?R(F):(t.consume(F),I)}function N(F){return F===47||F===62||bn(F)?C(F):n(F)}function k(F){return F===62?(t.consume(F),j):n(F)}function j(F){return F===null||Kt(F)?D(F):bn(F)?(t.consume(F),j):n(F)}function D(F){return F===45&&s===2?(t.consume(F),W):F===60&&s===1?(t.consume(F),X):F===62&&s===4?(t.consume(F),$):F===63&&s===3?(t.consume(F),V):F===93&&s===5?(t.consume(F),K):Kt(F)&&(s===6||s===7)?(t.exit("htmlFlowData"),t.check(sPe,z,L)(F)):F===null||Kt(F)?(t.exit("htmlFlowData"),L(F)):(t.consume(F),D)}function L(F){return t.check(iPe,G,z)(F)}function G(F){return t.enter("lineEnding"),t.consume(F),t.exit("lineEnding"),B}function B(F){return F===null||Kt(F)?L(F):(t.enter("htmlFlowData"),D(F))}function W(F){return F===45?(t.consume(F),V):D(F)}function X(F){return F===47?(t.consume(F),o="",H):D(F)}function H(F){if(F===62){const Z=o.toLowerCase();return wF.includes(Z)?(t.consume(F),$):D(F)}return sa(F)&&o.length<8?(t.consume(F),o+=String.fromCharCode(F),H):D(F)}function K(F){return F===93?(t.consume(F),V):D(F)}function V(F){return F===62?(t.consume(F),$):F===45&&s===2?(t.consume(F),V):D(F)}function $(F){return F===null||Kt(F)?(t.exit("htmlFlowData"),z(F)):(t.consume(F),$)}function z(F){return t.exit("htmlFlow"),e(F)}}function lPe(t,e,n){const r=this;return s;function s(o){return Kt(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i):n(o)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}function cPe(t,e,n){return r;function r(s){return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),t.attempt(a_,e,n)}}const uPe={name:"htmlText",tokenize:dPe};function dPe(t,e,n){const r=this;let s,i,o;return l;function l(V){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(V),c}function c(V){return V===33?(t.consume(V),u):V===47?(t.consume(V),R):V===63?(t.consume(V),C):sa(V)?(t.consume(V),I):n(V)}function u(V){return V===45?(t.consume(V),d):V===91?(t.consume(V),i=0,g):sa(V)?(t.consume(V),_):n(V)}function d(V){return V===45?(t.consume(V),m):n(V)}function h(V){return V===null?n(V):V===45?(t.consume(V),f):Kt(V)?(o=h,X(V)):(t.consume(V),h)}function f(V){return V===45?(t.consume(V),m):h(V)}function m(V){return V===62?W(V):V===45?f(V):h(V)}function g(V){const $="CDATA[";return V===$.charCodeAt(i++)?(t.consume(V),i===$.length?x:g):n(V)}function x(V){return V===null?n(V):V===93?(t.consume(V),v):Kt(V)?(o=x,X(V)):(t.consume(V),x)}function v(V){return V===93?(t.consume(V),w):x(V)}function w(V){return V===62?W(V):V===93?(t.consume(V),w):x(V)}function _(V){return V===null||V===62?W(V):Kt(V)?(o=_,X(V)):(t.consume(V),_)}function C(V){return V===null?n(V):V===63?(t.consume(V),T):Kt(V)?(o=C,X(V)):(t.consume(V),C)}function T(V){return V===62?W(V):C(V)}function R(V){return sa(V)?(t.consume(V),A):n(V)}function A(V){return V===45||Ui(V)?(t.consume(V),A):E(V)}function E(V){return Kt(V)?(o=E,X(V)):bn(V)?(t.consume(V),E):W(V)}function I(V){return V===45||Ui(V)?(t.consume(V),I):V===47||V===62||yi(V)?N(V):n(V)}function N(V){return V===47?(t.consume(V),W):V===58||V===95||sa(V)?(t.consume(V),k):Kt(V)?(o=N,X(V)):bn(V)?(t.consume(V),N):W(V)}function k(V){return V===45||V===46||V===58||V===95||Ui(V)?(t.consume(V),k):j(V)}function j(V){return V===61?(t.consume(V),D):Kt(V)?(o=j,X(V)):bn(V)?(t.consume(V),j):N(V)}function D(V){return V===null||V===60||V===61||V===62||V===96?n(V):V===34||V===39?(t.consume(V),s=V,L):Kt(V)?(o=D,X(V)):bn(V)?(t.consume(V),D):(t.consume(V),G)}function L(V){return V===s?(t.consume(V),s=void 0,B):V===null?n(V):Kt(V)?(o=L,X(V)):(t.consume(V),L)}function G(V){return V===null||V===34||V===39||V===60||V===61||V===96?n(V):V===47||V===62||yi(V)?N(V):(t.consume(V),G)}function B(V){return V===47||V===62||yi(V)?N(V):n(V)}function W(V){return V===62?(t.consume(V),t.exit("htmlTextData"),t.exit("htmlText"),e):n(V)}function X(V){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(V),t.exit("lineEnding"),H}function H(V){return bn(V)?Wn(t,K,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(V):K(V)}function K(V){return t.enter("htmlTextData"),o(V)}}const QA={name:"labelEnd",resolveAll:pPe,resolveTo:gPe,tokenize:yPe},hPe={tokenize:xPe},fPe={tokenize:vPe},mPe={tokenize:wPe};function pPe(t){let e=-1;const n=[];for(;++e<t.length;){const r=t[e][1];if(n.push(t[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const s=r.type==="labelImage"?4:2;r.type="data",e+=s}}return t.length!==n.length&&Sa(t,0,t.length,n),t}function gPe(t,e){let n=t.length,r=0,s,i,o,l;for(;n--;)if(s=t[n][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;t[n][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(o){if(t[n][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=n,s.type!=="labelLink")){r=2;break}}else s.type==="labelEnd"&&(o=n);const c={type:t[i][1].type==="labelLink"?"link":"image",start:{...t[i][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[i][1].start},end:{...t[o][1].end}},d={type:"labelText",start:{...t[i+r+2][1].end},end:{...t[o-2][1].start}};return l=[["enter",c,e],["enter",u,e]],l=no(l,t.slice(i+1,i+r+3)),l=no(l,[["enter",d,e]]),l=no(l,XA(e.parser.constructs.insideSpan.null,t.slice(i+r+4,o-3),e)),l=no(l,[["exit",d,e],t[o-2],t[o-1],["exit",u,e]]),l=no(l,t.slice(o+1)),l=no(l,[["exit",c,e]]),Sa(t,i,t.length,l),t}function yPe(t,e,n){const r=this;let s=r.events.length,i,o;for(;s--;)if((r.events[s][1].type==="labelImage"||r.events[s][1].type==="labelLink")&&!r.events[s][1]._balanced){i=r.events[s][1];break}return l;function l(f){return i?i._inactive?h(f):(o=r.parser.defined.includes(Mh(r.sliceSerialize({start:i.end,end:r.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(f),t.exit("labelMarker"),t.exit("labelEnd"),c):n(f)}function c(f){return f===40?t.attempt(hPe,d,o?d:h)(f):f===91?t.attempt(fPe,d,o?u:h)(f):o?d(f):h(f)}function u(f){return t.attempt(mPe,d,h)(f)}function d(f){return e(f)}function h(f){return i._balanced=!0,n(f)}}function xPe(t,e,n){return r;function r(h){return t.enter("resource"),t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),s}function s(h){return yi(h)?fp(t,i)(h):i(h)}function i(h){return h===41?d(h):nq(t,o,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function o(h){return yi(h)?fp(t,c)(h):d(h)}function l(h){return n(h)}function c(h){return h===34||h===39||h===40?sq(t,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function u(h){return yi(h)?fp(t,d)(h):d(h)}function d(h){return h===41?(t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),t.exit("resource"),e):n(h)}}function vPe(t,e,n){const r=this;return s;function s(l){return rq.call(r,t,i,o,"reference","referenceMarker","referenceString")(l)}function i(l){return r.parser.defined.includes(Mh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(l):n(l)}function o(l){return n(l)}}function wPe(t,e,n){return r;function r(i){return t.enter("reference"),t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),s}function s(i){return i===93?(t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),t.exit("reference"),e):n(i)}}const bPe={name:"labelStartImage",resolveAll:QA.resolveAll,tokenize:_Pe};function _Pe(t,e,n){const r=this;return s;function s(l){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(l),t.exit("labelImageMarker"),i}function i(l){return l===91?(t.enter("labelMarker"),t.consume(l),t.exit("labelMarker"),t.exit("labelImage"),o):n(l)}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):e(l)}}const SPe={name:"labelStartLink",resolveAll:QA.resolveAll,tokenize:CPe};function CPe(t,e,n){const r=this;return s;function s(o){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelLink"),i}function i(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}const rC={name:"lineEnding",tokenize:EPe};function EPe(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),Wn(t,e,"linePrefix")}}const pv={name:"thematicBreak",tokenize:TPe};function TPe(t,e,n){let r=0,s;return i;function i(u){return t.enter("thematicBreak"),o(u)}function o(u){return s=u,l(u)}function l(u){return u===s?(t.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||Kt(u))?(t.exit("thematicBreak"),e(u)):n(u)}function c(u){return u===s?(t.consume(u),r++,c):(t.exit("thematicBreakSequence"),bn(u)?Wn(t,l,"whitespace")(u):l(u))}}const oi={continuation:{tokenize:APe},exit:RPe,name:"list",tokenize:PPe},IPe={partial:!0,tokenize:jPe},NPe={partial:!0,tokenize:kPe};function PPe(t,e,n){const r=this,s=r.events[r.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,o=0;return l;function l(m){const g=r.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||m===r.containerState.marker:a1(m)){if(r.containerState.type||(r.containerState.type=g,t.enter(g,{_container:!0})),g==="listUnordered")return t.enter("listItemPrefix"),m===42||m===45?t.check(pv,n,u)(m):u(m);if(!r.interrupt||m===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),c(m)}return n(m)}function c(m){return a1(m)&&++o<10?(t.consume(m),c):(!r.interrupt||o<2)&&(r.containerState.marker?m===r.containerState.marker:m===41||m===46)?(t.exit("listItemValue"),u(m)):n(m)}function u(m){return t.enter("listItemMarker"),t.consume(m),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||m,t.check(a_,r.interrupt?n:d,t.attempt(IPe,f,h))}function d(m){return r.containerState.initialBlankLine=!0,i++,f(m)}function h(m){return bn(m)?(t.enter("listItemPrefixWhitespace"),t.consume(m),t.exit("listItemPrefixWhitespace"),f):n(m)}function f(m){return r.containerState.size=i+r.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(m)}}function APe(t,e,n){const r=this;return r.containerState._closeFlow=void 0,t.check(a_,s,i);function s(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Wn(t,e,"listItemIndent",r.containerState.size+1)(l)}function i(l){return r.containerState.furtherBlankLines||!bn(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,t.attempt(NPe,e,o)(l))}function o(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,Wn(t,t.attempt(oi,e,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function kPe(t,e,n){const r=this;return Wn(t,s,"listItemIndent",r.containerState.size+1);function s(i){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(i):n(i)}}function RPe(t){t.exit(this.containerState.type)}function jPe(t,e,n){const r=this;return Wn(t,s,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function s(i){const o=r.events[r.events.length-1];return!bn(i)&&o&&o[1].type==="listItemPrefixWhitespace"?e(i):n(i)}}const bF={name:"setextUnderline",resolveTo:DPe,tokenize:MPe};function DPe(t,e){let n=t.length,r,s,i;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(s=n)}else t[n][1].type==="content"&&t.splice(n,1),!i&&t[n][1].type==="definition"&&(i=n);const o={type:"setextHeading",start:{...t[r][1].start},end:{...t[t.length-1][1].end}};return t[s][1].type="setextHeadingText",i?(t.splice(s,0,["enter",o,e]),t.splice(i+1,0,["exit",t[r][1],e]),t[r][1].end={...t[i][1].end}):t[r][1]=o,t.push(["exit",o,e]),t}function MPe(t,e,n){const r=this;let s;return i;function i(u){let d=r.events.length,h;for(;d--;)if(r.events[d][1].type!=="lineEnding"&&r.events[d][1].type!=="linePrefix"&&r.events[d][1].type!=="content"){h=r.events[d][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||h)?(t.enter("setextHeadingLine"),s=u,o(u)):n(u)}function o(u){return t.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===s?(t.consume(u),l):(t.exit("setextHeadingLineSequence"),bn(u)?Wn(t,c,"lineSuffix")(u):c(u))}function c(u){return u===null||Kt(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}const LPe={tokenize:FPe};function FPe(t){const e=this,n=t.attempt(a_,r,t.attempt(this.parser.constructs.flowInitial,s,Wn(t,t.attempt(this.parser.constructs.flow,s,t.attempt(BNe,s)),"linePrefix")));return n;function r(i){if(i===null){t.consume(i);return}return t.enter("lineEndingBlank"),t.consume(i),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function s(i){if(i===null){t.consume(i);return}return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const OPe={resolveAll:oq()},VPe=iq("string"),$Pe=iq("text");function iq(t){return{resolveAll:oq(t==="text"?UPe:void 0),tokenize:e};function e(n){const r=this,s=this.parser.constructs[t],i=n.attempt(s,o,l);return o;function o(d){return u(d)?i(d):l(d)}function l(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),c}function c(d){return u(d)?(n.exit("data"),i(d)):(n.consume(d),c)}function u(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const m=h[f];if(!m.previous||m.previous.call(r,r.previous))return!0}return!1}}}function oq(t){return e;function e(n,r){let s=-1,i;for(;++s<=n.length;)i===void 0?n[s]&&n[s][1].type==="data"&&(i=s,s++):(!n[s]||n[s][1].type!=="data")&&(s!==i+2&&(n[i][1].end=n[s-1][1].end,n.splice(i+2,s-i-2),s=i+2),i=void 0);return t?t(n,r):n}}function UPe(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const r=t[n-1][1],s=e.sliceStream(r);let i=s.length,o=-1,l=0,c;for(;i--;){const u=s[i];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)l++,o--;if(o)break;o=-1}else if(u===-2)c=!0,l++;else if(u!==-1){i++;break}}if(e._contentTypeTextTrailing&&n===t.length&&(l=0),l){const u={type:n===t.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?o:r.start._bufferIndex+o,_index:r.start._index+i,line:r.end.line,column:r.end.column-l,offset:r.end.offset-l},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)}n++}return t}const BPe={42:oi,43:oi,45:oi,48:oi,49:oi,50:oi,51:oi,52:oi,53:oi,54:oi,55:oi,56:oi,57:oi,62:QH},zPe={91:qNe},GPe={[-2]:nC,[-1]:nC,32:nC},WPe={35:ZNe,42:pv,45:[bF,pv],60:rPe,61:bF,95:pv,96:vF,126:vF},HPe={38:eq,92:ZH},qPe={[-5]:rC,[-4]:rC,[-3]:rC,33:bPe,38:eq,42:l1,60:[SNe,uPe],91:SPe,92:[XNe,ZH],93:QA,95:l1,96:LNe},KPe={null:[l1,OPe]},YPe={null:[42,95]},JPe={null:[]},XPe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:YPe,contentInitial:zPe,disable:JPe,document:BPe,flow:WPe,flowInitial:GPe,insideSpan:KPe,string:HPe,text:qPe},Symbol.toStringTag,{value:"Module"}));function QPe(t,e,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const s={},i=[];let o=[],l=[];const c={attempt:E(R),check:E(A),consume:_,enter:C,exit:T,interrupt:E(A,{interrupt:!0})},u={code:null,containerState:{},defineSkip:x,events:[],now:g,parser:t,previous:null,sliceSerialize:f,sliceStream:m,write:h};let d=e.tokenize.call(u,c);return e.resolveAll&&i.push(e),u;function h(j){return o=no(o,j),v(),o[o.length-1]!==null?[]:(I(e,0),u.events=XA(i,u.events,u),u.events)}function f(j,D){return eAe(m(j),D)}function m(j){return ZPe(o,j)}function g(){const{_bufferIndex:j,_index:D,line:L,column:G,offset:B}=r;return{_bufferIndex:j,_index:D,line:L,column:G,offset:B}}function x(j){s[j.line]=j.column,k()}function v(){let j;for(;r._index<o.length;){const D=o[r._index];if(typeof D=="string")for(j=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===j&&r._bufferIndex<D.length;)w(D.charCodeAt(r._bufferIndex));else w(D)}}function w(j){d=d(j)}function _(j){Kt(j)?(r.line++,r.column=1,r.offset+=j===-3?2:1,k()):j!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=j}function C(j,D){const L=D||{};return L.type=j,L.start=g(),u.events.push(["enter",L,u]),l.push(L),L}function T(j){const D=l.pop();return D.end=g(),u.events.push(["exit",D,u]),D}function R(j,D){I(j,D.from)}function A(j,D){D.restore()}function E(j,D){return L;function L(G,B,W){let X,H,K,V;return Array.isArray(G)?z(G):"tokenize"in G?z([G]):$(G);function $(le){return he;function he(Le){const $e=Le!==null&&le[Le],Be=Le!==null&&le.null,ue=[...Array.isArray($e)?$e:$e?[$e]:[],...Array.isArray(Be)?Be:Be?[Be]:[]];return z(ue)(Le)}}function z(le){return X=le,H=0,le.length===0?W:F(le[H])}function F(le){return he;function he(Le){return V=N(),K=le,le.partial||(u.currentConstruct=le),le.name&&u.parser.constructs.disable.null.includes(le.name)?ce():le.tokenize.call(D?Object.assign(Object.create(u),D):u,c,Z,ce)(Le)}}function Z(le){return j(K,V),B}function ce(le){return V.restore(),++H<X.length?F(X[H]):W}}}function I(j,D){j.resolveAll&&!i.includes(j)&&i.push(j),j.resolve&&Sa(u.events,D,u.events.length-D,j.resolve(u.events.slice(D),u)),j.resolveTo&&(u.events=j.resolveTo(u.events,u))}function N(){const j=g(),D=u.previous,L=u.currentConstruct,G=u.events.length,B=Array.from(l);return{from:G,restore:W};function W(){r=j,u.previous=D,u.currentConstruct=L,u.events.length=G,l=B,k()}}function k(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function ZPe(t,e){const n=e.start._index,r=e.start._bufferIndex,s=e.end._index,i=e.end._bufferIndex;let o;if(n===s)o=[t[n].slice(r,i)];else{if(o=t.slice(n,s),r>-1){const l=o[0];typeof l=="string"?o[0]=l.slice(r):o.shift()}i>0&&o.push(t[s].slice(0,i))}return o}function eAe(t,e){let n=-1;const r=[];let s;for(;++n<t.length;){const i=t[n];let o;if(typeof i=="string")o=i;else switch(i){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&s)continue;o=" ";break}default:o=String.fromCharCode(i)}s=i===-2,r.push(o)}return r.join("")}function tAe(t){const r={constructs:lNe([XPe,...(t||{}).extensions||[]]),content:s(gNe),defined:[],document:s(xNe),flow:s(LPe),lazy:{},string:s(VPe),text:s($Pe)};return r;function s(i){return o;function o(l){return QPe(r,i,l)}}}function nAe(t){for(;!tq(t););return t}const _F=/[\0\t\n\r]/g;function rAe(){let t=1,e="",n=!0,r;return s;function s(i,o,l){const c=[];let u,d,h,f,m;for(i=e+(typeof i=="string"?i.toString():new TextDecoder(o||void 0).decode(i)),h=0,e="",n&&(i.charCodeAt(0)===65279&&h++,n=void 0);h<i.length;){if(_F.lastIndex=h,u=_F.exec(i),f=u&&u.index!==void 0?u.index:i.length,m=i.charCodeAt(f),!u){e=i.slice(h);break}if(m===10&&h===f&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),h<f&&(c.push(i.slice(h,f)),t+=f-h),m){case 0:{c.push(65533),t++;break}case 9:{for(d=Math.ceil(t/4)*4,c.push(-2);t++<d;)c.push(-1);break}case 10:{c.push(-4),t=1;break}default:r=!0,t=1}h=f+1}return l&&(r&&c.push(-5),e&&c.push(e),c.push(null)),c}}const sAe=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function iAe(t){return t.replace(sAe,oAe)}function oAe(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const s=n.charCodeAt(1),i=s===120||s===88;return XH(n.slice(i?2:1),i?16:10)}return JA(n)||t}const aq={}.hasOwnProperty;function aAe(t,e,n){return typeof e!="string"&&(n=e,e=void 0),lAe(n)(nAe(tAe(n).document().write(rAe()(t,e,!0))))}function lAe(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(kt),autolinkProtocol:N,autolinkEmail:N,atxHeading:i(ie),blockQuote:i(Be),characterEscape:N,characterReference:N,codeFenced:i(ue),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:i(ue,o),codeText:i(Ce,o),codeTextData:N,data:N,codeFlowValue:N,definition:i(Ie),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:i(ve),hardBreakEscape:i(Me),hardBreakTrailing:i(Me),htmlFlow:i(He,o),htmlFlowData:N,htmlText:i(He,o),htmlTextData:N,image:i(yt),label:o,link:i(kt),listItem:i(mn),listItemValue:f,listOrdered:i(en,h),listUnordered:i(en),paragraph:i(cn),reference:F,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:i(ie),strong:i(fn),thematicBreak:i(Et)},exit:{atxHeading:c(),atxHeadingSequence:R,autolink:c(),autolinkEmail:$e,autolinkProtocol:Le,blockQuote:c(),characterEscapeValue:k,characterReferenceMarkerHexadecimal:ce,characterReferenceMarkerNumeric:ce,characterReferenceValue:le,characterReference:he,codeFenced:c(v),codeFencedFence:x,codeFencedFenceInfo:m,codeFencedFenceMeta:g,codeFlowValue:k,codeIndented:c(w),codeText:c(B),codeTextData:k,data:k,definition:c(),definitionDestinationString:T,definitionLabelString:_,definitionTitleString:C,emphasis:c(),hardBreakEscape:c(D),hardBreakTrailing:c(D),htmlFlow:c(L),htmlFlowData:k,htmlText:c(G),htmlTextData:k,image:c(X),label:K,labelText:H,lineEnding:j,link:c(W),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:Z,resourceDestinationString:V,resourceTitleString:$,resource:z,setextHeading:c(I),setextHeadingLineSequence:E,setextHeadingText:A,strong:c(),thematicBreak:c()}};lq(e,(t||{}).mdastExtensions||[]);const n={};return r;function r(de){let De={type:"root",children:[]};const ee={stack:[De],tokenStack:[],config:e,enter:l,exit:u,buffer:o,resume:d,data:n},ae=[];let Q=-1;for(;++Q<de.length;)if(de[Q][1].type==="listOrdered"||de[Q][1].type==="listUnordered")if(de[Q][0]==="enter")ae.push(Q);else{const Pe=ae.pop();Q=s(de,Pe,Q)}for(Q=-1;++Q<de.length;){const Pe=e[de[Q][0]];aq.call(Pe,de[Q][1].type)&&Pe[de[Q][1].type].call(Object.assign({sliceSerialize:de[Q][2].sliceSerialize},ee),de[Q][1])}if(ee.tokenStack.length>0){const Pe=ee.tokenStack[ee.tokenStack.length-1];(Pe[1]||SF).call(ee,void 0,Pe[0])}for(De.position={start:kl(de.length>0?de[0][1].start:{line:1,column:1,offset:0}),end:kl(de.length>0?de[de.length-2][1].end:{line:1,column:1,offset:0})},Q=-1;++Q<e.transforms.length;)De=e.transforms[Q](De)||De;return De}function s(de,De,ee){let ae=De-1,Q=-1,Pe=!1,Ae,Ve,qe,oe;for(;++ae<=ee;){const _e=de[ae];switch(_e[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{_e[0]==="enter"?Q++:Q--,oe=void 0;break}case"lineEndingBlank":{_e[0]==="enter"&&(Ae&&!oe&&!Q&&!qe&&(qe=ae),oe=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:oe=void 0}if(!Q&&_e[0]==="enter"&&_e[1].type==="listItemPrefix"||Q===-1&&_e[0]==="exit"&&(_e[1].type==="listUnordered"||_e[1].type==="listOrdered")){if(Ae){let ze=ae;for(Ve=void 0;ze--;){const Te=de[ze];if(Te[1].type==="lineEnding"||Te[1].type==="lineEndingBlank"){if(Te[0]==="exit")continue;Ve&&(de[Ve][1].type="lineEndingBlank",Pe=!0),Te[1].type="lineEnding",Ve=ze}else if(!(Te[1].type==="linePrefix"||Te[1].type==="blockQuotePrefix"||Te[1].type==="blockQuotePrefixWhitespace"||Te[1].type==="blockQuoteMarker"||Te[1].type==="listItemIndent"))break}qe&&(!Ve||qe<Ve)&&(Ae._spread=!0),Ae.end=Object.assign({},Ve?de[Ve][1].start:_e[1].end),de.splice(Ve||ae,0,["exit",Ae,_e[2]]),ae++,ee++}if(_e[1].type==="listItemPrefix"){const ze={type:"listItem",_spread:!1,start:Object.assign({},_e[1].start),end:void 0};Ae=ze,de.splice(ae,0,["enter",ze,_e[2]]),ae++,ee++,qe=void 0,oe=!0}}}return de[De][1]._spread=Pe,ee}function i(de,De){return ee;function ee(ae){l.call(this,de(ae),ae),De&&De.call(this,ae)}}function o(){this.stack.push({type:"fragment",children:[]})}function l(de,De,ee){this.stack[this.stack.length-1].children.push(de),this.stack.push(de),this.tokenStack.push([De,ee||void 0]),de.position={start:kl(De.start),end:void 0}}function c(de){return De;function De(ee){de&&de.call(this,ee),u.call(this,ee)}}function u(de,De){const ee=this.stack.pop(),ae=this.tokenStack.pop();if(ae)ae[0].type!==de.type&&(De?De.call(this,de,ae[0]):(ae[1]||SF).call(this,de,ae[0]));else throw new Error("Cannot close `"+de.type+"` ("+hp({start:de.start,end:de.end})+"): its not open");ee.position.end=kl(de.end)}function d(){return oNe(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(de){if(this.data.expectingFirstListItemValue){const De=this.stack[this.stack.length-2];De.start=Number.parseInt(this.sliceSerialize(de),10),this.data.expectingFirstListItemValue=void 0}}function m(){const de=this.resume(),De=this.stack[this.stack.length-1];De.lang=de}function g(){const de=this.resume(),De=this.stack[this.stack.length-1];De.meta=de}function x(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function v(){const de=this.resume(),De=this.stack[this.stack.length-1];De.value=de.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function w(){const de=this.resume(),De=this.stack[this.stack.length-1];De.value=de.replace(/(\r?\n|\r)$/g,"")}function _(de){const De=this.resume(),ee=this.stack[this.stack.length-1];ee.label=De,ee.identifier=Mh(this.sliceSerialize(de)).toLowerCase()}function C(){const de=this.resume(),De=this.stack[this.stack.length-1];De.title=de}function T(){const de=this.resume(),De=this.stack[this.stack.length-1];De.url=de}function R(de){const De=this.stack[this.stack.length-1];if(!De.depth){const ee=this.sliceSerialize(de).length;De.depth=ee}}function A(){this.data.setextHeadingSlurpLineEnding=!0}function E(de){const De=this.stack[this.stack.length-1];De.depth=this.sliceSerialize(de).codePointAt(0)===61?1:2}function I(){this.data.setextHeadingSlurpLineEnding=void 0}function N(de){const ee=this.stack[this.stack.length-1].children;let ae=ee[ee.length-1];(!ae||ae.type!=="text")&&(ae=Ue(),ae.position={start:kl(de.start),end:void 0},ee.push(ae)),this.stack.push(ae)}function k(de){const De=this.stack.pop();De.value+=this.sliceSerialize(de),De.position.end=kl(de.end)}function j(de){const De=this.stack[this.stack.length-1];if(this.data.atHardBreak){const ee=De.children[De.children.length-1];ee.position.end=kl(de.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(De.type)&&(N.call(this,de),k.call(this,de))}function D(){this.data.atHardBreak=!0}function L(){const de=this.resume(),De=this.stack[this.stack.length-1];De.value=de}function G(){const de=this.resume(),De=this.stack[this.stack.length-1];De.value=de}function B(){const de=this.resume(),De=this.stack[this.stack.length-1];De.value=de}function W(){const de=this.stack[this.stack.length-1];if(this.data.inReference){const De=this.data.referenceType||"shortcut";de.type+="Reference",de.referenceType=De,delete de.url,delete de.title}else delete de.identifier,delete de.label;this.data.referenceType=void 0}function X(){const de=this.stack[this.stack.length-1];if(this.data.inReference){const De=this.data.referenceType||"shortcut";de.type+="Reference",de.referenceType=De,delete de.url,delete de.title}else delete de.identifier,delete de.label;this.data.referenceType=void 0}function H(de){const De=this.sliceSerialize(de),ee=this.stack[this.stack.length-2];ee.label=iAe(De),ee.identifier=Mh(De).toLowerCase()}function K(){const de=this.stack[this.stack.length-1],De=this.resume(),ee=this.stack[this.stack.length-1];if(this.data.inReference=!0,ee.type==="link"){const ae=de.children;ee.children=ae}else ee.alt=De}function V(){const de=this.resume(),De=this.stack[this.stack.length-1];De.url=de}function $(){const de=this.resume(),De=this.stack[this.stack.length-1];De.title=de}function z(){this.data.inReference=void 0}function F(){this.data.referenceType="collapsed"}function Z(de){const De=this.resume(),ee=this.stack[this.stack.length-1];ee.label=De,ee.identifier=Mh(this.sliceSerialize(de)).toLowerCase(),this.data.referenceType="full"}function ce(de){this.data.characterReferenceType=de.type}function le(de){const De=this.sliceSerialize(de),ee=this.data.characterReferenceType;let ae;ee?(ae=XH(De,ee==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):ae=JA(De);const Q=this.stack[this.stack.length-1];Q.value+=ae}function he(de){const De=this.stack.pop();De.position.end=kl(de.end)}function Le(de){k.call(this,de);const De=this.stack[this.stack.length-1];De.url=this.sliceSerialize(de)}function $e(de){k.call(this,de);const De=this.stack[this.stack.length-1];De.url="mailto:"+this.sliceSerialize(de)}function Be(){return{type:"blockquote",children:[]}}function ue(){return{type:"code",lang:null,meta:null,value:""}}function Ce(){return{type:"inlineCode",value:""}}function Ie(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function ve(){return{type:"emphasis",children:[]}}function ie(){return{type:"heading",depth:0,children:[]}}function Me(){return{type:"break"}}function He(){return{type:"html",value:""}}function yt(){return{type:"image",title:null,url:"",alt:null}}function kt(){return{type:"link",title:null,url:"",children:[]}}function en(de){return{type:"list",ordered:de.type==="listOrdered",start:null,spread:de._spread,children:[]}}function mn(de){return{type:"listItem",spread:de._spread,checked:null,children:[]}}function cn(){return{type:"paragraph",children:[]}}function fn(){return{type:"strong",children:[]}}function Ue(){return{type:"text",value:""}}function Et(){return{type:"thematicBreak"}}}function kl(t){return{line:t.line,column:t.column,offset:t.offset}}function lq(t,e){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?lq(t,r):cAe(t,r)}}function cAe(t,e){let n;for(n in e)if(aq.call(e,n))switch(n){case"canContainEols":{const r=e[n];r&&t[n].push(...r);break}case"transforms":{const r=e[n];r&&t[n].push(...r);break}case"enter":case"exit":{const r=e[n];r&&Object.assign(t[n],r);break}}}function SF(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+hp({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+hp({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+hp({start:e.start,end:e.end})+") is still open")}function uAe(t){const e=this;e.parser=n;function n(r){return aAe(r,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function dAe(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function hAe(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function fAe(t,e){const n=e.value?e.value+`
`:"",r={};e.lang&&(r.className=["language-"+e.lang]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return e.meta&&(s.data={meta:e.meta}),t.patch(e,s),s=t.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},t.patch(e,s),s}function mAe(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function pAe(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function gAe(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),s=jf(r.toLowerCase()),i=t.footnoteOrder.indexOf(r);let o,l=t.footnoteCounts.get(r);l===void 0?(l=0,t.footnoteOrder.push(r),o=t.footnoteOrder.length):o=i+1,l+=1,t.footnoteCounts.set(r,l);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+s,id:n+"fnref-"+s+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};t.patch(e,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return t.patch(e,u),t.applyData(e,u)}function yAe(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function xAe(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function cq(t,e){const n=e.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const s=t.all(e),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const o=s[s.length-1];return o&&o.type==="text"?o.value+=r:s.push({type:"text",value:r}),s}function vAe(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return cq(t,e);const s={src:jf(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"img",properties:s,children:[]};return t.patch(e,i),t.applyData(e,i)}function wAe(t,e){const n={src:jf(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,r),t.applyData(e,r)}function bAe(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,r),t.applyData(e,r)}function _Ae(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return cq(t,e);const s={href:jf(r.url||"")};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"a",properties:s,children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function SAe(t,e){const n={href:jf(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function CAe(t,e,n){const r=t.all(e),s=n?EAe(n):uq(e),i={},o=[];if(typeof e.checked=="boolean"){const d=r[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},r.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let l=-1;for(;++l<r.length;){const d=r[l];(s||l!==0||d.type!=="element"||d.tagName!=="p")&&o.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?o.push(...d.children):o.push(d)}const c=r[r.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:i,children:o};return t.patch(e,u),t.applyData(e,u)}function EAe(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let r=-1;for(;!e&&++r<n.length;)e=uq(n[r])}return e}function uq(t){const e=t.spread;return e??t.children.length>1}function TAe(t,e){const n={},r=t.all(e);let s=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++s<r.length;){const o=r[s];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(r,!0)};return t.patch(e,i),t.applyData(e,i)}function IAe(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function NAe(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function PAe(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function AAe(t,e){const n=t.all(e),r=n.shift(),s=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:t.wrap([r],!0)};t.patch(e.children[0],o),s.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},l=HA(e.children[1]),c=GH(e.children[e.children.length-1]);l&&c&&(o.position={start:l,end:c}),s.push(o)}const i={type:"element",tagName:"table",properties:{},children:t.wrap(s,!0)};return t.patch(e,i),t.applyData(e,i)}function kAe(t,e,n){const r=n?n.children:void 0,i=(r?r.indexOf(e):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,l=o?o.length:e.children.length;let c=-1;const u=[];for(;++c<l;){const h=e.children[c],f={},m=o?o[c]:void 0;m&&(f.align=m);let g={type:"element",tagName:i,properties:f,children:[]};h&&(g.children=t.all(h),t.patch(h,g),g=t.applyData(h,g)),u.push(g)}const d={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(e,d),t.applyData(e,d)}function RAe(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const CF=9,EF=32;function jAe(t){const e=String(t),n=/\r?\n|\r/g;let r=n.exec(e),s=0;const i=[];for(;r;)i.push(TF(e.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=n.exec(e);return i.push(TF(e.slice(s),s>0,!1)),i.join("")}function TF(t,e,n){let r=0,s=t.length;if(e){let i=t.codePointAt(r);for(;i===CF||i===EF;)r++,i=t.codePointAt(r)}if(n){let i=t.codePointAt(s-1);for(;i===CF||i===EF;)s--,i=t.codePointAt(s-1)}return s>r?t.slice(r,s):""}function DAe(t,e){const n={type:"text",value:jAe(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function MAe(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const LAe={blockquote:dAe,break:hAe,code:fAe,delete:mAe,emphasis:pAe,footnoteReference:gAe,heading:yAe,html:xAe,imageReference:vAe,image:wAe,inlineCode:bAe,linkReference:_Ae,link:SAe,listItem:CAe,list:TAe,paragraph:IAe,root:NAe,strong:PAe,table:AAe,tableCell:RAe,tableRow:kAe,text:DAe,thematicBreak:MAe,toml:_x,yaml:_x,definition:_x,footnoteDefinition:_x};function _x(){}const dq=-1,l_=0,mp=1,t0=2,ZA=3,ek=4,tk=5,nk=6,hq=7,fq=8,IF=typeof self=="object"?self:globalThis,FAe=(t,e)=>{const n=(s,i)=>(t.set(i,s),s),r=s=>{if(t.has(s))return t.get(s);const[i,o]=e[s];switch(i){case l_:case dq:return n(o,s);case mp:{const l=n([],s);for(const c of o)l.push(r(c));return l}case t0:{const l=n({},s);for(const[c,u]of o)l[r(c)]=r(u);return l}case ZA:return n(new Date(o),s);case ek:{const{source:l,flags:c}=o;return n(new RegExp(l,c),s)}case tk:{const l=n(new Map,s);for(const[c,u]of o)l.set(r(c),r(u));return l}case nk:{const l=n(new Set,s);for(const c of o)l.add(r(c));return l}case hq:{const{name:l,message:c}=o;return n(new IF[l](c),s)}case fq:return n(BigInt(o),s);case"BigInt":return n(Object(BigInt(o)),s);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new IF[i](o),s)};return r},NF=t=>FAe(new Map,t)(0),$d="",{toString:OAe}={},{keys:VAe}=Object,um=t=>{const e=typeof t;if(e!=="object"||!t)return[l_,e];const n=OAe.call(t).slice(8,-1);switch(n){case"Array":return[mp,$d];case"Object":return[t0,$d];case"Date":return[ZA,$d];case"RegExp":return[ek,$d];case"Map":return[tk,$d];case"Set":return[nk,$d];case"DataView":return[mp,n]}return n.includes("Array")?[mp,n]:n.includes("Error")?[hq,n]:[t0,n]},Sx=([t,e])=>t===l_&&(e==="function"||e==="symbol"),$Ae=(t,e,n,r)=>{const s=(o,l)=>{const c=r.push(o)-1;return n.set(l,c),c},i=o=>{if(n.has(o))return n.get(o);let[l,c]=um(o);switch(l){case l_:{let d=o;switch(c){case"bigint":l=fq,d=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+c);d=null;break;case"undefined":return s([dq],o)}return s([l,d],o)}case mp:{if(c){let f=o;return c==="DataView"?f=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(f=new Uint8Array(o)),s([c,[...f]],o)}const d=[],h=s([l,d],o);for(const f of o)d.push(i(f));return h}case t0:{if(c)switch(c){case"BigInt":return s([c,o.toString()],o);case"Boolean":case"Number":case"String":return s([c,o.valueOf()],o)}if(e&&"toJSON"in o)return i(o.toJSON());const d=[],h=s([l,d],o);for(const f of VAe(o))(t||!Sx(um(o[f])))&&d.push([i(f),i(o[f])]);return h}case ZA:return s([l,o.toISOString()],o);case ek:{const{source:d,flags:h}=o;return s([l,{source:d,flags:h}],o)}case tk:{const d=[],h=s([l,d],o);for(const[f,m]of o)(t||!(Sx(um(f))||Sx(um(m))))&&d.push([i(f),i(m)]);return h}case nk:{const d=[],h=s([l,d],o);for(const f of o)(t||!Sx(um(f)))&&d.push(i(f));return h}}const{message:u}=o;return s([l,{name:c,message:u}],o)};return i},PF=(t,{json:e,lossy:n}={})=>{const r=[];return $Ae(!(e||n),!!e,new Map,r)(t),r},n0=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?NF(PF(t,e)):structuredClone(t):(t,e)=>NF(PF(t,e));function UAe(t,e){const n=[{type:"text",value:""}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function BAe(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function zAe(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||UAe,r=t.options.footnoteBackLabel||BAe,s=t.options.footnoteLabel||"Footnotes",i=t.options.footnoteLabelTagName||"h2",o=t.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[c]);if(!u)continue;const d=t.all(u),h=String(u.identifier).toUpperCase(),f=jf(h.toLowerCase());let m=0;const g=[],x=t.footnoteCounts.get(h);for(;x!==void 0&&++m<=x;){g.length>0&&g.push({type:"text",value:" "});let _=typeof n=="string"?n:n(c,m);typeof _=="string"&&(_={type:"text",value:_}),g.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+f+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,m),className:["data-footnote-backref"]},children:Array.isArray(_)?_:[_]})}const v=d[d.length-1];if(v&&v.type==="element"&&v.tagName==="p"){const _=v.children[v.children.length-1];_&&_.type==="text"?_.value+=" ":v.children.push({type:"text",value:" "}),v.children.push(...g)}else d.push(...g);const w={type:"element",tagName:"li",properties:{id:e+"fn-"+f},children:t.wrap(d,!0)};t.patch(u,w),l.push(w)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...n0(o),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(l,!0)},{type:"text",value:`
`}]}}const mq=function(t){if(t==null)return qAe;if(typeof t=="function")return c_(t);if(typeof t=="object")return Array.isArray(t)?GAe(t):WAe(t);if(typeof t=="string")return HAe(t);throw new Error("Expected function, string, or object as test")};function GAe(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=mq(t[n]);return c_(r);function r(...s){let i=-1;for(;++i<e.length;)if(e[i].apply(this,s))return!0;return!1}}function WAe(t){const e=t;return c_(n);function n(r){const s=r;let i;for(i in t)if(s[i]!==e[i])return!1;return!0}}function HAe(t){return c_(e);function e(n){return n&&n.type===t}}function c_(t){return e;function e(n,r,s){return!!(KAe(n)&&t.call(this,n,typeof r=="number"?r:void 0,s||void 0))}}function qAe(){return!0}function KAe(t){return t!==null&&typeof t=="object"&&"type"in t}const pq=[],YAe=!0,AF=!1,JAe="skip";function XAe(t,e,n,r){let s;typeof e=="function"&&typeof n!="function"?(r=n,n=e):s=e;const i=mq(s),o=r?-1:1;l(t,void 0,[])();function l(c,u,d){const h=c&&typeof c=="object"?c:{};if(typeof h.type=="string"){const m=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(c.type+(m?"<"+m+">":""))+")"})}return f;function f(){let m=pq,g,x,v;if((!e||i(c,u,d[d.length-1]||void 0))&&(m=QAe(n(c,d)),m[0]===AF))return m;if("children"in c&&c.children){const w=c;if(w.children&&m[0]!==JAe)for(x=(r?w.children.length:-1)+o,v=d.concat(w);x>-1&&x<w.children.length;){const _=w.children[x];if(g=l(_,x,v)(),g[0]===AF)return g;x=typeof g[1]=="number"?g[1]:x+o}}return m}}}function QAe(t){return Array.isArray(t)?t:typeof t=="number"?[YAe,t]:t==null?pq:[t]}function gq(t,e,n,r){let s,i,o;typeof e=="function"&&typeof n!="function"?(i=void 0,o=e,s=n):(i=e,o=n,s=r),XAe(t,i,l,s);function l(c,u){const d=u[u.length-1],h=d?d.children.indexOf(c):void 0;return o(c,h,d)}}const c1={}.hasOwnProperty,ZAe={};function eke(t,e){const n=e||ZAe,r=new Map,s=new Map,i=new Map,o={...LAe,...n.handlers},l={all:u,applyData:nke,definitionById:r,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:o,one:c,options:n,patch:tke,wrap:ske};return gq(t,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?r:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),l;function c(d,h){const f=d.type,m=l.handlers[f];if(c1.call(l.handlers,f)&&m)return m(l,d,h);if(l.options.passThrough&&l.options.passThrough.includes(f)){if("children"in d){const{children:x,...v}=d,w=n0(v);return w.children=l.all(d),w}return n0(d)}return(l.options.unknownHandler||rke)(l,d,h)}function u(d){const h=[];if("children"in d){const f=d.children;let m=-1;for(;++m<f.length;){const g=l.one(f[m],d);if(g){if(m&&f[m-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=kF(g.value)),!Array.isArray(g)&&g.type==="element")){const x=g.children[0];x&&x.type==="text"&&(x.value=kF(x.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function tke(t,e){t.position&&(e.position=OIe(t))}function nke(t,e){let n=e;if(t&&t.data){const r=t.data.hName,s=t.data.hChildren,i=t.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&i&&Object.assign(n.properties,n0(i)),"children"in n&&n.children&&s!==null&&s!==void 0&&(n.children=s)}return n}function rke(t,e){const n=e.data||{},r="value"in e&&!(c1.call(n,"hProperties")||c1.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function ske(t,e){const n=[];let r=-1;for(e&&n.push({type:"text",value:`
`});++r<t.length;)r&&n.push({type:"text",value:`
`}),n.push(t[r]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function kF(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function RF(t,e){const n=eke(t,e),r=n.one(t,void 0),s=zAe(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function ike(t,e){return t&&"run"in t?async function(n,r){const s=RF(n,{file:r,...e});await t.run(s,r)}:function(n,r){return RF(n,{file:r,...t||e})}}function jF(t){if(t)throw t}var gv=Object.prototype.hasOwnProperty,yq=Object.prototype.toString,DF=Object.defineProperty,MF=Object.getOwnPropertyDescriptor,LF=function(e){return typeof Array.isArray=="function"?Array.isArray(e):yq.call(e)==="[object Array]"},FF=function(e){if(!e||yq.call(e)!=="[object Object]")return!1;var n=gv.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&gv.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var s;for(s in e);return typeof s>"u"||gv.call(e,s)},OF=function(e,n){DF&&n.name==="__proto__"?DF(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},VF=function(e,n){if(n==="__proto__")if(gv.call(e,n)){if(MF)return MF(e,n).value}else return;return e[n]},oke=function t(){var e,n,r,s,i,o,l=arguments[0],c=1,u=arguments.length,d=!1;for(typeof l=="boolean"&&(d=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<u;++c)if(e=arguments[c],e!=null)for(n in e)r=VF(l,n),s=VF(e,n),l!==s&&(d&&s&&(FF(s)||(i=LF(s)))?(i?(i=!1,o=r&&LF(r)?r:[]):o=r&&FF(r)?r:{},OF(l,{name:n,newValue:t(d,o,s)})):typeof s<"u"&&OF(l,{name:n,newValue:s}));return l};const sC=r0(oke);function u1(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function ake(){const t=[],e={run:n,use:r};return e;function n(...s){let i=-1;const o=s.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);l(null,...s);function l(c,...u){const d=t[++i];let h=-1;if(c){o(c);return}for(;++h<s.length;)(u[h]===null||u[h]===void 0)&&(u[h]=s[h]);s=u,d?lke(d,l)(...u):o(null,...u)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return t.push(s),e}}function lke(t,e){let n;return r;function r(...o){const l=t.length>o.length;let c;l&&o.push(s);try{c=t.apply(this,o)}catch(u){const d=u;if(l&&n)throw d;return s(d)}l||(c&&c.then&&typeof c.then=="function"?c.then(i,s):c instanceof Error?s(c):i(c))}function s(o,...l){n||(n=!0,e(o,...l))}function i(o){s(null,o)}}const Zo={basename:cke,dirname:uke,extname:dke,join:hke,sep:"/"};function cke(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');ly(t);let n=0,r=-1,s=t.length,i;if(e===void 0||e.length===0||e.length>t.length){for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else r<0&&(i=!0,r=s+1);return r<0?"":t.slice(n,r)}if(e===t)return"";let o=-1,l=e.length-1;for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else o<0&&(i=!0,o=s+1),l>-1&&(t.codePointAt(s)===e.codePointAt(l--)?l<0&&(r=s):(l=-1,r=o));return n===r?r=o:r<0&&(r=t.length),t.slice(n,r)}function uke(t){if(ly(t),t.length===0)return".";let e=-1,n=t.length,r;for(;--n;)if(t.codePointAt(n)===47){if(r){e=n;break}}else r||(r=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function dke(t){ly(t);let e=t.length,n=-1,r=0,s=-1,i=0,o;for(;e--;){const l=t.codePointAt(e);if(l===47){if(o){r=e+1;break}continue}n<0&&(o=!0,n=e+1),l===46?s<0?s=e:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||n<0||i===0||i===1&&s===n-1&&s===r+1?"":t.slice(s,n)}function hke(...t){let e=-1,n;for(;++e<t.length;)ly(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":fke(n)}function fke(t){ly(t);const e=t.codePointAt(0)===47;let n=mke(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function mke(t,e){let n="",r=0,s=-1,i=0,o=-1,l,c;for(;++o<=t.length;){if(o<t.length)l=t.codePointAt(o);else{if(l===47)break;l=47}if(l===47){if(!(s===o-1||i===1))if(s!==o-1&&i===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}}else if(n.length>0){n="",r=0,s=o,i=0;continue}}e&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+t.slice(s+1,o):n=t.slice(s+1,o),r=o-s-1;s=o,i=0}else l===46&&i>-1?i++:i=-1}return n}function ly(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const pke={cwd:gke};function gke(){return"/"}function d1(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function yke(t){if(typeof t=="string")t=new URL(t);else if(!d1(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return xke(t)}function xke(t){if(t.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const r=e.codePointAt(n+2);if(r===70||r===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(e)}const iC=["history","path","basename","stem","extname","dirname"];class xq{constructor(e){let n;e?d1(e)?n={path:e}:typeof e=="string"||vke(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":pke.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<iC.length;){const i=iC[r];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let s;for(s in n)iC.includes(s)||(this[s]=n[s])}get basename(){return typeof this.path=="string"?Zo.basename(this.path):void 0}set basename(e){aC(e,"basename"),oC(e,"basename"),this.path=Zo.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?Zo.dirname(this.path):void 0}set dirname(e){$F(this.basename,"dirname"),this.path=Zo.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?Zo.extname(this.path):void 0}set extname(e){if(oC(e,"extname"),$F(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=Zo.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){d1(e)&&(e=yke(e)),aC(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?Zo.basename(this.path,this.extname):void 0}set stem(e){aC(e,"stem"),oC(e,"stem"),this.path=Zo.join(this.dirname||"",e+(this.extname||""))}fail(e,n,r){const s=this.message(e,n,r);throw s.fatal=!0,s}info(e,n,r){const s=this.message(e,n,r);return s.fatal=void 0,s}message(e,n,r){const s=new Os(e,n,r);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function oC(t,e){if(t&&t.includes(Zo.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+Zo.sep+"`")}function aC(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function $F(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function vke(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const wke=function(t){const r=this.constructor.prototype,s=r[t],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,r),i},bke={}.hasOwnProperty;class rk extends wke{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=ake()}copy(){const e=new rk;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];e.use(...r)}return e.data(sC(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(uC("data",this.frozen),this.namespace[e]=n,this):bke.call(this.namespace,e)&&this.namespace[e]||void 0:e?(uC("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=n.call(e,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=Cx(e),r=this.parser||this.Parser;return lC("parse",r),r(String(n),n)}process(e,n){const r=this;return this.freeze(),lC("process",this.parser||this.Parser),cC("process",this.compiler||this.Compiler),n?s(void 0,n):new Promise(s);function s(i,o){const l=Cx(e),c=r.parse(l);r.run(c,l,function(d,h,f){if(d||!h||!f)return u(d);const m=h,g=r.stringify(m,f);Cke(g)?f.value=g:f.result=g,u(d,f)});function u(d,h){d||!h?o(d):i?i(h):n(void 0,h)}}}processSync(e){let n=!1,r;return this.freeze(),lC("processSync",this.parser||this.Parser),cC("processSync",this.compiler||this.Compiler),this.process(e,s),BF("processSync","process",n),r;function s(i,o){n=!0,jF(i),r=o}}run(e,n,r){UF(e),this.freeze();const s=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?i(void 0,r):new Promise(i);function i(o,l){const c=Cx(n);s.run(e,c,u);function u(d,h,f){const m=h||e;d?l(d):o?o(m):r(void 0,m,f)}}}runSync(e,n){let r=!1,s;return this.run(e,n,i),BF("runSync","run",r),s;function i(o,l){jF(o),s=l,r=!0}}stringify(e,n){this.freeze();const r=Cx(n),s=this.compiler||this.Compiler;return cC("stringify",s),UF(e),s(e,r)}use(e,...n){const r=this.attachers,s=this.namespace;if(uC("use",this.frozen),e!=null)if(typeof e=="function")c(e,n);else if(typeof e=="object")Array.isArray(e)?l(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function i(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...h]=u;c(d,h)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(s.settings=sC(!0,s.settings,u.settings))}function l(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const h=u[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,d){let h=-1,f=-1;for(;++h<r.length;)if(r[h][0]===u){f=h;break}if(f===-1)r.push([u,...d]);else if(d.length>0){let[m,...g]=d;const x=r[f][1];u1(x)&&u1(m)&&(m=sC(!0,x,m)),r[f]=[u,m,...g]}}}}const _ke=new rk().freeze();function lC(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function cC(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function uC(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function UF(t){if(!u1(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function BF(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Cx(t){return Ske(t)?t:new xq(t)}function Ske(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function Cke(t){return typeof t=="string"||Eke(t)}function Eke(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const Tke="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",zF=[],GF={allowDangerousHtml:!0},Ike=/^(https?|ircs?|mailto|xmpp)$/i,Nke=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function Pke(t){const e=Ake(t),n=kke(t);return Rke(e.runSync(e.parse(n),n),t)}function Ake(t){const e=t.rehypePlugins||zF,n=t.remarkPlugins||zF,r=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...GF}:GF;return _ke().use(uAe).use(n).use(ike,r).use(e)}function kke(t){const e=t.children||"",n=new xq;return typeof e=="string"&&(n.value=e),n}function Rke(t,e){const n=e.allowedElements,r=e.allowElement,s=e.components,i=e.disallowedElements,o=e.skipHtml,l=e.unwrapDisallowed,c=e.urlTransform||jke;for(const d of Nke)Object.hasOwn(e,d.from)&&(""+d.from+(d.to?"use `"+d.to+"` instead":"remove it")+Tke+d.id,void 0);return gq(t,u),zIe(t,{Fragment:a.Fragment,components:s,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function u(d,h,f){if(d.type==="raw"&&f&&typeof h=="number")return o?f.children.splice(h,1):f.children[h]={type:"text",value:d.value},h;if(d.type==="element"){let m;for(m in tC)if(Object.hasOwn(tC,m)&&Object.hasOwn(d.properties,m)){const g=d.properties[m],x=tC[m];(x===null||x.includes(d.tagName))&&(d.properties[m]=c(String(g||""),m,d))}}if(d.type==="element"){let m=n?!n.includes(d.tagName):i?i.includes(d.tagName):!1;if(!m&&r&&typeof h=="number"&&(m=!r(d,h,f)),m&&f&&typeof h=="number")return l&&d.children?f.children.splice(h,1,...d.children):f.children.splice(h,1),h}}}function jke(t){const e=t.indexOf(":"),n=t.indexOf("?"),r=t.indexOf("#"),s=t.indexOf("/");return e===-1||s!==-1&&e>s||n!==-1&&e>n||r!==-1&&e>r||Ike.test(t.slice(0,e))?t:""}const Dke=({productData:t,onViewDetails:e,onAddToCart:n,onBuyNow:r,onVisualize:s})=>{if(!t)return null;const{name:i,description:o,price:l,imageUrl:c,id:u}=t;return a.jsxs(Xe,{className:"mb-2 w-full max-w-xs sm:max-w-sm overflow-hidden shadow-md border border-border",children:[c&&a.jsx("div",{className:"w-full h-32 sm:h-40 overflow-hidden bg-muted",children:a.jsx("img",{src:c,alt:i||"Product image",className:"w-full h-full object-contain"})}),a.jsx(ct,{className:"p-3",children:i&&a.jsx(ut,{className:"text-sm sm:text-base font-semibold leading-tight line-clamp-2",children:i})}),a.jsxs(at,{className:"p-3 pt-0 text-xs sm:text-sm",children:[o&&a.jsx(Qt,{className:"mb-2 line-clamp-2 sm:line-clamp-3 text-muted-foreground",children:o}),l&&a.jsx("p",{className:"font-semibold text-sm sm:text-base",children:typeof l=="number"?`$${l.toFixed(2)}`:l}),a.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row sm:space-x-2 space-y-2 sm:space-y-0",children:[e&&a.jsx(O,{size:"sm",variant:"outline",className:"flex-1 text-xs sm:text-sm",onClick:()=>e(u,i),children:"View"}),n&&a.jsx(O,{size:"sm",variant:"secondary",className:"flex-1 text-xs sm:text-sm",onClick:()=>n(u,i),children:"Add to Cart"}),r&&a.jsx(O,{size:"sm",variant:"default",className:"flex-1 text-xs sm:text-sm",onClick:()=>r(u,i),children:"Buy Now"})]}),s&&a.jsxs(O,{size:"sm",variant:"outline",className:"w-full mt-2 text-xs sm:text-sm",onClick:()=>s(u,i),children:[a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Visualize with Image"]})]})]})},Mke="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s",Lke=new On({apiKey:Mke}),Fke="gemini-2.0-flash-preview-image-generation";async function dC(t,e){if(!t)throw new Error("Image source is undefined or null.");let n,r=e;if(typeof t=="string"&&(t.startsWith("http://")||t.startsWith("https://"))){console.log(`Fetching image from URL: ${t}`);const i=await fetch(t);if(!i.ok)throw new Error(`Failed to fetch image from ${t}: ${i.statusText}`);const o=await i.blob();r=o.type||r||"image/jpeg",n=await new Promise((l,c)=>{const u=new FileReader;u.onloadend=()=>{typeof u.result=="string"?l(u.result.split(",")[1]):c(new Error("FileReader did not return a string for URL image."))},u.onerror=d=>c(new Error(`FileReader failed for URL image: ${d}`)),u.readAsDataURL(o)})}else if(typeof t=="string"&&t.startsWith("data:")){console.log("Processing Data URL image.");try{const i=t.split(",");if(i.length<2)throw new Error("Invalid data URL structure.");const o=i[0];n=i[1];const l=o.match(/:(.*?);/);if(!l||!l[1])throw new Error("Could not parse MIME type from data URL.");r=l[1]}catch(i){throw console.error("Error parsing data URL:",t,i),new Error(`Invalid data URL format: ${i.message}`)}}else if(typeof File<"u"&&t instanceof File)console.log(`Processing File object: ${t.name}`),r=t.type,n=await new Promise((i,o)=>{const l=new FileReader;l.onloadend=()=>{typeof l.result=="string"?i(l.result.split(",")[1]):o(new Error("FileReader did not return a string for File object."))},l.onerror=c=>o(new Error(`FileReader failed for File object: ${c}`)),l.readAsDataURL(t)});else if(typeof t=="string"){console.warn(`Received string imageSource that is not a URL or Data URL: "${t}". This path is intended for Node.js file paths.`);try{console.log(`Attempting to read image from local path (Node.js context): ${t}`),n=(await(await Ot(()=>import("./__vite-browser-external-b25bb000.js"),[])).readFile(t)).toString("base64");const c=(await Ot(()=>import("./__vite-browser-external-b25bb000.js"),[])).extname(t).toLowerCase();if(!r)if(c===".png")r="image/png";else if(c===".jpg"||c===".jpeg")r="image/jpeg";else if(c===".webp")r="image/webp";else if(c===".gif")r="image/gif";else throw new Error(`Unsupported image extension or MIME type not provided for path: ${t}`)}catch(i){throw console.error("Failed to process string as Node.js file path (this is expected in browser):",i),new Error("Unsupported string imageSource in browser. Must be URL or Data URL, or provide a File object.")}}else throw new Error("Unsupported image source type. Provide a URL, Data URL, or File object.");if(!n)throw new Error("Could not obtain base64 image data.");r||(r="image/jpeg",console.warn("MIME type could not be determined, defaulting to image/jpeg."));const s=["image/png","image/jpeg","image/webp","image/heic","image/heif"];return s.includes(r)||console.warn(`MIME type ${r} may not be optimally supported. Supported types are: ${s.join(", ")}.`),{inlineData:{data:n,mimeType:r}}}async function vq({mainProduct:t,referenceSceneSource:e,additionalProducts:n=[],customInstructions:r=""}){var o,l,c,u,d,h,f,m;if(!t||!t.name||!t.imageSource)throw new Error("Main product with name and imageSource is required.");if(!e)throw new Error("Reference scene imageSource is required.");const s=[];let i=`Visually integrate the product named "${t.name}" into a scene inspired by the provided reference scene image.
The main product is described as: "${t.description||"Not specified"}".
The reference scene image sets the style, lighting, and overall environment.
Make the main product the primary focus, well-lit, and naturally fitting the scene's perspective.
`;n.length>0&&(i+=`
Also, incorporate the following additional products naturally into the scene:
`,n.forEach((g,x)=>{i+=`- Product ${x+1}: "${g.name}" (Description: "${g.description||"Not specified"}")
`})),r.trim()!==""&&(i+=`
Specific User Instructions: "${r.trim()}"
`),i+=`
Please generate a high-quality, photorealistic image based on these instructions and the provided images. Also provide a brief text commentary about the generated image or any challenges encountered.`,s.push({text:i});try{s.push(await dC(e)),s.push(await dC(t.imageSource));for(const g of n)if(g.imageSource)try{s.push(await dC(g.imageSource))}catch(x){console.warn(`Could not process image for additional product "${g.name}": ${x.message}. Skipping this image.`)}}catch(g){throw new Error(`Failed to process one or more input images: ${g.message}`)}console.log("Constructed prompt parts. Total parts:",s.length);try{const g=await Lke.models.generateContent({model:Fke,contents:[{role:"user",parts:s}],generationConfig:{temperature:.6,candidateCount:1},safetySettings:[{category:Nr.HARM_CATEGORY_HARASSMENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_HATE_SPEECH,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE},{category:Nr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Pr.BLOCK_MEDIUM_AND_ABOVE}],config:{responseModalities:[wn.TEXT,wn.IMAGE]}}),x=g;if(!x)throw console.error("Full API result from Gemini was undefined:",g),new Error("Invalid or empty response from Gemini API.");let v=null,w="No specific commentary from the model.";console.log("Full API response from Gemini:",JSON.stringify(x,null,2)),(o=x.promptFeedback)!=null&&o.blockReason&&(w=`Image generation may have been blocked. Reason: ${x.promptFeedback.blockReason}.`,console.warn(w));const _=(l=x.candidates)==null?void 0:l[0];if(_){if(_.finishReason&&_.finishReason!=="STOP"&&_.finishReason!=="MAX_TOKENS"){const C=`Generation stopped. Reason: ${_.finishReason}.`;w=w==="No specific commentary from the model."?C:`${w}. ${C}`,console.warn(C)}if(((u=(c=_.content)==null?void 0:c.parts)==null?void 0:u.length)>0)for(const C of _.content.parts)C.text?w=w==="No specific commentary from the model."||!w.includes(C.text)?w==="No specific commentary from the model."?C.text:w+" "+C.text:w:(h=(d=C.inlineData)==null?void 0:d.mimeType)!=null&&h.startsWith("image/")&&(v=`data:${C.inlineData.mimeType};base64,${C.inlineData.data}`,console.log(`Image generated successfully. MIME type: ${C.inlineData.mimeType}`))}else(f=x.promptFeedback)!=null&&f.blockReason||(w=w==="No specific commentary from the model."?"No candidates returned by the model.":`${w}. Also, no candidates were returned.`);return!v&&w==="No specific commentary from the model."&&(w="Image generation failed, and no specific reason or commentary was provided."),{imageUrl:v,commentary:w,promptUsed:i}}catch(g){console.error("Error during Gemini API call or response processing:",g);let x=g.message;throw(m=g.response)!=null&&m.message?x=g.response.message:g.response&&(x=JSON.stringify(g.response)),new Error(`Product visualization failed: ${x}`)}}const wq=()=>{var qe;const t=vi(),{currentStore:e,addToCart:n,getProductById:r,updateQuantity:s,viewMode:i}=Vn(),{userRole:o}=yo(),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState('You are a friendly and helpful AI assistant for an e-commerce store. Be concise and helpful. Always format your responses using Markdown. If a user asks you to find a product, your primary action should be to use the `find_and_open_product` function. **Only after the `find_and_open_product` function successfully returns product details (indicated by `product_found: true` in the function\'s result) should you then say something like "Here is the product I found for you:".** At that point, a product card will also be displayed by the UI. Following your acknowledgment, you MUST ask a relevant follow-up question, such as "Would you like to see more details, add it to your cart, or keep browsing?". If the function call indicates the product was not found (`product_found: false`), you should inform the user you could not find the product and offer to search again or help with something else. Do not repeat raw product data (like image URLs or full product objects) in your text response, as the card already displays this information.'),[m,g]=p.useState(""),[x,v]=p.useState([]),[w,_]=p.useState(null),[C,T]=p.useState(null),[R,A]=p.useState(!1),[E,I]=p.useState(null),N=p.useRef(null),k=p.useRef([]),j=p.useRef(null),D=p.useRef(null),[L,G]=p.useState(null),[B,W]=p.useState(!1),X=p.useRef(!1),H={name:"find_and_open_product",description:"Finds a product based on a query (name, keywords, or ID) and returns its details for display. It does NOT navigate. After displaying, ask if the user wants to navigate or add to cart.",parameters:{type:rt.OBJECT,properties:{product_query:{type:rt.STRING,description:"The name, keywords, or ID of the product to find."}},required:["product_query"]}},K={name:"navigate_to_product_detail_page",description:"Navigates the user to the detailed page for a specific product, given its ID.",parameters:{type:rt.OBJECT,properties:{product_id:{type:rt.STRING,description:"The unique ID of the product."},product_name:{type:rt.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},V={name:"add_to_cart",description:"Adds a specified product to the user's shopping cart.",parameters:{type:rt.OBJECT,properties:{product_id:{type:rt.STRING,description:"The unique ID of the product to add."},product_name:{type:rt.STRING,description:"The name of the product (for confirmation)."},quantity:{type:rt.NUMBER,description:"The quantity to add. Defaults to 1 if not specified."}},required:["product_id"]}},$={name:"initiate_purchase",description:"Initiates the purchase process for a specified product, potentially by adding to cart and navigating to checkout or directly to a payment page.",parameters:{type:rt.OBJECT,properties:{product_id:{type:rt.STRING,description:"The unique ID of the product to purchase."},product_name:{type:rt.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},z={name:"navigate_home",description:`Navigates the user to the application's home page (typically the root path "/").`,parameters:{type:rt.OBJECT,properties:{}}},F={name:"navigate_to_content_creation_page",description:"Navigates the user to the content creation page.",parameters:{type:rt.OBJECT,properties:{}}},Z={name:"navigate_to_store_dashboard",description:"Navigates the user to the store dashboard page.",parameters:{type:rt.OBJECT,properties:{}}},ce={name:"navigate_to_route",description:'Navigates the user to a specified route within the application. Use for requests like "go to a specific page". This is a generic navigation tool.',parameters:{type:rt.OBJECT,properties:{route:{type:rt.STRING,description:'The path to navigate to (e.g., "/", "/content-creation", "/dashboard").'}},required:["route"]}},le={name:"toggle_theme_mode",description:"Toggles the application's visual theme between light and dark mode.",parameters:{type:rt.OBJECT,properties:{}}},he={name:"open_import_store_dialog",description:"Opens the dialog or interface for importing a store from another platform.",parameters:{type:rt.OBJECT,properties:{}}},Le={name:"go_to_cart",description:"Navigates the user to their shopping cart page.",parameters:{type:rt.OBJECT,properties:{}}},$e=[H,K,V,$,ce,le,he,Le,z,F,Z],Be=()=>{var oe;(oe=j.current)==null||oe.scrollIntoView({behavior:"smooth"})};p.useEffect(Be,[x]);const ue=()=>c(!l),Ce=()=>d(!u),Ie=()=>{d(!1)},ve=(oe=null)=>{const _e=typeof oe=="string"?oe:m;if(_e.trim()==="")return;const ze=`user-text-${Date.now()}`;v(Te=>[...Te,{id:ze,role:"user",text:_e}]),typeof oe!="string"&&g(""),w==="gemini"&&C?ie(_e):console.error("Error: Gemini chat not active. Cannot send message.")},ie=async oe=>{if(!C){console.error("Gemini chat not initialized.");return}try{const _e=await C.sendMessageStream({message:[{text:oe}]}),ze=`assistant-gemini-${Date.now()}`;v(wt=>[...wt,{id:ze,role:"assistant",text:"",functionCallData:null}]);let Te="",Tt=null;for await(const wt of _e){let xt=null;wt.functionCalls&&wt.functionCalls.length>0?xt=wt.functionCalls[0]:wt.functionCall&&(xt=wt.functionCall),xt&&(Tt=xt);const pt=wt.text;pt&&(Te+=pt,v(Nt=>Nt.map(jn=>jn.id===ze?{...jn,text:Te}:jn)))}Tt?(v(wt=>wt.map(xt=>{if(xt.id===ze){let pt=`(Function call: ${Tt.name})`;Tt.name==="find_and_open_product"&&(pt="Searching for product");const Nt=Te.trim()===""?pt:`${Te}
${pt}`;return{...xt,text:Nt,functionCallData:Tt}}return xt})),await Ue(Tt,ze)):Te.trim()!==""||v(wt=>wt.map(xt=>xt.id===ze?{...xt,text:"(Assistant responded without text)"}:xt))}catch(_e){console.error("Error sending/receiving Gemini message:",_e)}},Me=oe=>{const _e=oe.route;if(_e)try{return t(_e),{success:!0,detail:`Successfully navigated to ${_e}`}}catch(ze){return console.error("Navigation error:",ze),{success:!1,detail:`Failed to navigate: ${ze.message}`}}return{success:!1,detail:"Route not provided in arguments."}},He=oe=>({success:!0,detail:"Theme toggled (placeholder action)."}),yt=oe=>({success:!0,detail:"Import store dialog would be shown (placeholder action)."}),kt=oe=>{try{return t("/cart"),{success:!0,detail:"Navigated to cart page."}}catch(_e){return console.error("Navigation to cart error:",_e),{success:!1,detail:`Failed to navigate to cart: ${_e.message}`}}},en=oe=>{var Tt,wt,xt,pt,Nt,jn,Sn,cr,sn;const _e=(Tt=oe.product_query)==null?void 0:Tt.toLowerCase().trim();if(!_e)return{success:!0,product_found:!1,detail:"Product query not provided."};if(!e||!e.products||e.products.length===0)return{success:!0,product_found:!1,detail:"No products available in the current store to search."};const ze=e.products;let Te=null;if(Te=ze.find(Vt=>{var tn;return((tn=Vt.name)==null?void 0:tn.toLowerCase())===_e}),!Te){const Vt=_e.split(/\s+/).filter(tn=>tn.length>1);if(Vt.length>0){let tn=ze.map(Zn=>{var Oe,tt;const Y=((Oe=Zn.name)==null?void 0:Oe.toLowerCase())||"",re=((tt=Zn.description)==null?void 0:tt.toLowerCase())||"";let ge=0;return Vt.forEach(J=>{Y.includes(J)&&(ge+=2),re.includes(J)&&(ge+=1)}),Y.includes(_e)&&(ge+=5),re.includes(_e)&&(ge+=2),{product:Zn,score:ge}});tn=tn.filter(Zn=>Zn.score>0).sort((Zn,Y)=>Y.score-Zn.score),tn.length>0&&(Te=tn[0].product)}}if(Te||/^[a-zA-Z0-9-_]+$/.test(_e)&&!_e.includes(" ")&&(Te=ze.find(Vt=>{var tn;return((tn=Vt.id)==null?void 0:tn.toString())===_e})),Te){let Vt=null;return(xt=(wt=Te.image)==null?void 0:wt.src)!=null&&xt.large&&typeof Te.image.src.large=="string"?Vt=Te.image.src.large:(Nt=(pt=Te.image)==null?void 0:pt.src)!=null&&Nt.medium&&typeof Te.image.src.medium=="string"?Vt=Te.image.src.medium:(Sn=(jn=Te.image)==null?void 0:jn.src)!=null&&Sn.small&&typeof Te.image.src.small=="string"?Vt=Te.image.src.small:Te.image_url&&typeof Te.image_url=="string"?Vt=Te.image_url:Te.imageUrl&&typeof Te.imageUrl=="string"?Vt=Te.imageUrl:Te.image&&typeof Te.image=="string"?Vt=Te.image:Te.images&&Array.isArray(Te.images)&&Te.images.length>0&&((cr=Te.images[0])!=null&&cr.src)&&typeof Te.images[0].src=="string"?Vt=Te.images[0].src:(sn=Te.featuredImage)!=null&&sn.url&&typeof Te.featuredImage.url=="string"&&(Vt=Te.featuredImage.url),Vt&&typeof Vt=="string"&&Vt.trim()!==""?Vt=Vt.trim():Vt=null,{success:!0,product_found:!0,product_data:{id:Te.id,name:Te.name,description:Te.description||"No description available.",price:Te.price||"Price not available.",imageUrl:Vt},detail:`Found product: ${Te.name}`}}else return{success:!0,product_found:!1,detail:`Could not find a matching or relevant product for query: "${oe.product_query}"`}},mn=oe=>oe.product_id&&e&&e.id?(t(`/store/${e.id}/product/${oe.product_id}`),{success:!0,detail:`Navigated to product page for ID ${oe.product_id} in store ${e.id}`}):!e||!e.id?{success:!1,detail:"Current store information is not available for navigation."}:{success:!1,detail:"Product ID not provided for navigation."},cn=oe=>{if(!e||!e.id)return{success:!1,detail:"Current store not available for cart operation."};if(!oe.product_id)return{success:!1,detail:"Product ID not provided to add to cart."};const _e=r(e.id,oe.product_id);if(_e){const ze=oe.quantity||1;return n(_e,e.id),ze>1&&s(oe.product_id,e.id,ze),{success:!0,detail:`${oe.product_name||_e.name||"Product"} added/updated in cart with quantity ${ze}.`}}else return{success:!1,detail:`Product with ID ${oe.product_id} not found.`}},fn=oe=>{const{product_id:_e,product_name:ze}=oe;if(!e||!e.id)return console.error("Buy Now: Current store not available."),{success:!1,detail:"Current store information is not available to initiate purchase."};if(!_e)return console.error("Buy Now: Product ID not provided."),{success:!1,detail:"Product ID not provided."};const Te=r(e.id,_e);if(!Te)return console.error(`Buy Now: Product with ID ${_e} not found.`),{success:!1,detail:`Product with ID ${_e} not found.`};try{return n(Te,e.id),t("/checkout",{state:{action:"buyNow",productToAddId:Te.id,storeId:e.id}}),{success:!0,detail:`Added ${Te.name||"product"} to cart and navigated to checkout.`}}catch(Tt){return console.error("Error during Buy Now (add to cart & navigate) process:",Tt),{success:!1,detail:Tt.message||"Could not process Buy Now action."}}},Ue=async(oe,_e)=>{let ze,Te=!1;switch(oe.name){case"navigate_to_route":ze=Me(oe.args),Te=ze.success;break;case"toggle_theme_mode":ze=He(oe.args),Te=ze.success;break;case"open_import_store_dialog":ze=yt(oe.args),Te=ze.success;break;case"go_to_cart":ze=kt(oe.args),Te=ze.success;break;case"navigate_home":ze=Me({route:"/"}),Te=ze.success;break;case"navigate_to_content_creation_page":ze=Me({route:"/content-creation"}),Te=ze.success;break;case"navigate_to_store_dashboard":ze=Me({route:"/dashboard"}),Te=ze.success;break;case"find_and_open_product":ze=en(oe.args),Te=ze.success;break;case"navigate_to_product_detail_page":ze=mn(oe.args),Te=ze.success;break;case"add_to_cart":ze=cn(oe.args),Te=ze.success;break;case"initiate_purchase":ze=fn(oe.args),Te=ze.success;break;default:ze={success:!1,detail:`Error: Unknown function ${oe.name}`}}if(!Te){console.error(`Function ${oe.name} execution failed: ${ze.detail}`),v(wt=>wt.map(xt=>xt.id===_e?{...xt,text:(xt.text.replace(/\(Function call: .*\)/,"").trim()+`
(Function ${oe.name} failed)`).trim(),functionCallData:null}:xt));return}const Tt={message:[{functionResponse:{name:oe.name,response:{result:ze}}}]};try{const wt=await C.sendMessageStream(Tt);let xt="";v(pt=>pt.map(Nt=>Nt.id===_e?{...Nt,text:"",functionCallData:null,productCardData:null}:Nt));for await(const pt of wt){if(pt.functionCalls||pt.functionCall){console.error("Model attempted another function call immediately after a function response.");break}const Nt=pt.text;Nt&&(xt+=Nt,v(jn=>jn.map(Sn=>{if(Sn.id===_e){const cr={...Sn,text:xt};return oe.name==="find_and_open_product"&&ze.success&&ze.product_found&&(cr.productCardData=ze.product_data),cr}return Sn})))}oe.name==="find_and_open_product"&&ze.success&&ze.product_found&&v(pt=>pt.map(Nt=>Nt.id===_e?{...Nt,productCardData:ze.product_data}:Nt)),xt.trim()===""&&(oe.name==="find_and_open_product"&&ze.product_found?v(pt=>pt.map(Nt=>Nt.id===_e&&Nt.text.trim()===""?{...Nt,text:"Here is the product information:"}:Nt)):v(pt=>pt.map(Nt=>Nt.id===_e&&Nt.text.trim()===""?{...Nt,text:"(Function processed)"}:Nt)))}catch(wt){console.error("Error sending function response or getting final response from Gemini:",wt),v(xt=>xt.map(pt=>pt.id===_e?{...pt,text:(pt.text+`
(Error processing function result)`).trim(),functionCallData:null}:pt))}},Et=async()=>{if(C||B)return;W(!0);const oe="AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s";try{const _e=new On({apiKey:oe}),Te=x.filter(xt=>xt.role==="user"||xt.role==="assistant").map(xt=>({role:xt.role==="assistant"?"model":"user",parts:[{text:xt.text||""}]})).filter(xt=>xt.parts.every(pt=>typeof pt.text=="string"&&pt.text.trim()!=="")),Tt={tools:[{functionDeclarations:$e}],systemInstruction:h},wt=_e.chats.create({model:"gemini-2.0-flash",history:Te,config:Tt,generationConfig:{}});if(!wt)throw new Error("genAI.chats.create() returned a null or undefined chat instance.");T(wt),_("gemini"),X.current=!1}catch(_e){console.error("Error initializing Gemini chat:",_e),T(null),_(null)}finally{W(!1)}},de=()=>{T(null),W(!1),_(null),X.current=!1};p.useEffect(()=>(l?!C&&!B&&Et():de(),()=>de()),[l]),p.useEffect(()=>{w==="gemini"?X.current?h&&!B&&C&&(T(null),X.current=!1,Et()):X.current=!0:X.current=!1},[h,w,B,C]);const De=(oe,_e)=>{mn({product_id:oe})},ee=(oe,_e)=>{if(!e||!e.id){console.error("Cannot add to cart: current store not available.");return}const ze=r(e.id,oe);ze?n(ze,e.id):console.error(`Product with ID ${oe} not found, cannot add to cart.`)},ae=async(oe,_e)=>{const ze=await fn({product_id:oe,product_name:_e});ze.success||console.error("Buy Now failed:",ze.detail)},Q=(oe,_e)=>{var ze;G({id:oe,name:_e}),(ze=D.current)==null||ze.click()},Pe=oe=>{var ze,Te,Tt,wt,xt,pt,Nt,jn;if(!oe)return null;let _e=null;return(Te=(ze=oe.image)==null?void 0:ze.src)!=null&&Te.large&&typeof oe.image.src.large=="string"?_e=oe.image.src.large:(wt=(Tt=oe.image)==null?void 0:Tt.src)!=null&&wt.medium&&typeof oe.image.src.medium=="string"?_e=oe.image.src.medium:(pt=(xt=oe.image)==null?void 0:xt.src)!=null&&pt.small&&typeof oe.image.src.small=="string"?_e=oe.image.src.small:oe.image_url&&typeof oe.image_url=="string"?_e=oe.image_url:oe.imageUrl&&typeof oe.imageUrl=="string"?_e=oe.imageUrl:oe.image&&typeof oe.image=="string"?_e=oe.image:oe.images&&Array.isArray(oe.images)&&oe.images.length>0&&((Nt=oe.images[0])!=null&&Nt.src)?_e=oe.images[0].src:(jn=oe.featuredImage)!=null&&jn.url&&(_e=oe.featuredImage.url),_e&&typeof _e=="string"&&_e.trim()!==""?_e.trim():null},Ae=async oe=>{var ze;const _e=(ze=oe.target.files)==null?void 0:ze[0];if(!_e||!L){G(null),D.current&&(D.current.value="");return}v(Te=>[...Te,{id:`system-visualizing-${Date.now()}`,role:"system",text:`Visualizing ${L.name} with your uploaded image. This may take a moment...`}]);try{console.log("[ChatViz] Getting product details for ID:",L.id);const Te=r(e.id,L.id);if(!Te)throw console.error("[ChatViz] Product not found for ID:",L.id),new Error("Product details not found for visualization.");console.log("[ChatViz] Product found:",Te.name);const Tt=Pe(Te);if(!Tt)throw console.error("[ChatViz] Product actual image URL is missing or invalid for product:",Te.name,"Raw product data:",Te),new Error("Product does not have a valid existing image to use for visualization context.");console.log("[ChatViz] Actual Product imageUrl to use:",Tt);const wt={name:Te.name,description:Te.description,imageSource:Tt},xt=`Visualize the product "${Te.name}" in a new scene inspired by the provided reference image. Focus on a creative and appealing composition.`;console.log("[ChatViz] Calling generateProductVisualization...");const pt=await vq({mainProduct:wt,referenceSceneSource:_e,additionalProducts:[],customInstructions:xt});if(console.log("[ChatViz] generateProductVisualization result:",pt),pt&&pt.imageUrl)v(Nt=>[...Nt,{id:`assistant-viz-${Date.now()}`,role:"assistant",text:pt.commentary||`Here's a new visualization for ${Te.name}:`,imageDataUrl:pt.imageUrl}]);else throw console.error("[ChatViz] generateProductVisualization did not return an imageUrl. Commentary:",pt==null?void 0:pt.commentary),new Error((pt==null?void 0:pt.commentary)||"Visualization did not return an image.")}catch(Te){console.error("Error during visualization in chat:",Te.name,Te.message,Te.stack),v(Tt=>[...Tt,{id:`error-viz-${Date.now()}`,role:"system",text:`Sorry, I couldn't visualize the product. Error: ${Te.name} - ${Te.message}`}])}finally{G(null),D.current&&(D.current.value="")}},Ve=async()=>{if(R)N.current&&N.current.state==="recording"&&N.current.stop(),A(!1);else try{const oe=await navigator.mediaDevices.getUserMedia({audio:!0});N.current=new MediaRecorder(oe),k.current=[],N.current.ondataavailable=_e=>{k.current.push(_e.data)},N.current.onstop=async()=>{const _e=new Blob(k.current,{type:"audio/webm"});k.current=[],console.log("Audio recorded:",_e),v(ze=>[...ze,{id:`user-audio-${Date.now()}`,role:"user",text:"[User sent audio]"}]),setTimeout(()=>{const ze=`assistant-audio-${Date.now()}`;v(Te=>[...Te,{id:ze,role:"assistant",text:"[Assistant audio response]"}])},2e3)},N.current.start(),A(!0),v(_e=>[..._e,{id:`system-rec-${Date.now()}`,role:"system",text:"Recording started..."}])}catch(oe){console.error("Error accessing microphone:",oe),v(_e=>[..._e,{id:`error-mic-${Date.now()}`,role:"system",text:"Error: Could not access microphone."}])}};return p.useEffect(()=>()=>{E&&E.context.state!=="closed"&&E.context.close(),N.current&&N.current.stream&&N.current.stream.getTracks().forEach(oe=>oe.stop())},[E]),a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"file",ref:D,style:{display:"none"},accept:"image/*",onChange:Ae}),!l&&a.jsx(O,{onClick:ue,className:"fixed bottom-[96px] right-0 py-4 pl-4 pr-1.5 shadow-lg z-50 rounded-tl-[20px] rounded-bl-[20px] rounded-tr-none rounded-br-none",size:"icon","aria-label":"Open Chatbot",style:{backgroundColor:((qe=e==null?void 0:e.theme)==null?void 0:qe.primaryColor)||"#007bff"},children:a.jsx(Mie,{size:20})}),l&&a.jsxs(Xe,{className:"fixed bottom-[96px] right-4 w-full max-w-md h-[70vh] max-h-[600px] shadow-xl z-[1000] flex flex-col bg-background border rounded-lg",children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between p-3 border-b",children:[a.jsx(ut,{className:"text-md font-semibold",children:"AI Assistant"}),a.jsxs("div",{className:"flex items-center gap-1",children:[(o==="admin"||i==="edit")&&a.jsx(O,{variant:"ghost",size:"icon",onClick:Ce,title:"Set Knowledge Base",children:a.jsx(Gie,{size:18})}),a.jsx(O,{variant:"ghost",size:"icon",onClick:ue,title:"Close Chat",children:a.jsx(Wi,{size:18})})]})]}),u&&a.jsxs("div",{className:"p-3 border-b bg-muted/40",children:[a.jsx("label",{htmlFor:"knowledgeBaseInput",className:"text-xs font-medium mb-1 block text-muted-foreground",children:"Knowledge Base (Instructions for Gemini)"}),a.jsx(En,{id:"knowledgeBaseInput",placeholder:"Enter instructions for the assistant...",value:h,onChange:oe=>f(oe.target.value),className:"h-28 text-xs mb-2 rounded-md"}),a.jsx(O,{onClick:Ie,size:"sm",className:"w-full",disabled:B||!C,children:"Save & Apply Instructions"})]}),a.jsxs(at,{className:"flex-grow p-3 overflow-y-auto space-y-3",children:[x.map(oe=>(oe.role==="user"||oe.role==="assistant")&&a.jsx("div",{className:`flex flex-col ${oe.role==="user"?"items-end":"items-start"}`,children:a.jsx("div",{className:`max-w-[80%] p-2.5 rounded-lg text-sm ${oe.role==="user"?"bg-primary text-primary-foreground rounded-br-none":"bg-muted rounded-bl-none"}`,children:oe.role==="assistant"?a.jsxs(a.Fragment,{children:[oe.productCardData&&a.jsx(Dke,{productData:oe.productCardData,onViewDetails:De,onAddToCart:ee,onBuyNow:ae,onVisualize:oe.productCardData.imageUrl&&typeof oe.productCardData.imageUrl=="string"&&oe.productCardData.imageUrl.trim()!==""?Q:null}),oe.imageDataUrl&&a.jsx("img",{src:oe.imageDataUrl,alt:"Generated visualization",className:"max-w-full h-auto rounded-md my-2"}),oe.text&&a.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert ${oe.productCardData||oe.imageDataUrl?"mt-2":""}`,children:a.jsx(Pke,{children:oe.text})}),!oe.productCardData&&!oe.text&&!oe.imageDataUrl&&a.jsx("p",{className:"whitespace-pre-wrap",children:"(Assistant message)"})]}):a.jsx("p",{className:"whitespace-pre-wrap",children:oe.text})})},oe.id)),a.jsx("div",{ref:j})]}),a.jsx(md,{className:"p-3 border-t",children:a.jsxs("div",{className:"flex w-full items-center gap-2",children:[a.jsx(O,{onClick:Ve,size:"icon",variant:R?"destructive":"outline",title:R?"Stop Recording":"Start Recording",disabled:!w||B,className:"p-2",children:R?a.jsx(qie,{size:18}):a.jsx(Lie,{size:18})}),a.jsx(En,{placeholder:R?"Recording audio...":"Type a message or use microphone...",value:m,onChange:oe=>g(oe.target.value),onKeyPress:oe=>{oe.key==="Enter"&&!oe.shiftKey&&(oe.preventDefault(),ve())},className:"flex-grow resize-none text-sm p-2 rounded-md min-h-[40px] max-h-[100px]",rows:1,disabled:!w||B||R}),a.jsx(O,{onClick:()=>ve(),size:"icon",title:"Send Message",disabled:!m.trim()||!w||B||R,children:a.jsx(zie,{size:18})})]})})]})]})};function Oke({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const Vke=p.forwardRef(Oke),$ke=Vke;function Uke({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"}))}const Bke=p.forwardRef(Uke),zke=Bke,zn=({initialText:t,onSave:e,isAdmin:n,placeholder:r="Enter text...",as:s="span",className:i="",textClassName:o="",inputClassName:l="",useTextarea:c=!1})=>{const[u,d]=p.useState(!1),[h,f]=p.useState(t),m=p.useRef(null);p.useEffect(()=>{f(t)},[t]),p.useEffect(()=>{u&&m.current&&(m.current.focus(),m.current.select(),c&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`))},[u,c]);const g=()=>{e&&e(h),d(!1)},x=_=>{f(_.target.value),c&&m.current&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`)},v=_=>{_.key==="Enter"&&!c?g():_.key==="Escape"&&(f(t),d(!1))},w=s;return n?a.jsx(w,{className:`inline-text-edit-container relative group ${i} ${u?"w-full":""}`,children:u?a.jsxs("div",{className:"flex items-start space-x-1 w-full",children:[" ",c?a.jsx("textarea",{ref:m,value:h,onChange:x,onKeyDown:v,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none resize-none overflow-hidden bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r,rows:1}):a.jsx("input",{ref:m,type:"text",value:h,onChange:x,onKeyDown:v,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r}),a.jsx("button",{onClick:g,className:"p-1 text-green-500 hover:text-green-700 flex-shrink-0",title:"Save",children:a.jsx($ke,{className:"h-5 w-5"})})]}):a.jsxs("div",{className:`flex items-center space-x-1 cursor-pointer w-full ${o}`,onClick:()=>d(!0),role:"button",tabIndex:0,onKeyDown:_=>{_.key==="Enter"&&d(!0)},children:[a.jsx("span",{className:"flex-grow",children:h||r}),a.jsx(zke,{className:"h-4 w-4 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]})}):a.jsx(w,{className:o,children:h||r})},Gke=({store:t,isPublishedView:e=!1})=>{var f;const{updateStore:n}=Vn(),r=(t==null?void 0:t.name)||"Our Store",s=t==null?void 0:t.id,i=!e,o={title:`The ${r} Way`,subtitle:"Discover the core values that make us unique.",items:[{emoji:"",icon:Er,title:"Quality First",description:"We prioritize premium materials and craftsmanship in every product."},{emoji:"",icon:kie,title:"Sustainable Practices",description:"Committed to eco-friendly sourcing and ethical production."},{emoji:"",icon:D3,title:"Innovative Design",description:"Blending timeless styles with modern, cutting-edge aesthetics."},{emoji:"",icon:C3,title:"Customer Love",description:"Our customers are at the heart of everything we do."}]},l=((f=t==null?void 0:t.content)==null?void 0:f.storeWay)||o,c=l.items&&l.items.length>0?l.items:o.items,u=async(m,g,x=null)=>{if(!s)return;let v={title:l.title,subtitle:l.subtitle,items:[...c].map(w=>({...w}))};x!==null&&v.items[x]?m==="itemTitle"?v.items[x].title=g:m==="itemDescription"?v.items[x].description=g:m==="itemEmoji"&&(v.items[x].emoji=g):m==="title"?v.title=g:m==="subtitle"&&(v.subtitle=g);try{await n(s,{content:{...t.content,storeWay:v}})}catch(w){console.error(`Failed to update store way content for ${m}:`,w)}},d=({item:m})=>{const g=m.icon||R3;return a.jsx(g,{className:"w-8 h-8 mb-4 text-[var(--theme-primary)]"})},h=(t==null?void 0:t.template_version)||"classic";return a.jsx("section",{className:"py-16 md:py-24 bg-background",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs(Pt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12 md:mb-16",children:[a.jsx("div",{className:`inline-flex items-center justify-center bg-[var(--theme-primary-10)] p-3 mb-4 ${h!=="sleek"?"rounded-full":""}`,children:a.jsx(Yv,{className:"h-8 w-8 text-[var(--theme-primary)]"})}),a.jsx(zn,{initialText:l.title,onSave:m=>u("title",m),isAdmin:i,placeholder:"Section Title",as:"h2",textClassName:"text-4xl md:text-5xl font-bold tracking-tight text-foreground"}),a.jsx(zn,{initialText:l.subtitle,onSave:m=>u("subtitle",m),isAdmin:i,placeholder:"Section Subtitle",as:"p",textClassName:"text-lg text-muted-foreground max-w-xl mx-auto mt-3"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:c.map((m,g)=>a.jsxs(Pt.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4,delay:g*.1+.2},className:`bg-card p-6 shadow-lg text-center border border-border/50 hover:shadow-2xl transition-shadow ${h!=="sleek"?"rounded-xl":""}`,children:[a.jsxs("div",{className:"flex justify-center items-center mb-4",children:[i?a.jsx(zn,{initialText:m.emoji,onSave:x=>u("itemEmoji",x,g),isAdmin:i,placeholder:"",textClassName:"text-4xl"}):a.jsx("span",{className:"text-4xl",children:m.emoji}),!m.emoji&&a.jsx(d,{item:m})]}),a.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:a.jsx(zn,{initialText:m.title,onSave:x=>u("itemTitle",x,g),isAdmin:i,placeholder:"Item Title"})}),a.jsx("p",{className:"text-muted-foreground text-sm",children:a.jsx(zn,{initialText:m.description,onSave:x=>u("itemDescription",x,g),isAdmin:i,placeholder:"Item Description",useTextarea:!0})})]},g))})]})})},bq="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t",Wke="https://api.pexels.com/videos",Hke="https://api.pexels.com/v1";async function _q(t,e=15){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=t.split(" ")[0],r=`${Wke}/search?query=${encodeURIComponent(n)}&per_page=${e}`;try{const s=await fetch(r,{headers:{Authorization:bq}});if(!s.ok){const d=await s.json().catch(()=>({message:s.statusText}));return console.error("Pexels API error:",s.status,d),{error:`Pexels API error: ${d.message||s.statusText}`}}const i=await s.json();if(!i.videos||i.videos.length===0)return{videos:[],totalResults:0};const o=Math.floor(Math.random()*i.videos.length),l=i.videos[o],c=l.video_files.find(d=>d.file_type==="video/mp4"&&(d.quality==="hd"||d.quality==="sd"))||l.video_files.find(d=>d.file_type==="video/mp4");return{video:{id:l.id,width:l.width,height:l.height,duration:l.duration,imageUrl:l.image,videoUrl:c?c.link:l.video_files[0]?l.video_files[0].link:null,photographer:l.user.name,pexelsUrl:l.url},totalResults:i.total_results}}catch(s){return console.error("Error fetching from Pexels API:",s),{error:`Network error or other issue fetching Pexels videos: ${s.message}`}}}async function qke(t,e=9){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=`${Hke}/search?query=${encodeURIComponent(t)}&per_page=${e}`;try{const r=await fetch(n,{headers:{Authorization:bq}});if(!r.ok){const o=await r.json().catch(()=>({message:r.statusText}));return console.error("Pexels API error:",r.status,o),{error:`Pexels API error: ${o.message||r.statusText}`}}const s=await r.json();return{photos:s.photos.map(o=>({id:o.id,width:o.width,height:o.height,src:o.src.medium,alt:o.alt,photographer:o.photographer,pexelsUrl:o.url})),totalResults:s.total_results,page:s.page,perPage:s.per_page}}catch(r){return console.error("Error fetching from Pexels API:",r),{error:`Network error or other issue fetching Pexels photos: ${r.message}`}}}const Kke=({open:t,onOpenChange:e,storeId:n,currentVideoUrl:r,onVideoReplaced:s})=>{const[i,o]=p.useState("ai"),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState(null),[m,g]=p.useState(""),[x,v]=p.useState(null),[w,_]=p.useState(!1),[C,T]=p.useState(null),[R,A]=p.useState(null),[E,I]=p.useState(null),[N,k]=p.useState(!1);p.useEffect(()=>{t&&(c(""),d(!1),f(null),g(""),v(null),_(!1),T(null),A(null),I(null),k(!1))},[t]);const j=async()=>{if(!l.trim()){f("Please enter a prompt for the video.");return}d(!0),f(null);try{console.log(`Generating video for store ${n} with prompt: "${l}"`);const W=await Nae(l);s&&s(W),e(!1),c("")}catch(W){console.error("Error generating video with AI:",W),f(W.message||"Failed to generate video. Please try again.")}finally{d(!1)}},D=async()=>{if(!m.trim()){T("Please enter a search query for Pexels.");return}_(!0),T(null),v(null);try{const W=await _q(m);W.error?T(W.error):W.video?v(W.video):T("No video found for your query.")}catch(W){console.error("Error searching Pexels videos:",W),T(W.message||"Failed to search Pexels. Please try again.")}finally{_(!1)}},L=W=>{s&&W?(s(W),e(!1)):T("Invalid video URL selected or replacement handler missing.")},G=W=>{const X=W.target.files[0];if(X){if(X.size>50*1024*1024){I("File is too large. Please select a video under 50MB."),A(null);return}if(!X.type.startsWith("video/")){I("Invalid file type. Please select a video file."),A(null);return}A(X),I(null)}},B=()=>{if(R&&s){k(!0),I(null);const W=new FileReader;W.onloadend=()=>{s(W.result),e(!1),A(null),k(!1)},W.onerror=()=>{I("Failed to read video file for upload."),k(!1)},W.readAsDataURL(R)}else I("No video file selected or replacement handler missing.")};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs($r,{className:"sm:max-w-[672px]",children:[a.jsxs(Ur,{className:"text-left",children:[a.jsx(Br,{children:"Replace Hero Video"}),a.jsxs(Ji,{className:"text-left",children:["Current video: ",a.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline truncate block max-w-full",children:r||"No video set"})]})]}),a.jsxs(bi,{value:i,onValueChange:o,className:"w-full",children:[a.jsxs(ei,{className:"grid w-full grid-cols-3",children:[" ",a.jsx($t,{value:"ai",children:"AI Generation (Veo)"}),a.jsx($t,{value:"pexels",children:"Search Pexels"}),a.jsx($t,{value:"upload",children:"Upload Video"})," "]}),a.jsxs(Ut,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"aiPrompt",className:"text-left block mb-1",children:"AI Video Prompt"}),a.jsx(Je,{id:"aiPrompt",value:l,onChange:W=>c(W.target.value),placeholder:"e.g., A futuristic cityscape at sunset",disabled:u})]}),h&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:h}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:u,children:"Cancel"}),a.jsx(O,{onClick:j,disabled:u||!l.trim(),children:u?"Generating...":"Generate Video"})]})]}),a.jsxs(Ut,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{id:"pexelsQuery",value:m,onChange:W=>g(W.target.value),placeholder:"e.g., Nature, Business, Technology",disabled:w,className:"flex-grow"}),a.jsx(O,{onClick:D,disabled:w||!m.trim(),children:w?"Searching...":"Search"})]}),C&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:C}),w&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels video..."}),!w&&x&&a.jsx("div",{className:"flex justify-center",children:a.jsxs("div",{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border hover:border-primary w-full max-w-md",onClick:()=>L(x.videoUrl),children:[a.jsx("img",{src:x.imageUrl,alt:`Pexels video by ${x.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-lg font-semibold text-center p-2 bg-black/50 rounded",children:"Use This Video"})})]})}),a.jsx(Ar,{className:"justify-start pt-4",children:a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:w,children:"Cancel"})})]}),a.jsxs(Ut,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"video-upload-input",className:"text-left block mb-1",children:"Select Video File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(Je,{id:"video-upload-input",type:"file",accept:"video/*",onChange:G,className:"flex-grow",disabled:N})}),R&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",R.name," (",(R.size/1024/1024).toFixed(2)," MB)"]}),E&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:E})]}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:N,children:"Cancel"}),a.jsx(O,{onClick:B,disabled:N||!R,children:N?"Uploading...":"Confirm Upload"})]})]})]})]})})},Yke=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),Jke=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageSelected:r,imageSearchContext:s="image",modalTitle:i="Change Image",storeName:o="your store"})=>{const{toast:l}=vs(),[c,u]=p.useState("search"),[d,h]=p.useState(s),[f,m]=p.useState([]),[g,x]=p.useState(!1),[v,w]=p.useState(`A visually appealing ${s} for ${o}`),_=async()=>{if(d.trim()){x(!0),m([]);try{const A=await ro(d,9,"landscape");m(A.map(E=>({id:E.id.toString(),src:{medium:E.src.large,large:E.src.large},alt:E.alt||d,photographer:E.photographer})))}catch(A){l({title:"Pexels Search Failed",description:A.message,variant:"destructive"})}x(!1)}},C=async()=>{if(v.trim()){x(!0),m([]);try{const A=await A0(v);if(A&&A.url)m([{id:Ft(),src:{medium:A.url,large:A.url},alt:A.alt||v,photographer:"Generated by AI"}]),l({title:"AI Image Generated",description:"Select the image below or generate more."});else throw new Error("AI did not return an image URL.")}catch(A){l({title:"AI Image Generation Failed",description:A.message,variant:"destructive"})}x(!1)}},T=async A=>{const E=A.target.files[0];if(E){x(!0);try{const I=await Yke(E);r(I),l({title:"Image Uploaded",description:"Your image has been selected."}),e(!1)}catch{l({title:"Upload Failed",description:"Could not process the uploaded file.",variant:"destructive"})}x(!1)}},R=A=>{r(A),e(!1)};return p.useEffect(()=>{t&&(h(s||"abstract background"),w(`A visually appealing ${s||"image"} for ${o||"a store"}`),m([]),u("search"))},[t,s,o]),a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs($r,{className:"sm:max-w-2xl md:max-w-3xl lg:max-w-4xl",children:[a.jsx(Ur,{children:a.jsx(Br,{children:i})}),a.jsxs("div",{className:"py-4",children:[a.jsxs(bi,{value:c,onValueChange:u,className:"w-full",children:[a.jsxs(ei,{className:"grid w-full grid-cols-3",children:[a.jsx($t,{value:"search",children:"Search Pexels"}),a.jsx($t,{value:"ai",children:"Generate with AI"}),a.jsx($t,{value:"upload",children:"Upload"})]}),a.jsx(Ut,{value:"search",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{placeholder:"Search for images on Pexels...",value:d,onChange:A=>h(A.target.value),onKeyPress:A=>A.key==="Enter"&&_()}),a.jsxs(O,{onClick:_,disabled:g||!d.trim(),children:[g?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(ju,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Search"})]})]})}),a.jsx(Ut,{value:"ai",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{placeholder:"Describe the image you want AI to generate...",value:v,onChange:A=>w(A.target.value),onKeyPress:A=>A.key==="Enter"&&C()}),a.jsxs(O,{onClick:C,disabled:g||!v.trim(),children:[g?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(wa,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Generate"})]})]})}),a.jsxs(Ut,{value:"upload",className:"mt-4",children:[a.jsx(Re,{htmlFor:"image-upload-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload your own image:"}),a.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Lo,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[a.jsxs("label",{htmlFor:"image-upload-input-file",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-primary hover:text-primary-focus focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-ring",children:[a.jsx("span",{children:"Upload a file"}),a.jsx(Je,{id:"image-upload-input-file",name:"image-upload-input-file",type:"file",className:"sr-only",accept:"image/*",onChange:T})]}),a.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB"})]})})]})]}),g&&f.length===0&&a.jsxs("div",{className:"text-center py-10",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin mx-auto text-primary"}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Fetching images..."})]}),f.length>0&&a.jsx(ScrollArea,{className:"mt-4 max-h-[50vh]",children:a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 p-1",children:f.map(A=>a.jsxs(Pt.div,{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>R(A.src.large||A.src.medium),whileHover:{scale:1.03},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[a.jsx("img",{src:A.src.medium,alt:A.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(Xke,{className:"h-10 w-10 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] p-1 truncate text-center",children:A.photographer||A.alt||"Untitled"})]},A.id))})})]}),a.jsx(Ar,{children:a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",children:"Cancel"})})})]})})},Xke=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),Qke=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");e({base64ImageData:i,mimeType:o[1]})}catch(r){n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o=s.toDataURL("image/png"),l="image/png";(!o||o.length<100)&&(o=s.toDataURL("image/jpeg"),l="image/jpeg");const c=o.split(",");e({base64ImageData:c[1],mimeType:l})}catch(o){n(new Error("Canvas toDataURL failed: "+o.message))}},r.onerror=()=>n(new Error("Failed to load image from URL for conversion.")),r.src=t}}),Zke=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageEdited:r,imageContext:s="image",modalTitle:i="Edit Image with AI"})=>{const{toast:o}=vs(),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState("");p.useEffect(()=>{t&&n&&(f(n),c(""))},[t,n]);const m=async()=>{if(!l.trim()||!h){o({title:"Missing data",description:"Image or edit prompt is missing.",variant:"destructive"});return}d(!0);try{const{base64ImageData:g,mimeType:x}=await Qke(h),v=await $o(g,x,l);if(v&&v.editedImageData&&v.newMimeType){const w=`data:${v.newMimeType};base64,${v.editedImageData}`;r(w),o({title:"Image Edited",description:"Image updated with AI edit."}),e(!1)}else throw new Error((v==null?void 0:v.textResponse)||"AI did not return an edited image.")}catch(g){console.error("Error editing image:",g),o({title:"Image Edit Failed",description:g.message,variant:"destructive"})}d(!1)};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs($r,{className:"sm:max-w-md",children:[a.jsx(Ur,{children:a.jsx(Br,{children:i})}),a.jsxs("div",{className:"space-y-4 py-4",children:[h&&a.jsxs("div",{className:"flex flex-col items-center space-y-2 mb-4",children:[a.jsx("img",{src:h,alt:`Current ${s} to edit`,className:"max-h-48 w-auto object-contain rounded border"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Editing: Current ",s]})]}),a.jsx(Re,{htmlFor:"editPrompt",className:"text-left",children:"Edit Instruction:"}),a.jsx(En,{id:"editPrompt",placeholder:`e.g., 'make the background blue', 'add sparkles to the ${s}'`,value:l,onChange:g=>c(g.target.value),rows:3,className:"resize-none"})]}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",disabled:u,children:"Cancel"})}),a.jsxs(O,{onClick:m,disabled:u||!l.trim(),children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(wa,{className:"mr-2 h-4 w-4"}),"Apply Edit"]})]})]})})},Sq=({store:t,isPublishedView:e=!1})=>{var F,Z,ce,le,he,Le,$e,Be,ue,Ce,Ie;const{updateStore:n,updateStoreTextContent:r}=Vn(),[s,i]=p.useState(0),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[v,w]=p.useState(null),_=p.useRef(null),C={Shield:Wie,Truck:Zv,CreditCard:Po,Headphones:m2,Star:NI,Zap:D3,GlobeIcon:Ru,AwardIcon:vie,UsersIcon:j0,HeartIcon:C3,CheckCircle:fa,Sparkles:Er,ArrowRight:ku,Play:II,Pause:Vie,Package:Mi},T=whe(_,{once:!0,margin:"-100px"}),{scrollYProgress:R}=yhe({target:_,offset:["start end","end start"]}),A=yS(R,[0,1],[100,-100]),E=yS(R,[0,.2,.8,1],[0,1,1,0]),I=yS(R,[0,.2,.8,1],[.9,1,1,.9]),N=((F=t==null?void 0:t.theme)==null?void 0:F.primaryColor)||"#6366F1",k=t==null?void 0:t.id,j=!e,D={title:"An Exceptional Experience",subtitle:"We're committed to providing you with the best shopping experience through our premium services and customer-first approach.",items:[{emoji:"",iconName:"Zap",title:"Smart Solutions",description:"Innovative products designed for modern living and efficiency.",color:"#007AFF",stats:"Future Ready",image:"https://images.pexels.com/photos/373543/pexels-photo-373543.jpeg?auto=compress&cs=tinysrgb&w=600&q=80",videoUrl:""},{emoji:"",icon:Zv,title:"Fast Delivery",description:"Free shipping worldwide with express delivery options available.",color:"#3B82F6",stats:"2-3 Days",image:"https://images.unsplash.com/photo-1566576912321-d58ddd7a6088?w=600&q=80"},{emoji:"",icon:Po,title:"Easy Returns",description:"30-day hassle-free returns with full refund guarantee.",color:"#8B5CF6",stats:"30 Days",image:"https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=600&q=80"},{emoji:"",icon:m2,title:"24/7 Support",description:"Round-the-clock customer support via chat, email, and phone.",color:"#F59E0B",stats:"Always On",image:"https://images.unsplash.com/photo-1553484771-371a605b060b?w=600&q=80"}],secondaryItems:[{iconName:"GlobeIcon",title:"Global Reach",description:"Serving customers in 50+ countries"},{iconName:"AwardIcon",title:"Premium Quality",description:"Certified products with quality guarantee"},{iconName:"UsersIcon",title:"Community Driven",description:"Join 100K+ satisfied customers"},{iconName:"HeartIcon",title:"Eco-Conscious",description:"Sustainable packaging and practices"}],statsItems:[{iconName:"UsersIcon",number:"50K+",label:"Happy Customers"},{iconName:"ZapIcon",number:"99.9%",label:"Uptime"},{iconName:"HeadphonesIcon",number:"24/7",label:"Support"},{iconName:"StarIcon",number:"4.9",label:"Rating"}]},L=(Z=t==null?void 0:t.content)!=null&&Z.storeFeatures?{...D,...t.content.storeFeatures,items:t.content.storeFeatures.items&&t.content.storeFeatures.items.length>0?t.content.storeFeatures.items:D.items,secondaryItems:t.content.storeFeatures.secondaryItems&&t.content.storeFeatures.secondaryItems.length>0?t.content.storeFeatures.secondaryItems:D.secondaryItems,statsItems:t.content.storeFeatures.statsItems&&t.content.storeFeatures.statsItems.length>0?t.content.storeFeatures.statsItems:D.statsItems}:D,G=L.items&&L.items.length>0?L.items:D.items;p.useEffect(()=>{const ve=async()=>{const ie=G[s];if(ie&&!ie.videoUrl){const Me=ie.title||ie.description||"modern abstract motion";try{console.log(`[Modern StoreFeatures] Fetching Pexels video for active feature "${Me}"`);const He=await _q(Me);He&&He.video?(l(He.video.videoUrl),u(He.video.imageUrl)):(console.warn(`No Pexels video found for query: "${Me}". Clearing previous Pexels video.`),l(null),u(null))}catch(He){console.error(`Failed to fetch Pexels video for query "${Me}":`,He),l(null),u(null)}}else ie&&ie.videoUrl&&(l(null),u(null))};G&&G.length>0&&s<G.length&&ve()},[s,G]);const B=async(ve,ie)=>{!k||!j||console.log(`[ModernStoreFeatures] handleSaveText called with field: ${ve}, value: ${ie}. This might be redundant if InlineTextEdit is used.`)},W=ve=>{w(ve),m(!0)},X=async ve=>{if(k==null||v==null||!ve)return;const ie=JSON.parse(JSON.stringify(L));if(ie.items&&ie.items[v])ie.items[v].image=ve,ie.items[v].videoUrl="";else{console.error("Cannot update feature image: active feature item not found."),m(!1);return}try{await n(k,{content:{...t.content,storeFeatures:ie}})}catch(Me){console.error("Failed to update store with new feature image URL:",Me)}m(!1),w(null)},H=()=>h(!0),K=async ve=>{if(!k||!j||s===null||!G[s])return;const ie=JSON.parse(JSON.stringify(L));if(ie.items&&ie.items[s])ie.items[s].videoUrl=ve,ie.items[s].image="",l(null),u(null);else{console.error("Cannot update video URL: active feature item not found."),h(!1);return}try{await n(k,{content:{...t.content,storeFeatures:ie}})}catch(Me){console.error("Failed to update store with new feature video URL:",Me)}h(!1)},V={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},$={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.25,.46,.45,.94]}}},z={hidden:{opacity:0,x:-50},visible:{opacity:1,x:0,transition:{duration:.8,ease:[.25,.46,.45,.94]}}};return a.jsxs("section",{ref:_,className:"relative py-20 gradient-bg overflow-hidden",id:`features-${k}`,children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[a.jsx(Pt.div,{className:"absolute top-20 left-20 w-96 h-96 bg-primary/5 blur-3xl rounded-full",style:{backgroundColor:`${N}10`,y:A}}),a.jsx(Pt.div,{className:"absolute bottom-20 right-20 w-80 h-80 bg-secondary/5 blur-3xl rounded-full",style:{y:A}}),a.jsx(Pt.div,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-accent/5 blur-3xl rounded-full",animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{duration:8,repeat:1/0}})]}),a.jsxs(Pt.div,{className:"container mx-auto px-6 relative z-10",style:{opacity:E,scale:I},children:[a.jsxs(Pt.div,{variants:V,initial:"hidden",animate:T?"visible":"hidden",className:"text-center mb-20",children:[a.jsxs(Pt.div,{variants:$,className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-full text-sm font-medium mb-6",style:{color:N,borderColor:`${N}30`},children:[a.jsx(Er,{className:"w-4 h-4"}),a.jsx("span",{children:"Why Choose Us"})]}),a.jsx(Pt.h2,{variants:$,className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white mb-6 tracking-tight",children:a.jsx(zn,{initialText:L.title,onSave:ve=>B("title",ve),isAdmin:j,placeholder:"Section Title",as:"span",textClassName:"bg-gradient-to-r from-gray-900 via-primary to-gray-900 dark:from-white dark:via-primary dark:to-white bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(90deg, currentColor, ${N}, currentColor)`}})}),a.jsx(Pt.p,{variants:$,className:"text-xl text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:a.jsx(zn,{initialText:L.subtitle,onSave:ve=>B("subtitle",ve),isAdmin:j,placeholder:"Section Subtitle",as:"span"})})]}),a.jsxs(Pt.div,{variants:V,initial:"hidden",animate:T?"visible":"hidden",className:"grid lg:grid-cols-2 gap-16 mb-20",children:[a.jsx(Pt.div,{variants:z,className:"space-y-6",children:G.map((ve,ie)=>{const Me=ve.icon||Mi,He=s===ie;return a.jsx(Pt.div,{className:`p-6 rounded-3xl border transition-all duration-500 cursor-pointer ${He?"bg-white/20 dark:bg-black/20 border-white/30 dark:border-white/20 shadow-float-lg":"bg-white/10 dark:bg-black/10 border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15"}`,onClick:()=>i(ie),whileHover:{scale:1.02,y:-5},whileTap:{scale:.98},initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{delay:ie*.1},children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center shadow-lg text-3xl",style:{backgroundColor:ve.color||N+"30"},children:ve.emoji||a.jsx(Me,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.jsx(zn,{initialText:ve.title,onSave:yt=>B("itemTitle",yt),isAdmin:j,placeholder:"Feature Title"})}),ve.stats&&a.jsx(dg,{variant:"secondary",className:"text-xs font-medium",style:{backgroundColor:`${ve.color||N}20`,color:ve.color||N},children:ve.stats})]}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:a.jsx(zn,{initialText:ve.description,onSave:yt=>B("itemDescription",yt),isAdmin:j,placeholder:"Feature Description",useTextarea:!0})}),He&&a.jsx(Pt.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-white/20 dark:border-white/10",children:a.jsxs(O,{variant:"outline",size:"sm",className:"group",style:{borderColor:ve.color||N,color:ve.color||N},children:["Learn More",a.jsx(ku,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})})]})]})},ve.title+ie)})}),G[s]&&a.jsxs(Pt.div,{variants:$,className:"relative aspect-square lg:aspect-[4/3] rounded-3xl overflow-hidden shadow-float-lg group",children:[!e&&G[s]&&a.jsx("div",{className:"absolute top-3 left-3 z-20 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(ce=G[s])!=null&&ce.videoUrl||o?a.jsxs(O,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:H,title:"Replace Feature Video",children:[a.jsx(g2,{className:"h-4 w-4 mr-1"})," Replace Video"]}):a.jsxs(a.Fragment,{children:[a.jsxs(O,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>W(s),title:"Change Feature Image",children:[a.jsx(g2,{className:"h-4 w-4 mr-1"})," Change Image"]}),a.jsxs(O,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>{w(s),x(!0)},title:"Edit Feature Image with AI",children:[a.jsx(wa,{className:"h-4 w-4 mr-1"})," Edit with AI"]})]})}),(le=G[s])!=null&&le.videoUrl?a.jsx("video",{src:G[s].videoUrl,poster:G[s].image||c||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`feat-video-${s}`):o?a.jsx("video",{src:o,poster:c||((he=G[s])==null?void 0:he.image)||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`current-pexels-video-${s}`):(Le=G[s])!=null&&Le.image?a.jsx(Pt.img,{src:G[s].image,alt:G[s].title||"Modern feature image",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`feat-img-${s}`):a.jsx(Pt.img,{src:"https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=600",alt:"Default modern feature background",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`fallback-img-${s}`),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"}),a.jsx(Pt.div,{className:"absolute bottom-6 left-6 right-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:a.jsxs("div",{className:"bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-2xl p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:G[s].color||N+"30"},children:G[s].emoji||ht.createElement(G[s].icon||Mi,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold text-white",children:G[s].title}),G[s].stats&&a.jsx("p",{className:"text-sm text-gray-200",children:G[s].stats})]})]}),a.jsx("p",{className:"text-gray-200 text-sm leading-relaxed",children:G[s].description})]})},`overlay-${s}`),a.jsx(Pt.div,{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/20 dark:bg-black/20 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/30 dark:border-white/20 z-10",animate:{y:[-8,8,-8],rotate:[0,10,0]},transition:{duration:6,repeat:1/0},children:a.jsx(fa,{className:"w-12 h-12 text-green-400"})})]})]}),a.jsx(Pt.div,{variants:V,initial:"hidden",animate:T?"visible":"hidden",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16",children:(L.secondaryItems||[]).map((ve,ie)=>{const Me=C[ve.iconName]||Mi;return a.jsxs(Pt.div,{variants:$,className:"text-center p-6 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15 transition-all duration-300",whileHover:{scale:1.05,y:-5},children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center shadow-lg",style:{backgroundColor:N},children:a.jsx(Me,{className:"w-8 h-8 text-white"})}),a.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:a.jsx(zn,{initialText:ve.title,onSave:He=>B(`secondaryItemTitle.${ie}`,He),isAdmin:j,placeholder:"Feature Title"})}),a.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:a.jsx(zn,{initialText:ve.description,onSave:He=>B(`secondaryItemDescription.${ie}`,He),isAdmin:j,placeholder:"Feature Description",useTextarea:!0})})]},ve.title+ie)})}),a.jsx(Pt.div,{variants:V,initial:"hidden",animate:T?"visible":"hidden",className:"grid grid-cols-2 md:grid-cols-4 gap-8 p-8 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10",children:(L.statsItems||[]).map((ve,ie)=>{const Me=C[ve.iconName]||Mi;return a.jsxs(Pt.div,{variants:$,className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-xl flex items-center justify-center",style:{backgroundColor:`${N}20`},children:a.jsx(Me,{className:"w-6 h-6",style:{color:N}})}),a.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-1",children:a.jsx(zn,{initialText:ve.number,onSave:He=>B("statsItemNumber",He),isAdmin:j,placeholder:"Stat Number"})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:a.jsx(zn,{initialText:ve.label,onSave:He=>B("statsItemLabel",He),isAdmin:j,placeholder:"Stat Label"})})]},ve.label+ie)})})]}),!e&&k&&a.jsx(Kke,{open:d,onOpenChange:h,storeId:k,currentVideoUrl:(($e=G[s])==null?void 0:$e.videoUrl)||o,onVideoReplaced:K}),!e&&k&&v!==null&&G[v]&&a.jsx(Jke,{isOpen:f,onOpenChange:m,currentImageUrl:(Be=G[v])==null?void 0:Be.image,onImageSelected:ve=>X(ve),imageSearchContext:`feature image for ${((ue=G[v])==null?void 0:ue.title)||"section"}`,modalTitle:"Change Feature Image",storeName:t.name}),!e&&k&&v!==null&&G[v]&&a.jsx(Zke,{isOpen:g,onOpenChange:x,currentImageUrl:(Ce=G[v])==null?void 0:Ce.image,onImageEdited:ve=>X(ve),imageContext:`feature image for "${((Ie=G[v])==null?void 0:Ie.title)||"section"}"`,modalTitle:"Edit Feature Image with AI"})]})},eRe=Object.freeze(Object.defineProperty({__proto__:null,default:Sq},Symbol.toStringTag,{value:"Module"})),tRe=()=>{var We,nt;console.log("[StorePreview] Component mounted.");const{storeName:t,productHandle:e}=E0();console.log("[StorePreview] storeName from params:",t);const{getStoreByName:n,getStoreBySlug:r,getStoreById:s,currentStore:i,setCurrentStore:o,updateStore:l,viewMode:c,isLoadingStores:u,user:d}=Vn(),{toast:h}=vs(),[f,m]=p.useState(null),[g,x]=p.useState(!1),[v,w]=p.useState(null),[_,C]=p.useState(null),[T,R]=p.useState(null),[A,E]=p.useState(null),[I,N]=p.useState(null),[k,j]=p.useState(null),[D,L]=p.useState(null),[G,B]=p.useState(null),[W,X]=p.useState(null),[H,K]=p.useState(null),[V,$]=p.useState(null),[z,F]=p.useState(null),[Z,ce]=p.useState(null),[le,he]=p.useState(null),[Le,$e]=p.useState(null),[Be,ue]=p.useState(null),[Ce,Ie]=p.useState(null),[ve,ie]=p.useState(null),[Me,He]=p.useState(null),[yt,kt]=p.useState(null),[en,mn]=p.useState(null),[cn,fn]=p.useState(null),[Ue,Et]=p.useState(null),[de,De]=p.useState(null),[ee,ae]=p.useState(null),[Q,Pe]=p.useState(null),[Ae,Ve]=p.useState(null),[qe,oe]=p.useState(null),[_e,ze]=p.useState(null),[Te,Tt]=p.useState(null),[wt,xt]=p.useState(null),[pt,Nt]=p.useState(null),[jn,Sn]=p.useState(null),[cr,sn]=p.useState(null),[Vt,tn]=p.useState(null),[Zn,Y]=p.useState(null),[re,ge]=p.useState(null),[Oe,tt]=p.useState(null),[J,te]=p.useState(null),[me,q]=p.useState(null),[ne,be]=p.useState(null),[Ne,Ge]=p.useState(null),[Se,it]=p.useState(null),[st,Mt]=p.useState(null),[xn,Zr]=p.useState(null),[Dn,Gr]=p.useState(null),[bs,Si]=p.useState(null),[Vs,$s]=p.useState(null),[es,nn]=p.useState(null),[Cn,ni]=p.useState(null),[ri,Mn]=p.useState(null),[Us,xo]=p.useState(!1),[Ho,Jc]=p.useState(""),[cy,Na]=p.useState(!1),[xe,pe]=p.useState(!1);p.useEffect(()=>{(async()=>{if(!t||g)return;x(!0);let je=null;i&&i.urlSlug===t?je=i:(je=n(t),je||(je=await r(t))),je?(m(je),(!i||i.id!==je.id)&&o(je)):u||(h({title:"Store Not Found",description:`Could not find store with slug: ${t}`,variant:"destructive"}),m(null)),x(!1)})()},[t,u,g,i,n,r,o,h]),p.useEffect(()=>{const Ye=v||(f==null?void 0:f.template_version),je=document.documentElement;f&&f.theme?(f.theme.primaryColor?je.style.setProperty("--theme-primary-color",f.theme.primaryColor):je.style.removeProperty("--theme-primary-color"),f.theme.secondaryColor?je.style.setProperty("--theme-secondary-color",f.theme.secondaryColor):je.style.removeProperty("--theme-secondary-color"),Ye==="premium"?(je.style.setProperty("--premium-gradient-start-color",f.theme.primaryColor||"#667eea"),je.style.setProperty("--premium-gradient-end-color",f.theme.secondaryColor||"#764ba2")):(je.style.removeProperty("--premium-gradient-start-color"),je.style.removeProperty("--premium-gradient-end-color"))):(je.style.removeProperty("--theme-primary-color"),je.style.removeProperty("--theme-secondary-color"),je.style.removeProperty("--premium-gradient-start-color"),je.style.removeProperty("--premium-gradient-end-color"));let mt=!1;return Ye==="sharp"&&(je.classList.contains("dark")||(je.classList.add("dark"),mt=!0)),()=>{mt&&Ye!=="sharp"&&je.classList.contains("dark")}},[f==null?void 0:f.theme,f==null?void 0:f.template_version,v]),p.useEffect(()=>{if(f){const Ye=v||f.template_version||"classic";console.log(`[StorePreview] Loading components for template: ${Ye}`),Mt(null),Zr(null),Gr(null),Si(null),$s(null),nn(null),ni(null),Mn(null),C(null),R(null),E(null),N(null),j(null),L(null),B(null),X(null),K(null),$(null),F(null),ce(null),he(null),$e(null),ue(null),Ie(null),ie(null),He(null),kt(null),mn(null),fn(null),Et(null),De(null),ae(null),Pe(null),Ve(null),oe(null),ze(null),Tt(null),xt(null),Nt(null),Sn(null),sn(null),tn(null),Y(null),ge(null),tt(null),te(null),q(null),be(null),Ge(null),it(null),Ge(()=>Gke),it(()=>Sq),Ye==="classic"?(Mt(()=>p.lazy(()=>Ot(()=>Promise.resolve().then(()=>rRe),void 0))),Zr(()=>p.lazy(()=>Ot(()=>import("./StoreHero-50283d49.js"),[]))),Gr(()=>p.lazy(()=>Ot(()=>import("./StoreCollections-9830f73e.js"),["assets/StoreCollections-9830f73e.js","assets/CollectionProductsDialog-be74b4e7.js"]))),Si(()=>p.lazy(()=>Ot(()=>import("./ProductGrid-0713c903.js"),["assets/ProductGrid-0713c903.js","assets/list-dfd3e55d.js","assets/filter-7cf80729.js"]))),$s(()=>p.lazy(()=>Ot(()=>import("./StoreFeatures-3037717d.js"),["assets/StoreFeatures-3037717d.js","assets/shield-check-08a74731.js","assets/message-square-19e73daf.js"]))),nn(()=>p.lazy(()=>Ot(()=>import("./StoreTestimonials-40bd3c3d.js"),["assets/StoreTestimonials-40bd3c3d.js","assets/user-circle-b02e132d.js"]))),ni(()=>p.lazy(()=>Ot(()=>import("./StoreNewsletter-00cef38d.js"),[]))),Mn(()=>p.lazy(()=>Ot(()=>Promise.resolve().then(()=>sRe),void 0)))):Ye==="modern"?(C(()=>p.lazy(()=>Ot(()=>import("./StoreHeader-26f1c0af.js"),["assets/StoreHeader-26f1c0af.js","assets/minus-6d107af1.js"]))),R(()=>p.lazy(()=>Ot(()=>import("./StoreHero-7ee214fa.js"),[]))),E(()=>p.lazy(()=>Ot(()=>Promise.resolve().then(()=>eRe),void 0))),N(()=>p.lazy(()=>Ot(()=>import("./StoreCollections-bbeeb7aa.js"),[]))),j(()=>p.lazy(()=>Ot(()=>import("./ProductGrid-57cc063b.js"),["assets/ProductGrid-57cc063b.js","assets/minus-6d107af1.js","assets/crown-e35592e4.js","assets/list-dfd3e55d.js"]))),L(()=>p.lazy(()=>Ot(()=>import("./Footer-5ec4e900.js"),[])))):Ye==="premium"?(B(()=>p.lazy(()=>Ot(()=>import("./Header-ee0b0d1d.js"),[]))),X(()=>p.lazy(()=>Ot(()=>import("./Hero-cd8fe721.js"),[]))),K(()=>p.lazy(()=>Ot(()=>import("./FeaturedProducts-7fa08de4.js"),["assets/FeaturedProducts-7fa08de4.js","assets/minus-6d107af1.js","assets/crown-e35592e4.js","assets/list-dfd3e55d.js","assets/filter-7cf80729.js"]))),$(()=>p.lazy(()=>Ot(()=>import("./CategoryShowcase-59259229.js"),["assets/CategoryShowcase-59259229.js","assets/CollectionProductsDialog-be74b4e7.js"]))),F(()=>p.lazy(()=>Ot(()=>import("./SocialProof-b5e141a8.js"),[]))),ce(()=>p.lazy(()=>Ot(()=>import("./Newsletter-3b756f63.js"),[]))),he(()=>p.lazy(()=>Ot(()=>import("./Footer-7e1737e1.js"),[])))):Ye==="sharp"?($e(()=>p.lazy(()=>Ot(()=>import("./StoreHeader-84586bd8.js"),[]))),ue(()=>p.lazy(()=>Ot(()=>import("./StoreHero-7beb3324.js"),["assets/StoreHero-7beb3324.js","assets/ReplaceVideoModal-51ea5c95.js"]))),Ie(()=>p.lazy(()=>Ot(()=>import("./StoreFeatures-c863d2f3.js"),[]))),ie(()=>p.lazy(()=>Ot(()=>import("./ProductGrid-6546f757.js"),["assets/ProductGrid-6546f757.js","assets/list-dfd3e55d.js"]))),He(()=>p.lazy(()=>Ot(()=>import("./Testimonials-3608a2eb.js"),["assets/Testimonials-3608a2eb.js","assets/message-square-19e73daf.js","assets/user-circle-b02e132d.js"]))),kt(()=>p.lazy(()=>Ot(()=>import("./ImageRightSection-bc6eb3be.js"),[]))),mn(()=>p.lazy(()=>Ot(()=>import("./VideoLeftSection-340c5878.js"),["assets/VideoLeftSection-340c5878.js","assets/ReplaceVideoModal-51ea5c95.js"]))),fn(()=>p.lazy(()=>Ot(()=>import("./HeroFollowUpVideo-a28bb157.js"),["assets/HeroFollowUpVideo-a28bb157.js","assets/ReplaceVideoModal-51ea5c95.js"]))),Et(()=>p.lazy(()=>Ot(()=>import("./Newsletter-9fb71d86.js"),[]))),De(()=>p.lazy(()=>Ot(()=>import("./Footer-eabeeede.js"),[])))):Ye==="fresh"?(ae(()=>p.lazy(()=>Ot(()=>import("./StoreHeader-7607ff00.js"),[]))),Pe(()=>p.lazy(()=>Ot(()=>import("./StoreHero-c4003277.js"),[]))),Ve(()=>p.lazy(()=>Ot(()=>import("./StoreFeatures-38311a49.js"),[]))),oe(()=>p.lazy(()=>Ot(()=>import("./ProductGrid-eb70cffa.js"),["assets/ProductGrid-eb70cffa.js","assets/list-dfd3e55d.js"]))),ze(()=>p.lazy(()=>Ot(()=>import("./StoreCollections-09052080.js"),["assets/StoreCollections-09052080.js","assets/CollectionProductsDialog-be74b4e7.js"]))),Tt(()=>p.lazy(()=>Ot(()=>import("./Testimonials-6578853a.js"),["assets/Testimonials-6578853a.js","assets/user-circle-b02e132d.js"]))),xt(()=>p.lazy(()=>Ot(()=>import("./Newsletter-be592756.js"),[]))),Nt(()=>p.lazy(()=>Ot(()=>import("./Footer-a629b84e.js"),["assets/Footer-a629b84e.js","assets/shield-check-08a74731.js"])))):Ye==="sleek"&&(Sn(()=>p.lazy(()=>Ot(()=>import("./StoreHeader-f5a5387c.js"),[]))),sn(()=>p.lazy(()=>Ot(()=>import("./StoreHero-ff54182f.js"),[]))),tn(()=>p.lazy(()=>Ot(()=>import("./ProductGrid-c5ac619c.js"),["assets/ProductGrid-c5ac619c.js","assets/list-dfd3e55d.js","assets/filter-7cf80729.js"]))),Y(()=>p.lazy(()=>Ot(()=>import("./StoreFeatures-c7aa11fc.js"),[]))),ge(()=>p.lazy(()=>Ot(()=>import("./Testimonials-e6402b65.js"),["assets/Testimonials-e6402b65.js","assets/user-circle-b02e132d.js"]))),tt(()=>p.lazy(()=>Ot(()=>import("./Newsletter-a32c2eb9.js"),[]))),te(()=>p.lazy(()=>Ot(()=>import("./Footer-143524fd.js"),[]))),q(()=>p.lazy(()=>Ot(()=>import("./StoreCollections-e32a9ff7.js"),[]))),be(()=>p.lazy(()=>Ot(()=>import("./StoreWaySection-2827bc04.js"),[]))))}},[f==null?void 0:f.id,v]);const we=()=>{if(!f||!f.pass_key){Na(!0);return}pe(!0),setTimeout(()=>{Ho===f.pass_key?(Na(!0),h({title:"Access Granted",description:"Welcome to the store!"})):(h({title:"Access Denied",description:"Incorrect pass key.",variant:"destructive"}),Jc("")),pe(!1)},500)};if(u)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading store..."})]})});if(!f)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl text-destructive",children:"Store not found."})});if(!cy&&f.pass_key)return a.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 p-4",children:a.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-2xl w-full max-w-md text-center",children:[a.jsx(T3,{className:"h-16 w-16 text-primary mx-auto mb-6"}),a.jsx("h2",{className:"text-3xl font-bold text-card-foreground mb-3",children:"Protected Store"}),a.jsx("p",{className:"text-muted-foreground mb-8",children:"This store requires a pass key to view its content."}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(Je,{type:"password",placeholder:"Enter Pass Key",value:Ho,onChange:Ye=>Jc(Ye.target.value),className:"h-12 text-lg text-center bg-input border-border focus:ring-primary focus:border-primary",onKeyPress:Ye=>Ye.key==="Enter"&&we()}),a.jsx(O,{onClick:we,disabled:xe||!Ho.trim(),className:"h-12 text-lg w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:xe?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):a.jsxs(a.Fragment,{children:[a.jsx(Yie,{className:"mr-2 h-5 w-5"})," Access Store"]})})]})]})});const se=c==="published";let Ee=v;if(Ee||(Ee=(f==null?void 0:f.template_version)==="v1"||!(f!=null&&f.template_version)?"classic":f.template_version),console.log(`[StorePreview] Determined templateVersionToRender: ${Ee}. (previewTemplateVersion: ${v}, store.template_version: ${f==null?void 0:f.template_version})`),console.log(`[StorePreview] Rendering template: ${Ee}. Store products: ${((We=f==null?void 0:f.products)==null?void 0:We.length)||0}, collections: ${((nt=f==null?void 0:f.collections)==null?void 0:nt.length)||0}`),Ee==="classic"){if(!st||!xn||!Dn||!bs||!Vs||!es||!Cn||!ri)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Classic Template Components..."})]})})}else if(Ee==="modern"){if(!_||!T||!A||!I||!k||!D)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Modern Template Components..."})]})})}else if(Ee==="premium"){if(!G||!W||!H||!V||!z||!Z||!le)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Premium Template Components..."})]})})}else if(Ee==="sharp"){if(!Le||!Be||!cn||!Ce||!ve||!Me||!yt||!en||!Ue||!de)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Sharp Template Components..."})]})})}else if(Ee==="sleek"){if(!jn||!cr||!Vt||!me||!Zn||!re||!Oe||!J)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Sleek Template Components..."})]})})}else if(Ee==="fresh"&&(!ee||!Q||!Ae||!qe||!_e||!wt||!pt))return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Fresh Template Components..."})]})});return a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(p.Suspense,{fallback:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:"Loading Store Content..."}),children:Ee==="classic"?a.jsxs(ht.Fragment,{children:[st&&a.jsx(st,{store:f,isPublishedView:se}),xn&&a.jsx(xn,{store:f,isPublishedView:se}),bs&&a.jsx(bs,{store:f,isPublishedView:se}),Dn&&a.jsx(Dn,{store:f,isPublishedView:se}),Se&&a.jsx(Se,{store:f,isPublishedView:se}),Ne&&a.jsx(Ne,{store:f,isPublishedView:se}),es&&a.jsx(es,{store:f,isPublishedView:se}),Cn&&a.jsx(Cn,{store:f,isPublishedView:se}),ri&&a.jsx(ri,{store:f,isPublishedView:se})]},"classic"):Ee==="modern"?a.jsx(ht.Fragment,{children:a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsxs("main",{className:"flex-1",children:[_&&a.jsx(_,{store:f,isPublishedView:se}),T&&a.jsx(T,{store:f,isPublishedView:se}),A?a.jsx(A,{store:f,isPublishedView:se}):Se&&a.jsx(Se,{store:f,isPublishedView:se}),k&&a.jsx(k,{store:f,products:(f==null?void 0:f.products)||[],isPublishedView:se}),I&&a.jsx(I,{store:f,isPublishedView:se}),Ne&&a.jsx(Ne,{store:f,isPublishedView:se})]}),a.jsx("footer",{className:"mt-auto",children:D&&a.jsx(D,{store:f,isPublishedView:se})})]})},"modern"):Ee==="premium"?a.jsxs(ht.Fragment,{children:[G&&a.jsx(G,{store:f,isPublishedView:se}),W&&a.jsx(W,{store:f,isPublishedView:se}),H&&a.jsx(H,{store:f,isPublishedView:se}),V&&a.jsx(V,{store:f,isPublishedView:se}),Se&&a.jsx(Se,{store:f,isPublishedView:se}),Ne&&a.jsx(Ne,{store:f,isPublishedView:se}),z&&a.jsx(z,{store:f,isPublishedView:se}),Z&&a.jsx(Z,{store:f,isPublishedView:se}),le&&a.jsx(le,{store:f,isPublishedView:se})]},"premium"):Ee==="sharp"?a.jsxs(ht.Fragment,{children:[Le&&a.jsx(Le,{store:f,isPublishedView:se}),Be&&a.jsx(Be,{store:f,isPublishedView:se}),cn&&a.jsx(cn,{store:f}),ve&&a.jsx(ve,{store:f,isPublishedView:se}),Ce?a.jsx(Ce,{store:f,isPublishedView:se}):Se&&a.jsx(Se,{store:f,isPublishedView:se}),Ne&&a.jsx(Ne,{store:f,isPublishedView:se}),yt&&a.jsx(yt,{store:f,isPublishedView:se}),en&&a.jsx(en,{store:f,isPublishedView:se}),Me&&a.jsx(Me,{store:f,isPublishedView:se}),Ue&&a.jsx(Ue,{store:f}),de&&a.jsx(de,{store:f})]},"sharp"):Ee==="fresh"?a.jsxs(ht.Fragment,{children:[ee&&a.jsx(ee,{store:f,isPublishedView:se}),Q&&a.jsx(Q,{store:f,isPublishedView:se}),qe&&a.jsx(qe,{store:f,isPublishedView:se})," ",_e&&a.jsx(_e,{store:f,isPublishedView:se})," ",Ae?a.jsx(Ae,{store:f,isPublishedView:se}):Se&&a.jsx(Se,{store:f,isPublishedView:se}),Te&&a.jsx(Te,{store:f,isPublishedView:se}),Ne&&a.jsx(Ne,{store:f,isPublishedView:se}),wt&&a.jsx(wt,{store:f}),pt&&a.jsx(pt,{store:f})]},"fresh"):Ee==="sleek"?a.jsxs(ht.Fragment,{children:[jn&&a.jsx(jn,{store:f,isPublishedView:se}),cr&&a.jsx(cr,{store:f,isPublishedView:se}),Vt&&a.jsx(Vt,{store:f,isPublishedView:se}),me&&a.jsx(me,{store:f,isPublishedView:se}),Zn?a.jsx(Zn,{store:f,isPublishedView:se}):Se&&a.jsx(Se,{store:f,isPublishedView:se}),ne?a.jsx(ne,{store:f,isPublishedView:se}):Ne&&a.jsx(Ne,{store:f,isPublishedView:se}),re&&a.jsx(re,{store:f,isPublishedView:se}),Oe&&a.jsx(Oe,{store:f,isPublishedView:se}),J&&a.jsx(J,{store:f,isPublishedView:se})]},"sleek"):null}),d&&f&&d.uid===f.merchant_id&&a.jsx(H1e,{store:f,onEdit:()=>xo(!0),currentTemplate:v,onTemplateChange:w,availableTemplates:["classic","modern","premium","sharp","fresh","sleek"]}),!se&&f&&a.jsx(q1e,{store:f,open:Us,onOpenChange:xo,onStoreUpdate:Ye=>{m(je=>({...je,...Ye})),Ye.template_version&&Ye.template_version!==v&&w(Ye.template_version),(f&&f.id===Ye.id||i&&i.id===Ye.id)&&l(Ye.id,Ye)}}),a.jsx(wq,{storeId:f==null?void 0:f.id})," "]})},nRe=({open:t,onOpenChange:e,storeId:n,storeName:r,currentLogoUrlLight:s,currentLogoUrlDark:i,onLogoReplaced:o})=>{const[l,c]=p.useState("ai"),[u,d]=p.useState(r||""),[h,f]=p.useState(!1),[m,g]=p.useState(null),[x,v]=p.useState({light:null,dark:null}),[w,_]=p.useState(""),[C,T]=p.useState([]),[R,A]=p.useState(!1),[E,I]=p.useState(null),[N,k]=p.useState(null),[j,D]=p.useState(null),[L,G]=p.useState(!1),[B,W]=p.useState(null);p.useEffect(()=>{t&&(d(r||""),f(!1),g(null),v({light:null,dark:null}),_(""),T([]),A(!1),I(null),k(null),D(null),G(!1),W(null))},[t,r]);const X=async()=>{if(!r){g("Store name is required to generate a logo with AI.");return}f(!0),g(null),v({light:null,dark:null});try{console.log(`Generating light/dark logos for store ${r}`);const F=await Eg(r);F&&(F.logoUrlLight||F.logoUrlDark)?v({light:F.logoUrlLight,dark:F.logoUrlDark}):g(F.textResponse||"AI did not return sufficient image data for logos.")}catch(F){console.error("Error generating logos with AI:",F),g(F.message||"Failed to generate logos. Please try again.")}finally{f(!1)}},H=async()=>{if(!w.trim()){I("Please enter a search query for Pexels.");return}A(!0),I(null),T([]);try{const F=await qke(w);F.error?(I(F.error),T([])):(T(F.photos||[]),(F.photos||[]).length===0&&I("No images found for your query."))}catch(F){console.error("Error searching Pexels images:",F),I(F.message||"Failed to search Pexels. Please try again.")}finally{A(!1)}},K=F=>{o&&F?(o({logoUrlLight:F,logoUrlDark:F}),e(!1)):I("Invalid image URL selected or replacement handler missing.")},V=F=>{const Z=F.target.files[0];if(Z){if(Z.size>10*1024*1024){D("File is too large. Please select an image under 10MB."),k(null),W(null);return}if(!Z.type.startsWith("image/")){D("Invalid file type. Please select an image file (e.g., PNG, JPG, GIF)."),k(null),W(null);return}k(Z),D(null);const ce=new FileReader;ce.onloadend=()=>{W(ce.result)},ce.readAsDataURL(Z)}},$=()=>{if(N&&o){G(!0),D(null);const F=new FileReader;F.onloadend=()=>{const Z=F.result;o({logoUrlLight:Z,logoUrlDark:Z}),e(!1),k(null),W(null),G(!1)},F.onerror=()=>{D("Failed to read image file for upload."),G(!1)},F.readAsDataURL(N)}else D("No image file selected or replacement handler missing.")},z=()=>{x.light||x.dark?(o({logoUrlLight:x.light,logoUrlDark:x.dark}),e(!1)):g("No AI generated logos available to confirm.")};return a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs($r,{className:"sm:max-w-[728px]",children:[" ",a.jsxs(Ur,{className:"text-left",children:[a.jsx(Br,{children:"Change Store Logo"}),a.jsxs(Ji,{className:"text-left space-y-2",children:[a.jsx("p",{children:"Current Logos:"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"For Dark Backgrounds (Light Logo)"}),s?a.jsx("img",{src:s,alt:"Current light logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-gray-700 p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]}),a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"For Light Backgrounds (Dark Logo)"}),i?a.jsx("img",{src:i,alt:"Current dark logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-white p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]})]})]})]}),a.jsxs(bi,{value:l,onValueChange:c,className:"w-full",children:[a.jsxs(ei,{className:"grid w-full grid-cols-3",children:[a.jsx($t,{value:"ai",children:"Generate with AI"}),a.jsx($t,{value:"pexels",children:"Search Pexels"}),a.jsx($t,{value:"upload",children:"Upload Image"})]}),a.jsxs(Ut,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("p",{className:"text-sm text-muted-foreground",children:["AI will generate a logo based on your store name: ",a.jsx("strong",{children:r}),"."]}),m&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:m}),h&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Generating logos..."}),(x.light||x.dark)&&!h&&a.jsxs("div",{className:"flex flex-col items-center gap-4 mt-3",children:[a.jsx("p",{className:"text-sm font-medium",children:"Generated Previews:"}),a.jsxs("div",{className:"flex gap-4",children:[x.dark&&a.jsxs("div",{className:"text-center",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"For Light BG"}),a.jsx("img",{src:x.dark,alt:"AI Generated Dark Logo",className:"h-24 w-24 object-contain border rounded-md bg-white p-1"})]}),x.light&&a.jsxs("div",{className:"text-center",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"For Dark BG"}),a.jsx("img",{src:x.light,alt:"AI Generated Light Logo",className:"h-24 w-24 object-contain border rounded-md bg-gray-700 p-1"})]})]})]}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:h,children:"Cancel"}),a.jsxs(O,{onClick:X,disabled:h||!r,children:[a.jsx(Yv,{className:"mr-2 h-4 w-4"}),h?"Generating...":x.light||x.dark?"Regenerate Logos":"Generate Logos"]}),(x.light||x.dark)&&a.jsx(O,{onClick:z,disabled:h,children:"Use These Logos"})]})]}),a.jsxs(Ut,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{id:"pexelsQuery",value:w,onChange:F=>_(F.target.value),placeholder:"e.g., Abstract, Minimal, Tech",disabled:R,className:"flex-grow"}),a.jsx(O,{onClick:H,disabled:R||!w.trim(),children:R?"Searching...":"Search Images"})]}),E&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:E}),R&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels images..."}),!R&&C.length>0&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3 max-h-[300px] overflow-y-auto pr-2",children:C.map(F=>a.jsxs("div",{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border hover:border-primary",onClick:()=>K(F.src.large2x||F.src.large||F.src.original),children:[a.jsx("img",{src:F.src.medium,alt:F.alt||`Pexels image by ${F.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-xs text-center p-1 bg-black/50 rounded",children:"Use Image"})})]},F.id))}),a.jsx(Ar,{className:"justify-start pt-4",children:a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:R,children:"Cancel"})})]}),a.jsxs(Ut,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"image-upload-input",className:"text-left block mb-1",children:"Select Image File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(Je,{id:"image-upload-input",type:"file",accept:"image/*",onChange:V,className:"flex-grow",disabled:L})}),B&&a.jsxs("div",{className:"mt-3 flex flex-col items-center",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Preview:"}),a.jsx("img",{src:B,alt:"Upload preview",className:"h-32 w-32 object-contain border rounded-md"})]}),N&&!B&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",N.name," (",(N.size/1024/1024).toFixed(2)," MB)"]}),j&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:j})]}),a.jsxs(Ar,{className:"justify-start pt-4",children:[a.jsx(O,{variant:"outline",onClick:()=>e(!1),disabled:L,children:"Cancel"}),a.jsx(O,{onClick:$,disabled:L||!N,children:L?"Uploading...":"Confirm Upload"})]})]})]})]})})},Cq=({store:t,isPublishedView:e=!1,productName:n})=>{const{name:r,theme:s,logo_url_light:i,logo_url_dark:o,id:l,settings:c,content:u,template_version:d}=t,{cart:h,removeFromCart:f,updateQuantity:m,updateStore:g,updateStoreTemplateVersion:x}=Vn(),[v,w]=p.useState(!1),[_,C]=p.useState(!1),[T,R]=p.useState(!1),A=!e,[E,I]=p.useState(!1),N=vi(),k=h.filter(F=>F.storeId===l),j=k.reduce((F,Z)=>F+Z.quantity,0),D=k.reduce((F,Z)=>F+Z.price*Z.quantity,0);p.useEffect(()=>{const F=localStorage.getItem("theme"),Z=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;I(!!(F==="dark"||!F&&Z))},[]);const L=async(F,Z,ce=null)=>{if(l)try{if(F==="storeName")await g(l,{name:Z});else if(F==="navLink"&&ce!==null){const he=((u==null?void 0:u.navLinks)||V.map(Le=>({label:Le.label,href:Le.href}))).map((Le,$e)=>$e===ce?{...Le,label:Z}:Le);await g(l,{content:{...u,navLinks:he}})}await G()}catch(le){console.error(`Failed to update store ${F} or refresh template:`,le)}},G=async()=>{const F=d||"v1";console.log(`Performing template refresh. Current version: ${F}`),F==="v1"?(await x(l,"v2"),await x(l,"v1"),console.log("Template refreshed: v1 -> v2 -> v1")):F==="v2"&&(await x(l,"v1"),await x(l,"v2"),console.log("Template refreshed: v2 -> v1 -> v2"))},B=()=>{R(!0),console.log("Open change image dialog (placeholder)")},W=async F=>{if(l&&F)try{await g(l,{logo_url_light:F.logoUrlLight||t.logo_url_light,logo_url_dark:F.logoUrlDark||t.logo_url_dark}),console.log("Store logos updated successfully.")}catch(Z){console.error("Failed to update store logos:",Z)}},X=()=>{const F=!E;I(F),F?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},H=`/store/${l}`,K=[{href:H,label:"Home"},{href:`#products-${l}`,label:"Products"},{href:`#features-${l}`,label:"Features"},{href:`#contact-${l}`,label:"Contact"}],V=u!=null&&u.navLinks&&u.navLinks.length===K.length?u.navLinks.map((F,Z)=>({...K[Z],label:F.label||K[Z].label})):K,$=(F,Z)=>{if(F.preventDefault(),w(!1),Z.startsWith("/store/"))N(Z);else{const ce=Z.substring(1),le=document.getElementById(ce);le?le.scrollIntoView({behavior:"smooth"}):N(H)}},z=()=>{C(!1),N("/checkout",{state:{cart:k,storeName:r,storeId:l}})};return a.jsxs(a.Fragment,{children:[a.jsx(Pt.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"sticky top-0 z-40 w-full bg-background/90 backdrop-blur-md border-b",style:{borderColor:`${s.primaryColor}30`},children:a.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-2",children:n?a.jsx("h1",{className:"font-bold text-xl tracking-tight",style:{color:s.primaryColor},children:n}):a.jsxs(a.Fragment,{children:[a.jsx(Xn,{to:H,className:"group",children:(E?i:o)?a.jsx("img",{src:E?i:o,alt:`${r} logo`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):i||o?a.jsx("img",{src:i||o,alt:`${r} logo (fallback)`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):null}),A&&(i||o)&&a.jsx(O,{variant:"outline",size:"icon",onClick:B,className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(Lp,{className:"h-4 w-4"})}),a.jsx(Xn,{to:H,className:"group ml-2",children:a.jsx("span",{className:"font-bold text-xl tracking-tight group-hover:text-primary transition-colors",style:{color:s.primaryColor},children:a.jsx(zn,{initialText:r,onSave:F=>L("storeName",F),isAdmin:A,placeholder:"Store Name"})})})]})}),!n&&a.jsx("nav",{className:"hidden md:flex items-center gap-x-6",children:V.map((F,Z)=>a.jsx("a",{href:F.href,onClick:ce=>$(ce,F.href),className:"text-sm font-medium text-muted-foreground hover:text-primary transition-colors",style:{"--hover-color":s.primaryColor},children:a.jsx(zn,{initialText:F.label,onSave:ce=>L("navLink",ce,Z),isAdmin:A,placeholder:`Link ${Z+1}`})},F.label+Z))}),a.jsxs("div",{className:"flex items-center gap-2",children:[((c==null?void 0:c.showThemeToggle)??!0)&&a.jsxs("div",{className:"hidden md:flex items-center gap-2 mr-2",children:[a.jsx(jo,{id:`store-theme-switcher-${l}`,checked:E,onCheckedChange:X,"aria-label":"Toggle dark mode"}),E?a.jsx(TE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(IE,{className:"h-5 w-5 text-muted-foreground"})]}),a.jsx(O,{variant:"ghost",size:"icon",className:"hidden md:flex text-muted-foreground hover:text-primary",style:{"--hover-color":s.primaryColor},children:a.jsx(ju,{className:"h-5 w-5"})}),a.jsxs(O,{variant:"outline",className:"relative",onClick:()=>C(!0),style:{borderColor:s.primaryColor,color:s.primaryColor},children:[a.jsx(Fp,{className:"h-5 w-5"}),j>0&&a.jsx(dg,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center text-xs",style:{backgroundColor:s.secondaryColor||"red"},children:j}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Cart"})]}),!n&&a.jsx(O,{variant:"ghost",size:"icon",className:"md:hidden text-muted-foreground hover:text-primary",onClick:()=>w(!0),style:{"--hover-color":s.primaryColor},children:a.jsx(I3,{className:"h-6 w-6"})})]})]})}),a.jsx(_c,{children:v&&a.jsxs(Pt.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"fixed inset-0 z-50 bg-background p-6 md:hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Xn,{to:H,className:"group",onClick:()=>w(!1),children:(E?i:o)?a.jsx("img",{src:E?i:o,alt:`${r} logo`,className:"h-16 w-16 object-contain"}):i||o?a.jsx("img",{src:i||o,alt:`${r} logo (fallback)`,className:"h-16 w-16 object-contain"}):null}),A&&(i||o)&&a.jsx(O,{variant:"outline",size:"icon",onClick:()=>{B(),w(!1)},className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(Lp,{className:"h-4 w-4"})}),a.jsx(Xn,{to:H,className:"group ml-2",onClick:()=>w(!1),children:a.jsx("span",{className:"font-bold text-xl",style:{color:s.primaryColor},children:a.jsx(zn,{initialText:r,onSave:F=>L("storeName",F),isAdmin:A,placeholder:"Store Name"})})})]})," ",a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>w(!1),children:a.jsx(Wi,{className:"h-6 w-6"})})]}),a.jsxs("nav",{className:"flex flex-col gap-y-4",children:[V.map((F,Z)=>a.jsx("a",{href:F.href,onClick:ce=>$(ce,F.href),className:"text-lg font-medium text-foreground hover:text-primary transition-colors",style:{"--hover-color":s.primaryColor},children:a.jsx(zn,{initialText:F.label,onSave:ce=>L("navLink",ce,Z),isAdmin:A,placeholder:`Link ${Z+1}`})},F.label+Z)),((c==null?void 0:c.showThemeToggle)??!0)&&a.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-4 border-t border-border",children:[a.jsx(jo,{id:`mobile-store-theme-switcher-${l}`,checked:E,onCheckedChange:X,"aria-label":"Toggle dark mode"}),E?a.jsx(TE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(IE,{className:"h-5 w-5 text-muted-foreground"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:E?"Dark Mode":"Light Mode"})]})]})]})}),a.jsx(_c,{children:_&&a.jsx(gh.Root,{open:_,onOpenChange:C,children:a.jsxs(gh.Portal,{children:[a.jsx(gh.Overlay,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),a.jsxs(gh.Content,{className:"fixed z-50 inset-y-0 right-0 h-full w-full max-w-md bg-background border-l shadow-xl flex flex-col",as:Pt.div,initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Your Cart"}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>C(!1),children:a.jsx(Wi,{className:"h-5 w-5"})})]}),k.length===0?a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center",children:[a.jsx(Fp,{className:"h-16 w-16 text-muted-foreground mb-4"}),a.jsx("p",{className:"text-lg font-medium",children:"Your cart is empty"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Looks like you haven't added anything yet."}),a.jsx(O,{onClick:()=>C(!1),className:"mt-6",style:{backgroundColor:s.primaryColor},children:"Continue Shopping"})]}):a.jsxs(a.Fragment,{children:[a.jsx(Ls,{className:"flex-1 p-6",children:a.jsx("div",{className:"space-y-4",children:k.map(F=>{var Z,ce,le,he;return a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("img",{src:((ce=(Z=F.image)==null?void 0:Z.src)==null?void 0:ce.tiny)||((he=(le=F.image)==null?void 0:le.src)==null?void 0:he.medium)||`https://via.placeholder.com/80x80.png?text=${F.name.substring(0,1)}`,alt:F.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium text-sm line-clamp-1",children:F.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: $",F.price.toFixed(2)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(O,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>m(F.id,l,F.quantity-1),children:a.jsx("span",{className:"text-lg leading-none",children:"-"})}),a.jsx("span",{className:"text-sm w-4 text-center",children:F.quantity}),a.jsx(O,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>m(F.id,l,F.quantity+1),children:a.jsx("span",{className:"text-lg leading-none",children:"+"})})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-semibold text-sm",children:["$",(F.price*F.quantity).toFixed(2)]}),a.jsx(O,{variant:"ghost",size:"icon",className:"h-7 w-7 mt-1 text-muted-foreground hover:text-destructive",onClick:()=>f(F.id,l),children:a.jsx(Fn,{className:"h-4 w-4"})})]})]},F.id)})})}),a.jsx(Oi,{}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex justify-between font-medium",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["$",D.toFixed(2)]})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Shipping and taxes calculated at checkout."}),a.jsx(O,{className:"w-full",size:"lg",style:{backgroundColor:s.primaryColor},onClick:z,children:"Proceed to Checkout"})]})]})]})]})})}),A&&a.jsx(nRe,{open:T,onOpenChange:R,storeId:l,storeName:r,currentLogoUrl:o,currentLogoUrlLight:i,currentLogoUrlDark:o,onLogoReplaced:W})]})},gh={Root:({children:t,...e})=>a.jsx("div",{...e,children:t}),Portal:({children:t})=>a.jsx(a.Fragment,{children:t}),Overlay:ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("fixed inset-0 z-50",t),...e})),Content:ht.forwardRef(({className:t,children:e,...n},r)=>a.jsx("div",{ref:r,className:bt("fixed z-50",t),...n,children:e}))};gh.Overlay.displayName="DialogPrimitive.Overlay";gh.Content.displayName="DialogPrimitive.Content";const rRe=Object.freeze(Object.defineProperty({__proto__:null,default:Cq},Symbol.toStringTag,{value:"Module"})),Eq=({store:t,isPublishedView:e=!1})=>{const{name:n,theme:r,id:s,content:i}=t,{updateStore:o}=Vn(),l=!e,c=new Date().getFullYear(),u=[{icon:Tie,href:"#",label:"Facebook"},{icon:Ux,href:"#",label:"Instagram"},{icon:Kie,href:"#",label:"Twitter"},{icon:Rie,href:"#",label:"LinkedIn"},{icon:Xie,href:"#",label:"YouTube"}],h=[{href:`/store/${s}`,label:"Home"},{href:`#products-${s}`,label:"Products"},{href:"#",label:"About Us"},{href:"#",label:"Contact"},{href:"#",label:"FAQ"},{href:"#",label:"Privacy Policy"},{href:"#",label:"Terms of Service"},{href:"#",label:"Shipping Info"},{href:"#",label:"Returns"}],f=i!=null&&i.footerNavLinks&&Array.isArray(i.footerNavLinks)&&i.footerNavLinks.length>0?i.footerNavLinks.map((A,E)=>{var I,N;return{href:A.href||((I=h[E])==null?void 0:I.href)||"#",label:A.label||((N=h[E])==null?void 0:N.label)||`Link ${E+1}`}}):h,m=()=>{window.scrollTo({top:0,behavior:"smooth"})},g=async(A,E,I=null)=>{if(s)try{if(A.startsWith("content.footerNavLinks")){const N=f.map((k,j)=>j===I?{...k,label:E}:k);await o(s,{content:{...i,footerNavLinks:N}})}else{const N=A.split(".");N.length===2&&N[0]==="content"?await o(s,{content:{...i,[N[1]]:E}}):console.warn("Unsupported identifier for footer text save:",A)}}catch(N){console.error(`Failed to update store footer text for ${A}:`,N)}},x=(i==null?void 0:i.footerStoreInfo)||`Your favorite destination for ${t.type||"quality products"}. We are committed to bringing you the best experience with premium quality and exceptional service.`,v=(i==null?void 0:i.footerQuickLinksTitle)||"Quick Links",w=(i==null?void 0:i.footerCustomerServiceTitle)||"Customer Service",_=(i==null?void 0:i.footerContactUsTitle)||"Contact Us",C=(i==null?void 0:i.footerAddress)||"123 Store Street, Cityville, ST 12345",T=(i==null?void 0:i.footerPhoneNumber)||"(123) 456-7890",R=(i==null?void 0:i.footerCopyrightSuffix)||"All Rights Reserved. Powered by FreshFront.";return a.jsxs("footer",{className:"bg-muted dark:bg-slate-900 text-muted-foreground relative overflow-hidden",id:`contact-${s}`,children:[a.jsx(Pt.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"pt-16 pb-8",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-xl font-bold text-foreground font-poppins",style:{color:r.primaryColor},children:n}),a.jsx("div",{className:"text-sm",children:a.jsx(zn,{initialText:x,onSave:A=>g("content.footerStoreInfo",A),isAdmin:l,placeholder:"Store information paragraph",useTextarea:!0,textClassName:"text-sm"})}),a.jsx("div",{className:"flex space-x-3 pt-2",children:u.map(A=>a.jsx("a",{href:A.href,"aria-label":A.label,className:"p-2 rounded-full bg-background/50 hover:bg-primary/10 hover:scale-110 transition-all duration-300",style:{"--hover-bg-color":`${r.primaryColor}1A`,"--hover-text-color":r.primaryColor},children:a.jsx(A.icon,{className:"h-5 w-5"})},A.label))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(zn,{initialText:v,onSave:A=>g("content.footerQuickLinksTitle",A),isAdmin:l,placeholder:"Quick Links Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(0,5).map((A,E)=>a.jsx("li",{children:a.jsx("a",{href:A.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx(zn,{initialText:A.label,onSave:I=>g("content.footerNavLinks",I,E),isAdmin:l,placeholder:`Link ${E+1}`,textClassName:"text-sm"})})},A.label+E))})]}),a.jsxs(Pt.div,{variants:{hidden:{opacity:0,x:-30},visible:{opacity:1,x:0,transition:{duration:.5,ease:"easeOut",delay:.2}}},children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(zn,{initialText:w,onSave:A=>g("content.footerCustomerServiceTitle",A),isAdmin:l,placeholder:"Customer Service Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(5).map((A,E)=>a.jsx("li",{children:a.jsx("a",{href:A.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx(zn,{initialText:A.label,onSave:I=>g("content.footerNavLinks",I,E+5),isAdmin:l,placeholder:`Link ${E+6}`,textClassName:"text-sm"})})},A.label+E+5))})]}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(zn,{initialText:_,onSave:A=>g("content.footerContactUsTitle",A),isAdmin:l,placeholder:"Contact Us Title",textClassName:"font-bold text-foreground"})}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(jie,{className:"h-5 w-5 mt-0.5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx(zn,{initialText:C,onSave:A=>g("content.footerAddress",A),isAdmin:l,placeholder:"Store Address",useTextarea:!0,textClassName:"text-sm"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(oh,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsxs("a",{href:`mailto:info@${n.toLowerCase().replace(/\s+/g,"")}.com`,className:"hover:text-primary hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:["info@",n.toLowerCase().replace(/\s+/g,""),".com"]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx($ie,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx(zn,{initialText:T,onSave:A=>g("content.footerPhoneNumber",A),isAdmin:l,placeholder:"Store Phone Number",textClassName:"text-sm hover:text-primary hover:underline decoration-primary/30 underline-offset-4"})]})]})]}),a.jsxs("div",{className:"border-t border-border/50 pt-6 flex flex-col md:flex-row justify-between items-center text-sm",children:[a.jsxs("p",{children:[" ",c," ",n,". ",a.jsx(zn,{initialText:R,onSave:A=>g("content.footerCopyrightSuffix",A),isAdmin:l,placeholder:"Copyright suffix",textClassName:"text-sm",as:"span"})]}),a.jsx("div",{className:"flex items-center mt-4 md:mt-0",children:a.jsx(O,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-primary/10 transition-all duration-300",onClick:m,style:{"--hover-bg-color":`${r.primaryColor}1A`},children:a.jsx(xie,{className:"h-5 w-5",style:{color:r.primaryColor}})})})]})]})}),a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full translate-x-1/2 -translate-y-1/2 blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-secondary/5 rounded-full -translate-x-1/3 translate-y-1/3 blur-3xl"})]})},sRe=Object.freeze(Object.defineProperty({__proto__:null,default:Eq},Symbol.toStringTag,{value:"Module"})),iRe=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),oRe=({open:t,onOpenChange:e,product:n,onVideoGenerated:r})=>{var T,R,A,E;const[s,i]=p.useState(""),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(null),{toast:v}=vs(),w=((R=(T=n==null?void 0:n.image)==null?void 0:T.src)==null?void 0:R.large)||((E=(A=n==null?void 0:n.image)==null?void 0:A.src)==null?void 0:E.medium);p.useEffect(()=>{t&&w&&(x(null),i(""),l(null),u(null),iRe(w).then(I=>{l(I.base64ImageData),u(I.mimeType)}).catch(I=>{console.error("Error loading product image data:",I),x(`Failed to load product image: ${I.message}`),v({title:"Error",description:`Failed to load product image: ${I.message}`,variant:"destructive"})}))},[t,w,v]);const _=async()=>{if(!o||!c){v({title:"Error",description:"Product image data is not available to suggest a prompt.",variant:"destructive"});return}h(!0),x(null);try{const I=await ia(o,c);i(I)}catch(I){console.error("Error generating prompt suggestion:",I),x(`Failed to suggest prompt: ${I.message}`),v({title:"Suggestion Failed",description:`Could not suggest a prompt: ${I.message}`,variant:"destructive"})}finally{h(!1)}},C=async()=>{if(!s.trim()){x("Please enter a prompt for the video.");return}if(!o||!c){x("Product image data is not available.");return}m(!0),x(null);try{const I=await zI(s,o,c);r&&r(I),e(!1)}catch(I){console.error("Error generating product video:",I),x(I.message||"Failed to generate video. Please try again."),v({title:"Video Generation Failed",description:I.message,variant:"destructive"})}finally{m(!1)}};return n?a.jsx(Yr,{open:t,onOpenChange:e,children:a.jsxs($r,{className:"sm:max-w-lg",children:[a.jsxs(Ur,{children:[a.jsx(Br,{children:"Generate Product Video"}),a.jsxs(Ji,{children:['Create a short video for "',n.name,'" using its image and a prompt.']})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[w&&a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("img",{src:w,alt:n.name,className:"w-32 h-32 object-contain rounded border"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Using this image as the base."})]}),a.jsxs("div",{className:"grid w-full gap-1.5",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Re,{htmlFor:"video-prompt",children:"Video Prompt"}),a.jsxs(O,{variant:"outline",size:"sm",onClick:_,disabled:d||f||!o,children:[d?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ma,{className:"mr-2 h-4 w-4"}),"Suggest"]})]}),a.jsx(En,{id:"video-prompt",value:s,onChange:I=>i(I.target.value),placeholder:"e.g., A dynamic shot of the product with vibrant background...",rows:4,disabled:d||f}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"AI will use the product image and this prompt to create a video."})]}),g&&a.jsx("p",{className:"text-sm text-red-500 col-span-4 text-center",children:g})]}),a.jsxs(Ar,{children:[a.jsx(rl,{asChild:!0,children:a.jsx(O,{variant:"outline",disabled:f,children:"Cancel"})}),a.jsxs(O,{onClick:C,disabled:d||f||!s.trim()||!o,children:[f?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ma,{className:"mr-2 h-4 w-4"}),"Generate Video"]})]})]})}):null},WF="msy_4wQeZBKbKsyGKmfCOGWk0Ux9F7zGIByWSgwC",HF="https://api.meshy.ai/openapi/v1",aRe=({open:t,onOpenChange:e,product:n,storeId:r,onModelGenerated:s})=>{const{toast:i}=vs(),[o,l]=p.useState([]),[c,u]=p.useState(null),[d,h]=p.useState(0),[f,m]=p.useState(""),[g,x]=p.useState(""),[v,w]=p.useState(!1),[_,C]=p.useState(null),T=p.useCallback(()=>{var k,j,D,L,G,B,W;return n?(j=(k=n.image)==null?void 0:k.src)!=null&&j.large||(L=(D=n.image)==null?void 0:D.src)!=null&&L.medium?[{name:"Main Product Image",url:n.image.src.large||n.image.src.medium}]:((B=(G=n.images)==null?void 0:G.edges)==null?void 0:B.length)>0&&((W=n.images.edges[0].node)!=null&&W.url)?n.images.edges.map((X,H)=>({name:`Product Image ${H+1}`,url:X.node.url})).slice(0,4):[]:[]},[n]);p.useEffect(()=>{t&&n?(l(T().slice(0,1)),u(null),h(0),m(""),x(""),w(!1),_&&(clearInterval(_),C(null))):!t&&_&&(clearInterval(_),C(null))},[t,n,T,_]);const R=k=>{const j=Array.from(k.target.files);if(j.length===0)return;const D=[];let L=o.length;j.forEach(G=>{if(L>=4){i({title:"Limit Reached",description:"You can select up to 4 images.",variant:"warning"});return}const B=new FileReader;B.onload=W=>{D.push({name:G.name,url:W.target.result,file:G}),D.length===Math.min(j.length,4-o.length)&&l(X=>[...X,...D].slice(0,4))},B.readAsDataURL(G),L++})},A=k=>{l(j=>j.filter((D,L)=>L!==k))},E=async()=>{if(o.length===0){i({title:"No Image Selected",description:"Please select at least one image.",variant:"destructive"});return}w(!0),x(""),m("PENDING"),h(5);const k=o.length>1?"/multi-image-to-3d":"/image-to-3d",j=o.length>1?{image_urls:o.map(D=>D.url)}:{image_url:o[0].url};j.enable_pbr=!0,j.should_texture=!0,o.length===1&&(n!=null&&n.name);try{const D=await fetch(`${HF}${k}`,{method:"POST",headers:{Authorization:`Bearer ${WF}`,"Content-Type":"application/json"},body:JSON.stringify(j)}),L=await D.json();if(!D.ok)throw new Error(L.detail||L.message||`API Error: ${D.status}`);if(L.result){u(L.result),m("IN_PROGRESS"),h(10);const G=setInterval(()=>I(L.result,k),5e3);C(G)}else throw new Error("Task ID not found in response.")}catch(D){console.error("Error creating Meshy task:",D),x(`Error creating task: ${D.message}`),m("FAILED"),w(!1)}},I=async(k,j)=>{var D,L;try{const G=await fetch(`${HF}${j}/${k}`,{headers:{Authorization:`Bearer ${WF}`}}),B=await G.json();if(!G.ok){if(G.status===404&&d<30){h(W=>Math.min(W+5,30));return}throw new Error(B.detail||B.message||`API Error: ${G.status}`)}if(h(B.progress||d),m(B.status),B.status==="SUCCEEDED")if(_&&clearInterval(_),C(null),w(!1),(D=B.model_urls)!=null&&D.glb)s(B.model_urls.glb),i({title:"3D Model Generated!",description:"The model has been successfully created."}),e(!1);else throw new Error("GLB model URL not found in successful response.");else B.status==="FAILED"?(_&&clearInterval(_),C(null),x(((L=B.task_error)==null?void 0:L.message)||"Generation failed for an unknown reason."),w(!1)):(B.status==="PENDING"||B.status==="IN_PROGRESS")&&B.progress===100&&B.status==="IN_PROGRESS"&&h(99)}catch(G){console.error("Error polling Meshy task status:",G),x(`Error polling status: ${G.message}`),_&&clearInterval(_),C(null),m("FAILED"),w(!1)}},N=()=>{_&&(clearInterval(_),C(null)),e(!1)};return a.jsx(Yr,{open:t,onOpenChange:N,children:a.jsxs($r,{className:"sm:max-w-lg",children:[a.jsx(Ur,{children:a.jsxs(Br,{children:["Generate 3D Model for ",(n==null?void 0:n.name)||(n==null?void 0:n.title)||"Product"]})}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"image-upload",children:"Product Images (select 1-4)"}),a.jsxs("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-4 gap-2 mb-2",children:[o.map((k,j)=>a.jsxs("div",{className:"relative group aspect-square border rounded-md overflow-hidden",children:[a.jsx("img",{src:k.url,alt:k.name,className:"w-full h-full object-cover"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-50 group-hover:opacity-100",onClick:()=>A(j),disabled:v||f==="IN_PROGRESS",children:a.jsx(Fn,{size:14})})]},j)),o.length<4&&a.jsxs(Re,{htmlFor:"image-upload-input",className:"aspect-square border-2 border-dashed rounded-md flex flex-col items-center justify-center cursor-pointer hover:border-primary transition-colors text-muted-foreground",children:[a.jsx(Lo,{size:24,className:"mb-1"}),a.jsx("span",{className:"text-xs",children:"Add Image"})]})]}),a.jsx(Je,{id:"image-upload-input",type:"file",multiple:!0,accept:"image/png, image/jpeg, image/jpg",onChange:R,className:"hidden",disabled:v||f==="IN_PROGRESS"||o.length>=4}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Default is main product image. You can add up to 4 images (PNG, JPG). More images can improve quality."})]}),f&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(Re,{children:["Status: ",f]}),f==="SUCCEEDED"&&a.jsx(fa,{className:"h-5 w-5 text-green-500"}),f==="FAILED"&&a.jsx(ew,{className:"h-5 w-5 text-red-500"}),(f==="PENDING"||f==="IN_PROGRESS")&&a.jsx(ft,{className:"h-5 w-5 animate-spin"})]}),a.jsx(Oa,{value:d,className:"w-full"}),g&&a.jsx("p",{className:"text-sm text-red-500",children:g})]})]}),a.jsxs(Ar,{children:[a.jsx(O,{type:"button",variant:"outline",onClick:N,disabled:v&&f==="IN_PROGRESS",children:"Cancel"}),a.jsxs(O,{type:"button",onClick:E,disabled:v||o.length===0||f==="IN_PROGRESS"||f==="SUCCEEDED",children:[v&&(f==="PENDING"||f==="IN_PROGRESS")?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,f==="IN_PROGRESS"?"Generating...":"Generate 3D Model"]})]})]})})},lRe=({modelUrl:t,thumbnailUrl:e,productName:n="Product",className:r="",height:s="400px",showControls:i=!0,autoRotate:o=!1,cameraControls:l=!0,ar:c=!0})=>{const u=p.useRef(null);p.useEffect(()=>{if(!window.customElements.get("model-viewer")){const m=document.createElement("script");m.type="module",m.src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js",document.head.appendChild(m)}},[]);const d=()=>{u.current&&(u.current.resetTurntableRotation(),u.current.jumpCameraToGoal())},h=()=>{u.current&&u.current.requestFullscreen&&u.current.requestFullscreen()},f=()=>{if(t){const m=document.createElement("a");m.href=t,m.download=`${n.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_3d_model.glb`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}};return t?a.jsx(Xe,{className:r,children:a.jsxs(at,{className:"p-0 relative",children:[a.jsxs("model-viewer",{ref:u,src:t,poster:e,alt:`3D model of ${n}`,style:{width:"100%",height:s,backgroundColor:"#f8f9fa"},"camera-controls":l,"auto-rotate":o,ar:c,"ar-modes":"webxr scene-viewer quick-look","environment-image":"neutral","shadow-intensity":"1",exposure:"1","tone-mapping":"neutral",loading:"eager",children:[a.jsx("div",{slot:"progress-bar",className:"absolute inset-0 flex items-center justify-center bg-background/80",children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading 3D model..."})]})}),a.jsx("div",{slot:"error",className:"absolute inset-0 flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-destructive mb-2",children:"Failed to load 3D model"}),a.jsx(O,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),children:"Retry"})]})})]}),i&&a.jsxs("div",{className:"absolute top-2 right-2 flex flex-col space-y-1",children:[a.jsx(O,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:d,title:"Reset camera",children:a.jsx(Bie,{className:"h-4 w-4"})}),a.jsx(O,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:h,title:"Fullscreen",children:a.jsx(Die,{className:"h-4 w-4"})}),a.jsx(O,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:f,title:"Download model",children:a.jsx(TI,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"absolute bottom-2 right-2"})]})}):a.jsx(Xe,{className:r,children:a.jsx(at,{className:"flex items-center justify-center p-6",style:{height:s},children:a.jsx("p",{className:"text-muted-foreground",children:"No 3D model available"})})})},cRe=({product:t,storeId:e,isPublishedView:n=!1})=>{const{toast:r}=vs(),{getStoreById:s}=Vn(),[i,o]=p.useState(null),[l,c]=p.useState(null),[u,d]=p.useState(""),[h,f]=p.useState([]),[m,g]=p.useState([]),[x,v]=p.useState(null),[w,_]=p.useState(!1),[C,T]=p.useState(""),[R,A]=p.useState("#FFFFFF"),[E,I]=p.useState({}),[N,k]=p.useState(""),[j,D]=p.useState(""),[L,G]=p.useState(!1),[B,W]=p.useState(!1);p.useEffect(()=>{if(e){const $=s(e);o($),$&&t&&f($.products.filter(z=>{var F,Z;return z.id!==t.id&&((Z=(F=z.image)==null?void 0:F.src)==null?void 0:Z.medium)}))}},[e,t,s]);const X=$=>{const z=$.target.files[0];if(z){z.size>5*1024*1024&&r({title:"File too large",description:"Reference image should ideally be under 5MB.",variant:"destructive"}),c(z);const F=new FileReader;F.onloadend=()=>d(F.result),F.readAsDataURL(z),v(null),k(""),D("")}},H=()=>{c(null),d(""),v(null),k(""),D("")},K=$=>{g(z=>z.find(F=>F.id===$.id)?z.filter(F=>F.id!==$.id):[...z,$]),v(null),k(""),D("")},V=async()=>{var F,Z,ce,le;if(!t||!l){r({title:"Missing inputs",description:"Main product and a reference image are required.",variant:"destructive"});return}_(!0),v(null),k(""),D("Generating visualization, please wait...");let $=C;R&&R!=="#FFFFFF"&&($=`${$} The main product's color should be ${R}.`.trim());const z=Object.entries(E);if(z.length>0){const he=z.map(([Le,$e])=>`${Le}: ${$e}`).join(", ");$=`${$} Apply these product attributes: ${he}.`.trim()}try{const he={name:t.name,description:t.description,imageSource:((Z=(F=t.image)==null?void 0:F.src)==null?void 0:Z.large)||((le=(ce=t.image)==null?void 0:ce.src)==null?void 0:le.medium)},Le=m.map(Be=>{var ue,Ce,Ie,ve;return{name:Be.name,description:Be.description,imageSource:((Ce=(ue=Be.image)==null?void 0:ue.src)==null?void 0:Ce.large)||((ve=(Ie=Be.image)==null?void 0:Ie.src)==null?void 0:ve.medium)}}),$e=await vq({mainProduct:he,referenceSceneSource:l,additionalProducts:Le,customInstructions:$});k($e.promptUsed||"Prompt details not available."),D($e.commentary||"Processing complete."),$e&&$e.imageUrl?(v($e.imageUrl),r({title:"Visualization Generated!",description:$e.commentary||"Image created."})):r({title:"Visualization Issue",description:$e.commentary||"No image generated by AI.",variant:"default",duration:7e3})}catch(he){console.error("Error in ProductVisualizer calling generateProductVisualization:",he);const Le=he.message||"An unknown error occurred during visualization.";D(`Error: ${Le}`),r({title:"Visualization Failed",description:Le,variant:"destructive",duration:1e4})}finally{_(!1)}};return!t||!i?a.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Initializing Product Visualizer..."}):a.jsxs("div",{className:"my-8 border rounded-lg shadow-sm bg-card",children:[a.jsxs("div",{className:"p-4 md:p-6 cursor-pointer flex justify-between items-center",onClick:()=>W(!B),role:"button",tabIndex:0,onKeyDown:$=>($.key==="Enter"||$.key===" ")&&W(!B),"aria-expanded":B,"aria-controls":"product-visualizer-content-area",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl md:text-2xl font-semibold",children:"Product Visualizer"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["See how ",a.jsx("span",{className:"font-medium text-primary",children:t.name})," looks in different settings."]})]}),a.jsx(O,{variant:"ghost",size:"icon","aria-label":B?"Collapse visualizer":"Expand visualizer",children:B?a.jsx(_3,{className:"h-6 w-6"}):a.jsx(Su,{className:"h-6 w-6"})})]}),B&&a.jsxs("div",{id:"product-visualizer-content-area",className:"p-4 md:p-6 border-t",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[a.jsxs("div",{className:"space-y-4 md:space-y-6",children:[a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"visualizer-reference-image-upload",className:"text-md font-medium block mb-1",children:"1. Upload Reference Scene"}),a.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"E.g., a room, a model. (Max ~5MB recommended)"}),u?a.jsxs("div",{className:"relative group aspect-video rounded-md border overflow-hidden bg-muted/20",children:[a.jsx("img",{src:u,alt:"Reference scene preview",className:"w-full h-full object-contain"}),a.jsx(O,{variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-50 group-hover:opacity-100 transition-opacity",onClick:H,"aria-label":"Remove reference image",children:a.jsx(Wi,{className:"h-4 w-4"})})]}):a.jsxs("label",{htmlFor:"visualizer-reference-image-input",className:"mt-1 flex flex-col justify-center items-center w-full h-40 md:h-48 px-6 py-5 border-2 border-dashed rounded-md cursor-pointer hover:border-primary transition-colors",children:[a.jsx(Lo,{className:"mx-auto h-8 md:h-10 w-8 md:w-10 text-muted-foreground mb-2"}),a.jsx("span",{className:"font-semibold text-primary text-sm",children:"Click to upload image"}),a.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG, GIF, WEBP"}),a.jsx(Je,{id:"visualizer-reference-image-input",type:"file",className:"sr-only",accept:"image/*",onChange:X})]})]}),h.length>0&&a.jsxs("div",{children:[a.jsx(Re,{className:"text-md font-medium block mb-1",children:"2. Add Other Products (Optional)"}),a.jsx(Ls,{className:"h-32 md:h-40 border rounded-md p-2",children:a.jsx("div",{className:"space-y-1.5",children:h.map($=>a.jsxs("div",{className:`flex items-center justify-between p-2 rounded-md cursor-pointer transition-all text-sm ${m.some(z=>z.id===$.id)?"bg-primary/10 ring-1 ring-primary":"hover:bg-muted/50"}`,onClick:()=>K($),role:"checkbox","aria-checked":m.some(z=>z.id===$.id),tabIndex:0,onKeyDown:z=>(z.key==="Enter"||z.key===" ")&&K($),children:[a.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[a.jsx("img",{src:$.image.src.medium,alt:$.name,className:"w-8 h-8 object-cover rounded flex-shrink-0"}),a.jsx("span",{className:"truncate",title:$.name,children:$.name})]}),m.some(z=>z.id===$.id)&&a.jsx(fa,{className:"h-4 w-4 text-primary flex-shrink-0"})]},$.id))})})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"visualizer-product-color",className:"text-md font-medium block mb-1",children:"3. Main Product Color (Optional)"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{type:"color",id:"visualizer-product-color",value:R,onChange:$=>A($.target.value),className:"w-12 h-10 p-1"}),a.jsx(Je,{type:"text",value:R,onChange:$=>A($.target.value),placeholder:"#FFFFFF",className:"flex-grow h-10 text-sm"})]})]}),t.variants&&t.variants.length>0&&a.jsxs("div",{children:[a.jsx(Re,{className:"text-md font-medium block mb-1",children:"3. Main Product Variants (Optional)"}),a.jsx("div",{className:"space-y-2",children:t.variants.map($=>!$.name||!$.values||$.values.length===0?null:a.jsxs("div",{children:[a.jsx(Re,{htmlFor:`visualizer-variant-${$.name}`,className:"text-sm text-muted-foreground",children:$.name}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:$.values.map(z=>a.jsx(O,{variant:E[$.name]===z?"default":"outline",size:"xs",onClick:()=>I(F=>({...F,[$.name]:z})),className:"text-xs px-2 py-1 h-auto",children:z},z))})]},$.name))})]}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"visualizer-custom-prompt",className:"text-md font-medium block mb-1",children:t.variants&&t.variants.length>0?"5. Additional Custom Instructions (Optional)":"4. Custom Instructions (Optional)"}),a.jsx(En,{id:"visualizer-custom-prompt",placeholder:"e.g., 'place the sofa by the window', 'make it a sunny day'",value:C,onChange:$=>T($.target.value),rows:2,className:"resize-none text-sm"})]}),a.jsxs(O,{onClick:V,disabled:w||!l,className:"w-full py-2.5 text-sm md:text-base",size:"lg",children:[w?a.jsx(ft,{className:"mr-2 h-5 w-5 animate-spin"}):a.jsx(wa,{className:"mr-2 h-5 w-5"}),"Generate Visualization"]})]}),a.jsx("div",{className:"flex flex-col items-center justify-center border rounded-md p-2 md:p-4 bg-muted/30 min-h-[250px] md:min-h-[300px] lg:min-h-full relative",children:w?a.jsxs("div",{className:"text-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary mb-3"}),a.jsx("p",{className:"text-muted-foreground font-medium",children:j||"Generating your scene..."})]}):x?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:x,alt:"Generated Product Visualization",className:"max-w-full max-h-[calc(100%-40px)] object-contain rounded-md"}),j&&!j.toLowerCase().includes("error")&&a.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center max-w-xs mx-auto",children:j}),a.jsxs(O,{variant:"ghost",size:"sm",onClick:()=>G(!L),className:"absolute bottom-1 right-1 text-muted-foreground hover:text-primary h-auto p-1","aria-label":"Toggle prompt information",children:[a.jsx(Nie,{className:"h-4 w-4 mr-1"})," ",a.jsx("span",{className:"text-xs",children:"Info"})]})]}):a.jsxs("div",{className:"text-center text-muted-foreground p-4",children:[j&&a.jsx("p",{className:`text-sm mb-2 ${j.toLowerCase().includes("error")||j.toLowerCase().includes("failed")?"text-destructive":""}`,children:j}),a.jsx(wa,{className:"h-12 w-12 mx-auto mb-3"}),a.jsx("p",{className:"font-medium",children:"Your product visualization will appear here."}),!x&&a.jsx("p",{className:"text-xs mt-1",children:'Upload a reference scene and click "Generate".'})]})})]}),L&&N&&!n&&a.jsxs("div",{className:"mt-4 p-3 border rounded-md bg-muted/50",children:[a.jsx(Re,{className:"text-xs font-semibold text-muted-foreground",children:"Technical Prompt Sent to AI:"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1 whitespace-pre-wrap",children:N})]}),a.jsx(Oi,{className:"mt-6 md:mt-8 mb-0"})]})]})};var Tq=p.forwardRef(({transition:t,...e},n)=>{let r={position:"absolute",top:0,left:0,width:"100%",height:"100%",transition:t?`clip-path ${t}`:void 0,userSelect:"none",willChange:"clip-path, transition",KhtmlUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none"};return a.jsx("div",{...e,style:r,"data-rcs":"clip-item",ref:n})});Tq.displayName="ContainerClip";var Iq=p.forwardRef(({children:t,disabled:e,portrait:n,position:r,transition:s},i)=>{let o={position:"absolute",top:0,width:n?"100%":void 0,height:n?void 0:"100%",background:"none",border:0,padding:0,pointerEvents:"all",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:0,transform:n?"translate3d(0, -50% ,0)":"translate3d(-50%, 0, 0)",transition:s?`${n?"top":"left"} ${s}`:void 0};return a.jsx("button",{ref:i,"aria-label":"Drag to move or focus and use arrow keys","aria-orientation":n?"vertical":"horizontal","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":r,"data-rcs":"handle-container",disabled:e,role:"slider",style:o,children:t})});Iq.displayName="ThisHandleContainer";var qF=({flip:t})=>a.jsx("div",{className:"__rcs-handle-arrow",style:{width:0,height:0,borderTop:"8px solid transparent",borderRight:"10px solid",borderBottom:"8px solid transparent",transform:t?"rotate(180deg)":void 0}}),uRe=({className:t="__rcs-handle-root",disabled:e,buttonStyle:n,linesStyle:r,portrait:s,style:i,...o})=>{let l={display:"flex",flexDirection:s?"row":"column",placeItems:"center",height:"100%",cursor:e?"not-allowed":s?"ns-resize":"ew-resize",pointerEvents:"none",color:"#fff",...i},c={flexGrow:1,height:s?2:"100%",width:s?"100%":2,backgroundColor:"currentColor",pointerEvents:"auto",boxShadow:"0 0 4px rgba(0,0,0,.5)",...r},u={display:"grid",gridAutoFlow:"column",gap:8,placeContent:"center",flexShrink:0,width:56,height:56,borderRadius:"50%",borderStyle:"solid",borderWidth:2,pointerEvents:"auto",backdropFilter:"blur(7px)",WebkitBackdropFilter:"blur(7px)",backgroundColor:"rgba(0, 0, 0, 0.125)",boxShadow:"0 0 4px rgba(0,0,0,.35)",transform:s?"rotate(90deg)":void 0,...n};return a.jsxs("div",{...o,className:t,style:l,children:[a.jsx("div",{className:"__rcs-handle-line",style:c}),a.jsxs("div",{className:"__rcs-handle-button",style:u,children:[a.jsx(qF,{}),a.jsx(qF,{flip:!0})]}),a.jsx("div",{className:"__rcs-handle-line",style:c})]})},Nq=(t=>(t.ARROW_LEFT="ArrowLeft",t.ARROW_RIGHT="ArrowRight",t.ARROW_UP="ArrowUp",t.ARROW_DOWN="ArrowDown",t))(Nq||{}),dRe=({boxSizing:t="border-box",objectFit:e="cover",objectPosition:n="center center",...r}={})=>({display:"block",width:"100%",height:"100%",maxWidth:"100%",boxSizing:t,objectFit:e,objectPosition:n,...r}),hRe=t=>{let e=p.useRef(t);return p.useEffect(()=>{e.current=t}),e.current},hC=(t,e,n,r)=>{let s=p.useRef();p.useEffect(()=>{s.current=e},[e]),p.useEffect(()=>{if(!(n&&n.addEventListener))return;let i=o=>s.current&&s.current(o);return n.addEventListener(t,i,r),()=>{n.removeEventListener(t,i,r)}},[t,n,r])},fRe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,mRe=(t,e)=>{let n=p.useRef(),r=p.useCallback(()=>{t.current&&n.current&&n.current.observe(t.current)},[t]);fRe(()=>(n.current=new ResizeObserver(([s])=>e(s.contentRect)),r(),()=>{n.current&&n.current.disconnect()}),[e,r])},Ex={capture:!1,passive:!0},fC={capture:!0,passive:!1},pRe=t=>{t.preventDefault(),t.currentTarget.focus()},Pq=p.forwardRef(({boundsPadding:t=0,browsingContext:e=globalThis,changePositionOnHover:n=!1,disabled:r=!1,handle:s,itemOne:i,itemTwo:o,keyboardIncrement:l="5%",onlyHandleDraggable:c=!1,onPositionChange:u,portrait:d=!1,position:h=50,style:f,transition:m,...g},x)=>{let v=p.useRef(null),w=p.useRef(null),_=p.useRef(null),C=p.useRef(h),[T,R]=p.useState(!1),[A,E]=p.useState(!0),I=p.useRef(!1),[N,k]=p.useState(),j=hRe(h),D=p.useCallback(function({x:$,y:z,isOffset:F}){let Z=v.current,ce=_.current,le=w.current,{width:he,height:Le,left:$e,top:Be}=Z.getBoundingClientRect();if(he===0||Le===0)return;let ue=d?F?z-Be-e.scrollY:z:F?$-$e-e.scrollX:$,Ce=Math.min(Math.max(ue/(d?Le:he)*100,0),100),Ie=d?Le/(Z.offsetHeight||1):he/(Z.offsetWidth||1),ve=t*Ie/(d?Le:he)*100,ie=Math.min(Math.max(Ce,ve*Ie),100-ve*Ie);C.current=Ce,ce.setAttribute("aria-valuenow",`${Math.round(C.current)}`),ce.style.top=d?`${ie}%`:"0",ce.style.left=d?"0":`${ie}%`,le.style.clipPath=d?`inset(${ie}% 0 0 0)`:`inset(0 0 0 ${ie}%)`,u&&u(C.current)},[t,u,d,e]);p.useEffect(()=>{let{width:$,height:z}=v.current.getBoundingClientRect(),F=h===j?C.current:h;D({x:$/100*F,y:z/100*F})},[t,h,d,j,D]);let L=p.useCallback($=>{$.preventDefault(),!(r||$.button!==0)&&(D({isOffset:!0,x:$.pageX,y:$.pageY}),R(!0),E(!0))},[r,D]),G=p.useCallback(function($){D({isOffset:!0,x:$.pageX,y:$.pageY}),E(!1)},[D]),B=p.useCallback(()=>{R(!1),E(!0)},[]),W=p.useCallback(({width:$,height:z})=>{let{width:F,height:Z}=v.current.getBoundingClientRect();D({x:$/100*C.current*F/$,y:z/100*C.current*Z/z})},[D]),X=p.useCallback($=>{if(!Object.values(Nq).includes($.key))return;$.preventDefault(),E(!0);let{top:z,left:F}=_.current.getBoundingClientRect(),{width:Z,height:ce}=v.current.getBoundingClientRect(),le=typeof l=="string"?parseFloat(l):l/Z*100,he=d?$.key==="ArrowLeft"||$.key==="ArrowDown":$.key==="ArrowRight"||$.key==="ArrowUp",Le=Math.min(Math.max(he?C.current+le:C.current-le,0),100);D({x:d?F:Z*Le/100,y:d?ce*Le/100:z})},[l,d,D]);p.useEffect(()=>{k(c?_.current:v.current)},[c]),p.useEffect(()=>{let $=v.current,z=()=>{T||B()};return n&&($.addEventListener("pointermove",G,Ex),$.addEventListener("pointerleave",z,Ex)),()=>{$.removeEventListener("pointermove",G),$.removeEventListener("pointerleave",z)}},[n,G,B,T]),p.useEffect(()=>(T&&!I.current&&(e.addEventListener("pointermove",G,Ex),e.addEventListener("pointerup",B,Ex),I.current=!0),()=>{I.current&&(e.removeEventListener("pointermove",G),e.removeEventListener("pointerup",B),I.current=!1)}),[G,B,T,e]),p.useImperativeHandle(x,()=>({rootContainer:v.current,handleContainer:_.current,setPosition($){let{width:z,height:F}=v.current.getBoundingClientRect();D({x:z/100*$,y:F/100*$})}}),[D]),mRe(v,W),hC("keydown",X,_.current,fC),hC("click",pRe,_.current,fC),hC("pointerdown",L,N,fC);let H=s||a.jsx(uRe,{disabled:r,portrait:d}),K=A?m:void 0,V={position:"relative",display:"flex",overflow:"hidden",cursor:T?d?"ns-resize":"ew-resize":void 0,touchAction:"none",userSelect:"none",KhtmlUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",...f};return a.jsxs("div",{...g,ref:v,style:V,"data-rcs":"root",children:[i,a.jsx(Tq,{ref:w,transition:K,children:o}),a.jsx(Iq,{disabled:r,portrait:d,position:Math.round(C.current),ref:_,transition:K,children:H})]})});Pq.displayName="ReactCompareSlider";var h1=p.forwardRef(({style:t,...e},n)=>{let r=dRe(t);return a.jsx("img",{ref:n,...e,style:r,"data-rcs":"image"})});h1.displayName="ReactCompareSliderImage";const gRe=()=>{var Y,re,ge,Oe,tt,J,te,me;const t=E0(),e=t.storeName,n=decodeURIComponent(t.productId),{getStoreByName:r,getProductById:s,updateProductImage:i,updateStore:o,isLoadingStores:l,viewMode:c,updateProductImagesArray:u}=Vn(),d=c==="published",{toast:h}=vs(),f=vi(),m=Hw(),[g,x]=p.useState(null),[v,w]=p.useState(null),[_,C]=p.useState(1),[T,R]=p.useState({}),[A,E]=p.useState(null),[I,N]=p.useState(!1),[k,j]=p.useState(""),[D,L]=p.useState([]),[G,B]=p.useState(!1),[W,X]=p.useState(!1),[H,K]=p.useState(null),[V,$]=p.useState(""),[z,F]=p.useState(!1),[Z,ce]=p.useState(!1),[le,he]=p.useState(""),[Le,$e]=p.useState(!1),[Be,ue]=p.useState(""),[Ce,Ie]=p.useState(""),[ve,ie]=p.useState(""),[Me,He]=p.useState([]),[yt,kt]=p.useState(!1),[en,mn]=p.useState(null),[cn,fn]=p.useState(""),[Ue,Et]=p.useState(""),[de,De]=p.useState(!1),[ee,ae]=p.useState(!1),Q=q=>{let ne=q.split(","),be=ne[0].match(/:(.*?);/)[1],Ne=atob(ne[1]),Ge=Ne.length,Se=new Uint8Array(Ge);for(;Ge--;)Se[Ge]=Ne.charCodeAt(Ge);return new Blob([Se],{type:be})},Pe=async()=>{if(!ve||!v||!g){h({title:"Missing data",description:"Cannot generate angles without an active image, product, or store context.",variant:"destructive"});return}De(!0);try{const{base64ImageData:q,mimeType:ne}=await Ve(ve),be=await B0(q,ne,v.name||"Product");if(be&&be.length>0){const Ne=[];for(const st of be)if(st.startsWith("data:")){const Mt=Q(st),xn=`angle-${Date.now()}-${Math.random().toString(36).substring(2,15)}.png`,Zr=`products/${g.id}/${v.id}/angles/${xn}`,Dn=mh(ph,Zr);await hh(Dn,Mt);const Gr=await fh(Dn);Ne.push(Gr)}else Ne.push(st);const Ge=Ne.map((st,Mt)=>({id:`angle-${v.id}-${Me.length+Mt}-${Ft()}`,src:{medium:st,large:st},alt:`${v.name} - Angle ${Me.length+Mt+1}`})),Se=[...Me,...Ge];He(Se);const it=Se.map(st=>st.src.large||st.src.medium);await u(g.id,v.id,it),h({title:"Angles Generated & Stored",description:`${Ne.length} new angle images added to gallery and storage.`})}else h({title:"No Angles Generated",description:"The AI did not return any new angle images.",variant:"default"})}catch(q){console.error("Error generating or storing angles on detail page:",q),h({title:"Angle Generation/Storage Failed",description:q.message,variant:"destructive"})}De(!1)},Ae=async q=>{var Ne,Ge;if(!g||!v)return;const ne=Me.filter(Se=>Se.id!==q);if(ne.length===0){const Se=`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(v.name||"Product")}`;He([{id:`placeholder-${v.id}`,src:{medium:Se,large:Se},alt:v.name||"Product image"}]),ie(Se)}else He(ne),(ve===((Ne=Me.find(Se=>Se.id===q))==null?void 0:Ne.src.large)||ve===((Ge=Me.find(Se=>Se.id===q))==null?void 0:Ge.src.medium))&&ie(ne[0].src.large||ne[0].src.medium);const be=ne.map(Se=>Se.src.large||Se.src.medium).filter(Se=>!Se.includes("via.placeholder.com"));await u(g.id,v.id,be),h({title:"Image Deleted",description:"Image removed from gallery.",variant:"destructive"})},Ve=p.useCallback(q=>new Promise((ne,be)=>{if(!q)return be(new Error("Image source is undefined or null."));if(q.startsWith("data:"))try{const Ne=q.split(",");if(Ne.length<2)throw new Error("Invalid data URL structure.");const Ge=Ne[0],Se=Ne[1],it=Ge.match(/:(.*?);/);if(!it||!it[1])throw new Error("Could not parse MIME type from data URL.");const st=it[1];ne({base64ImageData:Se,mimeType:st})}catch(Ne){console.error("Error parsing data URL:",q,Ne),be(new Error(`Invalid data URL format: ${Ne.message}`))}else{const Ne=new Image;Ne.crossOrigin="Anonymous",Ne.onload=()=>{const Ge=document.createElement("canvas");Ge.width=Ne.naturalWidth,Ge.height=Ne.naturalHeight,Ge.getContext("2d").drawImage(Ne,0,0);try{const Mt=Ge.toDataURL("image/png").split(",")[1];ne({base64ImageData:Mt,mimeType:"image/png"})}catch(it){console.error("Canvas toDataURL failed:",it),be(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas. "+it.message))}},Ne.onerror=Ge=>{console.error("Failed to load image from URL for conversion:",q,Ge),be(new Error("Failed to load image from URL for conversion."))},Ne.src=q}}),[]);p.useCallback(async()=>{if(!V.trim()||!ve||!v||!g){h({title:"Missing data",description:"Active image, edit prompt, product, or store context is missing.",variant:"destructive"});return}F(!0);try{const{base64ImageData:q,mimeType:ne}=await Ve(ve),be=await $o(q,ne,V);if(be&&be.editedImageData&&be.newMimeType){const Ne=`data:${be.newMimeType};base64,${be.editedImageData}`,Ge=Q(Ne),Se=`edited-${Date.now()}.png`,it=`products/${g.id}/${v.id}/images/${Se}`,st=mh(ph,it);await hh(st,Ge);const Mt=await fh(st),xn={id:Ft(),src:{medium:Mt,large:Mt},alt:`${v.name} (edited: ${V.substring(0,20)}...)`,photographer:"Edited with Gemini AI via Firebase Storage"};await i(g.id,n,xn);const Zr=Me.map(Dn=>Dn.src.medium===ve||Dn.src.large===ve?xn:Dn);Me.some(Dn=>Dn.src.medium===ve||Dn.src.large===ve)||Zr.push(xn),He(Zr),ie(Mt),h({title:"Image Edited & Stored",description:"Product image updated and saved to storage."}),X(!1),$("")}else throw new Error("AI did not return valid edited image data.")}catch(q){console.error("Error editing image or uploading to storage:",q),h({title:"Image Edit Failed",description:q.message,variant:"destructive"})}F(!1)},[ve,V,v,g,n,i,Me,h,Ve,Q]),p.useEffect(()=>{var ne,be,Ne,Ge;if(l)return;const q=r(e);if(q){x(q);const Se=s(q.id,n);if(Se){w(Se),j(Se.name),he(Se.video_url||""),ue(Se.model_3d_url||""),Ie(Se.model_3d_thumbnail_url||"");let it=[];Se.images&&Array.isArray(Se.images)&&Se.images.length>0?it=Se.images.map((Mt,xn)=>({id:`gallery-img-${Se.id}-${xn}-${Ft()}`,src:{medium:Mt,large:Mt},alt:`${Se.name||"Product"} image ${xn+1}`})):Se.image&&Se.image.src?it=[{id:Se.image.id||`gallery-img-${Se.id}-0-${Ft()}`,src:Se.image.src,alt:Se.image.alt||`${Se.name||"Product"} image`}]:it=[{id:`placeholder-${Se.id||Ft()}`,src:{medium:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(Se.name||"Product")}`,large:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(Se.name||"Product")}`},alt:Se.name||"Product image"}],Se.video_url&&it.push({id:`video-${Se.id}-${Ft()}`,src:{medium:Se.video_url,large:Se.video_url},alt:`${Se.name} video`,type:"video"}),He(it),ie(((be=(ne=it[0])==null?void 0:ne.src)==null?void 0:be.large)||((Ge=(Ne=it[0])==null?void 0:Ne.src)==null?void 0:Ge.medium)||"");let st=[];if(Se.options&&Array.isArray(Se.options)?st=Se.options:Se.variants&&Array.isArray(Se.variants)&&Se.variants.length>0&&Se.variants[0].name&&Se.variants[0].values&&(st=Se.variants),st.length>0){const Mt={};st.forEach(xn=>{xn.values&&xn.values.length>0&&(Mt[xn.name]=xn.values[0])}),R(Mt)}}else h({title:"Product not found",description:`Product ID ${n} not found in store ${q.name}.`,variant:"destructive"}),f(`/${e}`)}else h({title:"Store not found",description:`Could not find store: ${e}`,variant:"destructive"}),f("/")},[e,n,r,s,f,h,l]),p.useEffect(()=>{var q,ne,be,Ne,Ge;if(v&&Object.keys(T).length>0){if(((ne=(q=v.variants)==null?void 0:q.edges)==null?void 0:ne.length)>0){const Se=(be=v.variants.edges.find(it=>!it.node||!it.node.selectedOptions?!1:it.node.selectedOptions.every(st=>T[st.name]===st.value)))==null?void 0:be.node;if(Se){E(Se);return}}}else v&&((Ge=(Ne=v.variants)==null?void 0:Ne.edges)==null?void 0:Ge.length)>0&&Object.keys(T).length},[v,T]);const qe=q=>{const ne=parseInt(q.target.value);ne>0&&C(ne)},oe=async()=>{if(!g||!v||!Nt||Sn===void 0||!cr){h({title:"Error",description:"Product or store data is incomplete for checkout.",variant:"destructive"});return}ae(!0);try{const q=Me.map(st=>st.src.large||st.src.medium).filter(st=>st&&!st.includes("via.placeholder.com")&&!st.startsWith("data:")).slice(0,8),ne=`${window.location.origin}/${e}/product/${productIdFromUrl}`,be=Ja(m,"createStripePaymentLink"),Ne={productName:v.name,description:v.description||`High-quality ${v.name}`,images:q.length>0?q:Nt&&!Nt.includes("via.placeholder.com")&&!Nt.startsWith("data:")?[Nt]:[],unitAmount:Math.round(Sn*100),currency:cr.toLowerCase(),productUrl:ne,productMetadata:{productId:v.id,storeId:g.id,storeName:g.name},quantity:_,successUrl:`${window.location.origin}/order-confirmation?storeId=${g.id}&source=paymentlink&product_id=${v.id}`},Ge=await be(Ne),{paymentLinkUrl:Se,error:it}=Ge.data;if(it)throw new Error(it.message||"Failed to create Stripe Payment Link.");if(!Se)throw new Error("Stripe Payment Link URL not received.");window.location.href=Se}catch(q){console.error("Error creating Stripe Payment Link or redirecting:",q),h({title:"Checkout Setup Failed",description:q.message||"Could not prepare for checkout.",variant:"destructive"})}finally{ae(!1)}},_e=async()=>{if(k.trim()){B(!0);try{const q=await ro(k,5,"square");L(q)}catch(q){h({title:"Image search failed",description:q.message,variant:"destructive"})}B(!1)}},ze=async()=>{if(!k.trim()||!g||!v){h({title:"Missing context",description:"Store or product context is missing for image generation.",variant:"destructive"});return}B(!0);try{const q=`Product image for: ${k}, ${(v==null?void 0:v.type)||(g==null?void 0:g.type)||"item"}`,ne=await A0(q);if(!ne||!ne.url||!ne.url.startsWith("data:"))throw new Error("AI did not return a valid base64 image data URL.");const be=`gemini-${Date.now()}.png`,Ne=`products/${g.id}/${v.id}/images/${be}`,Ge=mh(ph,Ne),it=await(await fetch(ne.url)).blob();await hh(Ge,it);const st=await fh(Ge),Mt={id:Date.now().toString(),src:{medium:st,large:st},alt:ne.alt||k,photographer:"Gemini AI via Firebase Storage"};L(xn=>[Mt,...xn.slice(0,4)]),h({title:"Image Generated & Stored",description:"Gemini AI generated an image, and it has been uploaded to storage."})}catch(q){console.error("Gemini image generation or storage upload failed:",q),h({title:"Gemini Process Failed",description:q.message,variant:"destructive"})}B(!1)},Te=q=>{const ne=q.target.files[0];if(ne&&g&&v){B(!0);const be=`uploaded-${Date.now()}-${ne.name}`,Ne=`products/${g.id}/${v.id}/images/${be}`,Ge=mh(ph,Ne);hh(Ge,ne).then(()=>fh(Ge)).then(Se=>{const it={id:Ft(),src:{medium:Se,large:Se},alt:ne.name,photographer:"Uploaded by user via Firebase Storage"};L(st=>[it,...st.slice(0,4)]),h({title:"Image Uploaded & Stored",description:`${ne.name} uploaded. Select it from the results to use.`})}).catch(Se=>{console.error("Error uploading image to Firebase Storage:",Se),h({title:"Storage Upload Failed",description:Se.message,variant:"destructive"})}).finally(()=>{B(!1)})}else ne&&(h({title:"Missing context",description:"Store or product context is missing for image upload.",variant:"destructive"}),B(!1))},Tt=async q=>{if(!g||!v)return;const ne={id:`video-${v.id}-${Ft()}`,src:{medium:q,large:q},alt:`${v.name} video`,type:"video"},be=[...Me,ne];He(be);const Ne=be.filter(Se=>Se.type!=="video").map(Se=>Se.src.large||Se.src.medium),Ge=g.products.map(Se=>Se.id===n?{...Se,video_url:q,images:Ne}:Se);try{g&&g.id?(await o(g.id,{products:Ge}),he(q),h({title:"Product Video Generated",description:"The video has been added to the product gallery."})):h({title:"Error",description:"Store ID not available for video update.",variant:"destructive"})}catch(Se){console.error("Failed to update store with product video:",Se),h({title:"Update Failed",description:"Could not save the product video.",variant:"destructive"})}},wt=async q=>{if(!g||!v)return;const ne=g.products.map(be=>be.id===n?{...be,model_3d_url:q,model_3d_thumbnail_url:q}:be);try{g&&g.id?(await o(g.id,{products:ne}),ue(q),Ie(q),h({title:"3D Model Generated",description:"The 3D model has been added to the product."})):h({title:"Error",description:"Store ID not available for 3D model update.",variant:"destructive"})}catch(be){console.error("Failed to update store with 3D model:",be),h({title:"Update Failed",description:"Could not save the 3D model.",variant:"destructive"})}},xt=q=>{if(g&&g.id&&v&&q&&q.src&&(q.src.medium||q.src.large)){const ne=q.src.large||q.src.medium;if(ne.startsWith("https://firebasestorage.googleapis.com")||ne.startsWith("http://localhost:")||ne.startsWith("https://images.pexels.com")){const be={id:q.id||Ft(),src:{medium:ne,large:ne},alt:q.alt||v.name,photographer:q.photographer||"User"};if(i(g.id,n,be),!Me.find(Ge=>Ge.src.medium===ne||Ge.src.large===ne)){const Ge={...be,id:be.id||Ft()};He(Se=>{const it=Se.filter(st=>!st.src.medium.includes("via.placeholder.com"));return[Ge,...it.filter(st=>st.src.medium!==ne)]})}ie(ne),h({title:"Image Selected",description:"Product image updated."})}else h({title:"Invalid Image URL",description:"Selected image does not have a valid storage or Pexels URL.",variant:"destructive"})}else h({title:"Error",description:"Cannot select image. Store, product, or image data missing.",variant:"destructive"});N(!1),L([])};if(l||!g||!v)return a.jsxs("div",{className:"min-h-screen flex items-center justify-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary"}),a.jsx("p",{className:"ml-4 text-muted-foreground",children:"Loading product details..."})]});const pt=Me.find(q=>q.src.large===ve||q.src.medium===ve),Nt=ve||((re=(Y=v.image)==null?void 0:Y.src)==null?void 0:re.large)||((Oe=(ge=v.image)==null?void 0:ge.src)==null?void 0:Oe.medium)||`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(v.name)}`,jn=(pt==null?void 0:pt.alt)||((tt=v.image)==null?void 0:tt.alt)||v.name,Sn=((J=A==null?void 0:A.price)==null?void 0:J.amount)!==void 0?parseFloat(A.price.amount):v.price,cr=((te=A==null?void 0:A.price)==null?void 0:te.currencyCode)||v.currencyCode||"USD";let sn;v.inventory_count!==void 0?sn=v.inventory_count:v.stock!==void 0?sn=v.stock:sn=v.availableForSale?1:0;const Vt=((me=g==null?void 0:g.theme)==null?void 0:me.primaryColor)||"#000000";let tn=[];v&&(v.options&&Array.isArray(v.options)?tn=v.options.map(q=>({...q,name:q.name,values:q.values})):v.variants&&Array.isArray(v.variants)&&v.variants.length>0&&v.variants[0].name&&v.variants[0].values&&(tn=v.variants.map(q=>({...q,name:q.name,values:q.values}))));const Zn=async()=>{if(!v||!ve||Object.keys(T).length===0){h({title:"Cannot Visualize",description:"Product data, main image, or selected variants missing.",variant:"destructive"});return}kt(!0),mn(null),Et(ve);try{const{base64ImageData:q,mimeType:ne}=await Ve(ve);let be=[];for(const it in T)be.push(`${it}: ${T[it]}`);const Ne=be.join(", "),Ge=`Visualize the product "${v.name}" with the following attributes: ${Ne}. Apply these changes to the provided image.`,Se=await $o(q,ne,Ge);if(Se&&Se.editedImageData&&Se.newMimeType&&typeof Se.newMimeType=="string"&&Se.newMimeType.includes("/")){const it=`data:${Se.newMimeType};base64,${Se.editedImageData}`,st={id:`visualized-${Ft()}`,src:{medium:it,large:it},alt:`${v.name} visualized with ${Ne}`,photographer:"Variant Visualization by Gemini AI"};He(Mt=>[st,...Mt]),fn(st.src.medium||st.src.large),h({title:"Variant Visualized",description:"Comparison slider generated below."})}else{let it="AI image generation failed: ";throw Se?Se.editedImageData?Se.newMimeType?it+=`Invalid MIME type from AI ('${Se.newMimeType}').`:it+="Missing MIME type from AI.":it+="Missing image data from AI.":it+="No result from AI.",new Error(it)}}catch(q){console.error("Error visualizing variant:",q),mn(q.message),h({title:"Visualization Failed",description:q.message,variant:"destructive"})}kt(!1)};return a.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[a.jsx(Cq,{store:g,isPublishedView:d,productName:v.name}),a.jsxs(Pt.main,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"container mx-auto px-4 py-8 md:py-12 flex-grow",children:[a.jsxs(O,{variant:"outline",onClick:()=>f(`/${e}`),className:"mb-6",children:[a.jsx(Vo,{className:"mr-2 h-4 w-4"})," Back to Store"]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12",children:[a.jsxs(Pt.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},className:"flex flex-col items-center",children:[a.jsxs("div",{className:"relative group w-full",children:[ve&&Me.find(q=>(q.src.large===ve||q.src.medium===ve)&&q.type==="video")?a.jsx("video",{src:ve,controls:!0,autoPlay:!0,loop:!0,playsInline:!0,className:"w-full h-auto aspect-square object-cover rounded-xl shadow-lg border",children:"Your browser does not support the video tag."},ve):a.jsx("img",{src:Nt,alt:jn,className:"w-full h-auto aspect-square object-cover rounded-xl shadow-lg border"},ve),!d&&a.jsxs(a.Fragment,{children:[a.jsxs(O,{variant:"secondary",onClick:()=>N(!0),className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(k3,{className:"mr-2 h-4 w-4"})," Change Image"]}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>{K(v),X(!0)},className:"absolute top-16 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(Jv,{className:"mr-2 h-4 w-4"})," Edit Product"]}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>ce(!0),className:"absolute top-28 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(y2,{className:"mr-2 h-4 w-4"})," Gen Video"]}),a.jsxs(O,{variant:"outline",size:"sm",onClick:()=>$e(!0),className:"absolute top-40 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(wie,{className:"mr-2 h-4 w-4"})," Gen 3D"]})]})]}),Me.length>0&&a.jsxs(Pt.div,{className:"mt-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2,duration:.5},children:[a.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 gap-2",children:Me.map((q,ne)=>{var be,Ne;return a.jsxs(Pt.div,{className:"relative group",whileHover:{scale:1.05},children:[a.jsx("div",{className:`aspect-square rounded-md overflow-hidden cursor-pointer border-2 transition-all hover:opacity-80
                                    ${q.src.large===ve||q.src.medium===ve?"border-primary shadow-sm":"border-transparent"}`,onClick:()=>ie(q.src.large||q.src.medium),children:q.type==="video"?a.jsxs("div",{className:"relative w-full h-full",children:[a.jsx("video",{src:q.src.medium||q.src.large,className:"w-full h-full object-cover",poster:((Ne=(be=v.image)==null?void 0:be.src)==null?void 0:Ne.medium)||`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(v.name)}`}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50",children:a.jsx(y2,{className:"h-8 w-8 text-white"})})]}):a.jsx("img",{src:q.src.medium||q.src.large,alt:q.alt||`Product image ${ne+1}`,className:"w-full h-full object-cover"})}),!d&&Me.length>1&&!q.src.medium.includes("via.placeholder.com")&&a.jsx(O,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:Ge=>{Ge.stopPropagation(),Ae(q.id)},"aria-label":"Delete image",children:a.jsx(Fn,{className:"h-3 w-3"})})]},q.id||`gallery-${ne}`)})}),!d&&ve&&!ve.includes("via.placeholder.com")&&a.jsxs(O,{variant:"outline",size:"sm",className:"mt-3 w-full",onClick:Pe,disabled:de,children:[de?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Aie,{className:"mr-2 h-4 w-4"}),"Generate More Angles from Active Image"]})]})]}),a.jsxs(Pt.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"space-y-6",children:[a.jsx("h1",{className:"text-3xl lg:text-4xl font-bold tracking-tight text-foreground",children:v.name}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((q,ne)=>a.jsx(NI,{className:`h-5 w-5 ${ne<Math.floor(v.rating)?"text-amber-400 fill-amber-400":"text-muted-foreground/30"}`},ne))}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",v.rating," reviews)"]}),a.jsx(Oi,{orientation:"vertical",className:"h-5"}),a.jsx(dg,{variant:"outline",style:{borderColor:g.theme.primaryColor,color:g.theme.primaryColor},children:sn>0?"In Stock":"Out of Stock"})]}),a.jsxs("p",{className:"text-2xl lg:text-3xl font-semibold",style:{color:g.theme.primaryColor},children:[cr," ",Sn.toFixed(2)]}),tn.length>0&&a.jsxs("div",{className:"space-y-4 pt-4",children:[tn.map(q=>a.jsxs("div",{children:[a.jsxs(Re,{className:"text-sm font-medium text-foreground",children:[q.name,":",a.jsx("span",{className:"text-muted-foreground font-normal ml-1",children:T[q.name]||""})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:q.values.map(ne=>a.jsx(O,{variant:T[q.name]===ne?"default":"outline",size:"sm",onClick:()=>{R(be=>({...be,[q.name]:ne}))},style:T[q.name]===ne?{backgroundColor:Vt,color:"white",borderColor:Vt}:{borderColor:g.theme.secondaryColor||"#cccccc",color:g.theme.secondaryColor||"#333333"},children:ne},ne))})]},q.name)),tn.length>0&&Object.keys(T).length>0&&a.jsxs("div",{className:"mt-4 w-full",children:[cn&&Ue&&a.jsx("div",{className:"mb-3 flex justify-center",children:a.jsx(Pq,{itemOne:a.jsx(h1,{src:Ue,alt:"Original Image"}),itemTwo:a.jsx(h1,{src:cn,alt:"Visualized Variant"}),className:"w-full max-w-md h-auto aspect-square rounded-md border shadow-md"})}),a.jsxs(O,{onClick:Zn,disabled:yt,className:"w-full",variant:"outline",children:[yt?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ma,{className:"mr-2 h-4 w-4"}),"Visualize Variant"]}),en&&a.jsx("p",{className:"text-red-500 text-xs mt-2",children:en})]})]}),a.jsx("div",{className:"prose prose-sm sm:prose dark:prose-invert max-w-none text-muted-foreground pt-4",children:a.jsx("p",{children:v.description})}),v.tags&&v.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:v.tags.map(q=>a.jsx(dg,{variant:"secondary",children:q},q))}),a.jsx(Oi,{className:"my-6"}),a.jsxs("div",{className:"flex items-end gap-4 pt-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(Re,{htmlFor:"quantity",className:"text-sm",children:"Quantity"}),a.jsx(Je,{id:"quantity",type:"number",value:_,onChange:qe,min:"1",max:sn,className:"w-20 h-10 text-center",disabled:sn===0})]}),a.jsxs(O,{size:"lg",onClick:oe,className:"flex-1 h-10",style:{backgroundColor:Vt,color:"white"},disabled:sn===0,children:[a.jsx(Fp,{className:"mr-2 h-5 w-5"}),ee?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,sn===0?"Out of Stock":ee?"Processing...":"Proceed to Checkout"]})]})]})]}),Be&&a.jsxs(Pt.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-foreground",children:"3D Model"}),a.jsx(lRe,{modelUrl:Be,thumbnailUrl:Ce,productName:v.name,height:"500px",className:"w-full"})]}),v&&g&&g.id&&a.jsx(Pt.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.5},children:a.jsx(cRe,{product:v,storeId:g.id,isPublishedView:d})})]}),a.jsx(Eq,{store:g,isPublishedView:d}),!d&&a.jsxs(a.Fragment,{children:[a.jsx(Yr,{open:I,onOpenChange:N,children:a.jsxs($r,{className:"sm:max-w-2xl",children:[a.jsx(Ur,{children:a.jsx(Br,{children:"Change Product Image"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{placeholder:"Search Pexels or describe for AI...",value:k,onChange:q=>j(q.target.value)}),a.jsxs(O,{onClick:_e,disabled:G||!k.trim(),children:[G&&D.length===0?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Iie,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Pexels"})]}),a.jsxs(O,{onClick:ze,variant:"outline",disabled:G||!k.trim(),children:[G&&D.length>0?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(ma,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Gemini"})]}),a.jsxs(O,{variant:"outline",onClick:()=>{var q;return(q=document.getElementById("upload-image-input"))==null?void 0:q.click()},disabled:G,children:[a.jsx(Lo,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Upload"})]}),a.jsx(Je,{type:"file",id:"upload-image-input",className:"hidden",accept:"image/*",onChange:Te})]}),G&&D.length===0&&a.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"Searching for images or processing upload..."}),D.length>0&&a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-80 overflow-y-auto",children:D.map(q=>a.jsxs(Pt.div,{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>xt(q),whileHover:{scale:1.05},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:[a.jsx("img",{src:q.src.medium,alt:q.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(yRe,{className:"h-8 w-8 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/70 text-white text-xs p-1 truncate",children:q.photographer||q.alt})]},q.id))})]}),a.jsx(Ar,{children:a.jsx(rl,{asChild:!0,children:a.jsx(O,{type:"button",variant:"outline",children:"Cancel"})})})]})}),H&&a.jsx(ProductEditModal,{isOpen:W,onClose:()=>X(!1),product:H,onSave:async q=>{if(!g||!v)return;const ne=g.products.map(be=>be.id===q.id?{...be,...q}:be);await o(g.id,{products:ne}),w(q),h({title:"Product Updated",description:"Your product has been successfully updated."})},storeId:g.id}),v&&a.jsx(oRe,{open:Z,onOpenChange:ce,product:v,onVideoGenerated:Tt}),v&&a.jsx(aRe,{open:Le,onOpenChange:$e,product:v,onModelGenerated:wt,storeId:g==null?void 0:g.id})]})]})},yRe=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),xRe=()=>{const{cart:t,currentStore:e}=Vn(),{user:n}=yo(),[r,s]=p.useState(!1),[i,o]=p.useState(null),l=()=>t.reduce((u,d)=>u+d.price*d.quantity,0),c=async()=>{if(!n){o("You must be logged in to purchase.");return}s(!0),o(null);try{const u=t[0];if(!u)throw new Error("Your cart is empty.");const f=(await Ja(kh,"createProductCheckoutSession")({productName:u.name,productDescription:u.description,productImage:u.imageUrl,amount:u.price*100,currency:"usd",storeOwnerId:e.merchantId})).data;if(f&&f.url)window.location.href=f.url;else throw new Error("Failed to create checkout session.")}catch(u){console.error("Checkout error:",u),o(u.message||"An unexpected error occurred."),s(!1)}};return a.jsxs(a.Fragment,{children:[a.jsx(FA,{}),a.jsxs("div",{className:"container mx-auto p-4",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Checkout"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-2",children:"Order Summary"}),t.map(u=>a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:u.name}),a.jsxs("p",{children:["Quantity: ",u.quantity]})]}),a.jsxs("p",{children:["$",(u.price*u.quantity).toFixed(2)]})]},u.id)),a.jsx("hr",{className:"my-2"}),a.jsxs("div",{className:"flex justify-between font-bold",children:[a.jsx("p",{children:"Total"}),a.jsxs("p",{children:["$",l().toFixed(2)]})]})]}),a.jsxs("div",{children:[a.jsx("button",{onClick:c,disabled:r||t.length===0,className:"w-full bg-blue-500 text-white py-2 rounded disabled:bg-gray-400",children:r?"Processing...":"Purchase"}),i&&a.jsx("p",{className:"text-red-500 mt-2",children:i})]})]})]})]})},vRe="https://static.wixstatic.com/media/bd2e29_20f2a8a94b7e492a9d76e0b8b14e623b~mv2.png",wRe="https://static.wixstatic.com/media/bd2e29_c6677c7824044124b64fe765d0e9b88d~mv2.png";function bRe(){const[t,e]=p.useState(!0),[n,r]=p.useState(""),[s,i]=p.useState(!1),o=p.useRef(),l=p.useRef(),c=vi();p.useEffect(()=>{const h=localStorage.getItem("theme"),f=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;h==="dark"||!h&&f?(document.documentElement.classList.add("dark"),i(!0)):(document.documentElement.classList.remove("dark"),i(!1))},[]);const u=async h=>{r("");const f=o.current.value,m=l.current.value;if(!f||!m){r("Please enter both email and password.");return}try{let g;h==="login"?g=await Sge(dp,f,m):(g=await _ge(dp,f,m),await cp(Ai(nr,"profiles",g.user.uid),{id:g.user.uid,email:g.user.email,role:"store_owner",created_at:new Date})),c("/")}catch(g){console.error("Authentication error (Email/Password):",g.message),r(g.message)}},d=async()=>{r("");const h=new Fa;try{const m=(await qge(dp,h)).user,g=Ai(nr,"profiles",m.uid);(await v0e(g)).exists()||await cp(g,{id:m.uid,email:m.email,displayName:m.displayName,photoURL:m.photoURL,role:"store_owner",created_at:new Date}),c("/")}catch(f){console.error("Google Sign-In error:",f.message),f.code==="auth/popup-closed-by-user"?r("Google Sign-In was cancelled. Please try again."):f.code==="auth/account-exists-with-different-credential"?r("An account already exists with the same email address but different sign-in credentials. Try signing in with your original method."):r(`Google Sign-In failed: ${f.message}`)}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-cover bg-center bg-no-repeat p-4",style:{backgroundImage:`url(${wRe})`},children:a.jsxs("div",{className:`w-full max-w-md p-8 md:p-10 space-y-6
                   bg-white/10 dark:bg-black/30 backdrop-blur-lg
                   shadow-2xl rounded-xl border border-white/20 dark:border-black/20`,children:[a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("img",{src:vRe,alt:"FreshFront Logo",className:"h-12 w-auto"})}),a.jsx("h2",{className:"text-center text-3xl font-extrabold text-white mb-6",children:t?"Sign In":"Sign Up"}),n&&a.jsx("p",{className:"text-red-500 text-center",children:n}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),u(t?"login":"signup")},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-white mb-1",children:"Email"}),a.jsx("input",{type:"email",id:"email",ref:o,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"you@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-white mb-1",children:"Password"}),a.jsx("input",{type:"password",id:"password",ref:l,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:""})]}),a.jsx("button",{type:"submit",className:"w-full bg-black text-white py-3 rounded-md font-semibold hover:bg-gray-800 transition-colors",children:t?"Sign In":"Sign Up"})]}),a.jsxs("div",{className:"relative my-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:a.jsx("div",{className:"w-full border-t border-white/30"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 bg-white/10 dark:bg-black/30 text-white rounded-md",children:"Or continue with"})})]}),a.jsx("div",{children:a.jsxs("button",{type:"button",onClick:d,className:"w-full flex items-center justify-center gap-2 bg-white/90 dark:bg-white/10 text-black dark:text-white py-3 rounded-md font-semibold hover:bg-white dark:hover:bg-white/20 transition-colors border border-white/20",children:[a.jsx("svg",{className:"w-5 h-5","aria-hidden":"true",focusable:"false",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",children:a.jsxs("g",{fill:"none","fill-rule":"evenodd",children:[a.jsx("path",{d:"M17.64 9.2045c0-.6381-.0573-1.2518-.1636-1.8409H9v3.4818h4.8436c-.2086 1.125-.8427 2.0782-1.7777 2.7218v2.2582h2.9082c1.7018-1.5668 2.6836-3.8741 2.6836-6.621Z",fill:"#4285F4"}),a.jsx("path",{d:"M9 18c2.43 0 4.4673-.8055 5.9564-2.1818l-2.9082-2.2582c-.8055.5436-1.8368.8618-2.9945.8618-2.3127 0-4.2609-1.5668-4.9582-3.6709H1.0718v2.3318C2.5564 16.1632 5.5218 18 9 18Z",fill:"#34A853"}),a.jsx("path",{d:"M4.0418 10.7318c-.1164-.3464-.18-.7173-.18-1.0909 0-.3736.0636-.7445.18-1.0909V6.2182H1.0718C.3859 7.5614 0 9.0182 0 10.6409s.3859 3.0795 1.0718 4.4227l2.97-2.3318Z",fill:"#FBBC05"}),a.jsx("path",{d:"M9 3.5818c1.3218 0 2.5077.4559 3.4405 1.3468l2.5818-2.5818C13.4632.9918 11.43 0 9 0 5.5218 0 2.5564 1.8368 1.0718 4.5727l2.97 2.3318C4.7391 4.9855 6.6873 3.5818 9 3.5818Z",fill:"#EA4335"})]})}),t?"Sign in with Google":"Sign up with Google"]})}),a.jsxs("p",{className:"text-center text-sm text-white pt-4",children:[t?"Don't have an account?":"Already have an account?"," ",a.jsx("button",{onClick:()=>e(!t),className:"text-white hover:underline font-medium",children:t?"Sign Up":"Sign In"})]})]})})}const _Re=()=>{const{isAuthenticated:t,user:e}=yo();return a.jsxs(a.Fragment,{children:[a.jsx(FA,{}),a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Our Plan"}),a.jsx("p",{children:"Get full access to all store creation and management features."}),a.jsxs("div",{style:{border:"1px solid #ccc",padding:"20px",margin:"20px auto",maxWidth:"400px",borderRadius:"8px"},children:[a.jsx("h2",{children:"Store Creator Plan"}),a.jsx("p",{style:{fontSize:"2em",fontWeight:"bold",margin:"10px 0"},children:"$24.99 / month"}),a.jsxs("ul",{children:[a.jsx("li",{children:"Full access to publishing"}),a.jsx("li",{children:"Accept payments for your store"}),a.jsx("li",{children:"Unlimited products"}),a.jsx("li",{children:"And more!"})]}),t?null:a.jsxs("p",{children:["Please ",a.jsx(Xn,{to:"/auth",children:"log in or sign up"})," to subscribe."]})]})]})]})};function SRe(){return new URLSearchParams(gl().search)}const CRe=()=>{const e=SRe().get("session_id");p.useState(null);const[n,r]=p.useState(!0),[s,i]=p.useState(null);return p.useEffect(()=>{if(!e){i("No session ID found. Your order might still be processing."),r(!1);return}r(!1)},[e]),n?a.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Loading order details..."}):s?a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Order Status"}),a.jsx("p",{style:{color:"red"},children:s}),a.jsx(Xn,{to:"/",children:"Go to Homepage"})]}):a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Thank You for Your Order!"}),a.jsx("p",{children:"Your payment was successful and your order is being processed."}),a.jsxs("p",{children:["Order (Session ID): ",e]}),a.jsx("p",{children:"You will receive an email confirmation shortly."}),a.jsx(Xn,{to:"/",children:"Continue Shopping"})]})},ERe=()=>{const{isGenerating:t,progress:e,statusMessage:n}=Vn();return a.jsx(_c,{children:t&&a.jsx(Pt.div,{initial:{y:"-100%",opacity:0},animate:{y:"20px",opacity:1},exit:{y:"-100%",opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 left-0 right-0 flex justify-center z-[9999] p-4",children:a.jsxs(Xe,{className:"shadow-2xl rounded-xl overflow-hidden w-full max-w-md",children:[" ",a.jsxs(at,{className:"p-6 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Store Generation"}),a.jsxs("p",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400",children:[Math.floor(e),"%"]})]}),a.jsx(Oa,{value:e,className:"w-full h-2 [&>div]:bg-blue-600"}),a.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 pt-1 min-h-[1.2em]",children:n||"Processing..."})]})]})})})},TRe=()=>a.jsxs(rEe,{children:[a.jsx(ERe,{})," ",a.jsxs("main",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-gray-900 dark:to-slate-900",children:[a.jsx(vX,{})," ",a.jsx(soe,{}),a.jsx(wq,{})," "]})]});const IRe=({children:t,activeTab:e,setActiveTab:n,storeId:r,storeName:s})=>{const[i,o]=p.useState(""),[l,c]=p.useState([]),u=[{id:"orders",label:"Orders",icon:a.jsx(Fp,{className:"h-5 w-5"})},{id:"products",label:"Products",icon:a.jsx(Mi,{className:"h-5 w-5"})},{id:"customers",label:"Customers",icon:a.jsx(j0,{className:"h-5 w-5"})},{id:"payments",label:"Payments",icon:a.jsx(Po,{className:"h-5 w-5"})},{id:"analytics",label:"Analytics",icon:a.jsx(Kv,{className:"h-5 w-5"})},{id:"marketing",label:"Marketing",icon:a.jsx(oh,{className:"h-5 w-5"})},{id:"shipping",label:"Shipping",icon:a.jsx(Zv,{className:"h-5 w-5"})},{id:"settings",label:"Settings",icon:a.jsx(Sh,{className:"h-5 w-5"})}],d=u.map(m=>({id:m.id,label:m.label,tab:m.id})),h=m=>{const g=m.target.value;if(o(g),g.trim()===""){c([]);return}const x=g.toLowerCase(),v=[];d.forEach(w=>{w.label.toLowerCase().includes(x)&&v.push({id:`${w.id}-main`,label:w.label,tab:w.tab}),w.subItems&&w.subItems.forEach(_=>{_.label.toLowerCase().includes(x)&&v.push({id:_.id,label:`${w.label} > ${_.label}`,tab:w.tab})})}),c(v)},f=m=>{n(m.tab),o(""),c([])};return a.jsxs("div",{className:"flex h-screen bg-muted/40",children:[" ",a.jsxs("div",{className:"w-64 bg-card border-r border-border flex flex-col",children:[" ",a.jsxs("div",{className:"p-4 border-b flex items-center gap-2",children:[" ",s&&a.jsx(O,{asChild:!0,variant:"outline",size:"icon",className:"flex-shrink-0",children:a.jsxs(Xn,{to:`/${s}`,children:[" ",a.jsx(Vo,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Back to Store"})]})}),a.jsxs("div",{className:"relative flex-grow",children:[" ",a.jsx(ju,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),a.jsx(Je,{type:"text",placeholder:"Search dashboard...",className:"pl-9 w-full",value:i,onChange:h}),l.length>0&&a.jsxs(Xe,{className:"absolute mt-1 w-full z-50 max-h-64 overflow-y-auto shadow-lg",children:[" ",a.jsxs("div",{className:"p-1",children:[" ",l.map(m=>a.jsx("button",{className:"w-full text-left px-3 py-1.5 hover:bg-accent rounded-md text-sm",onClick:()=>f(m),children:m.label},m.id))]})]})]})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[" ",u.map(m=>a.jsxs(O,{variant:e===m.id?"secondary":"ghost",className:"w-full justify-start text-left h-10 px-3",onClick:()=>n(m.id),children:[a.jsx("span",{className:"mr-3",children:m.icon})," ",m.label]},m.id))]}),a.jsx("div",{className:"p-4 border-t",children:a.jsx(O,{variant:"ghost",className:"w-full justify-start text-left",children:"Help & Support"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[" ",t]})]})},KF=()=>{const[t,e]=p.useState("all"),n=[{id:"ORD-1234",customer:"John Doe",date:"2023-05-15",total:"$129.99",status:"Fulfilled"},{id:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",total:"$89.50",status:"Processing"},{id:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",total:"$210.75",status:"Pending"}],r=[{id:"CART-567",customer:"Emily Davis",date:"2023-05-15",items:3,total:"$78.45",timeSpent:"12m 30s"},{id:"CART-568",customer:"Michael Brown",date:"2023-05-14",items:2,total:"$45.99",timeSpent:"5m 15s"}],s=[{id:"RET-890",orderId:"ORD-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Wrong size"},{id:"RET-891",orderId:"ORD-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Damaged item"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Orders"}),a.jsxs(bi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ei,{className:"grid grid-cols-4 mb-6",children:[a.jsxs($t,{value:"all",children:[a.jsx(Fp,{className:"mr-2 h-4 w-4"}),"All Orders"]}),a.jsxs($t,{value:"abandoned",children:[a.jsx(_g,{className:"mr-2 h-4 w-4"}),"Abandoned Checkouts"]}),a.jsxs($t,{value:"returns",children:[a.jsx(Xv,{className:"mr-2 h-4 w-4"}),"Returns & Refunds"]}),a.jsxs($t,{value:"fulfillment",children:[a.jsx(Mi,{className:"mr-2 h-4 w-4"}),"Order Fulfillment"]})]}),a.jsx(Ut,{value:"all",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"All Orders"}),a.jsx(Qt,{children:"View and manage all customer orders"})]}),a.jsx(at,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View"})})]},i.id))})]})})})]})}),a.jsx(Ut,{value:"abandoned",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Abandoned Checkouts"}),a.jsx(Qt,{children:"View details of abandoned shopping carts"})]}),a.jsx(at,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Cart ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Items"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Time Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.items}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:i.timeSpent}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Details"})})]},i.id))})]})})})]})}),a.jsx(Ut,{value:"returns",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Returns & Refunds"}),a.jsx(Qt,{children:"Manage customer returns and process refunds"})]}),a.jsx(at,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Return ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.orderId}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.amount}),a.jsx("td",{className:"py-3 px-4",children:i.reason}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"outline",size:"sm",children:"Process"})]})]},i.id))})]})})})]})}),a.jsx(Ut,{value:"fulfillment",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Order Fulfillment"}),a.jsx(Qt,{children:"Manage and fulfill pending orders"})]}),a.jsx(at,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Fraud Risk"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer Score"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsxs("td",{className:"py-3 px-4",children:[Math.floor(Math.random()*100),"/100"]}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"default",size:"sm",disabled:i.status==="Fulfilled",children:"Fulfill"})]})]},i.id))})]})})})]})})]})]})},NRe=()=>{const[t,e]=p.useState("all"),n=[{id:"PRD-1234",name:"Premium T-Shirt",category:"Apparel",price:"$29.99",inventory:45,status:"Active"},{id:"PRD-1235",name:"Wireless Headphones",category:"Electronics",price:"$89.50",inventory:12,status:"Active"},{id:"PRD-1236",name:"Leather Wallet",category:"Accessories",price:"$49.99",inventory:0,status:"Out of Stock"}],r=[{id:"COL-567",name:"Summer Collection",products:12,type:"Manual",status:"Active"},{id:"COL-568",name:"Holiday Specials",products:8,type:"AI Generated",status:"Draft"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Products"}),a.jsxs(bi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ei,{className:"grid grid-cols-3 mb-6",children:[a.jsxs($t,{value:"all",children:[a.jsx(Mi,{className:"mr-2 h-4 w-4"}),"All Products"]}),a.jsxs($t,{value:"inventory",children:[a.jsx(Bm,{className:"mr-2 h-4 w-4"}),"Inventory"]}),a.jsxs($t,{value:"collections",children:[a.jsx(q_,{className:"mr-2 h-4 w-4"}),"Collections"]})]}),a.jsx(Ut,{value:"all",children:a.jsxs(Xe,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"All Products"}),a.jsx(Qt,{children:"Manage your product catalog"})]}),a.jsxs(O,{children:[a.jsx(Mi,{className:"mr-2 h-4 w-4"}),"Add Product"]})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(Je,{placeholder:"Search products...",className:"max-w-sm mr-2"}),a.jsx(O,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Inventory"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.category}),a.jsx("td",{className:"py-3 px-4",children:s.price}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})]})]})}),a.jsx(Ut,{value:"inventory",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Inventory Management"}),a.jsx(Qt,{children:"Track and update product inventory levels"})]}),a.jsx(at,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Stock"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Low Stock Alert"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:"10"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.inventory>10?"bg-green-100 text-green-800":s.inventory>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.inventory>10?"In Stock":s.inventory>0?"Low Stock":"Out of Stock"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Update Stock"})})]},s.id))})]})})})]})}),a.jsx(Ut,{value:"collections",children:a.jsxs(Xe,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Collections"}),a.jsx(Qt,{children:"Organize products into collections"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(q_,{className:"mr-2 h-4 w-4"}),"Create Manual Collection"]}),a.jsxs(O,{children:[a.jsx(q_,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]}),a.jsx(at,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Collection Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.type}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})})]})})]})]})},PRe=()=>{const t=[{id:"CUS-1234",name:"John Doe",email:"john.doe@example.com",orders:5,totalSpent:"$345.75",lastOrder:"2023-05-10",segment:"Loyal"},{id:"CUS-1235",name:"Jane Smith",email:"jane.smith@example.com",orders:2,totalSpent:"$129.50",lastOrder:"2023-04-22",segment:"New"},{id:"CUS-1236",name:"Robert Johnson",email:"robert.j@example.com",orders:8,totalSpent:"$780.25",lastOrder:"2023-05-15",segment:"VIP"}],e=[{id:"SEG-1",name:"New Customers",count:124,description:"Customers with 1-2 orders"},{id:"SEG-2",name:"Loyal Customers",count:86,description:"Customers with 3-7 orders"},{id:"SEG-3",name:"VIP Customers",count:32,description:"Customers with 8+ orders"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Customers"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:e.map(n=>a.jsxs(Xe,{children:[a.jsxs(ct,{className:"pb-2",children:[a.jsx(ut,{className:"text-lg",children:n.name}),a.jsx(Qt,{children:n.description})]}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:n.count}),a.jsx(O,{variant:"link",className:"p-0",children:"View customers"})]})]},n.id))}),a.jsxs(Xe,{className:"mb-6",children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Customer Insights"}),a.jsx(Qt,{children:"AI-generated insights about your customer base"})]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Uie,{className:"mr-2 h-4 w-4"}),"Generate New Insights"]})]}),a.jsx(at,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Your customer base is primarily 25-34 years old (45%), followed by 35-44 years old (30%). The gender distribution is 55% female and 45% male."})]}),a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Geographic Distribution"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Geographic map placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Most of your customers are from California (25%), New York (18%), and Texas (12%). International customers make up 15% of your customer base."})]})]})})]}),a.jsxs(Xe,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"All Customers"}),a.jsx(Qt,{children:"View and manage your customer database"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(Bm,{className:"mr-2 h-4 w-4"}),"Add Tags"]}),a.jsxs(O,{children:[a.jsx(j0,{className:"mr-2 h-4 w-4"}),"Create Segment"]})]})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(Je,{placeholder:"Search customers...",className:"max-w-sm mr-2"}),a.jsx(O,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Email"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Orders"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Last Order"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Segment"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:t.map(n=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:n.id}),a.jsx("td",{className:"py-3 px-4",children:n.name}),a.jsx("td",{className:"py-3 px-4",children:n.email}),a.jsx("td",{className:"py-3 px-4",children:n.orders}),a.jsx("td",{className:"py-3 px-4",children:n.totalSpent}),a.jsx("td",{className:"py-3 px-4",children:n.lastOrder}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${n.segment==="VIP"?"bg-purple-100 text-purple-800":n.segment==="Loyal"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:n.segment})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Profile"})})]},n.id))})]})})]})]})]})},ARe=()=>{const[t,e]=p.useState("transactions"),{session:n,user:r}=yo(),[s,i]=p.useState(!1),[o,l]=p.useState(null),c=async()=>{if(!(n!=null&&n.access_token)||!r){l("Authentication token not found. Please log in again.");return}i(!0),l(null);try{const f=await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/create-stripe-connect-account",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n.access_token}`},body:JSON.stringify({record:{id:r.id,email:r.email}})}),m=await f.json();if(!f.ok){const g=m.error||m.data&&m.data.error||"Failed to create Stripe Connect account link.";throw new Error(g)}if(m.account_link_url)window.location.href=m.account_link_url;else if(m.url)window.location.href=m.url;else throw new Error("No URL returned from Stripe Connect account creation.")}catch(f){console.error("Stripe Connect account creation error:",f),l(f.message)}finally{i(!1)}},u=[{id:"TRX-1234",orderId:"ORD-1234",customer:"John Doe",date:"2023-05-15",amount:"$129.99",status:"Completed",method:"Credit Card"},{id:"TRX-1235",orderId:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",amount:"$89.50",status:"Completed",method:"PayPal"},{id:"TRX-1236",orderId:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",amount:"$210.75",status:"Pending",method:"Credit Card"}],d=[{id:"PAY-567",date:"2023-05-15",amount:"$1,245.75",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-568",date:"2023-05-01",amount:"$980.50",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-569",scheduledDate:"2023-06-01",estimatedAmount:"$1,500.00",status:"Scheduled",destination:"Bank Account (****1234)"}],h=[{id:"DSP-890",transactionId:"TRX-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Item not received",status:"Under Review"},{id:"DSP-891",transactionId:"TRX-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Unauthorized charge",status:"Lost"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Payments & Payouts"}),a.jsxs(bi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ei,{className:"grid grid-cols-4 mb-6",children:[" ",a.jsxs($t,{value:"overview",children:[" ",a.jsx(Wh,{className:"mr-2 h-4 w-4"}),"Connect Account"]}),a.jsxs($t,{value:"transactions",children:[a.jsx(Po,{className:"mr-2 h-4 w-4"}),"Transactions"]}),a.jsxs($t,{value:"payouts",children:[a.jsx(CI,{className:"mr-2 h-4 w-4"}),"Payout Schedule"]}),a.jsxs($t,{value:"disputes",children:[a.jsx(_g,{className:"mr-2 h-4 w-4"}),"Disputes & Chargebacks"]})]}),a.jsxs(Ut,{value:"overview",children:[" ",a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Connect Stripe Account"}),a.jsx(Qt,{children:"Connect your Stripe account to start accepting payments and manage payouts."})]}),a.jsxs(at,{children:[a.jsxs(O,{onClick:c,disabled:s,children:[a.jsx(Wh,{className:"mr-2 h-4 w-4"}),s?"Connecting...":"Connect with Stripe"]}),o&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:o})]})]})]}),a.jsx(Ut,{value:"transactions",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"All Transactions"}),a.jsx(Qt,{children:"View all payment transactions"})]}),a.jsx(at,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:u.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.orderId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.method}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})})})]})}),a.jsx(Ut,{value:"payouts",children:a.jsxs(Xe,{className:"mb-6",children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Payout Schedule"}),a.jsx(Qt,{children:"Manage your payout schedule and instant transfers"})]}),a.jsxs(O,{children:[a.jsx(Po,{className:"mr-2 h-4 w-4"}),"Instant Transfer"]})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Current Balance"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,845.75"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Available for payout"})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Next Payout"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,500.00"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheduled for June 1, 2023"})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Payout Schedule"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-xl font-medium",children:"Monthly"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Every 1st of the month"}),a.jsx(O,{variant:"link",className:"p-0 mt-2",children:"Change schedule"})]})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Payout History"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Payout ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Destination"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:d.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.date||f.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:f.amount||f.estimatedAmount}),a.jsx("td",{className:"py-3 px-4",children:f.destination}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})]})]})]})}),a.jsx(Ut,{value:"disputes",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Disputes & Chargebacks"}),a.jsx(Qt,{children:"Manage payment disputes and chargebacks"})]}),a.jsx(at,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Dispute ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"AI Analysis"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.transactionId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.reason}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Under Review"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:f.status==="Under Review"?a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"High chance of winning"}):a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"Insufficient evidence"})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),f.status==="Under Review"&&a.jsx(O,{variant:"default",size:"sm",children:"Respond"})]})]},f.id))})]})})})]})})]})]})},kRe=()=>{const[t,e]=p.useState("sales");return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Analytics & Reports"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Total Sales"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$12,845.75"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Xf,{className:"h-4 w-4 mr-1"})," +15% from last month"]})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Orders"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"156"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Xf,{className:"h-4 w-4 mr-1"})," +8% from last month"]})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Conversion Rate"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3.2%"}),a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(Xf,{className:"h-4 w-4 mr-1"})," -0.5% from last month"]})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Avg. Order Value"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$82.34"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(Xf,{className:"h-4 w-4 mr-1"})," +5% from last month"]})]})]})]}),a.jsxs(bi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ei,{className:"grid grid-cols-5 mb-6",children:[a.jsxs($t,{value:"sales",children:[a.jsx(Kv,{className:"mr-2 h-4 w-4"}),"Sales Reports"]}),a.jsxs($t,{value:"traffic",children:[a.jsx(Xf,{className:"mr-2 h-4 w-4"}),"Traffic & Conversion"]}),a.jsxs($t,{value:"customers",children:[a.jsx(j0,{className:"mr-2 h-4 w-4"}),"Customer Insights"]}),a.jsxs($t,{value:"marketing",children:[a.jsx(R3,{className:"mr-2 h-4 w-4"}),"Marketing Attribution"]}),a.jsxs($t,{value:"products",children:[a.jsx(Mi,{className:"mr-2 h-4 w-4"}),"Product Performance"]})]}),a.jsx(Ut,{value:"sales",children:a.jsxs(Xe,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Sales Overview"}),a.jsx(Qt,{children:"Comprehensive sales data with AI summarization"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(O,{variant:"outline",children:"Export"}),a.jsx(O,{variant:"outline",children:"Print"})]})]}),a.jsxs(at,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Sales chart placeholder"})})}),a.jsxs(Xe,{className:"bg-muted/30",children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"AI Sales Summary"})}),a.jsxs(at,{children:[a.jsxs("p",{className:"text-sm",children:[a.jsx("strong",{children:"Key Insights:"}),' Your sales have increased by 15% compared to last month, with the highest growth in the "Electronics" category (+24%). Weekend sales are particularly strong, accounting for 45% of your weekly revenue. The average order value has increased by 5%, indicating customers are purchasing higher-value items.']}),a.jsxs("p",{className:"text-sm mt-2",children:[a.jsx("strong",{children:"Recommendations:"}),' Consider running promotions on weekdays to boost sales during slower periods. The "Apparel" category has seen a slight decline (-3%) and may benefit from new product additions or targeted marketing.']})]})]})]})]})}),a.jsx(Ut,{value:"traffic",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Traffic & Conversion Analysis"}),a.jsx(Qt,{children:"Website traffic sources and conversion rates"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Traffic Sources"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Traffic sources chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Conversion Funnel"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Conversion funnel chart placeholder"})})]})]}),a.jsxs(Xe,{className:"bg-muted/30",children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"AI Conversion Recommendations"})}),a.jsxs(at,{children:[a.jsx("p",{className:"text-sm",children:"Your current conversion rate of 3.2% is below the industry average of 4.5% for e-commerce stores in your category. The biggest drop-off occurs at the checkout page (45% abandonment rate)."}),a.jsx("p",{className:"text-sm mt-2",children:a.jsx("strong",{children:"Recommendations:"})}),a.jsxs("ul",{className:"text-sm list-disc pl-5 mt-1",children:[a.jsx("li",{children:"Simplify your checkout process by reducing the number of form fields"}),a.jsx("li",{children:"Add trust badges and security indicators near payment information"}),a.jsx("li",{children:"Implement exit-intent popups with discount offers to reduce cart abandonment"}),a.jsx("li",{children:"Optimize product page load times (currently averaging 3.2s, aim for under 2s)"})]})]})]})]})]})}),a.jsx(Ut,{value:"customers",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Customer Insights"}),a.jsx(Qt,{children:"Detailed analysis of customer behavior and demographics"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Purchase Frequency"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Purchase frequency chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Lifetime Value"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"CLV chart placeholder"})})]})]}),a.jsxs(Xe,{className:"bg-muted/30",children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Customer Personas"})}),a.jsx(at,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Tech-Savvy Millennials"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"25-34 years old, urban areas, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Prefer electronics and premium products, shop primarily on mobile devices"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Budget-Conscious Families"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"35-44 years old, suburban areas, middle income"}),a.jsx("p",{className:"text-sm mt-2",children:"Focus on value, frequently use discount codes, buy in bulk"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Luxury Shoppers"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"45-60 years old, various locations, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Purchase high-end products, less price sensitive, value quality and service"})]})]})})]})]})]})}),a.jsx(Ut,{value:"marketing",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Marketing Attribution"}),a.jsx(Qt,{children:"Track the effectiveness of your marketing channels"})]}),a.jsxs(at,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Marketing attribution chart placeholder"})})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Channel"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Sessions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conv. Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"ROAS"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Organic Search"}),a.jsx("td",{className:"py-3 px-4",children:"2,456"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"4.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$7,845.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Paid Search"}),a.jsx("td",{className:"py-3 px-4",children:"1,245"}),a.jsx("td",{className:"py-3 px-4",children:"62"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$4,980.00"}),a.jsx("td",{className:"py-3 px-4",children:"3.2x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Social Media"}),a.jsx("td",{className:"py-3 px-4",children:"3,120"}),a.jsx("td",{className:"py-3 px-4",children:"78"}),a.jsx("td",{className:"py-3 px-4",children:"2.5%"}),a.jsx("td",{className:"py-3 px-4",children:"$5,460.00"}),a.jsx("td",{className:"py-3 px-4",children:"2.8x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Email Marketing"}),a.jsx("td",{className:"py-3 px-4",children:"980"}),a.jsx("td",{className:"py-3 px-4",children:"49"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,920.00"}),a.jsx("td",{className:"py-3 px-4",children:"4.5x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Direct"}),a.jsx("td",{className:"py-3 px-4",children:"1,560"}),a.jsx("td",{className:"py-3 px-4",children:"47"}),a.jsx("td",{className:"py-3 px-4",children:"3.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,760.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]})]})]})})]})]})}),a.jsx(Ut,{value:"products",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Product Performance"}),a.jsx(Qt,{children:"Detailed analysis of product sales and performance"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Selling Products"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Top products chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Product Category Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Category performance chart placeholder"})})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Units Sold"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Profit Margin"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Return Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Rating"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Premium T-Shirt"}),a.jsx("td",{className:"py-3 px-4",children:"Apparel"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:"$7,345.55"}),a.jsx("td",{className:"py-3 px-4",children:"45%"}),a.jsx("td",{className:"py-3 px-4",children:"2.1%"}),a.jsx("td",{className:"py-3 px-4",children:"4.8/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Wireless Headphones"}),a.jsx("td",{className:"py-3 px-4",children:"Electronics"}),a.jsx("td",{className:"py-3 px-4",children:"124"}),a.jsx("td",{className:"py-3 px-4",children:"$11,098.00"}),a.jsx("td",{className:"py-3 px-4",children:"32%"}),a.jsx("td",{className:"py-3 px-4",children:"3.5%"}),a.jsx("td",{className:"py-3 px-4",children:"4.6/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Leather Wallet"}),a.jsx("td",{className:"py-3 px-4",children:"Accessories"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"$4,899.02"}),a.jsx("td",{className:"py-3 px-4",children:"55%"}),a.jsx("td",{className:"py-3 px-4",children:"1.2%"}),a.jsx("td",{className:"py-3 px-4",children:"4.9/5"})]})]})]})})]})]})})]})]})},RRe=()=>{const[t,e]=p.useState("email"),n=[{id:"EM-1234",name:"Summer Sale Announcement",status:"Sent",sentDate:"2023-05-15",opens:1245,clicks:356,conversions:28,revenue:"$2,450"},{id:"EM-1235",name:"New Product Launch",status:"Draft",lastEdited:"2023-05-14"},{id:"EM-1236",name:"Customer Feedback Request",status:"Scheduled",scheduledDate:"2023-05-20"},{id:"EM-1237",name:"Abandoned Cart Recovery",status:"Sent",sentDate:"2023-05-12",opens:876,clicks:234,conversions:15,revenue:"$1,280"}],r=[{id:"SM-567",platform:"Instagram",content:"Summer collection now available!",status:"Published",publishDate:"2023-05-15",engagement:245,likes:189,comments:32},{id:"SM-568",platform:"Facebook",content:"Limited time offer: 20% off all accessories",status:"Scheduled",scheduledDate:"2023-05-18"},{id:"SM-569",platform:"Twitter",content:"Flash sale today only! Use code FLASH25",status:"Published",publishDate:"2023-05-14",engagement:178,likes:45,comments:12},{id:"SM-570",platform:"TikTok",content:"Behind the scenes of our latest photoshoot",status:"Draft",lastEdited:"2023-05-16"}],s=[{id:"BLG-890",title:"10 Summer Fashion Trends",status:"Published",publishDate:"2023-05-10",views:1245,comments:23,shares:56},{id:"BLG-891",title:"How to Choose the Perfect Headphones",status:"Draft",lastEdited:"2023-05-14"},{id:"BLG-892",title:"Sustainable Fashion: Our Commitment",status:"Published",publishDate:"2023-05-05",views:980,comments:18,shares:42},{id:"BLG-893",title:"Gift Guide: Father's Day Edition",status:"Scheduled",scheduledDate:"2023-05-25"}],i=[{id:"PROMO-123",name:"Summer Sale",type:"Discount",value:"20% off",status:"Active",startDate:"2023-05-01",endDate:"2023-05-31",usageCount:245},{id:"PROMO-124",name:"Free Shipping",type:"Free Shipping",value:"Orders over $50",status:"Active",startDate:"2023-05-01",endDate:"2023-06-30",usageCount:189},{id:"PROMO-125",name:"WELCOME10",type:"Discount",value:"10% off first order",status:"Active",startDate:"2023-01-01",endDate:"2023-12-31",usageCount:567},{id:"PROMO-126",name:"Holiday Bundle",type:"Bundle",value:"Buy 2 Get 1 Free",status:"Draft",startDate:"2023-11-15",endDate:"2023-12-25"}];return a.jsxs("div",{className:"bg-background",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Marketing"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(O,{variant:"outline",size:"sm",children:[a.jsx(CI,{className:"h-4 w-4 mr-2"}),"Content Calendar"]}),a.jsxs(O,{size:"sm",children:[a.jsx(Li,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Email Performance"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"24.5%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Average open rate"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+2.3% from last month"})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Social Engagement"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"1,245"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Total interactions"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+15% from last month"})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Blog Traffic"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3,890"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly page views"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+8% from last month"})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Promo Conversions"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"12.8%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Conversion rate"}),a.jsx("p",{className:"text-sm text-red-600 mt-2",children:"-1.2% from last month"})]})]})]}),a.jsxs(bi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ei,{className:"grid grid-cols-5 mb-6",children:[a.jsxs($t,{value:"email",children:[a.jsx(oh,{className:"mr-2 h-4 w-4"}),"Email Campaigns"]}),a.jsxs($t,{value:"social",children:[a.jsx(Ux,{className:"mr-2 h-4 w-4"}),"Social Media"]}),a.jsxs($t,{value:"seo",children:[a.jsx(ju,{className:"mr-2 h-4 w-4"}),"SEO Tools"]}),a.jsxs($t,{value:"blog",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Blog"]}),a.jsxs($t,{value:"promotions",children:[a.jsx(Bm,{className:"mr-2 h-4 w-4"}),"Promotions"]})]}),a.jsx(Ut,{value:"email",children:a.jsxs(Xe,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Email Campaigns"}),a.jsx(Qt,{children:"Create and manage email marketing campaigns"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(oh,{className:"mr-2 h-4 w-4"}),"Import Template"]}),a.jsxs(O,{children:[a.jsx(oh,{className:"mr-2 h-4 w-4"}),"Create Campaign"]})]})]}),a.jsxs(at,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Campaign Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Opens"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Clicks"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Sent"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.sentDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.opens||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.clicks||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.conversions||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.revenue||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Sent"&&a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Email Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate professional marketing emails with AI, including copy and layout suggestions."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(oh,{className:"mr-2 h-4 w-4"}),"Generate New Email"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Kv,{className:"mr-2 h-4 w-4"}),"A/B Test Generator"]})]})]})]})]})}),a.jsx(Ut,{value:"social",children:a.jsxs(Xe,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Social Media Campaigns"}),a.jsx(Qt,{children:"Create and schedule social media content"})]}),a.jsxs(O,{children:[a.jsx(Ux,{className:"mr-2 h-4 w-4"}),"Create Post"]})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Content Calendar"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Content calendar placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Platform Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Performance chart placeholder"})})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Recent Posts"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Platform"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Content"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Engagement"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Likes"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.platform}),a.jsx("td",{className:"py-3 px-4",children:o.content}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.scheduledDate||o.lastEdited}),a.jsx("td",{className:"py-3 px-4",children:o.engagement||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.likes||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Published"&&a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Transform product images into engaging social media content with AI."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Ux,{className:"mr-2 h-4 w-4"}),"Generate Social Media Images"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Caption Ideas"]})]})]})]})]})}),a.jsx(Ut,{value:"seo",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"SEO Tools"}),a.jsx(Qt,{children:"Optimize your store for search engines"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Keyword Research"})}),a.jsxs(at,{children:[a.jsxs("div",{className:"mb-4 flex gap-2",children:[a.jsx(Je,{placeholder:"Enter a keyword to research...",className:"flex-1"}),a.jsxs(O,{children:[a.jsx(ju,{className:"mr-2 h-4 w-4"}),"Analyze"]})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Recent searches: wireless headphones, premium t-shirts, leather wallet"})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"SEO Performance"})}),a.jsx(at,{children:a.jsx("div",{className:"h-40 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"SEO performance chart placeholder"})})})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Keywords"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Keyword"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Search Volume"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Difficulty"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Ranking"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Traffic"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"wireless headphones"}),a.jsx("td",{className:"py-3 px-4",children:"12,400"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800",children:"Medium"})}),a.jsx("td",{className:"py-3 px-4",children:"#8"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"premium t-shirts"}),a.jsx("td",{className:"py-3 px-4",children:"5,800"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsx("td",{className:"py-3 px-4",children:"#3"}),a.jsx("td",{className:"py-3 px-4",children:"320"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"leather wallet men"}),a.jsx("td",{className:"py-3 px-4",children:"8,200"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"High"})}),a.jsx("td",{className:"py-3 px-4",children:"#15"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Optimize"})})]})]})]})})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate SEO-optimized content for your product pages and blog posts."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate SEO Content"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(ju,{className:"mr-2 h-4 w-4"}),"Analyze Page SEO"]})]})]})]})]})}),a.jsx(Ut,{value:"blog",children:a.jsxs(Xe,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Blog"}),a.jsx(Qt,{children:"Create and manage blog content"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Import Article"]}),a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Create New Post"]})]})]}),a.jsxs(at,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Title"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Views"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Shares"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.title}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.views||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.shares||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Blog Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate engaging blog content with AI based on your products and target audience."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Blog Post"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Topic Ideas"]})]})]})]})]})}),a.jsx(Ut,{value:"promotions",children:a.jsxs(Xe,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Promotions"}),a.jsx(Qt,{children:"Create and manage promotional campaigns"})]}),a.jsxs(O,{children:[a.jsx(Bm,{className:"mr-2 h-4 w-4"}),"Create Promotion"]})]}),a.jsxs(at,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Start Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"End Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Usage"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:i.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:o.type}),a.jsx("td",{className:"py-3 px-4",children:o.value}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.startDate}),a.jsx("td",{className:"py-3 px-4",children:o.endDate}),a.jsx("td",{className:"py-3 px-4",children:o.usageCount||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx(O,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Promotion Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Get AI recommendations for optimal discount levels and promotion timing based on your sales data."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Bm,{className:"mr-2 h-4 w-4"}),"Generate Promotion Strategy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Kv,{className:"mr-2 h-4 w-4"}),"Analyze Past Promotions"]})]})]})]})]})})]})]})},jRe=()=>{const[t,e]=p.useState("rates"),n=[{id:"ZONE-1",name:"Domestic",countries:["United States"],methods:[{name:"Standard",price:"$5.99",deliveryTime:"3-5 business days"},{name:"Express",price:"$12.99",deliveryTime:"1-2 business days"}]},{id:"ZONE-2",name:"Canada & Mexico",countries:["Canada","Mexico"],methods:[{name:"Standard",price:"$9.99",deliveryTime:"5-7 business days"},{name:"Express",price:"$19.99",deliveryTime:"2-3 business days"}]},{id:"ZONE-3",name:"International",countries:["Rest of World"],methods:[{name:"Standard",price:"$14.99",deliveryTime:"7-14 business days"},{name:"Express",price:"$29.99",deliveryTime:"3-5 business days"}]}],r=[{id:"SUP-1",name:"GlobalDropship Inc.",products:245,avgShippingTime:"4-7 days",status:"Connected"},{id:"SUP-2",name:"FastShip Solutions",products:189,avgShippingTime:"3-5 days",status:"Pending"},{id:"SUP-3",name:"EcoPackaging Co.",products:78,avgShippingTime:"5-8 days",status:"Connected"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Shipping & Delivery"}),a.jsxs(bi,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ei,{className:"grid grid-cols-3 mb-6",children:[a.jsxs($t,{value:"rates",children:[a.jsx(Zv,{className:"mr-2 h-4 w-4"}),"Shipping Rates"]}),a.jsxs($t,{value:"dropshipping",children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Dropshipping"]}),a.jsxs($t,{value:"policy",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Shipping Policy"]})]}),a.jsx(Ut,{value:"rates",children:a.jsxs(Xe,{children:[a.jsxs(ct,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(ut,{children:"Shipping Zones & Rates"}),a.jsx(Qt,{children:"Configure shipping rates by zone and package type"})]}),a.jsxs(O,{children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Add Shipping Zone"]})]}),a.jsxs(at,{children:[n.map(s=>a.jsxs(Xe,{className:"mb-6",children:[a.jsxs(ct,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(ut,{className:"text-lg",children:s.name}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(O,{variant:"outline",size:"sm",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]}),a.jsxs(Qt,{children:["Countries: ",s.countries.join(", ")]})]}),a.jsxs(at,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Delivery Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.methods.map((i,o)=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.name}),a.jsx("td",{className:"py-3 px-4",children:i.price}),a.jsx("td",{className:"py-3 px-4",children:i.deliveryTime}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx(O,{variant:"outline",size:"sm",children:"Delete"})]})]},o))})]})}),a.jsxs(O,{variant:"outline",size:"sm",className:"mt-4",children:[a.jsx(Mi,{className:"mr-2 h-4 w-4"}),"Add Shipping Method"]})]})]},s.id)),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Package Types"}),a.jsx("p",{className:"text-sm mb-4",children:"Define standard package types to calculate shipping rates accurately."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Small Package"}),a.jsx(O,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 1 lb, 9" x 6" x 2"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Medium Package"}),a.jsx(O,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 5 lbs, 12" x 9" x 4"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Large Package"}),a.jsx(O,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 10 lbs, 18" x 12" x 6"'})]})]}),a.jsxs(O,{variant:"outline",size:"sm",children:[a.jsx(Mi,{className:"mr-2 h-4 w-4"}),"Add Package Type"]})]})]})]})}),a.jsx(Ut,{value:"dropshipping",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Dropshipping Integration"}),a.jsx(Qt,{children:"Connect with dropshipping suppliers and manage fulfillment"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Fulfillment Mode"})}),a.jsxs(at,{children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx(O,{variant:"outline",className:"flex-1",children:"Self-Fulfillment"}),a.jsx(O,{variant:"default",className:"flex-1",children:"Dropshipping"}),a.jsx(O,{variant:"outline",className:"flex-1",children:"Hybrid"})]}),a.jsxs("p",{className:"text-sm text-muted-foreground mt-4",children:["Current mode: ",a.jsx("strong",{children:"Dropshipping"}),". Products will be shipped directly from suppliers to customers."]})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Connect Supplier"})}),a.jsxs(at,{children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Je,{placeholder:"Enter supplier API key or ID",className:"flex-1"}),a.jsxs(O,{children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"We support direct integration with AliExpress, Spocket, Oberlo, and more."})]})]})]}),a.jsx("h3",{className:"font-medium mb-3",children:"Connected Suppliers"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Supplier"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Avg. Shipping Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.avgShippingTime}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Connected"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx(O,{variant:"outline",size:"sm",className:"mr-2",children:"View Products"}),a.jsx(O,{variant:"outline",size:"sm",children:"Disconnect"})]})]},s.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Automatic Order Routing"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how orders are routed to different suppliers based on product, location, or other criteria."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs(O,{children:[a.jsx(Xv,{className:"mr-2 h-4 w-4"}),"Configure Routing Rules"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Mi,{className:"mr-2 h-4 w-4"}),"View Order Queue"]})]})]})]})]})}),a.jsx(Ut,{value:"policy",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Shipping Policy & Returns"}),a.jsx(Qt,{children:"Configure your shipping policy and return management settings"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Shipping Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Shipping Policy"}),a.jsx("p",{children:"We ship to all 50 US states and select international destinations. Orders are typically processed within 1-2 business days."}),a.jsx("h5",{children:"Domestic Shipping"}),a.jsxs("p",{children:["Standard shipping (3-5 business days): $5.99",a.jsx("br",{}),"Express shipping (1-2 business days): $12.99"]}),a.jsx("h5",{children:"International Shipping"}),a.jsxs("p",{children:["Standard shipping (7-14 business days): $14.99",a.jsx("br",{}),"Express shipping (3-5 business days): $29.99"]}),a.jsx("p",{children:"Free shipping on all domestic orders over $50. Shipping times may vary during peak seasons and holidays."})]})}),a.jsxs(O,{className:"mt-4",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Shipping Policy"]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Return Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Return Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs(O,{className:"mt-4",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Return Policy"]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Return Management"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how returns are processed and managed."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Window"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{type:"number",defaultValue:"30",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"days after delivery"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Restocking Fee"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{type:"number",defaultValue:"10",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"% of item price"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Labels"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{variant:"outline",size:"sm",children:"Customer Pays"}),a.jsx(O,{variant:"default",size:"sm",children:"Store Provides"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Refund Method"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(O,{variant:"default",size:"sm",children:"Original Payment"}),a.jsx(O,{variant:"outline",size:"sm",children:"Store Credit"})]})]})]}),a.jsxs(O,{className:"mt-4",children:[a.jsx(Xv,{className:"mr-2 h-4 w-4"}),"Save Return Settings"]})]})]})]})})]})]})},DRe=({store:t})=>{var w,_,C,T;const[e,n]=p.useState("store"),{user:r,session:s,subscriptionStatus:i}=yo(),{updateStore:o,isLoadingStores:l}=Vn(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),g=i==="active",x=async()=>{if(!(s!=null&&s.access_token)){h("Authentication token not found. Please log in again.");return}u(!0),h(null);try{const R=await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/create-portal-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`}}),A=await R.json();if(!R.ok)throw new Error(A.error||"Failed to create portal session.");window.location.href=A.url}catch(R){console.error("Portal session error:",R),h(R.message)}finally{u(!1)}},v=()=>{var A;const R=((A=r==null?void 0:r.store)==null?void 0:A.subdomain)||"your-store";navigator.clipboard.writeText(`${R}.storegen.app`),m(!0),setTimeout(()=>m(!1),2e3)};return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),a.jsxs(bi,{value:e,onValueChange:n,className:"w-full",children:[a.jsxs(ei,{className:"grid grid-cols-5 mb-6",children:[a.jsxs($t,{value:"store",children:[a.jsx(Sh,{className:"mr-2 h-4 w-4"}),"Store Details"]}),a.jsxs($t,{value:"billing",children:[a.jsx(Po,{className:"mr-2 h-4 w-4"}),"Billing"]}),a.jsxs($t,{value:"domain",children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Domain Management"]}),a.jsxs($t,{value:"legal",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Legal Pages"]}),a.jsxs($t,{value:"footer",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Footer Editor"]})]}),a.jsx(Ut,{value:"store",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Store Details"}),a.jsx(Qt,{children:"Update your store information and preferences"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-name",children:"Store Name"}),a.jsx(Je,{id:"store-name",placeholder:"Your Store Name",defaultValue:"My Awesome Store"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-email",children:"Store Email"}),a.jsx(Je,{id:"store-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-phone",children:"Store Phone"}),a.jsx(Je,{id:"store-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-address",children:"Store Address"}),a.jsx(En,{id:"store-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-currency",children:"Currency"}),a.jsxs("select",{id:"store-currency",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"USD",children:[a.jsx("option",{value:"USD",children:"USD ($)"}),a.jsx("option",{value:"EUR",children:"EUR ()"}),a.jsx("option",{value:"GBP",children:"GBP ()"}),a.jsx("option",{value:"CAD",children:"CAD ($)"}),a.jsx("option",{value:"AUD",children:"AUD ($)"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-timezone",children:"Timezone"}),a.jsxs("select",{id:"store-timezone",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"America/New_York",children:[a.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),a.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),a.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),a.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),a.jsx("option",{value:"Europe/London",children:"London (GMT)"})]})]})]})]})]}),a.jsxs("div",{className:"mt-6 space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"store-description",children:"Store Description"}),a.jsx(En,{id:"store-description",placeholder:"Tell customers about your store...",defaultValue:"Welcome to My Awesome Store! We offer high-quality products at competitive prices. Our mission is to provide exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(jo,{id:"enable-reviews",defaultChecked:!0}),a.jsx(Re,{htmlFor:"enable-reviews",children:"Enable customer reviews"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(jo,{id:"enable-inventory",defaultChecked:!0}),a.jsx(Re,{htmlFor:"enable-inventory",children:"Show inventory warnings on product pages"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(jo,{id:"enable-tax",defaultChecked:!0}),a.jsx(Re,{htmlFor:"enable-tax",children:"Enable automatic tax calculation"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(jo,{id:"enable-store-theme-toggle",checked:((w=t==null?void 0:t.settings)==null?void 0:w.showThemeToggle)??!0,onCheckedChange:R=>{t&&o&&o(t.id,{settings:{...t.settings,showThemeToggle:R}})},disabled:l||!t}),a.jsx(Re,{htmlFor:"enable-store-theme-toggle",children:"Show theme (light/dark) toggle in store header"})]})]}),a.jsxs(O,{className:"mt-6",disabled:l||!t,children:[a.jsx(K_,{className:"mr-2 h-4 w-4"}),"Save Store Details"]})]})]})}),a.jsx(Ut,{value:"billing",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Billing Information"}),a.jsx(Qt,{children:"Manage your subscription and payment methods"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Current Plan"})}),a.jsxs(at,{children:[a.jsx("div",{className:"text-xl font-medium",children:g?"Store Creator Plan":"Free Plan"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g?"$29.99/month, billed monthly":"Limited features"}),a.jsxs("div",{className:"mt-4",children:[g?a.jsxs(O,{onClick:x,disabled:c,children:[a.jsx(Po,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Subscription"]}):a.jsxs(O,{onClick:x,disabled:c,children:[" ",a.jsx(Po,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]}),d&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:d})]})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Payment Methods"})}),a.jsx(at,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"bg-blue-100 p-2 rounded-md mr-3",children:a.jsx(Po,{className:"h-5 w-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Visa ending in 4242"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Expires 12/2025"})]})]}),a.jsx(O,{variant:"outline",size:"sm",onClick:x,disabled:c,children:"Edit"})]}),a.jsxs(O,{variant:"outline",onClick:x,disabled:c,children:[a.jsx(Po,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Add Payment Method"]})]}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No payment methods available.",a.jsx("br",{}),"Upgrade to add payment methods."]})})})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Billing History"})}),a.jsx(at,{children:g?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Description"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Invoice"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"May 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Download"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Apr 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx(O,{variant:"outline",size:"sm",children:"Download"})})]})]})]})}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No billing history available.",a.jsx("br",{}),"Upgrade to view billing history."]})})})]})]})]})}),a.jsx(Ut,{value:"domain",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Domain Management"}),a.jsx(Qt,{children:"Configure your store's domain and URL settings"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Subdomain"})}),a.jsxs(at,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{defaultValue:((_=r==null?void 0:r.store)==null?void 0:_.subdomain)||"your-store",className:"flex-grow"}),a.jsx("span",{className:"text-muted-foreground",children:".storegen.app"})]}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs(O,{children:[a.jsx(K_,{className:"mr-2 h-4 w-4"}),"Save Subdomain"]}),a.jsx(O,{variant:"outline",onClick:v,children:f?a.jsxs(a.Fragment,{children:[a.jsx(Sg,{className:"mr-2 h-4 w-4"})," Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(EI,{className:"mr-2 h-4 w-4"})," Copy URL"]})})]})]})]}),a.jsxs(Xe,{children:[a.jsxs(ct,{className:"pb-2",children:[a.jsx(ut,{className:"text-lg",children:"Custom Domain"}),!g&&a.jsx(Qt,{children:a.jsx("span",{className:"text-yellow-600",children:"Available on paid plans only"})})]}),a.jsx(at,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Je,{placeholder:"yourdomain.com",className:"flex-grow"}),a.jsxs(O,{children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your domain name without http:// or www."})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center h-32 space-y-4",children:[a.jsx("p",{className:"text-muted-foreground text-center",children:"Custom domains are available on paid plans only."}),a.jsxs(O,{onClick:x,disabled:c,children:[a.jsx(Po,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]})]})})]})]}),g&&a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"DNS Configuration"})}),a.jsx(at,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm",children:"To connect your custom domain, add these DNS records in your domain provider's dashboard:"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"TTL"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"@"}),a.jsxs("td",{className:"py-3 px-4",children:[((C=r==null?void 0:r.store)==null?void 0:C.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"www"}),a.jsxs("td",{className:"py-3 px-4",children:[((T=r==null?void 0:r.store)==null?void 0:T.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]})]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"View DNS Guide"]}),a.jsxs(O,{children:[a.jsx(Ru,{className:"mr-2 h-4 w-4"}),"Verify DNS"]})]})]})})]})]})]})}),a.jsx(Ut,{value:"legal",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Legal Pages"}),a.jsx(Qt,{children:"Configure your store's legal documents and policies"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Privacy Policy"})}),a.jsx(at,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Privacy Policy"}),a.jsx("p",{children:"This Privacy Policy describes how your personal information is collected, used, and shared when you visit or make a purchase from our store."}),a.jsx("h5",{children:"Personal Information We Collect"}),a.jsx("p",{children:"When you visit the Site, we automatically collect certain information about your device, including information about your web browser, IP address, time zone, and some of the cookies that are installed on your device."}),a.jsx("p",{children:"Additionally, as you browse the Site, we collect information about the individual web pages or products that you view, what websites or search terms referred you to the Site, and information about how you interact with the Site."}),a.jsx("h5",{children:"How We Use Your Personal Information"}),a.jsx("p",{children:"We use the information that we collect generally to fulfill any orders placed through the Site (including processing your payment information, arranging for shipping, and providing you with invoices and/or order confirmations)."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Privacy Policy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Terms of Service"})}),a.jsx(at,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Terms of Service"}),a.jsx("p",{children:"These Terms of Service govern your use of our website and the products and services provided by us."}),a.jsx("h5",{children:"Overview"}),a.jsx("p",{children:"By accessing our website, you agree to these Terms of Service. If you do not agree with any part of these terms, you may not access the website or use our services."}),a.jsx("h5",{children:"Products and Services"}),a.jsx("p",{children:"All products and services displayed on our website are subject to availability. We reserve the right to discontinue any product or service at any time."}),a.jsx("h5",{children:"Accuracy of Information"}),a.jsx("p",{children:"We make every effort to ensure that the information on our website is accurate and up-to-date. However, we do not warrant that product descriptions or other content is accurate, complete, reliable, current, or error-free."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Terms of Service"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Refund Policy"})}),a.jsx(at,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Refund Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Refund Policy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Cookie Policy"})}),a.jsx(at,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Cookie Policy"}),a.jsx("p",{children:"This Cookie Policy explains how we use cookies and similar technologies to recognize you when you visit our website."}),a.jsx("h5",{children:"What are cookies?"}),a.jsx("p",{children:"Cookies are small data files that are placed on your computer or mobile device when you visit a website. Cookies are widely used by website owners in order to make their websites work, or to work more efficiently, as well as to provide reporting information."}),a.jsx("h5",{children:"How we use cookies"}),a.jsx("p",{children:'We use cookies for several reasons. Some cookies are required for technical reasons in order for our website to operate, and we refer to these as "essential" or "strictly necessary" cookies. Other cookies enable us to track and target the interests of our users to enhance the experience on our website.'})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs(O,{children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Edit Cookie Policy"]}),a.jsxs(O,{variant:"outline",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]})]})]})}),a.jsx(Ut,{value:"footer",children:a.jsxs(Xe,{children:[a.jsxs(ct,{children:[a.jsx(ut,{children:"Footer Editor"}),a.jsx(Qt,{children:"Customize your store's footer information"})]}),a.jsxs(at,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Contact Information"})}),a.jsx(at,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-email",children:"Email"}),a.jsx(Je,{id:"footer-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-phone",children:"Phone"}),a.jsx(Je,{id:"footer-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-address",children:"Address"}),a.jsx(En,{id:"footer-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]})]})})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Business Hours"})}),a.jsx(at,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-hours",children:"Hours of Operation"}),a.jsx(En,{id:"footer-hours",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-5pm\\nSaturday: 10am-4pm\\nSunday: Closed",rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-support",children:"Customer Support Hours"}),a.jsx(En,{id:"footer-support",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-6pm\\nSaturday: 10am-2pm\\nSunday: Closed",rows:3})]})]})})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"Social Media"})}),a.jsx(at,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-facebook",children:"Facebook"}),a.jsx(Je,{id:"footer-facebook",placeholder:"https://facebook.com/yourstore",defaultValue:"https://facebook.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-instagram",children:"Instagram"}),a.jsx(Je,{id:"footer-instagram",placeholder:"https://instagram.com/yourstore",defaultValue:"https://instagram.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-twitter",children:"Twitter"}),a.jsx(Je,{id:"footer-twitter",placeholder:"https://twitter.com/yourstore",defaultValue:"https://twitter.com/yourstore"})]})]})})]})]}),a.jsxs(Xe,{children:[a.jsx(ct,{className:"pb-2",children:a.jsx(ut,{className:"text-lg",children:"About Us"})}),a.jsx(at,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-about",children:"About Us Text"}),a.jsx(En,{id:"footer-about",placeholder:"Tell customers about your business...",defaultValue:"My Awesome Store was founded in 2023 with a mission to provide high-quality products at competitive prices. We are committed to exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(Re,{htmlFor:"footer-copyright",children:"Copyright Text"}),a.jsx(Je,{id:"footer-copyright",placeholder:" 2023 Your Store. All rights reserved.",defaultValue:` ${new Date().getFullYear()} My Awesome Store. All rights reserved.`})]})]})})]}),a.jsx("div",{className:"mt-6",children:a.jsxs(O,{children:[a.jsx(K_,{className:"mr-2 h-4 w-4"}),"Save Footer Settings"]})})]})]})})]})]})},MRe=()=>{const{storeName:t}=E0(),e=gl(),{getStoreById:n,getStoreByName:r,setCurrentStore:s,isLoadingStores:i}=Vn(),o=new URLSearchParams(e.search),l=o.get("tab")||"orders",[c,u]=p.useState(l),[d,h]=p.useState(null);p.useEffect(()=>{if(!i&&t){const m=r(t);m?(h(m),s(m)):console.error(`Store with name ${t} not found.`)}},[t,r,s,i]),p.useEffect(()=>{const m=o.get("tab");m&&m!==c&&u(m)},[e.search]);const f=()=>{switch(c){case"orders":return a.jsx(KF,{store:d});case"products":return a.jsx(NRe,{store:d});case"customers":return a.jsx(PRe,{store:d});case"payments":return a.jsx(ARe,{store:d});case"analytics":return a.jsx(kRe,{store:d});case"marketing":return a.jsx(RRe,{store:d});case"shipping":return a.jsx(jRe,{store:d});case"settings":return a.jsx(DRe,{store:d});default:return a.jsx(KF,{store:d})}};return i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading dashboard..."})]})}):!d&&!i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Store Not Found"}),a.jsxs("p",{className:"text-muted-foreground",children:["Could not load dashboard for store: ",t]})]})}):a.jsx(IRe,{activeTab:c,setActiveTab:u,storeId:d==null?void 0:d.id,storeName:d==null?void 0:d.name,children:f()})},LRe=[{id:"ref1",name:"Modern Minimalist",imageUrl:"https://via.placeholder.com/150/f8f9fa/000000?text=Modern"},{id:"ref2",name:"Vintage Charm",imageUrl:"https://via.placeholder.com/150/e9ecef/000000?text=Vintage"},{id:"ref3",name:"Abstract Art",imageUrl:"https://via.placeholder.com/150/dee2e6/000000?text=Abstract"},{id:"ref4",name:"Nature Inspired",imageUrl:"https://via.placeholder.com/150/ced4da/000000?text=Nature"}],FRe=()=>{const[t,e]=p.useState(""),[n,r]=p.useState(null),[s,i]=p.useState(null),[o,l]=p.useState(null),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),[g,x]=p.useState([]),[v,w]=p.useState(""),_=vi(),C=A=>{const E=A.target.files[0];if(E){const I=new FileReader;I.onloadend=()=>{r(I.result),l(I.result)},I.readAsDataURL(E)}},T=A=>{const E=Array.from(A.target.files);if(E.length+g.length>3){h("You can upload a maximum of 3 ingredient images.");return}E.forEach(I=>{const N=new FileReader;N.onloadend=()=>{x(k=>[...k,N.result])},N.readAsDataURL(I)})},R=async()=>{u(!0),h(null),l(null);try{let A;const E=n?n.split(",")[1]:null,I=g.map(N=>({mimeType:"image/png",data:N.split(",")[1]}));if(f&&E)A=await AE(t,E,"image/png",I);else{const N=s?`${t} in the style of ${s.name}`:t;A=await KU(N,I)}A.imageData?l(`data:image/png;base64,${A.imageData}`):h(A.text||"Failed to generate image. No image data returned.")}catch(A){console.error("Error generating image:",A),h(A.message||"An unexpected error occurred.")}finally{u(!1)}};return a.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-black md:bg-gradient-to-b from-black to-white",children:[a.jsx(O,{variant:"ghost",size:"icon",className:"absolute top-4 left-4 z-10 md:hidden",onClick:()=>window.history.back(),children:a.jsx(Vo,{className:"text-white"})}),a.jsxs("main",{className:"flex-1 flex items-center justify-center p-0 md:p-6 relative bg-black md:order-2",style:{paddingTop:"60px"},children:[o&&a.jsx("div",{className:"absolute top-0 left-0 right-0 bg-blue-600 text-white p-2 text-center md:hidden",children:a.jsxs(O,{className:"bg-transparent hover:bg-blue-700",children:[a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Create Store with Design"]})}),a.jsxs("div",{className:"w-full md:max-w-2xl aspect-square flex items-center justify-center relative",children:[c&&a.jsx("p",{className:"text-white",children:"Loading..."}),d&&a.jsx("p",{className:"text-red-500",children:d}),o&&a.jsx("img",{src:o,alt:"Generated result",className:"max-w-full max-h-full object-contain"}),!c&&!d&&!o&&a.jsx("div",{className:"text-center text-gray-400",children:a.jsx("p",{children:"Your design will appear here."})}),o&&a.jsx("div",{className:"absolute top-4 right-4 hidden md:block",children:a.jsxs(O,{className:"bg-blue-600 hover:bg-blue-700 text-white",onClick:()=>_("/",{state:{generatedImage:o}}),children:[a.jsx(Er,{className:"mr-2 h-4 w-4"}),"Create Store with Design"]})}),o&&a.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex items-center gap-2",children:[a.jsx(Je,{type:"text",value:v,onChange:A=>w(A.target.value),placeholder:"Describe your edit...",className:"bg-white/80 backdrop-blur-sm"}),a.jsx(O,{onClick:async()=>{if(v){u(!0),h(null);try{const A=o.split(",")[1],E=await AE(v,A,"image/png");E.imageData?l(`data:image/png;base64,${E.imageData}`):h(E.text||"Failed to edit image.")}catch(A){h(A.message)}finally{u(!1),w("")}}},disabled:c,className:"bg-gray-200 hover:bg-gray-300 text-black",children:"Edit"})]})]})]}),a.jsxs("aside",{className:"w-full md:w-1/3 md:max-w-sm p-6 bg-white shadow-md relative md:order-1",children:[a.jsx(Ls,{className:"h-full",children:a.jsxs("div",{className:"space-y-6 pb-20",children:[a.jsxs("div",{className:"hidden md:flex items-center justify-between",children:[a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>window.history.back(),children:a.jsx(Vo,{})}),a.jsx("h1",{className:"text-2xl font-bold",children:"Designer"}),a.jsx("img",{src:"https://static.wixstatic.com/media/bd2e29_695f70787cc24db4891e63da7e7529b3~mv2.png",alt:"Logo",className:"h-8"})]}),a.jsx("div",{className:"md:hidden text-center"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(jo,{id:"use-own-image",checked:f,onCheckedChange:m}),a.jsx(Re,{htmlFor:"use-own-image",children:"Use your own image"})]}),f&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Upload Your Image"}),a.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Upload an image to edit."}),a.jsx(Je,{id:"image-upload",type:"file",accept:"image/*",onChange:C,className:"mt-2"}),n&&a.jsxs("div",{className:"mt-4",children:[a.jsx("img",{src:n,alt:"Uploaded preview",className:"w-full rounded-lg shadow-sm"}),a.jsx(O,{variant:"link",size:"sm",onClick:()=>r(null),className:"mt-1 px-0",children:"Remove"})]})]}),a.jsx(Oi,{}),a.jsxs("div",{children:[a.jsx(Re,{htmlFor:"prompt",className:"text-lg font-semibold",children:"Prompt"}),a.jsx(Je,{id:"prompt",type:"text",value:t,onChange:A=>e(A.target.value),placeholder:"e.g., a futuristic cityscape",className:"mt-2"})]}),a.jsx(Oi,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Ingredients"}),a.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Add up to 3 images to include in the generation."}),a.jsx(Je,{id:"ingredient-upload",type:"file",accept:"image/*",multiple:!0,onChange:T,className:"mt-2"}),a.jsx("div",{className:"grid grid-cols-3 gap-2 mt-4",children:g.map((A,E)=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:A,alt:`Ingredient ${E+1}`,className:"w-full rounded-lg shadow-sm"}),a.jsx(O,{variant:"destructive",size:"sm",className:"absolute top-1 right-1 h-6 w-6 p-0",onClick:()=>x(I=>I.filter((N,k)=>k!==E)),children:"X"})]},E))})]}),a.jsx(Oi,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Reference Styles"}),a.jsx("p",{className:"text-sm text-gray-500 mb-2",children:"Optionally select a style to influence the generation."}),a.jsx("div",{className:"grid grid-cols-2 gap-4",children:LRe.map(A=>a.jsxs("div",{className:`cursor-pointer border-2 rounded-lg overflow-hidden ${(s==null?void 0:s.id)===A.id?"border-blue-500":"border-transparent"}`,onClick:()=>i((s==null?void 0:s.id)===A.id?null:A),children:[a.jsx("img",{src:A.imageUrl,alt:A.name,className:"w-full h-24 object-cover"}),a.jsx("p",{className:"text-center text-sm p-1 bg-gray-100",children:A.name})]},A.id))})]}),a.jsx(Oi,{})]})}),a.jsx("div",{className:"absolute bottom-6 left-6 right-6",children:a.jsx(O,{onClick:R,disabled:c||!t,className:"w-full",children:c?"Generating...":"Generate Image"})})]})]})},ORe=()=>a.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[a.jsx("h1",{className:"text-4xl font-bold",children:"Music Page"}),a.jsx("p",{className:"text-lg text-gray-600",children:"This page is under construction."})]}),VRe=()=>{const[t,e]=p.useState(""),[n,r]=p.useState(""),[s,i]=p.useState(!1),[o,l]=p.useState([]),[c,u]=p.useState(0),d=async()=>{var f,m,g,x,v,w;if(!t.trim())return;i(!0),r(""),l([]),u(0);const h=new On({apiKey:"AIzaSyBsOak33bcpbtIaKXUyVZ4ZVmpzuOL_k6s"});try{l(N=>[...N,"Generating transcript..."]),u(25);const C=(await h.models.generateContent({model:"gemini-2.0-flash",contents:`Generate a short podcast transcript with two speakers, Joe and Jane, discussing ${t}.`})).text;l(N=>[...N,"Transcript generated."]),u(50),l(N=>[...N,"Generating audio..."]),u(75);const R=(w=(v=(x=(g=(m=(f=(await h.models.generateContent({model:"gemini-2.5-flash-preview-tts",contents:[{parts:[{text:C}]}],config:{responseModalities:["AUDIO"],speechConfig:{multiSpeakerVoiceConfig:{speakerVoiceConfigs:[{speaker:"Joe",voiceConfig:{prebuiltVoiceConfig:{voiceName:"Kore"}}},{speaker:"Jane",voiceConfig:{prebuiltVoiceConfig:{voiceName:"Puck"}}}]}}}})).candidates)==null?void 0:f[0])==null?void 0:m.content)==null?void 0:g.parts)==null?void 0:x[0])==null?void 0:v.inlineData)==null?void 0:w.data,A=Buffer.from(R,"base64"),E=new Blob([A],{type:"audio/wav"}),I=URL.createObjectURL(E);r(I),l(N=>[...N,"Audio generated."]),u(100)}catch(_){console.error("Error generating podcast:",_),l(C=>[...C,"Error generating podcast."])}finally{i(!1)}};return a.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-100 relative",children:[a.jsx(Xn,{to:"/",className:"absolute top-4 left-4",children:a.jsx(O,{variant:"ghost",size:"icon",children:a.jsx(Vo,{})})}),!n&&!s&&a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-center",children:"Create a Podcast"}),a.jsx("div",{className:"space-y-2",children:a.jsx(Je,{type:"text",placeholder:"Enter a topic, ex. 2025 print on demand trends...",value:t,onChange:h=>e(h.target.value),className:"w-full bg-gray-200/50 rounded-[18px]"})}),a.jsx(O,{onClick:d,className:"w-full bg-blue-600 hover:bg-blue-700",children:"Create"})]}),s&&a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6",children:[a.jsx(Oa,{value:c,className:"w-full"}),a.jsx("div",{className:"text-center",children:o.map((h,f)=>a.jsx("p",{children:h},f))})]}),n&&!s&&a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-md",children:[a.jsx("h1",{className:"text-3xl font-bold text-center",children:"Your Podcast"}),a.jsx("audio",{controls:!0,src:n,className:"w-full"})]})]})},dm=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),$Re=()=>{const{toast:t}=vs(),[e,n]=p.useState("text-to-image"),[r,s]=p.useState(""),[i,o]=p.useState(""),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState(null),[m,g]=p.useState([]),[x,v]=p.useState(!1),[w,_]=p.useState(""),[C,T]=p.useState(null),[R,A]=p.useState(!1),[E,I]=p.useState(null),[N,k]=p.useState([]),[j,D]=p.useState(""),[L,G]=p.useState(!1),[B,W]=p.useState(null),[X,H]=p.useState(!1),[K,V]=p.useState(null),$=async()=>{var ue,Ce;if(!(!K||!K.url))try{const Ie=document.createElement("a");let ve="download";if(K.url.startsWith("data:")){const ie=K.url.match(/:(.*?);/),He=(ie?ie[1]:"application/octet-stream").split("/")[1]||"bin";ve=`${((ue=K.caption)==null?void 0:ue.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${He}`,Ie.href=K.url}else{const Me=await(await fetch(K.url)).blob();Ie.href=URL.createObjectURL(Me);const He=K.url.substring(K.url.lastIndexOf("/")+1).split("?")[0],yt=He.includes(".")?He.substring(He.lastIndexOf(".")+1):"",kt=K.type==="video"?"mp4":"png";ve=He||`${((Ce=K.caption)==null?void 0:Ce.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${yt||kt}`}Ie.download=ve,document.body.appendChild(Ie),Ie.click(),document.body.removeChild(Ie),K.url.startsWith("data:")||URL.revokeObjectURL(Ie.href),t({title:"Download Started",description:`Downloading ${ve}`})}catch(Ie){console.error("Error downloading media:",Ie),t({title:"Download Failed",description:Ie.message,variant:"destructive"})}},z=async()=>{if(!r.trim()){t({title:"Error",description:"Please enter a prompt for image generation",variant:"destructive"});return}c(!0),f(null),D("");try{const ue=await A0(r);let Ce=ue.alt?[ue.alt]:[`Image for: ${r.substring(0,30)}`];if(ue.url)try{const{base64ImageData:Ie,mimeType:ve}=await dm(ue.url);Ce=await ia(Ie,ve,`Image of ${r}`)}catch(Ie){console.error("Error generating caption for Gemini image:",Ie),Ce=[`Failed to generate caption for: ${r.substring(0,30)}`]}f({url:ue.url,captions:Ce,sourceApi:"gemini"}),Ce&&Ce.length>0&&D(Ce[0])}catch(ue){console.error("Error generating image with Gemini:",ue),t({title:"Image Generation Failed",description:ue.message,variant:"destructive"})}finally{c(!1)}},F=async()=>{if(!i.trim()){t({title:"Error",description:"Please enter a prompt for OpenAI image generation",variant:"destructive"});return}d(!0),f(null),D("");try{const ue=await qB(i),Ce=`data:image/png;base64,${ue.b64_json}`;let Ie=ue.alt?[ue.alt]:[`OpenAI image for: ${i.substring(0,30)}`];try{const{base64ImageData:ve,mimeType:ie}=await dm(Ce);Ie=await ia(ve,ie,`OpenAI-generated image of ${i}`)}catch(ve){console.error("Error generating caption for OpenAI image:",ve),Ie=[`Failed to generate caption for: ${i.substring(0,30)}`]}f({url:Ce,captions:Ie,sourceApi:"openai"}),Ie&&Ie.length>0&&D(Ie[0]),t({title:"Image Generated (OpenAI)",description:"Image successfully generated using OpenAI."})}catch(ue){console.error("Error generating image with OpenAI:",ue),t({title:"OpenAI Image Generation Failed",description:ue.message,variant:"destructive"})}finally{d(!1)}},Z=async(ue,Ce)=>{if(!ue||!ue.url){t({title:"Error",description:"No image selected to edit with Gemini.",variant:"destructive"});return}if(!Ce.trim()){t({title:"Error",description:"Please enter an edit prompt for Gemini.",variant:"destructive"});return}A(!0),I(null),D("");try{const{base64ImageData:Ie,mimeType:ve}=await dm(ue.url),ie=await $o(Ie,ve,Ce);if(ie&&ie.editedImageData){const Me=`data:${ie.newMimeType};base64,${ie.editedImageData}`;let He=ie.editTextResponse?[ie.editTextResponse]:[`Edited with Gemini: ${ue.caption||ue.id}`];try{He=await ia(ie.editedImageData,ie.newMimeType,`Edited image based on: ${Ce}`)}catch(yt){console.error("Error generating caption for Gemini edited image:",yt)}I({url:Me,captions:He,sourceApi:"gemini"}),He&&He.length>0&&D(He[0]),t({title:"Image Edited (Gemini)",description:"Image successfully edited with Gemini."})}else throw new Error("Gemini image edit did not return image data.")}catch(Ie){console.error("Error editing image with Gemini:",Ie),t({title:"Gemini Edit Failed",description:Ie.message,variant:"destructive"})}finally{A(!1)}},ce=async ue=>{const Ce=ue.target.files[0];if(Ce){H(!0),W(null),D("");try{const Ie=new FileReader;Ie.onload=async ve=>{const ie=ve.target.result,Me=Ce.type.startsWith("video/")?"video":"image";let He=[Ce.name];if(Me==="image")try{const{base64ImageData:yt,mimeType:kt}=await dm(ie);He=await ia(yt,kt,"Uploaded image caption")}catch(yt){console.error("Error generating caption for uploaded image:",yt)}else He=[`Uploaded video: ${Ce.name}`];W({url:ie,captions:He,type:Me}),He&&He.length>0&&D(He[0]),H(!1)},Ie.onerror=()=>{t({title:"Upload Failed",description:"Failed to read the selected file",variant:"destructive"}),H(!1)},Ie.readAsDataURL(Ce)}catch(Ie){console.error("Error processing uploaded file:",Ie),t({title:"Upload Failed",description:Ie.message,variant:"destructive"}),H(!1)}}},le=(ue,Ce,Ie="image")=>{if(!ue){t({title:"Cannot Add",description:"Item URL is missing.",variant:"destructive"});return}const ve={id:Ft(),type:Ie,url:ue,caption:Ce||`Item ${N.length+1}`,isVideo:Ie==="video"};k(ie=>[...ie,ve]),t({title:"Added to Timeline",description:`${Ie==="video"?"Video":"Image"} added to your content timeline.`}),f(null),I(null),W(null),T(null),D("")},he=(ue,Ce)=>{const Ie=[...N],ve=Ie[ue],ie=ue+Ce;ie<0||ie>=Ie.length||(Ie.splice(ue,1),Ie.splice(ie,0,ve),k(Ie))},Le=ue=>{k(Ce=>Ce.filter(Ie=>Ie.id!==ue)),t({title:"Removed from Timeline",description:"Item removed."})},$e=async(ue,Ce)=>{if(ue.isVideo){t({title:"Already a Video",description:"This item is already a video."});return}G(!0);try{const{base64ImageData:Ie,mimeType:ve}=await dm(ue.url),ie=ue.caption||"Create a short video from this image",Me=await zI(ie,Ie,ve),He=[...N];He[Ce]={...ue,url:Me,isVideo:!0,type:"video",caption:ue.caption+" (Veo Video)"},k(He),t({title:"Veo Video Generated",description:"Image converted to video using Veo."})}catch(Ie){console.error("Error converting to Veo video:",Ie),t({title:"Veo Conversion Failed",description:Ie.message,variant:"destructive"})}finally{G(!1)}},Be=ue=>{const Ce=N.find(ve=>ve.id===ue);if(!Ce)return;const Ie=prompt("Edit caption:",Ce.caption);Ie!==null&&Ie.trim()!==Ce.caption&&(k(ve=>ve.map(ie=>ie.id===ue?{...ie,caption:Ie.trim()}:ie)),t({title:"Caption Updated"}))};return a.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-8 bg-background",children:[a.jsxs("header",{className:"relative text-center pb-4",children:[a.jsx(Xn,{to:"/",className:"absolute left-0 top-0",children:a.jsxs(O,{variant:"outline",size:"icon",children:[a.jsx(Vo,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to Home"})]})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"AI Content Creation Studio"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"Generate images, edit them, create videos, and build your content sequence."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 xl:gap-8",children:[a.jsx("div",{className:"lg:col-span-1 space-y-6",children:a.jsxs(bi,{value:e,onValueChange:n,className:"w-full",children:[a.jsxs(ei,{className:"grid w-full grid-cols-3",children:[a.jsxs($t,{value:"text-to-image",children:[a.jsx(ma,{className:"mr-1 h-4 w-4 inline-block"}),"Gen Image"]}),a.jsxs($t,{value:"image-edit",children:[a.jsx(Qv,{className:"mr-1 h-4 w-4 inline-block"}),"Edit Image"]}),a.jsxs($t,{value:"upload",children:[a.jsx(j3,{className:"mr-1 h-4 w-4 inline-block"}),"Upload"]})]}),a.jsxs(Ut,{value:"text-to-image",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(Re,{htmlFor:"text-prompt-model1",className:"text-lg font-semibold",children:"Text-to-Image (Quick)"}),a.jsx(En,{id:"text-prompt-model1",placeholder:"e.g., 'A futuristic cityscape at sunset'",value:r,onChange:ue=>s(ue.target.value),rows:3,className:"mt-2",disabled:l||u}),x&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading prompt suggestions..."}),m.length>0&&!x&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx(Re,{className:"text-xs text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:m.map((ue,Ce)=>a.jsx(O,{variant:"outline",size:"xs",onClick:()=>s(ue),className:"text-xs",children:ue.length>40?ue.substring(0,37)+"...":ue},Ce))})]}),a.jsxs(O,{onClick:z,disabled:l||u||!r.trim(),className:"w-full mt-3",children:[l?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ma,{className:"mr-2 h-4 w-4"}),"Generate with Quick"]}),a.jsx(Oi,{className:"my-4"}),a.jsx(Re,{htmlFor:"text-prompt-model2",className:"text-lg font-semibold",children:"Text-to-Image (Quality)"}),a.jsx(En,{id:"text-prompt-model2",placeholder:"e.g., 'A photorealistic cat astronaut'",value:i,onChange:ue=>o(ue.target.value),rows:3,className:"mt-2",disabled:l||u}),a.jsxs(O,{onClick:F,disabled:l||u||!i.trim(),className:"w-full mt-3",children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(E3,{className:"mr-2 h-4 w-4"}),"Generate with Quality"]}),h&&h.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:h.url,alt:`Generated by ${h.sourceApi==="gemini"?"Quick":h.sourceApi==="openai"?"Quality":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",h.sourceApi==="gemini"?"Quick":h.sourceApi==="openai"?"Quality":"AI"]}),a.jsx(Re,{className:"text-sm font-medium",children:"Choose a caption:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(h.captions||[]).map((ue,Ce)=>a.jsx(O,{variant:j===ue?"default":"outline",size:"sm",onClick:()=>D(ue),className:"text-xs",children:ue},Ce))}),a.jsxs(O,{onClick:()=>le(h.url,j),size:"sm",className:"w-full mt-2",disabled:!j,children:[a.jsx(Cu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]}),a.jsxs(Ut,{value:"image-edit",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(Re,{className:"text-lg font-semibold",children:"Image Editing"}),!C&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select an image from the timeline to enable editing."}),C&&a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Editing: ",a.jsx("span",{className:"text-primary truncate",children:C.caption})]}),a.jsx("img",{src:C.url,alt:"Selected for editing",className:"w-full rounded-md object-contain max-h-48 border"}),a.jsx(Re,{htmlFor:"edit-prompt-model1",children:"Edit with Quick"}),a.jsx(En,{id:"edit-prompt-model1",placeholder:"Describe edits (e.g., 'change background to a beach')",value:w,onChange:ue=>_(ue.target.value),rows:2,disabled:R}),a.jsxs(O,{onClick:()=>Z(C,w),disabled:R||!w.trim(),className:"w-full",children:[R?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ma,{className:"mr-2 h-4 w-4"}),"Edit with Quick"]})]}),E&&E.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:E.url,alt:`Edited by ${E.sourceApi==="gemini"?"Quick":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",E.sourceApi==="gemini"?"Quick":"AI"]}),a.jsx(Re,{className:"text-sm font-medium",children:"Choose a caption for the edited image:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(E.captions||[]).map((ue,Ce)=>a.jsx(O,{variant:j===ue?"default":"outline",size:"sm",onClick:()=>D(ue),className:"text-xs",children:ue},Ce))}),a.jsxs(O,{onClick:()=>le(E.url,j),size:"sm",className:"w-full mt-2",disabled:!j,children:[a.jsx(Cu,{className:"mr-2 h-4 w-4"})," Add Edited to Timeline"]})]})]}),a.jsxs(Ut,{value:"upload",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(Re,{htmlFor:"file-upload",className:"text-lg font-semibold",children:"Upload Image or Video"}),a.jsx(Je,{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:ce,className:"mt-2",disabled:X}),X&&a.jsxs("div",{className:"mt-2 flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}),B&&B.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[B.type==="image"?a.jsx("img",{src:B.url,alt:"Uploaded content",className:"w-full rounded-md object-contain max-h-96"}):a.jsx("video",{src:B.url,controls:!0,className:"w-full rounded-md max-h-96",children:"Your browser does not support the video tag."}),a.jsx(Re,{className:"text-sm font-medium",children:"Choose a caption for the uploaded content:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(B.captions||[]).map((ue,Ce)=>a.jsx(O,{variant:j===ue?"default":"outline",size:"sm",onClick:()=>D(ue),className:"text-xs",children:ue},Ce))}),a.jsxs(O,{onClick:()=>le(B.url,j,B.type),size:"sm",className:"w-full mt-2",disabled:!j,children:[a.jsx(Cu,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]})]})}),a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"p-4 md:p-6 border rounded-lg bg-card shadow min-h-[400px]",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Content Timeline"}),a.jsx(Ls,{className:"h-[calc(100vh-350px)] min-h-[300px] pr-3",children:N.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[a.jsx(S3,{className:"h-12 w-12 mb-3"}),a.jsx("p",{children:"Your timeline is empty."}),a.jsx("p",{className:"text-sm",children:"Generate or upload content to get started."})]}):a.jsx(_c,{children:N.map((ue,Ce)=>a.jsxs(Pt.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{type:"spring",stiffness:300,damping:30},className:"mb-3 p-3 border rounded-md flex items-start gap-3 hover:shadow-md transition-shadow bg-background cursor-pointer",onClick:()=>V(ue),children:[a.jsxs("div",{className:"w-24 h-24 flex-shrink-0 relative rounded overflow-hidden group bg-muted",children:[ue.isVideo?a.jsx("video",{src:ue.url,className:"w-full h-full object-cover",controls:!1,muted:!0,loop:!0,onMouseOver:Ie=>Ie.target.play(),onMouseOut:Ie=>Ie.target.pause()}):a.jsx("img",{src:ue.url,alt:ue.caption,className:"w-full h-full object-cover"}),!ue.isVideo&&a.jsx(O,{size:"icon",variant:"secondary",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Ie=>{Ie.stopPropagation(),$e(ue,Ce)},disabled:L,title:"Convert to Veo Video",children:L?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(II,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"outline",className:"absolute bottom-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:Ie=>{Ie.stopPropagation(),T(ue),n("image-edit")},disabled:ue.isVideo,title:"Edit this image",children:a.jsx(Qv,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:`text-xs font-semibold px-1.5 py-0.5 rounded-sm ${ue.isVideo?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:[ue.isVideo?"Video":"Image"," ",Ce+1]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx(O,{size:"icon",variant:"ghost",onClick:Ie=>{Ie.stopPropagation(),he(Ce,-1)},disabled:Ce===0,className:"h-7 w-7",children:a.jsx(P3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ie=>{Ie.stopPropagation(),he(Ce,1)},disabled:Ce===N.length-1,className:"h-7 w-7",children:a.jsx(N3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ie=>{Ie.stopPropagation(),Be(ue.id)},className:"h-7 w-7",children:a.jsx(A3,{className:"h-4 w-4"})}),a.jsx(O,{size:"icon",variant:"ghost",onClick:Ie=>{Ie.stopPropagation(),Le(ue.id)},className:"h-7 w-7 text-destructive",children:a.jsx(Fn,{className:"h-4 w-4"})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-muted-foreground line-clamp-3",title:ue.caption,children:ue.caption})]})]},ue.id))})}),N.length>0&&a.jsx(Oi,{className:"my-4"}),K&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Media Viewer"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(O,{variant:"outline",size:"sm",onClick:$,children:[a.jsx(TI,{className:"mr-2 h-4 w-4"}),"Download"]}),a.jsx(O,{variant:"ghost",size:"icon",onClick:()=>V(null),children:a.jsx(Wi,{className:"h-5 w-5"})})]})]}),K.type==="image"||!K.isVideo?a.jsx("img",{src:K.url,alt:K.caption||"Viewing media",className:"w-full max-h-[60vh] rounded-md object-contain border"}):a.jsx("video",{src:K.url,controls:!0,className:"w-full max-h-[60vh] rounded-md border bg-black",children:"Your browser does not support the video tag."}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:K.caption})]})]})})]})]})},URe=()=>a.jsx(R1e,{}),BRe=()=>{const{isAuthenticated:t,loadingProfile:e}=yo();return e?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl",children:"Loading..."})}):t?a.jsx(C$,{to:"/",replace:!0}):a.jsx(bRe,{})},zRe=[{element:a.jsxs(Zbe,{children:[a.jsx(TRe,{})," "]}),children:[{index:!0,element:a.jsx(URe,{})},{path:"auth",element:a.jsx(BRe,{})},{path:"pricing",element:a.jsx(_Re,{})},{path:"designer",element:a.jsx(FRe,{})},{path:"music",element:a.jsx(ORe,{})},{path:"podcast",element:a.jsx(VRe,{})},{path:"video",element:a.jsx($Re,{})},{path:":storeName",element:a.jsx(tRe,{})},{path:":storeName/product/:productId",element:a.jsx(gRe,{})},{path:"checkout",element:a.jsx(xRe,{})},{path:"order-confirmation",element:a.jsx(CRe,{})},{path:":storeName/content-creation",element:a.jsx(sEe,{})},{path:":storeName/dashboard",element:a.jsx(MRe,{})},{path:"*",element:a.jsx(C$,{to:"/",replace:!0})}]}],GRe=!0,WRe=!0,HRe=IX(zRe,{future:{v7_startTransition:GRe,v7_relativeSplatPath:WRe}}),yv=document.getElementById("root");yv._reactRoot||(yv._reactRoot=mC.createRoot(yv));const YF=yv._reactRoot;try{YF.render(a.jsx(ht.StrictMode,{children:a.jsx(LX,{router:HRe})}))}catch(t){console.error("Application initialization failed:",t);let e="Application failed to load. Please check the console for details.";t.message.includes("VITE_")&&t.message.includes("is not set")&&(e=`Configuration Error: ${t.message}. Please ensure all required environment variables are correctly set in your .env file and the application is rebuilt if necessary.`),YF.render(a.jsx(ht.StrictMode,{children:a.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",fontFamily:"sans-serif"},children:[a.jsx("h1",{children:"Application Load Error"}),a.jsx("p",{children:e}),a.jsxs("p",{children:["Please check your ",a.jsx("code",{children:".env"})," file and ensure all necessary environment variables are configured."]})]})}))}export{dg as $,_c as A,O as B,Xe as C,Fn as D,Eie as E,TE as F,q_ as G,C3 as H,zn as I,IE as J,I3 as K,Xn as L,oh as M,Ru as N,GI as O,g2 as P,zde as Q,ht as R,Er as S,Xf as T,xi as U,lw as V,ds as W,Wi as X,Ka as Y,D3 as Z,Ig as _,yhe as a,Hie as a0,II as a1,j0 as a2,fa as a3,Die as a4,$ie as a5,jie as a6,xie as a7,Tie as a8,Kie as a9,Jke as aA,Zke as aB,Sg as aC,zie as aD,rl as aE,S3 as aF,Lo as aG,Pie as aH,Yv as aI,kie as aJ,Ux as aa,Xie as ab,Rie as ac,Wie as ad,m2 as ae,vi as af,jo as ag,Ls as ah,Yr as ai,$r as aj,Ur as ak,Br as al,Ji as am,bi as an,ei as ao,$t as ap,Ut as aq,Re as ar,Ar as as,Nae as at,_q as au,R3 as av,whe as aw,Mi as ax,Vie as ay,wa as az,yS as b,NI as c,ku as d,Kke as e,La as f,at as g,md as h,Fp as i,a as j,Lp as k,UTe as l,Pt as m,ju as n,mc as o,Ke as p,Zv as q,p as r,Po as s,vie as t,Vn as u,qke as v,bt as w,vs as x,Je as y,Cu as z};
