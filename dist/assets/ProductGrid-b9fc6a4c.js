import{ai as we,u as oe,r as g,x as ke,j as e,aj as de,ak as ce,al as me,am as ue,an as Ce,ah as Se,C as xe,as as $,y as G,aL as Te,aM as Q,B as p,D as ne,aK as Ae,aN as pe,S as re,aO as le,at as Ee,aI as he,au as ge,aP as $e,aQ as Ge,aR as _e,aw as ve,m as _,L as se,c as be,i as Ie,k as fe,A as Ne,E as Ve,H as Fe,$ as Le,z as De,a0 as Me,I as B,n as je,G as Oe,o as ze}from"./index-45811221.js";import{L as Pe}from"./list-36439a30.js";const Be=k=>new Promise((u,s)=>{const b=new FileReader;b.readAsDataURL(k),b.onload=()=>u(b.result),b.onerror=v=>s(v)}),ye=({isOpen:k,onClose:u,product:s,onSave:b,storeId:v,theme:o})=>{const{user:j}=we(),{updateStore:i,currentStore:N}=oe(),[a,c]=g.useState(null),[y,L]=g.useState(!1),[C,F]=g.useState(!1),[D,M]=g.useState(null),[R,I]=g.useState(!1),{toast:m}=ke();g.useEffect(()=>{if(s){const t=s.item&&s.item.itemId;c(t?{...s,id:s.item.itemId,name:s.item.title,description:s.item.title,price:s.item.sku.def.promotionPrice*1.5,cost:s.item.sku.def.promotionPrice,shipping:0,images:[s.item.image],variants:[],inventory_count:0}:{...s,name:s.name||s.product_title,description:s.description||s.product_description||"",price:s.price||s.target_sale_price*1.5,cost:s.cost||s.target_sale_price,shipping:s.shipping||s.shipping_cost||0,images:s.images||[s.product_main_image_url],variants:s.variants||[],inventory_count:s.inventory_count||0})}},[s]);const S=(t,r)=>{c(n=>({...n,[t]:r}))},K=async t=>{if(t)try{const r=await Be(t);c(n=>{const d=Array.isArray(n.images)?n.images:[];return{...n,images:[...d,r]}})}catch(r){console.error("Error converting file to base64:",r),m({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},V=t=>{c(r=>({...r,images:r.images.filter((n,d)=>d!==t)}))},O=async()=>{if(!a||!a.name){m({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const t=a.images&&a.images.length>0?a.images[0]:null;if(!t){m({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}F(!0);try{if(!await ge(j.uid,2)){m({title:"Insufficient Credits",description:"You need at least 2 credits to generate more visuals.",variant:"destructive"}),F(!1);return}const{base64ImageData:n,mimeType:d}=await $e(t),f=a.name;let w=[];try{const x=await Ge(n,d,f);x&&x.length>0&&w.push(...x.slice(0,2)),m({title:"Angles Generated",description:`${Math.min(2,(x==null?void 0:x.length)||0)} angle images generated.`,variant:"success"})}catch(x){console.error("Error generating angles:",x),m({title:"Angle Generation Failed",description:x.message,variant:"destructive"})}const q=[`Place this product, "${f}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${f}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const x of q)try{const E=await _e(n,d,x);E&&E.editedImageData&&w.push(`data:${E.newMimeType};base64,${E.editedImageData}`)}catch(E){console.error(`Error generating context image with prompt "${x}":`,E),m({title:"Context Image Failed",description:`Failed for: ${x.substring(0,30)}...`,variant:"destructive"})}m({title:"Context Images Attempted",description:`Attempted to generate ${q.length} context images.`,variant:"success"}),w.length>0?c(x=>{const E=Array.isArray(x.images)?x.images:[],te=new Set(E),J=w.filter(ae=>!te.has(ae));return J.length>0?{...x,images:[...E,...J]}:(m({title:"Visuals Generated",description:"Generated images were already present.",variant:"default"}),x)}):m({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"}),await ve(j.uid,2)}catch(r){console.error("Error in handleGenerateMoreVisuals:",r),m({title:"Visual Generation Error",description:r.message,variant:"destructive"})}finally{F(!1)}},T=async()=>{if(!await ge(j.uid,15)){m({title:"Insufficient Credits",description:"You need at least 15 credits to generate a video.",variant:"destructive"});return}await ve(j.uid,15),m({title:"Video Generation",description:"Video generation initiated. This is a placeholder."})},Y=(t,r)=>{c(n=>{const d=[...n.variants||[]];return d[t]={...d[t],name:r},{...n,variants:d}})},z=(t,r,n)=>{c(d=>{const f=[...d.variants||[]],w={...f[t]};return w.values=[...w.values||[]],w.values[r]=n,f[t]=w,{...d,variants:f}})},l=t=>{c(r=>{const n=[...r.variants||[]],d={...n[t]};return d.values=[...d.values||[],""],n[t]=d,{...r,variants:n}})},A=(t,r)=>{c(n=>{const d=[...n.variants||[]],f={...d[t]};return f.values=(f.values||[]).filter((w,q)=>q!==r),d[t]=f,{...n,variants:d}})},U=()=>{c(t=>({...t,variants:[...t.variants||[],{name:"",values:[""]}]}))},H=t=>{c(r=>({...r,variants:(r.variants||[]).filter((n,d)=>d!==t)}))},X=async()=>{if(L(!0),!a.name||a.name.trim()===""||a.price===void 0||String(a.price).trim()===""){m({title:"Missing Information",description:"Please ensure the product has a name and a valid price.",variant:"destructive"}),L(!1);return}try{const t={...a,product_title:a.name,product_description:a.description,sale_price:a.price,target_sale_price:a.cost,shipping_cost:a.shipping,product_main_image_url:a.images[0]};if(N&&N.products){const r=N.products.map(n=>n.id===t.id?t:n);await i(v,{products:r})}b(t,s.id),u()}catch{m({title:"Save Error",description:"Could not save product changes.",variant:"destructive"})}finally{L(!1)}},Z=t=>{M(t),I(!0)};if(!k||!a)return null;const ee=a.price-a.cost-a.shipping,W=a.price>0?ee/a.price*100:0;return e.jsxs(e.Fragment,{children:[e.jsx(de,{open:k,onOpenChange:t=>!t&&u(),children:e.jsxs(ce,{className:"max-w-2xl",children:[e.jsxs(me,{children:[e.jsxs(ue,{children:["Edit Product: ",s.item?s.item.title:s.product_title]}),e.jsx(Ce,{children:"Make changes to the product details below."})]}),e.jsx(Se,{className:"max-h-[60vh] p-1",children:e.jsx("div",{className:"space-y-4 pr-4",children:e.jsxs(xe,{className:"p-4 space-y-3",children:[e.jsxs("div",{children:[e.jsx($,{htmlFor:"productName-edit",children:"Product Name"}),e.jsx(G,{id:"productName-edit",value:a.name,onChange:t=>S("name",t.target.value),placeholder:"Product Name"})]}),e.jsxs("div",{children:[e.jsx($,{htmlFor:"productDescription-edit",children:"Description"}),e.jsx(Te,{id:"productDescription-edit",value:a.description,onChange:t=>S("description",t.target.value),placeholder:"Product Description",rows:3})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs($,{htmlFor:"productPrice-edit",children:["Price (",a.currencyCode||"USD",")"]}),e.jsx(G,{id:"productPrice-edit",type:"number",value:a.price,onChange:t=>S("price",parseFloat(t.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),e.jsx(Q,{value:100,className:"h-2"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx($,{htmlFor:"productCost-edit",children:"Cost"}),e.jsx(G,{id:"productCost-edit",type:"number",value:a.cost,onChange:t=>S("cost",parseFloat(t.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),e.jsx(Q,{value:a.price>0?a.cost/a.price*100:0,className:"h-2 [&>div]:bg-red-500"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx($,{htmlFor:"productShipping-edit",children:"Shipping"}),e.jsx(G,{id:"productShipping-edit",type:"number",value:a.shipping,onChange:t=>S("shipping",parseFloat(t.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),e.jsx(Q,{value:a.price>0?a.shipping/a.price*100:0,className:"h-2 [&>div]:bg-orange-500"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx($,{children:"Profit"}),e.jsx(G,{value:ee.toFixed(2),disabled:!0,className:"w-24 text-right"})]}),e.jsx(Q,{value:W,className:"h-2 [&>div]:bg-green-500"})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx($,{children:"Profit Margin"}),e.jsx(G,{value:`${W.toFixed(2)}%`,disabled:!0,className:"w-24 text-right"})]}),e.jsx(Q,{value:W,className:"h-2 [&>div]:bg-green-500"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($,{children:"Product Images"}),e.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(a.images||[]).map((t,r)=>e.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>Z(t),children:[e.jsx("img",{src:t,alt:`Product image ${r+1}`,className:"w-full h-full object-contain rounded-md border"}),e.jsx(p,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:n=>{n.stopPropagation(),V(r)},children:e.jsx(ne,{className:"h-3 w-3"})})]},r))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById("productImageUpload-edit").click(),children:[e.jsx(Ae,{className:"mr-2 h-4 w-4"})," Upload"]}),e.jsx(G,{id:"productImageUpload-edit",type:"file",accept:"image/*",className:"hidden",onChange:t=>K(t.target.files[0])}),e.jsxs(p,{type:"button",variant:"outline",size:"sm",onClick:O,disabled:y||C||!a.name||!a.images||a.images.length===0,children:[C?e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(re,{className:"mr-2 h-4 w-4"}),"More Angles/Context (AI)"]}),e.jsxs(p,{type:"button",variant:"outline",size:"sm",onClick:T,disabled:y||C,children:[e.jsx(re,{className:"mr-2 h-4 w-4"}),"Generate Video (AI)"]})]})]}),e.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(a.variants||[]).map((t,r)=>e.jsxs(xe,{className:"p-2 space-y-2 bg-muted/10",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx($,{htmlFor:`variantName-edit-${r}`,className:"text-xs",children:"Option Name"}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>H(r),className:"h-6 w-6",children:e.jsx(ne,{className:"h-3 w-3 text-destructive"})})]}),e.jsx(G,{id:`variantName-edit-${r}`,value:t.name||"",onChange:n=>Y(r,n.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),e.jsx($,{className:"text-xs",children:"Option Values"}),(t.values||[]).map((n,d)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{value:n||"",onChange:f=>z(r,d,f.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),e.jsx(p,{variant:"ghost",size:"icon",onClick:()=>A(r,d),className:"h-6 w-6",children:e.jsx(ne,{className:"h-3 w-3 text-destructive"})})]},d)),e.jsxs(p,{variant:"outline",size:"sm",onClick:()=>l(r),className:"text-xs h-7",children:[e.jsx(le,{className:"mr-1 h-3 w-3"})," Add Value"]})]},r)),e.jsxs(p,{variant:"outline",onClick:U,className:"w-full text-sm h-8",children:[e.jsx(le,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]}),e.jsxs("div",{className:"pt-3 border-t mt-3",children:[e.jsx($,{htmlFor:"productInventory-edit",children:"Inventory Count"}),e.jsx(G,{id:"productInventory-edit",type:"number",value:a.inventory_count||"",onChange:t=>S("inventory_count",parseInt(t.target.value)||0),placeholder:"0"})]})]})})}),e.jsxs(Ee,{children:[e.jsx(he,{asChild:!0,children:e.jsx(p,{type:"button",variant:"outline",onClick:u,children:"Cancel"})}),e.jsxs(p,{type:"button",onClick:X,disabled:y,children:[y?e.jsx(pe,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save Changes"]})]})]})}),R&&D&&e.jsx(de,{open:R,onOpenChange:I,children:e.jsxs(ce,{className:"max-w-xl max-h-[80vh]",children:[e.jsxs(me,{children:[e.jsx(ue,{children:"Enlarged Image"}),e.jsx(he,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:()=>I(!1),children:e.jsx(le,{className:"h-4 w-4 rotate-45"})})})]}),e.jsx("div",{className:"flex justify-center items-center p-4",children:e.jsx("img",{src:D,alt:"Enlarged product",className:"max-w-full max-h-[70vh] object-contain"})})]})})]})},Ue=({product:k,theme:u,index:s,storeName:b,storeId:v,isPublishedView:o=!1,displayMode:j="grid"})=>{var W,t,r,n,d,f,w,q,x,E,te,J,ae;const[i,N]=g.useState(k);g.useEffect(()=>{N(k)},[k]);const{addToCart:a,updateStore:c,currentStore:y}=oe(),[L,C]=g.useState(!1),[F,D]=g.useState(!1),[M,R]=g.useState(!1),[I,m]=g.useState(!1),S=!o,K=h=>typeof h=="string"&&h.startsWith("gid://shopify/"),V=i.id,O=K(V)?btoa(V):V,T=i.inventory_count,Y=h=>{h.stopPropagation(),a(i,v)},z=h=>{h.stopPropagation(),R(!M)},l=(u==null?void 0:u.primaryColor)||"#3B82F6",A={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.5,delay:s*.07,type:"spring",stiffness:100,damping:15}}},U={hover:{scale:1.05,transition:{duration:.35,ease:"circOut"}},initial:{scale:1}},H=h=>{h.stopPropagation(),h.preventDefault(),m(!0)},X=()=>{m(!1)},Z=async h=>{if(v&&V)try{if(await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/manage-product",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("supabase.auth.token")}`},body:JSON.stringify({store_id:v,product_id:V,...h})}),N(P=>({...P,...h})),y&&y.id===v&&y.products){const P=y.products.map(ie=>ie.id===V?{...ie,...h}:ie);c(v,{products:P})}else y&&y.id===v&&!y.products&&c(v,{products:[{...i,...h}]});m(!1)}catch(P){console.error("Failed to save product changes:",P)}},ee={hidden:{opacity:0,y:8},visible:{opacity:1,y:0,transition:{duration:.25,ease:"easeOut"}}};return j==="list"?e.jsxs(e.Fragment,{children:[e.jsxs(_.div,{variants:A,initial:"hidden",animate:"visible",className:"group bg-white/70 dark:bg-neutral-800/70 backdrop-blur-md rounded-2xl border border-neutral-200/70 dark:border-neutral-700/70 hover:border-primary/40 transition-all duration-300 shadow-sm hover:shadow-xl hover:shadow-primary/10 flex",onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1),children:[e.jsxs(se,{to:`/${b}/product/${O}`,className:"w-1/3 sm:w-40 md:w-48 block relative overflow-hidden rounded-l-2xl bg-neutral-100 dark:bg-neutral-700",children:[" ",(t=(W=i.image)==null?void 0:W.src)!=null&&t.medium||Array.isArray(i.images)&&i.images.length>0&&i.images[0]?e.jsx(_.img,{src:((n=(r=i.image)==null?void 0:r.src)==null?void 0:n.medium)||i.images[0],alt:i.name,className:"w-full h-full object-cover",variants:U,initial:"initial",whileHover:"hover",onLoad:()=>D(!0),animate:F?"visible":"hidden"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-neutral-100 dark:bg-neutral-700 text-neutral-400 dark:text-neutral-500 text-3xl font-semibold",children:((d=i.name)==null?void 0:d.charAt(0))||"?"})]}),e.jsxs("div",{className:"w-2/3 p-4 sm:p-5 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs(se,{to:`/${b}/product/${O}`,children:[" ",e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-neutral-800 dark:text-white hover:text-primary dark:hover:text-primary-light transition-colors mb-1 line-clamp-2",children:i.name})]}),e.jsx("p",{className:"text-neutral-500 dark:text-neutral-400 text-xs sm:text-sm mb-2 line-clamp-2 leading-snug",children:i.description}),e.jsx("div",{className:"flex items-center gap-1 mb-1",children:[...Array(5)].map(h=>e.jsx(be,{className:`w-3.5 h-3.5 ${h<(i.rating||4)?"fill-yellow-400 text-yellow-400":"fill-neutral-300 dark:fill-neutral-600 text-neutral-300 dark:text-neutral-600"}`},h))})]}),e.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[e.jsxs("div",{className:"text-lg sm:text-xl font-bold",style:{color:l},children:["$",((f=i.price)==null?void 0:f.toFixed(2))||"0.00"]}),e.jsxs(p,{onClick:Y,size:"sm",className:"bg-primary hover:bg-primary/90 text-white border-0 rounded-lg px-3 py-1.5 text-xs sm:text-sm",disabled:T!==void 0&&T<=0,children:[e.jsx(Ie,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5"}),T!==void 0&&T<=0?"Out of Stock":"Add to Cart"]}),S&&e.jsxs(p,{onClick:H,size:"sm",variant:"outline",className:"border-primary/50 text-primary hover:bg-primary/10 rounded-lg px-3 py-1.5 text-xs sm:text-sm ml-2",children:[e.jsx(fe,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5"}),"Edit"]})]})]})]}),I&&e.jsx(ye,{product:k,isOpen:I,onClose:X,onSave:Z,storeId:v,theme:u})]}):e.jsxs(e.Fragment,{children:[e.jsxs(_.div,{variants:A,initial:"hidden",animate:"visible",className:"group relative bg-white/70 dark:bg-neutral-800/70 backdrop-blur-md rounded-2xl overflow-hidden border border-neutral-200/70 dark:border-neutral-700/70 hover:border-primary/40 transition-all duration-300 shadow-sm hover:shadow-xl hover:shadow-primary/10",onMouseEnter:()=>C(!0),onMouseLeave:()=>C(!1),whileHover:{y:-6},children:[e.jsxs(se,{to:`/${b}/product/${O}`,className:"block",children:[" ",e.jsxs("div",{className:"aspect-square relative overflow-hidden bg-neutral-100 dark:bg-neutral-700",children:[(q=(w=i.image)==null?void 0:w.src)!=null&&q.medium||Array.isArray(i.images)&&i.images.length>0&&i.images[0]?e.jsx(_.img,{src:((E=(x=i.image)==null?void 0:x.src)==null?void 0:E.medium)||i.images[0],alt:i.name,className:"w-full h-full object-cover",variants:U,initial:"initial",whileHover:"hover",onLoad:()=>D(!0),animate:F?"visible":"hidden"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-neutral-100 dark:bg-neutral-700 text-neutral-400 dark:text-neutral-500 text-5xl font-semibold",children:((te=i.name)==null?void 0:te.charAt(0))||"?"}),e.jsx(Ne,{children:L&&!S&&e.jsxs(_.div,{variants:ee,initial:"hidden",animate:"visible",exit:"hidden",className:"absolute top-2.5 right-2.5 flex flex-col gap-1.5 z-10",children:[e.jsx(p,{variant:"outline",size:"icon",className:"h-8 w-8 bg-white/80 dark:bg-neutral-800/80 border-neutral-300/70 dark:border-neutral-600/70 text-neutral-600 dark:text-neutral-300 hover:text-primary dark:hover:text-primary-light hover:border-primary/50 backdrop-blur-sm rounded-lg shadow-sm",children:e.jsx(Ve,{className:"h-4 w-4"})}),e.jsx(p,{variant:"outline",size:"icon",onClick:z,className:`h-8 w-8 bg-white/80 dark:bg-neutral-800/80 border-neutral-300/70 dark:border-neutral-600/70 text-neutral-600 dark:text-neutral-300 hover:text-red-500 dark:hover:text-red-400 hover:border-red-500/50 backdrop-blur-sm rounded-lg shadow-sm ${M?"text-red-500 dark:text-red-400 border-red-500/50":""}`,children:e.jsx(Fe,{className:`h-4 w-4 transition-colors ${M?"fill-red-500":""}`})})]})}),((J=i.tags)==null?void 0:J.includes("New"))&&e.jsxs(Le,{variant:"default",className:"absolute top-2.5 left-2.5 bg-primary text-white text-[10px] px-1.5 py-0.5 rounded-full",children:[e.jsx(re,{className:"w-2.5 h-2.5 mr-1"})," NEW"]})]})]}),e.jsxs("div",{className:"p-4 sm:p-5",children:[e.jsxs(se,{to:`/${b}/product/${O}`,children:[" ",e.jsx("h3",{className:"text-sm sm:text-base font-semibold text-neutral-800 dark:text-white hover:text-primary dark:hover:text-primary-light transition-colors mb-1 line-clamp-2",children:i.name})]}),e.jsx("p",{className:"text-neutral-500 dark:text-neutral-400 text-xs sm:text-sm mb-2 line-clamp-2 leading-snug",children:i.description}),e.jsx("div",{className:"flex items-center gap-1 mb-1",children:[...Array(5)].map((h,P)=>e.jsx(be,{className:`w-3.5 h-3.5 ${P<(i.rating||4)?"fill-yellow-400 text-yellow-400":"fill-neutral-300 dark:fill-neutral-600 text-neutral-300 dark:text-neutral-600"}`},P))}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-base sm:text-lg font-bold",style:{color:l},children:["$",((ae=i.price)==null?void 0:ae.toFixed(2))||"N/A"]}),e.jsxs(p,{onClick:Y,size:"sm",className:"bg-primary hover:bg-primary/90 text-white dark:bg-neutral-300 dark:text-neutral-800 border-0 rounded-lg px-3 py-1.5 text-xs",disabled:T!==void 0&&T<=0,children:[e.jsx(De,{className:"h-3.5 w-3.5 mr-1"}),T!==void 0&&T<=0?"Out of Stock":"Add"]})]}),S&&e.jsxs(p,{onClick:H,variant:"outline",size:"sm",className:"w-full mt-2 border-primary/50 text-primary hover:bg-primary/10 rounded-lg text-xs",children:[e.jsx(fe,{className:"h-3.5 w-3.5 mr-1.5"}),"Edit Product"]})]})]}),I&&e.jsx(ye,{product:i,isOpen:I,onClose:X,onSave:Z,storeId:v,theme:u})]})},Ye=({store:k,isPublishedView:u=!1})=>{const{products:s,theme:b,id:v,content:o}=k,{updateStoreTextContent:j,viewMode:i}=oe(),[N,a]=g.useState("grid"),[c,y]=g.useState(""),[L,C]=g.useState(s||[]),[F,D]=g.useState(!0),M=(o==null?void 0:o.productGridSectionTitle)||"Our Products",R=(o==null?void 0:o.productGridSectionSubtitle)||"Discover fresh arrivals and top picks, curated just for you.",I=(o==null?void 0:o.productGridBadgeText)||"Handpicked For You",m=(o==null?void 0:o.productGridSearchPlaceholder)||"Search products...",S=(o==null?void 0:o.productGridNoProductsTitle)||"No Products Found",K=(o==null?void 0:o.productGridNoProductsSubtitle)||'Your search for "{searchTerm}" did not match any products.',V=(o==null?void 0:o.productGridClearSearchButtonText)||"Clear Search",O=(o==null?void 0:o.productGridEmptyStateTitle)||M,T=(o==null?void 0:o.productGridEmptyStateSubtitle)||"Our product lineup is currently being updated. Please check back soon!";g.useEffect(()=>{D(!0);const l=setTimeout(()=>{C(s||[]),D(!1)},300);return()=>clearTimeout(l)},[s]),g.useEffect(()=>{if(!s){C([]);return}let l=s;c.trim()!==""&&(l=l.filter(A=>{var U,H;return((U=A.name)==null?void 0:U.toLowerCase().includes(c.toLowerCase()))||((H=A.description)==null?void 0:H.toLowerCase().includes(c.toLowerCase()))})),C(l)},[c,s]);const Y=()=>e.jsxs("div",{className:"bg-white/60 dark:bg-neutral-800/60 backdrop-blur-sm rounded-2xl overflow-hidden border border-neutral-200/60 dark:border-neutral-700/60 animate-pulse",children:[e.jsx("div",{className:"aspect-square bg-neutral-200 dark:bg-neutral-700"}),e.jsxs("div",{className:"p-5 space-y-2.5",children:[e.jsx("div",{className:"h-4 bg-neutral-200 dark:bg-neutral-700 rounded-lg w-4/5"}),e.jsx("div",{className:"h-3 bg-neutral-200 dark:bg-neutral-700 rounded-lg w-3/5"}),e.jsx("div",{className:"h-5 bg-primary/20 rounded-lg w-1/3 mt-3"})]})]}),z=(b==null?void 0:b.primaryColor)||"#3B82F6";return!s&&!F?e.jsx("section",{id:`products-${v}`,className:"py-16 md:py-24 bg-neutral-50 dark:bg-neutral-800/90",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 text-center",children:[e.jsx(Me,{className:"w-12 h-12 mx-auto mb-4",style:{color:z}}),e.jsx(B,{initialText:O,onSave:l=>j("productGridEmptyStateTitle",l),isAdmin:!u&&i==="edit",as:"h2",textClassName:"text-3xl font-bold mb-3 text-neutral-800 dark:text-white",inputClassName:"text-3xl font-bold mb-3 text-neutral-800 dark:text-white bg-transparent",className:"text-3xl font-bold mb-3 text-neutral-800 dark:text-white"}),e.jsx(B,{initialText:T,onSave:l=>j("productGridEmptyStateSubtitle",l),isAdmin:!u&&i==="edit",as:"p",textClassName:"text-neutral-600 dark:text-neutral-400 text-lg",inputClassName:"text-neutral-600 dark:text-neutral-400 text-lg bg-transparent",className:"text-neutral-600 dark:text-neutral-400 text-lg",useTextarea:!0})]})}):e.jsxs("section",{id:`products-${v}`,className:"py-16 md:py-24 bg-neutral-50 dark:bg-neutral-800/90 relative overflow-hidden",children:[e.jsx("div",{className:"absolute top-1/4 left-0 w-1/2 h-1/2 bg-gradient-to-br from-primary/5 to-transparent rounded-full -translate-x-1/2 blur-3xl opacity-50 dark:opacity-30"}),e.jsx("div",{className:"absolute bottom-1/4 right-0 w-1/2 h-1/2 bg-gradient-to-tl from-primary/5 to-transparent rounded-full translate-x-1/2 blur-3xl opacity-50 dark:opacity-30"}),e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 relative z-10",children:[e.jsxs(_.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.6},className:"text-center mb-10 md:mb-14",children:[e.jsxs(_.div,{className:"inline-flex items-center gap-2 px-4 py-1.5 rounded-full text-sm font-medium mb-4",style:{backgroundColor:`${z}1A`,color:z,border:`1px solid ${z}40`},initial:{scale:.9,opacity:0},whileInView:{scale:1,opacity:1},viewport:{once:!0},transition:{delay:.1,duration:.4},children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx(B,{initialText:I,onSave:l=>j("productGridBadgeText",l),isAdmin:!u&&i==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})]}),e.jsx(B,{initialText:M,onSave:l=>j("productGridSectionTitle",l),isAdmin:!u&&i==="edit",as:"h2",textClassName:"text-3xl md:text-5xl font-bold tracking-tight mb-3 text-neutral-800 dark:text-white",inputClassName:"text-3xl md:text-5xl font-bold tracking-tight mb-3 text-neutral-800 dark:text-white bg-transparent",className:"text-3xl md:text-5xl font-bold tracking-tight mb-3 text-neutral-800 dark:text-white"}),e.jsx(B,{initialText:R,onSave:l=>j("productGridSectionSubtitle",l),isAdmin:!u&&i==="edit",as:"p",textClassName:"text-neutral-600 dark:text-neutral-300 max-w-xl mx-auto text-md md:text-lg leading-relaxed",inputClassName:"text-neutral-600 dark:text-neutral-300 max-w-xl mx-auto text-md md:text-lg leading-relaxed bg-transparent",className:"text-neutral-600 dark:text-neutral-300 max-w-xl mx-auto text-md md:text-lg leading-relaxed",useTextarea:!0})]}),e.jsxs(_.div,{initial:{opacity:0,y:15},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.2,duration:.5},className:"flex flex-col md:flex-row justify-between items-center mb-8 md:mb-10 gap-4",children:[e.jsxs("div",{className:"relative w-full md:max-w-xs",children:[e.jsx(je,{className:"absolute left-3.5 top-1/2 transform -translate-y-1/2 text-neutral-400 dark:text-neutral-500 h-4 w-4"}),e.jsx(G,{type:"text",placeholder:m,className:"w-full pl-10 pr-4 py-2.5 text-sm bg-white/70 dark:bg-neutral-800/70 backdrop-blur-sm border-neutral-300/70 dark:border-neutral-700/70 rounded-xl focus:ring-primary/30 focus:border-primary/60 transition-colors text-neutral-700 dark:text-neutral-200 placeholder-neutral-500 dark:placeholder-neutral-400",value:c,onChange:l=>y(l.target.value)})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1 bg-white/70 dark:bg-neutral-800/70 backdrop-blur-sm rounded-xl p-1 border border-neutral-300/70 dark:border-neutral-700/70",children:[e.jsx(p,{variant:"ghost",size:"icon",className:`h-8 w-8 rounded-lg transition-all duration-200 ${N==="grid"?"bg-primary text-white":"text-neutral-500 dark:text-neutral-400 hover:text-primary dark:hover:text-primary-light hover:bg-neutral-100 dark:hover:bg-neutral-700/50"}`,onClick:()=>a("grid"),title:"Grid View",children:e.jsx(Oe,{className:"h-4 w-4"})}),e.jsx(p,{variant:"ghost",size:"icon",className:`h-8 w-8 rounded-lg transition-all duration-200 ${N==="list"?"bg-primary text-white":"text-neutral-500 dark:text-neutral-400 hover:text-primary dark:hover:text-primary-light hover:bg-neutral-100 dark:hover:bg-neutral-700/50"}`,onClick:()=>a("list"),title:"List View",children:e.jsx(Pe,{className:"h-4 w-4"})})]})})]}),e.jsx(Ne,{mode:"wait",children:F?e.jsx(_.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:N==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8":"space-y-6",children:Array(N==="grid"?8:3).fill(0).map((l,A)=>e.jsx(Y,{},`skeleton-fresh-${A}`))},"loading-grid-fresh"):L.length>0?e.jsx(_.div,{variants:He,initial:"hidden",animate:"visible",className:N==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8":"space-y-6",children:L.map((l,A)=>e.jsx(Ue,{product:l,theme:b,index:A,storeName:ze(k.name),storeId:v,isPublishedView:u,displayMode:N},l.id||`product-fresh-${A}`))},"product-list-fresh"):e.jsxs(_.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[e.jsx(je,{className:"w-10 h-10 text-neutral-400 dark:text-neutral-500 mx-auto mb-3"}),e.jsx(B,{initialText:S,onSave:l=>j("productGridNoProductsTitle",l),isAdmin:!u&&i==="edit",as:"h3",textClassName:"text-xl font-semibold text-neutral-700 dark:text-white mb-2",inputClassName:"text-xl font-semibold text-neutral-700 dark:text-white mb-2 bg-transparent",className:"text-xl font-semibold text-neutral-700 dark:text-white mb-2"}),e.jsx(B,{initialText:K.replace("{searchTerm}",c),onSave:l=>j("productGridNoProductsSubtitle",l),isAdmin:!u&&i==="edit",as:"p",textClassName:"text-neutral-500 dark:text-neutral-400 text-sm",inputClassName:"text-neutral-500 dark:text-neutral-400 text-sm bg-transparent",className:"text-neutral-500 dark:text-neutral-400 text-sm",useTextarea:!0}),e.jsx(p,{variant:"link",onClick:()=>y(""),className:"text-primary hover:text-primary/80 mt-3 text-sm",children:e.jsx(B,{initialText:V,onSave:l=>j("productGridClearSearchButtonText",l),isAdmin:!u&&i==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})})]},"no-products-fresh")})]})]})},He={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.06}}};export{Ye as default};
