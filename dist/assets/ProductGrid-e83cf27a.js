import{u as Q,r as d,j as e,m as c,L as z,V as J,c as R,B as b,i as te,k as W,A as ee,E as se,H as ae,Z as ie,a1 as oe,av as re,I as j,G as Y,l as D,n as le}from"./index-1e2a087c.js";import{P as K,L as ne}from"./ProductEditModal-3669a150.js";const de=({product:y,theme:i,index:l,storeName:w,storeId:o,isPublishedView:n=!1,displayMode:m="grid"})=>{var H,I,_,q,U,V,X,Z;const{addToCart:x,updateStore:h,currentStore:u}=Q(),[t,C]=d.useState(y);d.useEffect(()=>{C(y)},[y]);const[$,g]=d.useState(!1),[T,k]=d.useState(!1),[f,A]=d.useState(!1),E=!n,B=r=>typeof r=="string"&&r.startsWith("gid://shopify/"),v=t.id,S=B(v)?btoa(v):v,a=t.inventory_count,L=r=>{r.stopPropagation(),(t.inventory_count===void 0||t.inventory_count>0)&&x(t,o)};i!=null&&i.primaryColor;const O={hidden:{opacity:0,y:20},visible:{opacity:1,y:0,transition:{duration:.4,delay:l*.05,type:"spring",stiffness:120,damping:14}}},M={hover:{scale:1.08,transition:{duration:.4,ease:"easeInOut"}},initial:{scale:1}},s={hidden:{opacity:0,y:10},visible:{opacity:1,y:0,transition:{duration:.2,ease:"easeOut"}}},p=r=>{r.stopPropagation(),r.preventDefault(),A(!0)},G=()=>{A(!1)},P=async r=>{if(o&&v)try{if(await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/manage-product",{method:"PUT",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("supabase.auth.token")}`},body:JSON.stringify({store_id:o,product_id:v,...r})}),C(N=>({...N,...r})),u&&u.id===o&&u.products){const N=u.products.map(F=>F.id===v?{...F,...r}:F);h(o,{products:N})}else u&&u.id===o&&!u.products&&h(o,{products:[{...t,...r}]});A(!1)}catch(N){console.error("Failed to save product changes:",N)}};return m==="list"?e.jsxs(e.Fragment,{children:[e.jsxs(c.div,{variants:O,initial:"hidden",animate:"visible",className:"bg-slate-800/70 rounded-md overflow-hidden shadow-lg hover:shadow-blue-900/40 transition-all duration-300 border border-slate-700 hover:border-blue-600/70 group flex",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),children:[e.jsxs(z,{to:`/${w}/product/${S}`,className:"w-1/3 block relative overflow-hidden bg-slate-700 aspect-[3/4]",children:[" ",(I=(H=t.image)==null?void 0:H.src)!=null&&I.medium?e.jsx(c.img,{src:t.image.src.medium,alt:t.name,className:"w-full h-full object-cover",variants:M,initial:"initial",whileHover:"hover",onLoad:()=>k(!0),animate:T?"visible":"hidden"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-700 text-slate-500 text-3xl font-bold font-mono",children:((_=t.name)==null?void 0:_.charAt(0))||"X"})]}),e.jsxs("div",{className:"w-2/3 p-4 sm:p-5 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs(J,{variant:"outline",className:"mb-2 border-blue-600/50 text-blue-400 bg-blue-900/30 text-xs font-mono uppercase px-2 py-0.5",children:[e.jsx(R,{className:"w-3 h-3 mr-1.5"})," Featured"]}),e.jsxs(z,{to:`/${w}/product/${S}`,children:[" ",e.jsx("h3",{className:"text-base sm:text-lg font-semibold text-slate-100 hover:text-blue-400 transition-colors mb-1 font-mono uppercase tracking-wide line-clamp-2",children:t.name})]}),e.jsx("p",{className:"text-slate-400 text-xs sm:text-sm mb-1 line-clamp-2 leading-snug",children:t.description}),e.jsx("div",{className:"text-xs mt-1 mb-2",children:a!==void 0?a>0?e.jsxs("span",{className:"text-green-400 font-medium",children:["In Stock (",a,")"]}):e.jsx("span",{className:"text-red-400 font-medium",children:"Out of Stock"}):e.jsx("span",{className:"text-slate-500",children:"Stock N/A"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-auto",children:[e.jsxs("div",{className:"text-lg sm:text-xl font-bold text-blue-400 font-mono",children:["$",((q=t.price)==null?void 0:q.toFixed(2))||"N/A"]}),e.jsxs(b,{onClick:L,size:"sm",className:"bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white border-0 rounded-md px-3 py-1.5 sm:px-4 text-xs sm:text-sm font-mono uppercase tracking-wider",disabled:a!==void 0&&a<=0,children:[e.jsx(te,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5"}),a!==void 0&&a<=0?"Out of Stock":"Add to Cart"]}),E&&e.jsxs(b,{onClick:p,size:"sm",variant:"outline",className:"border-blue-600/70 text-blue-400 hover:bg-blue-700/30 rounded-md px-3 py-1.5 sm:px-4 text-xs sm:text-sm font-mono uppercase tracking-wider ml-2",children:[e.jsx(W,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4 mr-1.5"}),"Edit"]})]})]})]}),f&&e.jsx(K,{product:t,isOpen:f,onClose:G,onSave:P,storeId:o,theme:i})]}):e.jsxs(e.Fragment,{children:[e.jsxs(c.div,{variants:O,initial:"hidden",animate:"visible",className:"bg-slate-800/70 rounded-lg overflow-hidden shadow-lg hover:shadow-blue-900/40 transition-all duration-300 border border-slate-700 hover:border-blue-600/70 group relative",onMouseEnter:()=>g(!0),onMouseLeave:()=>g(!1),whileHover:{y:-5},children:[e.jsxs(z,{to:`/${w}/product/${S}`,className:"block",children:[" ",e.jsxs("div",{className:"aspect-square relative overflow-hidden bg-slate-700",children:[(V=(U=t.image)==null?void 0:U.src)!=null&&V.medium?e.jsx(c.img,{src:t.image.src.medium,alt:t.name,className:"w-full h-full object-cover",variants:M,initial:"initial",whileHover:"hover",onLoad:()=>k(!0),animate:T?"visible":"hidden"}):e.jsx("div",{className:"w-full h-full flex items-center justify-center bg-slate-700 text-slate-500 text-5xl font-bold font-mono",children:((X=t.name)==null?void 0:X.charAt(0))||"X"}),e.jsx(ee,{children:$&&!E&&e.jsxs(c.div,{variants:s,initial:"hidden",animate:"visible",exit:"hidden",className:"absolute top-2 right-2 flex flex-col gap-1.5 z-10",children:[e.jsx(b,{variant:"outline",size:"icon",className:"h-7 w-7 bg-slate-800/70 border-slate-600 text-slate-300 hover:text-blue-400 hover:border-blue-500/70 backdrop-blur-sm rounded-md",children:e.jsx(se,{className:"h-3.5 w-3.5"})}),e.jsx(b,{variant:"outline",size:"icon",className:"h-7 w-7 bg-slate-800/70 border-slate-600 text-slate-300 hover:text-blue-400 hover:border-blue-500/70 backdrop-blur-sm rounded-md",children:e.jsx(ae,{className:"h-3.5 w-3.5"})})]})}),e.jsx("div",{className:"absolute top-2 left-2",children:e.jsxs(J,{variant:"outline",className:"border-blue-600/50 text-blue-400 bg-blue-900/30 text-[10px] font-mono uppercase px-1.5 py-0.5",children:[e.jsx(ie,{className:"w-2.5 h-2.5 mr-1"})," ","New"]})})]})]}),e.jsxs("div",{className:"p-4",children:[e.jsxs(z,{to:`/${w}/product/${S}`,children:[" ",e.jsx("h3",{className:"text-md font-semibold text-slate-100 hover:text-blue-400 transition-colors mb-1 font-mono uppercase tracking-wide line-clamp-2",children:t.name})]}),e.jsx("div",{className:"flex items-center gap-1 mb-1",children:[...Array(5)].map((r,N)=>e.jsx(R,{className:`w-3 h-3 ${N<(t.rating||4)?"fill-yellow-400 text-yellow-400":"fill-slate-600 text-slate-600"}`},N))}),e.jsx("div",{className:"text-xs mt-1 mb-2",children:a!==void 0?a>0?e.jsxs("span",{className:"text-green-400 font-medium",children:["In Stock (",a,")"]}):e.jsx("span",{className:"text-red-400 font-medium",children:"Out of Stock"}):e.jsx("span",{className:"text-slate-500",children:"Stock N/A"})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("p",{className:"text-lg font-bold text-blue-400 font-mono",children:["$",((Z=t.price)==null?void 0:Z.toFixed(2))||"N/A"]}),e.jsxs(b,{onClick:L,size:"sm",className:"bg-gradient-to-r from-blue-600 to-blue-500 hover:from-blue-700 hover:to-blue-600 text-white border-0 rounded-md px-3 py-1.5 text-xs font-mono uppercase tracking-wider",disabled:a!==void 0&&a<=0,children:[e.jsx(oe,{className:"h-3.5 w-3.5 mr-1"}),a!==void 0&&a<=0?"Out of Stock":"Add"]})]}),E&&e.jsxs(b,{onClick:p,variant:"outline",size:"sm",className:"w-full mt-3 border-blue-600/70 text-blue-400 hover:bg-blue-700/30 rounded-md text-xs font-mono uppercase tracking-wider",children:[e.jsx(W,{className:"h-3.5 w-3.5 mr-1.5"}),"Edit Product"]})]})]}),f&&e.jsx(K,{product:t,isOpen:f,onClose:G,onSave:P,storeId:o,theme:i})]})},ue=({store:y,isPublishedView:i=!1})=>{const{products:l=[],theme:w={},id:o,content:n={}}=y||{},{updateStoreTextContent:m,viewMode:x}=Q(),[h,u]=d.useState("grid"),[t,C]=d.useState(""),[$,g]=d.useState(Array.isArray(l)?l:[]),[T,k]=d.useState(!0),f=n.productGridSectionTitle||"Our Products",A=n.productGridSectionSubtitle||"Explore our curated selection of high-quality items.",E=n.productGridBadgeText||"Featured Products",B=n.productGridSearchPlaceholder||"Search Arsenal...",v=n.productGridNoProductsTitle||"No Gear Found",S=n.productGridNoProductsSubtitle||'Your search for "{searchTerm}" yielded no results. Try a different term or clear search.',a=n.productGridClearSearchButtonText||"Clear Search",L=n.productGridEmptyStateTitle||f,O=n.productGridEmptyStateSubtitle||"No equipment listed at this time. Stand by for inventory updates.";d.useEffect(()=>{k(!0);const s=setTimeout(()=>{g(Array.isArray(l)?l:[]),k(!1)},500);return()=>clearTimeout(s)},[l]),d.useEffect(()=>{if(!Array.isArray(l)){g([]);return}let s=l;t.trim()!==""&&(s=s.filter(p=>{var G,P;return((G=p.name)==null?void 0:G.toLowerCase().includes(t.toLowerCase()))||((P=p.description)==null?void 0:P.toLowerCase().includes(t.toLowerCase()))})),g(s)},[t,l]);const M=()=>e.jsxs("div",{className:"bg-slate-800 rounded-lg overflow-hidden shadow-md border border-slate-700/50 animate-pulse",children:[e.jsx("div",{className:"aspect-square bg-slate-700"}),e.jsxs("div",{className:"p-4 space-y-2",children:[e.jsx("div",{className:"h-4 bg-slate-700 rounded w-3/4"}),e.jsx("div",{className:"h-3 bg-slate-700 rounded w-1/2"}),e.jsx("div",{className:"h-5 bg-blue-700/50 rounded w-1/3 mt-2"})]})]});return!l&&!T?e.jsx("section",{id:`products-${o}`,className:"py-16 md:py-24 bg-slate-900 text-white",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6 text-center",children:[e.jsx(re,{className:"w-12 h-12 text-blue-500 mx-auto mb-4"}),e.jsx(j,{initialText:L,onSave:s=>m("productGridEmptyStateTitle",s),isAdmin:!i&&x==="edit",as:"h2",textClassName:"text-3xl font-bold mb-3 font-mono uppercase",inputClassName:"text-3xl font-bold mb-3 font-mono uppercase bg-transparent",className:"text-3xl font-bold mb-3 font-mono uppercase"}),e.jsx(j,{initialText:O,onSave:s=>m("productGridEmptyStateSubtitle",s),isAdmin:!i&&x==="edit",as:"p",textClassName:"text-slate-400 text-lg",inputClassName:"text-slate-400 text-lg bg-transparent",className:"text-slate-400 text-lg",useTextarea:!0})]})}):e.jsx("section",{id:`products-${o}`,className:"py-16 md:py-24 bg-slate-900 text-white",children:e.jsxs("div",{className:"container mx-auto px-4 sm:px-6",children:[e.jsxs(c.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},viewport:{once:!0,amount:.3},transition:{duration:.5},className:"text-center mb-10 md:mb-12",children:[e.jsxs(c.div,{className:"inline-flex items-center gap-2 px-3 py-1.5 bg-blue-800/30 rounded-md text-xs font-semibold text-blue-300 mb-4 border border-blue-700/50 font-mono uppercase tracking-widest",initial:{scale:.9,opacity:0},whileInView:{scale:1,opacity:1},viewport:{once:!0},transition:{delay:.1,duration:.4},children:[e.jsx(Y,{className:"w-3.5 h-3.5"})," ",e.jsx(j,{initialText:E,onSave:s=>m("productGridBadgeText",s),isAdmin:!i&&x==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})]}),e.jsx(j,{initialText:f,onSave:s=>m("productGridSectionTitle",s),isAdmin:!i&&x==="edit",as:"h2",textClassName:"text-3xl md:text-5xl font-extrabold tracking-tight font-mono uppercase mb-3",inputClassName:"text-3xl md:text-5xl font-extrabold tracking-tight font-mono uppercase mb-3 bg-transparent",className:"text-3xl md:text-5xl font-extrabold tracking-tight font-mono uppercase mb-3",children:e.jsx("span",{className:"bg-gradient-to-r from-slate-100 via-blue-400 to-sky-400 bg-clip-text text-transparent",children:f})}),e.jsx(j,{initialText:A,onSave:s=>m("productGridSectionSubtitle",s),isAdmin:!i&&x==="edit",as:"p",textClassName:"text-slate-400 max-w-xl mx-auto text-md md:text-lg leading-relaxed",inputClassName:"text-slate-400 max-w-xl mx-auto text-md md:text-lg leading-relaxed bg-transparent",className:"text-slate-400 max-w-xl mx-auto text-md md:text-lg leading-relaxed",useTextarea:!0})]}),e.jsxs(c.div,{initial:{opacity:0,y:15},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:.2,duration:.5},className:"flex flex-col md:flex-row justify-between items-center mb-8 md:mb-10 gap-4",children:[e.jsxs("div",{className:"relative w-full md:max-w-sm",children:[e.jsx(D,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-500 h-4 w-4"}),e.jsx("input",{type:"text",placeholder:B,className:"w-full pl-10 pr-4 py-2.5 text-sm border-2 border-slate-700 rounded-md focus:outline-none focus:border-blue-500/70 bg-slate-800 transition-colors text-slate-100 placeholder-slate-500 font-mono",value:t,onChange:s=>C(s.target.value)})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("div",{className:"flex items-center gap-1 bg-slate-800 rounded-md p-0.5 border border-slate-700",children:[e.jsx(b,{variant:"ghost",size:"icon",className:`h-8 w-8 rounded-sm transition-all duration-200 ${h==="grid"?"bg-blue-600 text-white":"text-slate-400 hover:text-blue-400 hover:bg-slate-700/50"}`,onClick:()=>u("grid"),title:"Grid View",children:e.jsx(Y,{className:"h-4 w-4"})}),e.jsx(b,{variant:"ghost",size:"icon",className:`h-8 w-8 rounded-sm transition-all duration-200 ${h==="list"?"bg-blue-600 text-white":"text-slate-400 hover:text-blue-400 hover:bg-slate-700/50"}`,onClick:()=>u("list"),title:"List View",children:e.jsx(ne,{className:"h-4 w-4"})})]})})]}),e.jsx(ee,{mode:"wait",children:T?e.jsx(c.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:h==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8":"space-y-6",children:Array(h==="grid"?8:3).fill(0).map((s,p)=>e.jsx(M,{},`skeleton-${p}`))},"loading-grid"):$.length>0?e.jsx(c.div,{variants:ce,initial:"hidden",animate:"visible",className:h==="grid"?"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6 md:gap-8":"space-y-6",children:$.map((s,p)=>e.jsx(de,{product:s,theme:w,index:p,storeName:le(y.name),storeId:o,isPublishedView:i,displayMode:h},s.id||`product-${p}`))},"product-list"):e.jsxs(c.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12",children:[e.jsx(D,{className:"w-10 h-10 text-slate-500 mx-auto mb-3"}),e.jsx(j,{initialText:v,onSave:s=>m("productGridNoProductsTitle",s),isAdmin:!i&&x==="edit",as:"h3",textClassName:"text-xl font-semibold text-white mb-2 font-mono",inputClassName:"text-xl font-semibold text-white mb-2 font-mono bg-transparent",className:"text-xl font-semibold text-white mb-2 font-mono"}),e.jsx(j,{initialText:S.replace("{searchTerm}",t),onSave:s=>m("productGridNoProductsSubtitle",s),isAdmin:!i&&x==="edit",as:"p",textClassName:"text-slate-400 font-mono text-sm",inputClassName:"text-slate-400 font-mono text-sm bg-transparent",className:"text-slate-400 font-mono text-sm",useTextarea:!0}),e.jsx(b,{variant:"link",onClick:()=>C(""),className:"text-blue-400 hover:text-blue-300 font-mono mt-3 text-sm",children:e.jsx(j,{initialText:a,onSave:s=>m("productGridClearSearchButtonText",s),isAdmin:!i&&x==="edit",as:"span",textClassName:"",inputClassName:"bg-transparent"})})]},"no-products")})]})})},ce={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.07}}};export{ue as default};
