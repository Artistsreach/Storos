function pO(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Sv=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function c0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var gO={exports:{}},u0={},yO={exports:{}},nn={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vg=Symbol.for("react.element"),Wq=Symbol.for("react.portal"),Hq=Symbol.for("react.fragment"),qq=Symbol.for("react.strict_mode"),Kq=Symbol.for("react.profiler"),Yq=Symbol.for("react.provider"),Jq=Symbol.for("react.context"),Xq=Symbol.for("react.forward_ref"),Qq=Symbol.for("react.suspense"),Zq=Symbol.for("react.memo"),eK=Symbol.for("react.lazy"),Vk=Symbol.iterator;function tK(t){return t===null||typeof t!="object"?null:(t=Vk&&t[Vk]||t["@@iterator"],typeof t=="function"?t:null)}var xO={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},vO=Object.assign,wO={};function Tf(t,e,n){this.props=t,this.context=e,this.refs=wO,this.updater=n||xO}Tf.prototype.isReactComponent={};Tf.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Tf.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function bO(){}bO.prototype=Tf.prototype;function E1(t,e,n){this.props=t,this.context=e,this.refs=wO,this.updater=n||xO}var T1=E1.prototype=new bO;T1.constructor=E1;vO(T1,Tf.prototype);T1.isPureReactComponent=!0;var Uk=Array.isArray,_O=Object.prototype.hasOwnProperty,I1={current:null},SO={key:!0,ref:!0,__self:!0,__source:!0};function CO(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)_O.call(e,r)&&!SO.hasOwnProperty(r)&&(s[r]=e[r]);var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){for(var c=Array(l),u=0;u<l;u++)c[u]=arguments[u+2];s.children=c}if(t&&t.defaultProps)for(r in l=t.defaultProps,l)s[r]===void 0&&(s[r]=l[r]);return{$$typeof:vg,type:t,key:i,ref:o,props:s,_owner:I1.current}}function nK(t,e){return{$$typeof:vg,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function N1(t){return typeof t=="object"&&t!==null&&t.$$typeof===vg}function rK(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Bk=/\/+/g;function b_(t,e){return typeof t=="object"&&t!==null&&t.key!=null?rK(""+t.key):e.toString(36)}function kx(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case vg:case Wq:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+b_(o,0):r,Uk(s)?(n="",t!=null&&(n=t.replace(Bk,"$&/")+"/"),kx(s,e,n,"",function(u){return u})):s!=null&&(N1(s)&&(s=nK(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Bk,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Uk(t))for(var l=0;l<t.length;l++){i=t[l];var c=r+b_(i,l);o+=kx(i,e,n,c,s)}else if(c=tK(t),typeof c=="function")for(t=c.call(t),l=0;!(i=t.next()).done;)i=i.value,c=r+b_(i,l++),o+=kx(i,e,n,c,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function by(t,e,n){if(t==null)return t;var r=[],s=0;return kx(t,r,"","",function(i){return e.call(n,i,s++)}),r}function sK(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Zs={current:null},Rx={transition:null},iK={ReactCurrentDispatcher:Zs,ReactCurrentBatchConfig:Rx,ReactCurrentOwner:I1};function EO(){throw Error("act(...) is not supported in production builds of React.")}nn.Children={map:by,forEach:function(t,e,n){by(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return by(t,function(){e++}),e},toArray:function(t){return by(t,function(e){return e})||[]},only:function(t){if(!N1(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};nn.Component=Tf;nn.Fragment=Hq;nn.Profiler=Kq;nn.PureComponent=E1;nn.StrictMode=qq;nn.Suspense=Qq;nn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=iK;nn.act=EO;nn.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=vO({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=I1.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var l=t.type.defaultProps;for(c in e)_O.call(e,c)&&!SO.hasOwnProperty(c)&&(r[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)r.children=n;else if(1<c){l=Array(c);for(var u=0;u<c;u++)l[u]=arguments[u+2];r.children=l}return{$$typeof:vg,type:t.type,key:s,ref:i,props:r,_owner:o}};nn.createContext=function(t){return t={$$typeof:Jq,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:Yq,_context:t},t.Consumer=t};nn.createElement=CO;nn.createFactory=function(t){var e=CO.bind(null,t);return e.type=t,e};nn.createRef=function(){return{current:null}};nn.forwardRef=function(t){return{$$typeof:Xq,render:t}};nn.isValidElement=N1;nn.lazy=function(t){return{$$typeof:eK,_payload:{_status:-1,_result:t},_init:sK}};nn.memo=function(t,e){return{$$typeof:Zq,type:t,compare:e===void 0?null:e}};nn.startTransition=function(t){var e=Rx.transition;Rx.transition={};try{t()}finally{Rx.transition=e}};nn.unstable_act=EO;nn.useCallback=function(t,e){return Zs.current.useCallback(t,e)};nn.useContext=function(t){return Zs.current.useContext(t)};nn.useDebugValue=function(){};nn.useDeferredValue=function(t){return Zs.current.useDeferredValue(t)};nn.useEffect=function(t,e){return Zs.current.useEffect(t,e)};nn.useId=function(){return Zs.current.useId()};nn.useImperativeHandle=function(t,e,n){return Zs.current.useImperativeHandle(t,e,n)};nn.useInsertionEffect=function(t,e){return Zs.current.useInsertionEffect(t,e)};nn.useLayoutEffect=function(t,e){return Zs.current.useLayoutEffect(t,e)};nn.useMemo=function(t,e){return Zs.current.useMemo(t,e)};nn.useReducer=function(t,e,n){return Zs.current.useReducer(t,e,n)};nn.useRef=function(t){return Zs.current.useRef(t)};nn.useState=function(t){return Zs.current.useState(t)};nn.useSyncExternalStore=function(t,e,n){return Zs.current.useSyncExternalStore(t,e,n)};nn.useTransition=function(){return Zs.current.useTransition()};nn.version="18.3.1";yO.exports=nn;var p=yO.exports;const ht=c0(p),d0=pO({__proto__:null,default:ht},[p]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var oK=p,aK=Symbol.for("react.element"),lK=Symbol.for("react.fragment"),cK=Object.prototype.hasOwnProperty,uK=oK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dK={key:!0,ref:!0,__self:!0,__source:!0};function TO(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)cK.call(e,r)&&!dK.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:aK,type:t,key:i,ref:o,props:s,_owner:uK.current}}u0.Fragment=lK;u0.jsx=TO;u0.jsxs=TO;gO.exports=u0;var a=gO.exports,wC={},IO={exports:{}},Zi={},NO={exports:{}},PO={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(W,te){var O=W.length;W.push(te);e:for(;0<O;){var V=O-1>>>1,H=W[V];if(0<s(H,te))W[V]=te,W[O]=H,O=V;else break e}}function n(W){return W.length===0?null:W[0]}function r(W){if(W.length===0)return null;var te=W[0],O=W.pop();if(O!==te){W[0]=O;e:for(var V=0,H=W.length,L=H>>>1;V<L;){var ee=2*(V+1)-1,pe=W[ee],xe=ee+1,we=W[xe];if(0>s(pe,O))xe<H&&0>s(we,pe)?(W[V]=we,W[xe]=O,V=xe):(W[V]=pe,W[ee]=O,V=ee);else if(xe<H&&0>s(we,O))W[V]=we,W[xe]=O,V=xe;else break e}}return te}function s(W,te){var O=W.sortIndex-te.sortIndex;return O!==0?O:W.id-te.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();t.unstable_now=function(){return o.now()-l}}var c=[],u=[],d=1,h=null,f=3,m=!1,g=!1,x=!1,w=typeof setTimeout=="function"?setTimeout:null,v=typeof clearTimeout=="function"?clearTimeout:null,_=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(W){for(var te=n(u);te!==null;){if(te.callback===null)r(u);else if(te.startTime<=W)r(u),te.sortIndex=te.expirationTime,e(c,te);else break;te=n(u)}}function T(W){if(x=!1,C(W),!g)if(n(c)!==null)g=!0,K(R);else{var te=n(u);te!==null&&q(T,te.startTime-W)}}function R(W,te){g=!1,x&&(x=!1,v(I),I=-1),m=!0;var O=f;try{for(C(te),h=n(c);h!==null&&(!(h.expirationTime>te)||W&&!D());){var V=h.callback;if(typeof V=="function"){h.callback=null,f=h.priorityLevel;var H=V(h.expirationTime<=te);te=t.unstable_now(),typeof H=="function"?h.callback=H:h===n(c)&&r(c),C(te)}else r(c);h=n(c)}if(h!==null)var L=!0;else{var ee=n(u);ee!==null&&q(T,ee.startTime-te),L=!1}return L}finally{h=null,f=O,m=!1}}var k=!1,E=null,I=-1,P=5,A=-1;function D(){return!(t.unstable_now()-A<P)}function j(){if(E!==null){var W=t.unstable_now();A=W;var te=!0;try{te=E(!0,W)}finally{te?M():(k=!1,E=null)}}else k=!1}var M;if(typeof _=="function")M=function(){_(j)};else if(typeof MessageChannel<"u"){var z=new MessageChannel,U=z.port2;z.port1.onmessage=j,M=function(){U.postMessage(null)}}else M=function(){w(j,0)};function K(W){E=W,k||(k=!0,M())}function q(W,te){I=w(function(){W(t.unstable_now())},te)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(W){W.callback=null},t.unstable_continueExecution=function(){g||m||(g=!0,K(R))},t.unstable_forceFrameRate=function(W){0>W||125<W?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):P=0<W?Math.floor(1e3/W):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(c)},t.unstable_next=function(W){switch(f){case 1:case 2:case 3:var te=3;break;default:te=f}var O=f;f=te;try{return W()}finally{f=O}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(W,te){switch(W){case 1:case 2:case 3:case 4:case 5:break;default:W=3}var O=f;f=W;try{return te()}finally{f=O}},t.unstable_scheduleCallback=function(W,te,O){var V=t.unstable_now();switch(typeof O=="object"&&O!==null?(O=O.delay,O=typeof O=="number"&&0<O?V+O:V):O=V,W){case 1:var H=-1;break;case 2:H=250;break;case 5:H=1073741823;break;case 4:H=1e4;break;default:H=5e3}return H=O+H,W={id:d++,callback:te,priorityLevel:W,startTime:O,expirationTime:H,sortIndex:-1},O>V?(W.sortIndex=O,e(u,W),n(c)===null&&W===n(u)&&(x?(v(I),I=-1):x=!0,q(T,O-V))):(W.sortIndex=H,e(c,W),g||m||(g=!0,K(R))),W},t.unstable_shouldYield=D,t.unstable_wrapCallback=function(W){var te=f;return function(){var O=f;f=te;try{return W.apply(this,arguments)}finally{f=O}}}})(PO);NO.exports=PO;var hK=NO.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fK=p,Yi=hK;function Je(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var AO=new Set,Cp={};function dd(t,e){Wh(t,e),Wh(t+"Capture",e)}function Wh(t,e){for(Cp[t]=e,t=0;t<e.length;t++)AO.add(e[t])}var rl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),bC=Object.prototype.hasOwnProperty,mK=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zk={},Gk={};function pK(t){return bC.call(Gk,t)?!0:bC.call(zk,t)?!1:mK.test(t)?Gk[t]=!0:(zk[t]=!0,!1)}function gK(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yK(t,e,n,r){if(e===null||typeof e>"u"||gK(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ei(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var vs={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){vs[t]=new ei(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];vs[e]=new ei(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){vs[t]=new ei(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){vs[t]=new ei(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){vs[t]=new ei(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){vs[t]=new ei(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){vs[t]=new ei(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){vs[t]=new ei(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){vs[t]=new ei(t,5,!1,t.toLowerCase(),null,!1,!1)});var P1=/[\-:]([a-z])/g;function A1(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(P1,A1);vs[e]=new ei(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(P1,A1);vs[e]=new ei(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(P1,A1);vs[e]=new ei(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){vs[t]=new ei(t,1,!1,t.toLowerCase(),null,!1,!1)});vs.xlinkHref=new ei("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){vs[t]=new ei(t,1,!1,t.toLowerCase(),null,!0,!0)});function k1(t,e,n,r){var s=vs.hasOwnProperty(e)?vs[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(yK(e,n,s,r)&&(n=null),r||s===null?pK(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var yl=fK.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_y=Symbol.for("react.element"),nh=Symbol.for("react.portal"),rh=Symbol.for("react.fragment"),R1=Symbol.for("react.strict_mode"),_C=Symbol.for("react.profiler"),kO=Symbol.for("react.provider"),RO=Symbol.for("react.context"),j1=Symbol.for("react.forward_ref"),SC=Symbol.for("react.suspense"),CC=Symbol.for("react.suspense_list"),D1=Symbol.for("react.memo"),$l=Symbol.for("react.lazy"),jO=Symbol.for("react.offscreen"),Wk=Symbol.iterator;function Kf(t){return t===null||typeof t!="object"?null:(t=Wk&&t[Wk]||t["@@iterator"],typeof t=="function"?t:null)}var vr=Object.assign,__;function _m(t){if(__===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);__=e&&e[1]||""}return`
`+__+t}var S_=!1;function C_(t,e){if(!t||S_)return"";S_=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(u){var r=u}Reflect.construct(t,[],e)}else{try{e.call()}catch(u){r=u}t.call(e.prototype)}else{try{throw Error()}catch(u){r=u}t()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var s=u.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,l=i.length-1;1<=o&&0<=l&&s[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(s[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||s[o]!==i[l]){var c=`
`+s[o].replace(" at new "," at ");return t.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",t.displayName)),c}while(1<=o&&0<=l);break}}}finally{S_=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?_m(t):""}function xK(t){switch(t.tag){case 5:return _m(t.type);case 16:return _m("Lazy");case 13:return _m("Suspense");case 19:return _m("SuspenseList");case 0:case 2:case 15:return t=C_(t.type,!1),t;case 11:return t=C_(t.type.render,!1),t;case 1:return t=C_(t.type,!0),t;default:return""}}function EC(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case rh:return"Fragment";case nh:return"Portal";case _C:return"Profiler";case R1:return"StrictMode";case SC:return"Suspense";case CC:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case RO:return(t.displayName||"Context")+".Consumer";case kO:return(t._context.displayName||"Context")+".Provider";case j1:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case D1:return e=t.displayName||null,e!==null?e:EC(t.type)||"Memo";case $l:e=t._payload,t=t._init;try{return EC(t(e))}catch{}}return null}function vK(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return EC(e);case 8:return e===R1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function bc(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function DO(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function wK(t){var e=DO(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Sy(t){t._valueTracker||(t._valueTracker=wK(t))}function MO(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=DO(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function Cv(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function TC(t,e){var n=e.checked;return vr({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Hk(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=bc(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function LO(t,e){e=e.checked,e!=null&&k1(t,"checked",e,!1)}function IC(t,e){LO(t,e);var n=bc(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?NC(t,e.type,n):e.hasOwnProperty("defaultValue")&&NC(t,e.type,bc(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function qk(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function NC(t,e,n){(e!=="number"||Cv(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Sm=Array.isArray;function Eh(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+bc(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function PC(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(Je(91));return vr({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Kk(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(Je(92));if(Sm(n)){if(1<n.length)throw Error(Je(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:bc(n)}}function FO(t,e){var n=bc(e.value),r=bc(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Yk(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function OO(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function AC(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?OO(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Cy,$O=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Cy=Cy||document.createElement("div"),Cy.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Cy.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ep(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var zm={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},bK=["Webkit","ms","Moz","O"];Object.keys(zm).forEach(function(t){bK.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),zm[e]=zm[t]})});function VO(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||zm.hasOwnProperty(t)&&zm[t]?(""+e).trim():e+"px"}function UO(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=VO(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var _K=vr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function kC(t,e){if(e){if(_K[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(Je(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(Je(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(Je(61))}if(e.style!=null&&typeof e.style!="object")throw Error(Je(62))}}function RC(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var jC=null;function M1(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var DC=null,Th=null,Ih=null;function Jk(t){if(t=_g(t)){if(typeof DC!="function")throw Error(Je(280));var e=t.stateNode;e&&(e=g0(e),DC(t.stateNode,t.type,e))}}function BO(t){Th?Ih?Ih.push(t):Ih=[t]:Th=t}function zO(){if(Th){var t=Th,e=Ih;if(Ih=Th=null,Jk(t),e)for(t=0;t<e.length;t++)Jk(e[t])}}function GO(t,e){return t(e)}function WO(){}var E_=!1;function HO(t,e,n){if(E_)return t(e,n);E_=!0;try{return GO(t,e,n)}finally{E_=!1,(Th!==null||Ih!==null)&&(WO(),zO())}}function Tp(t,e){var n=t.stateNode;if(n===null)return null;var r=g0(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(Je(231,e,typeof n));return n}var MC=!1;if(rl)try{var Yf={};Object.defineProperty(Yf,"passive",{get:function(){MC=!0}}),window.addEventListener("test",Yf,Yf),window.removeEventListener("test",Yf,Yf)}catch{MC=!1}function SK(t,e,n,r,s,i,o,l,c){var u=Array.prototype.slice.call(arguments,3);try{e.apply(n,u)}catch(d){this.onError(d)}}var Gm=!1,Ev=null,Tv=!1,LC=null,CK={onError:function(t){Gm=!0,Ev=t}};function EK(t,e,n,r,s,i,o,l,c){Gm=!1,Ev=null,SK.apply(CK,arguments)}function TK(t,e,n,r,s,i,o,l,c){if(EK.apply(this,arguments),Gm){if(Gm){var u=Ev;Gm=!1,Ev=null}else throw Error(Je(198));Tv||(Tv=!0,LC=u)}}function hd(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function qO(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Xk(t){if(hd(t)!==t)throw Error(Je(188))}function IK(t){var e=t.alternate;if(!e){if(e=hd(t),e===null)throw Error(Je(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Xk(s),t;if(i===r)return Xk(s),e;i=i.sibling}throw Error(Je(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,l=s.child;l;){if(l===n){o=!0,n=s,r=i;break}if(l===r){o=!0,r=s,n=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===n){o=!0,n=i,r=s;break}if(l===r){o=!0,r=i,n=s;break}l=l.sibling}if(!o)throw Error(Je(189))}}if(n.alternate!==r)throw Error(Je(190))}if(n.tag!==3)throw Error(Je(188));return n.stateNode.current===n?t:e}function KO(t){return t=IK(t),t!==null?YO(t):null}function YO(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=YO(t);if(e!==null)return e;t=t.sibling}return null}var JO=Yi.unstable_scheduleCallback,Qk=Yi.unstable_cancelCallback,NK=Yi.unstable_shouldYield,PK=Yi.unstable_requestPaint,jr=Yi.unstable_now,AK=Yi.unstable_getCurrentPriorityLevel,L1=Yi.unstable_ImmediatePriority,XO=Yi.unstable_UserBlockingPriority,Iv=Yi.unstable_NormalPriority,kK=Yi.unstable_LowPriority,QO=Yi.unstable_IdlePriority,h0=null,pa=null;function RK(t){if(pa&&typeof pa.onCommitFiberRoot=="function")try{pa.onCommitFiberRoot(h0,t,void 0,(t.current.flags&128)===128)}catch{}}var $o=Math.clz32?Math.clz32:MK,jK=Math.log,DK=Math.LN2;function MK(t){return t>>>=0,t===0?32:31-(jK(t)/DK|0)|0}var Ey=64,Ty=4194304;function Cm(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Nv(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var l=o&~s;l!==0?r=Cm(l):(i&=o,i!==0&&(r=Cm(i)))}else o=n&~s,o!==0?r=Cm(o):i!==0&&(r=Cm(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-$o(e),s=1<<n,r|=t[n],e&=~s;return r}function LK(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function FK(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-$o(i),l=1<<o,c=s[o];c===-1?(!(l&n)||l&r)&&(s[o]=LK(l,e)):c<=e&&(t.expiredLanes|=l),i&=~l}}function FC(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function ZO(){var t=Ey;return Ey<<=1,!(Ey&4194240)&&(Ey=64),t}function T_(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function wg(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-$o(e),t[e]=n}function OK(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-$o(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function F1(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-$o(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Dn=0;function e$(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var t$,O1,n$,r$,s$,OC=!1,Iy=[],Zl=null,ec=null,tc=null,Ip=new Map,Np=new Map,Bl=[],$K="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Zk(t,e){switch(t){case"focusin":case"focusout":Zl=null;break;case"dragenter":case"dragleave":ec=null;break;case"mouseover":case"mouseout":tc=null;break;case"pointerover":case"pointerout":Ip.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Np.delete(e.pointerId)}}function Jf(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=_g(e),e!==null&&O1(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function VK(t,e,n,r,s){switch(e){case"focusin":return Zl=Jf(Zl,t,e,n,r,s),!0;case"dragenter":return ec=Jf(ec,t,e,n,r,s),!0;case"mouseover":return tc=Jf(tc,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Ip.set(i,Jf(Ip.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,Np.set(i,Jf(Np.get(i)||null,t,e,n,r,s)),!0}return!1}function i$(t){var e=Cu(t.target);if(e!==null){var n=hd(e);if(n!==null){if(e=n.tag,e===13){if(e=qO(n),e!==null){t.blockedOn=e,s$(t.priority,function(){n$(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function jx(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=$C(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);jC=r,n.target.dispatchEvent(r),jC=null}else return e=_g(n),e!==null&&O1(e),t.blockedOn=n,!1;e.shift()}return!0}function eR(t,e,n){jx(t)&&n.delete(e)}function UK(){OC=!1,Zl!==null&&jx(Zl)&&(Zl=null),ec!==null&&jx(ec)&&(ec=null),tc!==null&&jx(tc)&&(tc=null),Ip.forEach(eR),Np.forEach(eR)}function Xf(t,e){t.blockedOn===e&&(t.blockedOn=null,OC||(OC=!0,Yi.unstable_scheduleCallback(Yi.unstable_NormalPriority,UK)))}function Pp(t){function e(s){return Xf(s,t)}if(0<Iy.length){Xf(Iy[0],t);for(var n=1;n<Iy.length;n++){var r=Iy[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Zl!==null&&Xf(Zl,t),ec!==null&&Xf(ec,t),tc!==null&&Xf(tc,t),Ip.forEach(e),Np.forEach(e),n=0;n<Bl.length;n++)r=Bl[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Bl.length&&(n=Bl[0],n.blockedOn===null);)i$(n),n.blockedOn===null&&Bl.shift()}var Nh=yl.ReactCurrentBatchConfig,Pv=!0;function BK(t,e,n,r){var s=Dn,i=Nh.transition;Nh.transition=null;try{Dn=1,$1(t,e,n,r)}finally{Dn=s,Nh.transition=i}}function zK(t,e,n,r){var s=Dn,i=Nh.transition;Nh.transition=null;try{Dn=4,$1(t,e,n,r)}finally{Dn=s,Nh.transition=i}}function $1(t,e,n,r){if(Pv){var s=$C(t,e,n,r);if(s===null)L_(t,e,r,Av,n),Zk(t,r);else if(VK(s,t,e,n,r))r.stopPropagation();else if(Zk(t,r),e&4&&-1<$K.indexOf(t)){for(;s!==null;){var i=_g(s);if(i!==null&&t$(i),i=$C(t,e,n,r),i===null&&L_(t,e,r,Av,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else L_(t,e,r,null,n)}}var Av=null;function $C(t,e,n,r){if(Av=null,t=M1(r),t=Cu(t),t!==null)if(e=hd(t),e===null)t=null;else if(n=e.tag,n===13){if(t=qO(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Av=t,null}function o$(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(AK()){case L1:return 1;case XO:return 4;case Iv:case kK:return 16;case QO:return 536870912;default:return 16}default:return 16}}var Yl=null,V1=null,Dx=null;function a$(){if(Dx)return Dx;var t,e=V1,n=e.length,r,s="value"in Yl?Yl.value:Yl.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return Dx=s.slice(t,1<r?1-r:void 0)}function Mx(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function Ny(){return!0}function tR(){return!1}function eo(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in t)t.hasOwnProperty(l)&&(n=t[l],this[l]=n?n(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Ny:tR,this.isPropagationStopped=tR,this}return vr(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=Ny)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=Ny)},persist:function(){},isPersistent:Ny}),e}var If={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},U1=eo(If),bg=vr({},If,{view:0,detail:0}),GK=eo(bg),I_,N_,Qf,f0=vr({},bg,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:B1,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Qf&&(Qf&&t.type==="mousemove"?(I_=t.screenX-Qf.screenX,N_=t.screenY-Qf.screenY):N_=I_=0,Qf=t),I_)},movementY:function(t){return"movementY"in t?t.movementY:N_}}),nR=eo(f0),WK=vr({},f0,{dataTransfer:0}),HK=eo(WK),qK=vr({},bg,{relatedTarget:0}),P_=eo(qK),KK=vr({},If,{animationName:0,elapsedTime:0,pseudoElement:0}),YK=eo(KK),JK=vr({},If,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),XK=eo(JK),QK=vr({},If,{data:0}),rR=eo(QK),ZK={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eY={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tY={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function nY(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=tY[t])?!!e[t]:!1}function B1(){return nY}var rY=vr({},bg,{key:function(t){if(t.key){var e=ZK[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Mx(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?eY[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:B1,charCode:function(t){return t.type==="keypress"?Mx(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Mx(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),sY=eo(rY),iY=vr({},f0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),sR=eo(iY),oY=vr({},bg,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:B1}),aY=eo(oY),lY=vr({},If,{propertyName:0,elapsedTime:0,pseudoElement:0}),cY=eo(lY),uY=vr({},f0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),dY=eo(uY),hY=[9,13,27,32],z1=rl&&"CompositionEvent"in window,Wm=null;rl&&"documentMode"in document&&(Wm=document.documentMode);var fY=rl&&"TextEvent"in window&&!Wm,l$=rl&&(!z1||Wm&&8<Wm&&11>=Wm),iR=String.fromCharCode(32),oR=!1;function c$(t,e){switch(t){case"keyup":return hY.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function u$(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var sh=!1;function mY(t,e){switch(t){case"compositionend":return u$(e);case"keypress":return e.which!==32?null:(oR=!0,iR);case"textInput":return t=e.data,t===iR&&oR?null:t;default:return null}}function pY(t,e){if(sh)return t==="compositionend"||!z1&&c$(t,e)?(t=a$(),Dx=V1=Yl=null,sh=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return l$&&e.locale!=="ko"?null:e.data;default:return null}}var gY={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function aR(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!gY[t.type]:e==="textarea"}function d$(t,e,n,r){BO(r),e=kv(e,"onChange"),0<e.length&&(n=new U1("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var Hm=null,Ap=null;function yY(t){_$(t,0)}function m0(t){var e=ah(t);if(MO(e))return t}function xY(t,e){if(t==="change")return e}var h$=!1;if(rl){var A_;if(rl){var k_="oninput"in document;if(!k_){var lR=document.createElement("div");lR.setAttribute("oninput","return;"),k_=typeof lR.oninput=="function"}A_=k_}else A_=!1;h$=A_&&(!document.documentMode||9<document.documentMode)}function cR(){Hm&&(Hm.detachEvent("onpropertychange",f$),Ap=Hm=null)}function f$(t){if(t.propertyName==="value"&&m0(Ap)){var e=[];d$(e,Ap,t,M1(t)),HO(yY,e)}}function vY(t,e,n){t==="focusin"?(cR(),Hm=e,Ap=n,Hm.attachEvent("onpropertychange",f$)):t==="focusout"&&cR()}function wY(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return m0(Ap)}function bY(t,e){if(t==="click")return m0(e)}function _Y(t,e){if(t==="input"||t==="change")return m0(e)}function SY(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var zo=typeof Object.is=="function"?Object.is:SY;function kp(t,e){if(zo(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!bC.call(e,s)||!zo(t[s],e[s]))return!1}return!0}function uR(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function dR(t,e){var n=uR(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=uR(n)}}function m$(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?m$(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function p$(){for(var t=window,e=Cv();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Cv(t.document)}return e}function G1(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function CY(t){var e=p$(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&m$(n.ownerDocument.documentElement,n)){if(r!==null&&G1(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=dR(n,i);var o=dR(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var EY=rl&&"documentMode"in document&&11>=document.documentMode,ih=null,VC=null,qm=null,UC=!1;function hR(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;UC||ih==null||ih!==Cv(r)||(r=ih,"selectionStart"in r&&G1(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),qm&&kp(qm,r)||(qm=r,r=kv(VC,"onSelect"),0<r.length&&(e=new U1("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ih)))}function Py(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var oh={animationend:Py("Animation","AnimationEnd"),animationiteration:Py("Animation","AnimationIteration"),animationstart:Py("Animation","AnimationStart"),transitionend:Py("Transition","TransitionEnd")},R_={},g$={};rl&&(g$=document.createElement("div").style,"AnimationEvent"in window||(delete oh.animationend.animation,delete oh.animationiteration.animation,delete oh.animationstart.animation),"TransitionEvent"in window||delete oh.transitionend.transition);function p0(t){if(R_[t])return R_[t];if(!oh[t])return t;var e=oh[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in g$)return R_[t]=e[n];return t}var y$=p0("animationend"),x$=p0("animationiteration"),v$=p0("animationstart"),w$=p0("transitionend"),b$=new Map,fR="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function jc(t,e){b$.set(t,e),dd(e,[t])}for(var j_=0;j_<fR.length;j_++){var D_=fR[j_],TY=D_.toLowerCase(),IY=D_[0].toUpperCase()+D_.slice(1);jc(TY,"on"+IY)}jc(y$,"onAnimationEnd");jc(x$,"onAnimationIteration");jc(v$,"onAnimationStart");jc("dblclick","onDoubleClick");jc("focusin","onFocus");jc("focusout","onBlur");jc(w$,"onTransitionEnd");Wh("onMouseEnter",["mouseout","mouseover"]);Wh("onMouseLeave",["mouseout","mouseover"]);Wh("onPointerEnter",["pointerout","pointerover"]);Wh("onPointerLeave",["pointerout","pointerover"]);dd("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));dd("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));dd("onBeforeInput",["compositionend","keypress","textInput","paste"]);dd("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));dd("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));dd("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Em="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),NY=new Set("cancel close invalid load scroll toggle".split(" ").concat(Em));function mR(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,TK(r,e,void 0,t),t.currentTarget=null}function _$(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var l=r[o],c=l.instance,u=l.currentTarget;if(l=l.listener,c!==i&&s.isPropagationStopped())break e;mR(s,l,u),i=c}else for(o=0;o<r.length;o++){if(l=r[o],c=l.instance,u=l.currentTarget,l=l.listener,c!==i&&s.isPropagationStopped())break e;mR(s,l,u),i=c}}}if(Tv)throw t=LC,Tv=!1,LC=null,t}function tr(t,e){var n=e[HC];n===void 0&&(n=e[HC]=new Set);var r=t+"__bubble";n.has(r)||(S$(e,t,2,!1),n.add(r))}function M_(t,e,n){var r=0;e&&(r|=4),S$(n,t,r,e)}var Ay="_reactListening"+Math.random().toString(36).slice(2);function Rp(t){if(!t[Ay]){t[Ay]=!0,AO.forEach(function(n){n!=="selectionchange"&&(NY.has(n)||M_(n,!1,t),M_(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Ay]||(e[Ay]=!0,M_("selectionchange",!1,e))}}function S$(t,e,n,r){switch(o$(e)){case 1:var s=BK;break;case 4:s=zK;break;default:s=$1}n=s.bind(null,e,n,t),s=void 0,!MC||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function L_(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var l=r.stateNode.containerInfo;if(l===s||l.nodeType===8&&l.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===s||c.nodeType===8&&c.parentNode===s))return;o=o.return}for(;l!==null;){if(o=Cu(l),o===null)return;if(c=o.tag,c===5||c===6){r=i=o;continue e}l=l.parentNode}}r=r.return}HO(function(){var u=i,d=M1(n),h=[];e:{var f=b$.get(t);if(f!==void 0){var m=U1,g=t;switch(t){case"keypress":if(Mx(n)===0)break e;case"keydown":case"keyup":m=sY;break;case"focusin":g="focus",m=P_;break;case"focusout":g="blur",m=P_;break;case"beforeblur":case"afterblur":m=P_;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=nR;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=HK;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=aY;break;case y$:case x$:case v$:m=YK;break;case w$:m=cY;break;case"scroll":m=GK;break;case"wheel":m=dY;break;case"copy":case"cut":case"paste":m=XK;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=sR}var x=(e&4)!==0,w=!x&&t==="scroll",v=x?f!==null?f+"Capture":null:f;x=[];for(var _=u,C;_!==null;){C=_;var T=C.stateNode;if(C.tag===5&&T!==null&&(C=T,v!==null&&(T=Tp(_,v),T!=null&&x.push(jp(_,T,C)))),w)break;_=_.return}0<x.length&&(f=new m(f,g,null,n,d),h.push({event:f,listeners:x}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",m=t==="mouseout"||t==="pointerout",f&&n!==jC&&(g=n.relatedTarget||n.fromElement)&&(Cu(g)||g[sl]))break e;if((m||f)&&(f=d.window===d?d:(f=d.ownerDocument)?f.defaultView||f.parentWindow:window,m?(g=n.relatedTarget||n.toElement,m=u,g=g?Cu(g):null,g!==null&&(w=hd(g),g!==w||g.tag!==5&&g.tag!==6)&&(g=null)):(m=null,g=u),m!==g)){if(x=nR,T="onMouseLeave",v="onMouseEnter",_="mouse",(t==="pointerout"||t==="pointerover")&&(x=sR,T="onPointerLeave",v="onPointerEnter",_="pointer"),w=m==null?f:ah(m),C=g==null?f:ah(g),f=new x(T,_+"leave",m,n,d),f.target=w,f.relatedTarget=C,T=null,Cu(d)===u&&(x=new x(v,_+"enter",g,n,d),x.target=C,x.relatedTarget=w,T=x),w=T,m&&g)t:{for(x=m,v=g,_=0,C=x;C;C=Pd(C))_++;for(C=0,T=v;T;T=Pd(T))C++;for(;0<_-C;)x=Pd(x),_--;for(;0<C-_;)v=Pd(v),C--;for(;_--;){if(x===v||v!==null&&x===v.alternate)break t;x=Pd(x),v=Pd(v)}x=null}else x=null;m!==null&&pR(h,f,m,x,!1),g!==null&&w!==null&&pR(h,w,g,x,!0)}}e:{if(f=u?ah(u):window,m=f.nodeName&&f.nodeName.toLowerCase(),m==="select"||m==="input"&&f.type==="file")var R=xY;else if(aR(f))if(h$)R=_Y;else{R=wY;var k=vY}else(m=f.nodeName)&&m.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(R=bY);if(R&&(R=R(t,u))){d$(h,R,n,d);break e}k&&k(t,f,u),t==="focusout"&&(k=f._wrapperState)&&k.controlled&&f.type==="number"&&NC(f,"number",f.value)}switch(k=u?ah(u):window,t){case"focusin":(aR(k)||k.contentEditable==="true")&&(ih=k,VC=u,qm=null);break;case"focusout":qm=VC=ih=null;break;case"mousedown":UC=!0;break;case"contextmenu":case"mouseup":case"dragend":UC=!1,hR(h,n,d);break;case"selectionchange":if(EY)break;case"keydown":case"keyup":hR(h,n,d)}var E;if(z1)e:{switch(t){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else sh?c$(t,n)&&(I="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(I="onCompositionStart");I&&(l$&&n.locale!=="ko"&&(sh||I!=="onCompositionStart"?I==="onCompositionEnd"&&sh&&(E=a$()):(Yl=d,V1="value"in Yl?Yl.value:Yl.textContent,sh=!0)),k=kv(u,I),0<k.length&&(I=new rR(I,t,null,n,d),h.push({event:I,listeners:k}),E?I.data=E:(E=u$(n),E!==null&&(I.data=E)))),(E=fY?mY(t,n):pY(t,n))&&(u=kv(u,"onBeforeInput"),0<u.length&&(d=new rR("onBeforeInput","beforeinput",null,n,d),h.push({event:d,listeners:u}),d.data=E))}_$(h,e)})}function jp(t,e,n){return{instance:t,listener:e,currentTarget:n}}function kv(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Tp(t,n),i!=null&&r.unshift(jp(t,i,s)),i=Tp(t,e),i!=null&&r.push(jp(t,i,s))),t=t.return}return r}function Pd(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function pR(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var l=n,c=l.alternate,u=l.stateNode;if(c!==null&&c===r)break;l.tag===5&&u!==null&&(l=u,s?(c=Tp(n,i),c!=null&&o.unshift(jp(n,c,l))):s||(c=Tp(n,i),c!=null&&o.push(jp(n,c,l)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var PY=/\r\n?/g,AY=/\u0000|\uFFFD/g;function gR(t){return(typeof t=="string"?t:""+t).replace(PY,`
`).replace(AY,"")}function ky(t,e,n){if(e=gR(e),gR(t)!==e&&n)throw Error(Je(425))}function Rv(){}var BC=null,zC=null;function GC(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var WC=typeof setTimeout=="function"?setTimeout:void 0,kY=typeof clearTimeout=="function"?clearTimeout:void 0,yR=typeof Promise=="function"?Promise:void 0,RY=typeof queueMicrotask=="function"?queueMicrotask:typeof yR<"u"?function(t){return yR.resolve(null).then(t).catch(jY)}:WC;function jY(t){setTimeout(function(){throw t})}function F_(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Pp(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Pp(e)}function nc(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function xR(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Nf=Math.random().toString(36).slice(2),aa="__reactFiber$"+Nf,Dp="__reactProps$"+Nf,sl="__reactContainer$"+Nf,HC="__reactEvents$"+Nf,DY="__reactListeners$"+Nf,MY="__reactHandles$"+Nf;function Cu(t){var e=t[aa];if(e)return e;for(var n=t.parentNode;n;){if(e=n[sl]||n[aa]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=xR(t);t!==null;){if(n=t[aa])return n;t=xR(t)}return e}t=n,n=t.parentNode}return null}function _g(t){return t=t[aa]||t[sl],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ah(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Je(33))}function g0(t){return t[Dp]||null}var qC=[],lh=-1;function Dc(t){return{current:t}}function rr(t){0>lh||(t.current=qC[lh],qC[lh]=null,lh--)}function Kn(t,e){lh++,qC[lh]=t.current,t.current=e}var _c={},Os=Dc(_c),mi=Dc(!1),zu=_c;function Hh(t,e){var n=t.type.contextTypes;if(!n)return _c;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function pi(t){return t=t.childContextTypes,t!=null}function jv(){rr(mi),rr(Os)}function vR(t,e,n){if(Os.current!==_c)throw Error(Je(168));Kn(Os,e),Kn(mi,n)}function C$(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(Je(108,vK(t)||"Unknown",s));return vr({},n,r)}function Dv(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||_c,zu=Os.current,Kn(Os,t),Kn(mi,mi.current),!0}function wR(t,e,n){var r=t.stateNode;if(!r)throw Error(Je(169));n?(t=C$(t,e,zu),r.__reactInternalMemoizedMergedChildContext=t,rr(mi),rr(Os),Kn(Os,t)):rr(mi),Kn(mi,n)}var Oa=null,y0=!1,O_=!1;function E$(t){Oa===null?Oa=[t]:Oa.push(t)}function LY(t){y0=!0,E$(t)}function Mc(){if(!O_&&Oa!==null){O_=!0;var t=0,e=Dn;try{var n=Oa;for(Dn=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Oa=null,y0=!1}catch(s){throw Oa!==null&&(Oa=Oa.slice(t+1)),JO(L1,Mc),s}finally{Dn=e,O_=!1}}return null}var ch=[],uh=0,Mv=null,Lv=0,io=[],oo=0,Gu=null,Ba=1,za="";function lu(t,e){ch[uh++]=Lv,ch[uh++]=Mv,Mv=t,Lv=e}function T$(t,e,n){io[oo++]=Ba,io[oo++]=za,io[oo++]=Gu,Gu=t;var r=Ba;t=za;var s=32-$o(r)-1;r&=~(1<<s),n+=1;var i=32-$o(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Ba=1<<32-$o(e)+s|n<<s|r,za=i+t}else Ba=1<<i|n<<s|r,za=t}function W1(t){t.return!==null&&(lu(t,1),T$(t,1,0))}function H1(t){for(;t===Mv;)Mv=ch[--uh],ch[uh]=null,Lv=ch[--uh],ch[uh]=null;for(;t===Gu;)Gu=io[--oo],io[oo]=null,za=io[--oo],io[oo]=null,Ba=io[--oo],io[oo]=null}var qi=null,Bi=null,lr=!1,jo=null;function I$(t,e){var n=co(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function bR(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,qi=t,Bi=nc(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,qi=t,Bi=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Gu!==null?{id:Ba,overflow:za}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=co(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,qi=t,Bi=null,!0):!1;default:return!1}}function KC(t){return(t.mode&1)!==0&&(t.flags&128)===0}function YC(t){if(lr){var e=Bi;if(e){var n=e;if(!bR(t,e)){if(KC(t))throw Error(Je(418));e=nc(n.nextSibling);var r=qi;e&&bR(t,e)?I$(r,n):(t.flags=t.flags&-4097|2,lr=!1,qi=t)}}else{if(KC(t))throw Error(Je(418));t.flags=t.flags&-4097|2,lr=!1,qi=t}}}function _R(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;qi=t}function Ry(t){if(t!==qi)return!1;if(!lr)return _R(t),lr=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!GC(t.type,t.memoizedProps)),e&&(e=Bi)){if(KC(t))throw N$(),Error(Je(418));for(;e;)I$(t,e),e=nc(e.nextSibling)}if(_R(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Je(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Bi=nc(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Bi=null}}else Bi=qi?nc(t.stateNode.nextSibling):null;return!0}function N$(){for(var t=Bi;t;)t=nc(t.nextSibling)}function qh(){Bi=qi=null,lr=!1}function q1(t){jo===null?jo=[t]:jo.push(t)}var FY=yl.ReactCurrentBatchConfig;function Zf(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(Je(309));var r=n.stateNode}if(!r)throw Error(Je(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=s.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(Je(284));if(!n._owner)throw Error(Je(290,t))}return t}function jy(t,e){throw t=Object.prototype.toString.call(e),Error(Je(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function SR(t){var e=t._init;return e(t._payload)}function P$(t){function e(v,_){if(t){var C=v.deletions;C===null?(v.deletions=[_],v.flags|=16):C.push(_)}}function n(v,_){if(!t)return null;for(;_!==null;)e(v,_),_=_.sibling;return null}function r(v,_){for(v=new Map;_!==null;)_.key!==null?v.set(_.key,_):v.set(_.index,_),_=_.sibling;return v}function s(v,_){return v=oc(v,_),v.index=0,v.sibling=null,v}function i(v,_,C){return v.index=C,t?(C=v.alternate,C!==null?(C=C.index,C<_?(v.flags|=2,_):C):(v.flags|=2,_)):(v.flags|=1048576,_)}function o(v){return t&&v.alternate===null&&(v.flags|=2),v}function l(v,_,C,T){return _===null||_.tag!==6?(_=W_(C,v.mode,T),_.return=v,_):(_=s(_,C),_.return=v,_)}function c(v,_,C,T){var R=C.type;return R===rh?d(v,_,C.props.children,T,C.key):_!==null&&(_.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===$l&&SR(R)===_.type)?(T=s(_,C.props),T.ref=Zf(v,_,C),T.return=v,T):(T=Bx(C.type,C.key,C.props,null,v.mode,T),T.ref=Zf(v,_,C),T.return=v,T)}function u(v,_,C,T){return _===null||_.tag!==4||_.stateNode.containerInfo!==C.containerInfo||_.stateNode.implementation!==C.implementation?(_=H_(C,v.mode,T),_.return=v,_):(_=s(_,C.children||[]),_.return=v,_)}function d(v,_,C,T,R){return _===null||_.tag!==7?(_=Lu(C,v.mode,T,R),_.return=v,_):(_=s(_,C),_.return=v,_)}function h(v,_,C){if(typeof _=="string"&&_!==""||typeof _=="number")return _=W_(""+_,v.mode,C),_.return=v,_;if(typeof _=="object"&&_!==null){switch(_.$$typeof){case _y:return C=Bx(_.type,_.key,_.props,null,v.mode,C),C.ref=Zf(v,null,_),C.return=v,C;case nh:return _=H_(_,v.mode,C),_.return=v,_;case $l:var T=_._init;return h(v,T(_._payload),C)}if(Sm(_)||Kf(_))return _=Lu(_,v.mode,C,null),_.return=v,_;jy(v,_)}return null}function f(v,_,C,T){var R=_!==null?_.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return R!==null?null:l(v,_,""+C,T);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case _y:return C.key===R?c(v,_,C,T):null;case nh:return C.key===R?u(v,_,C,T):null;case $l:return R=C._init,f(v,_,R(C._payload),T)}if(Sm(C)||Kf(C))return R!==null?null:d(v,_,C,T,null);jy(v,C)}return null}function m(v,_,C,T,R){if(typeof T=="string"&&T!==""||typeof T=="number")return v=v.get(C)||null,l(_,v,""+T,R);if(typeof T=="object"&&T!==null){switch(T.$$typeof){case _y:return v=v.get(T.key===null?C:T.key)||null,c(_,v,T,R);case nh:return v=v.get(T.key===null?C:T.key)||null,u(_,v,T,R);case $l:var k=T._init;return m(v,_,C,k(T._payload),R)}if(Sm(T)||Kf(T))return v=v.get(C)||null,d(_,v,T,R,null);jy(_,T)}return null}function g(v,_,C,T){for(var R=null,k=null,E=_,I=_=0,P=null;E!==null&&I<C.length;I++){E.index>I?(P=E,E=null):P=E.sibling;var A=f(v,E,C[I],T);if(A===null){E===null&&(E=P);break}t&&E&&A.alternate===null&&e(v,E),_=i(A,_,I),k===null?R=A:k.sibling=A,k=A,E=P}if(I===C.length)return n(v,E),lr&&lu(v,I),R;if(E===null){for(;I<C.length;I++)E=h(v,C[I],T),E!==null&&(_=i(E,_,I),k===null?R=E:k.sibling=E,k=E);return lr&&lu(v,I),R}for(E=r(v,E);I<C.length;I++)P=m(E,v,I,C[I],T),P!==null&&(t&&P.alternate!==null&&E.delete(P.key===null?I:P.key),_=i(P,_,I),k===null?R=P:k.sibling=P,k=P);return t&&E.forEach(function(D){return e(v,D)}),lr&&lu(v,I),R}function x(v,_,C,T){var R=Kf(C);if(typeof R!="function")throw Error(Je(150));if(C=R.call(C),C==null)throw Error(Je(151));for(var k=R=null,E=_,I=_=0,P=null,A=C.next();E!==null&&!A.done;I++,A=C.next()){E.index>I?(P=E,E=null):P=E.sibling;var D=f(v,E,A.value,T);if(D===null){E===null&&(E=P);break}t&&E&&D.alternate===null&&e(v,E),_=i(D,_,I),k===null?R=D:k.sibling=D,k=D,E=P}if(A.done)return n(v,E),lr&&lu(v,I),R;if(E===null){for(;!A.done;I++,A=C.next())A=h(v,A.value,T),A!==null&&(_=i(A,_,I),k===null?R=A:k.sibling=A,k=A);return lr&&lu(v,I),R}for(E=r(v,E);!A.done;I++,A=C.next())A=m(E,v,I,A.value,T),A!==null&&(t&&A.alternate!==null&&E.delete(A.key===null?I:A.key),_=i(A,_,I),k===null?R=A:k.sibling=A,k=A);return t&&E.forEach(function(j){return e(v,j)}),lr&&lu(v,I),R}function w(v,_,C,T){if(typeof C=="object"&&C!==null&&C.type===rh&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case _y:e:{for(var R=C.key,k=_;k!==null;){if(k.key===R){if(R=C.type,R===rh){if(k.tag===7){n(v,k.sibling),_=s(k,C.props.children),_.return=v,v=_;break e}}else if(k.elementType===R||typeof R=="object"&&R!==null&&R.$$typeof===$l&&SR(R)===k.type){n(v,k.sibling),_=s(k,C.props),_.ref=Zf(v,k,C),_.return=v,v=_;break e}n(v,k);break}else e(v,k);k=k.sibling}C.type===rh?(_=Lu(C.props.children,v.mode,T,C.key),_.return=v,v=_):(T=Bx(C.type,C.key,C.props,null,v.mode,T),T.ref=Zf(v,_,C),T.return=v,v=T)}return o(v);case nh:e:{for(k=C.key;_!==null;){if(_.key===k)if(_.tag===4&&_.stateNode.containerInfo===C.containerInfo&&_.stateNode.implementation===C.implementation){n(v,_.sibling),_=s(_,C.children||[]),_.return=v,v=_;break e}else{n(v,_);break}else e(v,_);_=_.sibling}_=H_(C,v.mode,T),_.return=v,v=_}return o(v);case $l:return k=C._init,w(v,_,k(C._payload),T)}if(Sm(C))return g(v,_,C,T);if(Kf(C))return x(v,_,C,T);jy(v,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,_!==null&&_.tag===6?(n(v,_.sibling),_=s(_,C),_.return=v,v=_):(n(v,_),_=W_(C,v.mode,T),_.return=v,v=_),o(v)):n(v,_)}return w}var Kh=P$(!0),A$=P$(!1),Fv=Dc(null),Ov=null,dh=null,K1=null;function Y1(){K1=dh=Ov=null}function J1(t){var e=Fv.current;rr(Fv),t._currentValue=e}function JC(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function Ph(t,e){Ov=t,K1=dh=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(ui=!0),t.firstContext=null)}function yo(t){var e=t._currentValue;if(K1!==t)if(t={context:t,memoizedValue:e,next:null},dh===null){if(Ov===null)throw Error(Je(308));dh=t,Ov.dependencies={lanes:0,firstContext:t}}else dh=dh.next=t;return e}var Eu=null;function X1(t){Eu===null?Eu=[t]:Eu.push(t)}function k$(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,X1(e)):(n.next=s.next,s.next=n),e.interleaved=n,il(t,r)}function il(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Vl=!1;function Q1(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function R$(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Ka(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function rc(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,fn&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,il(t,n)}return s=r.interleaved,s===null?(e.next=e,X1(r)):(e.next=s.next,s.next=e),r.interleaved=e,il(t,n)}function Lx(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,F1(t,n)}}function CR(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function $v(t,e,n,r){var s=t.updateQueue;Vl=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,l=s.shared.pending;if(l!==null){s.shared.pending=null;var c=l,u=c.next;c.next=null,o===null?i=u:o.next=u,o=c;var d=t.alternate;d!==null&&(d=d.updateQueue,l=d.lastBaseUpdate,l!==o&&(l===null?d.firstBaseUpdate=u:l.next=u,d.lastBaseUpdate=c))}if(i!==null){var h=s.baseState;o=0,d=u=c=null,l=i;do{var f=l.lane,m=l.eventTime;if((r&f)===f){d!==null&&(d=d.next={eventTime:m,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var g=t,x=l;switch(f=e,m=n,x.tag){case 1:if(g=x.payload,typeof g=="function"){h=g.call(m,h,f);break e}h=g;break e;case 3:g.flags=g.flags&-65537|128;case 0:if(g=x.payload,f=typeof g=="function"?g.call(m,h,f):g,f==null)break e;h=vr({},h,f);break e;case 2:Vl=!0}}l.callback!==null&&l.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[l]:f.push(l))}else m={eventTime:m,lane:f,tag:l.tag,payload:l.payload,callback:l.callback,next:null},d===null?(u=d=m,c=h):d=d.next=m,o|=f;if(l=l.next,l===null){if(l=s.shared.pending,l===null)break;f=l,l=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(1);if(d===null&&(c=h),s.baseState=c,s.firstBaseUpdate=u,s.lastBaseUpdate=d,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);Hu|=o,t.lanes=o,t.memoizedState=h}}function ER(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(Je(191,s));s.call(r)}}}var Sg={},ga=Dc(Sg),Mp=Dc(Sg),Lp=Dc(Sg);function Tu(t){if(t===Sg)throw Error(Je(174));return t}function Z1(t,e){switch(Kn(Lp,e),Kn(Mp,t),Kn(ga,Sg),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:AC(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=AC(e,t)}rr(ga),Kn(ga,e)}function Yh(){rr(ga),rr(Mp),rr(Lp)}function j$(t){Tu(Lp.current);var e=Tu(ga.current),n=AC(e,t.type);e!==n&&(Kn(Mp,t),Kn(ga,n))}function eI(t){Mp.current===t&&(rr(ga),rr(Mp))}var mr=Dc(0);function Vv(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var $_=[];function tI(){for(var t=0;t<$_.length;t++)$_[t]._workInProgressVersionPrimary=null;$_.length=0}var Fx=yl.ReactCurrentDispatcher,V_=yl.ReactCurrentBatchConfig,Wu=0,yr=null,Yr=null,is=null,Uv=!1,Km=!1,Fp=0,OY=0;function Is(){throw Error(Je(321))}function nI(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!zo(t[n],e[n]))return!1;return!0}function rI(t,e,n,r,s,i){if(Wu=i,yr=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Fx.current=t===null||t.memoizedState===null?BY:zY,t=n(r,s),Km){i=0;do{if(Km=!1,Fp=0,25<=i)throw Error(Je(301));i+=1,is=Yr=null,e.updateQueue=null,Fx.current=GY,t=n(r,s)}while(Km)}if(Fx.current=Bv,e=Yr!==null&&Yr.next!==null,Wu=0,is=Yr=yr=null,Uv=!1,e)throw Error(Je(300));return t}function sI(){var t=Fp!==0;return Fp=0,t}function na(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return is===null?yr.memoizedState=is=t:is=is.next=t,is}function xo(){if(Yr===null){var t=yr.alternate;t=t!==null?t.memoizedState:null}else t=Yr.next;var e=is===null?yr.memoizedState:is.next;if(e!==null)is=e,Yr=t;else{if(t===null)throw Error(Je(310));Yr=t,t={memoizedState:Yr.memoizedState,baseState:Yr.baseState,baseQueue:Yr.baseQueue,queue:Yr.queue,next:null},is===null?yr.memoizedState=is=t:is=is.next=t}return is}function Op(t,e){return typeof e=="function"?e(t):e}function U_(t){var e=xo(),n=e.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var r=Yr,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var l=o=null,c=null,u=i;do{var d=u.lane;if((Wu&d)===d)c!==null&&(c=c.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:t(r,u.action);else{var h={lane:d,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};c===null?(l=c=h,o=r):c=c.next=h,yr.lanes|=d,Hu|=d}u=u.next}while(u!==null&&u!==i);c===null?o=r:c.next=l,zo(r,e.memoizedState)||(ui=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=c,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,yr.lanes|=i,Hu|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function B_(t){var e=xo(),n=e.queue;if(n===null)throw Error(Je(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);zo(i,e.memoizedState)||(ui=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function D$(){}function M$(t,e){var n=yr,r=xo(),s=e(),i=!zo(r.memoizedState,s);if(i&&(r.memoizedState=s,ui=!0),r=r.queue,iI(O$.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||is!==null&&is.memoizedState.tag&1){if(n.flags|=2048,$p(9,F$.bind(null,n,r,s,e),void 0,null),as===null)throw Error(Je(349));Wu&30||L$(n,e,s)}return s}function L$(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=yr.updateQueue,e===null?(e={lastEffect:null,stores:null},yr.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function F$(t,e,n,r){e.value=n,e.getSnapshot=r,$$(e)&&V$(t)}function O$(t,e,n){return n(function(){$$(e)&&V$(t)})}function $$(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!zo(t,n)}catch{return!0}}function V$(t){var e=il(t,1);e!==null&&Vo(e,t,1,-1)}function TR(t){var e=na();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Op,lastRenderedState:t},e.queue=t,t=t.dispatch=UY.bind(null,yr,t),[e.memoizedState,t]}function $p(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=yr.updateQueue,e===null?(e={lastEffect:null,stores:null},yr.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function U$(){return xo().memoizedState}function Ox(t,e,n,r){var s=na();yr.flags|=t,s.memoizedState=$p(1|e,n,void 0,r===void 0?null:r)}function x0(t,e,n,r){var s=xo();r=r===void 0?null:r;var i=void 0;if(Yr!==null){var o=Yr.memoizedState;if(i=o.destroy,r!==null&&nI(r,o.deps)){s.memoizedState=$p(e,n,i,r);return}}yr.flags|=t,s.memoizedState=$p(1|e,n,i,r)}function IR(t,e){return Ox(8390656,8,t,e)}function iI(t,e){return x0(2048,8,t,e)}function B$(t,e){return x0(4,2,t,e)}function z$(t,e){return x0(4,4,t,e)}function G$(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function W$(t,e,n){return n=n!=null?n.concat([t]):null,x0(4,4,G$.bind(null,e,t),n)}function oI(){}function H$(t,e){var n=xo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&nI(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function q$(t,e){var n=xo();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&nI(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function K$(t,e,n){return Wu&21?(zo(n,e)||(n=ZO(),yr.lanes|=n,Hu|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,ui=!0),t.memoizedState=n)}function $Y(t,e){var n=Dn;Dn=n!==0&&4>n?n:4,t(!0);var r=V_.transition;V_.transition={};try{t(!1),e()}finally{Dn=n,V_.transition=r}}function Y$(){return xo().memoizedState}function VY(t,e,n){var r=ic(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},J$(t))X$(e,n);else if(n=k$(t,e,n,r),n!==null){var s=Xs();Vo(n,t,r,s),Q$(n,e,r)}}function UY(t,e,n){var r=ic(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(J$(t))X$(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,n);if(s.hasEagerState=!0,s.eagerState=l,zo(l,o)){var c=e.interleaved;c===null?(s.next=s,X1(e)):(s.next=c.next,c.next=s),e.interleaved=s;return}}catch{}finally{}n=k$(t,e,s,r),n!==null&&(s=Xs(),Vo(n,t,r,s),Q$(n,e,r))}}function J$(t){var e=t.alternate;return t===yr||e!==null&&e===yr}function X$(t,e){Km=Uv=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function Q$(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,F1(t,n)}}var Bv={readContext:yo,useCallback:Is,useContext:Is,useEffect:Is,useImperativeHandle:Is,useInsertionEffect:Is,useLayoutEffect:Is,useMemo:Is,useReducer:Is,useRef:Is,useState:Is,useDebugValue:Is,useDeferredValue:Is,useTransition:Is,useMutableSource:Is,useSyncExternalStore:Is,useId:Is,unstable_isNewReconciler:!1},BY={readContext:yo,useCallback:function(t,e){return na().memoizedState=[t,e===void 0?null:e],t},useContext:yo,useEffect:IR,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Ox(4194308,4,G$.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Ox(4194308,4,t,e)},useInsertionEffect:function(t,e){return Ox(4,2,t,e)},useMemo:function(t,e){var n=na();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=na();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=VY.bind(null,yr,t),[r.memoizedState,t]},useRef:function(t){var e=na();return t={current:t},e.memoizedState=t},useState:TR,useDebugValue:oI,useDeferredValue:function(t){return na().memoizedState=t},useTransition:function(){var t=TR(!1),e=t[0];return t=$Y.bind(null,t[1]),na().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=yr,s=na();if(lr){if(n===void 0)throw Error(Je(407));n=n()}else{if(n=e(),as===null)throw Error(Je(349));Wu&30||L$(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,IR(O$.bind(null,r,i,t),[t]),r.flags|=2048,$p(9,F$.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=na(),e=as.identifierPrefix;if(lr){var n=za,r=Ba;n=(r&~(1<<32-$o(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Fp++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=OY++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},zY={readContext:yo,useCallback:H$,useContext:yo,useEffect:iI,useImperativeHandle:W$,useInsertionEffect:B$,useLayoutEffect:z$,useMemo:q$,useReducer:U_,useRef:U$,useState:function(){return U_(Op)},useDebugValue:oI,useDeferredValue:function(t){var e=xo();return K$(e,Yr.memoizedState,t)},useTransition:function(){var t=U_(Op)[0],e=xo().memoizedState;return[t,e]},useMutableSource:D$,useSyncExternalStore:M$,useId:Y$,unstable_isNewReconciler:!1},GY={readContext:yo,useCallback:H$,useContext:yo,useEffect:iI,useImperativeHandle:W$,useInsertionEffect:B$,useLayoutEffect:z$,useMemo:q$,useReducer:B_,useRef:U$,useState:function(){return B_(Op)},useDebugValue:oI,useDeferredValue:function(t){var e=xo();return Yr===null?e.memoizedState=t:K$(e,Yr.memoizedState,t)},useTransition:function(){var t=B_(Op)[0],e=xo().memoizedState;return[t,e]},useMutableSource:D$,useSyncExternalStore:M$,useId:Y$,unstable_isNewReconciler:!1};function No(t,e){if(t&&t.defaultProps){e=vr({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function XC(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:vr({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var v0={isMounted:function(t){return(t=t._reactInternals)?hd(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Xs(),s=ic(t),i=Ka(r,s);i.payload=e,n!=null&&(i.callback=n),e=rc(t,i,s),e!==null&&(Vo(e,t,s,r),Lx(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Xs(),s=ic(t),i=Ka(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=rc(t,i,s),e!==null&&(Vo(e,t,s,r),Lx(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Xs(),r=ic(t),s=Ka(n,r);s.tag=2,e!=null&&(s.callback=e),e=rc(t,s,r),e!==null&&(Vo(e,t,r,n),Lx(e,t,r))}};function NR(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!kp(n,r)||!kp(s,i):!0}function Z$(t,e,n){var r=!1,s=_c,i=e.contextType;return typeof i=="object"&&i!==null?i=yo(i):(s=pi(e)?zu:Os.current,r=e.contextTypes,i=(r=r!=null)?Hh(t,s):_c),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=v0,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function PR(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&v0.enqueueReplaceState(e,e.state,null)}function QC(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},Q1(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=yo(i):(i=pi(e)?zu:Os.current,s.context=Hh(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(XC(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&v0.enqueueReplaceState(s,s.state,null),$v(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Jh(t,e){try{var n="",r=e;do n+=xK(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function z_(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function ZC(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var WY=typeof WeakMap=="function"?WeakMap:Map;function eV(t,e,n){n=Ka(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Gv||(Gv=!0,cE=r),ZC(t,e)},n}function tV(t,e,n){n=Ka(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){ZC(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){ZC(t,e),typeof r!="function"&&(sc===null?sc=new Set([this]):sc.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function AR(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new WY;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=iJ.bind(null,t,e,n),e.then(t,t))}function kR(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function RR(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Ka(-1,1),e.tag=2,rc(n,e,1))),n.lanes|=1),t)}var HY=yl.ReactCurrentOwner,ui=!1;function qs(t,e,n,r){e.child=t===null?A$(e,null,n,r):Kh(e,t.child,n,r)}function jR(t,e,n,r,s){n=n.render;var i=e.ref;return Ph(e,s),r=rI(t,e,n,r,i,s),n=sI(),t!==null&&!ui?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ol(t,e,s)):(lr&&n&&W1(e),e.flags|=1,qs(t,e,r,s),e.child)}function DR(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!mI(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,nV(t,e,i,r,s)):(t=Bx(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:kp,n(o,r)&&t.ref===e.ref)return ol(t,e,s)}return e.flags|=1,t=oc(i,r),t.ref=e.ref,t.return=e,e.child=t}function nV(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(kp(i,r)&&t.ref===e.ref)if(ui=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(ui=!0);else return e.lanes=t.lanes,ol(t,e,s)}return eE(t,e,n,r,s)}function rV(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Kn(fh,Li),Li|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Kn(fh,Li),Li|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,Kn(fh,Li),Li|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Kn(fh,Li),Li|=r;return qs(t,e,s,n),e.child}function sV(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function eE(t,e,n,r,s){var i=pi(n)?zu:Os.current;return i=Hh(e,i),Ph(e,s),n=rI(t,e,n,r,i,s),r=sI(),t!==null&&!ui?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ol(t,e,s)):(lr&&r&&W1(e),e.flags|=1,qs(t,e,n,s),e.child)}function MR(t,e,n,r,s){if(pi(n)){var i=!0;Dv(e)}else i=!1;if(Ph(e,s),e.stateNode===null)$x(t,e),Z$(e,n,r),QC(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,u=n.contextType;typeof u=="object"&&u!==null?u=yo(u):(u=pi(n)?zu:Os.current,u=Hh(e,u));var d=n.getDerivedStateFromProps,h=typeof d=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==r||c!==u)&&PR(e,o,r,u),Vl=!1;var f=e.memoizedState;o.state=f,$v(e,r,o,s),c=e.memoizedState,l!==r||f!==c||mi.current||Vl?(typeof d=="function"&&(XC(e,n,d,r),c=e.memoizedState),(l=Vl||NR(e,n,l,r,f,c,u))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=c),o.props=r,o.state=c,o.context=u,r=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,R$(t,e),l=e.memoizedProps,u=e.type===e.elementType?l:No(e.type,l),o.props=u,h=e.pendingProps,f=o.context,c=n.contextType,typeof c=="object"&&c!==null?c=yo(c):(c=pi(n)?zu:Os.current,c=Hh(e,c));var m=n.getDerivedStateFromProps;(d=typeof m=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==h||f!==c)&&PR(e,o,r,c),Vl=!1,f=e.memoizedState,o.state=f,$v(e,r,o,s);var g=e.memoizedState;l!==h||f!==g||mi.current||Vl?(typeof m=="function"&&(XC(e,n,m,r),g=e.memoizedState),(u=Vl||NR(e,n,u,r,f,g,c)||!1)?(d||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,g,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,g,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=g),o.props=r,o.state=g,o.context=c,r=u):(typeof o.componentDidUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return tE(t,e,n,r,i,s)}function tE(t,e,n,r,s,i){sV(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&wR(e,n,!1),ol(t,e,i);r=e.stateNode,HY.current=e;var l=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Kh(e,t.child,null,i),e.child=Kh(e,null,l,i)):qs(t,e,l,i),e.memoizedState=r.state,s&&wR(e,n,!0),e.child}function iV(t){var e=t.stateNode;e.pendingContext?vR(t,e.pendingContext,e.pendingContext!==e.context):e.context&&vR(t,e.context,!1),Z1(t,e.containerInfo)}function LR(t,e,n,r,s){return qh(),q1(s),e.flags|=256,qs(t,e,n,r),e.child}var nE={dehydrated:null,treeContext:null,retryLane:0};function rE(t){return{baseLanes:t,cachePool:null,transitions:null}}function oV(t,e,n){var r=e.pendingProps,s=mr.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=t!==null&&t.memoizedState===null?!1:(s&2)!==0),l?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Kn(mr,s&1),t===null)return YC(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=_0(o,r,0,null),t=Lu(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=rE(n),e.memoizedState=nE,t):aI(e,o));if(s=t.memoizedState,s!==null&&(l=s.dehydrated,l!==null))return qY(t,e,o,r,l,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,l=s.sibling;var c={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=c,e.deletions=null):(r=oc(s,c),r.subtreeFlags=s.subtreeFlags&14680064),l!==null?i=oc(l,i):(i=Lu(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?rE(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=nE,r}return i=t.child,t=i.sibling,r=oc(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function aI(t,e){return e=_0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Dy(t,e,n,r){return r!==null&&q1(r),Kh(e,t.child,null,n),t=aI(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function qY(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=z_(Error(Je(422))),Dy(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=_0({mode:"visible",children:r.children},s,0,null),i=Lu(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Kh(e,t.child,null,o),e.child.memoizedState=rE(o),e.memoizedState=nE,i);if(!(e.mode&1))return Dy(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var l=r.dgst;return r=l,i=Error(Je(419)),r=z_(i,r,void 0),Dy(t,e,o,r)}if(l=(o&t.childLanes)!==0,ui||l){if(r=as,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,il(t,s),Vo(r,t,s,-1))}return fI(),r=z_(Error(Je(421))),Dy(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=oJ.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,Bi=nc(s.nextSibling),qi=e,lr=!0,jo=null,t!==null&&(io[oo++]=Ba,io[oo++]=za,io[oo++]=Gu,Ba=t.id,za=t.overflow,Gu=e),e=aI(e,r.children),e.flags|=4096,e)}function FR(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),JC(t.return,e,n)}function G_(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function aV(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(qs(t,e,r.children,n),r=mr.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&FR(t,n,e);else if(t.tag===19)FR(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Kn(mr,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Vv(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),G_(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Vv(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}G_(e,!0,n,null,i);break;case"together":G_(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function $x(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ol(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Hu|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(Je(153));if(e.child!==null){for(t=e.child,n=oc(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=oc(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function KY(t,e,n){switch(e.tag){case 3:iV(e),qh();break;case 5:j$(e);break;case 1:pi(e.type)&&Dv(e);break;case 4:Z1(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Kn(Fv,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Kn(mr,mr.current&1),e.flags|=128,null):n&e.child.childLanes?oV(t,e,n):(Kn(mr,mr.current&1),t=ol(t,e,n),t!==null?t.sibling:null);Kn(mr,mr.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return aV(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Kn(mr,mr.current),r)break;return null;case 22:case 23:return e.lanes=0,rV(t,e,n)}return ol(t,e,n)}var lV,sE,cV,uV;lV=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};sE=function(){};cV=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Tu(ga.current);var i=null;switch(n){case"input":s=TC(t,s),r=TC(t,r),i=[];break;case"select":s=vr({},s,{value:void 0}),r=vr({},r,{value:void 0}),i=[];break;case"textarea":s=PC(t,s),r=PC(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Rv)}kC(n,r);var o;n=null;for(u in s)if(!r.hasOwnProperty(u)&&s.hasOwnProperty(u)&&s[u]!=null)if(u==="style"){var l=s[u];for(o in l)l.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Cp.hasOwnProperty(u)?i||(i=[]):(i=i||[]).push(u,null));for(u in r){var c=r[u];if(l=s!=null?s[u]:void 0,r.hasOwnProperty(u)&&c!==l&&(c!=null||l!=null))if(u==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(n||(n={}),n[o]=c[o])}else n||(i||(i=[]),i.push(u,n)),n=c;else u==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(u,c)):u==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(u,""+c):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Cp.hasOwnProperty(u)?(c!=null&&u==="onScroll"&&tr("scroll",t),i||l===c||(i=[])):(i=i||[]).push(u,c))}n&&(i=i||[]).push("style",n);var u=i;(e.updateQueue=u)&&(e.flags|=4)}};uV=function(t,e,n,r){n!==r&&(e.flags|=4)};function em(t,e){if(!lr)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Ns(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function YY(t,e,n){var r=e.pendingProps;switch(H1(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ns(e),null;case 1:return pi(e.type)&&jv(),Ns(e),null;case 3:return r=e.stateNode,Yh(),rr(mi),rr(Os),tI(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Ry(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,jo!==null&&(hE(jo),jo=null))),sE(t,e),Ns(e),null;case 5:eI(e);var s=Tu(Lp.current);if(n=e.type,t!==null&&e.stateNode!=null)cV(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(Je(166));return Ns(e),null}if(t=Tu(ga.current),Ry(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[aa]=e,r[Dp]=i,t=(e.mode&1)!==0,n){case"dialog":tr("cancel",r),tr("close",r);break;case"iframe":case"object":case"embed":tr("load",r);break;case"video":case"audio":for(s=0;s<Em.length;s++)tr(Em[s],r);break;case"source":tr("error",r);break;case"img":case"image":case"link":tr("error",r),tr("load",r);break;case"details":tr("toggle",r);break;case"input":Hk(r,i),tr("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},tr("invalid",r);break;case"textarea":Kk(r,i),tr("invalid",r)}kC(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?r.textContent!==l&&(i.suppressHydrationWarning!==!0&&ky(r.textContent,l,t),s=["children",l]):typeof l=="number"&&r.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&ky(r.textContent,l,t),s=["children",""+l]):Cp.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&tr("scroll",r)}switch(n){case"input":Sy(r),qk(r,i,!0);break;case"textarea":Sy(r),Yk(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Rv)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=OO(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[aa]=e,t[Dp]=r,lV(t,e,!1,!1),e.stateNode=t;e:{switch(o=RC(n,r),n){case"dialog":tr("cancel",t),tr("close",t),s=r;break;case"iframe":case"object":case"embed":tr("load",t),s=r;break;case"video":case"audio":for(s=0;s<Em.length;s++)tr(Em[s],t);s=r;break;case"source":tr("error",t),s=r;break;case"img":case"image":case"link":tr("error",t),tr("load",t),s=r;break;case"details":tr("toggle",t),s=r;break;case"input":Hk(t,r),s=TC(t,r),tr("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=vr({},r,{value:void 0}),tr("invalid",t);break;case"textarea":Kk(t,r),s=PC(t,r),tr("invalid",t);break;default:s=r}kC(n,s),l=s;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?UO(t,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&$O(t,c)):i==="children"?typeof c=="string"?(n!=="textarea"||c!=="")&&Ep(t,c):typeof c=="number"&&Ep(t,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Cp.hasOwnProperty(i)?c!=null&&i==="onScroll"&&tr("scroll",t):c!=null&&k1(t,i,c,o))}switch(n){case"input":Sy(t),qk(t,r,!1);break;case"textarea":Sy(t),Yk(t);break;case"option":r.value!=null&&t.setAttribute("value",""+bc(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?Eh(t,!!r.multiple,i,!1):r.defaultValue!=null&&Eh(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Rv)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Ns(e),null;case 6:if(t&&e.stateNode!=null)uV(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(Je(166));if(n=Tu(Lp.current),Tu(ga.current),Ry(e)){if(r=e.stateNode,n=e.memoizedProps,r[aa]=e,(i=r.nodeValue!==n)&&(t=qi,t!==null))switch(t.tag){case 3:ky(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&ky(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[aa]=e,e.stateNode=r}return Ns(e),null;case 13:if(rr(mr),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(lr&&Bi!==null&&e.mode&1&&!(e.flags&128))N$(),qh(),e.flags|=98560,i=!1;else if(i=Ry(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(Je(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(Je(317));i[aa]=e}else qh(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Ns(e),i=!1}else jo!==null&&(hE(jo),jo=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||mr.current&1?Jr===0&&(Jr=3):fI())),e.updateQueue!==null&&(e.flags|=4),Ns(e),null);case 4:return Yh(),sE(t,e),t===null&&Rp(e.stateNode.containerInfo),Ns(e),null;case 10:return J1(e.type._context),Ns(e),null;case 17:return pi(e.type)&&jv(),Ns(e),null;case 19:if(rr(mr),i=e.memoizedState,i===null)return Ns(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)em(i,!1);else{if(Jr!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Vv(t),o!==null){for(e.flags|=128,em(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Kn(mr,mr.current&1|2),e.child}t=t.sibling}i.tail!==null&&jr()>Xh&&(e.flags|=128,r=!0,em(i,!1),e.lanes=4194304)}else{if(!r)if(t=Vv(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),em(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!lr)return Ns(e),null}else 2*jr()-i.renderingStartTime>Xh&&n!==1073741824&&(e.flags|=128,r=!0,em(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=jr(),e.sibling=null,n=mr.current,Kn(mr,r?n&1|2:n&1),e):(Ns(e),null);case 22:case 23:return hI(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Li&1073741824&&(Ns(e),e.subtreeFlags&6&&(e.flags|=8192)):Ns(e),null;case 24:return null;case 25:return null}throw Error(Je(156,e.tag))}function JY(t,e){switch(H1(e),e.tag){case 1:return pi(e.type)&&jv(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Yh(),rr(mi),rr(Os),tI(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return eI(e),null;case 13:if(rr(mr),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(Je(340));qh()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return rr(mr),null;case 4:return Yh(),null;case 10:return J1(e.type._context),null;case 22:case 23:return hI(),null;case 24:return null;default:return null}}var My=!1,js=!1,XY=typeof WeakSet=="function"?WeakSet:Set,yt=null;function hh(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){_r(t,e,r)}else n.current=null}function iE(t,e,n){try{n()}catch(r){_r(t,e,r)}}var OR=!1;function QY(t,e){if(BC=Pv,t=p$(),G1(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,l=-1,c=-1,u=0,d=0,h=t,f=null;t:for(;;){for(var m;h!==n||s!==0&&h.nodeType!==3||(l=o+s),h!==i||r!==0&&h.nodeType!==3||(c=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(m=h.firstChild)!==null;)f=h,h=m;for(;;){if(h===t)break t;if(f===n&&++u===s&&(l=o),f===i&&++d===r&&(c=o),(m=h.nextSibling)!==null)break;h=f,f=h.parentNode}h=m}n=l===-1||c===-1?null:{start:l,end:c}}else n=null}n=n||{start:0,end:0}}else n=null;for(zC={focusedElem:t,selectionRange:n},Pv=!1,yt=e;yt!==null;)if(e=yt,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,yt=t;else for(;yt!==null;){e=yt;try{var g=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(g!==null){var x=g.memoizedProps,w=g.memoizedState,v=e.stateNode,_=v.getSnapshotBeforeUpdate(e.elementType===e.type?x:No(e.type,x),w);v.__reactInternalSnapshotBeforeUpdate=_}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Je(163))}}catch(T){_r(e,e.return,T)}if(t=e.sibling,t!==null){t.return=e.return,yt=t;break}yt=e.return}return g=OR,OR=!1,g}function Ym(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&iE(e,n,i)}s=s.next}while(s!==r)}}function w0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function oE(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function dV(t){var e=t.alternate;e!==null&&(t.alternate=null,dV(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[aa],delete e[Dp],delete e[HC],delete e[DY],delete e[MY])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function hV(t){return t.tag===5||t.tag===3||t.tag===4}function $R(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||hV(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function aE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Rv));else if(r!==4&&(t=t.child,t!==null))for(aE(t,e,n),t=t.sibling;t!==null;)aE(t,e,n),t=t.sibling}function lE(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(lE(t,e,n),t=t.sibling;t!==null;)lE(t,e,n),t=t.sibling}var fs=null,Ao=!1;function Cl(t,e,n){for(n=n.child;n!==null;)fV(t,e,n),n=n.sibling}function fV(t,e,n){if(pa&&typeof pa.onCommitFiberUnmount=="function")try{pa.onCommitFiberUnmount(h0,n)}catch{}switch(n.tag){case 5:js||hh(n,e);case 6:var r=fs,s=Ao;fs=null,Cl(t,e,n),fs=r,Ao=s,fs!==null&&(Ao?(t=fs,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):fs.removeChild(n.stateNode));break;case 18:fs!==null&&(Ao?(t=fs,n=n.stateNode,t.nodeType===8?F_(t.parentNode,n):t.nodeType===1&&F_(t,n),Pp(t)):F_(fs,n.stateNode));break;case 4:r=fs,s=Ao,fs=n.stateNode.containerInfo,Ao=!0,Cl(t,e,n),fs=r,Ao=s;break;case 0:case 11:case 14:case 15:if(!js&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&iE(n,e,o),s=s.next}while(s!==r)}Cl(t,e,n);break;case 1:if(!js&&(hh(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(l){_r(n,e,l)}Cl(t,e,n);break;case 21:Cl(t,e,n);break;case 22:n.mode&1?(js=(r=js)||n.memoizedState!==null,Cl(t,e,n),js=r):Cl(t,e,n);break;default:Cl(t,e,n)}}function VR(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new XY),e.forEach(function(r){var s=aJ.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function Eo(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:fs=l.stateNode,Ao=!1;break e;case 3:fs=l.stateNode.containerInfo,Ao=!0;break e;case 4:fs=l.stateNode.containerInfo,Ao=!0;break e}l=l.return}if(fs===null)throw Error(Je(160));fV(i,o,s),fs=null,Ao=!1;var c=s.alternate;c!==null&&(c.return=null),s.return=null}catch(u){_r(s,e,u)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)mV(e,t),e=e.sibling}function mV(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Eo(e,t),ea(t),r&4){try{Ym(3,t,t.return),w0(3,t)}catch(x){_r(t,t.return,x)}try{Ym(5,t,t.return)}catch(x){_r(t,t.return,x)}}break;case 1:Eo(e,t),ea(t),r&512&&n!==null&&hh(n,n.return);break;case 5:if(Eo(e,t),ea(t),r&512&&n!==null&&hh(n,n.return),t.flags&32){var s=t.stateNode;try{Ep(s,"")}catch(x){_r(t,t.return,x)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,l=t.type,c=t.updateQueue;if(t.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&LO(s,i),RC(l,o);var u=RC(l,i);for(o=0;o<c.length;o+=2){var d=c[o],h=c[o+1];d==="style"?UO(s,h):d==="dangerouslySetInnerHTML"?$O(s,h):d==="children"?Ep(s,h):k1(s,d,h,u)}switch(l){case"input":IC(s,i);break;case"textarea":FO(s,i);break;case"select":var f=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var m=i.value;m!=null?Eh(s,!!i.multiple,m,!1):f!==!!i.multiple&&(i.defaultValue!=null?Eh(s,!!i.multiple,i.defaultValue,!0):Eh(s,!!i.multiple,i.multiple?[]:"",!1))}s[Dp]=i}catch(x){_r(t,t.return,x)}}break;case 6:if(Eo(e,t),ea(t),r&4){if(t.stateNode===null)throw Error(Je(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(x){_r(t,t.return,x)}}break;case 3:if(Eo(e,t),ea(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Pp(e.containerInfo)}catch(x){_r(t,t.return,x)}break;case 4:Eo(e,t),ea(t);break;case 13:Eo(e,t),ea(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(uI=jr())),r&4&&VR(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(js=(u=js)||d,Eo(e,t),js=u):Eo(e,t),ea(t),r&8192){if(u=t.memoizedState!==null,(t.stateNode.isHidden=u)&&!d&&t.mode&1)for(yt=t,d=t.child;d!==null;){for(h=yt=d;yt!==null;){switch(f=yt,m=f.child,f.tag){case 0:case 11:case 14:case 15:Ym(4,f,f.return);break;case 1:hh(f,f.return);var g=f.stateNode;if(typeof g.componentWillUnmount=="function"){r=f,n=f.return;try{e=r,g.props=e.memoizedProps,g.state=e.memoizedState,g.componentWillUnmount()}catch(x){_r(r,n,x)}}break;case 5:hh(f,f.return);break;case 22:if(f.memoizedState!==null){BR(h);continue}}m!==null?(m.return=f,yt=m):BR(h)}d=d.sibling}e:for(d=null,h=t;;){if(h.tag===5){if(d===null){d=h;try{s=h.stateNode,u?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=h.stateNode,c=h.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=VO("display",o))}catch(x){_r(t,t.return,x)}}}else if(h.tag===6){if(d===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(x){_r(t,t.return,x)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;d===h&&(d=null),h=h.return}d===h&&(d=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Eo(e,t),ea(t),r&4&&VR(t);break;case 21:break;default:Eo(e,t),ea(t)}}function ea(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(hV(n)){var r=n;break e}n=n.return}throw Error(Je(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ep(s,""),r.flags&=-33);var i=$R(t);lE(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,l=$R(t);aE(t,l,o);break;default:throw Error(Je(161))}}catch(c){_r(t,t.return,c)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function ZY(t,e,n){yt=t,pV(t)}function pV(t,e,n){for(var r=(t.mode&1)!==0;yt!==null;){var s=yt,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||My;if(!o){var l=s.alternate,c=l!==null&&l.memoizedState!==null||js;l=My;var u=js;if(My=o,(js=c)&&!u)for(yt=s;yt!==null;)o=yt,c=o.child,o.tag===22&&o.memoizedState!==null?zR(s):c!==null?(c.return=o,yt=c):zR(s);for(;i!==null;)yt=i,pV(i),i=i.sibling;yt=s,My=l,js=u}UR(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,yt=i):UR(t)}}function UR(t){for(;yt!==null;){var e=yt;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:js||w0(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!js)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:No(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&ER(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}ER(e,o,n)}break;case 5:var l=e.stateNode;if(n===null&&e.flags&4){n=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&n.focus();break;case"img":c.src&&(n.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var u=e.alternate;if(u!==null){var d=u.memoizedState;if(d!==null){var h=d.dehydrated;h!==null&&Pp(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Je(163))}js||e.flags&512&&oE(e)}catch(f){_r(e,e.return,f)}}if(e===t){yt=null;break}if(n=e.sibling,n!==null){n.return=e.return,yt=n;break}yt=e.return}}function BR(t){for(;yt!==null;){var e=yt;if(e===t){yt=null;break}var n=e.sibling;if(n!==null){n.return=e.return,yt=n;break}yt=e.return}}function zR(t){for(;yt!==null;){var e=yt;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{w0(4,e)}catch(c){_r(e,n,c)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(c){_r(e,s,c)}}var i=e.return;try{oE(e)}catch(c){_r(e,i,c)}break;case 5:var o=e.return;try{oE(e)}catch(c){_r(e,o,c)}}}catch(c){_r(e,e.return,c)}if(e===t){yt=null;break}var l=e.sibling;if(l!==null){l.return=e.return,yt=l;break}yt=e.return}}var eJ=Math.ceil,zv=yl.ReactCurrentDispatcher,lI=yl.ReactCurrentOwner,fo=yl.ReactCurrentBatchConfig,fn=0,as=null,Ur=null,xs=0,Li=0,fh=Dc(0),Jr=0,Vp=null,Hu=0,b0=0,cI=0,Jm=null,ci=null,uI=0,Xh=1/0,La=null,Gv=!1,cE=null,sc=null,Ly=!1,Jl=null,Wv=0,Xm=0,uE=null,Vx=-1,Ux=0;function Xs(){return fn&6?jr():Vx!==-1?Vx:Vx=jr()}function ic(t){return t.mode&1?fn&2&&xs!==0?xs&-xs:FY.transition!==null?(Ux===0&&(Ux=ZO()),Ux):(t=Dn,t!==0||(t=window.event,t=t===void 0?16:o$(t.type)),t):1}function Vo(t,e,n,r){if(50<Xm)throw Xm=0,uE=null,Error(Je(185));wg(t,n,r),(!(fn&2)||t!==as)&&(t===as&&(!(fn&2)&&(b0|=n),Jr===4&&zl(t,xs)),gi(t,r),n===1&&fn===0&&!(e.mode&1)&&(Xh=jr()+500,y0&&Mc()))}function gi(t,e){var n=t.callbackNode;FK(t,e);var r=Nv(t,t===as?xs:0);if(r===0)n!==null&&Qk(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&Qk(n),e===1)t.tag===0?LY(GR.bind(null,t)):E$(GR.bind(null,t)),RY(function(){!(fn&6)&&Mc()}),n=null;else{switch(e$(r)){case 1:n=L1;break;case 4:n=XO;break;case 16:n=Iv;break;case 536870912:n=QO;break;default:n=Iv}n=SV(n,gV.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function gV(t,e){if(Vx=-1,Ux=0,fn&6)throw Error(Je(327));var n=t.callbackNode;if(Ah()&&t.callbackNode!==n)return null;var r=Nv(t,t===as?xs:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=Hv(t,r);else{e=r;var s=fn;fn|=2;var i=xV();(as!==t||xs!==e)&&(La=null,Xh=jr()+500,Mu(t,e));do try{rJ();break}catch(l){yV(t,l)}while(1);Y1(),zv.current=i,fn=s,Ur!==null?e=0:(as=null,xs=0,e=Jr)}if(e!==0){if(e===2&&(s=FC(t),s!==0&&(r=s,e=dE(t,s))),e===1)throw n=Vp,Mu(t,0),zl(t,r),gi(t,jr()),n;if(e===6)zl(t,r);else{if(s=t.current.alternate,!(r&30)&&!tJ(s)&&(e=Hv(t,r),e===2&&(i=FC(t),i!==0&&(r=i,e=dE(t,i))),e===1))throw n=Vp,Mu(t,0),zl(t,r),gi(t,jr()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(Je(345));case 2:cu(t,ci,La);break;case 3:if(zl(t,r),(r&130023424)===r&&(e=uI+500-jr(),10<e)){if(Nv(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Xs(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=WC(cu.bind(null,t,ci,La),e);break}cu(t,ci,La);break;case 4:if(zl(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-$o(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=jr()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*eJ(r/1960))-r,10<r){t.timeoutHandle=WC(cu.bind(null,t,ci,La),r);break}cu(t,ci,La);break;case 5:cu(t,ci,La);break;default:throw Error(Je(329))}}}return gi(t,jr()),t.callbackNode===n?gV.bind(null,t):null}function dE(t,e){var n=Jm;return t.current.memoizedState.isDehydrated&&(Mu(t,e).flags|=256),t=Hv(t,e),t!==2&&(e=ci,ci=n,e!==null&&hE(e)),t}function hE(t){ci===null?ci=t:ci.push.apply(ci,t)}function tJ(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!zo(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function zl(t,e){for(e&=~cI,e&=~b0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-$o(e),r=1<<n;t[n]=-1,e&=~r}}function GR(t){if(fn&6)throw Error(Je(327));Ah();var e=Nv(t,0);if(!(e&1))return gi(t,jr()),null;var n=Hv(t,e);if(t.tag!==0&&n===2){var r=FC(t);r!==0&&(e=r,n=dE(t,r))}if(n===1)throw n=Vp,Mu(t,0),zl(t,e),gi(t,jr()),n;if(n===6)throw Error(Je(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,cu(t,ci,La),gi(t,jr()),null}function dI(t,e){var n=fn;fn|=1;try{return t(e)}finally{fn=n,fn===0&&(Xh=jr()+500,y0&&Mc())}}function qu(t){Jl!==null&&Jl.tag===0&&!(fn&6)&&Ah();var e=fn;fn|=1;var n=fo.transition,r=Dn;try{if(fo.transition=null,Dn=1,t)return t()}finally{Dn=r,fo.transition=n,fn=e,!(fn&6)&&Mc()}}function hI(){Li=fh.current,rr(fh)}function Mu(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,kY(n)),Ur!==null)for(n=Ur.return;n!==null;){var r=n;switch(H1(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&jv();break;case 3:Yh(),rr(mi),rr(Os),tI();break;case 5:eI(r);break;case 4:Yh();break;case 13:rr(mr);break;case 19:rr(mr);break;case 10:J1(r.type._context);break;case 22:case 23:hI()}n=n.return}if(as=t,Ur=t=oc(t.current,null),xs=Li=e,Jr=0,Vp=null,cI=b0=Hu=0,ci=Jm=null,Eu!==null){for(e=0;e<Eu.length;e++)if(n=Eu[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Eu=null}return t}function yV(t,e){do{var n=Ur;try{if(Y1(),Fx.current=Bv,Uv){for(var r=yr.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Uv=!1}if(Wu=0,is=Yr=yr=null,Km=!1,Fp=0,lI.current=null,n===null||n.return===null){Jr=1,Vp=e,Ur=null;break}e:{var i=t,o=n.return,l=n,c=e;if(e=xs,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var u=c,d=l,h=d.tag;if(!(d.mode&1)&&(h===0||h===11||h===15)){var f=d.alternate;f?(d.updateQueue=f.updateQueue,d.memoizedState=f.memoizedState,d.lanes=f.lanes):(d.updateQueue=null,d.memoizedState=null)}var m=kR(o);if(m!==null){m.flags&=-257,RR(m,o,l,i,e),m.mode&1&&AR(i,u,e),e=m,c=u;var g=e.updateQueue;if(g===null){var x=new Set;x.add(c),e.updateQueue=x}else g.add(c);break e}else{if(!(e&1)){AR(i,u,e),fI();break e}c=Error(Je(426))}}else if(lr&&l.mode&1){var w=kR(o);if(w!==null){!(w.flags&65536)&&(w.flags|=256),RR(w,o,l,i,e),q1(Jh(c,l));break e}}i=c=Jh(c,l),Jr!==4&&(Jr=2),Jm===null?Jm=[i]:Jm.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var v=eV(i,c,e);CR(i,v);break e;case 1:l=c;var _=i.type,C=i.stateNode;if(!(i.flags&128)&&(typeof _.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(sc===null||!sc.has(C)))){i.flags|=65536,e&=-e,i.lanes|=e;var T=tV(i,l,e);CR(i,T);break e}}i=i.return}while(i!==null)}wV(n)}catch(R){e=R,Ur===n&&n!==null&&(Ur=n=n.return);continue}break}while(1)}function xV(){var t=zv.current;return zv.current=Bv,t===null?Bv:t}function fI(){(Jr===0||Jr===3||Jr===2)&&(Jr=4),as===null||!(Hu&268435455)&&!(b0&268435455)||zl(as,xs)}function Hv(t,e){var n=fn;fn|=2;var r=xV();(as!==t||xs!==e)&&(La=null,Mu(t,e));do try{nJ();break}catch(s){yV(t,s)}while(1);if(Y1(),fn=n,zv.current=r,Ur!==null)throw Error(Je(261));return as=null,xs=0,Jr}function nJ(){for(;Ur!==null;)vV(Ur)}function rJ(){for(;Ur!==null&&!NK();)vV(Ur)}function vV(t){var e=_V(t.alternate,t,Li);t.memoizedProps=t.pendingProps,e===null?wV(t):Ur=e,lI.current=null}function wV(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=JY(n,e),n!==null){n.flags&=32767,Ur=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Jr=6,Ur=null;return}}else if(n=YY(n,e,Li),n!==null){Ur=n;return}if(e=e.sibling,e!==null){Ur=e;return}Ur=e=t}while(e!==null);Jr===0&&(Jr=5)}function cu(t,e,n){var r=Dn,s=fo.transition;try{fo.transition=null,Dn=1,sJ(t,e,n,r)}finally{fo.transition=s,Dn=r}return null}function sJ(t,e,n,r){do Ah();while(Jl!==null);if(fn&6)throw Error(Je(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(Je(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(OK(t,i),t===as&&(Ur=as=null,xs=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ly||(Ly=!0,SV(Iv,function(){return Ah(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=fo.transition,fo.transition=null;var o=Dn;Dn=1;var l=fn;fn|=4,lI.current=null,QY(t,n),mV(n,t),CY(zC),Pv=!!BC,zC=BC=null,t.current=n,ZY(n),PK(),fn=l,Dn=o,fo.transition=i}else t.current=n;if(Ly&&(Ly=!1,Jl=t,Wv=s),i=t.pendingLanes,i===0&&(sc=null),RK(n.stateNode),gi(t,jr()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Gv)throw Gv=!1,t=cE,cE=null,t;return Wv&1&&t.tag!==0&&Ah(),i=t.pendingLanes,i&1?t===uE?Xm++:(Xm=0,uE=t):Xm=0,Mc(),null}function Ah(){if(Jl!==null){var t=e$(Wv),e=fo.transition,n=Dn;try{if(fo.transition=null,Dn=16>t?16:t,Jl===null)var r=!1;else{if(t=Jl,Jl=null,Wv=0,fn&6)throw Error(Je(331));var s=fn;for(fn|=4,yt=t.current;yt!==null;){var i=yt,o=i.child;if(yt.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var u=l[c];for(yt=u;yt!==null;){var d=yt;switch(d.tag){case 0:case 11:case 15:Ym(8,d,i)}var h=d.child;if(h!==null)h.return=d,yt=h;else for(;yt!==null;){d=yt;var f=d.sibling,m=d.return;if(dV(d),d===u){yt=null;break}if(f!==null){f.return=m,yt=f;break}yt=m}}}var g=i.alternate;if(g!==null){var x=g.child;if(x!==null){g.child=null;do{var w=x.sibling;x.sibling=null,x=w}while(x!==null)}}yt=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,yt=o;else e:for(;yt!==null;){if(i=yt,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Ym(9,i,i.return)}var v=i.sibling;if(v!==null){v.return=i.return,yt=v;break e}yt=i.return}}var _=t.current;for(yt=_;yt!==null;){o=yt;var C=o.child;if(o.subtreeFlags&2064&&C!==null)C.return=o,yt=C;else e:for(o=_;yt!==null;){if(l=yt,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:w0(9,l)}}catch(R){_r(l,l.return,R)}if(l===o){yt=null;break e}var T=l.sibling;if(T!==null){T.return=l.return,yt=T;break e}yt=l.return}}if(fn=s,Mc(),pa&&typeof pa.onPostCommitFiberRoot=="function")try{pa.onPostCommitFiberRoot(h0,t)}catch{}r=!0}return r}finally{Dn=n,fo.transition=e}}return!1}function WR(t,e,n){e=Jh(n,e),e=eV(t,e,1),t=rc(t,e,1),e=Xs(),t!==null&&(wg(t,1,e),gi(t,e))}function _r(t,e,n){if(t.tag===3)WR(t,t,n);else for(;e!==null;){if(e.tag===3){WR(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(sc===null||!sc.has(r))){t=Jh(n,t),t=tV(e,t,1),e=rc(e,t,1),t=Xs(),e!==null&&(wg(e,1,t),gi(e,t));break}}e=e.return}}function iJ(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Xs(),t.pingedLanes|=t.suspendedLanes&n,as===t&&(xs&n)===n&&(Jr===4||Jr===3&&(xs&130023424)===xs&&500>jr()-uI?Mu(t,0):cI|=n),gi(t,e)}function bV(t,e){e===0&&(t.mode&1?(e=Ty,Ty<<=1,!(Ty&130023424)&&(Ty=4194304)):e=1);var n=Xs();t=il(t,e),t!==null&&(wg(t,e,n),gi(t,n))}function oJ(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),bV(t,n)}function aJ(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(Je(314))}r!==null&&r.delete(e),bV(t,n)}var _V;_V=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||mi.current)ui=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return ui=!1,KY(t,e,n);ui=!!(t.flags&131072)}else ui=!1,lr&&e.flags&1048576&&T$(e,Lv,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;$x(t,e),t=e.pendingProps;var s=Hh(e,Os.current);Ph(e,n),s=rI(null,e,r,t,s,n);var i=sI();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,pi(r)?(i=!0,Dv(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,Q1(e),s.updater=v0,e.stateNode=s,s._reactInternals=e,QC(e,r,t,n),e=tE(null,e,r,!0,i,n)):(e.tag=0,lr&&i&&W1(e),qs(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch($x(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=cJ(r),t=No(r,t),s){case 0:e=eE(null,e,r,t,n);break e;case 1:e=MR(null,e,r,t,n);break e;case 11:e=jR(null,e,r,t,n);break e;case 14:e=DR(null,e,r,No(r.type,t),n);break e}throw Error(Je(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:No(r,s),eE(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:No(r,s),MR(t,e,r,s,n);case 3:e:{if(iV(e),t===null)throw Error(Je(387));r=e.pendingProps,i=e.memoizedState,s=i.element,R$(t,e),$v(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Jh(Error(Je(423)),e),e=LR(t,e,r,n,s);break e}else if(r!==s){s=Jh(Error(Je(424)),e),e=LR(t,e,r,n,s);break e}else for(Bi=nc(e.stateNode.containerInfo.firstChild),qi=e,lr=!0,jo=null,n=A$(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(qh(),r===s){e=ol(t,e,n);break e}qs(t,e,r,n)}e=e.child}return e;case 5:return j$(e),t===null&&YC(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,GC(r,s)?o=null:i!==null&&GC(r,i)&&(e.flags|=32),sV(t,e),qs(t,e,o,n),e.child;case 6:return t===null&&YC(e),null;case 13:return oV(t,e,n);case 4:return Z1(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Kh(e,null,r,n):qs(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:No(r,s),jR(t,e,r,s,n);case 7:return qs(t,e,e.pendingProps,n),e.child;case 8:return qs(t,e,e.pendingProps.children,n),e.child;case 12:return qs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,Kn(Fv,r._currentValue),r._currentValue=o,i!==null)if(zo(i.value,o)){if(i.children===s.children&&!mi.current){e=ol(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===r){if(i.tag===1){c=Ka(-1,n&-n),c.tag=2;var u=i.updateQueue;if(u!==null){u=u.shared;var d=u.pending;d===null?c.next=c:(c.next=d.next,d.next=c),u.pending=c}}i.lanes|=n,c=i.alternate,c!==null&&(c.lanes|=n),JC(i.return,n,e),l.lanes|=n;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(Je(341));o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),JC(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}qs(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,Ph(e,n),s=yo(s),r=r(s),e.flags|=1,qs(t,e,r,n),e.child;case 14:return r=e.type,s=No(r,e.pendingProps),s=No(r.type,s),DR(t,e,r,s,n);case 15:return nV(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:No(r,s),$x(t,e),e.tag=1,pi(r)?(t=!0,Dv(e)):t=!1,Ph(e,n),Z$(e,r,s),QC(e,r,s,n),tE(null,e,r,!0,t,n);case 19:return aV(t,e,n);case 22:return rV(t,e,n)}throw Error(Je(156,e.tag))};function SV(t,e){return JO(t,e)}function lJ(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function co(t,e,n,r){return new lJ(t,e,n,r)}function mI(t){return t=t.prototype,!(!t||!t.isReactComponent)}function cJ(t){if(typeof t=="function")return mI(t)?1:0;if(t!=null){if(t=t.$$typeof,t===j1)return 11;if(t===D1)return 14}return 2}function oc(t,e){var n=t.alternate;return n===null?(n=co(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Bx(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")mI(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case rh:return Lu(n.children,s,i,e);case R1:o=8,s|=8;break;case _C:return t=co(12,n,e,s|2),t.elementType=_C,t.lanes=i,t;case SC:return t=co(13,n,e,s),t.elementType=SC,t.lanes=i,t;case CC:return t=co(19,n,e,s),t.elementType=CC,t.lanes=i,t;case jO:return _0(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case kO:o=10;break e;case RO:o=9;break e;case j1:o=11;break e;case D1:o=14;break e;case $l:o=16,r=null;break e}throw Error(Je(130,t==null?t:typeof t,""))}return e=co(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Lu(t,e,n,r){return t=co(7,t,r,e),t.lanes=n,t}function _0(t,e,n,r){return t=co(22,t,r,e),t.elementType=jO,t.lanes=n,t.stateNode={isHidden:!1},t}function W_(t,e,n){return t=co(6,t,null,e),t.lanes=n,t}function H_(t,e,n){return e=co(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function uJ(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=T_(0),this.expirationTimes=T_(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=T_(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function pI(t,e,n,r,s,i,o,l,c){return t=new uJ(t,e,n,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=co(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Q1(i),t}function dJ(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:nh,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function CV(t){if(!t)return _c;t=t._reactInternals;e:{if(hd(t)!==t||t.tag!==1)throw Error(Je(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(pi(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(Je(171))}if(t.tag===1){var n=t.type;if(pi(n))return C$(t,n,e)}return e}function EV(t,e,n,r,s,i,o,l,c){return t=pI(n,r,!0,t,s,i,o,l,c),t.context=CV(null),n=t.current,r=Xs(),s=ic(n),i=Ka(r,s),i.callback=e??null,rc(n,i,s),t.current.lanes=s,wg(t,s,r),gi(t,r),t}function S0(t,e,n,r){var s=e.current,i=Xs(),o=ic(s);return n=CV(n),e.context===null?e.context=n:e.pendingContext=n,e=Ka(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=rc(s,e,o),t!==null&&(Vo(t,s,o,i),Lx(t,s,o)),o}function qv(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function HR(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function gI(t,e){HR(t,e),(t=t.alternate)&&HR(t,e)}function hJ(){return null}var TV=typeof reportError=="function"?reportError:function(t){console.error(t)};function yI(t){this._internalRoot=t}C0.prototype.render=yI.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(Je(409));S0(t,e,null,null)};C0.prototype.unmount=yI.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;qu(function(){S0(null,t,null,null)}),e[sl]=null}};function C0(t){this._internalRoot=t}C0.prototype.unstable_scheduleHydration=function(t){if(t){var e=r$();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Bl.length&&e!==0&&e<Bl[n].priority;n++);Bl.splice(n,0,t),n===0&&i$(t)}};function xI(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function E0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function qR(){}function fJ(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var u=qv(o);i.call(u)}}var o=EV(e,r,t,0,null,!1,!1,"",qR);return t._reactRootContainer=o,t[sl]=o.current,Rp(t.nodeType===8?t.parentNode:t),qu(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var l=r;r=function(){var u=qv(c);l.call(u)}}var c=pI(t,0,!1,null,null,!1,!1,"",qR);return t._reactRootContainer=c,t[sl]=c.current,Rp(t.nodeType===8?t.parentNode:t),qu(function(){S0(e,c,n,r)}),c}function T0(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var l=s;s=function(){var c=qv(o);l.call(c)}}S0(e,o,t,s)}else o=fJ(n,e,t,s,r);return qv(o)}t$=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Cm(e.pendingLanes);n!==0&&(F1(e,n|1),gi(e,jr()),!(fn&6)&&(Xh=jr()+500,Mc()))}break;case 13:qu(function(){var r=il(t,1);if(r!==null){var s=Xs();Vo(r,t,1,s)}}),gI(t,1)}};O1=function(t){if(t.tag===13){var e=il(t,134217728);if(e!==null){var n=Xs();Vo(e,t,134217728,n)}gI(t,134217728)}};n$=function(t){if(t.tag===13){var e=ic(t),n=il(t,e);if(n!==null){var r=Xs();Vo(n,t,e,r)}gI(t,e)}};r$=function(){return Dn};s$=function(t,e){var n=Dn;try{return Dn=t,e()}finally{Dn=n}};DC=function(t,e,n){switch(e){case"input":if(IC(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=g0(r);if(!s)throw Error(Je(90));MO(r),IC(r,s)}}}break;case"textarea":FO(t,n);break;case"select":e=n.value,e!=null&&Eh(t,!!n.multiple,e,!1)}};GO=dI;WO=qu;var mJ={usingClientEntryPoint:!1,Events:[_g,ah,g0,BO,zO,dI]},tm={findFiberByHostInstance:Cu,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},pJ={bundleType:tm.bundleType,version:tm.version,rendererPackageName:tm.rendererPackageName,rendererConfig:tm.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:yl.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=KO(t),t===null?null:t.stateNode},findFiberByHostInstance:tm.findFiberByHostInstance||hJ,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Fy=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Fy.isDisabled&&Fy.supportsFiber)try{h0=Fy.inject(pJ),pa=Fy}catch{}}Zi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=mJ;Zi.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!xI(e))throw Error(Je(200));return dJ(t,e,null,n)};Zi.createRoot=function(t,e){if(!xI(t))throw Error(Je(299));var n=!1,r="",s=TV;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=pI(t,1,!1,null,null,n,!1,r,s),t[sl]=e.current,Rp(t.nodeType===8?t.parentNode:t),new yI(e)};Zi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(Je(188)):(t=Object.keys(t).join(","),Error(Je(268,t)));return t=KO(e),t=t===null?null:t.stateNode,t};Zi.flushSync=function(t){return qu(t)};Zi.hydrate=function(t,e,n){if(!E0(e))throw Error(Je(200));return T0(null,t,e,!0,n)};Zi.hydrateRoot=function(t,e,n){if(!xI(t))throw Error(Je(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=TV;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=EV(e,null,t,1,n??null,s,!1,i,o),t[sl]=e.current,Rp(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new C0(e)};Zi.render=function(t,e,n){if(!E0(e))throw Error(Je(200));return T0(null,t,e,!1,n)};Zi.unmountComponentAtNode=function(t){if(!E0(t))throw Error(Je(40));return t._reactRootContainer?(qu(function(){T0(null,null,t,!1,function(){t._reactRootContainer=null,t[sl]=null})}),!0):!1};Zi.unstable_batchedUpdates=dI;Zi.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!E0(n))throw Error(Je(200));if(t==null||t._reactInternals===void 0)throw Error(Je(38));return T0(t,e,n,!1,r)};Zi.version="18.3.1-next-f1338f8080-20240426";function IV(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(IV)}catch(t){console.error(t)}}IV(),IO.exports=Zi;var xl=IO.exports;const vI=c0(xl),gJ=pO({__proto__:null,default:vI},[xl]);var KR=xl;wC.createRoot=KR.createRoot,wC.hydrateRoot=KR.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function or(){return or=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},or.apply(this,arguments)}var Rr;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Rr||(Rr={}));const YR="popstate";function yJ(t){t===void 0&&(t={});function e(r,s){let{pathname:i,search:o,hash:l}=r.location;return Up("",{pathname:i,search:o,hash:l},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Ku(s)}return vJ(e,n,null,t)}function Zt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qh(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function xJ(){return Math.random().toString(36).substr(2,8)}function JR(t,e){return{usr:t.state,key:t.key,idx:e}}function Up(t,e,n,r){return n===void 0&&(n=null),or({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?vl(e):e,{state:n,key:e&&e.key||r||xJ()})}function Ku(t){let{pathname:e="/",search:n="",hash:r=""}=t;return n&&n!=="?"&&(e+=n.charAt(0)==="?"?n:"?"+n),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function vl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substr(n),t=t.substr(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substr(r),t=t.substr(0,r)),t&&(e.pathname=t)}return e}function vJ(t,e,n,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:i=!1}=r,o=s.history,l=Rr.Pop,c=null,u=d();u==null&&(u=0,o.replaceState(or({},o.state,{idx:u}),""));function d(){return(o.state||{idx:null}).idx}function h(){l=Rr.Pop;let w=d(),v=w==null?null:w-u;u=w,c&&c({action:l,location:x.location,delta:v})}function f(w,v){l=Rr.Push;let _=Up(x.location,w,v);n&&n(_,w),u=d()+1;let C=JR(_,u),T=x.createHref(_);try{o.pushState(C,"",T)}catch(R){if(R instanceof DOMException&&R.name==="DataCloneError")throw R;s.location.assign(T)}i&&c&&c({action:l,location:x.location,delta:1})}function m(w,v){l=Rr.Replace;let _=Up(x.location,w,v);n&&n(_,w),u=d();let C=JR(_,u),T=x.createHref(_);o.replaceState(C,"",T),i&&c&&c({action:l,location:x.location,delta:0})}function g(w){let v=s.location.origin!=="null"?s.location.origin:s.location.href,_=typeof w=="string"?w:Ku(w);return _=_.replace(/ $/,"%20"),Zt(v,"No window.location.(origin|href) available to create URL for href: "+_),new URL(_,v)}let x={get action(){return l},get location(){return t(s,o)},listen(w){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(YR,h),c=w,()=>{s.removeEventListener(YR,h),c=null}},createHref(w){return e(s,w)},createURL:g,encodeLocation(w){let v=g(w);return{pathname:v.pathname,search:v.search,hash:v.hash}},push:f,replace:m,go(w){return o.go(w)}};return x}var Rn;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(Rn||(Rn={}));const wJ=new Set(["lazy","caseSensitive","path","id","index","children"]);function bJ(t){return t.index===!0}function Kv(t,e,n,r){return n===void 0&&(n=[]),r===void 0&&(r={}),t.map((s,i)=>{let o=[...n,String(i)],l=typeof s.id=="string"?s.id:o.join("-");if(Zt(s.index!==!0||!s.children,"Cannot specify children on an index route"),Zt(!r[l],'Found a route id collision on id "'+l+`".  Route id's must be globally unique within Data Router usages`),bJ(s)){let c=or({},s,e(s),{id:l});return r[l]=c,c}else{let c=or({},s,e(s),{id:l,children:void 0});return r[l]=c,s.children&&(c.children=Kv(s.children,e,o,r)),c}})}function gu(t,e,n){return n===void 0&&(n="/"),zx(t,e,n,!1)}function zx(t,e,n,r){let s=typeof e=="string"?vl(e):e,i=Pf(s.pathname||"/",n);if(i==null)return null;let o=NV(t);SJ(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let u=DJ(i);l=RJ(o[c],u,r)}return l}function _J(t,e){let{route:n,pathname:r,params:s}=t;return{id:n.id,pathname:r,params:s,data:e[n.id],handle:n.handle}}function NV(t,e,n,r){e===void 0&&(e=[]),n===void 0&&(n=[]),r===void 0&&(r="");let s=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(Zt(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let u=Ya([r,c.relativePath]),d=n.concat(c);i.children&&i.children.length>0&&(Zt(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+u+'".')),NV(i.children,e,d,u)),!(i.path==null&&!i.index)&&e.push({path:u,score:AJ(u,i.index),routesMeta:d})};return t.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))s(i,o);else for(let c of PV(i.path))s(i,o,c)}),e}function PV(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let o=PV(r.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),s&&l.push(...o),l.map(c=>t.startsWith("/")&&c===""?"/":c)}function SJ(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:kJ(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}const CJ=/^:[\w-]+$/,EJ=3,TJ=2,IJ=1,NJ=10,PJ=-2,XR=t=>t==="*";function AJ(t,e){let n=t.split("/"),r=n.length;return n.some(XR)&&(r+=PJ),e&&(r+=TJ),n.filter(s=>!XR(s)).reduce((s,i)=>s+(CJ.test(i)?EJ:i===""?IJ:NJ),r)}function kJ(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function RJ(t,e,n){n===void 0&&(n=!1);let{routesMeta:r}=t,s={},i="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],u=l===r.length-1,d=i==="/"?e:e.slice(i.length)||"/",h=QR({path:c.relativePath,caseSensitive:c.caseSensitive,end:u},d),f=c.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=QR({path:c.relativePath,caseSensitive:c.caseSensitive,end:!1},d)),!h)return null;Object.assign(s,h.params),o.push({params:s,pathname:Ya([i,h.pathname]),pathnameBase:FJ(Ya([i,h.pathnameBase])),route:f}),h.pathnameBase!=="/"&&(i=Ya([i,h.pathnameBase]))}return o}function QR(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=jJ(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],o=i.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((u,d,h)=>{let{paramName:f,isOptional:m}=d;if(f==="*"){let x=l[h]||"";o=i.slice(0,i.length-x.length).replace(/(.)\/+$/,"$1")}const g=l[h];return m&&!g?u[f]=void 0:u[f]=(g||"").replace(/%2F/g,"/"),u},{}),pathname:i,pathnameBase:o,pattern:t}}function jJ(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!0),Qh(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function DJ(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qh(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function Pf(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function MJ(t,e){e===void 0&&(e="/");let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?vl(t):t;return{pathname:n?n.startsWith("/")?n:LJ(n,e):e,search:OJ(r),hash:$J(s)}}function LJ(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function q_(t,e,n,r){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+n+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function AV(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function I0(t,e){let n=AV(t);return e?n.map((r,s)=>s===n.length-1?r.pathname:r.pathnameBase):n.map(r=>r.pathnameBase)}function N0(t,e,n,r){r===void 0&&(r=!1);let s;typeof t=="string"?s=vl(t):(s=or({},t),Zt(!s.pathname||!s.pathname.includes("?"),q_("?","pathname","search",s)),Zt(!s.pathname||!s.pathname.includes("#"),q_("#","pathname","hash",s)),Zt(!s.search||!s.search.includes("#"),q_("#","search","hash",s)));let i=t===""||s.pathname==="",o=i?"/":s.pathname,l;if(o==null)l=n;else{let h=e.length-1;if(!r&&o.startsWith("..")){let f=o.split("/");for(;f[0]==="..";)f.shift(),h-=1;s.pathname=f.join("/")}l=h>=0?e[h]:"/"}let c=MJ(s,l),u=o&&o!=="/"&&o.endsWith("/"),d=(i||o===".")&&n.endsWith("/");return!c.pathname.endsWith("/")&&(u||d)&&(c.pathname+="/"),c}const Ya=t=>t.join("/").replace(/\/\/+/g,"/"),FJ=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),OJ=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,$J=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;class Yv{constructor(e,n,r,s){s===void 0&&(s=!1),this.status=e,this.statusText=n||"",this.internal=s,r instanceof Error?(this.data=r.toString(),this.error=r):this.data=r}}function Bp(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const kV=["post","put","patch","delete"],VJ=new Set(kV),UJ=["get",...kV],BJ=new Set(UJ),zJ=new Set([301,302,303,307,308]),GJ=new Set([307,308]),K_={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},WJ={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},nm={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},wI=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,HJ=t=>({hasErrorBoundary:!!t.hasErrorBoundary}),RV="remix-router-transitions";function qJ(t){const e=t.window?t.window:typeof window<"u"?window:void 0,n=typeof e<"u"&&typeof e.document<"u"&&typeof e.document.createElement<"u",r=!n;Zt(t.routes.length>0,"You must provide a non-empty routes array to createRouter");let s;if(t.mapRouteProperties)s=t.mapRouteProperties;else if(t.detectErrorBoundary){let Z=t.detectErrorBoundary;s=he=>({hasErrorBoundary:Z(he)})}else s=HJ;let i={},o=Kv(t.routes,s,void 0,i),l,c=t.basename||"/",u=t.dataStrategy||XJ,d=t.patchRoutesOnNavigation,h=or({v7_fetcherPersist:!1,v7_normalizeFormMethod:!1,v7_partialHydration:!1,v7_prependBasename:!1,v7_relativeSplatPath:!1,v7_skipActionErrorRevalidation:!1},t.future),f=null,m=new Set,g=null,x=null,w=null,v=t.hydrationData!=null,_=gu(o,t.history.location,c),C=!1,T=null;if(_==null&&!d){let Z=li(404,{pathname:t.history.location.pathname}),{matches:he,route:_e}=cj(o);_=he,T={[_e.id]:Z}}_&&!t.hydrationData&&un(_,o,t.history.location.pathname).active&&(_=null);let R;if(_)if(_.some(Z=>Z.route.lazy))R=!1;else if(!_.some(Z=>Z.route.loader))R=!0;else if(h.v7_partialHydration){let Z=t.hydrationData?t.hydrationData.loaderData:null,he=t.hydrationData?t.hydrationData.errors:null;if(he){let _e=_.findIndex(Me=>he[Me.route.id]!==void 0);R=_.slice(0,_e+1).every(Me=>!mE(Me.route,Z,he))}else R=_.every(_e=>!mE(_e.route,Z,he))}else R=t.hydrationData!=null;else if(R=!1,_=[],h.v7_partialHydration){let Z=un(null,o,t.history.location.pathname);Z.active&&Z.matches&&(C=!0,_=Z.matches)}let k,E={historyAction:t.history.action,location:t.history.location,matches:_,initialized:R,navigation:K_,restoreScrollPosition:t.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:t.hydrationData&&t.hydrationData.loaderData||{},actionData:t.hydrationData&&t.hydrationData.actionData||null,errors:t.hydrationData&&t.hydrationData.errors||T,fetchers:new Map,blockers:new Map},I=Rr.Pop,P=!1,A,D=!1,j=new Map,M=null,z=!1,U=!1,K=[],q=new Set,W=new Map,te=0,O=-1,V=new Map,H=new Set,L=new Map,ee=new Map,pe=new Set,xe=new Map,we=new Map,Ie;function Fe(){if(f=t.history.listen(Z=>{let{action:he,location:_e,delta:Me}=Z;if(Ie){Ie(),Ie=void 0;return}Qh(we.size===0||Me!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let Qe=tn({currentLocation:E.location,nextLocation:_e,historyAction:he});if(Qe&&Me!=null){let Q=new Promise(se=>{Ie=se});t.history.go(Me*-1),Ht(Qe,{state:"blocked",location:_e,proceed(){Ht(Qe,{state:"proceeding",proceed:void 0,reset:void 0,location:_e}),Q.then(()=>t.history.go(Me))},reset(){let se=new Map(E.blockers);se.set(Qe,nm),fe({blockers:se})}});return}return me(he,_e)}),n){dX(e,j);let Z=()=>hX(e,j);e.addEventListener("pagehide",Z),M=()=>e.removeEventListener("pagehide",Z)}return E.initialized||me(Rr.Pop,E.location,{initialHydration:!0}),k}function Ve(){f&&f(),M&&M(),m.clear(),A&&A.abort(),E.fetchers.forEach((Z,he)=>Y(he)),E.blockers.forEach((Z,he)=>mt(he))}function Ge(Z){return m.add(Z),()=>m.delete(Z)}function fe(Z,he){he===void 0&&(he={}),E=or({},E,Z);let _e=[],Me=[];h.v7_fetcherPersist&&E.fetchers.forEach((Qe,Q)=>{Qe.state==="idle"&&(pe.has(Q)?Me.push(Q):_e.push(Q))}),pe.forEach(Qe=>{!E.fetchers.has(Qe)&&!W.has(Qe)&&Me.push(Qe)}),[...m].forEach(Qe=>Qe(E,{deletedFetchers:Me,viewTransitionOpts:he.viewTransitionOpts,flushSync:he.flushSync===!0})),h.v7_fetcherPersist?(_e.forEach(Qe=>E.fetchers.delete(Qe)),Me.forEach(Qe=>Y(Qe))):Me.forEach(Qe=>pe.delete(Qe))}function je(Z,he,_e){var Me,Qe;let{flushSync:Q}=_e===void 0?{}:_e,se=E.actionData!=null&&E.navigation.formMethod!=null&&ko(E.navigation.formMethod)&&E.navigation.state==="loading"&&((Me=Z.state)==null?void 0:Me._isRedirect)!==!0,ye;he.actionData?Object.keys(he.actionData).length>0?ye=he.actionData:ye=null:se?ye=E.actionData:ye=null;let J=he.loaderData?aj(E.loaderData,he.loaderData,he.matches||[],he.errors):E.loaderData,le=E.blockers;le.size>0&&(le=new Map(le),le.forEach((Le,Ce)=>le.set(Ce,nm)));let be=P===!0||E.navigation.formMethod!=null&&ko(E.navigation.formMethod)&&((Qe=Z.state)==null?void 0:Qe._isRedirect)!==!0;l&&(o=l,l=void 0),z||I===Rr.Pop||(I===Rr.Push?t.history.push(Z,Z.state):I===Rr.Replace&&t.history.replace(Z,Z.state));let Te;if(I===Rr.Pop){let Le=j.get(E.location.pathname);Le&&Le.has(Z.pathname)?Te={currentLocation:E.location,nextLocation:Z}:j.has(Z.pathname)&&(Te={currentLocation:Z,nextLocation:E.location})}else if(D){let Le=j.get(E.location.pathname);Le?Le.add(Z.pathname):(Le=new Set([Z.pathname]),j.set(E.location.pathname,Le)),Te={currentLocation:E.location,nextLocation:Z}}fe(or({},he,{actionData:ye,loaderData:J,historyAction:I,location:Z,initialized:!0,navigation:K_,revalidation:"idle",restoreScrollPosition:wr(Z,he.matches||E.matches),preventScrollReset:be,blockers:le}),{viewTransitionOpts:Te,flushSync:Q===!0}),I=Rr.Pop,P=!1,D=!1,z=!1,U=!1,K=[]}async function ie(Z,he){if(typeof Z=="number"){t.history.go(Z);return}let _e=fE(E.location,E.matches,c,h.v7_prependBasename,Z,h.v7_relativeSplatPath,he==null?void 0:he.fromRouteId,he==null?void 0:he.relative),{path:Me,submission:Qe,error:Q}=ZR(h.v7_normalizeFormMethod,!1,_e,he),se=E.location,ye=Up(E.location,Me,he&&he.state);ye=or({},ye,t.history.encodeLocation(ye));let J=he&&he.replace!=null?he.replace:void 0,le=Rr.Push;J===!0?le=Rr.Replace:J===!1||Qe!=null&&ko(Qe.formMethod)&&Qe.formAction===E.location.pathname+E.location.search&&(le=Rr.Replace);let be=he&&"preventScrollReset"in he?he.preventScrollReset===!0:void 0,Te=(he&&he.flushSync)===!0,Le=tn({currentLocation:se,nextLocation:ye,historyAction:le});if(Le){Ht(Le,{state:"blocked",location:ye,proceed(){Ht(Le,{state:"proceeding",proceed:void 0,reset:void 0,location:ye}),ie(Z,he)},reset(){let Ce=new Map(E.blockers);Ce.set(Le,nm),fe({blockers:Ce})}});return}return await me(le,ye,{submission:Qe,pendingError:Q,preventScrollReset:be,replace:he&&he.replace,enableViewTransition:he&&he.viewTransition,flushSync:Te})}function $e(){if(Se(),fe({revalidation:"loading"}),E.navigation.state!=="submitting"){if(E.navigation.state==="idle"){me(E.historyAction,E.location,{startUninterruptedRevalidation:!0});return}me(I||E.historyAction,E.navigation.location,{overrideNavigation:E.navigation,enableViewTransition:D===!0})}}async function me(Z,he,_e){A&&A.abort(),A=null,I=Z,z=(_e&&_e.startUninterruptedRevalidation)===!0,zn(E.location,E.matches),P=(_e&&_e.preventScrollReset)===!0,D=(_e&&_e.enableViewTransition)===!0;let Me=l||o,Qe=_e&&_e.overrideNavigation,Q=_e!=null&&_e.initialHydration&&E.matches&&E.matches.length>0&&!C?E.matches:gu(Me,he,c),se=(_e&&_e.flushSync)===!0;if(Q&&E.initialized&&!U&&rX(E.location,he)&&!(_e&&_e.submission&&ko(_e.submission.formMethod))){je(he,{matches:Q},{flushSync:se});return}let ye=un(Q,Me,he.pathname);if(ye.active&&ye.matches&&(Q=ye.matches),!Q){let{error:it,notFoundMatches:ut,route:Nt}=Rt(he.pathname);je(he,{matches:ut,loaderData:{},errors:{[Nt.id]:it}},{flushSync:se});return}A=new AbortController;let J=Ad(t.history,he,A.signal,_e&&_e.submission),le;if(_e&&_e.pendingError)le=[yu(Q).route.id,{type:Rn.error,error:_e.pendingError}];else if(_e&&_e.submission&&ko(_e.submission.formMethod)){let it=await Ue(J,he,_e.submission,Q,ye.active,{replace:_e.replace,flushSync:se});if(it.shortCircuited)return;if(it.pendingActionResult){let[ut,Nt]=it.pendingActionResult;if(Fi(Nt)&&Bp(Nt.error)&&Nt.error.status===404){A=null,je(he,{matches:it.matches,loaderData:{},errors:{[ut]:Nt.error}});return}}Q=it.matches||Q,le=it.pendingActionResult,Qe=Y_(he,_e.submission),se=!1,ye.active=!1,J=Ad(t.history,J.url,J.signal)}let{shortCircuited:be,matches:Te,loaderData:Le,errors:Ce}=await et(J,he,Q,ye.active,Qe,_e&&_e.submission,_e&&_e.fetcherSubmission,_e&&_e.replace,_e&&_e.initialHydration===!0,se,le);be||(A=null,je(he,or({matches:Te||Q},lj(le),{loaderData:Le,errors:Ce})))}async function Ue(Z,he,_e,Me,Qe,Q){Q===void 0&&(Q={}),Se();let se=cX(he,_e);if(fe({navigation:se},{flushSync:Q.flushSync===!0}),Qe){let le=await Nn(Me,he.pathname,Z.signal);if(le.type==="aborted")return{shortCircuited:!0};if(le.type==="error"){let be=yu(le.partialMatches).route.id;return{matches:le.partialMatches,pendingActionResult:[be,{type:Rn.error,error:le.error}]}}else if(le.matches)Me=le.matches;else{let{notFoundMatches:be,error:Te,route:Le}=Rt(he.pathname);return{matches:be,pendingActionResult:[Le.id,{type:Rn.error,error:Te}]}}}let ye,J=Tm(Me,he);if(!J.route.action&&!J.route.lazy)ye={type:Rn.error,error:li(405,{method:Z.method,pathname:he.pathname,routeId:J.route.id})};else if(ye=(await xn("action",E,Z,[J],Me,null))[J.route.id],Z.signal.aborted)return{shortCircuited:!0};if(Iu(ye)){let le;return Q&&Q.replace!=null?le=Q.replace:le=sj(ye.response.headers.get("Location"),new URL(Z.url),c)===E.location.pathname+E.location.search,await kt(Z,ye,!0,{submission:_e,replace:le}),{shortCircuited:!0}}if(Xl(ye))throw li(400,{type:"defer-action"});if(Fi(ye)){let le=yu(Me,J.route.id);return(Q&&Q.replace)!==!0&&(I=Rr.Push),{matches:Me,pendingActionResult:[le.route.id,ye]}}return{matches:Me,pendingActionResult:[J.route.id,ye]}}async function et(Z,he,_e,Me,Qe,Q,se,ye,J,le,be){let Te=Qe||Y_(he,Q),Le=Q||se||dj(Te),Ce=!z&&(!h.v7_partialHydration||!J);if(Me){if(Ce){let Pn=ct(be);fe(or({navigation:Te},Pn!==void 0?{actionData:Pn}:{}),{flushSync:le})}let Jt=await Nn(_e,he.pathname,Z.signal);if(Jt.type==="aborted")return{shortCircuited:!0};if(Jt.type==="error"){let Pn=yu(Jt.partialMatches).route.id;return{matches:Jt.partialMatches,loaderData:{},errors:{[Pn]:Jt.error}}}else if(Jt.matches)_e=Jt.matches;else{let{error:Pn,notFoundMatches:si,route:Ti}=Rt(he.pathname);return{matches:si,loaderData:{},errors:{[Ti.id]:Pn}}}}let it=l||o,[ut,Nt]=tj(t.history,E,_e,Le,he,h.v7_partialHydration&&J===!0,h.v7_skipActionErrorRevalidation,U,K,q,pe,L,H,it,c,be);if(sn(Jt=>!(_e&&_e.some(Pn=>Pn.route.id===Jt))||ut&&ut.some(Pn=>Pn.route.id===Jt)),O=++te,ut.length===0&&Nt.length===0){let Jt=Re();return je(he,or({matches:_e,loaderData:{},errors:be&&Fi(be[1])?{[be[0]]:be[1].error}:null},lj(be),Jt?{fetchers:new Map(E.fetchers)}:{}),{flushSync:le}),{shortCircuited:!0}}if(Ce){let Jt={};if(!Me){Jt.navigation=Te;let Pn=ct(be);Pn!==void 0&&(Jt.actionData=Pn)}Nt.length>0&&(Jt.fetchers=Mt(Nt)),fe(Jt,{flushSync:le})}Nt.forEach(Jt=>{ce(Jt.key),Jt.controller&&W.set(Jt.key,Jt.controller)});let vn=()=>Nt.forEach(Jt=>ce(Jt.key));A&&A.signal.addEventListener("abort",vn);let{loaderResults:es,fetcherResults:Vn}=await re(E,_e,ut,Nt,Z);if(Z.signal.aborted)return{shortCircuited:!0};A&&A.signal.removeEventListener("abort",vn),Nt.forEach(Jt=>W.delete(Jt.key));let Wr=Oy(es);if(Wr)return await kt(Z,Wr.result,!0,{replace:ye}),{shortCircuited:!0};if(Wr=Oy(Vn),Wr)return H.add(Wr.key),await kt(Z,Wr.result,!0,{replace:ye}),{shortCircuited:!0};let{loaderData:Ei,errors:Us}=oj(E,_e,es,be,Nt,Vn,xe);xe.forEach((Jt,Pn)=>{Jt.subscribe(si=>{(si||Jt.done)&&xe.delete(Pn)})}),h.v7_partialHydration&&J&&E.errors&&(Us=or({},E.errors,Us));let ri=Re(),Bs=Be(O),us=ri||Bs||Nt.length>0;return or({matches:_e,loaderData:Ei,errors:Us},us?{fetchers:new Map(E.fetchers)}:{})}function ct(Z){if(Z&&!Fi(Z[1]))return{[Z[0]]:Z[1].data};if(E.actionData)return Object.keys(E.actionData).length===0?null:E.actionData}function Mt(Z){return Z.forEach(he=>{let _e=E.fetchers.get(he.key),Me=rm(void 0,_e?_e.data:void 0);E.fetchers.set(he.key,Me)}),new Map(E.fetchers)}function Sn(Z,he,_e,Me){if(r)throw new Error("router.fetch() was called during the server render, but it shouldn't be. You are likely calling a useFetcher() method in the body of your component. Try moving it to a useEffect or a callback.");ce(Z);let Qe=(Me&&Me.flushSync)===!0,Q=l||o,se=fE(E.location,E.matches,c,h.v7_prependBasename,_e,h.v7_relativeSplatPath,he,Me==null?void 0:Me.relative),ye=gu(Q,se,c),J=un(ye,Q,se);if(J.active&&J.matches&&(ye=J.matches),!ye){X(Z,he,li(404,{pathname:se}),{flushSync:Qe});return}let{path:le,submission:be,error:Te}=ZR(h.v7_normalizeFormMethod,!0,se,Me);if(Te){X(Z,he,Te,{flushSync:Qe});return}let Le=Tm(ye,le),Ce=(Me&&Me.preventScrollReset)===!0;if(be&&ko(be.formMethod)){en(Z,he,le,Le,ye,J.active,Qe,Ce,be);return}L.set(Z,{routeId:he,path:le}),rn(Z,he,le,Le,ye,J.active,Qe,Ce,be)}async function en(Z,he,_e,Me,Qe,Q,se,ye,J){Se(),L.delete(Z);function le(Ln){if(!Ln.route.action&&!Ln.route.lazy){let ii=li(405,{method:J.formMethod,pathname:_e,routeId:he});return X(Z,he,ii,{flushSync:se}),!0}return!1}if(!Q&&le(Me))return;let be=E.fetchers.get(Z);B(Z,uX(J,be),{flushSync:se});let Te=new AbortController,Le=Ad(t.history,_e,Te.signal,J);if(Q){let Ln=await Nn(Qe,new URL(Le.url).pathname,Le.signal,Z);if(Ln.type==="aborted")return;if(Ln.type==="error"){X(Z,he,Ln.error,{flushSync:se});return}else if(Ln.matches){if(Qe=Ln.matches,Me=Tm(Qe,_e),le(Me))return}else{X(Z,he,li(404,{pathname:_e}),{flushSync:se});return}}W.set(Z,Te);let Ce=te,ut=(await xn("action",E,Le,[Me],Qe,Z))[Me.route.id];if(Le.signal.aborted){W.get(Z)===Te&&W.delete(Z);return}if(h.v7_fetcherPersist&&pe.has(Z)){if(Iu(ut)||Fi(ut)){B(Z,Dl(void 0));return}}else{if(Iu(ut))if(W.delete(Z),O>Ce){B(Z,Dl(void 0));return}else return H.add(Z),B(Z,rm(J)),kt(Le,ut,!1,{fetcherSubmission:J,preventScrollReset:ye});if(Fi(ut)){X(Z,he,ut.error);return}}if(Xl(ut))throw li(400,{type:"defer-action"});let Nt=E.navigation.location||E.location,vn=Ad(t.history,Nt,Te.signal),es=l||o,Vn=E.navigation.state!=="idle"?gu(es,E.navigation.location,c):E.matches;Zt(Vn,"Didn't find any matches after fetcher action");let Wr=++te;V.set(Z,Wr);let Ei=rm(J,ut.data);E.fetchers.set(Z,Ei);let[Us,ri]=tj(t.history,E,Vn,J,Nt,!1,h.v7_skipActionErrorRevalidation,U,K,q,pe,L,H,es,c,[Me.route.id,ut]);ri.filter(Ln=>Ln.key!==Z).forEach(Ln=>{let ii=Ln.key,_o=E.fetchers.get(ii),Qo=rm(void 0,_o?_o.data:void 0);E.fetchers.set(ii,Qo),ce(ii),Ln.controller&&W.set(ii,Ln.controller)}),fe({fetchers:new Map(E.fetchers)});let Bs=()=>ri.forEach(Ln=>ce(Ln.key));Te.signal.addEventListener("abort",Bs);let{loaderResults:us,fetcherResults:Jt}=await re(E,Vn,Us,ri,vn);if(Te.signal.aborted)return;Te.signal.removeEventListener("abort",Bs),V.delete(Z),W.delete(Z),ri.forEach(Ln=>W.delete(Ln.key));let Pn=Oy(us);if(Pn)return kt(vn,Pn.result,!1,{preventScrollReset:ye});if(Pn=Oy(Jt),Pn)return H.add(Pn.key),kt(vn,Pn.result,!1,{preventScrollReset:ye});let{loaderData:si,errors:Ti}=oj(E,Vn,us,void 0,ri,Jt,xe);if(E.fetchers.has(Z)){let Ln=Dl(ut.data);E.fetchers.set(Z,Ln)}Be(Wr),E.navigation.state==="loading"&&Wr>O?(Zt(I,"Expected pending action"),A&&A.abort(),je(E.navigation.location,{matches:Vn,loaderData:si,errors:Ti,fetchers:new Map(E.fetchers)})):(fe({errors:Ti,loaderData:aj(E.loaderData,si,Vn,Ti),fetchers:new Map(E.fetchers)}),U=!1)}async function rn(Z,he,_e,Me,Qe,Q,se,ye,J){let le=E.fetchers.get(Z);B(Z,rm(J,le?le.data:void 0),{flushSync:se});let be=new AbortController,Te=Ad(t.history,_e,be.signal);if(Q){let ut=await Nn(Qe,new URL(Te.url).pathname,Te.signal,Z);if(ut.type==="aborted")return;if(ut.type==="error"){X(Z,he,ut.error,{flushSync:se});return}else if(ut.matches)Qe=ut.matches,Me=Tm(Qe,_e);else{X(Z,he,li(404,{pathname:_e}),{flushSync:se});return}}W.set(Z,be);let Le=te,it=(await xn("loader",E,Te,[Me],Qe,Z))[Me.route.id];if(Xl(it)&&(it=await bI(it,Te.signal,!0)||it),W.get(Z)===be&&W.delete(Z),!Te.signal.aborted){if(pe.has(Z)){B(Z,Dl(void 0));return}if(Iu(it))if(O>Le){B(Z,Dl(void 0));return}else{H.add(Z),await kt(Te,it,!1,{preventScrollReset:ye});return}if(Fi(it)){X(Z,he,it.error);return}Zt(!Xl(it),"Unhandled fetcher deferred data"),B(Z,Dl(it.data))}}async function kt(Z,he,_e,Me){let{submission:Qe,fetcherSubmission:Q,preventScrollReset:se,replace:ye}=Me===void 0?{}:Me;he.response.headers.has("X-Remix-Revalidate")&&(U=!0);let J=he.response.headers.get("Location");Zt(J,"Expected a Location header on the redirect Response"),J=sj(J,new URL(Z.url),c);let le=Up(E.location,J,{_isRedirect:!0});if(n){let ut=!1;if(he.response.headers.has("X-Remix-Reload-Document"))ut=!0;else if(wI.test(J)){const Nt=t.history.createURL(J);ut=Nt.origin!==e.location.origin||Pf(Nt.pathname,c)==null}if(ut){ye?e.location.replace(J):e.location.assign(J);return}}A=null;let be=ye===!0||he.response.headers.has("X-Remix-Replace")?Rr.Replace:Rr.Push,{formMethod:Te,formAction:Le,formEncType:Ce}=E.navigation;!Qe&&!Q&&Te&&Le&&Ce&&(Qe=dj(E.navigation));let it=Qe||Q;if(GJ.has(he.response.status)&&it&&ko(it.formMethod))await me(be,le,{submission:or({},it,{formAction:J}),preventScrollReset:se||P,enableViewTransition:_e?D:void 0});else{let ut=Y_(le,Qe);await me(be,le,{overrideNavigation:ut,fetcherSubmission:Q,preventScrollReset:se||P,enableViewTransition:_e?D:void 0})}}async function xn(Z,he,_e,Me,Qe,Q){let se,ye={};try{se=await QJ(u,Z,he,_e,Me,Qe,Q,i,s)}catch(J){return Me.forEach(le=>{ye[le.route.id]={type:Rn.error,error:J}}),ye}for(let[J,le]of Object.entries(se))if(sX(le)){let be=le.result;ye[J]={type:Rn.redirect,response:tX(be,_e,J,Qe,c,h.v7_relativeSplatPath)}}else ye[J]=await eX(le);return ye}async function re(Z,he,_e,Me,Qe){let Q=Z.matches,se=xn("loader",Z,Qe,_e,he,null),ye=Promise.all(Me.map(async be=>{if(be.matches&&be.match&&be.controller){let Le=(await xn("loader",Z,Ad(t.history,be.path,be.controller.signal),[be.match],be.matches,be.key))[be.match.route.id];return{[be.key]:Le}}else return Promise.resolve({[be.key]:{type:Rn.error,error:li(404,{pathname:be.path})}})})),J=await se,le=(await ye).reduce((be,Te)=>Object.assign(be,Te),{});return await Promise.all([aX(he,J,Qe.signal,Q,Z.loaderData),lX(he,le,Me)]),{loaderResults:J,fetcherResults:le}}function Se(){U=!0,K.push(...sn()),L.forEach((Z,he)=>{W.has(he)&&q.add(he),ce(he)})}function B(Z,he,_e){_e===void 0&&(_e={}),E.fetchers.set(Z,he),fe({fetchers:new Map(E.fetchers)},{flushSync:(_e&&_e.flushSync)===!0})}function X(Z,he,_e,Me){Me===void 0&&(Me={});let Qe=yu(E.matches,he);Y(Z),fe({errors:{[Qe.route.id]:_e},fetchers:new Map(E.fetchers)},{flushSync:(Me&&Me.flushSync)===!0})}function ne(Z){return ee.set(Z,(ee.get(Z)||0)+1),pe.has(Z)&&pe.delete(Z),E.fetchers.get(Z)||WJ}function Y(Z){let he=E.fetchers.get(Z);W.has(Z)&&!(he&&he.state==="loading"&&V.has(Z))&&ce(Z),L.delete(Z),V.delete(Z),H.delete(Z),h.v7_fetcherPersist&&pe.delete(Z),q.delete(Z),E.fetchers.delete(Z)}function Ne(Z){let he=(ee.get(Z)||0)-1;he<=0?(ee.delete(Z),pe.add(Z),h.v7_fetcherPersist||Y(Z)):ee.set(Z,he),fe({fetchers:new Map(E.fetchers)})}function ce(Z){let he=W.get(Z);he&&(he.abort(),W.delete(Z))}function Ee(Z){for(let he of Z){let _e=ne(he),Me=Dl(_e.data);E.fetchers.set(he,Me)}}function Re(){let Z=[],he=!1;for(let _e of H){let Me=E.fetchers.get(_e);Zt(Me,"Expected fetcher: "+_e),Me.state==="loading"&&(H.delete(_e),Z.push(_e),he=!0)}return Ee(Z),he}function Be(Z){let he=[];for(let[_e,Me]of V)if(Me<Z){let Qe=E.fetchers.get(_e);Zt(Qe,"Expected fetcher: "+_e),Qe.state==="loading"&&(ce(_e),V.delete(_e),he.push(_e))}return Ee(he),he.length>0}function _t(Z,he){let _e=E.blockers.get(Z)||nm;return we.get(Z)!==he&&we.set(Z,he),_e}function mt(Z){E.blockers.delete(Z),we.delete(Z)}function Ht(Z,he){let _e=E.blockers.get(Z)||nm;Zt(_e.state==="unblocked"&&he.state==="blocked"||_e.state==="blocked"&&he.state==="blocked"||_e.state==="blocked"&&he.state==="proceeding"||_e.state==="blocked"&&he.state==="unblocked"||_e.state==="proceeding"&&he.state==="unblocked","Invalid blocker state transition: "+_e.state+" -> "+he.state);let Me=new Map(E.blockers);Me.set(Z,he),fe({blockers:Me})}function tn(Z){let{currentLocation:he,nextLocation:_e,historyAction:Me}=Z;if(we.size===0)return;we.size>1&&Qh(!1,"A router only supports one blocker at a time");let Qe=Array.from(we.entries()),[Q,se]=Qe[Qe.length-1],ye=E.blockers.get(Q);if(!(ye&&ye.state==="proceeding")&&se({currentLocation:he,nextLocation:_e,historyAction:Me}))return Q}function Rt(Z){let he=li(404,{pathname:Z}),_e=l||o,{matches:Me,route:Qe}=cj(_e);return sn(),{notFoundMatches:Me,route:Qe,error:he}}function sn(Z){let he=[];return xe.forEach((_e,Me)=>{(!Z||Z(Me))&&(_e.cancel(),he.push(Me),xe.delete(Me))}),he}function In(Z,he,_e){if(g=Z,w=he,x=_e||null,!v&&E.navigation===K_){v=!0;let Me=wr(E.location,E.matches);Me!=null&&fe({restoreScrollPosition:Me})}return()=>{g=null,w=null,x=null}}function Fr(Z,he){return x&&x(Z,he.map(Me=>_J(Me,E.loaderData)))||Z.key}function zn(Z,he){if(g&&w){let _e=Fr(Z,he);g[_e]=w()}}function wr(Z,he){if(g){let _e=Fr(Z,he),Me=g[_e];if(typeof Me=="number")return Me}return null}function un(Z,he,_e){if(d)if(Z){if(Object.keys(Z[0].params).length>0)return{active:!0,matches:zx(he,_e,c,!0)}}else return{active:!0,matches:zx(he,_e,c,!0)||[]};return{active:!1,matches:null}}async function Nn(Z,he,_e,Me){if(!d)return{type:"success",matches:Z};let Qe=Z;for(;;){let Q=l==null,se=l||o,ye=i;try{await d({signal:_e,path:he,matches:Qe,fetcherKey:Me,patch:(be,Te)=>{_e.aborted||rj(be,Te,se,ye,s)}})}catch(be){return{type:"error",error:be,partialMatches:Qe}}finally{Q&&!_e.aborted&&(o=[...o])}if(_e.aborted)return{type:"aborted"};let J=gu(se,he,c);if(J)return{type:"success",matches:J};let le=zx(se,he,c,!0);if(!le||Qe.length===le.length&&Qe.every((be,Te)=>be.route.id===le[Te].route.id))return{type:"success",matches:null};Qe=le}}function dn(Z){i={},l=Kv(Z,s,void 0,i)}function cs(Z,he){let _e=l==null;rj(Z,he,l||o,i,s),_e&&(o=[...o],fe({}))}return k={get basename(){return c},get future(){return h},get state(){return E},get routes(){return o},get window(){return e},initialize:Fe,subscribe:Ge,enableScrollRestoration:In,navigate:ie,fetch:Sn,revalidate:$e,createHref:Z=>t.history.createHref(Z),encodeLocation:Z=>t.history.encodeLocation(Z),getFetcher:ne,deleteFetcher:Ne,dispose:Ve,getBlocker:_t,deleteBlocker:mt,patchRoutes:cs,_internalFetchControllers:W,_internalActiveDeferreds:xe,_internalSetRoutes:dn},k}function KJ(t){return t!=null&&("formData"in t&&t.formData!=null||"body"in t&&t.body!==void 0)}function fE(t,e,n,r,s,i,o,l){let c,u;if(o){c=[];for(let h of e)if(c.push(h),h.route.id===o){u=h;break}}else c=e,u=e[e.length-1];let d=N0(s||".",I0(c,i),Pf(t.pathname,n)||t.pathname,l==="path");if(s==null&&(d.search=t.search,d.hash=t.hash),(s==null||s===""||s===".")&&u){let h=_I(d.search);if(u.route.index&&!h)d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index";else if(!u.route.index&&h){let f=new URLSearchParams(d.search),m=f.getAll("index");f.delete("index"),m.filter(x=>x).forEach(x=>f.append("index",x));let g=f.toString();d.search=g?"?"+g:""}}return r&&n!=="/"&&(d.pathname=d.pathname==="/"?n:Ya([n,d.pathname])),Ku(d)}function ZR(t,e,n,r){if(!r||!KJ(r))return{path:n};if(r.formMethod&&!oX(r.formMethod))return{path:n,error:li(405,{method:r.formMethod})};let s=()=>({path:n,error:li(400,{type:"invalid-body"})}),i=r.formMethod||"get",o=t?i.toUpperCase():i.toLowerCase(),l=MV(n);if(r.body!==void 0){if(r.formEncType==="text/plain"){if(!ko(o))return s();let f=typeof r.body=="string"?r.body:r.body instanceof FormData||r.body instanceof URLSearchParams?Array.from(r.body.entries()).reduce((m,g)=>{let[x,w]=g;return""+m+x+"="+w+`
`},""):String(r.body);return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:void 0,text:f}}}else if(r.formEncType==="application/json"){if(!ko(o))return s();try{let f=typeof r.body=="string"?JSON.parse(r.body):r.body;return{path:n,submission:{formMethod:o,formAction:l,formEncType:r.formEncType,formData:void 0,json:f,text:void 0}}}catch{return s()}}}Zt(typeof FormData=="function","FormData is not available in this environment");let c,u;if(r.formData)c=pE(r.formData),u=r.formData;else if(r.body instanceof FormData)c=pE(r.body),u=r.body;else if(r.body instanceof URLSearchParams)c=r.body,u=ij(c);else if(r.body==null)c=new URLSearchParams,u=new FormData;else try{c=new URLSearchParams(r.body),u=ij(c)}catch{return s()}let d={formMethod:o,formAction:l,formEncType:r&&r.formEncType||"application/x-www-form-urlencoded",formData:u,json:void 0,text:void 0};if(ko(d.formMethod))return{path:n,submission:d};let h=vl(n);return e&&h.search&&_I(h.search)&&c.append("index",""),h.search="?"+c,{path:Ku(h),submission:d}}function ej(t,e,n){n===void 0&&(n=!1);let r=t.findIndex(s=>s.route.id===e);return r>=0?t.slice(0,n?r+1:r):t}function tj(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x){let w=x?Fi(x[1])?x[1].error:x[1].data:void 0,v=t.createURL(e.location),_=t.createURL(s),C=n;i&&e.errors?C=ej(n,Object.keys(e.errors)[0],!0):x&&Fi(x[1])&&(C=ej(n,x[0]));let T=x?x[1].statusCode:void 0,R=o&&T&&T>=400,k=C.filter((I,P)=>{let{route:A}=I;if(A.lazy)return!0;if(A.loader==null)return!1;if(i)return mE(A,e.loaderData,e.errors);if(YJ(e.loaderData,e.matches[P],I)||c.some(M=>M===I.route.id))return!0;let D=e.matches[P],j=I;return nj(I,or({currentUrl:v,currentParams:D.params,nextUrl:_,nextParams:j.params},r,{actionResult:w,actionStatus:T,defaultShouldRevalidate:R?!1:l||v.pathname+v.search===_.pathname+_.search||v.search!==_.search||jV(D,j)}))}),E=[];return h.forEach((I,P)=>{if(i||!n.some(z=>z.route.id===I.routeId)||d.has(P))return;let A=gu(m,I.path,g);if(!A){E.push({key:P,routeId:I.routeId,path:I.path,matches:null,match:null,controller:null});return}let D=e.fetchers.get(P),j=Tm(A,I.path),M=!1;f.has(P)?M=!1:u.has(P)?(u.delete(P),M=!0):D&&D.state!=="idle"&&D.data===void 0?M=l:M=nj(j,or({currentUrl:v,currentParams:e.matches[e.matches.length-1].params,nextUrl:_,nextParams:n[n.length-1].params},r,{actionResult:w,actionStatus:T,defaultShouldRevalidate:R?!1:l})),M&&E.push({key:P,routeId:I.routeId,path:I.path,matches:A,match:j,controller:new AbortController})}),[k,E]}function mE(t,e,n){if(t.lazy)return!0;if(!t.loader)return!1;let r=e!=null&&e[t.id]!==void 0,s=n!=null&&n[t.id]!==void 0;return!r&&s?!1:typeof t.loader=="function"&&t.loader.hydrate===!0?!0:!r&&!s}function YJ(t,e,n){let r=!e||n.route.id!==e.route.id,s=t[n.route.id]===void 0;return r||s}function jV(t,e){let n=t.route.path;return t.pathname!==e.pathname||n!=null&&n.endsWith("*")&&t.params["*"]!==e.params["*"]}function nj(t,e){if(t.route.shouldRevalidate){let n=t.route.shouldRevalidate(e);if(typeof n=="boolean")return n}return e.defaultShouldRevalidate}function rj(t,e,n,r,s){var i;let o;if(t){let u=r[t];Zt(u,"No route found to patch children into: routeId = "+t),u.children||(u.children=[]),o=u.children}else o=n;let l=e.filter(u=>!o.some(d=>DV(u,d))),c=Kv(l,s,[t||"_","patch",String(((i=o)==null?void 0:i.length)||"0")],r);o.push(...c)}function DV(t,e){return"id"in t&&"id"in e&&t.id===e.id?!0:t.index===e.index&&t.path===e.path&&t.caseSensitive===e.caseSensitive?(!t.children||t.children.length===0)&&(!e.children||e.children.length===0)?!0:t.children.every((n,r)=>{var s;return(s=e.children)==null?void 0:s.some(i=>DV(n,i))}):!1}async function JJ(t,e,n){if(!t.lazy)return;let r=await t.lazy();if(!t.lazy)return;let s=n[t.id];Zt(s,"No route found in manifest");let i={};for(let o in r){let c=s[o]!==void 0&&o!=="hasErrorBoundary";Qh(!c,'Route "'+s.id+'" has a static property "'+o+'" defined but its lazy function is also returning a value for this property. '+('The lazy route property "'+o+'" will be ignored.')),!c&&!wJ.has(o)&&(i[o]=r[o])}Object.assign(s,i),Object.assign(s,or({},e(s),{lazy:void 0}))}async function XJ(t){let{matches:e}=t,n=e.filter(s=>s.shouldLoad);return(await Promise.all(n.map(s=>s.resolve()))).reduce((s,i,o)=>Object.assign(s,{[n[o].route.id]:i}),{})}async function QJ(t,e,n,r,s,i,o,l,c,u){let d=i.map(m=>m.route.lazy?JJ(m.route,c,l):void 0),h=i.map((m,g)=>{let x=d[g],w=s.some(_=>_.route.id===m.route.id);return or({},m,{shouldLoad:w,resolve:async _=>(_&&r.method==="GET"&&(m.route.lazy||m.route.loader)&&(w=!0),w?ZJ(e,r,m,x,_,u):Promise.resolve({type:Rn.data,result:void 0}))})}),f=await t({matches:h,request:r,params:i[0].params,fetcherKey:o,context:u});try{await Promise.all(d)}catch{}return f}async function ZJ(t,e,n,r,s,i){let o,l,c=u=>{let d,h=new Promise((g,x)=>d=x);l=()=>d(),e.signal.addEventListener("abort",l);let f=g=>typeof u!="function"?Promise.reject(new Error("You cannot call the handler for a route which defines a boolean "+('"'+t+'" [routeId: '+n.route.id+"]"))):u({request:e,params:n.params,context:i},...g!==void 0?[g]:[]),m=(async()=>{try{return{type:"data",result:await(s?s(x=>f(x)):f())}}catch(g){return{type:"error",result:g}}})();return Promise.race([m,h])};try{let u=n.route[t];if(r)if(u){let d,[h]=await Promise.all([c(u).catch(f=>{d=f}),r]);if(d!==void 0)throw d;o=h}else if(await r,u=n.route[t],u)o=await c(u);else if(t==="action"){let d=new URL(e.url),h=d.pathname+d.search;throw li(405,{method:e.method,pathname:h,routeId:n.route.id})}else return{type:Rn.data,result:void 0};else if(u)o=await c(u);else{let d=new URL(e.url),h=d.pathname+d.search;throw li(404,{pathname:h})}Zt(o.result!==void 0,"You defined "+(t==="action"?"an action":"a loader")+" for route "+('"'+n.route.id+"\" but didn't return anything from your `"+t+"` ")+"function. Please return a value or `null`.")}catch(u){return{type:Rn.error,result:u}}finally{l&&e.signal.removeEventListener("abort",l)}return o}async function eX(t){let{result:e,type:n}=t;if(LV(e)){let h;try{let f=e.headers.get("Content-Type");f&&/\bapplication\/json\b/.test(f)?e.body==null?h=null:h=await e.json():h=await e.text()}catch(f){return{type:Rn.error,error:f}}return n===Rn.error?{type:Rn.error,error:new Yv(e.status,e.statusText,h),statusCode:e.status,headers:e.headers}:{type:Rn.data,data:h,statusCode:e.status,headers:e.headers}}if(n===Rn.error){if(uj(e)){var r,s;if(e.data instanceof Error){var i,o;return{type:Rn.error,error:e.data,statusCode:(i=e.init)==null?void 0:i.status,headers:(o=e.init)!=null&&o.headers?new Headers(e.init.headers):void 0}}return{type:Rn.error,error:new Yv(((r=e.init)==null?void 0:r.status)||500,void 0,e.data),statusCode:Bp(e)?e.status:void 0,headers:(s=e.init)!=null&&s.headers?new Headers(e.init.headers):void 0}}return{type:Rn.error,error:e,statusCode:Bp(e)?e.status:void 0}}if(iX(e)){var l,c;return{type:Rn.deferred,deferredData:e,statusCode:(l=e.init)==null?void 0:l.status,headers:((c=e.init)==null?void 0:c.headers)&&new Headers(e.init.headers)}}if(uj(e)){var u,d;return{type:Rn.data,data:e.data,statusCode:(u=e.init)==null?void 0:u.status,headers:(d=e.init)!=null&&d.headers?new Headers(e.init.headers):void 0}}return{type:Rn.data,data:e}}function tX(t,e,n,r,s,i){let o=t.headers.get("Location");if(Zt(o,"Redirects returned/thrown from loaders/actions must have a Location header"),!wI.test(o)){let l=r.slice(0,r.findIndex(c=>c.route.id===n)+1);o=fE(new URL(e.url),l,s,!0,o,i),t.headers.set("Location",o)}return t}function sj(t,e,n){if(wI.test(t)){let r=t,s=r.startsWith("//")?new URL(e.protocol+r):new URL(r),i=Pf(s.pathname,n)!=null;if(s.origin===e.origin&&i)return s.pathname+s.search+s.hash}return t}function Ad(t,e,n,r){let s=t.createURL(MV(e)).toString(),i={signal:n};if(r&&ko(r.formMethod)){let{formMethod:o,formEncType:l}=r;i.method=o.toUpperCase(),l==="application/json"?(i.headers=new Headers({"Content-Type":l}),i.body=JSON.stringify(r.json)):l==="text/plain"?i.body=r.text:l==="application/x-www-form-urlencoded"&&r.formData?i.body=pE(r.formData):i.body=r.formData}return new Request(s,i)}function pE(t){let e=new URLSearchParams;for(let[n,r]of t.entries())e.append(n,typeof r=="string"?r:r.name);return e}function ij(t){let e=new FormData;for(let[n,r]of t.entries())e.append(n,r);return e}function nX(t,e,n,r,s){let i={},o=null,l,c=!1,u={},d=n&&Fi(n[1])?n[1].error:void 0;return t.forEach(h=>{if(!(h.route.id in e))return;let f=h.route.id,m=e[f];if(Zt(!Iu(m),"Cannot handle redirect results in processLoaderData"),Fi(m)){let g=m.error;if(d!==void 0&&(g=d,d=void 0),o=o||{},s)o[f]=g;else{let x=yu(t,f);o[x.route.id]==null&&(o[x.route.id]=g)}i[f]=void 0,c||(c=!0,l=Bp(m.error)?m.error.status:500),m.headers&&(u[f]=m.headers)}else Xl(m)?(r.set(f,m.deferredData),i[f]=m.deferredData.data,m.statusCode!=null&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers)):(i[f]=m.data,m.statusCode&&m.statusCode!==200&&!c&&(l=m.statusCode),m.headers&&(u[f]=m.headers))}),d!==void 0&&n&&(o={[n[0]]:d},i[n[0]]=void 0),{loaderData:i,errors:o,statusCode:l||200,loaderHeaders:u}}function oj(t,e,n,r,s,i,o){let{loaderData:l,errors:c}=nX(e,n,r,o,!1);return s.forEach(u=>{let{key:d,match:h,controller:f}=u,m=i[d];if(Zt(m,"Did not find corresponding fetcher result"),!(f&&f.signal.aborted))if(Fi(m)){let g=yu(t.matches,h==null?void 0:h.route.id);c&&c[g.route.id]||(c=or({},c,{[g.route.id]:m.error})),t.fetchers.delete(d)}else if(Iu(m))Zt(!1,"Unhandled fetcher revalidation redirect");else if(Xl(m))Zt(!1,"Unhandled fetcher deferred data");else{let g=Dl(m.data);t.fetchers.set(d,g)}}),{loaderData:l,errors:c}}function aj(t,e,n,r){let s=or({},e);for(let i of n){let o=i.route.id;if(e.hasOwnProperty(o)?e[o]!==void 0&&(s[o]=e[o]):t[o]!==void 0&&i.route.loader&&(s[o]=t[o]),r&&r.hasOwnProperty(o))break}return s}function lj(t){return t?Fi(t[1])?{actionData:{}}:{actionData:{[t[0]]:t[1].data}}:{}}function yu(t,e){return(e?t.slice(0,t.findIndex(r=>r.route.id===e)+1):[...t]).reverse().find(r=>r.route.hasErrorBoundary===!0)||t[0]}function cj(t){let e=t.length===1?t[0]:t.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:e}],route:e}}function li(t,e){let{pathname:n,routeId:r,method:s,type:i,message:o}=e===void 0?{}:e,l="Unknown Server Error",c="Unknown @remix-run/router error";return t===400?(l="Bad Request",s&&n&&r?c="You made a "+s+' request to "'+n+'" but '+('did not provide a `loader` for route "'+r+'", ')+"so there is no way to handle the request.":i==="defer-action"?c="defer() is not supported in actions":i==="invalid-body"&&(c="Unable to encode submission body")):t===403?(l="Forbidden",c='Route "'+r+'" does not match URL "'+n+'"'):t===404?(l="Not Found",c='No route matches URL "'+n+'"'):t===405&&(l="Method Not Allowed",s&&n&&r?c="You made a "+s.toUpperCase()+' request to "'+n+'" but '+('did not provide an `action` for route "'+r+'", ')+"so there is no way to handle the request.":s&&(c='Invalid request method "'+s.toUpperCase()+'"')),new Yv(t||500,l,new Error(c),!0)}function Oy(t){let e=Object.entries(t);for(let n=e.length-1;n>=0;n--){let[r,s]=e[n];if(Iu(s))return{key:r,result:s}}}function MV(t){let e=typeof t=="string"?vl(t):t;return Ku(or({},e,{hash:""}))}function rX(t,e){return t.pathname!==e.pathname||t.search!==e.search?!1:t.hash===""?e.hash!=="":t.hash===e.hash?!0:e.hash!==""}function sX(t){return LV(t.result)&&zJ.has(t.result.status)}function Xl(t){return t.type===Rn.deferred}function Fi(t){return t.type===Rn.error}function Iu(t){return(t&&t.type)===Rn.redirect}function uj(t){return typeof t=="object"&&t!=null&&"type"in t&&"data"in t&&"init"in t&&t.type==="DataWithResponseInit"}function iX(t){let e=t;return e&&typeof e=="object"&&typeof e.data=="object"&&typeof e.subscribe=="function"&&typeof e.cancel=="function"&&typeof e.resolveData=="function"}function LV(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.headers=="object"&&typeof t.body<"u"}function oX(t){return BJ.has(t.toLowerCase())}function ko(t){return VJ.has(t.toLowerCase())}async function aX(t,e,n,r,s){let i=Object.entries(e);for(let o=0;o<i.length;o++){let[l,c]=i[o],u=t.find(f=>(f==null?void 0:f.route.id)===l);if(!u)continue;let d=r.find(f=>f.route.id===u.route.id),h=d!=null&&!jV(d,u)&&(s&&s[u.route.id])!==void 0;Xl(c)&&h&&await bI(c,n,!1).then(f=>{f&&(e[l]=f)})}}async function lX(t,e,n){for(let r=0;r<n.length;r++){let{key:s,routeId:i,controller:o}=n[r],l=e[s];t.find(u=>(u==null?void 0:u.route.id)===i)&&Xl(l)&&(Zt(o,"Expected an AbortController for revalidating fetcher deferred result"),await bI(l,o.signal,!0).then(u=>{u&&(e[s]=u)}))}}async function bI(t,e,n){if(n===void 0&&(n=!1),!await t.deferredData.resolveData(e)){if(n)try{return{type:Rn.data,data:t.deferredData.unwrappedData}}catch(s){return{type:Rn.error,error:s}}return{type:Rn.data,data:t.deferredData.data}}}function _I(t){return new URLSearchParams(t).getAll("index").some(e=>e==="")}function Tm(t,e){let n=typeof e=="string"?vl(e).search:e.search;if(t[t.length-1].route.index&&_I(n||""))return t[t.length-1];let r=AV(t);return r[r.length-1]}function dj(t){let{formMethod:e,formAction:n,formEncType:r,text:s,formData:i,json:o}=t;if(!(!e||!n||!r)){if(s!=null)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:void 0,text:s};if(i!=null)return{formMethod:e,formAction:n,formEncType:r,formData:i,json:void 0,text:void 0};if(o!==void 0)return{formMethod:e,formAction:n,formEncType:r,formData:void 0,json:o,text:void 0}}}function Y_(t,e){return e?{state:"loading",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}:{state:"loading",location:t,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function cX(t,e){return{state:"submitting",location:t,formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text}}function rm(t,e){return t?{state:"loading",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function uX(t,e){return{state:"submitting",formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text,data:e?e.data:void 0}}function Dl(t){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function dX(t,e){try{let n=t.sessionStorage.getItem(RV);if(n){let r=JSON.parse(n);for(let[s,i]of Object.entries(r||{}))i&&Array.isArray(i)&&e.set(s,new Set(i||[]))}}catch{}}function hX(t,e){if(e.size>0){let n={};for(let[r,s]of e)n[r]=[...s];try{t.sessionStorage.setItem(RV,JSON.stringify(n))}catch(r){Qh(!1,"Failed to save applied view transitions in sessionStorage ("+r+").")}}}/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function zp(){return zp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},zp.apply(this,arguments)}const P0=p.createContext(null),FV=p.createContext(null),Lc=p.createContext(null),A0=p.createContext(null),Pa=p.createContext({outlet:null,matches:[],isDataRoute:!1}),OV=p.createContext(null);function fX(t,e){let{relative:n}=e===void 0?{}:e;Af()||Zt(!1);let{basename:r,navigator:s}=p.useContext(Lc),{hash:i,pathname:o,search:l}=VV(t,{relative:n}),c=o;return r!=="/"&&(c=o==="/"?r:Ya([r,o])),s.createHref({pathname:c,search:l,hash:i})}function Af(){return p.useContext(A0)!=null}function wl(){return Af()||Zt(!1),p.useContext(A0).location}function $V(t){p.useContext(Lc).static||p.useLayoutEffect(t)}function wi(){let{isDataRoute:t}=p.useContext(Pa);return t?IX():mX()}function mX(){Af()||Zt(!1);let t=p.useContext(P0),{basename:e,future:n,navigator:r}=p.useContext(Lc),{matches:s}=p.useContext(Pa),{pathname:i}=wl(),o=JSON.stringify(I0(s,n.v7_relativeSplatPath)),l=p.useRef(!1);return $V(()=>{l.current=!0}),p.useCallback(function(u,d){if(d===void 0&&(d={}),!l.current)return;if(typeof u=="number"){r.go(u);return}let h=N0(u,JSON.parse(o),i,d.relative==="path");t==null&&e!=="/"&&(h.pathname=h.pathname==="/"?e:Ya([e,h.pathname])),(d.replace?r.replace:r.push)(h,d.state,d)},[e,r,o,i,t])}const pX=p.createContext(null);function gX(t){let e=p.useContext(Pa).outlet;return e&&p.createElement(pX.Provider,{value:t},e)}function k0(){let{matches:t}=p.useContext(Pa),e=t[t.length-1];return e?e.params:{}}function VV(t,e){let{relative:n}=e===void 0?{}:e,{future:r}=p.useContext(Lc),{matches:s}=p.useContext(Pa),{pathname:i}=wl(),o=JSON.stringify(I0(s,r.v7_relativeSplatPath));return p.useMemo(()=>N0(t,JSON.parse(o),i,n==="path"),[t,o,i,n])}function yX(t,e,n,r){Af()||Zt(!1);let{navigator:s}=p.useContext(Lc),{matches:i}=p.useContext(Pa),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let u=wl(),d;if(e){var h;let w=typeof e=="string"?vl(e):e;c==="/"||(h=w.pathname)!=null&&h.startsWith(c)||Zt(!1),d=w}else d=u;let f=d.pathname||"/",m=f;if(c!=="/"){let w=c.replace(/^\//,"").split("/");m="/"+f.replace(/^\//,"").split("/").slice(w.length).join("/")}let g=gu(t,{pathname:m}),x=_X(g&&g.map(w=>Object.assign({},w,{params:Object.assign({},l,w.params),pathname:Ya([c,s.encodeLocation?s.encodeLocation(w.pathname).pathname:w.pathname]),pathnameBase:w.pathnameBase==="/"?c:Ya([c,s.encodeLocation?s.encodeLocation(w.pathnameBase).pathname:w.pathnameBase])})),i,n,r);return e&&x?p.createElement(A0.Provider,{value:{location:zp({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Rr.Pop}},x):x}function xX(){let t=TX(),e=Bp(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"},i=null;return p.createElement(p.Fragment,null,p.createElement("h2",null,"Unexpected Application Error!"),p.createElement("h3",{style:{fontStyle:"italic"}},e),n?p.createElement("pre",{style:s},n):null,i)}const vX=p.createElement(xX,null);class wX extends p.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,n){return n.location!==e.location||n.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:n.error,location:n.location,revalidation:e.revalidation||n.revalidation}}componentDidCatch(e,n){console.error("React Router caught the following error during render",e,n)}render(){return this.state.error!==void 0?p.createElement(Pa.Provider,{value:this.props.routeContext},p.createElement(OV.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function bX(t){let{routeContext:e,match:n,children:r}=t,s=p.useContext(P0);return s&&s.static&&s.staticContext&&(n.route.errorElement||n.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=n.route.id),p.createElement(Pa.Provider,{value:e},r)}function _X(t,e,n,r){var s;if(e===void 0&&(e=[]),n===void 0&&(n=null),r===void 0&&(r=null),t==null){var i;if(!n)return null;if(n.errors)t=n.matches;else if((i=r)!=null&&i.v7_partialHydration&&e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let o=t,l=(s=n)==null?void 0:s.errors;if(l!=null){let d=o.findIndex(h=>h.route.id&&(l==null?void 0:l[h.route.id])!==void 0);d>=0||Zt(!1),o=o.slice(0,Math.min(o.length,d+1))}let c=!1,u=-1;if(n&&r&&r.v7_partialHydration)for(let d=0;d<o.length;d++){let h=o[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(u=d),h.route.id){let{loaderData:f,errors:m}=n,g=h.route.loader&&f[h.route.id]===void 0&&(!m||m[h.route.id]===void 0);if(h.route.lazy||g){c=!0,u>=0?o=o.slice(0,u+1):o=[o[0]];break}}}return o.reduceRight((d,h,f)=>{let m,g=!1,x=null,w=null;n&&(m=l&&h.route.id?l[h.route.id]:void 0,x=h.route.errorElement||vX,c&&(u<0&&f===0?(NX("route-fallback",!1),g=!0,w=null):u===f&&(g=!0,w=h.route.hydrateFallbackElement||null)));let v=e.concat(o.slice(0,f+1)),_=()=>{let C;return m?C=x:g?C=w:h.route.Component?C=p.createElement(h.route.Component,null):h.route.element?C=h.route.element:C=d,p.createElement(bX,{match:h,routeContext:{outlet:d,matches:v,isDataRoute:n!=null},children:C})};return n&&(h.route.ErrorBoundary||h.route.errorElement||f===0)?p.createElement(wX,{location:n.location,revalidation:n.revalidation,component:x,error:m,children:_(),routeContext:{outlet:null,matches:v,isDataRoute:!0}}):_()},null)}var UV=function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t}(UV||{}),Jv=function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t}(Jv||{});function SX(t){let e=p.useContext(P0);return e||Zt(!1),e}function CX(t){let e=p.useContext(FV);return e||Zt(!1),e}function EX(t){let e=p.useContext(Pa);return e||Zt(!1),e}function BV(t){let e=EX(),n=e.matches[e.matches.length-1];return n.route.id||Zt(!1),n.route.id}function TX(){var t;let e=p.useContext(OV),n=CX(Jv.UseRouteError),r=BV(Jv.UseRouteError);return e!==void 0?e:(t=n.errors)==null?void 0:t[r]}function IX(){let{router:t}=SX(UV.UseNavigateStable),e=BV(Jv.UseNavigateStable),n=p.useRef(!1);return $V(()=>{n.current=!0}),p.useCallback(function(s,i){i===void 0&&(i={}),n.current&&(typeof s=="number"?t.navigate(s):t.navigate(s,zp({fromRouteId:e},i)))},[t,e])}const hj={};function NX(t,e,n){!e&&!hj[t]&&(hj[t]=!0)}function PX(t,e){t==null||t.v7_startTransition,(t==null?void 0:t.v7_relativeSplatPath)===void 0&&(!e||e.v7_relativeSplatPath),e&&(e.v7_fetcherPersist,e.v7_normalizeFormMethod,e.v7_partialHydration,e.v7_skipActionErrorRevalidation)}function zV(t){let{to:e,replace:n,state:r,relative:s}=t;Af()||Zt(!1);let{future:i,static:o}=p.useContext(Lc),{matches:l}=p.useContext(Pa),{pathname:c}=wl(),u=wi(),d=N0(e,I0(l,i.v7_relativeSplatPath),c,s==="path"),h=JSON.stringify(d);return p.useEffect(()=>u(JSON.parse(h),{replace:n,state:r,relative:s}),[u,h,s,n,r]),null}function AX(t){return gX(t.context)}function kX(t){let{basename:e="/",children:n=null,location:r,navigationType:s=Rr.Pop,navigator:i,static:o=!1,future:l}=t;Af()&&Zt(!1);let c=e.replace(/^\/*/,"/"),u=p.useMemo(()=>({basename:c,navigator:i,static:o,future:zp({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof r=="string"&&(r=vl(r));let{pathname:d="/",search:h="",hash:f="",state:m=null,key:g="default"}=r,x=p.useMemo(()=>{let w=Pf(d,c);return w==null?null:{location:{pathname:w,search:h,hash:f,state:m,key:g},navigationType:s}},[c,d,h,f,m,g,s]);return x==null?null:p.createElement(Lc.Provider,{value:u},p.createElement(A0.Provider,{children:n,value:x}))}new Promise(()=>{});function RX(t){let e={hasErrorBoundary:t.ErrorBoundary!=null||t.errorElement!=null};return t.Component&&Object.assign(e,{element:p.createElement(t.Component),Component:void 0}),t.HydrateFallback&&Object.assign(e,{hydrateFallbackElement:p.createElement(t.HydrateFallback),HydrateFallback:void 0}),t.ErrorBoundary&&Object.assign(e,{errorElement:p.createElement(t.ErrorBoundary),ErrorBoundary:void 0}),e}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Gp(){return Gp=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Gp.apply(this,arguments)}function jX(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function DX(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function MX(t,e){return t.button===0&&(!e||e==="_self")&&!DX(t)}const LX=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],FX="6";try{window.__reactRouterVersion=FX}catch{}function OX(t,e){return qJ({basename:e==null?void 0:e.basename,future:Gp({},e==null?void 0:e.future,{v7_prependBasename:!0}),history:yJ({window:e==null?void 0:e.window}),hydrationData:(e==null?void 0:e.hydrationData)||$X(),routes:t,mapRouteProperties:RX,dataStrategy:e==null?void 0:e.dataStrategy,patchRoutesOnNavigation:e==null?void 0:e.patchRoutesOnNavigation,window:e==null?void 0:e.window}).initialize()}function $X(){var t;let e=(t=window)==null?void 0:t.__staticRouterHydrationData;return e&&e.errors&&(e=Gp({},e,{errors:VX(e.errors)})),e}function VX(t){if(!t)return null;let e=Object.entries(t),n={};for(let[r,s]of e)if(s&&s.__type==="RouteErrorResponse")n[r]=new Yv(s.status,s.statusText,s.data,s.internal===!0);else if(s&&s.__type==="Error"){if(s.__subType){let i=window[s.__subType];if(typeof i=="function")try{let o=new i(s.message);o.stack="",n[r]=o}catch{}}if(n[r]==null){let i=new Error(s.message);i.stack="",n[r]=i}}else n[r]=s;return n}const UX=p.createContext({isTransitioning:!1}),BX=p.createContext(new Map),zX="startTransition",fj=d0[zX],GX="flushSync",mj=gJ[GX];function WX(t){fj?fj(t):t()}function sm(t){mj?mj(t):t()}let HX=class{constructor(){this.status="pending",this.promise=new Promise((e,n)=>{this.resolve=r=>{this.status==="pending"&&(this.status="resolved",e(r))},this.reject=r=>{this.status==="pending"&&(this.status="rejected",n(r))}})}};function qX(t){let{fallbackElement:e,router:n,future:r}=t,[s,i]=p.useState(n.state),[o,l]=p.useState(),[c,u]=p.useState({isTransitioning:!1}),[d,h]=p.useState(),[f,m]=p.useState(),[g,x]=p.useState(),w=p.useRef(new Map),{v7_startTransition:v}=r||{},_=p.useCallback(I=>{v?WX(I):I()},[v]),C=p.useCallback((I,P)=>{let{deletedFetchers:A,flushSync:D,viewTransitionOpts:j}=P;I.fetchers.forEach((z,U)=>{z.data!==void 0&&w.current.set(U,z.data)}),A.forEach(z=>w.current.delete(z));let M=n.window==null||n.window.document==null||typeof n.window.document.startViewTransition!="function";if(!j||M){D?sm(()=>i(I)):_(()=>i(I));return}if(D){sm(()=>{f&&(d&&d.resolve(),f.skipTransition()),u({isTransitioning:!0,flushSync:!0,currentLocation:j.currentLocation,nextLocation:j.nextLocation})});let z=n.window.document.startViewTransition(()=>{sm(()=>i(I))});z.finished.finally(()=>{sm(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})})}),sm(()=>m(z));return}f?(d&&d.resolve(),f.skipTransition(),x({state:I,currentLocation:j.currentLocation,nextLocation:j.nextLocation})):(l(I),u({isTransitioning:!0,flushSync:!1,currentLocation:j.currentLocation,nextLocation:j.nextLocation}))},[n.window,f,d,w,_]);p.useLayoutEffect(()=>n.subscribe(C),[n,C]),p.useEffect(()=>{c.isTransitioning&&!c.flushSync&&h(new HX)},[c]),p.useEffect(()=>{if(d&&o&&n.window){let I=o,P=d.promise,A=n.window.document.startViewTransition(async()=>{_(()=>i(I)),await P});A.finished.finally(()=>{h(void 0),m(void 0),l(void 0),u({isTransitioning:!1})}),m(A)}},[_,o,d,n.window]),p.useEffect(()=>{d&&o&&s.location.key===o.location.key&&d.resolve()},[d,f,s.location,o]),p.useEffect(()=>{!c.isTransitioning&&g&&(l(g.state),u({isTransitioning:!0,flushSync:!1,currentLocation:g.currentLocation,nextLocation:g.nextLocation}),x(void 0))},[c.isTransitioning,g]),p.useEffect(()=>{},[]);let T=p.useMemo(()=>({createHref:n.createHref,encodeLocation:n.encodeLocation,go:I=>n.navigate(I),push:(I,P,A)=>n.navigate(I,{state:P,preventScrollReset:A==null?void 0:A.preventScrollReset}),replace:(I,P,A)=>n.navigate(I,{replace:!0,state:P,preventScrollReset:A==null?void 0:A.preventScrollReset})}),[n]),R=n.basename||"/",k=p.useMemo(()=>({router:n,navigator:T,static:!1,basename:R}),[n,T,R]),E=p.useMemo(()=>({v7_relativeSplatPath:n.future.v7_relativeSplatPath}),[n.future.v7_relativeSplatPath]);return p.useEffect(()=>PX(r,n.future),[r,n.future]),p.createElement(p.Fragment,null,p.createElement(P0.Provider,{value:k},p.createElement(FV.Provider,{value:s},p.createElement(BX.Provider,{value:w.current},p.createElement(UX.Provider,{value:c},p.createElement(kX,{basename:R,location:s.location,navigationType:s.historyAction,navigator:T,future:E},s.initialized||n.future.v7_partialHydration?p.createElement(KX,{routes:n.routes,future:n.future,state:s}):e))))),null)}const KX=p.memo(YX);function YX(t){let{routes:e,future:n,state:r}=t;return yX(e,void 0,r,n)}const JX=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",XX=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,ir=p.forwardRef(function(e,n){let{onClick:r,relative:s,reloadDocument:i,replace:o,state:l,target:c,to:u,preventScrollReset:d,viewTransition:h}=e,f=jX(e,LX),{basename:m}=p.useContext(Lc),g,x=!1;if(typeof u=="string"&&XX.test(u)&&(g=u,JX))try{let C=new URL(window.location.href),T=u.startsWith("//")?new URL(C.protocol+u):new URL(u),R=Pf(T.pathname,m);T.origin===C.origin&&R!=null?u=R+T.search+T.hash:x=!0}catch{}let w=fX(u,{relative:s}),v=QX(u,{replace:o,state:l,target:c,preventScrollReset:d,relative:s,viewTransition:h});function _(C){r&&r(C),C.defaultPrevented||v(C)}return p.createElement("a",Gp({},f,{href:g||w,onClick:x||i?r:_,ref:n,target:c}))});var pj;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(pj||(pj={}));var gj;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(gj||(gj={}));function QX(t,e){let{target:n,replace:r,state:s,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=wi(),u=wl(),d=VV(t,{relative:o});return p.useCallback(h=>{if(MX(h,n)){h.preventDefault();let f=r!==void 0?r:Ku(u)===Ku(d);c(t,{replace:f,state:s,preventScrollReset:i,relative:o,viewTransition:l})}},[u,c,d,r,s,n,t,i,o,l])}var ZX="@vercel/analytics",eQ="1.5.0",tQ=()=>{window.va||(window.va=function(...e){(window.vaq=window.vaq||[]).push(e)})};function GV(){return typeof window<"u"}function WV(){try{const t="production"}catch{}return"production"}function nQ(t="auto"){if(t==="auto"){window.vam=WV();return}window.vam=t}function rQ(){return(GV()?window.vam:WV())||"production"}function gE(){return rQ()==="development"}function sQ(t){return t.scriptSrc?t.scriptSrc:gE()?"https://va.vercel-scripts.com/v1/script.debug.js":t.basePath?`${t.basePath}/insights/script.js`:"/_vercel/insights/script.js"}function iQ(t={debug:!0}){var e;if(!GV())return;nQ(t.mode),tQ(),t.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",t.beforeSend));const n=sQ(t);if(document.head.querySelector(`script[src*="${n}"]`))return;const r=document.createElement("script");r.src=n,r.defer=!0,r.dataset.sdkn=ZX+(t.framework?`/${t.framework}`:""),r.dataset.sdkv=eQ,t.disableAutoTrack&&(r.dataset.disableAutoTrack="1"),t.endpoint?r.dataset.endpoint=t.endpoint:t.basePath&&(r.dataset.endpoint=`${t.basePath}/insights`),t.dsn&&(r.dataset.dsn=t.dsn),r.onerror=()=>{const s=gE()?"Please check if any ad blockers are enabled and try again.":"Be sure to enable Web Analytics for your project and deploy again. See https://vercel.com/docs/analytics/quickstart for more information.";console.log(`[Vercel Web Analytics] Failed to load script from ${n}. ${s}`)},gE()&&t.debug===!1&&(r.dataset.debug="false"),document.head.appendChild(r)}function oQ({route:t,path:e}){var n;(n=window.va)==null||n.call(window,"pageview",{route:t,path:e})}function aQ(){if(!(typeof process>"u"||typeof process.env>"u"))return{}.REACT_APP_VERCEL_OBSERVABILITY_BASEPATH}function lQ(t){return p.useEffect(()=>{var e;t.beforeSend&&((e=window.va)==null||e.call(window,"beforeSend",t.beforeSend))},[t.beforeSend]),p.useEffect(()=>{iQ({framework:t.framework||"react",basePath:t.basePath??aQ(),...t.route!==void 0&&{disableAutoTrack:!0},...t})},[]),p.useEffect(()=>{t.route&&t.path&&oQ({route:t.route,path:t.path})},[t.route,t.path]),null}function HV(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=HV(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function qV(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=HV(t))&&(r&&(r+=" "),r+=e);return r}function cQ(){for(var t=0,e,n,r="";t<arguments.length;)(e=arguments[t++])&&(n=KV(e))&&(r&&(r+=" "),r+=n);return r}function KV(t){if(typeof t=="string")return t;for(var e,n="",r=0;r<t.length;r++)t[r]&&(e=KV(t[r]))&&(n&&(n+=" "),n+=e);return n}var SI="-";function uQ(t){var e=hQ(t),n=t.conflictingClassGroups,r=t.conflictingClassGroupModifiers,s=r===void 0?{}:r;function i(l){var c=l.split(SI);return c[0]===""&&c.length!==1&&c.shift(),YV(c,e)||dQ(l)}function o(l,c){var u=n[l]||[];return c&&s[l]?[].concat(u,s[l]):u}return{getClassGroupId:i,getConflictingClassGroupIds:o}}function YV(t,e){var o;if(t.length===0)return e.classGroupId;var n=t[0],r=e.nextPart.get(n),s=r?YV(t.slice(1),r):void 0;if(s)return s;if(e.validators.length!==0){var i=t.join(SI);return(o=e.validators.find(function(l){var c=l.validator;return c(i)}))==null?void 0:o.classGroupId}}var yj=/^\[(.+)\]$/;function dQ(t){if(yj.test(t)){var e=yj.exec(t)[1],n=e==null?void 0:e.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}}function hQ(t){var e=t.theme,n=t.prefix,r={nextPart:new Map,validators:[]},s=mQ(Object.entries(t.classGroups),n);return s.forEach(function(i){var o=i[0],l=i[1];yE(l,r,o,e)}),r}function yE(t,e,n,r){t.forEach(function(s){if(typeof s=="string"){var i=s===""?e:xj(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(fQ(s)){yE(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(function(o){var l=o[0],c=o[1];yE(c,xj(e,l),n,r)})})}function xj(t,e){var n=t;return e.split(SI).forEach(function(r){n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n}function fQ(t){return t.isThemeGetter}function mQ(t,e){return e?t.map(function(n){var r=n[0],s=n[1],i=s.map(function(o){return typeof o=="string"?e+o:typeof o=="object"?Object.fromEntries(Object.entries(o).map(function(l){var c=l[0],u=l[1];return[e+c,u]})):o});return[r,i]}):t}function pQ(t){if(t<1)return{get:function(){},set:function(){}};var e=0,n=new Map,r=new Map;function s(i,o){n.set(i,o),e++,e>t&&(e=0,r=n,n=new Map)}return{get:function(o){var l=n.get(o);if(l!==void 0)return l;if((l=r.get(o))!==void 0)return s(o,l),l},set:function(o,l){n.has(o)?n.set(o,l):s(o,l)}}}var JV="!";function gQ(t){var e=t.separator||":",n=e.length===1,r=e[0],s=e.length;return function(o){for(var l=[],c=0,u=0,d,h=0;h<o.length;h++){var f=o[h];if(c===0){if(f===r&&(n||o.slice(h,h+s)===e)){l.push(o.slice(u,h)),u=h+s;continue}if(f==="/"){d=h;continue}}f==="["?c++:f==="]"&&c--}var m=l.length===0?o:o.substring(u),g=m.startsWith(JV),x=g?m.substring(1):m,w=d&&d>u?d-u:void 0;return{modifiers:l,hasImportantModifier:g,baseClassName:x,maybePostfixModifierPosition:w}}}function yQ(t){if(t.length<=1)return t;var e=[],n=[];return t.forEach(function(r){var s=r[0]==="[";s?(e.push.apply(e,n.sort().concat([r])),n=[]):n.push(r)}),e.push.apply(e,n.sort()),e}function xQ(t){return{cache:pQ(t.cacheSize),splitModifiers:gQ(t),...uQ(t)}}var vQ=/\s+/;function wQ(t,e){var n=e.splitModifiers,r=e.getClassGroupId,s=e.getConflictingClassGroupIds,i=new Set;return t.trim().split(vQ).map(function(o){var l=n(o),c=l.modifiers,u=l.hasImportantModifier,d=l.baseClassName,h=l.maybePostfixModifierPosition,f=r(h?d.substring(0,h):d),m=!!h;if(!f){if(!h)return{isTailwindClass:!1,originalClassName:o};if(f=r(d),!f)return{isTailwindClass:!1,originalClassName:o};m=!1}var g=yQ(c).join(":"),x=u?g+JV:g;return{isTailwindClass:!0,modifierId:x,classGroupId:f,originalClassName:o,hasPostfixModifier:m}}).reverse().filter(function(o){if(!o.isTailwindClass)return!0;var l=o.modifierId,c=o.classGroupId,u=o.hasPostfixModifier,d=l+c;return i.has(d)?!1:(i.add(d),s(c,u).forEach(function(h){return i.add(l+h)}),!0)}).reverse().map(function(o){return o.originalClassName}).join(" ")}function bQ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var r,s,i,o=l;function l(u){var d=e[0],h=e.slice(1),f=h.reduce(function(m,g){return g(m)},d());return r=xQ(f),s=r.cache.get,i=r.cache.set,o=c,c(u)}function c(u){var d=s(u);if(d)return d;var h=wQ(u,r);return i(u,h),h}return function(){return o(cQ.apply(null,arguments))}}function er(t){var e=function(r){return r[t]||[]};return e.isThemeGetter=!0,e}var XV=/^\[(?:([a-z-]+):)?(.+)\]$/i,_Q=/^\d+\/\d+$/,SQ=new Set(["px","full","screen"]),CQ=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,EQ=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,TQ=/^-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/;function To(t){return Nu(t)||SQ.has(t)||_Q.test(t)||xE(t)}function xE(t){return fd(t,"length",RQ)}function IQ(t){return fd(t,"size",QV)}function NQ(t){return fd(t,"position",QV)}function PQ(t){return fd(t,"url",jQ)}function $y(t){return fd(t,"number",Nu)}function Nu(t){return!Number.isNaN(Number(t))}function AQ(t){return t.endsWith("%")&&Nu(t.slice(0,-1))}function im(t){return vj(t)||fd(t,"number",vj)}function on(t){return XV.test(t)}function om(){return!0}function El(t){return CQ.test(t)}function kQ(t){return fd(t,"",DQ)}function fd(t,e,n){var r=XV.exec(t);return r?r[1]?r[1]===e:n(r[2]):!1}function RQ(t){return EQ.test(t)}function QV(){return!1}function jQ(t){return t.startsWith("url(")}function vj(t){return Number.isInteger(Number(t))}function DQ(t){return TQ.test(t)}function MQ(){var t=er("colors"),e=er("spacing"),n=er("blur"),r=er("brightness"),s=er("borderColor"),i=er("borderRadius"),o=er("borderSpacing"),l=er("borderWidth"),c=er("contrast"),u=er("grayscale"),d=er("hueRotate"),h=er("invert"),f=er("gap"),m=er("gradientColorStops"),g=er("gradientColorStopPositions"),x=er("inset"),w=er("margin"),v=er("opacity"),_=er("padding"),C=er("saturate"),T=er("scale"),R=er("sepia"),k=er("skew"),E=er("space"),I=er("translate"),P=function(){return["auto","contain","none"]},A=function(){return["auto","hidden","clip","visible","scroll"]},D=function(){return["auto",on,e]},j=function(){return[on,e]},M=function(){return["",To]},z=function(){return["auto",Nu,on]},U=function(){return["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"]},K=function(){return["solid","dashed","dotted","double","none"]},q=function(){return["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter"]},W=function(){return["start","end","center","between","around","evenly","stretch"]},te=function(){return["","0",on]},O=function(){return["auto","avoid","all","avoid-page","page","left","right","column"]},V=function(){return[Nu,$y]},H=function(){return[Nu,on]};return{cacheSize:500,theme:{colors:[om],spacing:[To],blur:["none","",El,on],brightness:V(),borderColor:[t],borderRadius:["none","","full",El,on],borderSpacing:j(),borderWidth:M(),contrast:V(),grayscale:te(),hueRotate:H(),invert:te(),gap:j(),gradientColorStops:[t],gradientColorStopPositions:[AQ,xE],inset:D(),margin:D(),opacity:V(),padding:j(),saturate:V(),scale:V(),sepia:te(),skew:H(),space:j(),translate:j()},classGroups:{aspect:[{aspect:["auto","square","video",on]}],container:["container"],columns:[{columns:[El]}],"break-after":[{"break-after":O()}],"break-before":[{"break-before":O()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none"]}],clear:[{clear:["left","right","both","none"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[].concat(U(),[on])}],overflow:[{overflow:A()}],"overflow-x":[{"overflow-x":A()}],"overflow-y":[{"overflow-y":A()}],overscroll:[{overscroll:P()}],"overscroll-x":[{"overscroll-x":P()}],"overscroll-y":[{"overscroll-y":P()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",im]}],basis:[{basis:D()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",on]}],grow:[{grow:te()}],shrink:[{shrink:te()}],order:[{order:["first","last","none",im]}],"grid-cols":[{"grid-cols":[om]}],"col-start-end":[{col:["auto",{span:["full",im]},on]}],"col-start":[{"col-start":z()}],"col-end":[{"col-end":z()}],"grid-rows":[{"grid-rows":[om]}],"row-start-end":[{row:["auto",{span:[im]},on]}],"row-start":[{"row-start":z()}],"row-end":[{"row-end":z()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",on]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",on]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal"].concat(W())}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal"].concat(W(),["baseline"])}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[].concat(W(),["baseline"])}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[_]}],px:[{px:[_]}],py:[{py:[_]}],ps:[{ps:[_]}],pe:[{pe:[_]}],pt:[{pt:[_]}],pr:[{pr:[_]}],pb:[{pb:[_]}],pl:[{pl:[_]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[E]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[E]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit",on,e]}],"min-w":[{"min-w":["min","max","fit",on,To]}],"max-w":[{"max-w":["0","none","full","min","max","fit","prose",{screen:[El]},El,on]}],h:[{h:[on,e,"auto","min","max","fit"]}],"min-h":[{"min-h":["min","max","fit",on,To]}],"max-h":[{"max-h":[on,e,"min","max","fit"]}],"font-size":[{text:["base",El,xE]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",$y]}],"font-family":[{font:[om]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",on]}],"line-clamp":[{"line-clamp":["none",Nu,$y]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",on,To]}],"list-image":[{"list-image":["none",on]}],"list-style-type":[{list:["none","disc","decimal",on]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[v]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[v]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[].concat(K(),["wavy"])}],"text-decoration-thickness":[{decoration:["auto","from-font",To]}],"underline-offset":[{"underline-offset":["auto",on,To]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",on]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",on]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[v]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[].concat(U(),[NQ])}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",IQ]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},PQ]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[v]}],"border-style":[{border:[].concat(K(),["hidden"])}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[v]}],"divide-style":[{divide:K()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:[""].concat(K())}],"outline-offset":[{"outline-offset":[on,To]}],"outline-w":[{outline:[To]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:M()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[v]}],"ring-offset-w":[{"ring-offset":[To]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",El,kQ]}],"shadow-color":[{shadow:[om]}],opacity:[{opacity:[v]}],"mix-blend":[{"mix-blend":q()}],"bg-blend":[{"bg-blend":q()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",El,on]}],grayscale:[{grayscale:[u]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[h]}],saturate:[{saturate:[C]}],sepia:[{sepia:[R]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[u]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[h]}],"backdrop-opacity":[{"backdrop-opacity":[v]}],"backdrop-saturate":[{"backdrop-saturate":[C]}],"backdrop-sepia":[{"backdrop-sepia":[R]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[o]}],"border-spacing-x":[{"border-spacing-x":[o]}],"border-spacing-y":[{"border-spacing-y":[o]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",on]}],duration:[{duration:H()}],ease:[{ease:["linear","in","out","in-out",on]}],delay:[{delay:H()}],animate:[{animate:["none","spin","ping","pulse","bounce",on]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[T]}],"scale-x":[{"scale-x":[T]}],"scale-y":[{"scale-y":[T]}],rotate:[{rotate:[im,on]}],"translate-x":[{"translate-x":[I]}],"translate-y":[{"translate-y":[I]}],"skew-x":[{"skew-x":[k]}],"skew-y":[{"skew-y":[k]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",on]}],accent:[{accent:["auto",t]}],appearance:["appearance-none"],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",on]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","pinch-zoom","manipulation",{pan:["x","left","right","y","up","down"]}]}],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",on]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[To,$y]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}var LQ=bQ(MQ);let Vy;const FQ=new Uint8Array(16);function OQ(){if(!Vy&&(Vy=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Vy))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Vy(FQ)}const hs=[];for(let t=0;t<256;++t)hs.push((t+256).toString(16).slice(1));function $Q(t,e=0){return hs[t[e+0]]+hs[t[e+1]]+hs[t[e+2]]+hs[t[e+3]]+"-"+hs[t[e+4]]+hs[t[e+5]]+"-"+hs[t[e+6]]+hs[t[e+7]]+"-"+hs[t[e+8]]+hs[t[e+9]]+"-"+hs[t[e+10]]+hs[t[e+11]]+hs[t[e+12]]+hs[t[e+13]]+hs[t[e+14]]+hs[t[e+15]]}const VQ=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),wj={randomUUID:VQ};function UQ(t,e,n){if(wj.randomUUID&&!e&&!t)return wj.randomUUID();t=t||{};const r=t.random||(t.rng||OQ)();if(r[6]=r[6]&15|64,r[8]=r[8]&63|128,e){n=n||0;for(let s=0;s<16;++s)e[n+s]=r[s];return e}return $Q(r)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let BQ,zQ;function GQ(){return{geminiUrl:BQ,vertexUrl:zQ}}function WQ(t,e,n){var r,s,i;if(!(!((r=t.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=GQ();return t.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(i=o.geminiUrl)!==null&&i!==void 0?i:n}return t.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cg{}function zt(t,e){const n=/\{([^}]+)\}/g;return t.replace(n,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const i=e[s];return i!=null?String(i):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function S(t,e,n){for(let i=0;i<e.length-1;i++){const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in t))if(Array.isArray(n))t[l]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(t[l])){const c=t[l];if(Array.isArray(n))for(let u=0;u<c.length;u++){const d=c[u];S(d,e.slice(i+1),n[u])}else for(const u of c)S(u,e.slice(i+1),n)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in t||(t[l]=[{}]);const c=t[l];S(c[0],e.slice(i+1),n);return}(!t[o]||typeof t[o]!="object")&&(t[o]={}),t=t[o]}const r=e[e.length-1],s=t[r];if(s!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===s)return;if(typeof s=="object"&&typeof n=="object"&&s!==null&&n!==null)Object.assign(s,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else t[r]=n}function b(t,e){try{if(e.length===1&&e[0]==="_self")return t;for(let n=0;n<e.length;n++){if(typeof t!="object"||t===null)return;const r=e[n];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in t){const i=t[s];return Array.isArray(i)?i.map(o=>b(o,e.slice(n+1))):void 0}else return}else t=t[r]}return t}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cr(t,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(t.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const n=e.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function ZV(t,e){const n=cr(t,e);return n?n.startsWith("publishers/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}`:n.startsWith("models/")&&t.isVertexAI()?`projects/${t.getProject()}/locations/${t.getLocation()}/publishers/google/${n}`:n:""}function e3(t,e){return Array.isArray(e)?e.map(n=>Xv(t,n)):[Xv(t,e)]}function Xv(t,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function HQ(t,e){const n=Xv(t,e);if(n.mimeType&&n.mimeType.startsWith("image/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function qQ(t,e){const n=Xv(t,e);if(n.mimeType&&n.mimeType.startsWith("audio/"))return n;throw new Error(`Unsupported mime type: ${n.mimeType}`)}function bj(t,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function t3(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(n=>bj(t,n)):[bj(t,e)]}function vE(t){return t!=null&&typeof t=="object"&&"parts"in t&&Array.isArray(t.parts)}function _j(t){return t!=null&&typeof t=="object"&&"functionCall"in t}function Sj(t){return t!=null&&typeof t=="object"&&"functionResponse"in t}function di(t,e){if(e==null)throw new Error("ContentUnion is required");return vE(e)?e:{role:"user",parts:t3(t,e)}}function n3(t,e){if(!e)return[];if(t.isVertexAI()&&Array.isArray(e))return e.flatMap(n=>{const r=di(t,n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(t.isVertexAI()){const n=di(t,e);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(e)?e.map(n=>di(t,n)):[di(t,e)]}function Fc(t,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(_j(e)||Sj(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[di(t,e)]}const n=[],r=[],s=vE(e[0]);for(const i of e){const o=vE(i);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)n.push(i);else{if(_j(i)||Sj(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(i)}}return s||n.push({role:"user",parts:t3(t,r)}),n}function r3(t,e){return e}function s3(t,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function R0(t,e){return e}function j0(t,e){if(!Array.isArray(e))throw new Error("tool is required and must be an array of Tools");return e}function KQ(t,e,n,r=1){const s=!e.startsWith(`${n}/`)&&e.split("/").length===r;return t.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${t.getProject()}/${e}`:e.startsWith(`${n}/`)?`projects/${t.getProject()}/locations/${t.getLocation()}/${e}`:s?`projects/${t.getProject()}/locations/${t.getLocation()}/${n}/${e}`:e:s?`${n}/${e}`:e}function Oc(t,e){if(typeof e!="string")throw new Error("name must be a string");return KQ(t,e,"cachedContents")}function i3(t,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function $c(t,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function YQ(t){return t!=null&&typeof t=="object"&&"name"in t}function JQ(t){return t!=null&&typeof t=="object"&&"video"in t}function XQ(t){return t!=null&&typeof t=="object"&&"uri"in t}function o3(t,e){var n;let r;if(YQ(e)&&(r=e.name),!(XQ(e)&&(r=e.uri,r===void 0))&&!(JQ(e)&&(r=(n=e.video)===null||n===void 0?void 0:n.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const i=r.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${r}`);r=i[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function a3(t,e){let n;return t.isVertexAI()?n=e?"publishers/google/models":"models":n=e?"models":"tunedModels",n}function l3(t,e){for(const n of["models","tunedModels","publisherModels"])if(QQ(e,n))return e[n];return[]}function QQ(t,e){return t!==null&&typeof t=="object"&&e in t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function ZQ(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function eZ(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],ZQ(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function Cj(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>eZ(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function tZ(){return{}}function nZ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function rZ(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],nZ(t,r)),n}function sZ(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],tZ());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],rZ(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function iZ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function oZ(t,e){const n={},r=b(e,["functionCallingConfig"]);if(r!=null&&S(n,["functionCallingConfig"],iZ(t,r)),b(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function aZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);n!==void 0&&i!=null&&S(n,["expireTime"],i);const o=b(e,["displayName"]);n!==void 0&&o!=null&&S(n,["displayName"],o);const l=b(e,["contents"]);if(n!==void 0&&l!=null){let h=Fc(t,l);Array.isArray(h)&&(h=h.map(f=>Cj(t,f))),S(n,["contents"],h)}const c=b(e,["systemInstruction"]);n!==void 0&&c!=null&&S(n,["systemInstruction"],Cj(t,di(t,c)));const u=b(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>sZ(t,f))),S(n,["tools"],h)}const d=b(e,["toolConfig"]);return n!==void 0&&d!=null&&S(n,["toolConfig"],oZ(t,d)),r}function lZ(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],ZV(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],aZ(t,s,n)),n}function cZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Oc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function uZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Oc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function dZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);return n!==void 0&&i!=null&&S(n,["expireTime"],i),r}function hZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Oc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],dZ(t,s,n)),n}function fZ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function mZ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],fZ(t,r,n)),n}function pZ(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function gZ(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],pZ(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function Ej(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>gZ(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function yZ(){return{}}function xZ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function vZ(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],xZ(t,r)),n}function wZ(){return{}}function bZ(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function _Z(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],bZ(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function SZ(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],_Z(t,r)),n}function CZ(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],yZ());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],vZ(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],wZ());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],SZ(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function EZ(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function TZ(t,e){const n={},r=b(e,["latitude"]);r!=null&&S(n,["latitude"],r);const s=b(e,["longitude"]);return s!=null&&S(n,["longitude"],s),n}function IZ(t,e){const n={},r=b(e,["latLng"]);return r!=null&&S(n,["latLng"],TZ(t,r)),n}function NZ(t,e){const n={},r=b(e,["functionCallingConfig"]);r!=null&&S(n,["functionCallingConfig"],EZ(t,r));const s=b(e,["retrievalConfig"]);return s!=null&&S(n,["retrievalConfig"],IZ(t,s)),n}function PZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);n!==void 0&&i!=null&&S(n,["expireTime"],i);const o=b(e,["displayName"]);n!==void 0&&o!=null&&S(n,["displayName"],o);const l=b(e,["contents"]);if(n!==void 0&&l!=null){let h=Fc(t,l);Array.isArray(h)&&(h=h.map(f=>Ej(t,f))),S(n,["contents"],h)}const c=b(e,["systemInstruction"]);n!==void 0&&c!=null&&S(n,["systemInstruction"],Ej(t,di(t,c)));const u=b(e,["tools"]);if(n!==void 0&&u!=null){let h=u;Array.isArray(h)&&(h=h.map(f=>CZ(t,f))),S(n,["tools"],h)}const d=b(e,["toolConfig"]);return n!==void 0&&d!=null&&S(n,["toolConfig"],NZ(t,d)),r}function AZ(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],ZV(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],PZ(t,s,n)),n}function kZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Oc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function RZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Oc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function jZ(t,e,n){const r={},s=b(e,["ttl"]);n!==void 0&&s!=null&&S(n,["ttl"],s);const i=b(e,["expireTime"]);return n!==void 0&&i!=null&&S(n,["expireTime"],i),r}function DZ(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],Oc(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],jZ(t,s,n)),n}function MZ(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function LZ(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],MZ(t,r,n)),n}function Gx(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["model"]);i!=null&&S(n,["model"],i);const o=b(e,["createTime"]);o!=null&&S(n,["createTime"],o);const l=b(e,["updateTime"]);l!=null&&S(n,["updateTime"],l);const c=b(e,["expireTime"]);c!=null&&S(n,["expireTime"],c);const u=b(e,["usageMetadata"]);return u!=null&&S(n,["usageMetadata"],u),n}function FZ(){return{}}function OZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>Gx(t,o))),S(n,["cachedContents"],i)}return n}function Wx(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["model"]);i!=null&&S(n,["model"],i);const o=b(e,["createTime"]);o!=null&&S(n,["createTime"],o);const l=b(e,["updateTime"]);l!=null&&S(n,["updateTime"],l);const c=b(e,["expireTime"]);c!=null&&S(n,["expireTime"],c);const u=b(e,["usageMetadata"]);return u!=null&&S(n,["usageMetadata"],u),n}function $Z(){return{}}function VZ(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["cachedContents"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>Wx(t,o))),S(n,["cachedContents"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Zh;(function(t){t.PAGED_ITEM_BATCH_JOBS="batchJobs",t.PAGED_ITEM_MODELS="models",t.PAGED_ITEM_TUNING_JOBS="tuningJobs",t.PAGED_ITEM_FILES="files",t.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Zh||(Zh={}));class D0{constructor(e,n,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(e,r,s)}init(e,n,r){var s,i;this.nameInternal=e,this.pageInternal=n[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=n.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(i=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Tj;(function(t){t.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",t.OUTCOME_OK="OUTCOME_OK",t.OUTCOME_FAILED="OUTCOME_FAILED",t.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(Tj||(Tj={}));var Ij;(function(t){t.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",t.PYTHON="PYTHON"})(Ij||(Ij={}));var Tr;(function(t){t.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",t.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",t.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",t.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",t.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",t.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(Tr||(Tr={}));var Nj;(function(t){t.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",t.SEVERITY="SEVERITY",t.PROBABILITY="PROBABILITY"})(Nj||(Nj={}));var Ir;(function(t){t.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE",t.OFF="OFF"})(Ir||(Ir={}));var Pj;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})(Pj||(Pj={}));var Aj;(function(t){t.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",t.NO_AUTH="NO_AUTH",t.API_KEY_AUTH="API_KEY_AUTH",t.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",t.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",t.OAUTH="OAUTH",t.OIDC_AUTH="OIDC_AUTH"})(Aj||(Aj={}));var He;(function(t){t.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",t.STRING="STRING",t.NUMBER="NUMBER",t.INTEGER="INTEGER",t.BOOLEAN="BOOLEAN",t.ARRAY="ARRAY",t.OBJECT="OBJECT"})(He||(He={}));var kj;(function(t){t.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",t.STOP="STOP",t.MAX_TOKENS="MAX_TOKENS",t.SAFETY="SAFETY",t.RECITATION="RECITATION",t.LANGUAGE="LANGUAGE",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT",t.SPII="SPII",t.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",t.IMAGE_SAFETY="IMAGE_SAFETY"})(kj||(kj={}));var Rj;(function(t){t.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",t.NEGLIGIBLE="NEGLIGIBLE",t.LOW="LOW",t.MEDIUM="MEDIUM",t.HIGH="HIGH"})(Rj||(Rj={}));var jj;(function(t){t.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",t.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",t.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",t.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",t.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(jj||(jj={}));var Dj;(function(t){t.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",t.SAFETY="SAFETY",t.OTHER="OTHER",t.BLOCKLIST="BLOCKLIST",t.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(Dj||(Dj={}));var Mj;(function(t){t.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",t.ON_DEMAND="ON_DEMAND",t.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(Mj||(Mj={}));var yn;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.AUDIO="AUDIO"})(yn||(yn={}));var Lj;(function(t){t.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",t.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",t.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",t.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(Lj||(Lj={}));var wE;(function(t){t.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",t.JOB_STATE_QUEUED="JOB_STATE_QUEUED",t.JOB_STATE_PENDING="JOB_STATE_PENDING",t.JOB_STATE_RUNNING="JOB_STATE_RUNNING",t.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",t.JOB_STATE_FAILED="JOB_STATE_FAILED",t.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",t.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",t.JOB_STATE_PAUSED="JOB_STATE_PAUSED",t.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",t.JOB_STATE_UPDATING="JOB_STATE_UPDATING",t.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(wE||(wE={}));var Fj;(function(t){t.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",t.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",t.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",t.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",t.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",t.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",t.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(Fj||(Fj={}));var Oj;(function(t){t.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",t.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",t.BALANCED="BALANCED",t.PRIORITIZE_COST="PRIORITIZE_COST"})(Oj||(Oj={}));var $j;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.MODE_DYNAMIC="MODE_DYNAMIC"})($j||($j={}));var Vj;(function(t){t.MODE_UNSPECIFIED="MODE_UNSPECIFIED",t.AUTO="AUTO",t.ANY="ANY",t.NONE="NONE"})(Vj||(Vj={}));var Uj;(function(t){t.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",t.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",t.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",t.BLOCK_NONE="BLOCK_NONE"})(Uj||(Uj={}));var Bj;(function(t){t.DONT_ALLOW="DONT_ALLOW",t.ALLOW_ADULT="ALLOW_ADULT",t.ALLOW_ALL="ALLOW_ALL"})(Bj||(Bj={}));var zj;(function(t){t.auto="auto",t.en="en",t.ja="ja",t.ko="ko",t.hi="hi"})(zj||(zj={}));var Gj;(function(t){t.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",t.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",t.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",t.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",t.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(Gj||(Gj={}));var Wj;(function(t){t.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",t.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",t.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",t.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(Wj||(Wj={}));var Hj;(function(t){t.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",t.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",t.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",t.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(Hj||(Hj={}));var qj;(function(t){t.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",t.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",t.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",t.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",t.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",t.EDIT_MODE_STYLE="EDIT_MODE_STYLE",t.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",t.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(qj||(qj={}));var Kj;(function(t){t.STATE_UNSPECIFIED="STATE_UNSPECIFIED",t.PROCESSING="PROCESSING",t.ACTIVE="ACTIVE",t.FAILED="FAILED"})(Kj||(Kj={}));var Yj;(function(t){t.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",t.UPLOADED="UPLOADED",t.GENERATED="GENERATED"})(Yj||(Yj={}));var Jj;(function(t){t.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",t.TEXT="TEXT",t.IMAGE="IMAGE",t.VIDEO="VIDEO",t.AUDIO="AUDIO",t.DOCUMENT="DOCUMENT"})(Jj||(Jj={}));var Xj;(function(t){t.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",t.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",t.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(Xj||(Xj={}));var Qj;(function(t){t.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",t.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",t.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(Qj||(Qj={}));var Zj;(function(t){t.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",t.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",t.NO_INTERRUPTION="NO_INTERRUPTION"})(Zj||(Zj={}));var e2;(function(t){t.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",t.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",t.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(e2||(e2={}));class Uy{get text(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",d=!1;const h=[];for(const f of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[m,g]of Object.entries(f))m!=="text"&&m!=="thought"&&(g!==null||g!==void 0)&&h.push(m);if(typeof f.text=="string"){if(typeof f.thought=="boolean"&&f.thought)continue;d=!0,u+=f.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),d?u:void 0}get data(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const d=[];for(const h of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[f,m]of Object.entries(h))f!=="inlineData"&&(m!==null||m!==void 0)&&d.push(f);h.inlineData&&typeof h.inlineData.data=="string"&&(u+=atob(h.inlineData.data))}return d.length>0&&console.warn(`there are non-data parts ${d} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var e,n,r,s,i,o,l,c;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(d=>d.functionCall).map(d=>d.functionCall).filter(d=>d!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var e,n,r,s,i,o,l,c,u;if(((s=(r=(n=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return(u=d==null?void 0:d[0])===null||u===void 0?void 0:u.output}}class t2{}class n2{}class UZ{}class BZ{}class r2{}class s2{}class i2{}class zZ{}class o2{}class a2{}class l2{}class GZ{}class bE{constructor(e){const n={};for(const r of e.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=e}json(){return this.responseInternal.json()}}class WZ{}class HZ{}class qZ{get text(){var e,n,r;let s="",i=!1;const o=[];for(const l of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[c,u]of Object.entries(l))c!=="text"&&c!=="thought"&&u!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;i=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?s:void 0}get data(){var e,n,r;let s="";const i=[];for(const o of(r=(n=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&i.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class KZ extends Cg{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new D0(Zh.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=AZ(this.apiClient,e);return l=zt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Wx(this.apiClient,d))}else{const u=lZ(this.apiClient,e);return l=zt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Gx(this.apiClient,d))}}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=kZ(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Wx(this.apiClient,d))}else{const u=cZ(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Gx(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=RZ(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=$Z(),h=new a2;return Object.assign(h,d),h})}else{const u=uZ(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=FZ(),h=new a2;return Object.assign(h,d),h})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=DZ(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Wx(this.apiClient,d))}else{const u=hZ(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Gx(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=LZ(this.apiClient,e);return l=zt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=VZ(this.apiClient,d),f=new l2;return Object.assign(f,h),f})}else{const u=mZ(this.apiClient,e);return l=zt("cachedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=OZ(this.apiClient,d),f=new l2;return Object.assign(f,h),f})}}}function c2(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ks(t){return this instanceof ks?(this.v=t,this):new ks(t)}function Qv(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(t,e||[]),s,i=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(m){return function(g){return Promise.resolve(g).then(m,h)}}function l(m,g){r[m]&&(s[m]=function(x){return new Promise(function(w,v){i.push([m,x,w,v])>1||c(m,x)})},g&&(s[m]=g(s[m])))}function c(m,g){try{u(r[m](g))}catch(x){f(i[0][3],x)}}function u(m){m.value instanceof ks?Promise.resolve(m.value.v).then(d,h):f(i[0][2],m)}function d(m){c("next",m)}function h(m){c("throw",m)}function f(m,g){m(g),i.shift(),i.length&&c(i[0][0],i[0][1])}}function _E(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof c2=="function"?c2(t):t[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(i){n[i]=t[i]&&function(o){return new Promise(function(l,c){o=t[i](o),s(l,c,o.done,o.value)})}}function s(i,o,l,c){Promise.resolve(c).then(function(u){i({value:u,done:l})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function YZ(t){var e;if(t.candidates==null||t.candidates.length===0)return!1;const n=(e=t.candidates[0])===null||e===void 0?void 0:e.content;return n===void 0?!1:c3(n)}function c3(t){if(t.parts===void 0||t.parts.length===0)return!1;for(const e of t.parts)if(e===void 0||Object.keys(e).length===0||e.text!==void 0&&e.text==="")return!1;return!0}function JZ(t){if(t.length!==0){if(t[0].role!=="user")throw new Error("History must start with a user turn.");for(const e of t)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function XZ(t){if(t===void 0||t.length===0)return[];const e=[],n=t.length;let r=0,s=t[0];for(;r<n;)if(t[r].role==="user")s=t[r],r++;else{const i=[];let o=!0;for(;r<n&&t[r].role==="model";)i.push(t[r]),o&&!c3(t[r])&&(o=!1),r++;o&&(e.push(s),e.push(...i))}return e}class QZ{constructor(e,n){this.modelsModule=e,this.apiClient=n}create(e){return new ZZ(this.apiClient,this.modelsModule,e.model,e.config,e.history)}}let ZZ=class{constructor(e,n,r,s={},i=[]){this.apiClient=e,this.modelsModule=n,this.model=r,this.config=s,this.history=i,this.sendPromise=Promise.resolve(),JZ(i)}async sendMessage(e){var n;await this.sendPromise;const r=di(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var i,o;const c=(o=(i=(await s).candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content,u=c?[c]:[];this.recordHistory(r,u)})(),await this.sendPromise,s}async sendMessageStream(e){var n;await this.sendPromise;const r=di(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=e.config)!==null&&n!==void 0?n:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const i=await s;return this.processStreamResponse(i,r)}getHistory(e=!1){return e?XZ(this.history):this.history}processStreamResponse(e,n){var r,s;return Qv(this,arguments,function*(){var o,l,c,u;const d=[];try{for(var h=!0,f=_E(e),m;m=yield ks(f.next()),o=m.done,!o;h=!0){u=m.value,h=!1;const g=u;if(YZ(g)){const x=(s=(r=g.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;x!==void 0&&d.push(x)}yield yield ks(g)}}catch(g){l={error:g}}finally{try{!h&&!o&&(c=f.return)&&(yield ks(c.call(f)))}finally{if(l)throw l.error}}this.recordHistory(n,d)})}recordHistory(e,n){let r=[];n.length>0&&n.every(s=>s.role==="model")?r=n:r.push({role:"model",parts:[]}),this.history.push(e),this.history.push(...r)}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function eee(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);return n!==void 0&&i!=null&&S(n,["_query","pageToken"],i),r}function tee(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],eee(t,r,n)),n}function nee(t,e){const n={},r=b(e,["details"]);r!=null&&S(n,["details"],r);const s=b(e,["message"]);s!=null&&S(n,["message"],s);const i=b(e,["code"]);return i!=null&&S(n,["code"],i),n}function ree(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["mimeType"]);i!=null&&S(n,["mimeType"],i);const o=b(e,["sizeBytes"]);o!=null&&S(n,["sizeBytes"],o);const l=b(e,["createTime"]);l!=null&&S(n,["createTime"],l);const c=b(e,["expirationTime"]);c!=null&&S(n,["expirationTime"],c);const u=b(e,["updateTime"]);u!=null&&S(n,["updateTime"],u);const d=b(e,["sha256Hash"]);d!=null&&S(n,["sha256Hash"],d);const h=b(e,["uri"]);h!=null&&S(n,["uri"],h);const f=b(e,["downloadUri"]);f!=null&&S(n,["downloadUri"],f);const m=b(e,["state"]);m!=null&&S(n,["state"],m);const g=b(e,["source"]);g!=null&&S(n,["source"],g);const x=b(e,["videoMetadata"]);x!=null&&S(n,["videoMetadata"],x);const w=b(e,["error"]);return w!=null&&S(n,["error"],nee(t,w)),n}function see(t,e){const n={},r=b(e,["file"]);r!=null&&S(n,["file"],ree(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function iee(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","file"],o3(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function oee(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","file"],o3(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function aee(t,e){const n={},r=b(e,["details"]);r!=null&&S(n,["details"],r);const s=b(e,["message"]);s!=null&&S(n,["message"],s);const i=b(e,["code"]);return i!=null&&S(n,["code"],i),n}function SE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["mimeType"]);i!=null&&S(n,["mimeType"],i);const o=b(e,["sizeBytes"]);o!=null&&S(n,["sizeBytes"],o);const l=b(e,["createTime"]);l!=null&&S(n,["createTime"],l);const c=b(e,["expirationTime"]);c!=null&&S(n,["expirationTime"],c);const u=b(e,["updateTime"]);u!=null&&S(n,["updateTime"],u);const d=b(e,["sha256Hash"]);d!=null&&S(n,["sha256Hash"],d);const h=b(e,["uri"]);h!=null&&S(n,["uri"],h);const f=b(e,["downloadUri"]);f!=null&&S(n,["downloadUri"],f);const m=b(e,["state"]);m!=null&&S(n,["state"],m);const g=b(e,["source"]);g!=null&&S(n,["source"],g);const x=b(e,["videoMetadata"]);x!=null&&S(n,["videoMetadata"],x);const w=b(e,["error"]);return w!=null&&S(n,["error"],aee(t,w)),n}function lee(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["files"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>SE(t,o))),S(n,["files"],i)}return n}function cee(){return{}}function uee(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let dee=class extends Cg{constructor(e){super(),this.apiClient=e,this.list=async(n={})=>new D0(Zh.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(n=>SE(this.apiClient,n))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=tee(this.apiClient,e);return i=zt("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=lee(this.apiClient,c),d=new GZ;return Object.assign(d,u),d})}}async createInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=see(this.apiClient,e);return i=zt("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=cee(),u=new WZ;return Object.assign(u,c),u})}}async get(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=iee(this.apiClient,e);return i=zt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>SE(this.apiClient,c))}}async delete(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=oee(this.apiClient,e);return i=zt("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=uee(),u=new HZ;return Object.assign(u,c),u})}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function hee(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function fee(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function mee(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],hee(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function pee(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],fee(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function gee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>mee(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function yee(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>pee(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function xee(){return{}}function vee(){return{}}function wee(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function bee(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function _ee(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],wee(t,r)),n}function See(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],bee(t,r)),n}function Cee(){return{}}function Eee(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function Tee(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],Eee(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function Iee(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],Tee(t,r)),n}function Nee(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],xee());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],_ee(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function Pee(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],vee());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],See(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],Cee());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],Iee(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function Aee(t,e){const n={},r=b(e,["handle"]);if(r!=null&&S(n,["handle"],r),b(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return n}function kee(t,e){const n={},r=b(e,["handle"]);r!=null&&S(n,["handle"],r);const s=b(e,["transparent"]);return s!=null&&S(n,["transparent"],s),n}function u2(){return{}}function d2(){return{}}function Ree(t,e){const n={},r=b(e,["disabled"]);r!=null&&S(n,["disabled"],r);const s=b(e,["startOfSpeechSensitivity"]);s!=null&&S(n,["startOfSpeechSensitivity"],s);const i=b(e,["endOfSpeechSensitivity"]);i!=null&&S(n,["endOfSpeechSensitivity"],i);const o=b(e,["prefixPaddingMs"]);o!=null&&S(n,["prefixPaddingMs"],o);const l=b(e,["silenceDurationMs"]);return l!=null&&S(n,["silenceDurationMs"],l),n}function jee(t,e){const n={},r=b(e,["disabled"]);r!=null&&S(n,["disabled"],r);const s=b(e,["startOfSpeechSensitivity"]);s!=null&&S(n,["startOfSpeechSensitivity"],s);const i=b(e,["endOfSpeechSensitivity"]);i!=null&&S(n,["endOfSpeechSensitivity"],i);const o=b(e,["prefixPaddingMs"]);o!=null&&S(n,["prefixPaddingMs"],o);const l=b(e,["silenceDurationMs"]);return l!=null&&S(n,["silenceDurationMs"],l),n}function Dee(t,e){const n={},r=b(e,["automaticActivityDetection"]);r!=null&&S(n,["automaticActivityDetection"],Ree(t,r));const s=b(e,["activityHandling"]);s!=null&&S(n,["activityHandling"],s);const i=b(e,["turnCoverage"]);return i!=null&&S(n,["turnCoverage"],i),n}function Mee(t,e){const n={},r=b(e,["automaticActivityDetection"]);r!=null&&S(n,["automaticActivityDetection"],jee(t,r));const s=b(e,["activityHandling"]);s!=null&&S(n,["activityHandling"],s);const i=b(e,["turnCoverage"]);return i!=null&&S(n,["turnCoverage"],i),n}function Lee(t,e){const n={},r=b(e,["targetTokens"]);return r!=null&&S(n,["targetTokens"],r),n}function Fee(t,e){const n={},r=b(e,["targetTokens"]);return r!=null&&S(n,["targetTokens"],r),n}function Oee(t,e){const n={},r=b(e,["triggerTokens"]);r!=null&&S(n,["triggerTokens"],r);const s=b(e,["slidingWindow"]);return s!=null&&S(n,["slidingWindow"],Lee(t,s)),n}function $ee(t,e){const n={},r=b(e,["triggerTokens"]);r!=null&&S(n,["triggerTokens"],r);const s=b(e,["slidingWindow"]);return s!=null&&S(n,["slidingWindow"],Fee(t,s)),n}function Vee(t,e,n){const r={},s=b(e,["generationConfig"]);n!==void 0&&s!=null&&S(n,["setup","generationConfig"],s);const i=b(e,["responseModalities"]);n!==void 0&&i!=null&&S(n,["setup","generationConfig","responseModalities"],i);const o=b(e,["temperature"]);n!==void 0&&o!=null&&S(n,["setup","generationConfig","temperature"],o);const l=b(e,["topP"]);n!==void 0&&l!=null&&S(n,["setup","generationConfig","topP"],l);const c=b(e,["topK"]);n!==void 0&&c!=null&&S(n,["setup","generationConfig","topK"],c);const u=b(e,["maxOutputTokens"]);n!==void 0&&u!=null&&S(n,["setup","generationConfig","maxOutputTokens"],u);const d=b(e,["mediaResolution"]);n!==void 0&&d!=null&&S(n,["setup","generationConfig","mediaResolution"],d);const h=b(e,["seed"]);n!==void 0&&h!=null&&S(n,["setup","generationConfig","seed"],h);const f=b(e,["speechConfig"]);n!==void 0&&f!=null&&S(n,["setup","generationConfig","speechConfig"],f);const m=b(e,["systemInstruction"]);n!==void 0&&m!=null&&S(n,["setup","systemInstruction"],gee(t,di(t,m)));const g=b(e,["tools"]);if(n!==void 0&&g!=null){let T=j0(t,g);Array.isArray(T)&&(T=T.map(R=>Nee(t,R0(t,R)))),S(n,["setup","tools"],T)}const x=b(e,["sessionResumption"]);n!==void 0&&x!=null&&S(n,["setup","sessionResumption"],Aee(t,x));const w=b(e,["inputAudioTranscription"]);n!==void 0&&w!=null&&S(n,["setup","inputAudioTranscription"],u2());const v=b(e,["outputAudioTranscription"]);n!==void 0&&v!=null&&S(n,["setup","outputAudioTranscription"],u2());const _=b(e,["realtimeInputConfig"]);n!==void 0&&_!=null&&S(n,["setup","realtimeInputConfig"],Dee(t,_));const C=b(e,["contextWindowCompression"]);return n!==void 0&&C!=null&&S(n,["setup","contextWindowCompression"],Oee(t,C)),r}function Uee(t,e,n){const r={},s=b(e,["generationConfig"]);n!==void 0&&s!=null&&S(n,["setup","generationConfig"],s);const i=b(e,["responseModalities"]);n!==void 0&&i!=null&&S(n,["setup","generationConfig","responseModalities"],i);const o=b(e,["temperature"]);n!==void 0&&o!=null&&S(n,["setup","generationConfig","temperature"],o);const l=b(e,["topP"]);n!==void 0&&l!=null&&S(n,["setup","generationConfig","topP"],l);const c=b(e,["topK"]);n!==void 0&&c!=null&&S(n,["setup","generationConfig","topK"],c);const u=b(e,["maxOutputTokens"]);n!==void 0&&u!=null&&S(n,["setup","generationConfig","maxOutputTokens"],u);const d=b(e,["mediaResolution"]);n!==void 0&&d!=null&&S(n,["setup","generationConfig","mediaResolution"],d);const h=b(e,["seed"]);n!==void 0&&h!=null&&S(n,["setup","generationConfig","seed"],h);const f=b(e,["speechConfig"]);n!==void 0&&f!=null&&S(n,["setup","generationConfig","speechConfig"],f);const m=b(e,["systemInstruction"]);n!==void 0&&m!=null&&S(n,["setup","systemInstruction"],yee(t,di(t,m)));const g=b(e,["tools"]);if(n!==void 0&&g!=null){let T=j0(t,g);Array.isArray(T)&&(T=T.map(R=>Pee(t,R0(t,R)))),S(n,["setup","tools"],T)}const x=b(e,["sessionResumption"]);n!==void 0&&x!=null&&S(n,["setup","sessionResumption"],kee(t,x));const w=b(e,["inputAudioTranscription"]);n!==void 0&&w!=null&&S(n,["setup","inputAudioTranscription"],d2());const v=b(e,["outputAudioTranscription"]);n!==void 0&&v!=null&&S(n,["setup","outputAudioTranscription"],d2());const _=b(e,["realtimeInputConfig"]);n!==void 0&&_!=null&&S(n,["setup","realtimeInputConfig"],Mee(t,_));const C=b(e,["contextWindowCompression"]);return n!==void 0&&C!=null&&S(n,["setup","contextWindowCompression"],$ee(t,C)),r}function Bee(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["setup","model"],cr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],Vee(t,s,n)),n}function zee(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["setup","model"],cr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],Uee(t,s,n)),n}function Gee(){return{}}function Wee(){return{}}function Hee(){return{}}function qee(){return{}}function Kee(t,e){const n={},r=b(e,["media"]);r!=null&&S(n,["mediaChunks"],e3(t,r));const s=b(e,["audio"]);s!=null&&S(n,["audio"],qQ(t,s));const i=b(e,["audioStreamEnd"]);i!=null&&S(n,["audioStreamEnd"],i);const o=b(e,["video"]);o!=null&&S(n,["video"],HQ(t,o));const l=b(e,["text"]);return l!=null&&S(n,["text"],l),b(e,["activityStart"])!=null&&S(n,["activityStart"],Gee()),b(e,["activityEnd"])!=null&&S(n,["activityEnd"],Hee()),n}function Yee(t,e){const n={},r=b(e,["media"]);if(r!=null&&S(n,["mediaChunks"],e3(t,r)),b(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=b(e,["audioStreamEnd"]);if(s!=null&&S(n,["audioStreamEnd"],s),b(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(b(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return b(e,["activityStart"])!=null&&S(n,["activityStart"],Wee()),b(e,["activityEnd"])!=null&&S(n,["activityEnd"],qee()),n}function Jee(){return{}}function Xee(){return{}}function Qee(t,e){const n={},r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function Zee(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function ete(t,e){const n={},r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],Qee(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function tte(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],Zee(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function nte(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>ete(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function rte(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>tte(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function h2(t,e){const n={},r=b(e,["text"]);r!=null&&S(n,["text"],r);const s=b(e,["finished"]);return s!=null&&S(n,["finished"],s),n}function f2(t,e){const n={},r=b(e,["text"]);r!=null&&S(n,["text"],r);const s=b(e,["finished"]);return s!=null&&S(n,["finished"],s),n}function ste(t,e){const n={},r=b(e,["modelTurn"]);r!=null&&S(n,["modelTurn"],nte(t,r));const s=b(e,["turnComplete"]);s!=null&&S(n,["turnComplete"],s);const i=b(e,["interrupted"]);i!=null&&S(n,["interrupted"],i);const o=b(e,["groundingMetadata"]);o!=null&&S(n,["groundingMetadata"],o);const l=b(e,["generationComplete"]);l!=null&&S(n,["generationComplete"],l);const c=b(e,["inputTranscription"]);c!=null&&S(n,["inputTranscription"],h2(t,c));const u=b(e,["outputTranscription"]);return u!=null&&S(n,["outputTranscription"],h2(t,u)),n}function ite(t,e){const n={},r=b(e,["modelTurn"]);r!=null&&S(n,["modelTurn"],rte(t,r));const s=b(e,["turnComplete"]);s!=null&&S(n,["turnComplete"],s);const i=b(e,["interrupted"]);i!=null&&S(n,["interrupted"],i);const o=b(e,["groundingMetadata"]);o!=null&&S(n,["groundingMetadata"],o);const l=b(e,["generationComplete"]);l!=null&&S(n,["generationComplete"],l);const c=b(e,["inputTranscription"]);c!=null&&S(n,["inputTranscription"],f2(t,c));const u=b(e,["outputTranscription"]);return u!=null&&S(n,["outputTranscription"],f2(t,u)),n}function ote(t,e){const n={},r=b(e,["id"]);r!=null&&S(n,["id"],r);const s=b(e,["args"]);s!=null&&S(n,["args"],s);const i=b(e,["name"]);return i!=null&&S(n,["name"],i),n}function ate(t,e){const n={},r=b(e,["args"]);r!=null&&S(n,["args"],r);const s=b(e,["name"]);return s!=null&&S(n,["name"],s),n}function lte(t,e){const n={},r=b(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>ote(t,i))),S(n,["functionCalls"],s)}return n}function cte(t,e){const n={},r=b(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>ate(t,i))),S(n,["functionCalls"],s)}return n}function ute(t,e){const n={},r=b(e,["ids"]);return r!=null&&S(n,["ids"],r),n}function dte(t,e){const n={},r=b(e,["ids"]);return r!=null&&S(n,["ids"],r),n}function By(t,e){const n={},r=b(e,["modality"]);r!=null&&S(n,["modality"],r);const s=b(e,["tokenCount"]);return s!=null&&S(n,["tokenCount"],s),n}function zy(t,e){const n={},r=b(e,["modality"]);r!=null&&S(n,["modality"],r);const s=b(e,["tokenCount"]);return s!=null&&S(n,["tokenCount"],s),n}function hte(t,e){const n={},r=b(e,["promptTokenCount"]);r!=null&&S(n,["promptTokenCount"],r);const s=b(e,["cachedContentTokenCount"]);s!=null&&S(n,["cachedContentTokenCount"],s);const i=b(e,["responseTokenCount"]);i!=null&&S(n,["responseTokenCount"],i);const o=b(e,["toolUsePromptTokenCount"]);o!=null&&S(n,["toolUsePromptTokenCount"],o);const l=b(e,["thoughtsTokenCount"]);l!=null&&S(n,["thoughtsTokenCount"],l);const c=b(e,["totalTokenCount"]);c!=null&&S(n,["totalTokenCount"],c);const u=b(e,["promptTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(g=>By(t,g))),S(n,["promptTokensDetails"],m)}const d=b(e,["cacheTokensDetails"]);if(d!=null){let m=d;Array.isArray(m)&&(m=m.map(g=>By(t,g))),S(n,["cacheTokensDetails"],m)}const h=b(e,["responseTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(g=>By(t,g))),S(n,["responseTokensDetails"],m)}const f=b(e,["toolUsePromptTokensDetails"]);if(f!=null){let m=f;Array.isArray(m)&&(m=m.map(g=>By(t,g))),S(n,["toolUsePromptTokensDetails"],m)}return n}function fte(t,e){const n={},r=b(e,["promptTokenCount"]);r!=null&&S(n,["promptTokenCount"],r);const s=b(e,["cachedContentTokenCount"]);s!=null&&S(n,["cachedContentTokenCount"],s);const i=b(e,["candidatesTokenCount"]);i!=null&&S(n,["responseTokenCount"],i);const o=b(e,["toolUsePromptTokenCount"]);o!=null&&S(n,["toolUsePromptTokenCount"],o);const l=b(e,["thoughtsTokenCount"]);l!=null&&S(n,["thoughtsTokenCount"],l);const c=b(e,["totalTokenCount"]);c!=null&&S(n,["totalTokenCount"],c);const u=b(e,["promptTokensDetails"]);if(u!=null){let g=u;Array.isArray(g)&&(g=g.map(x=>zy(t,x))),S(n,["promptTokensDetails"],g)}const d=b(e,["cacheTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(x=>zy(t,x))),S(n,["cacheTokensDetails"],g)}const h=b(e,["candidatesTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(x=>zy(t,x))),S(n,["responseTokensDetails"],g)}const f=b(e,["toolUsePromptTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(x=>zy(t,x))),S(n,["toolUsePromptTokensDetails"],g)}const m=b(e,["trafficType"]);return m!=null&&S(n,["trafficType"],m),n}function mte(t,e){const n={},r=b(e,["timeLeft"]);return r!=null&&S(n,["timeLeft"],r),n}function pte(t,e){const n={},r=b(e,["timeLeft"]);return r!=null&&S(n,["timeLeft"],r),n}function gte(t,e){const n={},r=b(e,["newHandle"]);r!=null&&S(n,["newHandle"],r);const s=b(e,["resumable"]);s!=null&&S(n,["resumable"],s);const i=b(e,["lastConsumedClientMessageIndex"]);return i!=null&&S(n,["lastConsumedClientMessageIndex"],i),n}function yte(t,e){const n={},r=b(e,["newHandle"]);r!=null&&S(n,["newHandle"],r);const s=b(e,["resumable"]);s!=null&&S(n,["resumable"],s);const i=b(e,["lastConsumedClientMessageIndex"]);return i!=null&&S(n,["lastConsumedClientMessageIndex"],i),n}function xte(t,e){const n={};b(e,["setupComplete"])!=null&&S(n,["setupComplete"],Jee());const s=b(e,["serverContent"]);s!=null&&S(n,["serverContent"],ste(t,s));const i=b(e,["toolCall"]);i!=null&&S(n,["toolCall"],lte(t,i));const o=b(e,["toolCallCancellation"]);o!=null&&S(n,["toolCallCancellation"],ute(t,o));const l=b(e,["usageMetadata"]);l!=null&&S(n,["usageMetadata"],hte(t,l));const c=b(e,["goAway"]);c!=null&&S(n,["goAway"],mte(t,c));const u=b(e,["sessionResumptionUpdate"]);return u!=null&&S(n,["sessionResumptionUpdate"],gte(t,u)),n}function vte(t,e){const n={};b(e,["setupComplete"])!=null&&S(n,["setupComplete"],Xee());const s=b(e,["serverContent"]);s!=null&&S(n,["serverContent"],ite(t,s));const i=b(e,["toolCall"]);i!=null&&S(n,["toolCall"],cte(t,i));const o=b(e,["toolCallCancellation"]);o!=null&&S(n,["toolCallCancellation"],dte(t,o));const l=b(e,["usageMetadata"]);l!=null&&S(n,["usageMetadata"],fte(t,l));const c=b(e,["goAway"]);c!=null&&S(n,["goAway"],pte(t,c));const u=b(e,["sessionResumptionUpdate"]);return u!=null&&S(n,["sessionResumptionUpdate"],yte(t,u)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function wte(t,e){const n={};if(b(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function bte(t,e){const n={};if(b(e,["videoMetadata"])!==void 0)throw new Error("videoMetadata parameter is not supported in Gemini API.");const r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],wte(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function M0(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>bte(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function _te(t,e){const n={};if(b(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=b(e,["category"]);r!=null&&S(n,["category"],r);const s=b(e,["threshold"]);return s!=null&&S(n,["threshold"],s),n}function Ste(){return{}}function Cte(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function Ete(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],Cte(t,r)),n}function Tte(t,e){const n={};if(b(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");b(e,["googleSearch"])!=null&&S(n,["googleSearch"],Ste());const s=b(e,["googleSearchRetrieval"]);if(s!=null&&S(n,["googleSearchRetrieval"],Ete(t,s)),b(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(b(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");const i=b(e,["codeExecution"]);i!=null&&S(n,["codeExecution"],i);const o=b(e,["functionDeclarations"]);return o!=null&&S(n,["functionDeclarations"],o),n}function Ite(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function Nte(t,e){const n={},r=b(e,["functionCallingConfig"]);if(r!=null&&S(n,["functionCallingConfig"],Ite(t,r)),b(e,["retrievalConfig"])!==void 0)throw new Error("retrievalConfig parameter is not supported in Gemini API.");return n}function Pte(t,e){const n={},r=b(e,["voiceName"]);return r!=null&&S(n,["voiceName"],r),n}function Ate(t,e){const n={},r=b(e,["prebuiltVoiceConfig"]);return r!=null&&S(n,["prebuiltVoiceConfig"],Pte(t,r)),n}function kte(t,e){const n={},r=b(e,["voiceConfig"]);r!=null&&S(n,["voiceConfig"],Ate(t,r));const s=b(e,["languageCode"]);return s!=null&&S(n,["languageCode"],s),n}function Rte(t,e){const n={},r=b(e,["includeThoughts"]);r!=null&&S(n,["includeThoughts"],r);const s=b(e,["thinkingBudget"]);return s!=null&&S(n,["thinkingBudget"],s),n}function jte(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],M0(t,di(t,s)));const i=b(e,["temperature"]);i!=null&&S(r,["temperature"],i);const o=b(e,["topP"]);o!=null&&S(r,["topP"],o);const l=b(e,["topK"]);l!=null&&S(r,["topK"],l);const c=b(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const u=b(e,["maxOutputTokens"]);u!=null&&S(r,["maxOutputTokens"],u);const d=b(e,["stopSequences"]);d!=null&&S(r,["stopSequences"],d);const h=b(e,["responseLogprobs"]);h!=null&&S(r,["responseLogprobs"],h);const f=b(e,["logprobs"]);f!=null&&S(r,["logprobs"],f);const m=b(e,["presencePenalty"]);m!=null&&S(r,["presencePenalty"],m);const g=b(e,["frequencyPenalty"]);g!=null&&S(r,["frequencyPenalty"],g);const x=b(e,["seed"]);x!=null&&S(r,["seed"],x);const w=b(e,["responseMimeType"]);w!=null&&S(r,["responseMimeType"],w);const v=b(e,["responseSchema"]);if(v!=null&&S(r,["responseSchema"],r3(t,v)),b(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(b(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const _=b(e,["safetySettings"]);if(n!==void 0&&_!=null){let A=_;Array.isArray(A)&&(A=A.map(D=>_te(t,D))),S(n,["safetySettings"],A)}const C=b(e,["tools"]);if(n!==void 0&&C!=null){let A=j0(t,C);Array.isArray(A)&&(A=A.map(D=>Tte(t,R0(t,D)))),S(n,["tools"],A)}const T=b(e,["toolConfig"]);if(n!==void 0&&T!=null&&S(n,["toolConfig"],Nte(t,T)),b(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const R=b(e,["cachedContent"]);n!==void 0&&R!=null&&S(n,["cachedContent"],Oc(t,R));const k=b(e,["responseModalities"]);k!=null&&S(r,["responseModalities"],k);const E=b(e,["mediaResolution"]);E!=null&&S(r,["mediaResolution"],E);const I=b(e,["speechConfig"]);if(I!=null&&S(r,["speechConfig"],kte(t,s3(t,I))),b(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const P=b(e,["thinkingConfig"]);return P!=null&&S(r,["thinkingConfig"],Rte(t,P)),r}function m2(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["contents"]);if(s!=null){let o=Fc(t,s);Array.isArray(o)&&(o=o.map(l=>M0(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["generationConfig"],jte(t,i,n)),n}function Dte(t,e,n){const r={},s=b(e,["taskType"]);n!==void 0&&s!=null&&S(n,["requests[]","taskType"],s);const i=b(e,["title"]);n!==void 0&&i!=null&&S(n,["requests[]","title"],i);const o=b(e,["outputDimensionality"]);if(n!==void 0&&o!=null&&S(n,["requests[]","outputDimensionality"],o),b(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(b(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function Mte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["contents"]);s!=null&&S(n,["requests[]","content"],n3(t,s));const i=b(e,["config"]);i!=null&&S(n,["config"],Dte(t,i,n));const o=b(e,["model"]);return o!==void 0&&S(n,["requests[]","model"],cr(t,o)),n}function Lte(t,e,n){const r={};if(b(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(b(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=b(e,["numberOfImages"]);n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s);const i=b(e,["aspectRatio"]);n!==void 0&&i!=null&&S(n,["parameters","aspectRatio"],i);const o=b(e,["guidanceScale"]);if(n!==void 0&&o!=null&&S(n,["parameters","guidanceScale"],o),b(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=b(e,["safetyFilterLevel"]);n!==void 0&&l!=null&&S(n,["parameters","safetySetting"],l);const c=b(e,["personGeneration"]);n!==void 0&&c!=null&&S(n,["parameters","personGeneration"],c);const u=b(e,["includeSafetyAttributes"]);n!==void 0&&u!=null&&S(n,["parameters","includeSafetyAttributes"],u);const d=b(e,["includeRaiReason"]);n!==void 0&&d!=null&&S(n,["parameters","includeRaiReason"],d);const h=b(e,["language"]);n!==void 0&&h!=null&&S(n,["parameters","language"],h);const f=b(e,["outputMimeType"]);n!==void 0&&f!=null&&S(n,["parameters","outputOptions","mimeType"],f);const m=b(e,["outputCompressionQuality"]);if(n!==void 0&&m!=null&&S(n,["parameters","outputOptions","compressionQuality"],m),b(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(b(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Fte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],Lte(t,i,n)),n}function Ote(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],cr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function $te(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);n!==void 0&&o!=null&&S(n,["_query","filter"],o);const l=b(e,["queryBase"]);return n!==void 0&&l!=null&&S(n,["_url","models_url"],a3(t,l)),r}function Vte(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],$te(t,r,n)),n}function Ute(t,e,n){const r={},s=b(e,["displayName"]);n!==void 0&&s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);n!==void 0&&i!=null&&S(n,["description"],i);const o=b(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&S(n,["defaultCheckpointId"],o),r}function Bte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],cr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],Ute(t,s,n)),n}function zte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],cr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Gte(t,e){const n={};if(b(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(b(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(b(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return n}function Wte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["contents"]);if(s!=null){let o=Fc(t,s);Array.isArray(o)&&(o=o.map(l=>M0(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],Gte(t,i)),n}function Hte(t,e){const n={};if(b(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=b(e,["imageBytes"]);r!=null&&S(n,["bytesBase64Encoded"],$c(t,r));const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function qte(t,e,n){const r={},s=b(e,["numberOfVideos"]);if(n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s),b(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(b(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=b(e,["durationSeconds"]);if(n!==void 0&&i!=null&&S(n,["parameters","durationSeconds"],i),b(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=b(e,["aspectRatio"]);if(n!==void 0&&o!=null&&S(n,["parameters","aspectRatio"],o),b(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=b(e,["personGeneration"]);if(n!==void 0&&l!=null&&S(n,["parameters","personGeneration"],l),b(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=b(e,["negativePrompt"]);if(n!==void 0&&c!=null&&S(n,["parameters","negativePrompt"],c),b(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function Kte(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["image"]);i!=null&&S(n,["instances[0]","image"],Hte(t,i));const o=b(e,["config"]);return o!=null&&S(n,["config"],qte(t,o,n)),n}function Yte(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Jte(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],Yte(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function kf(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Jte(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function Xte(t,e){const n={},r=b(e,["featureSelectionPreference"]);return r!=null&&S(n,["featureSelectionPreference"],r),n}function Qte(t,e){const n={},r=b(e,["method"]);r!=null&&S(n,["method"],r);const s=b(e,["category"]);s!=null&&S(n,["category"],s);const i=b(e,["threshold"]);return i!=null&&S(n,["threshold"],i),n}function Zte(){return{}}function ene(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["dynamicThreshold"]);return s!=null&&S(n,["dynamicThreshold"],s),n}function tne(t,e){const n={},r=b(e,["dynamicRetrievalConfig"]);return r!=null&&S(n,["dynamicRetrievalConfig"],ene(t,r)),n}function nne(){return{}}function rne(t,e){const n={},r=b(e,["apiKeyString"]);return r!=null&&S(n,["apiKeyString"],r),n}function sne(t,e){const n={},r=b(e,["apiKeyConfig"]);r!=null&&S(n,["apiKeyConfig"],rne(t,r));const s=b(e,["authType"]);s!=null&&S(n,["authType"],s);const i=b(e,["googleServiceAccountConfig"]);i!=null&&S(n,["googleServiceAccountConfig"],i);const o=b(e,["httpBasicAuthConfig"]);o!=null&&S(n,["httpBasicAuthConfig"],o);const l=b(e,["oauthConfig"]);l!=null&&S(n,["oauthConfig"],l);const c=b(e,["oidcConfig"]);return c!=null&&S(n,["oidcConfig"],c),n}function ine(t,e){const n={},r=b(e,["authConfig"]);return r!=null&&S(n,["authConfig"],sne(t,r)),n}function u3(t,e){const n={},r=b(e,["retrieval"]);r!=null&&S(n,["retrieval"],r),b(e,["googleSearch"])!=null&&S(n,["googleSearch"],Zte());const i=b(e,["googleSearchRetrieval"]);i!=null&&S(n,["googleSearchRetrieval"],tne(t,i)),b(e,["enterpriseWebSearch"])!=null&&S(n,["enterpriseWebSearch"],nne());const l=b(e,["googleMaps"]);l!=null&&S(n,["googleMaps"],ine(t,l));const c=b(e,["codeExecution"]);c!=null&&S(n,["codeExecution"],c);const u=b(e,["functionDeclarations"]);return u!=null&&S(n,["functionDeclarations"],u),n}function one(t,e){const n={},r=b(e,["mode"]);r!=null&&S(n,["mode"],r);const s=b(e,["allowedFunctionNames"]);return s!=null&&S(n,["allowedFunctionNames"],s),n}function ane(t,e){const n={},r=b(e,["latitude"]);r!=null&&S(n,["latitude"],r);const s=b(e,["longitude"]);return s!=null&&S(n,["longitude"],s),n}function lne(t,e){const n={},r=b(e,["latLng"]);return r!=null&&S(n,["latLng"],ane(t,r)),n}function cne(t,e){const n={},r=b(e,["functionCallingConfig"]);r!=null&&S(n,["functionCallingConfig"],one(t,r));const s=b(e,["retrievalConfig"]);return s!=null&&S(n,["retrievalConfig"],lne(t,s)),n}function une(t,e){const n={},r=b(e,["voiceName"]);return r!=null&&S(n,["voiceName"],r),n}function dne(t,e){const n={},r=b(e,["prebuiltVoiceConfig"]);return r!=null&&S(n,["prebuiltVoiceConfig"],une(t,r)),n}function hne(t,e){const n={},r=b(e,["voiceConfig"]);r!=null&&S(n,["voiceConfig"],dne(t,r));const s=b(e,["languageCode"]);return s!=null&&S(n,["languageCode"],s),n}function fne(t,e){const n={},r=b(e,["includeThoughts"]);r!=null&&S(n,["includeThoughts"],r);const s=b(e,["thinkingBudget"]);return s!=null&&S(n,["thinkingBudget"],s),n}function mne(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],kf(t,di(t,s)));const i=b(e,["temperature"]);i!=null&&S(r,["temperature"],i);const o=b(e,["topP"]);o!=null&&S(r,["topP"],o);const l=b(e,["topK"]);l!=null&&S(r,["topK"],l);const c=b(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const u=b(e,["maxOutputTokens"]);u!=null&&S(r,["maxOutputTokens"],u);const d=b(e,["stopSequences"]);d!=null&&S(r,["stopSequences"],d);const h=b(e,["responseLogprobs"]);h!=null&&S(r,["responseLogprobs"],h);const f=b(e,["logprobs"]);f!=null&&S(r,["logprobs"],f);const m=b(e,["presencePenalty"]);m!=null&&S(r,["presencePenalty"],m);const g=b(e,["frequencyPenalty"]);g!=null&&S(r,["frequencyPenalty"],g);const x=b(e,["seed"]);x!=null&&S(r,["seed"],x);const w=b(e,["responseMimeType"]);w!=null&&S(r,["responseMimeType"],w);const v=b(e,["responseSchema"]);v!=null&&S(r,["responseSchema"],r3(t,v));const _=b(e,["routingConfig"]);_!=null&&S(r,["routingConfig"],_);const C=b(e,["modelSelectionConfig"]);C!=null&&S(r,["modelConfig"],Xte(t,C));const T=b(e,["safetySettings"]);if(n!==void 0&&T!=null){let z=T;Array.isArray(z)&&(z=z.map(U=>Qte(t,U))),S(n,["safetySettings"],z)}const R=b(e,["tools"]);if(n!==void 0&&R!=null){let z=j0(t,R);Array.isArray(z)&&(z=z.map(U=>u3(t,R0(t,U)))),S(n,["tools"],z)}const k=b(e,["toolConfig"]);n!==void 0&&k!=null&&S(n,["toolConfig"],cne(t,k));const E=b(e,["labels"]);n!==void 0&&E!=null&&S(n,["labels"],E);const I=b(e,["cachedContent"]);n!==void 0&&I!=null&&S(n,["cachedContent"],Oc(t,I));const P=b(e,["responseModalities"]);P!=null&&S(r,["responseModalities"],P);const A=b(e,["mediaResolution"]);A!=null&&S(r,["mediaResolution"],A);const D=b(e,["speechConfig"]);D!=null&&S(r,["speechConfig"],hne(t,s3(t,D)));const j=b(e,["audioTimestamp"]);j!=null&&S(r,["audioTimestamp"],j);const M=b(e,["thinkingConfig"]);return M!=null&&S(r,["thinkingConfig"],fne(t,M)),r}function p2(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["contents"]);if(s!=null){let o=Fc(t,s);Array.isArray(o)&&(o=o.map(l=>kf(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["generationConfig"],mne(t,i,n)),n}function pne(t,e,n){const r={},s=b(e,["taskType"]);n!==void 0&&s!=null&&S(n,["instances[]","task_type"],s);const i=b(e,["title"]);n!==void 0&&i!=null&&S(n,["instances[]","title"],i);const o=b(e,["outputDimensionality"]);n!==void 0&&o!=null&&S(n,["parameters","outputDimensionality"],o);const l=b(e,["mimeType"]);n!==void 0&&l!=null&&S(n,["instances[]","mimeType"],l);const c=b(e,["autoTruncate"]);return n!==void 0&&c!=null&&S(n,["parameters","autoTruncate"],c),r}function gne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["contents"]);s!=null&&S(n,["instances[]","content"],n3(t,s));const i=b(e,["config"]);return i!=null&&S(n,["config"],pne(t,i,n)),n}function yne(t,e,n){const r={},s=b(e,["outputGcsUri"]);n!==void 0&&s!=null&&S(n,["parameters","storageUri"],s);const i=b(e,["negativePrompt"]);n!==void 0&&i!=null&&S(n,["parameters","negativePrompt"],i);const o=b(e,["numberOfImages"]);n!==void 0&&o!=null&&S(n,["parameters","sampleCount"],o);const l=b(e,["aspectRatio"]);n!==void 0&&l!=null&&S(n,["parameters","aspectRatio"],l);const c=b(e,["guidanceScale"]);n!==void 0&&c!=null&&S(n,["parameters","guidanceScale"],c);const u=b(e,["seed"]);n!==void 0&&u!=null&&S(n,["parameters","seed"],u);const d=b(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&S(n,["parameters","safetySetting"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&S(n,["parameters","includeSafetyAttributes"],f);const m=b(e,["includeRaiReason"]);n!==void 0&&m!=null&&S(n,["parameters","includeRaiReason"],m);const g=b(e,["language"]);n!==void 0&&g!=null&&S(n,["parameters","language"],g);const x=b(e,["outputMimeType"]);n!==void 0&&x!=null&&S(n,["parameters","outputOptions","mimeType"],x);const w=b(e,["outputCompressionQuality"]);n!==void 0&&w!=null&&S(n,["parameters","outputOptions","compressionQuality"],w);const v=b(e,["addWatermark"]);n!==void 0&&v!=null&&S(n,["parameters","addWatermark"],v);const _=b(e,["enhancePrompt"]);return n!==void 0&&_!=null&&S(n,["parameters","enhancePrompt"],_),r}function xne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],yne(t,i,n)),n}function CI(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["gcsUri"],r);const s=b(e,["imageBytes"]);s!=null&&S(n,["bytesBase64Encoded"],$c(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function vne(t,e){const n={},r=b(e,["maskMode"]);r!=null&&S(n,["maskMode"],r);const s=b(e,["segmentationClasses"]);s!=null&&S(n,["maskClasses"],s);const i=b(e,["maskDilation"]);return i!=null&&S(n,["dilation"],i),n}function wne(t,e){const n={},r=b(e,["controlType"]);r!=null&&S(n,["controlType"],r);const s=b(e,["enableControlImageComputation"]);return s!=null&&S(n,["computeControl"],s),n}function bne(t,e){const n={},r=b(e,["styleDescription"]);return r!=null&&S(n,["styleDescription"],r),n}function _ne(t,e){const n={},r=b(e,["subjectType"]);r!=null&&S(n,["subjectType"],r);const s=b(e,["subjectDescription"]);return s!=null&&S(n,["subjectDescription"],s),n}function Sne(t,e){const n={},r=b(e,["referenceImage"]);r!=null&&S(n,["referenceImage"],CI(t,r));const s=b(e,["referenceId"]);s!=null&&S(n,["referenceId"],s);const i=b(e,["referenceType"]);i!=null&&S(n,["referenceType"],i);const o=b(e,["maskImageConfig"]);o!=null&&S(n,["maskImageConfig"],vne(t,o));const l=b(e,["controlImageConfig"]);l!=null&&S(n,["controlImageConfig"],wne(t,l));const c=b(e,["styleImageConfig"]);c!=null&&S(n,["styleImageConfig"],bne(t,c));const u=b(e,["subjectImageConfig"]);return u!=null&&S(n,["subjectImageConfig"],_ne(t,u)),n}function Cne(t,e,n){const r={},s=b(e,["outputGcsUri"]);n!==void 0&&s!=null&&S(n,["parameters","storageUri"],s);const i=b(e,["negativePrompt"]);n!==void 0&&i!=null&&S(n,["parameters","negativePrompt"],i);const o=b(e,["numberOfImages"]);n!==void 0&&o!=null&&S(n,["parameters","sampleCount"],o);const l=b(e,["aspectRatio"]);n!==void 0&&l!=null&&S(n,["parameters","aspectRatio"],l);const c=b(e,["guidanceScale"]);n!==void 0&&c!=null&&S(n,["parameters","guidanceScale"],c);const u=b(e,["seed"]);n!==void 0&&u!=null&&S(n,["parameters","seed"],u);const d=b(e,["safetyFilterLevel"]);n!==void 0&&d!=null&&S(n,["parameters","safetySetting"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["includeSafetyAttributes"]);n!==void 0&&f!=null&&S(n,["parameters","includeSafetyAttributes"],f);const m=b(e,["includeRaiReason"]);n!==void 0&&m!=null&&S(n,["parameters","includeRaiReason"],m);const g=b(e,["language"]);n!==void 0&&g!=null&&S(n,["parameters","language"],g);const x=b(e,["outputMimeType"]);n!==void 0&&x!=null&&S(n,["parameters","outputOptions","mimeType"],x);const w=b(e,["outputCompressionQuality"]);n!==void 0&&w!=null&&S(n,["parameters","outputOptions","compressionQuality"],w);const v=b(e,["editMode"]);n!==void 0&&v!=null&&S(n,["parameters","editMode"],v);const _=b(e,["baseSteps"]);return n!==void 0&&_!=null&&S(n,["parameters","editConfig","baseSteps"],_),r}function Ene(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["referenceImages"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>Sne(t,c))),S(n,["instances[0]","referenceImages"],l)}const o=b(e,["config"]);return o!=null&&S(n,["config"],Cne(t,o,n)),n}function Tne(t,e,n){const r={},s=b(e,["includeRaiReason"]);n!==void 0&&s!=null&&S(n,["parameters","includeRaiReason"],s);const i=b(e,["outputMimeType"]);n!==void 0&&i!=null&&S(n,["parameters","outputOptions","mimeType"],i);const o=b(e,["outputCompressionQuality"]);n!==void 0&&o!=null&&S(n,["parameters","outputOptions","compressionQuality"],o);const l=b(e,["numberOfImages"]);n!==void 0&&l!=null&&S(n,["parameters","sampleCount"],l);const c=b(e,["mode"]);return n!==void 0&&c!=null&&S(n,["parameters","mode"],c),r}function Ine(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["image"]);s!=null&&S(n,["instances[0]","image"],CI(t,s));const i=b(e,["upscaleFactor"]);i!=null&&S(n,["parameters","upscaleConfig","upscaleFactor"],i);const o=b(e,["config"]);return o!=null&&S(n,["config"],Tne(t,o,n)),n}function Nne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],cr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Pne(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);n!==void 0&&o!=null&&S(n,["_query","filter"],o);const l=b(e,["queryBase"]);return n!==void 0&&l!=null&&S(n,["_url","models_url"],a3(t,l)),r}function Ane(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],Pne(t,r,n)),n}function kne(t,e,n){const r={},s=b(e,["displayName"]);n!==void 0&&s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);n!==void 0&&i!=null&&S(n,["description"],i);const o=b(e,["defaultCheckpointId"]);return n!==void 0&&o!=null&&S(n,["defaultCheckpointId"],o),r}function Rne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],kne(t,s,n)),n}function jne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","name"],cr(t,r));const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Dne(t,e,n){const r={},s=b(e,["systemInstruction"]);n!==void 0&&s!=null&&S(n,["systemInstruction"],kf(t,di(t,s)));const i=b(e,["tools"]);if(n!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>u3(t,c))),S(n,["tools"],l)}const o=b(e,["generationConfig"]);return n!==void 0&&o!=null&&S(n,["generationConfig"],o),r}function Mne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["contents"]);if(s!=null){let o=Fc(t,s);Array.isArray(o)&&(o=o.map(l=>kf(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],Dne(t,i,n)),n}function Lne(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["contents"]);if(s!=null){let o=Fc(t,s);Array.isArray(o)&&(o=o.map(l=>kf(t,l))),S(n,["contents"],o)}const i=b(e,["config"]);return i!=null&&S(n,["config"],i),n}function Fne(t,e,n){const r={},s=b(e,["numberOfVideos"]);n!==void 0&&s!=null&&S(n,["parameters","sampleCount"],s);const i=b(e,["outputGcsUri"]);n!==void 0&&i!=null&&S(n,["parameters","storageUri"],i);const o=b(e,["fps"]);n!==void 0&&o!=null&&S(n,["parameters","fps"],o);const l=b(e,["durationSeconds"]);n!==void 0&&l!=null&&S(n,["parameters","durationSeconds"],l);const c=b(e,["seed"]);n!==void 0&&c!=null&&S(n,["parameters","seed"],c);const u=b(e,["aspectRatio"]);n!==void 0&&u!=null&&S(n,["parameters","aspectRatio"],u);const d=b(e,["resolution"]);n!==void 0&&d!=null&&S(n,["parameters","resolution"],d);const h=b(e,["personGeneration"]);n!==void 0&&h!=null&&S(n,["parameters","personGeneration"],h);const f=b(e,["pubsubTopic"]);n!==void 0&&f!=null&&S(n,["parameters","pubsubTopic"],f);const m=b(e,["negativePrompt"]);n!==void 0&&m!=null&&S(n,["parameters","negativePrompt"],m);const g=b(e,["enhancePrompt"]);return n!==void 0&&g!=null&&S(n,["parameters","enhancePrompt"],g),r}function One(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["_url","model"],cr(t,r));const s=b(e,["prompt"]);s!=null&&S(n,["instances[0]","prompt"],s);const i=b(e,["image"]);i!=null&&S(n,["instances[0]","image"],CI(t,i));const o=b(e,["config"]);return o!=null&&S(n,["config"],Fne(t,o,n)),n}function $ne(t,e){const n={},r=b(e,["data"]);r!=null&&S(n,["data"],r);const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function Vne(t,e){const n={},r=b(e,["thought"]);r!=null&&S(n,["thought"],r);const s=b(e,["inlineData"]);s!=null&&S(n,["inlineData"],$ne(t,s));const i=b(e,["codeExecutionResult"]);i!=null&&S(n,["codeExecutionResult"],i);const o=b(e,["executableCode"]);o!=null&&S(n,["executableCode"],o);const l=b(e,["fileData"]);l!=null&&S(n,["fileData"],l);const c=b(e,["functionCall"]);c!=null&&S(n,["functionCall"],c);const u=b(e,["functionResponse"]);u!=null&&S(n,["functionResponse"],u);const d=b(e,["text"]);return d!=null&&S(n,["text"],d),n}function Une(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Vne(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function Bne(t,e){const n={},r=b(e,["citationSources"]);return r!=null&&S(n,["citations"],r),n}function zne(t,e){const n={},r=b(e,["content"]);r!=null&&S(n,["content"],Une(t,r));const s=b(e,["citationMetadata"]);s!=null&&S(n,["citationMetadata"],Bne(t,s));const i=b(e,["tokenCount"]);i!=null&&S(n,["tokenCount"],i);const o=b(e,["finishReason"]);o!=null&&S(n,["finishReason"],o);const l=b(e,["avgLogprobs"]);l!=null&&S(n,["avgLogprobs"],l);const c=b(e,["groundingMetadata"]);c!=null&&S(n,["groundingMetadata"],c);const u=b(e,["index"]);u!=null&&S(n,["index"],u);const d=b(e,["logprobsResult"]);d!=null&&S(n,["logprobsResult"],d);const h=b(e,["safetyRatings"]);return h!=null&&S(n,["safetyRatings"],h),n}function g2(t,e){const n={},r=b(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>zne(t,c))),S(n,["candidates"],l)}const s=b(e,["modelVersion"]);s!=null&&S(n,["modelVersion"],s);const i=b(e,["promptFeedback"]);i!=null&&S(n,["promptFeedback"],i);const o=b(e,["usageMetadata"]);return o!=null&&S(n,["usageMetadata"],o),n}function Gne(t,e){const n={},r=b(e,["values"]);return r!=null&&S(n,["values"],r),n}function Wne(){return{}}function Hne(t,e){const n={},r=b(e,["embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Gne(t,o))),S(n,["embeddings"],i)}return b(e,["metadata"])!=null&&S(n,["metadata"],Wne()),n}function qne(t,e){const n={},r=b(e,["bytesBase64Encoded"]);r!=null&&S(n,["imageBytes"],$c(t,r));const s=b(e,["mimeType"]);return s!=null&&S(n,["mimeType"],s),n}function d3(t,e){const n={},r=b(e,["safetyAttributes","categories"]);r!=null&&S(n,["categories"],r);const s=b(e,["safetyAttributes","scores"]);s!=null&&S(n,["scores"],s);const i=b(e,["contentType"]);return i!=null&&S(n,["contentType"],i),n}function Kne(t,e){const n={},r=b(e,["_self"]);r!=null&&S(n,["image"],qne(t,r));const s=b(e,["raiFilteredReason"]);s!=null&&S(n,["raiFilteredReason"],s);const i=b(e,["_self"]);return i!=null&&S(n,["safetyAttributes"],d3(t,i)),n}function Yne(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Kne(t,o))),S(n,["generatedImages"],i)}const s=b(e,["positivePromptSafetyAttributes"]);return s!=null&&S(n,["positivePromptSafetyAttributes"],d3(t,s)),n}function Jne(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["updateTime"]);return i!=null&&S(n,["updateTime"],i),n}function CE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);i!=null&&S(n,["description"],i);const o=b(e,["version"]);o!=null&&S(n,["version"],o);const l=b(e,["_self"]);l!=null&&S(n,["tunedModelInfo"],Jne(t,l));const c=b(e,["inputTokenLimit"]);c!=null&&S(n,["inputTokenLimit"],c);const u=b(e,["outputTokenLimit"]);u!=null&&S(n,["outputTokenLimit"],u);const d=b(e,["supportedGenerationMethods"]);return d!=null&&S(n,["supportedActions"],d),n}function Xne(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["_self"]);if(s!=null){let i=l3(t,s);Array.isArray(i)&&(i=i.map(o=>CE(t,o))),S(n,["models"],i)}return n}function Qne(){return{}}function Zne(t,e){const n={},r=b(e,["totalTokens"]);r!=null&&S(n,["totalTokens"],r);const s=b(e,["cachedContentTokenCount"]);return s!=null&&S(n,["cachedContentTokenCount"],s),n}function ere(t,e){const n={},r=b(e,["video","uri"]);r!=null&&S(n,["uri"],r);const s=b(e,["video","encodedVideo"]);s!=null&&S(n,["videoBytes"],$c(t,s));const i=b(e,["encoding"]);return i!=null&&S(n,["mimeType"],i),n}function tre(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],ere(t,r)),n}function nre(t,e){const n={},r=b(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>tre(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function rre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response","generateVideoResponse"]);return l!=null&&S(n,["response"],nre(t,l)),n}function sre(t,e){const n={},r=b(e,["displayName"]);r!=null&&S(n,["displayName"],r);const s=b(e,["data"]);s!=null&&S(n,["data"],s);const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function ire(t,e){const n={},r=b(e,["videoMetadata"]);r!=null&&S(n,["videoMetadata"],r);const s=b(e,["thought"]);s!=null&&S(n,["thought"],s);const i=b(e,["inlineData"]);i!=null&&S(n,["inlineData"],sre(t,i));const o=b(e,["codeExecutionResult"]);o!=null&&S(n,["codeExecutionResult"],o);const l=b(e,["executableCode"]);l!=null&&S(n,["executableCode"],l);const c=b(e,["fileData"]);c!=null&&S(n,["fileData"],c);const u=b(e,["functionCall"]);u!=null&&S(n,["functionCall"],u);const d=b(e,["functionResponse"]);d!=null&&S(n,["functionResponse"],d);const h=b(e,["text"]);return h!=null&&S(n,["text"],h),n}function ore(t,e){const n={},r=b(e,["parts"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>ire(t,o))),S(n,["parts"],i)}const s=b(e,["role"]);return s!=null&&S(n,["role"],s),n}function are(t,e){const n={},r=b(e,["citations"]);return r!=null&&S(n,["citations"],r),n}function lre(t,e){const n={},r=b(e,["content"]);r!=null&&S(n,["content"],ore(t,r));const s=b(e,["citationMetadata"]);s!=null&&S(n,["citationMetadata"],are(t,s));const i=b(e,["finishMessage"]);i!=null&&S(n,["finishMessage"],i);const o=b(e,["finishReason"]);o!=null&&S(n,["finishReason"],o);const l=b(e,["avgLogprobs"]);l!=null&&S(n,["avgLogprobs"],l);const c=b(e,["groundingMetadata"]);c!=null&&S(n,["groundingMetadata"],c);const u=b(e,["index"]);u!=null&&S(n,["index"],u);const d=b(e,["logprobsResult"]);d!=null&&S(n,["logprobsResult"],d);const h=b(e,["safetyRatings"]);return h!=null&&S(n,["safetyRatings"],h),n}function y2(t,e){const n={},r=b(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(d=>lre(t,d))),S(n,["candidates"],u)}const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["responseId"]);i!=null&&S(n,["responseId"],i);const o=b(e,["modelVersion"]);o!=null&&S(n,["modelVersion"],o);const l=b(e,["promptFeedback"]);l!=null&&S(n,["promptFeedback"],l);const c=b(e,["usageMetadata"]);return c!=null&&S(n,["usageMetadata"],c),n}function cre(t,e){const n={},r=b(e,["truncated"]);r!=null&&S(n,["truncated"],r);const s=b(e,["token_count"]);return s!=null&&S(n,["tokenCount"],s),n}function ure(t,e){const n={},r=b(e,["values"]);r!=null&&S(n,["values"],r);const s=b(e,["statistics"]);return s!=null&&S(n,["statistics"],cre(t,s)),n}function dre(t,e){const n={},r=b(e,["billableCharacterCount"]);return r!=null&&S(n,["billableCharacterCount"],r),n}function hre(t,e){const n={},r=b(e,["predictions[]","embeddings"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>ure(t,o))),S(n,["embeddings"],i)}const s=b(e,["metadata"]);return s!=null&&S(n,["metadata"],dre(t,s)),n}function fre(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["gcsUri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["imageBytes"],$c(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function h3(t,e){const n={},r=b(e,["safetyAttributes","categories"]);r!=null&&S(n,["categories"],r);const s=b(e,["safetyAttributes","scores"]);s!=null&&S(n,["scores"],s);const i=b(e,["contentType"]);return i!=null&&S(n,["contentType"],i),n}function EI(t,e){const n={},r=b(e,["_self"]);r!=null&&S(n,["image"],fre(t,r));const s=b(e,["raiFilteredReason"]);s!=null&&S(n,["raiFilteredReason"],s);const i=b(e,["_self"]);i!=null&&S(n,["safetyAttributes"],h3(t,i));const o=b(e,["prompt"]);return o!=null&&S(n,["enhancedPrompt"],o),n}function mre(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>EI(t,o))),S(n,["generatedImages"],i)}const s=b(e,["positivePromptSafetyAttributes"]);return s!=null&&S(n,["positivePromptSafetyAttributes"],h3(t,s)),n}function pre(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>EI(t,i))),S(n,["generatedImages"],s)}return n}function gre(t,e){const n={},r=b(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>EI(t,i))),S(n,["generatedImages"],s)}return n}function yre(t,e){const n={},r=b(e,["endpoint"]);r!=null&&S(n,["name"],r);const s=b(e,["deployedModelId"]);return s!=null&&S(n,["deployedModelId"],s),n}function xre(t,e){const n={},r=b(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["createTime"]);s!=null&&S(n,["createTime"],s);const i=b(e,["updateTime"]);return i!=null&&S(n,["updateTime"],i),n}function vre(t,e){const n={},r=b(e,["checkpointId"]);r!=null&&S(n,["checkpointId"],r);const s=b(e,["epoch"]);s!=null&&S(n,["epoch"],s);const i=b(e,["step"]);return i!=null&&S(n,["step"],i),n}function EE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["displayName"]);s!=null&&S(n,["displayName"],s);const i=b(e,["description"]);i!=null&&S(n,["description"],i);const o=b(e,["versionId"]);o!=null&&S(n,["version"],o);const l=b(e,["deployedModels"]);if(l!=null){let f=l;Array.isArray(f)&&(f=f.map(m=>yre(t,m))),S(n,["endpoints"],f)}const c=b(e,["labels"]);c!=null&&S(n,["labels"],c);const u=b(e,["_self"]);u!=null&&S(n,["tunedModelInfo"],xre(t,u));const d=b(e,["defaultCheckpointId"]);d!=null&&S(n,["defaultCheckpointId"],d);const h=b(e,["checkpoints"]);if(h!=null){let f=h;Array.isArray(f)&&(f=f.map(m=>vre(t,m))),S(n,["checkpoints"],f)}return n}function wre(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["_self"]);if(s!=null){let i=l3(t,s);Array.isArray(i)&&(i=i.map(o=>EE(t,o))),S(n,["models"],i)}return n}function bre(){return{}}function _re(t,e){const n={},r=b(e,["totalTokens"]);return r!=null&&S(n,["totalTokens"],r),n}function Sre(t,e){const n={},r=b(e,["tokensInfo"]);return r!=null&&S(n,["tokensInfo"],r),n}function Cre(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["uri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["videoBytes"],$c(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Ere(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],Cre(t,r)),n}function Tre(t,e){const n={},r=b(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Ere(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function Ire(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response"]);return l!=null&&S(n,["response"],Tre(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Nre="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function Pre(t,e,n){const r=new qZ;let s;if(n.data instanceof Blob?s=JSON.parse(await n.data.text()):s=JSON.parse(n.data),t.isVertexAI()){const i=vte(t,s);Object.assign(r,i)}else{const i=xte(t,s);Object.assign(r,i)}e(r)}class Are{constructor(e,n,r){this.apiClient=e,this.auth=n,this.webSocketFactory=r}async connect(e){var n,r,s,i;const o=this.apiClient.getWebsocketBaseUrl(),l=this.apiClient.getApiVersion();let c;const u=Dre(this.apiClient.getDefaultHeaders());if(this.apiClient.isVertexAI())c=`${o}/ws/google.cloud.aiplatform.${l}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(u);else{const T=this.apiClient.getApiKey();c=`${o}/ws/google.ai.generativelanguage.${l}.GenerativeService.BidiGenerateContent?key=${T}`}let d=()=>{};const h=new Promise(T=>{d=T}),f=e.callbacks,m=function(){var T;(T=f==null?void 0:f.onopen)===null||T===void 0||T.call(f),d({})},g=this.apiClient,x={onopen:m,onmessage:T=>{Pre(g,f.onmessage,T)},onerror:(n=f==null?void 0:f.onerror)!==null&&n!==void 0?n:function(T){},onclose:(r=f==null?void 0:f.onclose)!==null&&r!==void 0?r:function(T){}},w=this.webSocketFactory.create(c,jre(u),x);w.connect(),await h;let v=cr(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&v.startsWith("publishers/")){const T=this.apiClient.getProject(),R=this.apiClient.getLocation();v=`projects/${T}/locations/${R}/`+v}let _={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[yn.AUDIO]}:e.config.responseModalities=[yn.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const C={model:v,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?_=zee(this.apiClient,C):_=Bee(this.apiClient,C),delete _.config,w.send(JSON.stringify(_)),new Rre(w,this.apiClient)}}const kre={turnComplete:!0};class Rre{constructor(e,n){this.conn=e,this.apiClient=n}tLiveClientContent(e,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=Fc(e,n.turns),e.isVertexAI()?r=r.map(s=>kf(e,s)):r=r.map(s=>M0(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(e,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const i of r){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(Nre)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},kre),e);const n=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(n))}sendRealtimeInput(e){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Yee(this.apiClient,e)}:n={realtimeInput:Kee(this.apiClient,e)},this.conn.send(JSON.stringify(n))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function jre(t){const e={};return t.forEach((n,r)=>{e[r]=n}),e}function Dre(t){const e=new Headers;for(const[n,r]of Object.entries(t))e.append(n,r);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let Mre=class extends Cg{constructor(e){super(),this.apiClient=e,this.generateContent=async n=>await this.generateContentInternal(n),this.generateContentStream=async n=>await this.generateContentStreamInternal(n),this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var s;let i;const o=[];if(r!=null&&r.generatedImages)for(const c of r.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((s=c==null?void 0:c.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?i=c==null?void 0:c.safetyAttributes:o.push(c);let l;return i?l={generatedImages:o,positivePromptSafetyAttributes:i}:l={generatedImages:o},l}),this.list=async n=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new D0(Zh.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const s={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async generateContentInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=p2(this.apiClient,e);return l=zt("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=y2(this.apiClient,d),f=new Uy;return Object.assign(f,h),f})}else{const u=m2(this.apiClient,e);return l=zt("{model}:generateContent",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=g2(this.apiClient,d),f=new Uy;return Object.assign(f,h),f})}}async generateContentStreamInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=p2(this.apiClient,e);l=zt("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(h){return Qv(this,arguments,function*(){var f,m,g,x;try{for(var w=!0,v=_E(h),_;_=yield ks(v.next()),f=_.done,!f;w=!0){x=_.value,w=!1;const T=y2(d,yield ks(x.json())),R=new Uy;Object.assign(R,T),yield yield ks(R)}}catch(C){m={error:C}}finally{try{!w&&!f&&(g=v.return)&&(yield ks(g.call(v)))}finally{if(m)throw m.error}}})})}else{const u=m2(this.apiClient,e);l=zt("{model}:streamGenerateContent?alt=sse",u._url),c=u._query,delete u.config,delete u._url,delete u._query;const d=this.apiClient;return o=d.requestStream({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(h){return Qv(this,arguments,function*(){var f,m,g,x;try{for(var w=!0,v=_E(h),_;_=yield ks(v.next()),f=_.done,!f;w=!0){x=_.value,w=!1;const T=g2(d,yield ks(x.json())),R=new Uy;Object.assign(R,T),yield yield ks(R)}}catch(C){m={error:C}}finally{try{!w&&!f&&(g=v.return)&&(yield ks(g.call(v)))}finally{if(m)throw m.error}}})})}}async embedContent(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=gne(this.apiClient,e);return l=zt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=hre(this.apiClient,d),f=new t2;return Object.assign(f,h),f})}else{const u=Mte(this.apiClient,e);return l=zt("{model}:batchEmbedContents",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Hne(this.apiClient,d),f=new t2;return Object.assign(f,h),f})}}async generateImagesInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=xne(this.apiClient,e);return l=zt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=mre(this.apiClient,d),f=new n2;return Object.assign(f,h),f})}else{const u=Fte(this.apiClient,e);return l=zt("{model}:predict",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Yne(this.apiClient,d),f=new n2;return Object.assign(f,h),f})}}async editImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Ene(this.apiClient,e);return i=zt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=pre(this.apiClient,c),d=new UZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Ine(this.apiClient,e);return i=zt("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=gre(this.apiClient,c),d=new BZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Nne(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>EE(this.apiClient,d))}else{const u=Ote(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>CE(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Ane(this.apiClient,e);return l=zt("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=wre(this.apiClient,d),f=new r2;return Object.assign(f,h),f})}else{const u=Vte(this.apiClient,e);return l=zt("{models_url}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Xne(this.apiClient,d),f=new r2;return Object.assign(f,h),f})}}async update(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Rne(this.apiClient,e);return l=zt("{model}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>EE(this.apiClient,d))}else{const u=Bte(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>CE(this.apiClient,d))}}async delete(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=jne(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(()=>{const d=bre(),h=new s2;return Object.assign(h,d),h})}else{const u=zte(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(()=>{const d=Qne(),h=new s2;return Object.assign(h,d),h})}}async countTokens(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Mne(this.apiClient,e);return l=zt("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=_re(this.apiClient,d),f=new i2;return Object.assign(f,h),f})}else{const u=Wte(this.apiClient,e);return l=zt("{model}:countTokens",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=Zne(this.apiClient,d),f=new i2;return Object.assign(f,h),f})}}async computeTokens(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Lne(this.apiClient,e);return i=zt("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const u=Sre(this.apiClient,c),d=new zZ;return Object.assign(d,u),d})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=One(this.apiClient,e);return l=zt("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>Ire(this.apiClient,d))}else{const u=Kte(this.apiClient,e);return l=zt("{model}:predictLongRunning",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>rre(this.apiClient,d))}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Lre(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["_url","operationName"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Fre(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["_url","operationName"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function Ore(t,e){const n={},r=b(e,["operationName"]);r!=null&&S(n,["operationName"],r);const s=b(e,["resourceName"]);s!=null&&S(n,["_url","resourceName"],s);const i=b(e,["config"]);return i!=null&&S(n,["config"],i),n}function $re(t,e){const n={},r=b(e,["video","uri"]);r!=null&&S(n,["uri"],r);const s=b(e,["video","encodedVideo"]);s!=null&&S(n,["videoBytes"],$c(t,s));const i=b(e,["encoding"]);return i!=null&&S(n,["mimeType"],i),n}function Vre(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],$re(t,r)),n}function Ure(t,e){const n={},r=b(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Vre(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function Bre(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response","generateVideoResponse"]);return l!=null&&S(n,["response"],Ure(t,l)),n}function zre(t,e){const n={},r=b(e,["gcsUri"]);r!=null&&S(n,["uri"],r);const s=b(e,["bytesBase64Encoded"]);s!=null&&S(n,["videoBytes"],$c(t,s));const i=b(e,["mimeType"]);return i!=null&&S(n,["mimeType"],i),n}function Gre(t,e){const n={},r=b(e,["_self"]);return r!=null&&S(n,["video"],zre(t,r)),n}function Wre(t,e){const n={},r=b(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>Gre(t,l))),S(n,["generatedVideos"],o)}const s=b(e,["raiMediaFilteredCount"]);s!=null&&S(n,["raiMediaFilteredCount"],s);const i=b(e,["raiMediaFilteredReasons"]);return i!=null&&S(n,["raiMediaFilteredReasons"],i),n}function x2(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);o!=null&&S(n,["error"],o);const l=b(e,["response"]);return l!=null&&S(n,["response"],Wre(t,l)),n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Hre extends Cg{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const n=e.operation,r=e.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=n.name.split("/operations/")[0];let i;return r&&"httpOptions"in r&&(i=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:s,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:n.name,config:r})}async getVideosOperationInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=Fre(this.apiClient,e);return l=zt("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>x2(this.apiClient,d))}else{const u=Lre(this.apiClient,e);return l=zt("{operationName}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>Bre(this.apiClient,d))}}async fetchPredictVideosOperationInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=Ore(this.apiClient,e);return i=zt("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>x2(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const qre="Content-Type",Kre="X-Server-Timeout",Yre="User-Agent",Jre="x-goog-api-client",Xre="0.14.1",Qre=`google-genai-sdk/${Xre}`,Zre="v1beta1",ese="v1beta",v2=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class f3 extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class TE extends Error{constructor(e,n){n?super(e,{cause:n}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class tse{constructor(e){var n,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Zre,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:ese,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),n=new URL(e);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,n,r){const s=[this.getRequestUrlInternal(n)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.unaryApiCall(s,i,e.httpMethod)}patchHttpOptions(e,n){const r=JSON.parse(JSON.stringify(e));for(const[s,i]of Object.entries(n))typeof i=="object"?r[s]=Object.assign(Object.assign({},r[s]),i):i!==void 0&&(r[s]=i);return r}async requestStream(e){let n=this.clientOptions.httpOptions;e.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,n,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,n,e.abortSignal),this.streamApiCall(s,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,n,r){if(n&&n.timeout||r){const s=new AbortController,i=s.signal;n.timeout&&(n==null?void 0:n.timeout)>0&&setTimeout(()=>s.abort(),n.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=i}return e.headers=await this.getHeadersInternal(n),e}async unaryApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await w2(s),new bE(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,n,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},n),{method:r})).then(async s=>(await w2(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var n;return Qv(this,arguments,function*(){const s=(n=e==null?void 0:e.body)===null||n===void 0?void 0:n.getReader(),i=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield ks(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=i.decode(c);try{const h=JSON.parse(u);if("error"in h){const f=JSON.parse(JSON.stringify(h.error)),m=f.status,g=f.code,x=`got status: ${m}. ${JSON.stringify(h)}`;if(g>=400&&g<500)throw new f3(x);if(g>=500&&g<600)throw new TE(x)}}catch(h){const f=h;if(f.name==="ClientError"||f.name==="ServerError")throw h}o+=u;let d=o.match(v2);for(;d;){const h=d[1];try{const f=new Response(h,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ks(new bE(f)),o=o.slice(d[0].length),d=o.match(v2)}catch(f){throw new Error(`exception parsing stream chunk ${h}. ${f}`)}}}}finally{s.releaseLock()}})}async apiCall(e,n){return fetch(e,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},n=Qre+" "+this.clientOptions.userAgentExtra;return e[Yre]=n,e[Jre]=n,e[qre]="application/json",e}async getHeadersInternal(e){const n=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))n.append(r,s);e.timeout&&e.timeout>0&&n.append(Kre,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(e,n){var r;const s={};n!=null&&(s.mimeType=n.mimeType,s.name=n.name,s.displayName=n.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const i=this.clientOptions.uploader,o=await i.stat(e);s.sizeBytes=String(o.size);const l=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,n);return i.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,n){var r;let s={};n!=null&&n.httpOptions?s=n.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},o=await this.request({path:zt("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:s});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o==null?void 0:o.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function w2(t){var e;if(t===void 0)throw new TE("response is undefined");if(!t.ok){const n=t.status,r=t.statusText;let s;!((e=t.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await t.json():s={error:{message:await t.text(),code:t.status,status:t.statusText}};const i=`got status: ${n} ${r}. ${JSON.stringify(s)}`;throw n>=400&&n<500?new f3(i):n>=500&&n<600?new TE(i):new Error(i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nse(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function rse(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);return n!==void 0&&o!=null&&S(n,["_query","filter"],o),r}function sse(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],rse(t,r,n)),n}function ise(t,e){const n={},r=b(e,["textInput"]);r!=null&&S(n,["textInput"],r);const s=b(e,["output"]);return s!=null&&S(n,["output"],s),n}function ose(t,e){const n={};if(b(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=b(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(i=>ise(t,i))),S(n,["examples","examples"],s)}return n}function ase(t,e,n){const r={};if(b(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=b(e,["tunedModelDisplayName"]);if(n!==void 0&&s!=null&&S(n,["displayName"],s),b(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=b(e,["epochCount"]);n!==void 0&&i!=null&&S(n,["tuningTask","hyperparameters","epochCount"],i);const o=b(e,["learningRateMultiplier"]);if(o!=null&&S(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),b(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(b(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=b(e,["batchSize"]);n!==void 0&&l!=null&&S(n,["tuningTask","hyperparameters","batchSize"],l);const c=b(e,["learningRate"]);return n!==void 0&&c!=null&&S(n,["tuningTask","hyperparameters","learningRate"],c),r}function lse(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["trainingDataset"]);s!=null&&S(n,["tuningTask","trainingData"],ose(t,s));const i=b(e,["config"]);return i!=null&&S(n,["config"],ase(t,i,n)),n}function cse(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["_url","name"],r);const s=b(e,["config"]);return s!=null&&S(n,["config"],s),n}function use(t,e,n){const r={},s=b(e,["pageSize"]);n!==void 0&&s!=null&&S(n,["_query","pageSize"],s);const i=b(e,["pageToken"]);n!==void 0&&i!=null&&S(n,["_query","pageToken"],i);const o=b(e,["filter"]);return n!==void 0&&o!=null&&S(n,["_query","filter"],o),r}function dse(t,e){const n={},r=b(e,["config"]);return r!=null&&S(n,["config"],use(t,r,n)),n}function hse(t,e,n){const r={},s=b(e,["gcsUri"]);if(n!==void 0&&s!=null&&S(n,["supervisedTuningSpec","trainingDatasetUri"],s),b(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function fse(t,e){const n={},r=b(e,["gcsUri"]);return r!=null&&S(n,["validationDatasetUri"],r),n}function mse(t,e,n){const r={},s=b(e,["validationDataset"]);n!==void 0&&s!=null&&S(n,["supervisedTuningSpec"],fse(t,s));const i=b(e,["tunedModelDisplayName"]);n!==void 0&&i!=null&&S(n,["tunedModelDisplayName"],i);const o=b(e,["description"]);n!==void 0&&o!=null&&S(n,["description"],o);const l=b(e,["epochCount"]);n!==void 0&&l!=null&&S(n,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=b(e,["learningRateMultiplier"]);n!==void 0&&c!=null&&S(n,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const u=b(e,["exportLastCheckpointOnly"]);n!==void 0&&u!=null&&S(n,["supervisedTuningSpec","exportLastCheckpointOnly"],u);const d=b(e,["adapterSize"]);if(n!==void 0&&d!=null&&S(n,["supervisedTuningSpec","hyperParameters","adapterSize"],d),b(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(b(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function pse(t,e){const n={},r=b(e,["baseModel"]);r!=null&&S(n,["baseModel"],r);const s=b(e,["trainingDataset"]);s!=null&&S(n,["supervisedTuningSpec","trainingDatasetUri"],hse(t,s,n));const i=b(e,["config"]);return i!=null&&S(n,["config"],mse(t,i,n)),n}function gse(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["model"],r);const s=b(e,["name"]);return s!=null&&S(n,["endpoint"],s),n}function m3(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["state"]);s!=null&&S(n,["state"],i3(t,s));const i=b(e,["createTime"]);i!=null&&S(n,["createTime"],i);const o=b(e,["tuningTask","startTime"]);o!=null&&S(n,["startTime"],o);const l=b(e,["tuningTask","completeTime"]);l!=null&&S(n,["endTime"],l);const c=b(e,["updateTime"]);c!=null&&S(n,["updateTime"],c);const u=b(e,["description"]);u!=null&&S(n,["description"],u);const d=b(e,["baseModel"]);d!=null&&S(n,["baseModel"],d);const h=b(e,["_self"]);h!=null&&S(n,["tunedModel"],gse(t,h));const f=b(e,["distillationSpec"]);f!=null&&S(n,["distillationSpec"],f);const m=b(e,["experiment"]);m!=null&&S(n,["experiment"],m);const g=b(e,["labels"]);g!=null&&S(n,["labels"],g);const x=b(e,["pipelineJob"]);x!=null&&S(n,["pipelineJob"],x);const w=b(e,["tunedModelDisplayName"]);return w!=null&&S(n,["tunedModelDisplayName"],w),n}function yse(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["tunedModels"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>m3(t,o))),S(n,["tuningJobs"],i)}return n}function xse(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["metadata"]);s!=null&&S(n,["metadata"],s);const i=b(e,["done"]);i!=null&&S(n,["done"],i);const o=b(e,["error"]);return o!=null&&S(n,["error"],o),n}function vse(t,e){const n={},r=b(e,["checkpointId"]);r!=null&&S(n,["checkpointId"],r);const s=b(e,["epoch"]);s!=null&&S(n,["epoch"],s);const i=b(e,["step"]);i!=null&&S(n,["step"],i);const o=b(e,["endpoint"]);return o!=null&&S(n,["endpoint"],o),n}function wse(t,e){const n={},r=b(e,["model"]);r!=null&&S(n,["model"],r);const s=b(e,["endpoint"]);s!=null&&S(n,["endpoint"],s);const i=b(e,["checkpoints"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>vse(t,l))),S(n,["checkpoints"],o)}return n}function IE(t,e){const n={},r=b(e,["name"]);r!=null&&S(n,["name"],r);const s=b(e,["state"]);s!=null&&S(n,["state"],i3(t,s));const i=b(e,["createTime"]);i!=null&&S(n,["createTime"],i);const o=b(e,["startTime"]);o!=null&&S(n,["startTime"],o);const l=b(e,["endTime"]);l!=null&&S(n,["endTime"],l);const c=b(e,["updateTime"]);c!=null&&S(n,["updateTime"],c);const u=b(e,["error"]);u!=null&&S(n,["error"],u);const d=b(e,["description"]);d!=null&&S(n,["description"],d);const h=b(e,["baseModel"]);h!=null&&S(n,["baseModel"],h);const f=b(e,["tunedModel"]);f!=null&&S(n,["tunedModel"],wse(t,f));const m=b(e,["supervisedTuningSpec"]);m!=null&&S(n,["supervisedTuningSpec"],m);const g=b(e,["tuningDataStats"]);g!=null&&S(n,["tuningDataStats"],g);const x=b(e,["encryptionSpec"]);x!=null&&S(n,["encryptionSpec"],x);const w=b(e,["partnerModelTuningSpec"]);w!=null&&S(n,["partnerModelTuningSpec"],w);const v=b(e,["distillationSpec"]);v!=null&&S(n,["distillationSpec"],v);const _=b(e,["experiment"]);_!=null&&S(n,["experiment"],_);const C=b(e,["labels"]);C!=null&&S(n,["labels"],C);const T=b(e,["pipelineJob"]);T!=null&&S(n,["pipelineJob"],T);const R=b(e,["tunedModelDisplayName"]);return R!=null&&S(n,["tunedModelDisplayName"],R),n}function bse(t,e){const n={},r=b(e,["nextPageToken"]);r!=null&&S(n,["nextPageToken"],r);const s=b(e,["tuningJobs"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>IE(t,o))),S(n,["tuningJobs"],i)}return n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class _se extends Cg{constructor(e){super(),this.apiClient=e,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new D0(Zh.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:wE.JOB_STATE_QUEUED}}}}async getInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=cse(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>IE(this.apiClient,d))}else{const u=nse(this.apiClient,e);return l=zt("{name}",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>m3(this.apiClient,d))}}async listInternal(e){var n,r,s,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const u=dse(this.apiClient,e);return l=zt("tuningJobs",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(d=>d.json()),o.then(d=>{const h=bse(this.apiClient,d),f=new o2;return Object.assign(f,h),f})}else{const u=sse(this.apiClient,e);return l=zt("tunedModels",u._url),c=u._query,delete u.config,delete u._url,delete u._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(d=>d.json()),o.then(d=>{const h=yse(this.apiClient,d),f=new o2;return Object.assign(f,h),f})}}async tuneInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI()){const l=pse(this.apiClient,e);return i=zt("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>IE(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var n,r;let s,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=lse(this.apiClient,e);return i=zt("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=e.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>xse(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Sse{async download(e,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const Cse=1024*1024*8,Ese=3,Tse=1e3,Ise=2,J_="x-goog-upload-status";async function Nse(t,e,n){var r,s,i;let o=0,l=0,c=new bE(new Response),u="upload";for(o=t.size;l<o;){const h=Math.min(Cse,o-l),f=t.slice(l,l+h);l+h>=o&&(u+=", finalize");let m=0,g=Tse;for(;m<Ese&&(c=await n.request({path:"",body:f,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(l),"Content-Length":String(h)}}}),!(!((r=c==null?void 0:c.headers)===null||r===void 0)&&r[J_]));)m++,await Ase(g),g=g*Ise;if(l+=h,((s=c==null?void 0:c.headers)===null||s===void 0?void 0:s[J_])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const d=await(c==null?void 0:c.json());if(((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[J_])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return d.file}async function Pse(t){return{size:t.size,type:t.type}}function Ase(t){return new Promise(e=>setTimeout(e,t))}class kse{async upload(e,n,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Nse(e,n,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await Pse(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Rse{create(e,n,r){return new jse(e,n,r)}}class jse{constructor(e,n,r){this.url=e,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const b2="x-goog-api-key";class Dse{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(b2)===null&&e.append(b2,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Mse="gl-node/";class _n{constructor(e){var n;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=e.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=e.apiKey;const r=WQ(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new Dse(this.apiKey);this.apiClient=new tse({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:Mse+"web",uploader:new kse,downloader:new Sse}),this.models=new Mre(this.apiClient),this.live=new Are(this.apiClient,s,new Rse),this.chats=new QZ(this.models,this.apiClient),this.caches=new KZ(this.apiClient),this.files=new dee(this.apiClient),this.operations=new Hre(this.apiClient),this.tunings=new _se(this.apiClient)}}const Yo="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk";async function TI(t){const e=new _n({apiKey:Yo}),n={type:He.ARRAY,items:{type:He.STRING},description:"An array of 3 creative and catchy store name suggestions."};try{const r=`Suggest 3 creative and catchy store name options based on the following store name: "${t}". The suggestions should be relevant and similar. Return exactly 3 suggestions.`,s=await e.models.generateContent({model:"gemini-2.5-flash-lite-preview-06-17",contents:[{role:"user",parts:[{text:r}]}],config:{responseMimeType:"application/json",responseSchema:n}}),i=s.text;if(typeof i!="string"||i.trim()==="")throw console.error("Model did not return a text response for store name suggestions. Response:",JSON.stringify(s)),new Error("Model response for store name suggestions was empty or not a string.");try{const o=JSON.parse(i);return Array.isArray(o)&&o.every(l=>typeof l=="string")?{suggestions:o.slice(0,3).map(l=>l.trim()).filter(l=>l.length>0)}:(console.error("Parsed store name suggestions are not an array of strings:",o),{error:"AI response was not in the expected format (array of strings).",rawResponse:i})}catch(o){return console.error("Failed to parse JSON response for store names:",i,"ParseError:",o),{error:"Failed to parse store name suggestions from AI.",rawResponse:i}}}catch(r){return console.error("Error generating store name suggestions:",r),{error:`Error generating suggestions: ${r.message}`}}}async function p3(t){const e=new _n({apiKey:Yo}),n={type:He.OBJECT,properties:{heroTitle:{type:He.STRING,description:"The catchy hero title for the store."},heroDescription:{type:He.STRING,description:"A short (1-2 sentences) engaging hero description."}},required:["heroTitle","heroDescription"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t;let c=`Generate a compelling hero title and a short, engaging hero description for an online store.
Store Name: ${r||"N/A"}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and friendly"}

Return the hero title and description as a JSON object matching the schema.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:n}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for hero content. Response:",JSON.stringify(u)),new Error("Model response for hero content was empty or not a string.");try{const h=JSON.parse(d);return h&&typeof h.heroTitle=="string"&&typeof h.heroDescription=="string"?{heroTitle:h.heroTitle,heroDescription:h.heroDescription}:(console.error("Parsed hero content is not in the expected format:",h),{error:"AI response was not in the expected format for hero content.",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for hero content:",d,"ParseError:",h),{error:"Failed to parse hero content from AI.",rawResponse:d}}}catch(u){return console.error("Error generating hero content:",u),{error:`Error generating hero content: ${u.message}`}}}async function Lse(t){if(!t||!t.name)return console.error("Product information (at least name) is required for image prompt suggestions."),{error:"Product information required."};const e=new _n({apiKey:Yo}),{name:n,description:r,niche:s,storeName:i}=t,o={type:He.ARRAY,items:{type:He.STRING},description:"An array of 6 diverse and creative text prompts for AI image generation related to a product."};let l=`product named "${n}"`;r&&(l+=` with description "${r}"`),i&&(l+=` from a store called "${i}"`),s&&(l+=` in the "${s}" niche`);const c=`Based on a ${l}, generate 6 diverse and creative text prompts suitable for AI image generation. These prompts should aim to create visually appealing images for marketing this product. Examples: "A dynamic shot of [product name] on a clean, modern background with soft lighting", "Lifestyle image of [product name] being used by a happy customer in a [relevant setting]", "Close-up detail of [product name]'s unique feature with artistic blur". Return exactly 6 prompt suggestions.`;try{const u=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:c}]}],config:{responseMimeType:"application/json",responseSchema:o}}),d=u.text;if(typeof d!="string"||d.trim()==="")throw console.error("Model did not return a text response for image prompt suggestions. Response:",JSON.stringify(u)),new Error("Model response for image prompt suggestions was empty or not a string.");try{const h=JSON.parse(d);return Array.isArray(h)&&h.every(f=>typeof f=="string")?{suggestions:h.slice(0,6).map(f=>f.trim()).filter(f=>f.length>0)}:(console.error("Parsed image prompt suggestions are not an array of strings:",h),{error:"AI response was not in the expected format for image prompts (array of strings).",rawResponse:d})}catch(h){return console.error("Failed to parse JSON response for image prompt suggestions:",d,"ParseError:",h),{error:"Failed to parse image prompt suggestions from AI.",rawResponse:d}}}catch(u){return console.error("Error generating image prompt suggestions:",u),{error:`Error generating image prompt suggestions: ${u.message}`}}}async function Fse(t){const e=new _n({apiKey:Yo}),n={name:"extract_store_name",description:`Extracts the desired store name if explicitly mentioned in the prompt using phrases like "store called 'My Store'", "named 'My Store'", or "store 'My Store'". The name should be the direct object of such phrases.`,parameters:{type:He.OBJECT,properties:{storeName:{type:He.STRING,description:"The explicitly mentioned name of the store."}},required:["storeName"]}};try{const i=(await e.getGenerativeModel({model:"gemini-pro"}).generateContent({contents:[{role:"user",parts:[{text:t}]}],tools:[{functionDeclarations:[n]}]})).response.functionCalls();return i&&i.length>0&&i[0].name==="extract_store_name"&&i[0].args&&i[0].args.storeName?(console.log(`[extractExplicitStoreName] Gemini identified store name: ${i[0].args.storeName}`),i[0].args.storeName):(console.log("[extractExplicitStoreName] Gemini did not identify an explicit store name via function call."),null)}catch(r){return console.error("Error during Gemini store name extraction:",r),null}}async function g3(t){const e=new _n({apiKey:Yo}),n={type:He.OBJECT,properties:{title:{type:He.STRING,description:"The main title for 'The [StoreName] Way' section (e.g., 'The AwesomeStore Way')."},subtitle:{type:He.STRING,description:"A short, engaging subtitle for this section (1-2 sentences)."},items:{type:He.ARRAY,description:"An array of 3 to 4 items representing the store's core values or unique selling points.",items:{type:He.OBJECT,properties:{emoji:{type:He.STRING,description:"A single relevant emoji for the item (e.g., '✨', '🌿')."},title:{type:He.STRING,description:"A short title for the item (2-4 words)."},description:{type:He.STRING,description:"A brief description of the item (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4}},required:["title","subtitle","items"]},{name:r,niche:s,description:i,targetAudience:o,style:l}=t,c=r||"Our Store";let u=`Generate content for "The ${c} Way" section of an online store. This section highlights the store's core values and what makes it unique.
Store Name: ${c}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of quality products."}
Target Audience: ${o||"General consumers"}
Style/Vibe: ${l||"Modern and customer-focused"}

The content should include:
1.  A main title (e.g., "The ${c} Way"). This title should dynamically incorporate the actual store name.
2.  A short subtitle (1-2 sentences) that is specific and engaging for this store.
3.  3 to 4 items, each with:
    *   A unique and highly relevant emoji that visually represents the item's theme and is specific to this store's niche/style/keywords. This emoji is mandatory and must not be a generic placeholder. For example, if the store sells coffee, an emoji like ☕ or 🌿 (for organic beans) would be appropriate. If it's a tech store, 💡 or 🚀.
    *   A short, catchy title for the item (2-4 words, e.g., "Artisanal Roasts", "Cutting-Edge Tech"). This title must be specific to the store's theme.
    *   A brief description (10-20 words) elaborating on the item's title, specific to the store's values and offerings.

Return this content as a JSON object matching the schema. Ensure all text content and emojis are distinct, creative, and directly reflect the store's unique characteristics and offerings. Do not use generic examples in the output.`;try{const d=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:u}]}],config:{responseMimeType:"application/json",responseSchema:n}}),h=d.text;if(typeof h!="string"||h.trim()==="")throw console.error("Model did not return a text response for store way content. Response:",JSON.stringify(d)),new Error("Model response for store way content was empty or not a string.");try{const f=JSON.parse(h);return f&&typeof f.title=="string"&&typeof f.subtitle=="string"&&Array.isArray(f.items)&&f.items.length>=3&&f.items.length<=4&&f.items.every(m=>typeof m.emoji=="string"&&m.emoji.length>0&&typeof m.title=="string"&&typeof m.description=="string")?(f.title=`The ${c} Way`,f):(console.error("Parsed store way content is not in the expected format:",f),{error:"AI response was not in the expected format for store way content.",rawResponse:h})}catch(f){return console.error("Failed to parse JSON response for store way content:",h,"ParseError:",f),{error:"Failed to parse store way content from AI.",rawResponse:h}}}catch(d){return console.error("Error generating store way content:",d),{error:`Error generating store way content: ${d.message}`}}}async function II(t){const e=[{iconName:"Truck",title:"Fast Shipping",description:"Get your orders delivered quickly and reliably."},{iconName:"ShieldCheck",title:"Secure Payments",description:"Shop with confidence using our secure payment gateways."},{iconName:"MessageSquare",title:"24/7 Support",description:"Our dedicated team is here to help you around the clock."},{iconName:"Repeat",title:"Easy Returns",description:"Hassle-free return and exchange policy if you're not satisfied."},{iconName:"Award",title:"Quality Guaranteed",description:"We stand by the quality of our products."},{iconName:"Gift",title:"Gift Options",description:"Special gift wrapping and messaging available."}],n=[{iconName:"Users",number:"10K+",label:"Active Users"},{iconName:"Star",number:"4.8",label:"Avg. Rating"},{iconName:"PackageCheck",number:"20K+",label:"Orders Shipped"},{iconName:"ShieldCheck",number:"100%",label:"Secure Checkout"},{iconName:"ThumbsUp",number:"95%",label:"Positive Feedback"},{iconName:"Globe",number:"Worldwide",label:"Shipping"}],r=new _n({apiKey:Yo}),s={type:He.OBJECT,properties:{title:{type:He.STRING,description:"Main title for the features/experience section (e.g., 'An Exceptional Experience')."},subtitle:{type:He.STRING,description:"Engaging subtitle for the features section (1-2 sentences)."},items:{type:He.ARRAY,description:"An array of 3 to 4 feature items highlighting key store benefits.",items:{type:He.OBJECT,properties:{emoji:{type:He.STRING,description:"A single relevant emoji for the feature (e.g., '🛡️', '🌍', '💎')."},title:{type:He.STRING,description:"Short title for the feature (2-4 words, e.g., 'Secure Payments', 'Global Reach')."},description:{type:He.STRING,description:"Brief description of the feature (10-20 words)."}},required:["emoji","title","description"]},minItems:3,maxItems:4},secondaryItems:{type:He.ARRAY,description:"An array of up to 4 secondary feature items highlighting broader store benefits or values. The function will ensure 4 items are present by adding defaults if needed.",items:{type:He.OBJECT,properties:{iconName:{type:He.STRING,description:"Name of a Lucide icon (e.g., 'GlobeIcon', 'AwardIcon', 'UsersIcon', 'HeartIcon') for the secondary feature."},title:{type:He.STRING,description:"Short title for the secondary feature (2-4 words, e.g., 'Global Shipping', 'Quality Assured')."},description:{type:He.STRING,description:"Brief description of the secondary feature (10-15 words)."}},required:["iconName","title","description"]},minItems:0,maxItems:4},statsItems:{type:He.ARRAY,description:"An array of exactly 4 stat items highlighting key metrics or achievements.",items:{type:He.OBJECT,properties:{iconName:{type:He.STRING,description:"Name of a Lucide icon for the stat (e.g., 'UsersIcon', 'StarIcon', 'ZapIcon')."},number:{type:He.STRING,description:"The statistic value (e.g., '50K+', '99.9%', '4.9')."},label:{type:He.STRING,description:"The label for the statistic (e.g., 'Happy Customers', 'Uptime', 'Average Rating')."}},required:["iconName","number","label"]},minItems:4,maxItems:4}},required:["title","subtitle","items","secondaryItems","statsItems"]},{name:i,niche:o,description:l,targetAudience:c,style:u}=t,d=i||"Our Store";let h=`Generate content for a store features section, often titled "An Exceptional Experience" or similar, for an online store named "${d}".
This section should highlight key benefits and unique selling propositions.
Store Name: ${d}
Niche: ${o||"General E-commerce"}
Description/Keywords: ${l||"A variety of quality products."}
Target Audience: ${c||"General consumers"}
Style/Vibe: ${u||"Modern and customer-focused"}

The content should include:
1.  A main title for the section (e.g., "Why Choose Us?", "Our Commitment to You", "An Exceptional Experience").
2.  A short, engaging subtitle (1-2 sentences).
3.  3 to 4 feature items, each with:
    *   A unique and highly relevant emoji that visually represents the feature (e.g., ✨ for innovation,  for eco-friendly,  for smart tech). This emoji is mandatory and must be specific to the feature's theme.
    *   A short, catchy, and descriptive title for the feature (2-5 words, e.g., "Innovative Designs", "Sustainable Materials", "Smart Home Solutions"). This title will be used to search for a relevant background video, so make it evocative. The features should be specific to the store's niche and not generic e-commerce benefits like "Fast Shipping" or "Secure Payments" unless they are a core, unique part of the brand.
    *   A brief description (10-20 words) explaining the benefit of the feature.
4.  Up to 4 secondary feature items (the system will ensure 4 by adding defaults if fewer are provided by AI), each with:
    *   An \`iconName\` string representing a Lucide icon (e.g., "GlobeIcon", "AwardIcon", "UsersIcon", "HeartIcon"). Choose an icon name that best fits the feature. Examples: GlobeIcon, AwardIcon, UsersIcon, HeartIcon, PackageIcon, ShieldIcon, ZapIcon.
    *   A short title for the secondary feature (2-4 words, e.g., "Global Shipping", "Quality Assured", "Community Love", "Eco-Friendly Focus").
    *   A brief description (10-15 words) for the secondary feature. These should highlight broader store values or benefits.
5.  Exactly 4 stat items, each with:
    *   An \`iconName\` string for a Lucide icon (e.g., "UsersIcon", "StarIcon", "ZapIcon", "PackageIcon").
    *   A \`number\` or key metric (e.g., "50K+", "99.9%", "4.9", "1M+"). Avoid including symbols like ★ in the number string itself.
    *   A descriptive \`label\` (e.g., "Happy Customers", "Uptime Guarantee", "Average Rating", "Units Sold").

Return this content as a JSON object matching the schema. Ensure all text content, emojis, and iconNames are distinct, creative, and directly reflect positive attributes of a store like "${d}". Do not use generic examples in the output. Examples of main features could be related to payment security, shipping, product quality, customer service. Secondary features could be about global reach, quality assurance, community, sustainability etc. Stats should reflect plausible achievements or service levels for a store selling "${o||"various items"}".`;try{const f=await r.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:h}]}],config:{responseMimeType:"application/json",responseSchema:s}}),m=f.text;if(typeof m!="string"||m.trim()==="")throw console.error("Model did not return a text response for store features content. Response:",JSON.stringify(f)),new Error("Model response for store features content was empty or not a string.");try{const g=JSON.parse(m);if(g&&typeof g.title=="string"&&typeof g.subtitle=="string"&&Array.isArray(g.items)&&g.items.length>=3&&g.items.length<=4&&g.items.every(x=>typeof x.emoji=="string"&&x.emoji.length>0&&typeof x.title=="string"&&typeof x.description=="string")){let x=[];g.secondaryItems&&Array.isArray(g.secondaryItems)&&(x=g.secondaryItems.filter(C=>C&&typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.title=="string"&&C.title.length>0&&typeof C.description=="string"&&C.description.length>0).slice(0,4));const w=4-x.length;if(w>0){const C=new Set(x.map(R=>R.title)),T=e.filter(R=>!C.has(R.title)).slice(0,w);x.push(...T)}g.secondaryItems=x.slice(0,4);let v=[];g.statsItems&&Array.isArray(g.statsItems)&&(v=g.statsItems.filter(C=>C&&typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.number=="string"&&C.number.length>0&&typeof C.label=="string"&&C.label.length>0).slice(0,4));const _=4-v.length;if(_>0){const C=new Set(v.map(R=>R.label)),T=n.filter(R=>!C.has(R.label)).slice(0,_);v.push(...T)}return g.statsItems=v.slice(0,4),Array.isArray(g.secondaryItems)&&g.secondaryItems.every(C=>typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.title=="string"&&typeof C.description=="string")&&Array.isArray(g.statsItems)&&g.statsItems.length===4&&g.statsItems.every(C=>typeof C.iconName=="string"&&C.iconName.length>0&&typeof C.number=="string"&&C.number.length>0&&typeof C.label=="string"&&C.label.length>0)?g:(console.error("Parsed store features content is not in the expected format after padding/validation:",g),(!g.statsItems||g.statsItems.length!==4)&&(console.warn("Stats items still not 4, forcing defaults for stats."),g.statsItems=n.slice(0,4)),(!g.secondaryItems||g.secondaryItems.length===0)&&(console.warn("Secondary items empty, forcing defaults for secondary."),g.secondaryItems=e.slice(0,Math.min(4,e.length))),g.title&&g.subtitle&&g.items?g:{error:"AI response format error after final processing.",rawResponse:m,processedContent:g})}else return console.error("Initial parsed store features content structure is invalid:",g),{error:"AI response (initial structure) was not in the expected format for store features content.",rawResponse:m}}catch(g){return console.error("Failed to parse JSON response for store features content:",m,"ParseError:",g),{error:"Failed to parse store features content from AI.",rawResponse:m}}}catch(f){return console.error("Error generating store features content:",f),{error:`Error generating store features content: ${f.message}`}}}async function y3(t){const e=new _n({apiKey:Yo}),n={type:He.OBJECT,properties:{title:{type:He.STRING,description:"Catchy title for a section highlighting craftsmanship/quality (e.g., 'Our Commitment to Quality')."},subtitle:{type:He.STRING,description:"Engaging subtitle (1-2 sentences) related to the title."},text:{type:He.STRING,description:"Main descriptive text (2-3 sentences) about the store's dedication to quality, materials, or process."},listItems:{type:He.ARRAY,description:"An array of 3-4 short bullet points (3-5 words each) highlighting key aspects (e.g., 'Premium Materials', 'Expert Craftsmanship').",items:{type:He.STRING},minItems:3,maxItems:4},ctaText:{type:He.STRING,description:"Call to action button text (e.g., 'Explore Our Process', 'Learn More')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`Key products include: ${t.productExamples}.`:"The store offers a range of specialized gear.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has an image on the right and text on the left, emphasizing the store's precision, quality, craftsmanship, or unique process.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"high-performance gear"}"
Store Description: "${i||"A store dedicated to excellence and precision."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 3-4 list items (3-5 words each), and a CTA button text.
The tone should be bold, confident, and precise, fitting a high-tech or tactical brand.
Focus on aspects like durability, advanced technology, expert design, or mission-readiness.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=3&&d.ctaText?d:(console.error("Invalid structure from AI for ImageRightSection:",d),{error:"AI response format error for ImageRightSection.",rawResponse:u})}catch(c){return console.error("Error generating ImageRightSection content:",c),{error:`Error generating ImageRightSection content: ${c.message}`}}}async function x3(t){const e=new _n({apiKey:Yo}),n={type:He.OBJECT,properties:{title:{type:He.STRING,description:"Catchy title for a section showcasing a product or brand story via video (e.g., 'Experience the Difference')."},subtitle:{type:He.STRING,description:"Engaging subtitle (1-2 sentences) related to the video's theme."},text:{type:He.STRING,description:"Main descriptive text (2-3 sentences) complementing the video."},listItems:{type:He.ARRAY,description:"An array of 2-3 short bullet points (3-5 words each) highlighting key takeaways or features shown in a video.",items:{type:He.STRING},minItems:2,maxItems:3},ctaText:{type:He.STRING,description:"Call to action button text (e.g., 'Watch Now', 'See It In Action')."}},required:["title","subtitle","text","listItems","ctaText"]},{name:r,niche:s,description:i}=t,o=t.productExamples?`The video might showcase products like: ${t.productExamples}.`:"The video showcases our innovative products.",l=`Generate content for a website section for a store with a "sharp" and "tactical" aesthetic. This section has a video on the left and text on the right, aiming to engage users with a dynamic visual story or product demonstration.
Store Name: "${r||"Our Store"}"
Niche/Type: "${s||"cutting-edge solutions"}"
Store Description: "${i||"A store focused on performance and innovation."}"
${o}
Generate a title, subtitle, main text (2-3 sentences), 2-3 list items (3-5 words each highlighting video takeaways), and a CTA button text.
The tone should be energetic, impactful, and forward-thinking, suitable for a high-performance brand.
Focus on action, benefits, or the experience the video portrays.
Return as a JSON object matching the schema.`;try{const u=(await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:l}]}],config:{responseMimeType:"application/json",responseSchema:n}})).text;if(!(u!=null&&u.trim()))throw new Error("Empty response from AI.");const d=JSON.parse(u);return d.title&&d.subtitle&&d.text&&Array.isArray(d.listItems)&&d.listItems.length>=2&&d.ctaText?d:(console.error("Invalid structure from AI for VideoLeftSection:",d),{error:"AI response format error for VideoLeftSection.",rawResponse:u})}catch(c){return console.error("Error generating VideoLeftSection content:",c),{error:`Error generating VideoLeftSection content: ${c.message}`}}}async function Ose(t,e){const n=new _n({apiKey:Yo}),r={type:He.OBJECT,properties:{description:{type:He.STRING,description:"A compelling and SEO-friendly product description."}},required:["description"]},{name:s,description:i}=t,{name:o,niche:l,targetAudience:c,style:u}=e;let d=`Generate a compelling, engaging, and SEO-friendly product description.
Store Name: ${o||"N/A"}
Store Niche: ${l||"General E-commerce"}
Store Style: ${u||"Modern and friendly"}
Target Audience: ${c||"General consumers"}

Product Name: "${s}"
${i?`Existing Description (for context, improve upon it): "${i}"`:""}

The new description should be persuasive, highlight key benefits, and be written in a tone that matches the store's style. It should be between 50 and 150 words.
Return the description as a JSON object matching the schema.`;try{const h=await n.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:d}]}],config:{responseMimeType:"application/json",responseSchema:r}}),f=h.text;if(typeof f!="string"||f.trim()==="")throw console.error("Model did not return a text response for product description. Response:",JSON.stringify(h)),new Error("Model response for product description was empty or not a string.");try{const m=JSON.parse(f);return m&&typeof m.description=="string"?{description:m.description}:(console.error("Parsed product description is not in the expected format:",m),{error:"AI response was not in the expected format for product description.",rawResponse:f})}catch(m){return console.error("Failed to parse JSON response for product description:",f,"ParseError:",m),{error:"Failed to parse product description from AI.",rawResponse:f}}}catch(h){return console.error("Error generating product description:",h),{error:`Error generating product description: ${h.message}`}}}async function v3(t){const e=new _n({apiKey:Yo}),n={type:He.OBJECT,properties:{query:{type:He.STRING,description:"A concise and relevant search query for Pexels videos."}},required:["query"]},{name:r,niche:s,description:i}=t;let o=`Generate a concise and relevant search query for Pexels videos for an online store.
Store Name: ${r||"N/A"}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of products."}

The query should be 2-3 words and capture the essence of the store's brand and products.
Return the query as a JSON object matching the schema.`;try{const l=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:o}]}],config:{responseMimeType:"application/json",responseSchema:n}}),c=l.text;if(typeof c!="string"||c.trim()==="")throw console.error("Model did not return a text response for Pexels query. Response:",JSON.stringify(l)),new Error("Model response for Pexels query was empty or not a string.");try{const u=JSON.parse(c);return u&&typeof u.query=="string"?{query:u.query}:(console.error("Parsed Pexels query is not in the expected format:",u),{error:"AI response was not in the expected format for Pexels query.",rawResponse:c})}catch(u){return console.error("Failed to parse JSON response for Pexels query:",c,"ParseError:",u),{error:"Failed to parse Pexels query from AI.",rawResponse:c}}}catch(l){return console.error("Error generating Pexels video query:",l),{error:`Error generating Pexels video query: ${l.message}`}}}async function _2(t){const e=new _n({apiKey:Yo}),n={type:He.OBJECT,properties:{primaryColor:{type:He.STRING,description:"The hex code for the primary color."},secondaryColor:{type:He.STRING,description:"The hex code for the secondary color."}},required:["primaryColor","secondaryColor"]},{name:r,niche:s,description:i}=t;let o=`Generate a primary and secondary color for a store's theme.
Store Name: ${r||"N/A"}
Niche: ${s||"General E-commerce"}
Description/Keywords: ${i||"A variety of products."}

The colors should be represented as hex codes.
Return the colors as a JSON object matching the schema.`;try{const l=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:o}]}],config:{responseMimeType:"application/json",responseSchema:n}}),c=l.text;if(typeof c!="string"||c.trim()==="")throw console.error("Model did not return a text response for theme colors. Response:",JSON.stringify(l)),new Error("Model response for theme colors was empty or not a string.");try{const u=JSON.parse(c);return u&&typeof u.primaryColor=="string"&&typeof u.secondaryColor=="string"?{primaryColor:u.primaryColor,secondaryColor:u.secondaryColor}:(console.error("Parsed theme colors are not in the expected format:",u),{error:"AI response was not in the expected format for theme colors.",rawResponse:c})}catch(u){return console.error("Failed to parse JSON response for theme colors:",c,"ParseError:",u),{error:"Failed to parse theme colors from AI.",rawResponse:c}}}catch(l){return console.error("Error generating theme colors:",l),{error:`Error generating theme colors: ${l.message}`}}}function bt(...t){return LQ(qV(t))}function Pt(){return UQ()}const $se="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t";console.log("[utils.jsx] VITE_PEXELS_API_KEY loaded:","Exists");const w3=$se,Vse="https://api.pexels.com/v1",Use="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk";console.log("[utils.jsx] VITE_GEMINI_API_KEY loaded:","Exists");const Bse=Use,zse="your-shop-name.myshopify.com",lo=async(t,e=1,n="landscape")=>{const r=`${Vse}/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:w3}});if(!s.ok){const o=await s.json();throw console.error("Pexels API error:",o),new Error(`Pexels API request failed: ${s.statusText}`)}const i=await s.json();if(!i.photos||i.photos.length===0){console.warn(`No Pexels images found for query: "${t}". Attempting fallback.`);const o=(l,c,u)=>`https://via.placeholder.com/${l}x${c}.png?text=NoImage:${encodeURIComponent(u)}`;return Array(e).fill(null).map((l,c)=>({id:Pt(),src:{large:o(1200,800,`${t} ${c+1}`),medium:o(800,600,`${t} ${c+1}`),original:o(1920,1280,`${t} ${c+1}`),square:o(400,400,`${t} ${c+1}`),landscape:o(1200,800,`${t} ${c+1}`),portrait:o(800,1200,`${t} ${c+1}`),small:o(400,260,`${t} ${c+1}`),tiny:o(200,130,`${t} ${c+1}`)},photographer:"N/A",alt:`No image found for ${t} ${c+1}`}))}return i.photos.map(o=>({id:o.id,src:o.src,photographer:o.photographer,alt:o.alt||`Photo by ${o.photographer} of ${t}`}))}catch(s){console.error("Error fetching Pexels images:",s);const i=(o,l,c)=>`https://via.placeholder.com/${o}x${l}.png?text=${encodeURIComponent(c)}`;return Array(e).fill(null).map((o,l)=>({id:Pt(),src:{large:i(1200,800,`Error ${t} ${l+1}`),medium:i(800,600,`Error ${t} ${l+1}`),original:i(1920,1280,`Error ${t} ${l+1}`),square:i(400,400,`Error ${t} ${l+1}`),landscape:i(1200,800,`Error ${t} ${l+1}`),portrait:i(800,1200,`Error ${t} ${l+1}`),small:i(400,260,`Error ${t} ${l+1}`),tiny:i(200,130,`Error ${t} ${l+1}`)},photographer:"Placeholder Error",alt:`Placeholder Error for ${t} ${l+1}`}))}},$a=async(t,e=1,n="landscape")=>{const r=`https://api.pexels.com/videos/search?query=${encodeURIComponent(t)}&per_page=${e}&orientation=${n}`;try{const s=await fetch(r,{headers:{Authorization:w3}});if(!s.ok){const o=await s.json();throw console.error("Pexels Videos API error:",o),new Error(`Pexels Videos API request failed: ${s.statusText}`)}const i=await s.json();return!i.videos||i.videos.length===0?(console.warn(`No Pexels videos found for query: "${t}".`),Array(e).fill(null).map((o,l)=>({id:Pt(),url:`https://videos.pexels.com/videos/no-video-${l+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=No+Video+Found+${encodeURIComponent(t)}`,alt:`No video found for ${t} ${l+1}`}))):i.videos.map(o=>{var c,u;const l=o.video_files.find(d=>d.quality==="hd"&&d.file_type==="video/mp4")||o.video_files.find(d=>d.file_type==="video/mp4")||o.video_files[0];return{id:o.id,url:l?l.link:null,image:((c=o.video_pictures[0])==null?void 0:c.picture)||`https://via.placeholder.com/1280x720.png?text=${encodeURIComponent(o.url||t)}`,duration:o.duration,user:o.user,alt:`Video of ${t} by ${((u=o.user)==null?void 0:u.name)||"Pexels Contributor"}`}})}catch(s){return console.error("Error fetching Pexels videos:",s),Array(e).fill(null).map((i,o)=>({id:Pt(),url:`https://videos.pexels.com/videos/error-video-${o+1}.mp4`,image:`https://via.placeholder.com/1280x720.png?text=Video+Error+${encodeURIComponent(t)}`,alt:`Error fetching video for ${t} ${o+1}`}))}},L0=async t=>{try{const e=new _n({apiKey:Bse}),n=[{category:Tr.HARM_CATEGORY_HARASSMENT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_HATE_SPEECH,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE}];console.log(`[utils.jsx/generateImageWithGemini] Calling Gemini with prompt: "${t}"`);const r=await e.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{text:t}],safetySettings:n,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});let s=null,i="image/png";if(r.candidates&&r.candidates.length>0&&r.candidates[0].content&&r.candidates[0].content.parts){for(const o of r.candidates[0].content.parts)if(o.inlineData&&o.inlineData.data){s=o.inlineData.data,i=o.inlineData.mimeType||"image/png",console.log(`[utils.jsx/generateImageWithGemini] Image generated. MimeType: ${i}`);break}}if(s)return{url:`data:${i};base64,${s}`,alt:`AI Generated Image for: ${t}`};throw new Error("No image data found in Gemini response.")}catch(e){return console.error("[utils.jsx/generateImageWithGemini] Error generating image with Gemini:",e),{url:`https://via.placeholder.com/512x512.png?text=Error:${encodeURIComponent(t.substring(0,20))}`,alt:`Error generating image for: ${t}`}}},Gse=(t,e)=>{const n={fashion:[`Elevate your style with our ${e}. Crafted for comfort and a modern look.`,`The ${e} is a must-have for any fashion-forward wardrobe. Versatile and chic.`,`Discover the perfect blend of quality and design in our ${e}. Ideal for any occasion.`],electronics:[`Experience next-level technology with the ${e}. Packed with features for modern life.`,`The ${e} offers superior performance and sleek design. Upgrade your tech today.`,`Unleash innovation with the ${e}. Reliable, powerful, and built to last.`],food:[`Savor the rich flavors of our ${e}. Made with the freshest, high-quality ingredients.`,`Our ${e} is a delicious treat for any time of day. Wholesome and satisfying.`,`Indulge in the authentic taste of ${e}. Perfect for sharing or enjoying solo.`],jewelry:[`Adorn yourself with the exquisite ${e}. A timeless piece that radiates elegance.`,`The ${e} is a symbol of sophistication and luxury. Crafted with precision.`,`Make a statement with our stunning ${e}. Perfect for special moments.`],general:[`Discover the quality and utility of the ${e}. A great addition to your collection.`,`The ${e} is designed for excellence and everyday use. You'll love it.`,`Enhance your life with the versatile ${e}. Built for performance and style.`]},r=n[t]||n.general;return r[Math.floor(Math.random()*r.length)]},NI=async(t,e,n="")=>{const r={niche:t,name:e,description:n};let s={heroTitle:`Welcome to ${e}`,heroDescription:`Discover amazing products at ${e}.`,featuresSectionTitle:"Why Shop With Us?",featuresSectionSubtitle:"We are committed to providing you with the best shopping experience.",featureTitles:["Fast Worldwide Shipping","Secure Online Payments","24/7 Customer Support","Easy Returns & Exchanges"],featureDescriptions:["Get your orders delivered quickly and reliably, no matter where you are.","Shop with confidence using our encrypted and secure payment gateways.","Our dedicated team is here to help you around the clock with any queries.","Not satisfied? We offer a hassle-free return and exchange policy."],featuresVideoQuery:`${t} abstract`,newsletterHeading:`Join the ${e} Family`,newsletterText:"Sign up for our newsletter to receive exclusive offers, new product alerts, and style tips directly to your inbox. Don't miss out!"};try{const l=await II(r);if(l&&!l.error&&l.items&&(s.featuresSectionTitle=l.title,s.featuresSectionSubtitle=l.subtitle,s.featureTitles=l.items.map(c=>c.title),s.featureDescriptions=l.items.map(c=>c.description),s.featureTitles.length>0)){const c=await v3(r);s.featuresVideoQuery=c.query||`${e} ${t} ${s.featureTitles[0]}`}}catch(l){console.error("Failed to generate dynamic features content, using fallback.",l)}const i={fashion:`Step Into Style at ${e}`,electronics:`${e}: Your Tech Universe`,food:`Taste the Difference with ${e}`,jewelry:`Shine Bright with ${e}`,general:`Welcome to ${e} - Quality Finds!`},o={fashion:`Explore the latest trends and timeless classics. ${e} offers curated fashion for every individual. Express yourself with our unique collection.`,electronics:`Discover cutting-edge gadgets and essential electronics at ${e}. We bring you innovation, performance, and value, all in one place.`,food:`From farm-fresh produce to gourmet delights, ${e} is your source for delicious and wholesome food. Quality ingredients for a healthier life.`,jewelry:`Find exquisite pieces that tell your story. ${e} presents a stunning collection of fine jewelry, perfect for gifting or treating yourself.`,general:`Your one-stop shop for amazing products. ${e} offers a diverse range of quality items to meet your everyday needs and special desires.`};return s.heroTitle=i[t]||i.general,s.heroDescription=o[t]||o.general,s};function Wse(t,e){const[n,r]=p.useState(t);return p.useEffect(()=>{const s=setTimeout(()=>{r(t)},e);return()=>{clearTimeout(s)}},[t,e]),n}function gt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function S2(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function F0(...t){return e=>{let n=!1;const r=t.map(s=>{const i=S2(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():S2(t[s],null)}}}}function mn(...t){return p.useCallback(F0(...t),t)}function Hse(t,e){const n=p.createContext(e),r=i=>{const{children:o,...l}=i,c=p.useMemo(()=>l,Object.values(l));return a.jsx(n.Provider,{value:c,children:o})};r.displayName=t+"Provider";function s(i){const o=p.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return[r,s]}function bi(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];const u=h=>{var v;const{scope:f,children:m,...g}=h,x=((v=f==null?void 0:f[t])==null?void 0:v[c])||l,w=p.useMemo(()=>g,Object.values(g));return a.jsx(x.Provider,{value:w,children:m})};u.displayName=i+"Provider";function d(h,f){var x;const m=((x=f==null?void 0:f[t])==null?void 0:x[c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,qse(s,...e)]}function qse(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function Yu(t){const e=Yse(t),n=p.forwardRef((r,s)=>{const{children:i,...o}=r,l=p.Children.toArray(i),c=l.find(Xse);if(c){const u=c.props.children,d=l.map(h=>h===c?p.Children.count(u)>1?p.Children.only(null):p.isValidElement(u)?u.props.children:null:h);return a.jsx(e,{...o,ref:s,children:p.isValidElement(u)?p.cloneElement(u,void 0,d):null})}return a.jsx(e,{...o,ref:s,children:i})});return n.displayName=`${t}.Slot`,n}var Kse=Yu("Slot");function Yse(t){const e=p.forwardRef((n,r)=>{const{children:s,...i}=n;if(p.isValidElement(s)){const o=Zse(s),l=Qse(i,s.props);return s.type!==p.Fragment&&(l.ref=r?F0(r,o):o),p.cloneElement(s,l)}return p.Children.count(s)>1?p.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var b3=Symbol("radix.slottable");function Jse(t){const e=({children:n})=>a.jsx(a.Fragment,{children:n});return e.displayName=`${t}.Slottable`,e.__radixId=b3,e}function Xse(t){return p.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===b3}function Qse(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{const c=i(...l);return s(...l),c}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function Zse(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}function PI(t){const e=t+"CollectionProvider",[n,r]=bi(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=x=>{const{scope:w,children:v}=x,_=ht.useRef(null),C=ht.useRef(new Map).current;return a.jsx(s,{scope:w,itemMap:C,collectionRef:_,children:v})};o.displayName=e;const l=t+"CollectionSlot",c=Yu(l),u=ht.forwardRef((x,w)=>{const{scope:v,children:_}=x,C=i(l,v),T=mn(w,C.collectionRef);return a.jsx(c,{ref:T,children:_})});u.displayName=l;const d=t+"CollectionItemSlot",h="data-radix-collection-item",f=Yu(d),m=ht.forwardRef((x,w)=>{const{scope:v,children:_,...C}=x,T=ht.useRef(null),R=mn(w,T),k=i(d,v);return ht.useEffect(()=>(k.itemMap.set(T,{ref:T,...C}),()=>void k.itemMap.delete(T))),a.jsx(f,{[h]:"",ref:R,children:_})});m.displayName=d;function g(x){const w=i(t+"CollectionConsumer",x);return ht.useCallback(()=>{const _=w.collectionRef.current;if(!_)return[];const C=Array.from(_.querySelectorAll(`[${h}]`));return Array.from(w.itemMap.values()).sort((k,E)=>C.indexOf(k.ref.current)-C.indexOf(E.ref.current))},[w.collectionRef,w.itemMap])}return[{Provider:o,Slot:u,ItemSlot:m},g,r]}var eie=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Wt=eie.reduce((t,e)=>{const n=Yu(`Primitive.${e}`),r=p.forwardRef((s,i)=>{const{asChild:o,...l}=s,c=o?n:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),a.jsx(c,{...l,ref:i})});return r.displayName=`Primitive.${e}`,{...t,[e]:r}},{});function AI(t,e){t&&xl.flushSync(()=>t.dispatchEvent(e))}function Br(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function tie(t,e=globalThis==null?void 0:globalThis.document){const n=Br(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var nie="DismissableLayer",NE="dismissableLayer.update",rie="dismissableLayer.pointerDownOutside",sie="dismissableLayer.focusOutside",C2,_3=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Eg=p.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:l,...c}=t,u=p.useContext(_3),[d,h]=p.useState(null),f=(d==null?void 0:d.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=p.useState({}),g=mn(e,E=>h(E)),x=Array.from(u.layers),[w]=[...u.layersWithOutsidePointerEventsDisabled].slice(-1),v=x.indexOf(w),_=d?x.indexOf(d):-1,C=u.layersWithOutsidePointerEventsDisabled.size>0,T=_>=v,R=oie(E=>{const I=E.target,P=[...u.branches].some(A=>A.contains(I));!T||P||(s==null||s(E),o==null||o(E),E.defaultPrevented||l==null||l())},f),k=aie(E=>{const I=E.target;[...u.branches].some(A=>A.contains(I))||(i==null||i(E),o==null||o(E),E.defaultPrevented||l==null||l())},f);return tie(E=>{_===u.layers.size-1&&(r==null||r(E),!E.defaultPrevented&&l&&(E.preventDefault(),l()))},f),p.useEffect(()=>{if(d)return n&&(u.layersWithOutsidePointerEventsDisabled.size===0&&(C2=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),u.layersWithOutsidePointerEventsDisabled.add(d)),u.layers.add(d),E2(),()=>{n&&u.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=C2)}},[d,f,n,u]),p.useEffect(()=>()=>{d&&(u.layers.delete(d),u.layersWithOutsidePointerEventsDisabled.delete(d),E2())},[d,u]),p.useEffect(()=>{const E=()=>m({});return document.addEventListener(NE,E),()=>document.removeEventListener(NE,E)},[]),a.jsx(Wt.div,{...c,ref:g,style:{pointerEvents:C?T?"auto":"none":void 0,...t.style},onFocusCapture:gt(t.onFocusCapture,k.onFocusCapture),onBlurCapture:gt(t.onBlurCapture,k.onBlurCapture),onPointerDownCapture:gt(t.onPointerDownCapture,R.onPointerDownCapture)})});Eg.displayName=nie;var iie="DismissableLayerBranch",S3=p.forwardRef((t,e)=>{const n=p.useContext(_3),r=p.useRef(null),s=mn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),a.jsx(Wt.div,{...t,ref:s})});S3.displayName=iie;function oie(t,e=globalThis==null?void 0:globalThis.document){const n=Br(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let c=function(){C3(rie,n,u,{discrete:!0})};const u={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=c,e.addEventListener("click",s.current,{once:!0})):c()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function aie(t,e=globalThis==null?void 0:globalThis.document){const n=Br(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&C3(sie,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function E2(){const t=new CustomEvent(NE);document.dispatchEvent(t)}function C3(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?AI(s,i):s.dispatchEvent(i)}var lie=Eg,cie=S3,Ca=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},uie="Portal",Tg=p.forwardRef((t,e)=>{var l;const{container:n,...r}=t,[s,i]=p.useState(!1);Ca(()=>i(!0),[]);const o=n||s&&((l=globalThis==null?void 0:globalThis.document)==null?void 0:l.body);return o?vI.createPortal(a.jsx(Wt.div,{...r,ref:e}),o):null});Tg.displayName=uie;function die(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var _s=t=>{const{present:e,children:n}=t,r=hie(e),s=typeof n=="function"?n({present:r.isPresent}):p.Children.only(n),i=mn(r.ref,fie(s));return typeof n=="function"||r.isPresent?p.cloneElement(s,{ref:i}):null};_s.displayName="Presence";function hie(t){const[e,n]=p.useState(),r=p.useRef(null),s=p.useRef(t),i=p.useRef("none"),o=t?"mounted":"unmounted",[l,c]=die(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return p.useEffect(()=>{const u=Gy(r.current);i.current=l==="mounted"?u:"none"},[l]),Ca(()=>{const u=r.current,d=s.current;if(d!==t){const f=i.current,m=Gy(u);t?c("MOUNT"):m==="none"||(u==null?void 0:u.display)==="none"?c("UNMOUNT"):c(d&&f!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,c]),Ca(()=>{if(e){let u;const d=e.ownerDocument.defaultView??window,h=m=>{const x=Gy(r.current).includes(m.animationName);if(m.target===e&&x&&(c("ANIMATION_END"),!s.current)){const w=e.style.animationFillMode;e.style.animationFillMode="forwards",u=d.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=w)})}},f=m=>{m.target===e&&(i.current=Gy(r.current))};return e.addEventListener("animationstart",f),e.addEventListener("animationcancel",h),e.addEventListener("animationend",h),()=>{d.clearTimeout(u),e.removeEventListener("animationstart",f),e.removeEventListener("animationcancel",h),e.removeEventListener("animationend",h)}}else c("ANIMATION_END")},[e,c]),{isPresent:["mounted","unmountSuspended"].includes(l),ref:p.useCallback(u=>{r.current=u?getComputedStyle(u):null,n(u)},[])}}function Gy(t){return(t==null?void 0:t.animationName)||"none"}function fie(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var mie=d0[" useInsertionEffect ".trim().toString()]||Ca;function Vc({prop:t,defaultProp:e,onChange:n=()=>{},caller:r}){const[s,i,o]=pie({defaultProp:e,onChange:n}),l=t!==void 0,c=l?t:s;{const d=p.useRef(t!==void 0);p.useEffect(()=>{const h=d.current;h!==l&&console.warn(`${r} is changing from ${h?"controlled":"uncontrolled"} to ${l?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),d.current=l},[l,r])}const u=p.useCallback(d=>{var h;if(l){const f=gie(d)?d(t):d;f!==t&&((h=o.current)==null||h.call(o,f))}else i(d)},[l,t,i,o]);return[c,u]}function pie({defaultProp:t,onChange:e}){const[n,r]=p.useState(t),s=p.useRef(n),i=p.useRef(e);return mie(()=>{i.current=e},[e]),p.useEffect(()=>{var o;s.current!==n&&((o=i.current)==null||o.call(i,n),s.current=n)},[n,s]),[n,r,i]}function gie(t){return typeof t=="function"}var yie=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),xie="VisuallyHidden",kI=p.forwardRef((t,e)=>a.jsx(Wt.span,{...t,ref:e,style:{...yie,...t.style}}));kI.displayName=xie;var RI="ToastProvider",[jI,vie,wie]=PI("Toast"),[E3,Pje]=bi("Toast",[wie]),[bie,O0]=E3(RI),T3=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[l,c]=p.useState(null),[u,d]=p.useState(0),h=p.useRef(!1),f=p.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${RI}\`. Expected non-empty \`string\`.`),a.jsx(jI.Provider,{scope:e,children:a.jsx(bie,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:u,viewport:l,onViewportChange:c,onToastAdd:p.useCallback(()=>d(m=>m+1),[]),onToastRemove:p.useCallback(()=>d(m=>m-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:f,children:o})})};T3.displayName=RI;var I3="ToastViewport",_ie=["F8"],PE="toast.viewportPause",AE="toast.viewportResume",N3=p.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=_ie,label:s="Notifications ({hotkey})",...i}=t,o=O0(I3,n),l=vie(n),c=p.useRef(null),u=p.useRef(null),d=p.useRef(null),h=p.useRef(null),f=mn(e,h,o.onViewportChange),m=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),g=o.toastCount>0;p.useEffect(()=>{const w=v=>{var C;r.length!==0&&r.every(T=>v[T]||v.code===T)&&((C=h.current)==null||C.focus())};return document.addEventListener("keydown",w),()=>document.removeEventListener("keydown",w)},[r]),p.useEffect(()=>{const w=c.current,v=h.current;if(g&&w&&v){const _=()=>{if(!o.isClosePausedRef.current){const k=new CustomEvent(PE);v.dispatchEvent(k),o.isClosePausedRef.current=!0}},C=()=>{if(o.isClosePausedRef.current){const k=new CustomEvent(AE);v.dispatchEvent(k),o.isClosePausedRef.current=!1}},T=k=>{!w.contains(k.relatedTarget)&&C()},R=()=>{w.contains(document.activeElement)||C()};return w.addEventListener("focusin",_),w.addEventListener("focusout",T),w.addEventListener("pointermove",_),w.addEventListener("pointerleave",R),window.addEventListener("blur",_),window.addEventListener("focus",C),()=>{w.removeEventListener("focusin",_),w.removeEventListener("focusout",T),w.removeEventListener("pointermove",_),w.removeEventListener("pointerleave",R),window.removeEventListener("blur",_),window.removeEventListener("focus",C)}}},[g,o.isClosePausedRef]);const x=p.useCallback(({tabbingDirection:w})=>{const _=l().map(C=>{const T=C.ref.current,R=[T,...Mie(T)];return w==="forwards"?R:R.reverse()});return(w==="forwards"?_.reverse():_).flat()},[l]);return p.useEffect(()=>{const w=h.current;if(w){const v=_=>{var R,k,E;const C=_.altKey||_.ctrlKey||_.metaKey;if(_.key==="Tab"&&!C){const I=document.activeElement,P=_.shiftKey;if(_.target===w&&P){(R=u.current)==null||R.focus();return}const j=x({tabbingDirection:P?"backwards":"forwards"}),M=j.findIndex(z=>z===I);X_(j.slice(M+1))?_.preventDefault():P?(k=u.current)==null||k.focus():(E=d.current)==null||E.focus()}};return w.addEventListener("keydown",v),()=>w.removeEventListener("keydown",v)}},[l,x]),a.jsxs(cie,{ref:c,role:"region","aria-label":s.replace("{hotkey}",m),tabIndex:-1,style:{pointerEvents:g?void 0:"none"},children:[g&&a.jsx(kE,{ref:u,onFocusFromOutsideViewport:()=>{const w=x({tabbingDirection:"forwards"});X_(w)}}),a.jsx(jI.Slot,{scope:n,children:a.jsx(Wt.ol,{tabIndex:-1,...i,ref:f})}),g&&a.jsx(kE,{ref:d,onFocusFromOutsideViewport:()=>{const w=x({tabbingDirection:"backwards"});X_(w)}})]})});N3.displayName=I3;var P3="ToastFocusProxy",kE=p.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=O0(P3,n);return a.jsx(kI,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var u;const l=o.relatedTarget;!((u=i.viewport)!=null&&u.contains(l))&&r()}})});kE.displayName=P3;var Ig="Toast",Sie="toast.swipeStart",Cie="toast.swipeMove",Eie="toast.swipeCancel",Tie="toast.swipeEnd",A3=p.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[l,c]=Vc({prop:r,defaultProp:s??!0,onChange:i,caller:Ig});return a.jsx(_s,{present:n||l,children:a.jsx(Pie,{open:l,...o,ref:e,onClose:()=>c(!1),onPause:Br(t.onPause),onResume:Br(t.onResume),onSwipeStart:gt(t.onSwipeStart,u=>{u.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:gt(t.onSwipeMove,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","move"),u.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:gt(t.onSwipeCancel,u=>{u.currentTarget.setAttribute("data-swipe","cancel"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:gt(t.onSwipeEnd,u=>{const{x:d,y:h}=u.detail.delta;u.currentTarget.setAttribute("data-swipe","end"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),u.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),u.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${d}px`),u.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),c(!1)})})})});A3.displayName=Ig;var[Iie,Nie]=E3(Ig,{onClose(){}}),Pie=p.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:l,onPause:c,onResume:u,onSwipeStart:d,onSwipeMove:h,onSwipeCancel:f,onSwipeEnd:m,...g}=t,x=O0(Ig,n),[w,v]=p.useState(null),_=mn(e,z=>v(z)),C=p.useRef(null),T=p.useRef(null),R=s||x.duration,k=p.useRef(0),E=p.useRef(R),I=p.useRef(0),{onToastAdd:P,onToastRemove:A}=x,D=Br(()=>{var U;(w==null?void 0:w.contains(document.activeElement))&&((U=x.viewport)==null||U.focus()),o()}),j=p.useCallback(z=>{!z||z===1/0||(window.clearTimeout(I.current),k.current=new Date().getTime(),I.current=window.setTimeout(D,z))},[D]);p.useEffect(()=>{const z=x.viewport;if(z){const U=()=>{j(E.current),u==null||u()},K=()=>{const q=new Date().getTime()-k.current;E.current=E.current-q,window.clearTimeout(I.current),c==null||c()};return z.addEventListener(PE,K),z.addEventListener(AE,U),()=>{z.removeEventListener(PE,K),z.removeEventListener(AE,U)}}},[x.viewport,R,c,u,j]),p.useEffect(()=>{i&&!x.isClosePausedRef.current&&j(R)},[i,R,x.isClosePausedRef,j]),p.useEffect(()=>(P(),()=>A()),[P,A]);const M=p.useMemo(()=>w?F3(w):null,[w]);return x.viewport?a.jsxs(a.Fragment,{children:[M&&a.jsx(Aie,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:M}),a.jsx(Iie,{scope:n,onClose:D,children:xl.createPortal(a.jsx(jI.ItemSlot,{scope:n,children:a.jsx(lie,{asChild:!0,onEscapeKeyDown:gt(l,()=>{x.isFocusedToastEscapeKeyDownRef.current||D(),x.isFocusedToastEscapeKeyDownRef.current=!1}),children:a.jsx(Wt.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":x.swipeDirection,...g,ref:_,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:gt(t.onKeyDown,z=>{z.key==="Escape"&&(l==null||l(z.nativeEvent),z.nativeEvent.defaultPrevented||(x.isFocusedToastEscapeKeyDownRef.current=!0,D()))}),onPointerDown:gt(t.onPointerDown,z=>{z.button===0&&(C.current={x:z.clientX,y:z.clientY})}),onPointerMove:gt(t.onPointerMove,z=>{if(!C.current)return;const U=z.clientX-C.current.x,K=z.clientY-C.current.y,q=!!T.current,W=["left","right"].includes(x.swipeDirection),te=["left","up"].includes(x.swipeDirection)?Math.min:Math.max,O=W?te(0,U):0,V=W?0:te(0,K),H=z.pointerType==="touch"?10:2,L={x:O,y:V},ee={originalEvent:z,delta:L};q?(T.current=L,Wy(Cie,h,ee,{discrete:!1})):T2(L,x.swipeDirection,H)?(T.current=L,Wy(Sie,d,ee,{discrete:!1}),z.target.setPointerCapture(z.pointerId)):(Math.abs(U)>H||Math.abs(K)>H)&&(C.current=null)}),onPointerUp:gt(t.onPointerUp,z=>{const U=T.current,K=z.target;if(K.hasPointerCapture(z.pointerId)&&K.releasePointerCapture(z.pointerId),T.current=null,C.current=null,U){const q=z.currentTarget,W={originalEvent:z,delta:U};T2(U,x.swipeDirection,x.swipeThreshold)?Wy(Tie,m,W,{discrete:!0}):Wy(Eie,f,W,{discrete:!0}),q.addEventListener("click",te=>te.preventDefault(),{once:!0})}})})})}),x.viewport)})]}):null}),Aie=t=>{const{__scopeToast:e,children:n,...r}=t,s=O0(Ig,e),[i,o]=p.useState(!1),[l,c]=p.useState(!1);return jie(()=>o(!0)),p.useEffect(()=>{const u=window.setTimeout(()=>c(!0),1e3);return()=>window.clearTimeout(u)},[]),l?null:a.jsx(Tg,{asChild:!0,children:a.jsx(kI,{...r,children:i&&a.jsxs(a.Fragment,{children:[s.label," ",n]})})})},kie="ToastTitle",k3=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Wt.div,{...r,ref:e})});k3.displayName=kie;var Rie="ToastDescription",R3=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return a.jsx(Wt.div,{...r,ref:e})});R3.displayName=Rie;var j3="ToastAction",D3=p.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?a.jsx(L3,{altText:n,asChild:!0,children:a.jsx(DI,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${j3}\`. Expected non-empty \`string\`.`),null)});D3.displayName=j3;var M3="ToastClose",DI=p.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=Nie(M3,n);return a.jsx(L3,{asChild:!0,children:a.jsx(Wt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,s.onClose)})})});DI.displayName=M3;var L3=p.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return a.jsx(Wt.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function F3(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),Die(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...F3(r))}}),e}function Wy(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?AI(s,i):s.dispatchEvent(i)}var T2=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function jie(t=()=>{}){const e=Br(t);Ca(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function Die(t){return t.nodeType===t.ELEMENT_NODE}function Mie(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function X_(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var Lie=T3,O3=N3,$3=A3,V3=k3,U3=R3,B3=D3,z3=DI;const I2=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,N2=qV,MI=(t,e)=>n=>{var r;if((e==null?void 0:e.variants)==null)return N2(t,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=e,o=Object.keys(s).map(u=>{const d=n==null?void 0:n[u],h=i==null?void 0:i[u];if(d===null)return null;const f=I2(d)||I2(h);return s[u][f]}),l=n&&Object.entries(n).reduce((u,d)=>{let[h,f]=d;return f===void 0||(u[h]=f),u},{}),c=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((u,d)=>{let{class:h,className:f,...m}=d;return Object.entries(m).every(g=>{let[x,w]=g;return Array.isArray(w)?w.includes({...i,...l}[x]):{...i,...l}[x]===w})?[...u,h,f]:u},[]);return N2(t,o,c,n==null?void 0:n.class,n==null?void 0:n.className)};var Fie={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const Oie=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),We=(t,e)=>{const n=p.forwardRef(({color:r="currentColor",size:s=24,strokeWidth:i=2,absoluteStrokeWidth:o,children:l,...c},u)=>p.createElement("svg",{ref:u,...Fie,width:s,height:s,stroke:r,strokeWidth:o?Number(i)*24/Number(s):i,className:`lucide lucide-${Oie(t)}`,...c},[...e.map(([d,h])=>p.createElement(d,h)),...(Array.isArray(l)?l:[l])||[]]));return n.displayName=`${t}`,n},Q_=We("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Ng=We("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),Go=We("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Fu=We("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),$ie=We("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Vie=We("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]]),Zv=We("BarChart2",[["line",{x1:"18",x2:"18",y1:"20",y2:"10",key:"1xfpm4"}],["line",{x1:"12",x2:"12",y1:"20",y2:"4",key:"be30l9"}],["line",{x1:"6",x2:"6",y1:"20",y2:"14",key:"1r4le6"}]]),Uie=We("Box",[["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),Bie=We("Briefcase",[["rect",{width:"20",height:"14",x:"2",y:"7",rx:"2",ry:"2",key:"eto64e"}],["path",{d:"M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"zwj3tp"}]]),LI=We("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]),ya=We("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),Pg=We("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Pu=We("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),zie=We("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),G3=We("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),Gie=We("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]),Wie=We("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ew=We("Coins",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]),FI=We("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),Do=We("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]),P2=We("DownloadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m8 17 4 4 4-4",key:"1ul180"}]]),OI=We("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),ef=We("ExternalLink",[["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}],["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["line",{x1:"10",x2:"21",y1:"14",y2:"3",key:"18c3s4"}]]),Hie=We("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),qie=We("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]),br=We("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]),W3=We("Film",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M7 3v18",key:"bbkbws"}],["path",{d:"M3 7.5h4",key:"zfgn84"}],["path",{d:"M3 12h18",key:"1i2n21"}],["path",{d:"M3 16.5h4",key:"1230mu"}],["path",{d:"M17 3v18",key:"in4fa5"}],["path",{d:"M17 7.5h4",key:"myr1c1"}],["path",{d:"M17 16.5h4",key:"go4c1d"}]]),Ou=We("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]),Z_=We("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),A2=We("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]),H3=We("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),Kie=We("ImageDown",[["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"M10.3 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v10.8",key:"sqts6f"}],["path",{d:"m21 15-3.1-3.1a2 2 0 0 0-2.814.014L6 21",key:"1h47z9"}],["path",{d:"m14 19.5 3 3v-6",key:"1x9jmo"}],["path",{d:"m17 22.5 3-3",key:"xzuz0n"}]]),q3=We("ImagePlus",[["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7",key:"31hg93"}],["line",{x1:"16",x2:"22",y1:"5",y2:"5",key:"ez7e4s"}],["line",{x1:"19",x2:"19",y1:"2",y2:"8",key:"1gkr8c"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),RE=We("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Yie=We("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),Hx=We("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]]),Jie=We("Layers3",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m6.08 9.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1e5n1m"}],["path",{d:"m6.08 14.5-3.5 1.6a1 1 0 0 0 0 1.81l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9a1 1 0 0 0 0-1.83l-3.5-1.59",key:"1iwflc"}]]),Xie=We("Layers",[["path",{d:"m12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83Z",key:"8b97xw"}],["path",{d:"m22 17.65-9.17 4.16a2 2 0 0 1-1.66 0L2 17.65",key:"dd6zsq"}],["path",{d:"m22 12.65-9.17 4.16a2 2 0 0 1-1.66 0L2 12.65",key:"ep9fru"}]]),Qie=We("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]),Zie=We("Linkedin",[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]]),ft=We("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),eoe=We("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]),k2=We("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]),mh=We("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),toe=We("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),noe=We("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),K3=We("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),roe=We("MessageCircle",[["path",{d:"m3 21 1.9-5.7a8.5 8.5 0 1 1 3.8 3.8z",key:"v2veuj"}]]),jE=We("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]),soe=We("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]),Y3=We("MoveDown",[["path",{d:"M8 18L12 22L16 18",key:"cskvfv"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),J3=We("MoveUp",[["path",{d:"M8 6L12 2L16 6",key:"1yvkyx"}],["path",{d:"M12 2V22",key:"r89rzk"}]]),Vi=We("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),tw=We("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]),ioe=We("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),ooe=We("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]),nw=We("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]),rw=We("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]),R2=We("Pen",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}]]),X3=We("Pencil",[["path",{d:"M17 3a2.85 2.83 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5Z",key:"5qss01"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]),aoe=We("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),loe=We("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]),$I=We("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]),Ui=We("PlusCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]),Au=We("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),DE=We("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),Q3=We("Replace",[["path",{d:"M14 4c0-1.1.9-2 2-2",key:"1mvvbw"}],["path",{d:"M20 2c1.1 0 2 .9 2 2",key:"1mj6oe"}],["path",{d:"M22 8c0 1.1-.9 2-2 2",key:"v1wql3"}],["path",{d:"M16 10c-1.1 0-2-.9-2-2",key:"821ux0"}],["path",{d:"m3 7 3 3 3-3",key:"x25e72"}],["path",{d:"M6 10V5c0-1.7 1.3-3 3-3h1",key:"13af7h"}],["rect",{width:"8",height:"8",x:"2",y:"14",rx:"2",key:"17ihk4"}]]),coe=We("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),eS=We("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]),sw=We("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]]),ac=We("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),uoe=We("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),doe=We("Settings2",[["path",{d:"M20 7h-9",key:"3s1dr2"}],["path",{d:"M14 17H5",key:"gfn3mx"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]]),kh=We("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),hoe=We("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]),foe=We("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]),moe=We("ShoppingBag",[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]]),Wp=We("ShoppingCart",[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]]),Sr=We("Sparkles",[["path",{d:"m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z",key:"17u4zn"}],["path",{d:"M5 3v4",key:"bklmnn"}],["path",{d:"M19 17v4",key:"iiml17"}],["path",{d:"M3 5h4",key:"nem4j1"}],["path",{d:"M17 19h4",key:"lbex7p"}]]),VI=We("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]),Hy=We("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2v0a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12v0a2 2 0 0 1-2-2V7",key:"jon5kx"}]]),ME=We("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]),Qm=We("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]),Z3=We("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Bn=We("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),am=We("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),iw=We("Truck",[["path",{d:"M5 18H3c-.6 0-1-.4-1-1V7c0-.6.4-1 1-1h10c.6 0 1 .4 1 1v11",key:"hs4xqm"}],["path",{d:"M14 9h4l4 4v4c0 .6-.4 1-1 1h-2",key:"11fp61"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}]]),poe=We("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]]),goe=We("Unlock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),Uo=We("UploadCloud",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]),eU=We("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),$0=We("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),j2=We("Video",[["path",{d:"m22 8-6 4 6 4V8Z",key:"50v9me"}],["rect",{width:"14",height:"12",x:"2",y:"6",rx:"2",ry:"2",key:"1rqjg6"}]]),Ea=We("Wand2",[["path",{d:"m21.64 3.64-1.28-1.28a1.21 1.21 0 0 0-1.72 0L2.36 18.64a1.21 1.21 0 0 0 0 1.72l1.28 1.28a1.2 1.2 0 0 0 1.72 0L21.64 5.36a1.2 1.2 0 0 0 0-1.72Z",key:"1bcowg"}],["path",{d:"m14 7 3 3",key:"1r5n42"}],["path",{d:"M5 6v4",key:"ilb8ba"}],["path",{d:"M19 14v4",key:"blhpug"}],["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M7 8H3",key:"zfb6yr"}],["path",{d:"M21 16h-4",key:"1cnmox"}],["path",{d:"M11 3H9",key:"1obp7u"}]]),xa=We("Wand",[["path",{d:"M15 4V2",key:"z1p9b7"}],["path",{d:"M15 16v-2",key:"px0unx"}],["path",{d:"M8 9h2",key:"1g203m"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M17.8 11.8 19 13",key:"yihg8r"}],["path",{d:"M15 9h0",key:"kg5t1u"}],["path",{d:"M17.8 6.2 19 5",key:"fd4us0"}],["path",{d:"m3 21 9-9",key:"1jfql5"}],["path",{d:"M12.2 6.2 11 5",key:"i3da3b"}]]),ow=We("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ji=We("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),yoe=We("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]),tU=We("Zap",[["polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2",key:"45s27k"}]]),xoe=Lie,nU=ht.forwardRef(({className:t,...e},n)=>a.jsx(O3,{ref:n,className:bt("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));nU.displayName=O3.displayName;const voe=MI("data-[swipe=move]:transition-none group relative pointer-events-auto flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full data-[state=closed]:slide-out-to-right-full",{variants:{variant:{default:"bg-background border",destructive:"group destructive border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),rU=ht.forwardRef(({className:t,variant:e,...n},r)=>a.jsx($3,{ref:r,className:bt(voe({variant:e}),t),...n}));rU.displayName=$3.displayName;const woe=ht.forwardRef(({className:t,...e},n)=>a.jsx(B3,{ref:n,className:bt("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-destructive/30 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...e}));woe.displayName=B3.displayName;const sU=ht.forwardRef(({className:t,...e},n)=>a.jsx(z3,{ref:n,className:bt("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:a.jsx(Ji,{className:"h-4 w-4"})}));sU.displayName=z3.displayName;const iU=ht.forwardRef(({className:t,...e},n)=>a.jsx(V3,{ref:n,className:bt("text-sm font-semibold",t),...e}));iU.displayName=V3.displayName;const oU=ht.forwardRef(({className:t,...e},n)=>a.jsx(U3,{ref:n,className:bt("text-sm opacity-90",t),...e}));oU.displayName=U3.displayName;const boe=1;let tS=0;function _oe(){return tS=(tS+1)%Number.MAX_VALUE,tS.toString()}const Ws={state:{toasts:[]},listeners:[],getState:()=>Ws.state,setState:t=>{typeof t=="function"?Ws.state=t(Ws.state):Ws.state={...Ws.state,...t},Ws.listeners.forEach(e=>e(Ws.state))},subscribe:t=>(Ws.listeners.push(t),()=>{Ws.listeners=Ws.listeners.filter(e=>e!==t)})},Soe=({...t})=>{const e=_oe(),n=s=>Ws.setState(i=>({...i,toasts:i.toasts.map(o=>o.id===e?{...o,...s}:o)})),r=()=>Ws.setState(s=>({...s,toasts:s.toasts.filter(i=>i.id!==e)}));return Ws.setState(s=>({...s,toasts:[{...t,id:e,dismiss:r},...s.toasts].slice(0,boe)})),{id:e,dismiss:r,update:n}};function Ss(){const[t,e]=p.useState(Ws.getState());return p.useEffect(()=>Ws.subscribe(r=>{e(r)}),[]),p.useEffect(()=>{const n=[];return t.toasts.forEach(r=>{if(r.duration===1/0)return;const s=setTimeout(()=>{r.dismiss()},r.duration||5e3);n.push(s)}),()=>{n.forEach(r=>clearTimeout(r))}},[t.toasts]),{toast:Soe,toasts:t.toasts}}function Coe(){const{toasts:t}=Ss();return a.jsxs(xoe,{children:[t.map(({id:e,title:n,description:r,action:s,dismiss:i,...o})=>a.jsxs(rU,{...o,children:[a.jsxs("div",{className:"grid gap-1",children:[n&&a.jsx(iU,{children:n}),r&&a.jsx(oU,{children:r})]}),s,a.jsx(sU,{})]},e)),a.jsx(nU,{})]})}var Eoe=d0[" useId ".trim().toString()]||(()=>{}),Toe=0;function lc(t){const[e,n]=p.useState(Eoe());return Ca(()=>{t||n(r=>r??String(Toe++))},[t]),t||(e?`radix-${e}`:"")}var nS="focusScope.autoFocusOnMount",rS="focusScope.autoFocusOnUnmount",D2={bubbles:!1,cancelable:!0},Ioe="FocusScope",V0=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=Br(s),d=Br(i),h=p.useRef(null),f=mn(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(C){if(m.paused||!l)return;const T=C.target;l.contains(T)?h.current=T:Ml(h.current,{select:!0})},w=function(C){if(m.paused||!l)return;const T=C.relatedTarget;T!==null&&(l.contains(T)||Ml(h.current,{select:!0}))},v=function(C){if(document.activeElement===document.body)for(const R of C)R.removedNodes.length>0&&Ml(l)};document.addEventListener("focusin",x),document.addEventListener("focusout",w);const _=new MutationObserver(v);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",w),_.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){L2.add(m);const x=document.activeElement;if(!l.contains(x)){const v=new CustomEvent(nS,D2);l.addEventListener(nS,u),l.dispatchEvent(v),v.defaultPrevented||(Noe(joe(aU(l)),{select:!0}),document.activeElement===x&&Ml(l))}return()=>{l.removeEventListener(nS,u),setTimeout(()=>{const v=new CustomEvent(rS,D2);l.addEventListener(rS,d),l.dispatchEvent(v),v.defaultPrevented||Ml(x??document.body,{select:!0}),l.removeEventListener(rS,d),L2.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const w=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,v=document.activeElement;if(w&&v){const _=x.currentTarget,[C,T]=Poe(_);C&&T?!x.shiftKey&&v===T?(x.preventDefault(),n&&Ml(C,{select:!0})):x.shiftKey&&v===C&&(x.preventDefault(),n&&Ml(T,{select:!0})):v===_&&x.preventDefault()}},[n,r,m.paused]);return a.jsx(Wt.div,{tabIndex:-1,...o,ref:f,onKeyDown:g})});V0.displayName=Ioe;function Noe(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ml(r,{select:e}),document.activeElement!==n)return}function Poe(t){const e=aU(t),n=M2(e,t),r=M2(e.reverse(),t);return[n,r]}function aU(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function M2(t,e){for(const n of t)if(!Aoe(n,{upTo:e}))return n}function Aoe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function koe(t){return t instanceof HTMLInputElement&&"select"in t}function Ml(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&koe(t)&&e&&t.select()}}var L2=Roe();function Roe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=F2(t,e),t.unshift(e)},remove(e){var n;t=F2(t,e),(n=t[0])==null||n.resume()}}}function F2(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function joe(t){return t.filter(e=>e.tagName!=="A")}var sS=0;function UI(){p.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??O2()),document.body.insertAdjacentElement("beforeend",t[1]??O2()),sS++,()=>{sS===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),sS--}},[])}function O2(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Ds=function(){return Ds=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},Ds.apply(this,arguments)};function Rf(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function lU(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var Zm="right-scroll-bar-position",ep="width-before-scroll-bar",Doe="with-scroll-bars-hidden",Moe="--removed-body-scroll-bar-size";function iS(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Loe(t,e){var n=p.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var Foe=typeof window<"u"?p.useLayoutEffect:p.useEffect,$2=new WeakMap;function cU(t,e){var n=Loe(e||null,function(r){return t.forEach(function(s){return iS(s,r)})});return Foe(function(){var r=$2.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(l){i.has(l)||iS(l,null)}),i.forEach(function(l){s.has(l)||iS(l,o)})}$2.set(n,t)},[t]),n}function Ooe(t){return t}function $oe(t,e){e===void 0&&(e=Ooe);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(l){return l!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(l){return i(l)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var l=n;n=[],l.forEach(i),o=n}var c=function(){var d=o;o=[],d.forEach(i)},u=function(){return Promise.resolve().then(c)};u(),n={push:function(d){o.push(d),u()},filter:function(d){return o=o.filter(d),n}}}};return s}function uU(t){t===void 0&&(t={});var e=$oe(null);return e.options=Ds({async:!0,ssr:!1},t),e}var dU=function(t){var e=t.sideCar,n=Rf(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return p.createElement(r,Ds({},n))};dU.isSideCarExport=!0;function hU(t,e){return t.useMedium(e),dU}var fU=uU(),oS=function(){},U0=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:oS,onWheelCapture:oS,onTouchMoveCapture:oS}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noRelative,g=t.noIsolation,x=t.inert,w=t.allowPinchZoom,v=t.as,_=v===void 0?"div":v,C=t.gapMode,T=Rf(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),R=f,k=cU([n,e]),E=Ds(Ds({},T),s);return p.createElement(p.Fragment,null,d&&p.createElement(R,{sideCar:fU,removeScrollBar:u,shards:h,noRelative:m,noIsolation:g,inert:x,setCallbacks:i,allowPinchZoom:!!w,lockRef:n,gapMode:C}),o?p.cloneElement(p.Children.only(l),Ds(Ds({},E),{ref:k})):p.createElement(_,Ds({},E,{className:c,ref:k}),l))});U0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};U0.classNames={fullWidth:ep,zeroRight:Zm};var V2,Voe=function(){if(V2)return V2;if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Uoe(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Voe();return e&&t.setAttribute("nonce",e),t}function Boe(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function zoe(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Goe=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Uoe())&&(Boe(e,n),zoe(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Woe=function(){var t=Goe();return function(e,n){p.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},BI=function(){var t=Woe(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},Hoe={left:0,top:0,right:0,gap:0},aS=function(t){return parseInt(t||"",10)||0},qoe=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[aS(n),aS(r),aS(s)]},Koe=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Hoe;var e=qoe(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},Yoe=BI(),Rh="data-scroll-locked",Joe=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,l=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Doe,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(l,"px ").concat(r,`;
  }
  body[`).concat(Rh,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(l,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(l,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Zm,` {
    right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(ep,` {
    margin-right: `).concat(l,"px ").concat(r,`;
  }
  
  .`).concat(Zm," .").concat(Zm,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(ep," .").concat(ep,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Rh,`] {
    `).concat(Moe,": ").concat(l,`px;
  }
`)},U2=function(){var t=parseInt(document.body.getAttribute(Rh)||"0",10);return isFinite(t)?t:0},Xoe=function(){p.useEffect(function(){return document.body.setAttribute(Rh,(U2()+1).toString()),function(){var t=U2()-1;t<=0?document.body.removeAttribute(Rh):document.body.setAttribute(Rh,t.toString())}},[])},mU=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;Xoe();var i=p.useMemo(function(){return Koe(s)},[s]);return p.createElement(Yoe,{styles:Joe(i,!e,s,n?"":"!important")})},LE=!1;if(typeof window<"u")try{var qy=Object.defineProperty({},"passive",{get:function(){return LE=!0,!0}});window.addEventListener("test",qy,qy),window.removeEventListener("test",qy,qy)}catch{LE=!1}var kd=LE?{passive:!1}:!1,Qoe=function(t){return t.tagName==="TEXTAREA"},pU=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!Qoe(t)&&n[e]==="visible")},Zoe=function(t){return pU(t,"overflowY")},eae=function(t){return pU(t,"overflowX")},B2=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=gU(t,r);if(s){var i=yU(t,r),o=i[1],l=i[2];if(o>l)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},tae=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},nae=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},gU=function(t,e){return t==="v"?Zoe(e):eae(e)},yU=function(t,e){return t==="v"?tae(e):nae(e)},rae=function(t,e){return t==="h"&&e==="rtl"?-1:1},sae=function(t,e,n,r,s){var i=rae(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=yU(t,l),g=m[0],x=m[1],w=m[2],v=x-w-i*g;(g||v)&&gU(t,l)&&(h+=v,f+=g),l=l.parentNode.host||l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&Math.abs(h)<1||!s&&o>h)||!d&&(s&&Math.abs(f)<1||!s&&-o>f))&&(u=!0),u},Ky=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},z2=function(t){return[t.deltaX,t.deltaY]},G2=function(t){return t&&"current"in t?t.current:t},iae=function(t,e){return t[0]===e[0]&&t[1]===e[1]},oae=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},aae=0,Rd=[];function lae(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(aae++)[0],i=p.useState(BI)[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=lU([t.lockRef.current],(t.shards||[]).map(G2),!0).filter(Boolean);return x.forEach(function(w){return w.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,w){if("touches"in x&&x.touches.length===2||x.type==="wheel"&&x.ctrlKey)return!o.current.allowPinchZoom;var v=Ky(x),_=n.current,C="deltaX"in x?x.deltaX:_[0]-v[0],T="deltaY"in x?x.deltaY:_[1]-v[1],R,k=x.target,E=Math.abs(C)>Math.abs(T)?"h":"v";if("touches"in x&&E==="h"&&k.type==="range")return!1;var I=B2(E,k);if(!I)return!0;if(I?R=E:(R=E==="v"?"h":"v",I=B2(E,k)),!I)return!1;if(!r.current&&"changedTouches"in x&&(C||T)&&(r.current=R),!R)return!0;var P=r.current||R;return sae(P,w,x,P==="h"?C:T,!0)},[]),c=p.useCallback(function(x){var w=x;if(!(!Rd.length||Rd[Rd.length-1]!==i)){var v="deltaY"in w?z2(w):Ky(w),_=e.current.filter(function(R){return R.name===w.type&&(R.target===w.target||w.target===R.shadowParent)&&iae(R.delta,v)})[0];if(_&&_.should){w.cancelable&&w.preventDefault();return}if(!_){var C=(o.current.shards||[]).map(G2).filter(Boolean).filter(function(R){return R.contains(w.target)}),T=C.length>0?l(w,C[0]):!o.current.noIsolation;T&&w.cancelable&&w.preventDefault()}}},[]),u=p.useCallback(function(x,w,v,_){var C={name:x,delta:w,target:v,should:_,shadowParent:cae(v)};e.current.push(C),setTimeout(function(){e.current=e.current.filter(function(T){return T!==C})},1)},[]),d=p.useCallback(function(x){n.current=Ky(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,z2(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,Ky(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return Rd.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,kd),document.addEventListener("touchmove",c,kd),document.addEventListener("touchstart",d,kd),function(){Rd=Rd.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,kd),document.removeEventListener("touchmove",c,kd),document.removeEventListener("touchstart",d,kd)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:oae(s)}):null,m?p.createElement(mU,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function cae(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const uae=hU(fU,lae);var xU=p.forwardRef(function(t,e){return p.createElement(U0,Ds({},t,{ref:e,sideCar:uae}))});xU.classNames=U0.classNames;const zI=xU;var dae=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},jd=new WeakMap,Yy=new WeakMap,Jy={},lS=0,vU=function(t){return t&&(t.host||vU(t.parentNode))},hae=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=vU(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},fae=function(t,e,n,r){var s=hae(e,Array.isArray(t)?t:[t]);Jy[n]||(Jy[n]=new WeakMap);var i=Jy[n],o=[],l=new Set,c=new Set(s),u=function(h){!h||l.has(h)||(l.add(h),u(h.parentNode))};s.forEach(u);var d=function(h){!h||c.has(h)||Array.prototype.forEach.call(h.children,function(f){if(l.has(f))d(f);else try{var m=f.getAttribute(r),g=m!==null&&m!=="false",x=(jd.get(f)||0)+1,w=(i.get(f)||0)+1;jd.set(f,x),i.set(f,w),o.push(f),x===1&&g&&Yy.set(f,!0),w===1&&f.setAttribute(n,"true"),g||f.setAttribute(r,"true")}catch(v){console.error("aria-hidden: cannot operate on ",f,v)}})};return d(e),l.clear(),lS++,function(){o.forEach(function(h){var f=jd.get(h)-1,m=i.get(h)-1;jd.set(h,f),i.set(h,m),f||(Yy.has(h)||h.removeAttribute(r),Yy.delete(h)),m||h.removeAttribute(n)}),lS--,lS||(jd=new WeakMap,jd=new WeakMap,Yy=new WeakMap,Jy={})}},B0=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=e||dae(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live], script"))),fae(r,s,n,"aria-hidden")):function(){return null}},z0="Dialog",[wU,bU]=bi(z0),[mae,Jo]=wU(z0),_U=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,l=p.useRef(null),c=p.useRef(null),[u,d]=Vc({prop:r,defaultProp:s??!1,onChange:i,caller:z0});return a.jsx(mae,{scope:e,triggerRef:l,contentRef:c,contentId:lc(),titleId:lc(),descriptionId:lc(),open:u,onOpenChange:d,onOpenToggle:p.useCallback(()=>d(h=>!h),[d]),modal:o,children:n})};_U.displayName=z0;var SU="DialogTrigger",CU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Jo(SU,n),i=mn(e,s.triggerRef);return a.jsx(Wt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":HI(s.open),...r,ref:i,onClick:gt(t.onClick,s.onOpenToggle)})});CU.displayName=SU;var GI="DialogPortal",[pae,EU]=wU(GI,{forceMount:void 0}),TU=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=Jo(GI,e);return a.jsx(pae,{scope:e,forceMount:n,children:p.Children.map(r,o=>a.jsx(_s,{present:n||i.open,children:a.jsx(Tg,{asChild:!0,container:s,children:o})}))})};TU.displayName=GI;var aw="DialogOverlay",IU=p.forwardRef((t,e)=>{const n=EU(aw,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Jo(aw,t.__scopeDialog);return i.modal?a.jsx(_s,{present:r||i.open,children:a.jsx(yae,{...s,ref:e})}):null});IU.displayName=aw;var gae=Yu("DialogOverlay.RemoveScroll"),yae=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Jo(aw,n);return a.jsx(zI,{as:gae,allowPinchZoom:!0,shards:[s.contentRef],children:a.jsx(Wt.div,{"data-state":HI(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),Ju="DialogContent",NU=p.forwardRef((t,e)=>{const n=EU(Ju,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Jo(Ju,t.__scopeDialog);return a.jsx(_s,{present:r||i.open,children:i.modal?a.jsx(xae,{...s,ref:e}):a.jsx(vae,{...s,ref:e})})});NU.displayName=Ju;var xae=p.forwardRef((t,e)=>{const n=Jo(Ju,t.__scopeDialog),r=p.useRef(null),s=mn(e,n.contentRef,r);return p.useEffect(()=>{const i=r.current;if(i)return B0(i)},[]),a.jsx(PU,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gt(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:gt(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0;(o.button===2||l)&&i.preventDefault()}),onFocusOutside:gt(t.onFocusOutside,i=>i.preventDefault())})}),vae=p.forwardRef((t,e)=>{const n=Jo(Ju,t.__scopeDialog),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(PU,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),PU=p.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,l=Jo(Ju,n),c=p.useRef(null),u=mn(e,c);return UI(),a.jsxs(a.Fragment,{children:[a.jsx(V0,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(Eg,{role:"dialog",id:l.contentId,"aria-describedby":l.descriptionId,"aria-labelledby":l.titleId,"data-state":HI(l.open),...o,ref:u,onDismiss:()=>l.onOpenChange(!1)})}),a.jsxs(a.Fragment,{children:[a.jsx(bae,{titleId:l.titleId}),a.jsx(Sae,{contentRef:c,descriptionId:l.descriptionId})]})]})}),WI="DialogTitle",AU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Jo(WI,n);return a.jsx(Wt.h2,{id:s.titleId,...r,ref:e})});AU.displayName=WI;var kU="DialogDescription",RU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Jo(kU,n);return a.jsx(Wt.p,{id:s.descriptionId,...r,ref:e})});RU.displayName=kU;var jU="DialogClose",DU=p.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Jo(jU,n);return a.jsx(Wt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,()=>s.onOpenChange(!1))})});DU.displayName=jU;function HI(t){return t?"open":"closed"}var MU="DialogTitleWarning",[wae,LU]=Hse(MU,{contentName:Ju,titleName:WI,docsSlug:"dialog"}),bae=({titleId:t})=>{const e=LU(MU),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return p.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},_ae="DialogDescriptionWarning",Sae=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${LU(_ae).contentName}}.`;return p.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},Cae=_U,Eae=CU,FU=TU,qI=IU,KI=NU,YI=AU,JI=RU,G0=DU;const zr=Cae,Tae=FU,al=G0,OU=ht.forwardRef(({className:t,...e},n)=>a.jsx(qI,{ref:n,className:bt("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));OU.displayName=qI.displayName;const Dr=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(Tae,{children:[a.jsx(OU,{}),a.jsxs(KI,{ref:r,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n,children:[e,a.jsxs(G0,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[a.jsx(Ji,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Dr.displayName=KI.displayName;const Mr=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});Mr.displayName="DialogHeader";const Nr=({className:t,...e})=>a.jsx("div",{className:bt("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});Nr.displayName="DialogFooter";const Lr=ht.forwardRef(({className:t,...e},n)=>a.jsx(YI,{ref:n,className:bt("text-lg font-semibold leading-none tracking-tight",t),...e}));Lr.displayName=YI.displayName;const _i=ht.forwardRef(({className:t,...e},n)=>a.jsx(JI,{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));_i.displayName=JI.displayName;const XI=MI("inline-flex items-center justify-center rounded-xl text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-foreground text-primary-foreground hover:bg-foreground/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-xl px-3",lg:"h-11 rounded-xl px-8",icon:"h-10 w-10 rounded-xl"}},defaultVariants:{variant:"default",size:"default"}}),$=ht.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const o=r?Kse:"button";return a.jsx(o,{className:bt(XI({variant:e,size:n,className:t})),ref:i,...s})});$.displayName="Button";const qe=ht.forwardRef(({className:t,type:e,...n},r)=>a.jsx("input",{type:e,className:bt("flex h-10 w-full rounded-xl bg-white dark:bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));qe.displayName="Input";const Cn=ht.forwardRef(({className:t,...e},n)=>a.jsx("textarea",{className:bt("flex min-h-[80px] w-full rounded-xl bg-white dark:bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-zinc-400 dark:placeholder:text-zinc-600 focus-visible:outline-none disabled:cursor-not-allowed disabled:opacity-50",t),ref:n,...e}));Cn.displayName="Textarea";var Iae="Label",$U=p.forwardRef((t,e)=>a.jsx(Wt.label,{...t,ref:e,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=t.onMouseDown)==null||s.call(t,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));$U.displayName=Iae;var VU=$U;const ke=ht.forwardRef(({className:t,...e},n)=>a.jsx(VU,{ref:n,className:bt("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...e}));ke.displayName=VU.displayName;var Nae=p.createContext(void 0);function W0(t){const e=p.useContext(Nae);return t||e||"ltr"}var cS="rovingFocusGroup.onEntryFocus",Pae={bubbles:!1,cancelable:!0},Ag="RovingFocusGroup",[FE,UU,Aae]=PI(Ag),[kae,H0]=bi(Ag,[Aae]),[Rae,jae]=kae(Ag),BU=p.forwardRef((t,e)=>a.jsx(FE.Provider,{scope:t.__scopeRovingFocusGroup,children:a.jsx(FE.Slot,{scope:t.__scopeRovingFocusGroup,children:a.jsx(Dae,{...t,ref:e})})}));BU.displayName=Ag;var Dae=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:l,onCurrentTabStopIdChange:c,onEntryFocus:u,preventScrollOnEntryFocus:d=!1,...h}=t,f=p.useRef(null),m=mn(e,f),g=W0(i),[x,w]=Vc({prop:o,defaultProp:l??null,onChange:c,caller:Ag}),[v,_]=p.useState(!1),C=Br(u),T=UU(n),R=p.useRef(!1),[k,E]=p.useState(0);return p.useEffect(()=>{const I=f.current;if(I)return I.addEventListener(cS,C),()=>I.removeEventListener(cS,C)},[C]),a.jsx(Rae,{scope:n,orientation:r,dir:g,loop:s,currentTabStopId:x,onItemFocus:p.useCallback(I=>w(I),[w]),onItemShiftTab:p.useCallback(()=>_(!0),[]),onFocusableItemAdd:p.useCallback(()=>E(I=>I+1),[]),onFocusableItemRemove:p.useCallback(()=>E(I=>I-1),[]),children:a.jsx(Wt.div,{tabIndex:v||k===0?-1:0,"data-orientation":r,...h,ref:m,style:{outline:"none",...t.style},onMouseDown:gt(t.onMouseDown,()=>{R.current=!0}),onFocus:gt(t.onFocus,I=>{const P=!R.current;if(I.target===I.currentTarget&&P&&!v){const A=new CustomEvent(cS,Pae);if(I.currentTarget.dispatchEvent(A),!A.defaultPrevented){const D=T().filter(K=>K.focusable),j=D.find(K=>K.active),M=D.find(K=>K.id===x),U=[j,M,...D].filter(Boolean).map(K=>K.ref.current);WU(U,d)}}R.current=!1}),onBlur:gt(t.onBlur,()=>_(!1))})})}),zU="RovingFocusGroupItem",GU=p.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:o,...l}=t,c=lc(),u=i||c,d=jae(zU,n),h=d.currentTabStopId===u,f=UU(n),{onFocusableItemAdd:m,onFocusableItemRemove:g,currentTabStopId:x}=d;return p.useEffect(()=>{if(r)return m(),()=>g()},[r,m,g]),a.jsx(FE.ItemSlot,{scope:n,id:u,focusable:r,active:s,children:a.jsx(Wt.span,{tabIndex:h?0:-1,"data-orientation":d.orientation,...l,ref:e,onMouseDown:gt(t.onMouseDown,w=>{r?d.onItemFocus(u):w.preventDefault()}),onFocus:gt(t.onFocus,()=>d.onItemFocus(u)),onKeyDown:gt(t.onKeyDown,w=>{if(w.key==="Tab"&&w.shiftKey){d.onItemShiftTab();return}if(w.target!==w.currentTarget)return;const v=Fae(w,d.orientation,d.dir);if(v!==void 0){if(w.metaKey||w.ctrlKey||w.altKey||w.shiftKey)return;w.preventDefault();let C=f().filter(T=>T.focusable).map(T=>T.ref.current);if(v==="last")C.reverse();else if(v==="prev"||v==="next"){v==="prev"&&C.reverse();const T=C.indexOf(w.currentTarget);C=d.loop?Oae(C,T+1):C.slice(T+1)}setTimeout(()=>WU(C))}}),children:typeof o=="function"?o({isCurrentTabStop:h,hasTabStop:x!=null}):o})})});GU.displayName=zU;var Mae={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Lae(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function Fae(t,e,n){const r=Lae(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Mae[r]}function WU(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function Oae(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var HU=BU,qU=GU,q0="Tabs",[$ae,Aje]=bi(q0,[H0]),KU=H0(),[Vae,QI]=$ae(q0),YU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:o="horizontal",dir:l,activationMode:c="automatic",...u}=t,d=W0(l),[h,f]=Vc({prop:r,onChange:s,defaultProp:i??"",caller:q0});return a.jsx(Vae,{scope:n,baseId:lc(),value:h,onValueChange:f,orientation:o,dir:d,activationMode:c,children:a.jsx(Wt.div,{dir:d,"data-orientation":o,...u,ref:e})})});YU.displayName=q0;var JU="TabsList",XU=p.forwardRef((t,e)=>{const{__scopeTabs:n,loop:r=!0,...s}=t,i=QI(JU,n),o=KU(n);return a.jsx(HU,{asChild:!0,...o,orientation:i.orientation,dir:i.dir,loop:r,children:a.jsx(Wt.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:e})})});XU.displayName=JU;var QU="TabsTrigger",ZU=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=t,o=QI(QU,n),l=KU(n),c=n5(o.baseId,r),u=r5(o.baseId,r),d=r===o.value;return a.jsx(qU,{asChild:!0,...l,focusable:!s,active:d,children:a.jsx(Wt.button,{type:"button",role:"tab","aria-selected":d,"aria-controls":u,"data-state":d?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:c,...i,ref:e,onMouseDown:gt(t.onMouseDown,h=>{!s&&h.button===0&&h.ctrlKey===!1?o.onValueChange(r):h.preventDefault()}),onKeyDown:gt(t.onKeyDown,h=>{[" ","Enter"].includes(h.key)&&o.onValueChange(r)}),onFocus:gt(t.onFocus,()=>{const h=o.activationMode!=="manual";!d&&!s&&h&&o.onValueChange(r)})})})});ZU.displayName=QU;var e5="TabsContent",t5=p.forwardRef((t,e)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...o}=t,l=QI(e5,n),c=n5(l.baseId,r),u=r5(l.baseId,r),d=r===l.value,h=p.useRef(d);return p.useEffect(()=>{const f=requestAnimationFrame(()=>h.current=!1);return()=>cancelAnimationFrame(f)},[]),a.jsx(_s,{present:s||d,children:({present:f})=>a.jsx(Wt.div,{"data-state":d?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!f,id:u,tabIndex:0,...o,ref:e,style:{...t.style,animationDuration:h.current?"0s":void 0},children:f&&i})})});t5.displayName=e5;function n5(t,e){return`${t}-trigger-${e}`}function r5(t,e){return`${t}-content-${e}`}var Uae=YU,s5=XU,i5=ZU,o5=t5;const Si=Uae,ti=ht.forwardRef(({className:t,...e},n)=>a.jsx(s5,{ref:n,className:bt("inline-flex h-10 items-center justify-center rounded-[18px] bg-white dark:bg-[#1c1c1c] p-1 text-muted-foreground",t),...e}));ti.displayName=s5.displayName;const jt=ht.forwardRef(({className:t,...e},n)=>a.jsx(i5,{ref:n,className:bt("inline-flex items-center justify-center whitespace-nowrap rounded-xl px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-gray-100 data-[state=active]:dark:bg-zinc-700 data-[state=active]:text-foreground data-[state=active]:shadow-sm data-[state=active]:border data-[state=active]:border-[#8d9499] data-[state=active]:relative data-[state=active]:-top-px",t),...e}));jt.displayName=i5.displayName;const Dt=ht.forwardRef(({className:t,...e},n)=>a.jsx(o5,{ref:n,className:bt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Dt.displayName=o5.displayName;var Bae="Separator",W2="horizontal",zae=["horizontal","vertical"],a5=p.forwardRef((t,e)=>{const{decorative:n,orientation:r=W2,...s}=t,i=Gae(r)?r:W2,l=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return a.jsx(Wt.div,{"data-orientation":i,...l,...s,ref:e})});a5.displayName=Bae;function Gae(t){return zae.includes(t)}var l5=a5;const zi=ht.forwardRef(({className:t,orientation:e="horizontal",decorative:n=!0,...r},s)=>a.jsx(l5,{ref:s,decorative:n,orientation:e,className:bt("shrink-0 bg-border",e==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",t),...r}));zi.displayName=l5.displayName;const c5="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk";console.log("[geminiImageGeneration Module] VITE_GEMINI_API_KEY loaded:",`"${c5.substring(0,5)}..."`);const u5="YsU4YZtXedeyLPn6bQaNT8PD";console.log("[geminiImageGeneration Module] VITE_REMOVE_BG_API_KEY loaded:",`"${u5.substring(0,5)}..."`);const bl=c5,ZI=u5,Aa=[{category:Tr.HARM_CATEGORY_HARASSMENT,threshold:Ir.BLOCK_NONE},{category:Tr.HARM_CATEGORY_HATE_SPEECH,threshold:Ir.BLOCK_NONE},{category:Tr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Ir.BLOCK_NONE},{category:Tr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Ir.BLOCK_NONE}];async function Wae(t,e,n){var r;try{const s=[{inlineData:{mimeType:e,data:t}},{text:"Describe the main colors of this logo. Is it primarily black, white, or colorful? If black or white, state which. If colorful, list the dominant colors."}],i=await n.models.generateContent({model:"gemini-2.0-flash",contents:s,safetySettings:Aa,config:{responseModalities:[yn.TEXT]}}),o=((r=i==null?void 0:i.text)==null?void 0:r.toLowerCase())||"";return console.log("[getLogoColorType] Gemini color description:",o),o.includes("primarily black")||o.includes("black logo")?"black":o.includes("primarily white")||o.includes("white logo")?"white":(o.includes("colorful")||o.includes("multiple colors")||o.includes("various colors")||console.warn("[getLogoColorType] Could not clearly determine logo color type. Defaulting to 'colored'. Desc:",o),"colored")}catch(s){return console.error("[getLogoColorType] Error analyzing logo color:",s),"colored"}}async function kg(t,e=(n,r)=>console.log(`Logo Progress: ${n}%, Message: ${r||""}`)){var l,c,u,d;if(!t)throw new Error("Store name is required.");const n=new _n({apiKey:bl}),r=`Create a modern, clean, and professional logo for an e-commerce store named "${t}". The logo should be suitable for a website header. Avoid text in the logo itself, or if text is present, ensure it is "${t}" and highly legible. Focus on an iconic and memorable design. Generate a square image. The main subject of the logo should be prominent.`;let s="",i=null,o=null;try{console.log("[generateLogoWithGemini] Generating initial logo for:",t),e(void 0,`Generating initial logo for ${t}...`);const h=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Aa,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});if((u=(c=(l=h.candidates)==null?void 0:l[0])==null?void 0:c.content)!=null&&u.parts){for(const _ of h.candidates[0].content.parts)if(_.text)s+=_.text;else if((d=_.inlineData)!=null&&d.data){i=_.inlineData.data,o=_.inlineData.mimeType;break}}if(!i)throw new Error("Failed to generate initial image data. "+(s||"No text explanation."));console.log("[generateLogoWithGemini] Initial logo generated. MimeType:",o);let f=null,m=null,g=i,x=o;if(ZI)try{console.log("[generateLogoWithGemini] Removing background."),e(void 0,"Removing logo background..."),g=await d5(i,o),x="image/png",console.log("[generateLogoWithGemini] Background removed."),e(void 0,"Background removed.")}catch(_){console.warn("[generateLogoWithGemini] BG removal failed, using original:",_.message),e(void 0,"Background removal failed.")}const w=await Wae(g,x,n),v=`data:${x};base64,${g}`;if(w==="black"){m=v;try{const _=await Wo(g,x,"Convert this black logo to a white logo, maintaining transparency and all details precisely. Output only the modified image.");if(_.editedImageData)f=`data:${_.newMimeType};base64,${_.editedImageData}`;else throw new Error("Inversion to white failed.")}catch(_){console.warn("[generateLogoWithGemini] Failed to make white version:",_.message),f=v}}else if(w==="white"){f=v;try{const _=await Wo(g,x,"Convert this white logo to a black logo, maintaining transparency and all details precisely. Output only the modified image.");if(_.editedImageData)m=`data:${_.newMimeType};base64,${_.editedImageData}`;else throw new Error("Inversion to black failed.")}catch(_){console.warn("[generateLogoWithGemini] Failed to make black version:",_.message),m=v}}else f=v,m=v;return{logoUrlLight:f,logoUrlDark:m,textResponse:s}}catch(h){throw console.error("[generateLogoWithGemini] Main error:",h.message,h.stack),new Error(`Logo generation failed: ${h.message||"Unknown error"}`)}}async function ca(t,e,n){return console.warn("Skipping image caption generation due to environment limitations."),["Generated image description."]}function Hae(t,e){const n=atob(t),r=new Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return new Blob([new Uint8Array(r)],{type:e})}async function d5(t,e){const n=Hae(t,e),r=new FormData;r.append("size","auto"),r.append("image_file",n,"logo_temp"+(e.startsWith("image/")?"."+e.substring(6):".bin")),r.append("format","png");try{const s=await fetch("https://api.remove.bg/v1.0/removebg",{method:"POST",headers:{"X-Api-Key":ZI},body:r});if(!s.ok){const o=await s.text();throw new Error(`Remove.bg API Error ${s.status}: ${o}`)}const i=await s.arrayBuffer();return btoa(new Uint8Array(i).reduce((o,l)=>o+String.fromCharCode(l),""))}catch(s){throw console.error("[removeBackgroundFromLogo] Error:",s.message),s}}async function Wo(t,e,n){var i,o,l,c;if(!t||!e||!n)throw new Error("Image data, MIME type, and prompt required.");const r=new _n({apiKey:bl}),s=[{text:n},{inlineData:{mimeType:e,data:t}}];try{const u=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:s,safetySettings:Aa,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});let d=null,h="",f=e;if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)h+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,f=m.inlineData.mimeType||e;break}}if(!d)throw new Error("Failed to edit image. "+(h||"No text explanation."));return{editedImageData:d,newMimeType:f,editTextResponse:h}}catch(u){throw console.error("[editImageWithGemini] Error:",u.message),new Error(`Image editing failed: ${u.message||"Unknown error"}`)}}async function h5(t,e){var s,i,o,l;if(!t)throw new Error("Product name required.");const n=new _n({apiKey:bl});let r=`Generate a clean, commercial-style product image for "${t}".`;e&&(r+=` Description: "${e}".`),r+=" Main focus on product, simple/neutral/white background for e-commerce. Square image.";try{const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Aa,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});let u=null,d="",h="image/png";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)d+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,h=f.inlineData.mimeType||"image/png";break}}if(!u)throw new Error("Failed to generate product image. "+(d||"No text explanation."));if(ZI)try{return{imageData:await d5(u,h),textResponse:d}}catch(f){console.warn("[generateGenericProductImageWithGemini] BG removal failed, using original:",f.message)}return{imageData:u,textResponse:d}}catch(c){throw console.error("[generateGenericProductImageWithGemini] Error:",c.message),new Error(`Product image generation failed: ${c.message||"Unknown error"}`)}}async function Rg({prompt:t,referenceImage:e}){var i,o,l,c;if(!t)throw new Error("Prompt required.");const n=new _n({apiKey:bl});let r;const s=`Generate visually appealing image/print design to place on a product based on the following user prompt for a store generator: "${t}". Solely the image/design alone that is intended to go on products (canvas, t-shirts, mugs) not the products themselves. Square image.`;e!=null&&e.base64Data&&(e!=null&&e.mimeType)?r=[{text:`Using the provided image as a reference, generate a new image based on the following concept: "${t}". Ensure the output is suitable for print-on-demand merchandise and is a square image.`},{inlineData:{mimeType:e.mimeType,data:e.base64Data}}]:r=s;try{const u=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Aa,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});let d=null,h=null,f="";if((l=(o=(i=u.candidates)==null?void 0:i[0])==null?void 0:o.content)!=null&&l.parts){for(const m of u.candidates[0].content.parts)if(m.text)f+=m.text;else if((c=m.inlineData)!=null&&c.data){d=m.inlineData.data,h=m.inlineData.mimeType;break}}if(!d)throw new Error("Failed to generate image from prompt. "+(f||"No text explanation."));return{imageData:d,imageMimeType:h,textResponse:f}}catch(u){throw console.error("[generateImageFromPromptForPod] Error:",u.message),new Error(`Image generation for POD failed: ${u.message||"Unknown error"}`)}}async function qae(t){try{const e=await fetch(t);if(!e.ok)throw console.warn(`Direct fetch for ${t} failed with status ${e.status}. Retrying without proxy for now.`),new Error(`Failed to fetch image ${t}: ${e.statusText}`);const n=await e.blob(),r=n.type;if(!r.startsWith("image/"))throw new Error(`Fetched content from ${t} is not an image. MIME type: ${r}`);const s=await n.arrayBuffer();return{base64Data:btoa(new Uint8Array(s).reduce((o,l)=>o+String.fromCharCode(l),"")),mimeType:r}}catch(e){throw console.error(`Error in fetchImageAsBase64 for ${t}:`,e),e}}async function tf(t,e,n,r,s){var o,l,c,u;if(!t||!e||!n||!r||!s)throw console.error("[visualizeImageOnProductWithGemini] Missing required parameters."),new Error("Missing required parameters for product visualization.");const i=new _n({apiKey:bl});try{console.log(`[visualizeImageOnProductWithGemini] Fetching base product image from: ${n}`);const{base64Data:d,mimeType:h}=await qae(n);console.log(`[visualizeImageOnProductWithGemini] Fetched mockup: ${h}, length: ${d.length}`);const f={inlineData:{mimeType:e,data:t}},m={inlineData:{mimeType:h,data:d}},x=[{text:`You are an expert product visualization AI.
Task: Place the first provided image (the 'design') onto the second provided image (the '${s}' mockup).
Design Details: The design was conceptualized with the idea: "${r}".
Mockup: The mockup is a '${s}'.
Instructions:
1. Realistically superimpose the design onto the mockup.
2. Ensure the design conforms to the shape and texture of the mockup.
3. Maintain the original quality and details of both the design and the mockup where appropriate.
4. Output only the final visualized product image. Do not add any extra text or explanations in the image itself.
`},f,m];console.log(`[visualizeImageOnProductWithGemini] Calling Gemini API for ${s} with prompt: "${r}"`);const w=await i.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:x,safetySettings:Aa,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});let v=null,_=null,C="";if((c=(l=(o=w.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const T of w.candidates[0].content.parts)if(T.text)C+=T.text;else if((u=T.inlineData)!=null&&u.data){v=T.inlineData.data,_=T.inlineData.mimeType;break}}if(console.log(`[visualizeImageOnProductWithGemini] API Text Response: ${C}`),!v)throw console.error("[visualizeImageOnProductWithGemini] Failed to get visualized image data from API.",C),new Error("Failed to visualize product. API did not return image data. "+(C||"No text explanation."));return console.log(`[visualizeImageOnProductWithGemini] Visualization successful for ${s}. MimeType: ${_}`),{visualizedImageData:v,visualizedImageMimeType:_,productDetails:{title:`Custom ${s} (Viz)`,price:24.99,description:`Unique ${s} featuring the design: "${r}".`},apiTextResponse:C}}catch(d){return console.error(`[visualizeImageOnProductWithGemini] Error visualizing ${s}:`,d),{visualizedImageData:null,visualizedImageMimeType:null,productDetails:{title:`Custom ${s}`,price:24.99,description:`Failed to visualize design on ${s}. Error: ${d.message}`},error:d.message}}}async function K0(t,e,n){var o,l,c,u;if(!t||!e||!n)throw new Error("Image data, MIME type, and product name required.");const r=new _n({apiKey:bl}),s=[`Show this product, "${n}", from a slightly high front-left angle. Maintain product integrity.`,`Show this product, "${n}", from a direct side view. Maintain product integrity.`,`Show this product, "${n}", from a top-down perspective. Maintain product integrity.`],i=[];try{for(const d of s){const h=[{text:d},{inlineData:{mimeType:e,data:t}}],f=await r.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:h,safetySettings:Aa,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});let m=null;if((c=(l=(o=f.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const g of f.candidates[0].content.parts)if((u=g.inlineData)!=null&&u.data){m=`data:${g.inlineData.mimeType};base64,${g.inlineData.data}`,i.push(m);break}}m||console.warn("[generateDifferentAnglesFromImage] No image data for one angle.")}if(i.length===0)throw new Error("Failed to generate any additional angle images.");return i}catch(d){throw console.error("[generateDifferentAnglesFromImage] Error:",d.message),new Error(`Generating different angles failed: ${d.message||"Unknown error"}`)}}async function f5(t,e){var s,i,o,l;if(!t)throw new Error("Collection name is required to generate an image.");const n=new _n({apiKey:bl});let r=`Generate a visually appealing banner image for an e-commerce collection named "${t}".`;e&&(r+=` The collection is described as: "${e}".`),r+=" The image should be thematic or abstract, suitable for a collection header or card. It should evoke the essence of the collection. Consider a wide aspect ratio like 16:9 or a square image if more appropriate for a card.";try{console.log(`[generateCollectionImageWithGemini] Generating image for collection: ${t}`);const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:[{role:"user",parts:[{text:r}]}],safetySettings:Aa,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});let u=null,d="image/png",h="";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const f of c.candidates[0].content.parts)if(f.text)h+=f.text;else if((l=f.inlineData)!=null&&l.data){u=f.inlineData.data,d=f.inlineData.mimeType||d;break}}if(!u)throw new Error("Failed to generate image data for the collection. "+(h||"No text explanation from AI."));return{imageData:u,imageMimeType:d,textResponse:h}}catch(c){throw console.error(`[generateCollectionImageWithGemini] Error generating image for collection "${t}":`,c),new Error(`Collection image generation failed for "${t}": ${c.message||"Unknown error"}`)}}async function eN(t,e=[]){var s,i,o,l;if(!t)throw new Error("Prompt is required.");const n=new _n({apiKey:bl}),r=[{text:t}];e.forEach(c=>{r.push({inlineData:{mimeType:c.mimeType,data:c.data}})});try{const c=await n.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:r,safetySettings:Aa,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});let u=null,d="";if((o=(i=(s=c.candidates)==null?void 0:s[0])==null?void 0:i.content)!=null&&o.parts){for(const h of c.candidates[0].content.parts)if(h.text)d+=h.text;else if((l=h.inlineData)!=null&&l.data){u=h.inlineData.data;break}}if(!u)throw new Error(d||"Failed to generate image. No image data returned.");return{imageData:u,text:d}}catch(c){throw console.error("[generateImage] Error:",c.message),new Error(`Image generation failed: ${c.message||"Unknown error"}`)}}async function OE(t,e,n,r=[]){var o,l,c,u;if(!t||!e||!n)throw new Error("Prompt, image data, and MIME type are required.");const s=new _n({apiKey:bl}),i=[{text:t},{inlineData:{mimeType:n,data:e}}];r.forEach(d=>{i.push({inlineData:{mimeType:d.mimeType,data:d.data}})});try{const d=await s.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:i,safetySettings:Aa,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});let h=null,f="";if((c=(l=(o=d.candidates)==null?void 0:o[0])==null?void 0:l.content)!=null&&c.parts){for(const m of d.candidates[0].content.parts)if(m.text)f+=m.text;else if((u=m.inlineData)!=null&&u.data){h=m.inlineData.data;break}}if(!h)throw new Error(f||"Failed to edit image. No image data returned.");return{imageData:h,text:f}}catch(d){throw console.error("[editImage] Error:",d.message),new Error(`Image editing failed: ${d.message||"Unknown error"}`)}}const Kae=Object.freeze(Object.defineProperty({__proto__:null,editImage:OE,editImageWithGemini:Wo,generateCaptionForImageData:ca,generateCollectionImageWithGemini:f5,generateDifferentAnglesFromImage:K0,generateGenericProductImageWithGemini:h5,generateImage:eN,generateImageFromPromptForPod:Rg,generateLogoWithGemini:kg,visualizeImageOnProductWithGemini:tf},Symbol.toStringTag,{value:"Module"})),tN="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk",lw=new _n({apiKey:tN}),Yae=async(t,e={})=>{var n,r,s;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");console.log(`Starting video generation with prompt: "${t}"`);try{let i=await lw.models.generateVideos({model:"veo-2.0-generate-001",prompt:t,config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...e}});for(console.log("Video generation operation started:",i.name);!i.done;)console.log(`Polling operation ${i.name}, current status: ${((n=i.metadata)==null?void 0:n.state)||"UNKNOWN"}`),await new Promise(l=>setTimeout(l,1e4)),i=await lw.operations.getVideosOperation({operation:i});if(console.log("Video generation operation completed:",i.name,"Done:",i.done),i.error)throw console.error("Error during video generation operation:",i.error),new Error(`Video generation failed: ${i.error.message||"Unknown error"}`);const o=(r=i.response)==null?void 0:r.generatedVideos;if(o&&o.length>0&&((s=o[0].video)!=null&&s.uri)){const c=`${o[0].video.uri}&key=${tN}`;return console.log("Generated video URI (with key appended):",c),c}else throw console.error("No video URI found in the response:",i.response),new Error("Video generation completed, but no video URI was returned.")}catch(i){throw console.error("Failed to generate video with Veo:",i),i.message&&i.message.includes("Quota")?new Error("Video generation failed due to quota limits. Please check your Google Cloud project quotas."):i.message&&i.message.includes("API key not valid")?new Error("Video generation failed due to an invalid API key. Please check your VITE_GEMINI_API_KEY."):i}},nN=async(t,e,n,r={})=>{var s,i,o;if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required.");if(!e||typeof e!="string")throw new Error("Valid base64 image data string is required.");if(!n||typeof n!="string")throw new Error("Valid image MIME type string is required.");console.log(`Starting image-to-video generation with prompt: "${t}" and image (mimeType: ${n})`);try{const l={model:"veo-2.0-generate-001",prompt:t,image:{imageBytes:e,mimeType:n},config:{personGeneration:"dont_allow",aspectRatio:"16:9",numberOfVideos:1,durationSeconds:6,...r}};console.log("Veo image-to-video payload (excluding imageBytes):",{...l,image:{mimeType:l.image.mimeType,imageBytes:"..."}});let c=await lw.models.generateVideos(l);for(console.log("Image-to-video generation operation started:",c.name);!c.done;)console.log(`Polling operation ${c.name}, current status: ${((s=c.metadata)==null?void 0:s.state)||"UNKNOWN"}`),await new Promise(d=>setTimeout(d,1e4)),c=await lw.operations.getVideosOperation({operation:c});if(console.log("Image-to-video generation operation completed:",c.name,"Done:",c.done),c.error)throw console.error("Error during image-to-video generation operation:",c.error),new Error(`Image-to-video generation failed: ${c.error.message||"Unknown error"}`);const u=(i=c.response)==null?void 0:i.generatedVideos;if(u&&u.length>0&&((o=u[0].video)!=null&&o.uri)){const h=`${u[0].video.uri}&key=${tN}`;return console.log("Generated image-to-video URI (with key appended):",h),h}else throw console.error("No video URI found in the image-to-video response:",c.response),new Error("Image-to-video generation completed, but no video URI was returned.")}catch(l){throw console.error("Failed to generate image-to-video with Veo:",l),l.message&&l.message.includes("Quota")?new Error("Image-to-video generation failed due to quota limits."):l.message&&l.message.includes("API key not valid")?new Error("Image-to-video generation failed due to an invalid API key."):l}},Jae=()=>{};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m5=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let s=t.charCodeAt(r);s<128?e[n++]=s:s<2048?(e[n++]=s>>6|192,e[n++]=s&63|128):(s&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(s=65536+((s&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=s>>18|240,e[n++]=s>>12&63|128,e[n++]=s>>6&63|128,e[n++]=s&63|128):(e[n++]=s>>12|224,e[n++]=s>>6&63|128,e[n++]=s&63|128)}return e},Xae=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const s=t[n++];if(s<128)e[r++]=String.fromCharCode(s);else if(s>191&&s<224){const i=t[n++];e[r++]=String.fromCharCode((s&31)<<6|i&63)}else if(s>239&&s<365){const i=t[n++],o=t[n++],l=t[n++],c=((s&7)<<18|(i&63)<<12|(o&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(c>>10)),e[r++]=String.fromCharCode(56320+(c&1023))}else{const i=t[n++],o=t[n++];e[r++]=String.fromCharCode((s&15)<<12|(i&63)<<6|o&63)}}return e.join("")},p5={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let s=0;s<t.length;s+=3){const i=t[s],o=s+1<t.length,l=o?t[s+1]:0,c=s+2<t.length,u=c?t[s+2]:0,d=i>>2,h=(i&3)<<4|l>>4;let f=(l&15)<<2|u>>6,m=u&63;c||(m=64,o||(f=64)),r.push(n[d],n[h],n[f],n[m])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(m5(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):Xae(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let s=0;s<t.length;){const i=n[t.charAt(s++)],l=s<t.length?n[t.charAt(s)]:0;++s;const u=s<t.length?n[t.charAt(s)]:64;++s;const h=s<t.length?n[t.charAt(s)]:64;if(++s,i==null||l==null||u==null||h==null)throw new Qae;const f=i<<2|l>>4;if(r.push(f),u!==64){const m=l<<4&240|u>>2;if(r.push(m),h!==64){const g=u<<6&192|h;r.push(g)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class Qae extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const Zae=function(t){const e=m5(t);return p5.encodeByteArray(e,!0)},cw=function(t){return Zae(t).replace(/\./g,"")},g5=function(t){try{return p5.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y5(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ele=()=>y5().__FIREBASE_DEFAULTS__,tle=()=>{if(typeof process>"u"||typeof process.env>"u")return;const t={}.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},nle=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&g5(t[1]);return e&&JSON.parse(e)},Y0=()=>{try{return Jae()||ele()||tle()||nle()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},x5=t=>{var e,n;return(n=(e=Y0())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},rN=t=>{const e=x5(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},v5=()=>{var t;return(t=Y0())===null||t===void 0?void 0:t.config},w5=t=>{var e;return(e=Y0())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rle{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Uc(t){return t.endsWith(".cloudworkstations.dev")}async function J0(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function b5(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",s=t.iat||0,i=t.sub||t.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const o=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:s,exp:s+3600,auth_time:s,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[cw(JSON.stringify(n)),cw(JSON.stringify(o)),l].join(".")}const tp={};function sle(){const t={prod:[],emulator:[]};for(const e of Object.keys(tp))tp[e]?t.emulator.push(e):t.prod.push(e);return t}function ile(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let H2=!1;function X0(t,e){if(typeof window>"u"||typeof document>"u"||!Uc(window.location.host)||tp[t]===e||tp[t]||H2)return;tp[t]=e;function n(f){return`__firebase__banner__${f}`}const r="__firebase__banner",i=sle().prod.length>0;function o(){const f=document.getElementById(r);f&&f.remove()}function l(f){f.style.display="flex",f.style.background="#7faaf0",f.style.position="fixed",f.style.bottom="5px",f.style.left="5px",f.style.padding=".5em",f.style.borderRadius="5px",f.style.alignItems="center"}function c(f,m){f.setAttribute("width","24"),f.setAttribute("id",m),f.setAttribute("height","24"),f.setAttribute("viewBox","0 0 24 24"),f.setAttribute("fill","none"),f.style.marginLeft="-6px"}function u(){const f=document.createElement("span");return f.style.cursor="pointer",f.style.marginLeft="16px",f.style.fontSize="24px",f.innerHTML=" &times;",f.onclick=()=>{H2=!0,o()},f}function d(f,m){f.setAttribute("id",m),f.innerText="Learn more",f.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",f.setAttribute("target","__blank"),f.style.paddingLeft="5px",f.style.textDecoration="underline"}function h(){const f=ile(r),m=n("text"),g=document.getElementById(m)||document.createElement("span"),x=n("learnmore"),w=document.getElementById(x)||document.createElement("a"),v=n("preprendIcon"),_=document.getElementById(v)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(f.created){const C=f.element;l(C),d(w,x);const T=u();c(_,v),C.append(_,g,w,T),document.body.appendChild(C)}i?(g.innerText="Preview backend disconnected.",_.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(_.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,g.innerText="Preview backend running in this workspace."),g.setAttribute("id",m)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",h):h()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xr(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function ole(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Xr())}function _5(){var t;const e=(t=Y0())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function ale(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function lle(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function cle(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function ule(){const t=Xr();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function S5(){return!_5()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function C5(){return!_5()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function E5(){try{return typeof indexedDB=="object"}catch{return!1}}function dle(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",s=self.indexedDB.open(r);s.onsuccess=()=>{s.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},s.onupgradeneeded=()=>{n=!1},s.onerror=()=>{var i;e(((i=s.error)===null||i===void 0?void 0:i.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hle="FirebaseError";class Xo extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=hle,Object.setPrototypeOf(this,Xo.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jg.prototype.create)}}class jg{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},s=`${this.service}/${e}`,i=this.errors[e],o=i?fle(i,r):"Error",l=`${this.serviceName}: ${o} (${s}).`;return new Xo(s,l,r)}}function fle(t,e){return t.replace(mle,(n,r)=>{const s=e[r];return s!=null?String(s):`<${r}?>`})}const mle=/\{\$([^}]+)}/g;function ple(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Xu(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const s of n){if(!r.includes(s))return!1;const i=t[s],o=e[s];if(q2(i)&&q2(o)){if(!Xu(i,o))return!1}else if(i!==o)return!1}for(const s of r)if(!n.includes(s))return!1;return!0}function q2(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dg(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(s=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(s))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function Im(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[s,i]=r.split("=");e[decodeURIComponent(s)]=decodeURIComponent(i)}}),e}function Nm(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function gle(t,e){const n=new yle(t,e);return n.subscribe.bind(n)}class yle{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");xle(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=uS),s.error===void 0&&(s.error=uS),s.complete===void 0&&(s.complete=uS);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?s.error(this.finalError):s.complete()}catch{}}),this.observers.push(s),i}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function xle(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function uS(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jn(t){return t&&t._delegate?t._delegate:t}class ll{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uu="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vle{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new rle;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const s=this.getOrInitializeService({instanceIdentifier:n});s&&r.resolve(s)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),s=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(i){if(s)return null;throw i}else{if(s)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(ble(e))try{this.getOrInitializeService({instanceIdentifier:uu})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(n);try{const i=this.getOrInitializeService({instanceIdentifier:s});r.resolve(i)}catch{}}}}clearInstance(e=uu){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=uu){return this.instances.has(e)}getOptions(e=uu){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const s=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[i,o]of this.instancesDeferred.entries()){const l=this.normalizeInstanceIdentifier(i);r===l&&o.resolve(s)}return s}onInit(e,n){var r;const s=this.normalizeInstanceIdentifier(n),i=(r=this.onInitCallbacks.get(s))!==null&&r!==void 0?r:new Set;i.add(e),this.onInitCallbacks.set(s,i);const o=this.instances.get(s);return o&&e(o,s),()=>{i.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const s of r)try{s(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:wle(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=uu){return this.component?this.component.multipleInstances?e:uu:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function wle(t){return t===uu?void 0:t}function ble(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _le{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new vle(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var an;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(an||(an={}));const Sle={debug:an.DEBUG,verbose:an.VERBOSE,info:an.INFO,warn:an.WARN,error:an.ERROR,silent:an.SILENT},Cle=an.INFO,Ele={[an.DEBUG]:"log",[an.VERBOSE]:"log",[an.INFO]:"info",[an.WARN]:"warn",[an.ERROR]:"error"},Tle=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),s=Ele[e];if(s)console[s](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class sN{constructor(e){this.name=e,this._logLevel=Cle,this._logHandler=Tle,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in an))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?Sle[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,an.DEBUG,...e),this._logHandler(this,an.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,an.VERBOSE,...e),this._logHandler(this,an.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,an.INFO,...e),this._logHandler(this,an.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,an.WARN,...e),this._logHandler(this,an.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,an.ERROR,...e),this._logHandler(this,an.ERROR,...e)}}const Ile=(t,e)=>e.some(n=>t instanceof n);let K2,Y2;function Nle(){return K2||(K2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function Ple(){return Y2||(Y2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const T5=new WeakMap,$E=new WeakMap,I5=new WeakMap,dS=new WeakMap,iN=new WeakMap;function Ale(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(cc(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&T5.set(n,t)}).catch(()=>{}),iN.set(e,t),e}function kle(t){if($E.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});$E.set(t,e)}let VE={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return $E.get(t);if(e==="objectStoreNames")return t.objectStoreNames||I5.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return cc(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function Rle(t){VE=t(VE)}function jle(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(hS(this),e,...n);return I5.set(r,e.sort?e.sort():[e]),cc(r)}:Ple().includes(t)?function(...e){return t.apply(hS(this),e),cc(T5.get(this))}:function(...e){return cc(t.apply(hS(this),e))}}function Dle(t){return typeof t=="function"?jle(t):(t instanceof IDBTransaction&&kle(t),Ile(t,Nle())?new Proxy(t,VE):t)}function cc(t){if(t instanceof IDBRequest)return Ale(t);if(dS.has(t))return dS.get(t);const e=Dle(t);return e!==t&&(dS.set(t,e),iN.set(e,t)),e}const hS=t=>iN.get(t);function Mle(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),l=cc(o);return r&&o.addEventListener("upgradeneeded",c=>{r(cc(o.result),c.oldVersion,c.newVersion,cc(o.transaction),c)}),n&&o.addEventListener("blocked",c=>n(c.oldVersion,c.newVersion,c)),l.then(c=>{i&&c.addEventListener("close",()=>i()),s&&c.addEventListener("versionchange",u=>s(u.oldVersion,u.newVersion,u))}).catch(()=>{}),l}const Lle=["get","getKey","getAll","getAllKeys","count"],Fle=["put","add","delete","clear"],fS=new Map;function J2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(fS.get(e))return fS.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=Fle.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||Lle.includes(n)))return;const i=async function(o,...l){const c=this.transaction(o,s?"readwrite":"readonly");let u=c.store;return r&&(u=u.index(l.shift())),(await Promise.all([u[n](...l),s&&c.done]))[0]};return fS.set(e,i),i}Rle(t=>({...t,get:(e,n,r)=>J2(e,n)||t.get(e,n,r),has:(e,n)=>!!J2(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ole{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if($le(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function $le(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const UE="@firebase/app",X2="0.13.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cl=new sN("@firebase/app"),Vle="@firebase/app-compat",Ule="@firebase/analytics-compat",Ble="@firebase/analytics",zle="@firebase/app-check-compat",Gle="@firebase/app-check",Wle="@firebase/auth",Hle="@firebase/auth-compat",qle="@firebase/database",Kle="@firebase/data-connect",Yle="@firebase/database-compat",Jle="@firebase/functions",Xle="@firebase/functions-compat",Qle="@firebase/installations",Zle="@firebase/installations-compat",ece="@firebase/messaging",tce="@firebase/messaging-compat",nce="@firebase/performance",rce="@firebase/performance-compat",sce="@firebase/remote-config",ice="@firebase/remote-config-compat",oce="@firebase/storage",ace="@firebase/storage-compat",lce="@firebase/firestore",cce="@firebase/ai",uce="@firebase/firestore-compat",dce="firebase",hce="11.8.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const BE="[DEFAULT]",fce={[UE]:"fire-core",[Vle]:"fire-core-compat",[Ble]:"fire-analytics",[Ule]:"fire-analytics-compat",[Gle]:"fire-app-check",[zle]:"fire-app-check-compat",[Wle]:"fire-auth",[Hle]:"fire-auth-compat",[qle]:"fire-rtdb",[Kle]:"fire-data-connect",[Yle]:"fire-rtdb-compat",[Jle]:"fire-fn",[Xle]:"fire-fn-compat",[Qle]:"fire-iid",[Zle]:"fire-iid-compat",[ece]:"fire-fcm",[tce]:"fire-fcm-compat",[nce]:"fire-perf",[rce]:"fire-perf-compat",[sce]:"fire-rc",[ice]:"fire-rc-compat",[oce]:"fire-gcs",[ace]:"fire-gcs-compat",[lce]:"fire-fst",[uce]:"fire-fst-compat",[cce]:"fire-vertex","fire-js":"fire-js",[dce]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uw=new Map,mce=new Map,zE=new Map;function Q2(t,e){try{t.container.addComponent(e)}catch(n){cl.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Sc(t){const e=t.name;if(zE.has(e))return cl.debug(`There were multiple attempts to register component ${e}.`),!1;zE.set(e,t);for(const n of uw.values())Q2(n,t);for(const n of mce.values())Q2(n,t);return!0}function Mg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Ks(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pce={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},uc=new jg("app","Firebase",pce);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gce{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new ll("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw uc.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const md=hce;function N5(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:BE,automaticDataCollectionEnabled:!0},e),s=r.name;if(typeof s!="string"||!s)throw uc.create("bad-app-name",{appName:String(s)});if(n||(n=v5()),!n)throw uc.create("no-options");const i=uw.get(s);if(i){if(Xu(n,i.options)&&Xu(r,i.config))return i;throw uc.create("duplicate-app",{appName:s})}const o=new _le(s);for(const c of zE.values())o.addComponent(c);const l=new gce(n,r,o);return uw.set(s,l),l}function Q0(t=BE){const e=uw.get(t);if(!e&&t===BE&&v5())return N5();if(!e)throw uc.create("no-app",{appName:t});return e}function mo(t,e,n){var r;let s=(r=fce[t])!==null&&r!==void 0?r:t;n&&(s+=`-${n}`);const i=s.match(/\s|\//),o=e.match(/\s|\//);if(i||o){const l=[`Unable to register library "${s}" with version "${e}":`];i&&l.push(`library name "${s}" contains illegal characters (whitespace or "/")`),i&&o&&l.push("and"),o&&l.push(`version name "${e}" contains illegal characters (whitespace or "/")`),cl.warn(l.join(" "));return}Sc(new ll(`${s}-version`,()=>({library:s,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yce="firebase-heartbeat-database",xce=1,Hp="firebase-heartbeat-store";let mS=null;function P5(){return mS||(mS=Mle(yce,xce,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Hp)}catch(n){console.warn(n)}}}}).catch(t=>{throw uc.create("idb-open",{originalErrorMessage:t.message})})),mS}async function vce(t){try{const n=(await P5()).transaction(Hp),r=await n.objectStore(Hp).get(A5(t));return await n.done,r}catch(e){if(e instanceof Xo)cl.warn(e.message);else{const n=uc.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});cl.warn(n.message)}}}async function Z2(t,e){try{const r=(await P5()).transaction(Hp,"readwrite");await r.objectStore(Hp).put(e,A5(t)),await r.done}catch(n){if(n instanceof Xo)cl.warn(n.message);else{const r=uc.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});cl.warn(r.message)}}}function A5(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wce=1024,bce=30;class _ce{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new Cce(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const s=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),i=eD();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===i||this._heartbeatsCache.heartbeats.some(o=>o.date===i))return;if(this._heartbeatsCache.heartbeats.push({date:i,agent:s}),this._heartbeatsCache.heartbeats.length>bce){const o=Ece(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(o,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){cl.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=eD(),{heartbeatsToSend:r,unsentEntries:s}=Sce(this._heartbeatsCache.heartbeats),i=cw(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,s.length>0?(this._heartbeatsCache.heartbeats=s,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(n){return cl.warn(n),""}}}function eD(){return new Date().toISOString().substring(0,10)}function Sce(t,e=wce){const n=[];let r=t.slice();for(const s of t){const i=n.find(o=>o.agent===s.agent);if(i){if(i.dates.push(s.date),tD(n)>e){i.dates.pop();break}}else if(n.push({agent:s.agent,dates:[s.date]}),tD(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class Cce{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return E5()?dle().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await vce(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Z2(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const s=await this.read();return Z2(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:s.lastSentHeartbeatDate,heartbeats:[...s.heartbeats,...e.heartbeats]})}else return}}function tD(t){return cw(JSON.stringify({version:2,heartbeats:t})).length}function Ece(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tce(t){Sc(new ll("platform-logger",e=>new Ole(e),"PRIVATE")),Sc(new ll("heartbeat",e=>new _ce(e),"PRIVATE")),mo(UE,X2,t),mo(UE,X2,"esm2017"),mo("fire-js","")}Tce("");var Ice="firebase",Nce="11.8.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */mo(Ice,Nce,"app");function k5(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const Pce=k5,R5=new jg("auth","Firebase",k5());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dw=new sN("@firebase/auth");function Ace(t,...e){dw.logLevel<=an.WARN&&dw.warn(`Auth (${md}): ${t}`,...e)}function qx(t,...e){dw.logLevel<=an.ERROR&&dw.error(`Auth (${md}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vo(t,...e){throw aN(t,...e)}function Bo(t,...e){return aN(t,...e)}function oN(t,e,n){const r=Object.assign(Object.assign({},Pce()),{[e]:n});return new jg("auth","Firebase",r).create(e,{appName:t.name})}function Ja(t){return oN(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function kce(t,e,n){const r=n;if(!(e instanceof r))throw r.name!==e.constructor.name&&vo(t,"argument-error"),oN(t,"argument-error",`Type of ${e.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function aN(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return R5.create(t,...e)}function $t(t,e,...n){if(!t)throw aN(e,...n)}function Ga(t){const e="INTERNAL ASSERTION FAILED: "+t;throw qx(e),new Error(e)}function ul(t,e){t||Ga(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function GE(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function Rce(){return nD()==="http:"||nD()==="https:"}function nD(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jce(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(Rce()||lle()||"connection"in navigator)?navigator.onLine:!0}function Dce(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lg{constructor(e,n){this.shortDelay=e,this.longDelay=n,ul(n>e,"Short delay should be less than long delay!"),this.isMobile=ole()||cle()}get(){return jce()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lN(t,e){ul(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class j5{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;Ga("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;Ga("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;Ga("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Mce={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lce=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],Fce=new Lg(3e4,6e4);function Bc(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function zc(t,e,n,r,s={}){return D5(t,s,async()=>{let i={},o={};r&&(e==="GET"?o=r:i={body:JSON.stringify(r)});const l=Dg(Object.assign({key:t.config.apiKey},o)).slice(1),c=await t._getAdditionalHeaders();c["Content-Type"]="application/json",t.languageCode&&(c["X-Firebase-Locale"]=t.languageCode);const u=Object.assign({method:e,headers:c},i);return ale()||(u.referrerPolicy="no-referrer"),t.emulatorConfig&&Uc(t.emulatorConfig.host)&&(u.credentials="include"),j5.fetch()(await M5(t,t.config.apiHost,n,l),u)})}async function D5(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},Mce),e);try{const s=new $ce(t),i=await Promise.race([n(),s.promise]);s.clearNetworkTimeout();const o=await i.json();if("needConfirmation"in o)throw Xy(t,"account-exists-with-different-credential",o);if(i.ok&&!("errorMessage"in o))return o;{const l=i.ok?o.errorMessage:o.error.message,[c,u]=l.split(" : ");if(c==="FEDERATED_USER_ID_ALREADY_LINKED")throw Xy(t,"credential-already-in-use",o);if(c==="EMAIL_EXISTS")throw Xy(t,"email-already-in-use",o);if(c==="USER_DISABLED")throw Xy(t,"user-disabled",o);const d=r[c]||c.toLowerCase().replace(/[_\s]+/g,"-");if(u)throw oN(t,d,u);vo(t,d)}}catch(s){if(s instanceof Xo)throw s;vo(t,"network-request-failed",{message:String(s)})}}async function Fg(t,e,n,r,s={}){const i=await zc(t,e,n,r,s);return"mfaPendingCredential"in i&&vo(t,"multi-factor-auth-required",{_serverResponse:i}),i}async function M5(t,e,n,r){const s=`${e}${n}?${r}`,i=t,o=i.config.emulator?lN(t.config,s):`${t.config.apiScheme}://${s}`;return Lce.includes(n)&&(await i._persistenceManagerAvailable,i._getPersistenceType()==="COOKIE")?i._getPersistence()._getFinalTarget(o).toString():o}function Oce(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class $ce{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Bo(this.auth,"network-request-failed")),Fce.get())})}}function Xy(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const s=Bo(t,e,r);return s.customData._tokenResponse=n,s}function rD(t){return t!==void 0&&t.enterprise!==void 0}class Vce{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return Oce(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function Uce(t,e){return zc(t,"GET","/v2/recaptchaConfig",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Bce(t,e){return zc(t,"POST","/v1/accounts:delete",e)}async function hw(t,e){return zc(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function np(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function zce(t,e=!1){const n=Jn(t),r=await n.getIdToken(e),s=cN(r);$t(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const i=typeof s.firebase=="object"?s.firebase:void 0,o=i==null?void 0:i.sign_in_provider;return{claims:s,token:r,authTime:np(pS(s.auth_time)),issuedAtTime:np(pS(s.iat)),expirationTime:np(pS(s.exp)),signInProvider:o||null,signInSecondFactor:(i==null?void 0:i.sign_in_second_factor)||null}}function pS(t){return Number(t)*1e3}function cN(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return qx("JWT malformed, contained fewer than 3 sections"),null;try{const s=g5(n);return s?JSON.parse(s):(qx("Failed to decode base64 JWT payload"),null)}catch(s){return qx("Caught error parsing JWT payload as JSON",s==null?void 0:s.toString()),null}}function sD(t){const e=cN(t);return $t(e,"internal-error"),$t(typeof e.exp<"u","internal-error"),$t(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function qp(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof Xo&&Gce(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function Gce({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wce{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const s=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,s)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WE{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=np(this.lastLoginAt),this.creationTime=np(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fw(t){var e;const n=t.auth,r=await t.getIdToken(),s=await qp(t,hw(n,{idToken:r}));$t(s==null?void 0:s.users.length,n,"internal-error");const i=s.users[0];t._notifyReloadListener(i);const o=!((e=i.providerUserInfo)===null||e===void 0)&&e.length?L5(i.providerUserInfo):[],l=qce(t.providerData,o),c=t.isAnonymous,u=!(t.email&&i.passwordHash)&&!(l!=null&&l.length),d=c?u:!1,h={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:l,metadata:new WE(i.createdAt,i.lastLoginAt),isAnonymous:d};Object.assign(t,h)}async function Hce(t){const e=Jn(t);await fw(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function qce(t,e){return[...t.filter(r=>!e.some(s=>s.providerId===r.providerId)),...e]}function L5(t){return t.map(e=>{var{providerId:n}=e,r=Rf(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Kce(t,e){const n=await D5(t,{},async()=>{const r=Dg({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:s,apiKey:i}=t.config,o=await M5(t,s,"/v1/token",`key=${i}`),l=await t._getAdditionalHeaders();return l["Content-Type"]="application/x-www-form-urlencoded",j5.fetch()(o,{method:"POST",headers:l,body:r})});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function Yce(t,e){return zc(t,"POST","/v2/accounts:revokeToken",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jh{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){$t(e.idToken,"internal-error"),$t(typeof e.idToken<"u","internal-error"),$t(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):sD(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){$t(e.length!==0,"internal-error");const n=sD(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:($t(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:s,expiresIn:i}=await Kce(e,n);this.updateTokensAndExpiration(r,s,Number(i))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:s,expirationTime:i}=n,o=new jh;return r&&($t(typeof r=="string","internal-error",{appName:e}),o.refreshToken=r),s&&($t(typeof s=="string","internal-error",{appName:e}),o.accessToken=s),i&&($t(typeof i=="number","internal-error",{appName:e}),o.expirationTime=i),o}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new jh,this.toJSON())}_performRefresh(){return Ga("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tl(t,e){$t(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class Mo{constructor(e){var{uid:n,auth:r,stsTokenManager:s}=e,i=Rf(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Wce(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=s,this.accessToken=s.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new WE(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const n=await qp(this,this.stsTokenManager.getToken(this.auth,e));return $t(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return zce(this,e)}reload(){return Hce(this)}_assign(e){this!==e&&($t(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new Mo(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){$t(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await fw(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ks(this.auth.app))return Promise.reject(Ja(this.auth));const e=await this.getIdToken();return await qp(this,Bce(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,s,i,o,l,c,u,d;const h=(r=n.displayName)!==null&&r!==void 0?r:void 0,f=(s=n.email)!==null&&s!==void 0?s:void 0,m=(i=n.phoneNumber)!==null&&i!==void 0?i:void 0,g=(o=n.photoURL)!==null&&o!==void 0?o:void 0,x=(l=n.tenantId)!==null&&l!==void 0?l:void 0,w=(c=n._redirectEventId)!==null&&c!==void 0?c:void 0,v=(u=n.createdAt)!==null&&u!==void 0?u:void 0,_=(d=n.lastLoginAt)!==null&&d!==void 0?d:void 0,{uid:C,emailVerified:T,isAnonymous:R,providerData:k,stsTokenManager:E}=n;$t(C&&E,e,"internal-error");const I=jh.fromJSON(this.name,E);$t(typeof C=="string",e,"internal-error"),Tl(h,e.name),Tl(f,e.name),$t(typeof T=="boolean",e,"internal-error"),$t(typeof R=="boolean",e,"internal-error"),Tl(m,e.name),Tl(g,e.name),Tl(x,e.name),Tl(w,e.name),Tl(v,e.name),Tl(_,e.name);const P=new Mo({uid:C,auth:e,email:f,emailVerified:T,displayName:h,isAnonymous:R,photoURL:g,phoneNumber:m,tenantId:x,stsTokenManager:I,createdAt:v,lastLoginAt:_});return k&&Array.isArray(k)&&(P.providerData=k.map(A=>Object.assign({},A))),w&&(P._redirectEventId=w),P}static async _fromIdTokenResponse(e,n,r=!1){const s=new jh;s.updateFromServerResponse(n);const i=new Mo({uid:n.localId,auth:e,stsTokenManager:s,isAnonymous:r});return await fw(i),i}static async _fromGetAccountInfoResponse(e,n,r){const s=n.users[0];$t(s.localId!==void 0,"internal-error");const i=s.providerUserInfo!==void 0?L5(s.providerUserInfo):[],o=!(s.email&&s.passwordHash)&&!(i!=null&&i.length),l=new jh;l.updateFromIdToken(r);const c=new Mo({uid:s.localId,auth:e,stsTokenManager:l,isAnonymous:o}),u={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:i,metadata:new WE(s.createdAt,s.lastLoginAt),isAnonymous:!(s.email&&s.passwordHash)&&!(i!=null&&i.length)};return Object.assign(c,u),c}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const iD=new Map;function Wa(t){ul(t instanceof Function,"Expected a class definition");let e=iD.get(t);return e?(ul(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,iD.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F5{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}F5.type="NONE";const oD=F5;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kx(t,e,n){return`firebase:${t}:${e}:${n}`}class Dh{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:s,name:i}=this.auth;this.fullUserKey=Kx(this.userKey,s.apiKey,i),this.fullPersistenceKey=Kx("persistence",s.apiKey,i),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await hw(this.auth,{idToken:e}).catch(()=>{});return n?Mo._fromGetAccountInfoResponse(this.auth,n,e):null}return Mo._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new Dh(Wa(oD),e,r);const s=(await Promise.all(n.map(async u=>{if(await u._isAvailable())return u}))).filter(u=>u);let i=s[0]||Wa(oD);const o=Kx(r,e.config.apiKey,e.name);let l=null;for(const u of n)try{const d=await u._get(o);if(d){let h;if(typeof d=="string"){const f=await hw(e,{idToken:d}).catch(()=>{});if(!f)break;h=await Mo._fromGetAccountInfoResponse(e,f,d)}else h=Mo._fromJSON(e,d);u!==i&&(l=h),i=u;break}}catch{}const c=s.filter(u=>u._shouldAllowMigration);return!i._shouldAllowMigration||!c.length?new Dh(i,e,r):(i=c[0],l&&await i._set(o,l.toJSON()),await Promise.all(n.map(async u=>{if(u!==i)try{await u._remove(o)}catch{}})),new Dh(i,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aD(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(U5(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(O5(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(z5(e))return"Blackberry";if(G5(e))return"Webos";if($5(e))return"Safari";if((e.includes("chrome/")||V5(e))&&!e.includes("edge/"))return"Chrome";if(B5(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function O5(t=Xr()){return/firefox\//i.test(t)}function $5(t=Xr()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function V5(t=Xr()){return/crios\//i.test(t)}function U5(t=Xr()){return/iemobile/i.test(t)}function B5(t=Xr()){return/android/i.test(t)}function z5(t=Xr()){return/blackberry/i.test(t)}function G5(t=Xr()){return/webos/i.test(t)}function uN(t=Xr()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function Jce(t=Xr()){var e;return uN(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function Xce(){return ule()&&document.documentMode===10}function W5(t=Xr()){return uN(t)||B5(t)||G5(t)||z5(t)||/windows phone/i.test(t)||U5(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H5(t,e=[]){let n;switch(t){case"Browser":n=aD(Xr());break;case"Worker":n=`${aD(Xr())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${md}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Qce{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=i=>new Promise((o,l)=>{try{const c=e(i);o(c)}catch(c){l(c)}});r.onAbort=n,this.queue.push(r);const s=this.queue.length-1;return()=>{this.queue[s]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const s of n)try{s()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zce(t,e={}){return zc(t,"GET","/v2/passwordPolicy",Bc(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const eue=6;class tue{constructor(e){var n,r,s,i;const o=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=o.minPasswordLength)!==null&&n!==void 0?n:eue,o.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=o.maxPasswordLength),o.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=o.containsLowercaseCharacter),o.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=o.containsUppercaseCharacter),o.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=o.containsNumericCharacter),o.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=o.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(s=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&s!==void 0?s:"",this.forceUpgradeOnSignin=(i=e.forceUpgradeOnSignin)!==null&&i!==void 0?i:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,s,i,o,l;const c={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,c),this.validatePasswordCharacterOptions(e,c),c.isValid&&(c.isValid=(n=c.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),c.isValid&&(c.isValid=(r=c.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),c.isValid&&(c.isValid=(s=c.containsLowercaseLetter)!==null&&s!==void 0?s:!0),c.isValid&&(c.isValid=(i=c.containsUppercaseLetter)!==null&&i!==void 0?i:!0),c.isValid&&(c.isValid=(o=c.containsNumericCharacter)!==null&&o!==void 0?o:!0),c.isValid&&(c.isValid=(l=c.containsNonAlphanumericCharacter)!==null&&l!==void 0?l:!0),c}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,s=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),s&&(n.meetsMaxPasswordLength=e.length<=s)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let s=0;s<e.length;s++)r=e.charAt(s),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,s,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=s)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nue{constructor(e,n,r,s){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=s,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new lD(this),this.idTokenSubscription=new lD(this),this.beforeStateQueue=new Qce(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=R5,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=s.sdkClientVersion,this._persistenceManagerAvailable=new Promise(i=>this._resolvePersistenceManagerAvailable=i)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=Wa(n)),this._initializationPromise=this.queue(async()=>{var r,s,i;if(!this._deleted&&(this.persistenceManager=await Dh.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((s=this._popupRedirectResolver)===null||s===void 0)&&s._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((i=this.currentUser)===null||i===void 0?void 0:i.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await hw(this,{idToken:e}),r=await Mo._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Ks(this.app)){const o=this.app.settings.authIdToken;return o?new Promise(l=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(o).then(l,l))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let s=r,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const o=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,l=s==null?void 0:s._redirectEventId,c=await this.tryRedirectSignIn(e);(!o||o===l)&&(c!=null&&c.user)&&(s=c.user,i=!0)}if(!s)return this.directlySetCurrentUser(null);if(!s._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(s)}catch(o){s=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(o))}return s?this.reloadAndSetCurrentUserOrClear(s):this.directlySetCurrentUser(null)}return $t(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===s._redirectEventId?this.directlySetCurrentUser(s):this.reloadAndSetCurrentUserOrClear(s)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await fw(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=Dce()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ks(this.app))return Promise.reject(Ja(this));const n=e?Jn(e):null;return n&&$t(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&$t(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ks(this.app)?Promise.reject(Ja(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ks(this.app)?Promise.reject(Ja(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Wa(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await Zce(this),n=new tue(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new jg("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await Yce(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&Wa(e)||this._popupRedirectResolver;$t(n,this,"argument-error"),this.redirectPersistenceManager=await Dh.create(this,[Wa(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,s){if(this._deleted)return()=>{};const i=typeof n=="function"?n:n.next.bind(n);let o=!1;const l=this._isInitialized?Promise.resolve():this._initializationPromise;if($t(l,this,"internal-error"),l.then(()=>{o||i(this.currentUser)}),typeof n=="function"){const c=e.addObserver(n,r,s);return()=>{o=!0,c()}}else{const c=e.addObserver(n);return()=>{o=!0,c()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return $t(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=H5(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const s=await this._getAppCheckToken();return s&&(n["X-Firebase-AppCheck"]=s),n}async _getAppCheckToken(){var e;if(Ks(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&Ace(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Gc(t){return Jn(t)}class lD{constructor(e){this.auth=e,this.observer=null,this.addObserver=gle(n=>this.observer=n)}get next(){return $t(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Z0={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function rue(t){Z0=t}function q5(t){return Z0.loadJS(t)}function sue(){return Z0.recaptchaEnterpriseScript}function iue(){return Z0.gapiScript}function oue(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class aue{constructor(){this.enterprise=new lue}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class lue{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const cue="recaptcha-enterprise",K5="NO_RECAPTCHA";class uue{constructor(e){this.type=cue,this.auth=Gc(e)}async verify(e="verify",n=!1){async function r(i){if(!n){if(i.tenantId==null&&i._agentRecaptchaConfig!=null)return i._agentRecaptchaConfig.siteKey;if(i.tenantId!=null&&i._tenantRecaptchaConfigs[i.tenantId]!==void 0)return i._tenantRecaptchaConfigs[i.tenantId].siteKey}return new Promise(async(o,l)=>{Uce(i,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(c=>{if(c.recaptchaKey===void 0)l(new Error("recaptcha Enterprise site key undefined"));else{const u=new Vce(c);return i.tenantId==null?i._agentRecaptchaConfig=u:i._tenantRecaptchaConfigs[i.tenantId]=u,o(u.siteKey)}}).catch(c=>{l(c)})})}function s(i,o,l){const c=window.grecaptcha;rD(c)?c.enterprise.ready(()=>{c.enterprise.execute(i,{action:e}).then(u=>{o(u)}).catch(()=>{o(K5)})}):l(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new aue().execute("siteKey",{action:"verify"}):new Promise((i,o)=>{r(this.auth).then(l=>{if(!n&&rD(window.grecaptcha))s(l,i,o);else{if(typeof window>"u"){o(new Error("RecaptchaVerifier is only supported in browser"));return}let c=sue();c.length!==0&&(c+=l),q5(c).then(()=>{s(l,i,o)}).catch(u=>{o(u)})}}).catch(l=>{o(l)})})}}async function lm(t,e,n,r=!1,s=!1){const i=new uue(t);let o;if(s)o=K5;else try{o=await i.verify(n)}catch{o=await i.verify(n,!0)}const l=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in l){const c=l.phoneEnrollmentInfo.phoneNumber,u=l.phoneEnrollmentInfo.recaptchaToken;Object.assign(l,{phoneEnrollmentInfo:{phoneNumber:c,recaptchaToken:u,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in l){const c=l.phoneSignInInfo.recaptchaToken;Object.assign(l,{phoneSignInInfo:{recaptchaToken:c,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return l}return r?Object.assign(l,{captchaResp:o}):Object.assign(l,{captchaResponse:o}),Object.assign(l,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(l,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),l}async function HE(t,e,n,r,s){var i,o;if(s==="EMAIL_PASSWORD_PROVIDER")if(!((i=t._getRecaptchaConfig())===null||i===void 0)&&i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const l=await lm(t,e,n,n==="getOobCode");return r(t,l)}else return r(t,e).catch(async l=>{if(l.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const c=await lm(t,e,n,n==="getOobCode");return r(t,c)}else return Promise.reject(l)});else if(s==="PHONE_PROVIDER")if(!((o=t._getRecaptchaConfig())===null||o===void 0)&&o.isProviderEnabled("PHONE_PROVIDER")){const l=await lm(t,e,n);return r(t,l).catch(async c=>{var u;if(((u=t._getRecaptchaConfig())===null||u===void 0?void 0:u.getProviderEnforcementState("PHONE_PROVIDER"))==="AUDIT"&&(c.code==="auth/missing-recaptcha-token"||c.code==="auth/invalid-app-credential")){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const d=await lm(t,e,n,!1,!0);return r(t,d)}return Promise.reject(c)})}else{const l=await lm(t,e,n,!1,!0);return r(t,l)}else return Promise.reject(s+" provider is not supported.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function due(t,e){const n=Mg(t,"auth");if(n.isInitialized()){const s=n.getImmediate(),i=n.getOptions();if(Xu(i,e??{}))return s;vo(s,"already-initialized")}return n.initialize({options:e})}function hue(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(Wa);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function fue(t,e,n){const r=Gc(t);$t(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const s=!!(n!=null&&n.disableWarnings),i=Y5(e),{host:o,port:l}=mue(e),c=l===null?"":`:${l}`,u={url:`${i}//${o}${c}/`},d=Object.freeze({host:o,port:l,protocol:i.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator){$t(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),$t(Xu(u,r.config.emulator)&&Xu(d,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=u,r.emulatorConfig=d,r.settings.appVerificationDisabledForTesting=!0,Uc(o)?(J0(`${i}//${o}${c}`),X0("Auth",!0)):s||pue()}function Y5(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function mue(t){const e=Y5(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",s=/^(\[[^\]]+\])(:|$)/.exec(r);if(s){const i=s[1];return{host:i,port:cD(r.substr(i.length+1))}}else{const[i,o]=r.split(":");return{host:i,port:cD(o)}}}function cD(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function pue(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return Ga("not implemented")}_getIdTokenResponse(e){return Ga("not implemented")}_linkToIdToken(e,n){return Ga("not implemented")}_getReauthenticationResolver(e){return Ga("not implemented")}}async function gue(t,e){return zc(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yue(t,e){return Fg(t,"POST","/v1/accounts:signInWithPassword",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function xue(t,e){return Fg(t,"POST","/v1/accounts:signInWithEmailLink",Bc(t,e))}async function vue(t,e){return Fg(t,"POST","/v1/accounts:signInWithEmailLink",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kp extends dN{constructor(e,n,r,s=null){super("password",r),this._email=e,this._password=n,this._tenantId=s}static _fromEmailAndPassword(e,n){return new Kp(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new Kp(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return HE(e,n,"signInWithPassword",yue,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return xue(e,{email:this._email,oobCode:this._password});default:vo(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return HE(e,r,"signUpPassword",gue,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return vue(e,{idToken:n,email:this._email,oobCode:this._password});default:vo(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Mh(t,e){return Fg(t,"POST","/v1/accounts:signInWithIdp",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wue="http://localhost";class Qu extends dN{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new Qu(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):vo("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:s}=n,i=Rf(n,["providerId","signInMethod"]);if(!r||!s)return null;const o=new Qu(r,s);return o.idToken=i.idToken||void 0,o.accessToken=i.accessToken||void 0,o.secret=i.secret,o.nonce=i.nonce,o.pendingToken=i.pendingToken||null,o}_getIdTokenResponse(e){const n=this.buildRequest();return Mh(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Mh(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Mh(e,n)}buildRequest(){const e={requestUri:wue,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=Dg(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bue(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _ue(t){const e=Im(Nm(t)).link,n=e?Im(Nm(e)).deep_link_id:null,r=Im(Nm(t)).deep_link_id;return(r?Im(Nm(r)).link:null)||r||n||e||t}class hN{constructor(e){var n,r,s,i,o,l;const c=Im(Nm(e)),u=(n=c.apiKey)!==null&&n!==void 0?n:null,d=(r=c.oobCode)!==null&&r!==void 0?r:null,h=bue((s=c.mode)!==null&&s!==void 0?s:null);$t(u&&d&&h,"argument-error"),this.apiKey=u,this.operation=h,this.code=d,this.continueUrl=(i=c.continueUrl)!==null&&i!==void 0?i:null,this.languageCode=(o=c.lang)!==null&&o!==void 0?o:null,this.tenantId=(l=c.tenantId)!==null&&l!==void 0?l:null}static parseLink(e){const n=_ue(e);try{return new hN(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jf{constructor(){this.providerId=jf.PROVIDER_ID}static credential(e,n){return Kp._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=hN.parseLink(n);return $t(r,"argument-error"),Kp._fromEmailAndCode(e,r.code,r.tenantId)}}jf.PROVIDER_ID="password";jf.EMAIL_PASSWORD_SIGN_IN_METHOD="password";jf.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Og extends fN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl extends Og{constructor(){super("facebook.com")}static credential(e){return Qu._fromParams({providerId:Gl.PROVIDER_ID,signInMethod:Gl.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Gl.credentialFromTaggedObject(e)}static credentialFromError(e){return Gl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Gl.credential(e.oauthAccessToken)}catch{return null}}}Gl.FACEBOOK_SIGN_IN_METHOD="facebook.com";Gl.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Va extends Og{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return Qu._fromParams({providerId:Va.PROVIDER_ID,signInMethod:Va.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Va.credentialFromTaggedObject(e)}static credentialFromError(e){return Va.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Va.credential(n,r)}catch{return null}}}Va.GOOGLE_SIGN_IN_METHOD="google.com";Va.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wl extends Og{constructor(){super("github.com")}static credential(e){return Qu._fromParams({providerId:Wl.PROVIDER_ID,signInMethod:Wl.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Wl.credentialFromTaggedObject(e)}static credentialFromError(e){return Wl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Wl.credential(e.oauthAccessToken)}catch{return null}}}Wl.GITHUB_SIGN_IN_METHOD="github.com";Wl.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl extends Og{constructor(){super("twitter.com")}static credential(e,n){return Qu._fromParams({providerId:Hl.PROVIDER_ID,signInMethod:Hl.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Hl.credentialFromTaggedObject(e)}static credentialFromError(e){return Hl.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Hl.credential(n,r)}catch{return null}}}Hl.TWITTER_SIGN_IN_METHOD="twitter.com";Hl.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Sue(t,e){return Fg(t,"POST","/v1/accounts:signUp",Bc(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zu{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,s=!1){const i=await Mo._fromIdTokenResponse(e,r,s),o=uD(r);return new Zu({user:i,providerId:o,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const s=uD(r);return new Zu({user:e,providerId:s,_tokenResponse:r,operationType:n})}}function uD(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mw extends Xo{constructor(e,n,r,s){var i;super(n.code,n.message),this.operationType=r,this.user=s,Object.setPrototypeOf(this,mw.prototype),this.customData={appName:e.name,tenantId:(i=e.tenantId)!==null&&i!==void 0?i:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,s){return new mw(e,n,r,s)}}function J5(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(i=>{throw i.code==="auth/multi-factor-auth-required"?mw._fromErrorAndOperation(t,i,e,r):i})}async function Cue(t,e,n=!1){const r=await qp(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return Zu._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eue(t,e,n=!1){const{auth:r}=t;if(Ks(r.app))return Promise.reject(Ja(r));const s="reauthenticate";try{const i=await qp(t,J5(r,s,e,t),n);$t(i.idToken,r,"internal-error");const o=cN(i.idToken);$t(o,r,"internal-error");const{sub:l}=o;return $t(t.uid===l,r,"user-mismatch"),Zu._forOperation(t,s,i)}catch(i){throw(i==null?void 0:i.code)==="auth/user-not-found"&&vo(r,"user-mismatch"),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function X5(t,e,n=!1){if(Ks(t.app))return Promise.reject(Ja(t));const r="signIn",s=await J5(t,r,e),i=await Zu._fromIdTokenResponse(t,r,s);return n||await t._updateCurrentUser(i.user),i}async function Tue(t,e){return X5(Gc(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Q5(t){const e=Gc(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function Iue(t,e,n){if(Ks(t.app))return Promise.reject(Ja(t));const r=Gc(t),o=await HE(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Sue,"EMAIL_PASSWORD_PROVIDER").catch(c=>{throw c.code==="auth/password-does-not-meet-requirements"&&Q5(t),c}),l=await Zu._fromIdTokenResponse(r,"signIn",o);return await r._updateCurrentUser(l.user),l}function Nue(t,e,n){return Ks(t.app)?Promise.reject(Ja(t)):Tue(Jn(t),jf.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&Q5(t),r})}function Pue(t,e,n,r){return Jn(t).onIdTokenChanged(e,n,r)}function Aue(t,e,n){return Jn(t).beforeAuthStateChanged(e,n)}function kue(t,e,n,r){return Jn(t).onAuthStateChanged(e,n,r)}function Rue(t){return Jn(t).signOut()}const pw="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z5{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(pw,"1"),this.storage.removeItem(pw),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jue=1e3,Due=10;class e6 extends Z5{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=W5(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),s=this.localCache[n];r!==s&&e(n,s,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((o,l,c)=>{this.notifyListeners(o,c)});return}const r=e.key;n?this.detachListener():this.stopPolling();const s=()=>{const o=this.storage.getItem(r);!n&&this.localCache[r]===o||this.notifyListeners(r,o)},i=this.storage.getItem(r);Xce()&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(s,Due):s()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},jue)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}e6.type="LOCAL";const Mue=e6;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class t6 extends Z5{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}t6.type="SESSION";const n6=t6;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lue(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eb{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(s=>s.isListeningto(e));if(n)return n;const r=new eb(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:s,data:i}=n.data,o=this.handlersMap[s];if(!(o!=null&&o.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:s});const l=Array.from(o).map(async u=>u(n.origin,i)),c=await Lue(l);n.ports[0].postMessage({status:"done",eventId:r,eventType:s,response:c})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}eb.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mN(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fue{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const s=typeof MessageChannel<"u"?new MessageChannel:null;if(!s)throw new Error("connection_unavailable");let i,o;return new Promise((l,c)=>{const u=mN("",20);s.port1.start();const d=setTimeout(()=>{c(new Error("unsupported_event"))},r);o={messageChannel:s,onMessage(h){const f=h;if(f.data.eventId===u)switch(f.data.status){case"ack":clearTimeout(d),i=setTimeout(()=>{c(new Error("timeout"))},3e3);break;case"done":clearTimeout(i),l(f.data.response);break;default:clearTimeout(d),clearTimeout(i),c(new Error("invalid_response"));break}}},this.handlers.add(o),s.port1.addEventListener("message",o.onMessage),this.target.postMessage({eventType:e,eventId:u,data:n},[s.port2])}).finally(()=>{o&&this.removeMessageHandler(o)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function va(){return window}function Oue(t){va().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r6(){return typeof va().WorkerGlobalScope<"u"&&typeof va().importScripts=="function"}async function $ue(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Vue(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function Uue(){return r6()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s6="firebaseLocalStorageDb",Bue=1,gw="firebaseLocalStorage",i6="fbase_key";class $g{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function tb(t,e){return t.transaction([gw],e?"readwrite":"readonly").objectStore(gw)}function zue(){const t=indexedDB.deleteDatabase(s6);return new $g(t).toPromise()}function qE(){const t=indexedDB.open(s6,Bue);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(gw,{keyPath:i6})}catch(s){n(s)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(gw)?e(r):(r.close(),await zue(),e(await qE()))})})}async function dD(t,e,n){const r=tb(t,!0).put({[i6]:e,value:n});return new $g(r).toPromise()}async function Gue(t,e){const n=tb(t,!1).get(e),r=await new $g(n).toPromise();return r===void 0?null:r.value}function hD(t,e){const n=tb(t,!0).delete(e);return new $g(n).toPromise()}const Wue=800,Hue=3;class o6{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await qE(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>Hue)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return r6()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=eb._getInstance(Uue()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await $ue(),!this.activeServiceWorker)return;this.sender=new Fue(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Vue()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await qE();return await dD(e,pw,"1"),await hD(e,pw),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>dD(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Gue(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>hD(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(s=>{const i=tb(s,!1).getAll();return new $g(i).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:s,value:i}of e)r.add(s),JSON.stringify(this.localCache[s])!==JSON.stringify(i)&&(this.notifyListeners(s,i),n.push(s));for(const s of Object.keys(this.localCache))this.localCache[s]&&!r.has(s)&&(this.notifyListeners(s,null),n.push(s));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const s of Array.from(r))s(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Wue)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}o6.type="LOCAL";const que=o6;new Lg(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function a6(t,e){return e?Wa(e):($t(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pN extends dN{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Mh(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Mh(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Mh(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Kue(t){return X5(t.auth,new pN(t),t.bypassAuthState)}function Yue(t){const{auth:e,user:n}=t;return $t(n,e,"internal-error"),Eue(n,new pN(t),t.bypassAuthState)}async function Jue(t){const{auth:e,user:n}=t;return $t(n,e,"internal-error"),Cue(n,new pN(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class l6{constructor(e,n,r,s,i=!1){this.auth=e,this.resolver=r,this.user=s,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:s,tenantId:i,error:o,type:l}=e;if(o){this.reject(o);return}const c={auth:this.auth,requestUri:n,sessionId:r,tenantId:i||void 0,postBody:s||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(l)(c))}catch(u){this.reject(u)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Kue;case"linkViaPopup":case"linkViaRedirect":return Jue;case"reauthViaPopup":case"reauthViaRedirect":return Yue;default:vo(this.auth,"internal-error")}}resolve(e){ul(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){ul(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xue=new Lg(2e3,1e4);async function Que(t,e,n){if(Ks(t.app))return Promise.reject(Bo(t,"operation-not-supported-in-this-environment"));const r=Gc(t);kce(t,e,fN);const s=a6(r,n);return new ku(r,"signInViaPopup",e,s).executeNotNull()}class ku extends l6{constructor(e,n,r,s,i){super(e,n,s,i),this.provider=r,this.authWindow=null,this.pollId=null,ku.currentPopupAction&&ku.currentPopupAction.cancel(),ku.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return $t(e,this.auth,"internal-error"),e}async onExecution(){ul(this.filter.length===1,"Popup operations only handle one event");const e=mN();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Bo(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Bo(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,ku.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Bo(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Xue.get())};e()}}ku.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zue="pendingRedirect",Yx=new Map;class ede extends l6{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=Yx.get(this.auth._key());if(!e){try{const r=await tde(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}Yx.set(this.auth._key(),e)}return this.bypassAuthState||Yx.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function tde(t,e){const n=sde(e),r=rde(t);if(!await r._isAvailable())return!1;const s=await r._get(n)==="true";return await r._remove(n),s}function nde(t,e){Yx.set(t._key(),e)}function rde(t){return Wa(t._redirectPersistence)}function sde(t){return Kx(Zue,t.config.apiKey,t.name)}async function ide(t,e,n=!1){if(Ks(t.app))return Promise.reject(Ja(t));const r=Gc(t),s=a6(r,e),o=await new ede(r,s,n).execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,e)),o}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ode=10*60*1e3;class ade{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!lde(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!c6(e)){const s=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Bo(this.auth,s))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=ode&&this.cachedEventUids.clear(),this.cachedEventUids.has(fD(e))}saveEventToCache(e){this.cachedEventUids.add(fD(e)),this.lastProcessedEventTime=Date.now()}}function fD(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function c6({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function lde(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return c6(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cde(t,e={}){return zc(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ude=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,dde=/^https?/;async function hde(t){if(t.config.emulator)return;const{authorizedDomains:e}=await cde(t);for(const n of e)try{if(fde(n))return}catch{}vo(t,"unauthorized-domain")}function fde(t){const e=GE(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const o=new URL(t);return o.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&o.hostname===r}if(!dde.test(n))return!1;if(ude.test(t))return r===t;const s=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+s+"|"+s+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mde=new Lg(3e4,6e4);function mD(){const t=va().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function pde(t){return new Promise((e,n)=>{var r,s,i;function o(){mD(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{mD(),n(Bo(t,"network-request-failed"))},timeout:mde.get()})}if(!((s=(r=va().gapi)===null||r===void 0?void 0:r.iframes)===null||s===void 0)&&s.Iframe)e(gapi.iframes.getContext());else if(!((i=va().gapi)===null||i===void 0)&&i.load)o();else{const l=oue("iframefcb");return va()[l]=()=>{gapi.load?o():n(Bo(t,"network-request-failed"))},q5(`${iue()}?onload=${l}`).catch(c=>n(c))}}).catch(e=>{throw Jx=null,e})}let Jx=null;function gde(t){return Jx=Jx||pde(t),Jx}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yde=new Lg(5e3,15e3),xde="__/auth/iframe",vde="emulator/auth/iframe",wde={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bde=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _de(t){const e=t.config;$t(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?lN(e,vde):`https://${t.config.authDomain}/${xde}`,r={apiKey:e.apiKey,appName:t.name,v:md},s=bde.get(t.config.apiHost);s&&(r.eid=s);const i=t._getFrameworks();return i.length&&(r.fw=i.join(",")),`${n}?${Dg(r).slice(1)}`}async function Sde(t){const e=await gde(t),n=va().gapi;return $t(n,t,"internal-error"),e.open({where:document.body,url:_de(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wde,dontclear:!0},r=>new Promise(async(s,i)=>{await r.restyle({setHideOnLeave:!1});const o=Bo(t,"network-request-failed"),l=va().setTimeout(()=>{i(o)},yde.get());function c(){va().clearTimeout(l),s(r)}r.ping(c).then(c,()=>{i(o)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cde={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},Ede=500,Tde=600,Ide="_blank",Nde="http://localhost";class pD{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Pde(t,e,n,r=Ede,s=Tde){const i=Math.max((window.screen.availHeight-s)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let l="";const c=Object.assign(Object.assign({},Cde),{width:r.toString(),height:s.toString(),top:i,left:o}),u=Xr().toLowerCase();n&&(l=V5(u)?Ide:n),O5(u)&&(e=e||Nde,c.scrollbars="yes");const d=Object.entries(c).reduce((f,[m,g])=>`${f}${m}=${g},`,"");if(Jce(u)&&l!=="_self")return Ade(e||"",l),new pD(null);const h=window.open(e||"",l,d);$t(h,t,"popup-blocked");try{h.focus()}catch{}return new pD(h)}function Ade(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kde="__/auth/handler",Rde="emulator/auth/handler",jde=encodeURIComponent("fac");async function gD(t,e,n,r,s,i){$t(t.config.authDomain,t,"auth-domain-config-required"),$t(t.config.apiKey,t,"invalid-api-key");const o={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:md,eventId:s};if(e instanceof fN){e.setDefaultLanguage(t.languageCode),o.providerId=e.providerId||"",ple(e.getCustomParameters())||(o.customParameters=JSON.stringify(e.getCustomParameters()));for(const[d,h]of Object.entries(i||{}))o[d]=h}if(e instanceof Og){const d=e.getScopes().filter(h=>h!=="");d.length>0&&(o.scopes=d.join(","))}t.tenantId&&(o.tid=t.tenantId);const l=o;for(const d of Object.keys(l))l[d]===void 0&&delete l[d];const c=await t._getAppCheckToken(),u=c?`#${jde}=${encodeURIComponent(c)}`:"";return`${Dde(t)}?${Dg(l).slice(1)}${u}`}function Dde({config:t}){return t.emulator?lN(t,Rde):`https://${t.authDomain}/${kde}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gS="webStorageSupport";class Mde{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=n6,this._completeRedirectFn=ide,this._overrideRedirectResult=nde}async _openPopup(e,n,r,s){var i;ul((i=this.eventManagers[e._key()])===null||i===void 0?void 0:i.manager,"_initialize() not called before _openPopup()");const o=await gD(e,n,r,GE(),s);return Pde(e,o,mN())}async _openRedirect(e,n,r,s){await this._originValidation(e);const i=await gD(e,n,r,GE(),s);return Oue(i),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:s,promise:i}=this.eventManagers[n];return s?Promise.resolve(s):(ul(i,"If manager is not set, promise should be"),i)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await Sde(e),r=new ade(e);return n.register("authEvent",s=>($t(s==null?void 0:s.authEvent,e,"invalid-auth-event"),{status:r.onEvent(s.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(gS,{type:gS},s=>{var i;const o=(i=s==null?void 0:s[0])===null||i===void 0?void 0:i[gS];o!==void 0&&n(!!o),vo(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=hde(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return W5()||$5()||uN()}}const Lde=Mde;var yD="@firebase/auth",xD="1.10.6";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fde{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){$t(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ode(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function $de(t){Sc(new ll("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),s=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:o,authDomain:l}=r.options;$t(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const c={apiKey:o,authDomain:l,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:H5(t)},u=new nue(r,s,i,c);return hue(u,n),u},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Sc(new ll("auth-internal",e=>{const n=Gc(e.getProvider("auth").getImmediate());return(r=>new Fde(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),mo(yD,xD,Ode(t)),mo(yD,xD,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vde=5*60,Ude=w5("authIdTokenMaxAge")||Vde;let vD=null;const Bde=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Ude)return;const s=n==null?void 0:n.token;vD!==s&&(vD=s,await fetch(t,{method:s?"POST":"DELETE",headers:s?{Authorization:`Bearer ${s}`}:{}}))};function zde(t=Q0()){const e=Mg(t,"auth");if(e.isInitialized())return e.getImmediate();const n=due(t,{popupRedirectResolver:Lde,persistence:[que,Mue,n6]}),r=w5("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const i=new URL(r,location.origin);if(location.origin===i.origin){const o=Bde(i.toString());Aue(n,o,()=>o(n.currentUser)),Pue(n,l=>o(l))}}const s=x5("auth");return s&&fue(n,`http://${s}`),n}function Gde(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}rue({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=s=>{const i=Bo("internal-error");i.customData=s,n(i)},r.type="text/javascript",r.charset="UTF-8",Gde().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});$de("Browser");var wD=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var dc,u6;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(E,I){function P(){}P.prototype=I.prototype,E.D=I.prototype,E.prototype=new P,E.prototype.constructor=E,E.C=function(A,D,j){for(var M=Array(arguments.length-2),z=2;z<arguments.length;z++)M[z-2]=arguments[z];return I.prototype[D].apply(A,M)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function s(E,I,P){P||(P=0);var A=Array(16);if(typeof I=="string")for(var D=0;16>D;++D)A[D]=I.charCodeAt(P++)|I.charCodeAt(P++)<<8|I.charCodeAt(P++)<<16|I.charCodeAt(P++)<<24;else for(D=0;16>D;++D)A[D]=I[P++]|I[P++]<<8|I[P++]<<16|I[P++]<<24;I=E.g[0],P=E.g[1],D=E.g[2];var j=E.g[3],M=I+(j^P&(D^j))+A[0]+3614090360&4294967295;I=P+(M<<7&4294967295|M>>>25),M=j+(D^I&(P^D))+A[1]+3905402710&4294967295,j=I+(M<<12&4294967295|M>>>20),M=D+(P^j&(I^P))+A[2]+606105819&4294967295,D=j+(M<<17&4294967295|M>>>15),M=P+(I^D&(j^I))+A[3]+3250441966&4294967295,P=D+(M<<22&4294967295|M>>>10),M=I+(j^P&(D^j))+A[4]+4118548399&4294967295,I=P+(M<<7&4294967295|M>>>25),M=j+(D^I&(P^D))+A[5]+1200080426&4294967295,j=I+(M<<12&4294967295|M>>>20),M=D+(P^j&(I^P))+A[6]+2821735955&4294967295,D=j+(M<<17&4294967295|M>>>15),M=P+(I^D&(j^I))+A[7]+4249261313&4294967295,P=D+(M<<22&4294967295|M>>>10),M=I+(j^P&(D^j))+A[8]+1770035416&4294967295,I=P+(M<<7&4294967295|M>>>25),M=j+(D^I&(P^D))+A[9]+2336552879&4294967295,j=I+(M<<12&4294967295|M>>>20),M=D+(P^j&(I^P))+A[10]+4294925233&4294967295,D=j+(M<<17&4294967295|M>>>15),M=P+(I^D&(j^I))+A[11]+2304563134&4294967295,P=D+(M<<22&4294967295|M>>>10),M=I+(j^P&(D^j))+A[12]+1804603682&4294967295,I=P+(M<<7&4294967295|M>>>25),M=j+(D^I&(P^D))+A[13]+4254626195&4294967295,j=I+(M<<12&4294967295|M>>>20),M=D+(P^j&(I^P))+A[14]+2792965006&4294967295,D=j+(M<<17&4294967295|M>>>15),M=P+(I^D&(j^I))+A[15]+1236535329&4294967295,P=D+(M<<22&4294967295|M>>>10),M=I+(D^j&(P^D))+A[1]+4129170786&4294967295,I=P+(M<<5&4294967295|M>>>27),M=j+(P^D&(I^P))+A[6]+3225465664&4294967295,j=I+(M<<9&4294967295|M>>>23),M=D+(I^P&(j^I))+A[11]+643717713&4294967295,D=j+(M<<14&4294967295|M>>>18),M=P+(j^I&(D^j))+A[0]+3921069994&4294967295,P=D+(M<<20&4294967295|M>>>12),M=I+(D^j&(P^D))+A[5]+3593408605&4294967295,I=P+(M<<5&4294967295|M>>>27),M=j+(P^D&(I^P))+A[10]+38016083&4294967295,j=I+(M<<9&4294967295|M>>>23),M=D+(I^P&(j^I))+A[15]+3634488961&4294967295,D=j+(M<<14&4294967295|M>>>18),M=P+(j^I&(D^j))+A[4]+3889429448&4294967295,P=D+(M<<20&4294967295|M>>>12),M=I+(D^j&(P^D))+A[9]+568446438&4294967295,I=P+(M<<5&4294967295|M>>>27),M=j+(P^D&(I^P))+A[14]+3275163606&4294967295,j=I+(M<<9&4294967295|M>>>23),M=D+(I^P&(j^I))+A[3]+4107603335&4294967295,D=j+(M<<14&4294967295|M>>>18),M=P+(j^I&(D^j))+A[8]+1163531501&4294967295,P=D+(M<<20&4294967295|M>>>12),M=I+(D^j&(P^D))+A[13]+2850285829&4294967295,I=P+(M<<5&4294967295|M>>>27),M=j+(P^D&(I^P))+A[2]+4243563512&4294967295,j=I+(M<<9&4294967295|M>>>23),M=D+(I^P&(j^I))+A[7]+1735328473&4294967295,D=j+(M<<14&4294967295|M>>>18),M=P+(j^I&(D^j))+A[12]+2368359562&4294967295,P=D+(M<<20&4294967295|M>>>12),M=I+(P^D^j)+A[5]+4294588738&4294967295,I=P+(M<<4&4294967295|M>>>28),M=j+(I^P^D)+A[8]+2272392833&4294967295,j=I+(M<<11&4294967295|M>>>21),M=D+(j^I^P)+A[11]+1839030562&4294967295,D=j+(M<<16&4294967295|M>>>16),M=P+(D^j^I)+A[14]+4259657740&4294967295,P=D+(M<<23&4294967295|M>>>9),M=I+(P^D^j)+A[1]+2763975236&4294967295,I=P+(M<<4&4294967295|M>>>28),M=j+(I^P^D)+A[4]+1272893353&4294967295,j=I+(M<<11&4294967295|M>>>21),M=D+(j^I^P)+A[7]+4139469664&4294967295,D=j+(M<<16&4294967295|M>>>16),M=P+(D^j^I)+A[10]+3200236656&4294967295,P=D+(M<<23&4294967295|M>>>9),M=I+(P^D^j)+A[13]+681279174&4294967295,I=P+(M<<4&4294967295|M>>>28),M=j+(I^P^D)+A[0]+3936430074&4294967295,j=I+(M<<11&4294967295|M>>>21),M=D+(j^I^P)+A[3]+3572445317&4294967295,D=j+(M<<16&4294967295|M>>>16),M=P+(D^j^I)+A[6]+76029189&4294967295,P=D+(M<<23&4294967295|M>>>9),M=I+(P^D^j)+A[9]+3654602809&4294967295,I=P+(M<<4&4294967295|M>>>28),M=j+(I^P^D)+A[12]+3873151461&4294967295,j=I+(M<<11&4294967295|M>>>21),M=D+(j^I^P)+A[15]+530742520&4294967295,D=j+(M<<16&4294967295|M>>>16),M=P+(D^j^I)+A[2]+3299628645&4294967295,P=D+(M<<23&4294967295|M>>>9),M=I+(D^(P|~j))+A[0]+4096336452&4294967295,I=P+(M<<6&4294967295|M>>>26),M=j+(P^(I|~D))+A[7]+1126891415&4294967295,j=I+(M<<10&4294967295|M>>>22),M=D+(I^(j|~P))+A[14]+2878612391&4294967295,D=j+(M<<15&4294967295|M>>>17),M=P+(j^(D|~I))+A[5]+4237533241&4294967295,P=D+(M<<21&4294967295|M>>>11),M=I+(D^(P|~j))+A[12]+1700485571&4294967295,I=P+(M<<6&4294967295|M>>>26),M=j+(P^(I|~D))+A[3]+2399980690&4294967295,j=I+(M<<10&4294967295|M>>>22),M=D+(I^(j|~P))+A[10]+4293915773&4294967295,D=j+(M<<15&4294967295|M>>>17),M=P+(j^(D|~I))+A[1]+2240044497&4294967295,P=D+(M<<21&4294967295|M>>>11),M=I+(D^(P|~j))+A[8]+1873313359&4294967295,I=P+(M<<6&4294967295|M>>>26),M=j+(P^(I|~D))+A[15]+4264355552&4294967295,j=I+(M<<10&4294967295|M>>>22),M=D+(I^(j|~P))+A[6]+2734768916&4294967295,D=j+(M<<15&4294967295|M>>>17),M=P+(j^(D|~I))+A[13]+1309151649&4294967295,P=D+(M<<21&4294967295|M>>>11),M=I+(D^(P|~j))+A[4]+4149444226&4294967295,I=P+(M<<6&4294967295|M>>>26),M=j+(P^(I|~D))+A[11]+3174756917&4294967295,j=I+(M<<10&4294967295|M>>>22),M=D+(I^(j|~P))+A[2]+718787259&4294967295,D=j+(M<<15&4294967295|M>>>17),M=P+(j^(D|~I))+A[9]+3951481745&4294967295,E.g[0]=E.g[0]+I&4294967295,E.g[1]=E.g[1]+(D+(M<<21&4294967295|M>>>11))&4294967295,E.g[2]=E.g[2]+D&4294967295,E.g[3]=E.g[3]+j&4294967295}r.prototype.u=function(E,I){I===void 0&&(I=E.length);for(var P=I-this.blockSize,A=this.B,D=this.h,j=0;j<I;){if(D==0)for(;j<=P;)s(this,E,j),j+=this.blockSize;if(typeof E=="string"){for(;j<I;)if(A[D++]=E.charCodeAt(j++),D==this.blockSize){s(this,A),D=0;break}}else for(;j<I;)if(A[D++]=E[j++],D==this.blockSize){s(this,A),D=0;break}}this.h=D,this.o+=I},r.prototype.v=function(){var E=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);E[0]=128;for(var I=1;I<E.length-8;++I)E[I]=0;var P=8*this.o;for(I=E.length-8;I<E.length;++I)E[I]=P&255,P/=256;for(this.u(E),E=Array(16),I=P=0;4>I;++I)for(var A=0;32>A;A+=8)E[P++]=this.g[I]>>>A&255;return E};function i(E,I){var P=l;return Object.prototype.hasOwnProperty.call(P,E)?P[E]:P[E]=I(E)}function o(E,I){this.h=I;for(var P=[],A=!0,D=E.length-1;0<=D;D--){var j=E[D]|0;A&&j==I||(P[D]=j,A=!1)}this.g=P}var l={};function c(E){return-128<=E&&128>E?i(E,function(I){return new o([I|0],0>I?-1:0)}):new o([E|0],0>E?-1:0)}function u(E){if(isNaN(E)||!isFinite(E))return h;if(0>E)return w(u(-E));for(var I=[],P=1,A=0;E>=P;A++)I[A]=E/P|0,P*=4294967296;return new o(I,0)}function d(E,I){if(E.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(E.charAt(0)=="-")return w(d(E.substring(1),I));if(0<=E.indexOf("-"))throw Error('number format error: interior "-" character');for(var P=u(Math.pow(I,8)),A=h,D=0;D<E.length;D+=8){var j=Math.min(8,E.length-D),M=parseInt(E.substring(D,D+j),I);8>j?(j=u(Math.pow(I,j)),A=A.j(j).add(u(M))):(A=A.j(P),A=A.add(u(M)))}return A}var h=c(0),f=c(1),m=c(16777216);t=o.prototype,t.m=function(){if(x(this))return-w(this).m();for(var E=0,I=1,P=0;P<this.g.length;P++){var A=this.i(P);E+=(0<=A?A:4294967296+A)*I,I*=4294967296}return E},t.toString=function(E){if(E=E||10,2>E||36<E)throw Error("radix out of range: "+E);if(g(this))return"0";if(x(this))return"-"+w(this).toString(E);for(var I=u(Math.pow(E,6)),P=this,A="";;){var D=T(P,I).g;P=v(P,D.j(I));var j=((0<P.g.length?P.g[0]:P.h)>>>0).toString(E);if(P=D,g(P))return j+A;for(;6>j.length;)j="0"+j;A=j+A}},t.i=function(E){return 0>E?0:E<this.g.length?this.g[E]:this.h};function g(E){if(E.h!=0)return!1;for(var I=0;I<E.g.length;I++)if(E.g[I]!=0)return!1;return!0}function x(E){return E.h==-1}t.l=function(E){return E=v(this,E),x(E)?-1:g(E)?0:1};function w(E){for(var I=E.g.length,P=[],A=0;A<I;A++)P[A]=~E.g[A];return new o(P,~E.h).add(f)}t.abs=function(){return x(this)?w(this):this},t.add=function(E){for(var I=Math.max(this.g.length,E.g.length),P=[],A=0,D=0;D<=I;D++){var j=A+(this.i(D)&65535)+(E.i(D)&65535),M=(j>>>16)+(this.i(D)>>>16)+(E.i(D)>>>16);A=M>>>16,j&=65535,M&=65535,P[D]=M<<16|j}return new o(P,P[P.length-1]&-2147483648?-1:0)};function v(E,I){return E.add(w(I))}t.j=function(E){if(g(this)||g(E))return h;if(x(this))return x(E)?w(this).j(w(E)):w(w(this).j(E));if(x(E))return w(this.j(w(E)));if(0>this.l(m)&&0>E.l(m))return u(this.m()*E.m());for(var I=this.g.length+E.g.length,P=[],A=0;A<2*I;A++)P[A]=0;for(A=0;A<this.g.length;A++)for(var D=0;D<E.g.length;D++){var j=this.i(A)>>>16,M=this.i(A)&65535,z=E.i(D)>>>16,U=E.i(D)&65535;P[2*A+2*D]+=M*U,_(P,2*A+2*D),P[2*A+2*D+1]+=j*U,_(P,2*A+2*D+1),P[2*A+2*D+1]+=M*z,_(P,2*A+2*D+1),P[2*A+2*D+2]+=j*z,_(P,2*A+2*D+2)}for(A=0;A<I;A++)P[A]=P[2*A+1]<<16|P[2*A];for(A=I;A<2*I;A++)P[A]=0;return new o(P,0)};function _(E,I){for(;(E[I]&65535)!=E[I];)E[I+1]+=E[I]>>>16,E[I]&=65535,I++}function C(E,I){this.g=E,this.h=I}function T(E,I){if(g(I))throw Error("division by zero");if(g(E))return new C(h,h);if(x(E))return I=T(w(E),I),new C(w(I.g),w(I.h));if(x(I))return I=T(E,w(I)),new C(w(I.g),I.h);if(30<E.g.length){if(x(E)||x(I))throw Error("slowDivide_ only works with positive integers.");for(var P=f,A=I;0>=A.l(E);)P=R(P),A=R(A);var D=k(P,1),j=k(A,1);for(A=k(A,2),P=k(P,2);!g(A);){var M=j.add(A);0>=M.l(E)&&(D=D.add(P),j=M),A=k(A,1),P=k(P,1)}return I=v(E,D.j(I)),new C(D,I)}for(D=h;0<=E.l(I);){for(P=Math.max(1,Math.floor(E.m()/I.m())),A=Math.ceil(Math.log(P)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),j=u(P),M=j.j(I);x(M)||0<M.l(E);)P-=A,j=u(P),M=j.j(I);g(j)&&(j=f),D=D.add(j),E=v(E,M)}return new C(D,E)}t.A=function(E){return T(this,E).h},t.and=function(E){for(var I=Math.max(this.g.length,E.g.length),P=[],A=0;A<I;A++)P[A]=this.i(A)&E.i(A);return new o(P,this.h&E.h)},t.or=function(E){for(var I=Math.max(this.g.length,E.g.length),P=[],A=0;A<I;A++)P[A]=this.i(A)|E.i(A);return new o(P,this.h|E.h)},t.xor=function(E){for(var I=Math.max(this.g.length,E.g.length),P=[],A=0;A<I;A++)P[A]=this.i(A)^E.i(A);return new o(P,this.h^E.h)};function R(E){for(var I=E.g.length+1,P=[],A=0;A<I;A++)P[A]=E.i(A)<<1|E.i(A-1)>>>31;return new o(P,E.h)}function k(E,I){var P=I>>5;I%=32;for(var A=E.g.length-P,D=[],j=0;j<A;j++)D[j]=0<I?E.i(j+P)>>>I|E.i(j+P+1)<<32-I:E.i(j+P);return new o(D,E.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,u6=r,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=u,o.fromString=d,dc=o}).apply(typeof wD<"u"?wD:typeof self<"u"?self:typeof window<"u"?window:{});var Qy=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var d6,Pm,h6,Xx,KE,f6,m6,p6;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,N,F){return y==Array.prototype||y==Object.prototype||(y[N]=F.value),y};function n(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Qy=="object"&&Qy];for(var N=0;N<y.length;++N){var F=y[N];if(F&&F.Math==Math)return F}throw Error("Cannot find global object")}var r=n(this);function s(y,N){if(N)e:{var F=r;y=y.split(".");for(var G=0;G<y.length-1;G++){var ge=y[G];if(!(ge in F))break e;F=F[ge]}y=y[y.length-1],G=F[y],N=N(G),N!=G&&N!=null&&e(F,y,{configurable:!0,writable:!0,value:N})}}function i(y,N){y instanceof String&&(y+="");var F=0,G=!1,ge={next:function(){if(!G&&F<y.length){var Ae=F++;return{value:N(Ae,y[Ae]),done:!1}}return G=!0,{done:!0,value:void 0}}};return ge[Symbol.iterator]=function(){return ge},ge}s("Array.prototype.values",function(y){return y||function(){return i(this,function(N,F){return F})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var o=o||{},l=this||self;function c(y){var N=typeof y;return N=N!="object"?N:y?Array.isArray(y)?"array":N:"null",N=="array"||N=="object"&&typeof y.length=="number"}function u(y){var N=typeof y;return N=="object"&&y!=null||N=="function"}function d(y,N,F){return y.call.apply(y.bind,arguments)}function h(y,N,F){if(!y)throw Error();if(2<arguments.length){var G=Array.prototype.slice.call(arguments,2);return function(){var ge=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(ge,G),y.apply(N,ge)}}return function(){return y.apply(N,arguments)}}function f(y,N,F){return f=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?d:h,f.apply(null,arguments)}function m(y,N){var F=Array.prototype.slice.call(arguments,1);return function(){var G=F.slice();return G.push.apply(G,arguments),y.apply(this,G)}}function g(y,N){function F(){}F.prototype=N.prototype,y.aa=N.prototype,y.prototype=new F,y.prototype.constructor=y,y.Qb=function(G,ge,Ae){for(var rt=Array(arguments.length-2),Un=2;Un<arguments.length;Un++)rt[Un-2]=arguments[Un];return N.prototype[ge].apply(G,rt)}}function x(y){const N=y.length;if(0<N){const F=Array(N);for(let G=0;G<N;G++)F[G]=y[G];return F}return[]}function w(y,N){for(let F=1;F<arguments.length;F++){const G=arguments[F];if(c(G)){const ge=y.length||0,Ae=G.length||0;y.length=ge+Ae;for(let rt=0;rt<Ae;rt++)y[ge+rt]=G[rt]}else y.push(G)}}class v{constructor(N,F){this.i=N,this.j=F,this.h=0,this.g=null}get(){let N;return 0<this.h?(this.h--,N=this.g,this.g=N.next,N.next=null):N=this.i(),N}}function _(y){return/^[\s\xa0]*$/.test(y)}function C(){var y=l.navigator;return y&&(y=y.userAgent)?y:""}function T(y){return T[" "](y),y}T[" "]=function(){};var R=C().indexOf("Gecko")!=-1&&!(C().toLowerCase().indexOf("webkit")!=-1&&C().indexOf("Edge")==-1)&&!(C().indexOf("Trident")!=-1||C().indexOf("MSIE")!=-1)&&C().indexOf("Edge")==-1;function k(y,N,F){for(const G in y)N.call(F,y[G],G,y)}function E(y,N){for(const F in y)N.call(void 0,y[F],F,y)}function I(y){const N={};for(const F in y)N[F]=y[F];return N}const P="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(y,N){let F,G;for(let ge=1;ge<arguments.length;ge++){G=arguments[ge];for(F in G)y[F]=G[F];for(let Ae=0;Ae<P.length;Ae++)F=P[Ae],Object.prototype.hasOwnProperty.call(G,F)&&(y[F]=G[F])}}function D(y){var N=1;y=y.split(":");const F=[];for(;0<N&&y.length;)F.push(y.shift()),N--;return y.length&&F.push(y.join(":")),F}function j(y){l.setTimeout(()=>{throw y},0)}function M(){var y=te;let N=null;return y.g&&(N=y.g,y.g=y.g.next,y.g||(y.h=null),N.next=null),N}class z{constructor(){this.h=this.g=null}add(N,F){const G=U.get();G.set(N,F),this.h?this.h.next=G:this.g=G,this.h=G}}var U=new v(()=>new K,y=>y.reset());class K{constructor(){this.next=this.g=this.h=null}set(N,F){this.h=N,this.g=F,this.next=null}reset(){this.next=this.g=this.h=null}}let q,W=!1,te=new z,O=()=>{const y=l.Promise.resolve(void 0);q=()=>{y.then(V)}};var V=()=>{for(var y;y=M();){try{y.h.call(y.g)}catch(F){j(F)}var N=U;N.j(y),100>N.h&&(N.h++,y.next=N.g,N.g=y)}W=!1};function H(){this.s=this.s,this.C=this.C}H.prototype.s=!1,H.prototype.ma=function(){this.s||(this.s=!0,this.N())},H.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function L(y,N){this.type=y,this.g=this.target=N,this.defaultPrevented=!1}L.prototype.h=function(){this.defaultPrevented=!0};var ee=function(){if(!l.addEventListener||!Object.defineProperty)return!1;var y=!1,N=Object.defineProperty({},"passive",{get:function(){y=!0}});try{const F=()=>{};l.addEventListener("test",F,N),l.removeEventListener("test",F,N)}catch{}return y}();function pe(y,N){if(L.call(this,y?y.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,y){var F=this.type=y.type,G=y.changedTouches&&y.changedTouches.length?y.changedTouches[0]:null;if(this.target=y.target||y.srcElement,this.g=N,N=y.relatedTarget){if(R){e:{try{T(N.nodeName);var ge=!0;break e}catch{}ge=!1}ge||(N=null)}}else F=="mouseover"?N=y.fromElement:F=="mouseout"&&(N=y.toElement);this.relatedTarget=N,G?(this.clientX=G.clientX!==void 0?G.clientX:G.pageX,this.clientY=G.clientY!==void 0?G.clientY:G.pageY,this.screenX=G.screenX||0,this.screenY=G.screenY||0):(this.clientX=y.clientX!==void 0?y.clientX:y.pageX,this.clientY=y.clientY!==void 0?y.clientY:y.pageY,this.screenX=y.screenX||0,this.screenY=y.screenY||0),this.button=y.button,this.key=y.key||"",this.ctrlKey=y.ctrlKey,this.altKey=y.altKey,this.shiftKey=y.shiftKey,this.metaKey=y.metaKey,this.pointerId=y.pointerId||0,this.pointerType=typeof y.pointerType=="string"?y.pointerType:xe[y.pointerType]||"",this.state=y.state,this.i=y,y.defaultPrevented&&pe.aa.h.call(this)}}g(pe,L);var xe={2:"touch",3:"pen",4:"mouse"};pe.prototype.h=function(){pe.aa.h.call(this);var y=this.i;y.preventDefault?y.preventDefault():y.returnValue=!1};var we="closure_listenable_"+(1e6*Math.random()|0),Ie=0;function Fe(y,N,F,G,ge){this.listener=y,this.proxy=null,this.src=N,this.type=F,this.capture=!!G,this.ha=ge,this.key=++Ie,this.da=this.fa=!1}function Ve(y){y.da=!0,y.listener=null,y.proxy=null,y.src=null,y.ha=null}function Ge(y){this.src=y,this.g={},this.h=0}Ge.prototype.add=function(y,N,F,G,ge){var Ae=y.toString();y=this.g[Ae],y||(y=this.g[Ae]=[],this.h++);var rt=je(y,N,G,ge);return-1<rt?(N=y[rt],F||(N.fa=!1)):(N=new Fe(N,this.src,Ae,!!G,ge),N.fa=F,y.push(N)),N};function fe(y,N){var F=N.type;if(F in y.g){var G=y.g[F],ge=Array.prototype.indexOf.call(G,N,void 0),Ae;(Ae=0<=ge)&&Array.prototype.splice.call(G,ge,1),Ae&&(Ve(N),y.g[F].length==0&&(delete y.g[F],y.h--))}}function je(y,N,F,G){for(var ge=0;ge<y.length;++ge){var Ae=y[ge];if(!Ae.da&&Ae.listener==N&&Ae.capture==!!F&&Ae.ha==G)return ge}return-1}var ie="closure_lm_"+(1e6*Math.random()|0),$e={};function me(y,N,F,G,ge){if(G&&G.once)return ct(y,N,F,G,ge);if(Array.isArray(N)){for(var Ae=0;Ae<N.length;Ae++)me(y,N[Ae],F,G,ge);return null}return F=re(F),y&&y[we]?y.K(N,F,u(G)?!!G.capture:!!G,ge):Ue(y,N,F,!1,G,ge)}function Ue(y,N,F,G,ge,Ae){if(!N)throw Error("Invalid event type");var rt=u(ge)?!!ge.capture:!!ge,Un=kt(y);if(Un||(y[ie]=Un=new Ge(y)),F=Un.add(N,F,G,rt,Ae),F.proxy)return F;if(G=et(),F.proxy=G,G.src=y,G.listener=F,y.addEventListener)ee||(ge=rt),ge===void 0&&(ge=!1),y.addEventListener(N.toString(),G,ge);else if(y.attachEvent)y.attachEvent(en(N.toString()),G);else if(y.addListener&&y.removeListener)y.addListener(G);else throw Error("addEventListener and attachEvent are unavailable.");return F}function et(){function y(F){return N.call(y.src,y.listener,F)}const N=rn;return y}function ct(y,N,F,G,ge){if(Array.isArray(N)){for(var Ae=0;Ae<N.length;Ae++)ct(y,N[Ae],F,G,ge);return null}return F=re(F),y&&y[we]?y.L(N,F,u(G)?!!G.capture:!!G,ge):Ue(y,N,F,!0,G,ge)}function Mt(y,N,F,G,ge){if(Array.isArray(N))for(var Ae=0;Ae<N.length;Ae++)Mt(y,N[Ae],F,G,ge);else G=u(G)?!!G.capture:!!G,F=re(F),y&&y[we]?(y=y.i,N=String(N).toString(),N in y.g&&(Ae=y.g[N],F=je(Ae,F,G,ge),-1<F&&(Ve(Ae[F]),Array.prototype.splice.call(Ae,F,1),Ae.length==0&&(delete y.g[N],y.h--)))):y&&(y=kt(y))&&(N=y.g[N.toString()],y=-1,N&&(y=je(N,F,G,ge)),(F=-1<y?N[y]:null)&&Sn(F))}function Sn(y){if(typeof y!="number"&&y&&!y.da){var N=y.src;if(N&&N[we])fe(N.i,y);else{var F=y.type,G=y.proxy;N.removeEventListener?N.removeEventListener(F,G,y.capture):N.detachEvent?N.detachEvent(en(F),G):N.addListener&&N.removeListener&&N.removeListener(G),(F=kt(N))?(fe(F,y),F.h==0&&(F.src=null,N[ie]=null)):Ve(y)}}}function en(y){return y in $e?$e[y]:$e[y]="on"+y}function rn(y,N){if(y.da)y=!0;else{N=new pe(N,this);var F=y.listener,G=y.ha||y.src;y.fa&&Sn(y),y=F.call(G,N)}return y}function kt(y){return y=y[ie],y instanceof Ge?y:null}var xn="__closure_events_fn_"+(1e9*Math.random()>>>0);function re(y){return typeof y=="function"?y:(y[xn]||(y[xn]=function(N){return y.handleEvent(N)}),y[xn])}function Se(){H.call(this),this.i=new Ge(this),this.M=this,this.F=null}g(Se,H),Se.prototype[we]=!0,Se.prototype.removeEventListener=function(y,N,F,G){Mt(this,y,N,F,G)};function B(y,N){var F,G=y.F;if(G)for(F=[];G;G=G.F)F.push(G);if(y=y.M,G=N.type||N,typeof N=="string")N=new L(N,y);else if(N instanceof L)N.target=N.target||y;else{var ge=N;N=new L(G,y),A(N,ge)}if(ge=!0,F)for(var Ae=F.length-1;0<=Ae;Ae--){var rt=N.g=F[Ae];ge=X(rt,G,!0,N)&&ge}if(rt=N.g=y,ge=X(rt,G,!0,N)&&ge,ge=X(rt,G,!1,N)&&ge,F)for(Ae=0;Ae<F.length;Ae++)rt=N.g=F[Ae],ge=X(rt,G,!1,N)&&ge}Se.prototype.N=function(){if(Se.aa.N.call(this),this.i){var y=this.i,N;for(N in y.g){for(var F=y.g[N],G=0;G<F.length;G++)Ve(F[G]);delete y.g[N],y.h--}}this.F=null},Se.prototype.K=function(y,N,F,G){return this.i.add(String(y),N,!1,F,G)},Se.prototype.L=function(y,N,F,G){return this.i.add(String(y),N,!0,F,G)};function X(y,N,F,G){if(N=y.i.g[String(N)],!N)return!0;N=N.concat();for(var ge=!0,Ae=0;Ae<N.length;++Ae){var rt=N[Ae];if(rt&&!rt.da&&rt.capture==F){var Un=rt.listener,ds=rt.ha||rt.src;rt.fa&&fe(y.i,rt),ge=Un.call(ds,G)!==!1&&ge}}return ge&&!G.defaultPrevented}function ne(y,N,F){if(typeof y=="function")F&&(y=f(y,F));else if(y&&typeof y.handleEvent=="function")y=f(y.handleEvent,y);else throw Error("Invalid listener argument");return 2147483647<Number(N)?-1:l.setTimeout(y,N||0)}function Y(y){y.g=ne(()=>{y.g=null,y.i&&(y.i=!1,Y(y))},y.l);const N=y.h;y.h=null,y.m.apply(null,N)}class Ne extends H{constructor(N,F){super(),this.m=N,this.l=F,this.h=null,this.i=!1,this.g=null}j(N){this.h=arguments,this.g?this.i=!0:Y(this)}N(){super.N(),this.g&&(l.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ce(y){H.call(this),this.h=y,this.g={}}g(ce,H);var Ee=[];function Re(y){k(y.g,function(N,F){this.g.hasOwnProperty(F)&&Sn(N)},y),y.g={}}ce.prototype.N=function(){ce.aa.N.call(this),Re(this)},ce.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Be=l.JSON.stringify,_t=l.JSON.parse,mt=class{stringify(y){return l.JSON.stringify(y,void 0)}parse(y){return l.JSON.parse(y,void 0)}};function Ht(){}Ht.prototype.h=null;function tn(y){return y.h||(y.h=y.i())}function Rt(){}var sn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function In(){L.call(this,"d")}g(In,L);function Fr(){L.call(this,"c")}g(Fr,L);var zn={},wr=null;function un(){return wr=wr||new Se}zn.La="serverreachability";function Nn(y){L.call(this,zn.La,y)}g(Nn,L);function dn(y){const N=un();B(N,new Nn(N))}zn.STAT_EVENT="statevent";function cs(y,N){L.call(this,zn.STAT_EVENT,y),this.stat=N}g(cs,L);function Z(y){const N=un();B(N,new cs(N,y))}zn.Ma="timingevent";function he(y,N){L.call(this,zn.Ma,y),this.size=N}g(he,L);function _e(y,N){if(typeof y!="function")throw Error("Fn must not be null and must be a function");return l.setTimeout(function(){y()},N)}function Me(){this.g=!0}Me.prototype.xa=function(){this.g=!1};function Qe(y,N,F,G,ge,Ae){y.info(function(){if(y.g)if(Ae)for(var rt="",Un=Ae.split("&"),ds=0;ds<Un.length;ds++){var pn=Un[ds].split("=");if(1<pn.length){var Es=pn[0];pn=pn[1];var Ts=Es.split("_");rt=2<=Ts.length&&Ts[1]=="type"?rt+(Es+"="+pn+"&"):rt+(Es+"=redacted&")}}else rt=null;else rt=Ae;return"XMLHTTP REQ ("+G+") [attempt "+ge+"]: "+N+`
`+F+`
`+rt})}function Q(y,N,F,G,ge,Ae,rt){y.info(function(){return"XMLHTTP RESP ("+G+") [ attempt "+ge+"]: "+N+`
`+F+`
`+Ae+" "+rt})}function se(y,N,F,G){y.info(function(){return"XMLHTTP TEXT ("+N+"): "+J(y,F)+(G?" "+G:"")})}function ye(y,N){y.info(function(){return"TIMEOUT: "+N})}Me.prototype.info=function(){};function J(y,N){if(!y.g)return N;if(!N)return null;try{var F=JSON.parse(N);if(F){for(y=0;y<F.length;y++)if(Array.isArray(F[y])){var G=F[y];if(!(2>G.length)){var ge=G[1];if(Array.isArray(ge)&&!(1>ge.length)){var Ae=ge[0];if(Ae!="noop"&&Ae!="stop"&&Ae!="close")for(var rt=1;rt<ge.length;rt++)ge[rt]=""}}}}return Be(F)}catch{return N}}var le={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},be={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Te;function Le(){}g(Le,Ht),Le.prototype.g=function(){return new XMLHttpRequest},Le.prototype.i=function(){return{}},Te=new Le;function Ce(y,N,F,G){this.j=y,this.i=N,this.l=F,this.R=G||1,this.U=new ce(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new it}function it(){this.i=null,this.g="",this.h=!1}var ut={},Nt={};function vn(y,N,F){y.L=1,y.v=Pe(Xn(N)),y.m=F,y.P=!0,es(y,null)}function es(y,N){y.F=Date.now(),Ei(y),y.A=Xn(y.v);var F=y.A,G=y.R;Array.isArray(G)||(G=[String(G)]),Hr(F.i,"t",G),y.C=0,F=y.j.J,y.h=new it,y.g=Lk(y.j,F?N:null,!y.m),0<y.O&&(y.M=new Ne(f(y.Y,y,y.g),y.O)),N=y.U,F=y.g,G=y.ca;var ge="readystatechange";Array.isArray(ge)||(ge&&(Ee[0]=ge.toString()),ge=Ee);for(var Ae=0;Ae<ge.length;Ae++){var rt=me(F,ge[Ae],G||N.handleEvent,!1,N.h||N);if(!rt)break;N.g[rt.key]=rt}N=y.H?I(y.H):{},y.m?(y.u||(y.u="POST"),N["Content-Type"]="application/x-www-form-urlencoded",y.g.ea(y.A,y.u,y.m,N)):(y.u="GET",y.g.ea(y.A,y.u,null,N)),dn(),Qe(y.i,y.u,y.A,y.l,y.R,y.m)}Ce.prototype.ca=function(y){y=y.target;const N=this.M;N&&ja(y)==3?N.j():this.Y(y)},Ce.prototype.Y=function(y){try{if(y==this.g)e:{const Ts=ja(this.g);var N=this.g.Ba();const Nd=this.g.Z();if(!(3>Ts)&&(Ts!=3||this.g&&(this.h.h||this.g.oa()||Ek(this.g)))){this.J||Ts!=4||N==7||(N==8||0>=Nd?dn(3):dn(2)),ri(this);var F=this.g.Z();this.X=F;t:if(Vn(this)){var G=Ek(this.g);y="";var ge=G.length,Ae=ja(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){us(this),Bs(this);var rt="";break t}this.h.i=new l.TextDecoder}for(N=0;N<ge;N++)this.h.h=!0,y+=this.h.i.decode(G[N],{stream:!(Ae&&N==ge-1)});G.length=0,this.h.g+=y,this.C=0,rt=this.h.g}else rt=this.g.oa();if(this.o=F==200,Q(this.i,this.u,this.A,this.l,this.R,Ts,F),this.o){if(this.T&&!this.K){t:{if(this.g){var Un,ds=this.g;if((Un=ds.g?ds.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!_(Un)){var pn=Un;break t}}pn=null}if(F=pn)se(this.i,this.l,F,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Jt(this,F);else{this.o=!1,this.s=3,Z(12),us(this),Bs(this);break e}}if(this.P){F=!0;let Co;for(;!this.J&&this.C<rt.length;)if(Co=Wr(this,rt),Co==Nt){Ts==4&&(this.s=4,Z(14),F=!1),se(this.i,this.l,null,"[Incomplete Response]");break}else if(Co==ut){this.s=4,Z(15),se(this.i,this.l,rt,"[Invalid Chunk]"),F=!1;break}else se(this.i,this.l,Co,null),Jt(this,Co);if(Vn(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Ts!=4||rt.length!=0||this.h.h||(this.s=1,Z(16),F=!1),this.o=this.o&&F,!F)se(this.i,this.l,rt,"[Invalid Chunked Response]"),us(this),Bs(this);else if(0<rt.length&&!this.W){this.W=!0;var Es=this.j;Es.g==this&&Es.ba&&!Es.M&&(Es.j.info("Great, no buffering proxy detected. Bytes received: "+rt.length),v_(Es),Es.M=!0,Z(11))}}else se(this.i,this.l,rt,null),Jt(this,rt);Ts==4&&us(this),this.o&&!this.J&&(Ts==4?Rk(this.j,this):(this.o=!1,Ei(this)))}else zq(this.g),F==400&&0<rt.indexOf("Unknown SID")?(this.s=3,Z(12)):(this.s=0,Z(13)),us(this),Bs(this)}}}catch{}finally{}};function Vn(y){return y.g?y.u=="GET"&&y.L!=2&&y.j.Ca:!1}function Wr(y,N){var F=y.C,G=N.indexOf(`
`,F);return G==-1?Nt:(F=Number(N.substring(F,G)),isNaN(F)?ut:(G+=1,G+F>N.length?Nt:(N=N.slice(G,G+F),y.C=G+F,N)))}Ce.prototype.cancel=function(){this.J=!0,us(this)};function Ei(y){y.S=Date.now()+y.I,Us(y,y.I)}function Us(y,N){if(y.B!=null)throw Error("WatchDog timer not null");y.B=_e(f(y.ba,y),N)}function ri(y){y.B&&(l.clearTimeout(y.B),y.B=null)}Ce.prototype.ba=function(){this.B=null;const y=Date.now();0<=y-this.S?(ye(this.i,this.A),this.L!=2&&(dn(),Z(17)),us(this),this.s=2,Bs(this)):Us(this,this.S-y)};function Bs(y){y.j.G==0||y.J||Rk(y.j,y)}function us(y){ri(y);var N=y.M;N&&typeof N.ma=="function"&&N.ma(),y.M=null,Re(y.U),y.g&&(N=y.g,y.g=null,N.abort(),N.ma())}function Jt(y,N){try{var F=y.j;if(F.G!=0&&(F.g==y||ii(F.h,y))){if(!y.K&&ii(F.h,y)&&F.G==3){try{var G=F.Da.g.parse(N)}catch{G=null}if(Array.isArray(G)&&G.length==3){var ge=G;if(ge[0]==0){e:if(!F.u){if(F.g)if(F.g.F+3e3<y.F)xy(F),gy(F);else break e;x_(F),Z(18)}}else F.za=ge[1],0<F.za-F.T&&37500>ge[2]&&F.F&&F.v==0&&!F.C&&(F.C=_e(f(F.Za,F),6e3));if(1>=Ln(F.h)&&F.ca){try{F.ca()}catch{}F.ca=void 0}}else su(F,11)}else if((y.K||F.g==y)&&xy(F),!_(N))for(ge=F.Da.g.parse(N),N=0;N<ge.length;N++){let pn=ge[N];if(F.T=pn[0],pn=pn[1],F.G==2)if(pn[0]=="c"){F.K=pn[1],F.ia=pn[2];const Es=pn[3];Es!=null&&(F.la=Es,F.j.info("VER="+F.la));const Ts=pn[4];Ts!=null&&(F.Aa=Ts,F.j.info("SVER="+F.Aa));const Nd=pn[5];Nd!=null&&typeof Nd=="number"&&0<Nd&&(G=1.5*Nd,F.L=G,F.j.info("backChannelRequestTimeoutMs_="+G)),G=F;const Co=y.g;if(Co){const wy=Co.g?Co.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(wy){var Ae=G.h;Ae.g||wy.indexOf("spdy")==-1&&wy.indexOf("quic")==-1&&wy.indexOf("h2")==-1||(Ae.j=Ae.l,Ae.g=new Set,Ae.h&&(_o(Ae,Ae.h),Ae.h=null))}if(G.D){const w_=Co.g?Co.g.getResponseHeader("X-HTTP-Session-Id"):null;w_&&(G.ya=w_,ue(G.I,G.D,w_))}}F.G=3,F.l&&F.l.ua(),F.ba&&(F.R=Date.now()-y.F,F.j.info("Handshake RTT: "+F.R+"ms")),G=F;var rt=y;if(G.qa=Mk(G,G.J?G.ia:null,G.W),rt.K){Qo(G.h,rt);var Un=rt,ds=G.L;ds&&(Un.I=ds),Un.B&&(ri(Un),Ei(Un)),G.g=rt}else Ak(G);0<F.i.length&&yy(F)}else pn[0]!="stop"&&pn[0]!="close"||su(F,7);else F.G==3&&(pn[0]=="stop"||pn[0]=="close"?pn[0]=="stop"?su(F,7):y_(F):pn[0]!="noop"&&F.l&&F.l.ta(pn),F.v=0)}}dn(4)}catch{}}var Pn=class{constructor(y,N){this.g=y,this.map=N}};function si(y){this.l=y||10,l.PerformanceNavigationTiming?(y=l.performance.getEntriesByType("navigation"),y=0<y.length&&(y[0].nextHopProtocol=="hq"||y[0].nextHopProtocol=="h2")):y=!!(l.chrome&&l.chrome.loadTimes&&l.chrome.loadTimes()&&l.chrome.loadTimes().wasFetchedViaSpdy),this.j=y?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ti(y){return y.h?!0:y.g?y.g.size>=y.j:!1}function Ln(y){return y.h?1:y.g?y.g.size:0}function ii(y,N){return y.h?y.h==N:y.g?y.g.has(N):!1}function _o(y,N){y.g?y.g.add(N):y.h=N}function Qo(y,N){y.h&&y.h==N?y.h=null:y.g&&y.g.has(N)&&y.g.delete(N)}si.prototype.cancel=function(){if(this.i=eu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const y of this.g.values())y.cancel();this.g.clear()}};function eu(y){if(y.h!=null)return y.i.concat(y.h.D);if(y.g!=null&&y.g.size!==0){let N=y.i;for(const F of y.g.values())N=N.concat(F.D);return N}return x(y.i)}function Wf(y){if(y.V&&typeof y.V=="function")return y.V();if(typeof Map<"u"&&y instanceof Map||typeof Set<"u"&&y instanceof Set)return Array.from(y.values());if(typeof y=="string")return y.split("");if(c(y)){for(var N=[],F=y.length,G=0;G<F;G++)N.push(y[G]);return N}N=[],F=0;for(G in y)N[F++]=y[G];return N}function tu(y){if(y.na&&typeof y.na=="function")return y.na();if(!y.V||typeof y.V!="function"){if(typeof Map<"u"&&y instanceof Map)return Array.from(y.keys());if(!(typeof Set<"u"&&y instanceof Set)){if(c(y)||typeof y=="string"){var N=[];y=y.length;for(var F=0;F<y;F++)N.push(F);return N}N=[],F=0;for(const G in y)N[F++]=G;return N}}}function nu(y,N){if(y.forEach&&typeof y.forEach=="function")y.forEach(N,void 0);else if(c(y)||typeof y=="string")Array.prototype.forEach.call(y,N,void 0);else for(var F=tu(y),G=Wf(y),ge=G.length,Ae=0;Ae<ge;Ae++)N.call(void 0,G[Ae],F&&F[Ae],y)}var ru=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Ed(y,N){if(y){y=y.split("&");for(var F=0;F<y.length;F++){var G=y[F].indexOf("="),ge=null;if(0<=G){var Ae=y[F].substring(0,G);ge=y[F].substring(G+1)}else Ae=y[F];N(Ae,ge?decodeURIComponent(ge.replace(/\+/g," ")):"")}}}function vt(y){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,y instanceof vt){this.h=y.h,de(this,y.j),this.o=y.o,this.g=y.g,ae(this,y.s),this.l=y.l;var N=y.i,F=new Gn;F.i=N.i,N.g&&(F.g=new Map(N.g),F.h=N.h),oe(this,F),this.m=y.m}else y&&(N=String(y).match(ru))?(this.h=!1,de(this,N[1]||"",!0),this.o=Oe(N[2]||""),this.g=Oe(N[3]||"",!0),ae(this,N[4]),this.l=Oe(N[5]||"",!0),oe(this,N[6]||"",!0),this.m=Oe(N[7]||"")):(this.h=!1,this.i=new Gn(null,this.h))}vt.prototype.toString=function(){var y=[],N=this.j;N&&y.push(ze(N,Ze,!0),":");var F=this.g;return(F||N=="file")&&(y.push("//"),(N=this.o)&&y.push(ze(N,Ze,!0),"@"),y.push(encodeURIComponent(String(F)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),F=this.s,F!=null&&y.push(":",String(F))),(F=this.l)&&(this.g&&F.charAt(0)!="/"&&y.push("/"),y.push(ze(F,F.charAt(0)=="/"?Lt:pt,!0))),(F=this.i.toString())&&y.push("?",F),(F=this.m)&&y.push("#",ze(F,An)),y.join("")};function Xn(y){return new vt(y)}function de(y,N,F){y.j=F?Oe(N,!0):N,y.j&&(y.j=y.j.replace(/:$/,""))}function ae(y,N){if(N){if(N=Number(N),isNaN(N)||0>N)throw Error("Bad port number "+N);y.s=N}else y.s=null}function oe(y,N,F){N instanceof Gn?(y.i=N,ts(y.i,y.h)):(F||(N=ze(N,Bt)),y.i=new Gn(N,y.h))}function ue(y,N,F){y.i.set(N,F)}function Pe(y){return ue(y,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),y}function Oe(y,N){return y?N?decodeURI(y.replace(/%25/g,"%2525")):decodeURIComponent(y):""}function ze(y,N,F){return typeof y=="string"?(y=encodeURI(y).replace(N,tt),F&&(y=y.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),y):null}function tt(y){return y=y.charCodeAt(0),"%"+(y>>4&15).toString(16)+(y&15).toString(16)}var Ze=/[#\/\?@]/g,pt=/[#\?:]/g,Lt=/[#\?]/g,Bt=/[#\?@]/g,An=/#/g;function Gn(y,N){this.h=this.g=null,this.i=y||null,this.j=!!N}function nt(y){y.g||(y.g=new Map,y.h=0,y.i&&Ed(y.i,function(N,F){y.add(decodeURIComponent(N.replace(/\+/g," ")),F)}))}t=Gn.prototype,t.add=function(y,N){nt(this),this.i=null,y=kr(this,y);var F=this.g.get(y);return F||this.g.set(y,F=[]),F.push(N),this.h+=1,this};function xt(y,N){nt(y),N=kr(y,N),y.g.has(N)&&(y.i=null,y.h-=y.g.get(N).length,y.g.delete(N))}function cn(y,N){return nt(y),N=kr(y,N),y.g.has(N)}t.forEach=function(y,N){nt(this),this.g.forEach(function(F,G){F.forEach(function(ge){y.call(N,ge,G,this)},this)},this)},t.na=function(){nt(this);const y=Array.from(this.g.values()),N=Array.from(this.g.keys()),F=[];for(let G=0;G<N.length;G++){const ge=y[G];for(let Ae=0;Ae<ge.length;Ae++)F.push(N[G])}return F},t.V=function(y){nt(this);let N=[];if(typeof y=="string")cn(this,y)&&(N=N.concat(this.g.get(kr(this,y))));else{y=Array.from(this.g.values());for(let F=0;F<y.length;F++)N=N.concat(y[F])}return N},t.set=function(y,N){return nt(this),this.i=null,y=kr(this,y),cn(this,y)&&(this.h-=this.g.get(y).length),this.g.set(y,[N]),this.h+=1,this},t.get=function(y,N){return y?(y=this.V(y),0<y.length?String(y[0]):N):N};function Hr(y,N,F){xt(y,N),0<F.length&&(y.i=null,y.g.set(kr(y,N),x(F)),y.h+=F.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const y=[],N=Array.from(this.g.keys());for(var F=0;F<N.length;F++){var G=N[F];const Ae=encodeURIComponent(String(G)),rt=this.V(G);for(G=0;G<rt.length;G++){var ge=Ae;rt[G]!==""&&(ge+="="+encodeURIComponent(String(rt[G]))),y.push(ge)}}return this.i=y.join("&")};function kr(y,N){return N=String(N),y.j&&(N=N.toLowerCase()),N}function ts(y,N){N&&!y.j&&(nt(y),y.i=null,y.g.forEach(function(F,G){var ge=G.toLowerCase();G!=ge&&(xt(this,G),Hr(this,ge,F))},y)),y.j=N}function Tt(y,N){const F=new Me;if(l.Image){const G=new Image;G.onload=m(hr,F,"TestLoadImage: loaded",!0,N,G),G.onerror=m(hr,F,"TestLoadImage: error",!1,N,G),G.onabort=m(hr,F,"TestLoadImage: abort",!1,N,G),G.ontimeout=m(hr,F,"TestLoadImage: timeout",!1,N,G),l.setTimeout(function(){G.ontimeout&&G.ontimeout()},1e4),G.src=y}else N(!1)}function kn(y,N){const F=new Me,G=new AbortController,ge=setTimeout(()=>{G.abort(),hr(F,"TestPingServer: timeout",!1,N)},1e4);fetch(y,{signal:G.signal}).then(Ae=>{clearTimeout(ge),Ae.ok?hr(F,"TestPingServer: ok",!0,N):hr(F,"TestPingServer: server error",!1,N)}).catch(()=>{clearTimeout(ge),hr(F,"TestPingServer: error",!1,N)})}function hr(y,N,F,G,ge){try{ge&&(ge.onload=null,ge.onerror=null,ge.onabort=null,ge.ontimeout=null),G(F)}catch{}}function Ii(){this.g=new mt}function Td(y,N,F){const G=F||"";try{nu(y,function(ge,Ae){let rt=ge;u(ge)&&(rt=Be(ge)),N.push(G+Ae+"="+encodeURIComponent(rt))})}catch(ge){throw N.push(G+"type="+encodeURIComponent("_badmap")),ge}}function Qn(y){this.l=y.Ub||null,this.j=y.eb||!1}g(Qn,Ht),Qn.prototype.g=function(){return new Fn(this.l,this.j)},Qn.prototype.i=function(y){return function(){return y}}({});function Fn(y,N){Se.call(this),this.D=y,this.o=N,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}g(Fn,Se),t=Fn.prototype,t.open=function(y,N){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=y,this.A=N,this.readyState=1,So(this)},t.send=function(y){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const N={headers:this.u,method:this.B,credentials:this.m,cache:void 0};y&&(N.body=y),(this.D||l).fetch(new Request(this.A,N)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,to(this)),this.readyState=0},t.Sa=function(y){if(this.g&&(this.l=y,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=y.headers,this.readyState=2,So(this)),this.g&&(this.readyState=3,So(this),this.g)))if(this.responseType==="arraybuffer")y.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof l.ReadableStream<"u"&&"body"in y){if(this.j=y.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Wn(this)}else y.text().then(this.Ra.bind(this),this.ga.bind(this))};function Wn(y){y.j.read().then(y.Pa.bind(y)).catch(y.ga.bind(y))}t.Pa=function(y){if(this.g){if(this.o&&y.value)this.response.push(y.value);else if(!this.o){var N=y.value?y.value:new Uint8Array(0);(N=this.v.decode(N,{stream:!y.done}))&&(this.response=this.responseText+=N)}y.done?to(this):So(this),this.readyState==3&&Wn(this)}},t.Ra=function(y){this.g&&(this.response=this.responseText=y,to(this))},t.Qa=function(y){this.g&&(this.response=y,to(this))},t.ga=function(){this.g&&to(this)};function to(y){y.readyState=4,y.l=null,y.j=null,y.v=null,So(y)}t.setRequestHeader=function(y,N){this.u.append(y,N)},t.getResponseHeader=function(y){return this.h&&this.h.get(y.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const y=[],N=this.h.entries();for(var F=N.next();!F.done;)F=F.value,y.push(F[0]+": "+F[1]),F=N.next();return y.join(`\r
`)};function So(y){y.onreadystatechange&&y.onreadystatechange.call(y)}Object.defineProperty(Fn.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(y){this.m=y?"include":"same-origin"}});function Zo(y){let N="";return k(y,function(F,G){N+=G,N+=":",N+=F,N+=`\r
`}),N}function Ni(y,N,F){e:{for(G in F){var G=!1;break e}G=!0}G||(F=Zo(F),typeof y=="string"?F!=null&&encodeURIComponent(String(F)):ue(y,N,F))}function Zn(y){Se.call(this),this.headers=new Map,this.o=y||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}g(Zn,Se);var Uq=/^https?$/i,Bq=["POST","PUT"];t=Zn.prototype,t.Ha=function(y){this.J=y},t.ea=function(y,N,F,G){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+y);N=N?N.toUpperCase():"GET",this.D=y,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Te.g(),this.v=this.o?tn(this.o):tn(Te),this.g.onreadystatechange=f(this.Ea,this);try{this.B=!0,this.g.open(N,String(y),!0),this.B=!1}catch(Ae){bk(this,Ae);return}if(y=F||"",F=new Map(this.headers),G)if(Object.getPrototypeOf(G)===Object.prototype)for(var ge in G)F.set(ge,G[ge]);else if(typeof G.keys=="function"&&typeof G.get=="function")for(const Ae of G.keys())F.set(Ae,G.get(Ae));else throw Error("Unknown input type for opt_headers: "+String(G));G=Array.from(F.keys()).find(Ae=>Ae.toLowerCase()=="content-type"),ge=l.FormData&&y instanceof l.FormData,!(0<=Array.prototype.indexOf.call(Bq,N,void 0))||G||ge||F.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[Ae,rt]of F)this.g.setRequestHeader(Ae,rt);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Ck(this),this.u=!0,this.g.send(y),this.u=!1}catch(Ae){bk(this,Ae)}};function bk(y,N){y.h=!1,y.g&&(y.j=!0,y.g.abort(),y.j=!1),y.l=N,y.m=5,_k(y),py(y)}function _k(y){y.A||(y.A=!0,B(y,"complete"),B(y,"error"))}t.abort=function(y){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=y||7,B(this,"complete"),B(this,"abort"),py(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),py(this,!0)),Zn.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Sk(this):this.bb())},t.bb=function(){Sk(this)};function Sk(y){if(y.h&&typeof o<"u"&&(!y.v[1]||ja(y)!=4||y.Z()!=2)){if(y.u&&ja(y)==4)ne(y.Ea,0,y);else if(B(y,"readystatechange"),ja(y)==4){y.h=!1;try{const rt=y.Z();e:switch(rt){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var N=!0;break e;default:N=!1}var F;if(!(F=N)){var G;if(G=rt===0){var ge=String(y.D).match(ru)[1]||null;!ge&&l.self&&l.self.location&&(ge=l.self.location.protocol.slice(0,-1)),G=!Uq.test(ge?ge.toLowerCase():"")}F=G}if(F)B(y,"complete"),B(y,"success");else{y.m=6;try{var Ae=2<ja(y)?y.g.statusText:""}catch{Ae=""}y.l=Ae+" ["+y.Z()+"]",_k(y)}}finally{py(y)}}}}function py(y,N){if(y.g){Ck(y);const F=y.g,G=y.v[0]?()=>{}:null;y.g=null,y.v=null,N||B(y,"ready");try{F.onreadystatechange=G}catch{}}}function Ck(y){y.I&&(l.clearTimeout(y.I),y.I=null)}t.isActive=function(){return!!this.g};function ja(y){return y.g?y.g.readyState:0}t.Z=function(){try{return 2<ja(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(y){if(this.g){var N=this.g.responseText;return y&&N.indexOf(y)==0&&(N=N.substring(y.length)),_t(N)}};function Ek(y){try{if(!y.g)return null;if("response"in y.g)return y.g.response;switch(y.H){case"":case"text":return y.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in y.g)return y.g.mozResponseArrayBuffer}return null}catch{return null}}function zq(y){const N={};y=(y.g&&2<=ja(y)&&y.g.getAllResponseHeaders()||"").split(`\r
`);for(let G=0;G<y.length;G++){if(_(y[G]))continue;var F=D(y[G]);const ge=F[0];if(F=F[1],typeof F!="string")continue;F=F.trim();const Ae=N[ge]||[];N[ge]=Ae,Ae.push(F)}E(N,function(G){return G.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Hf(y,N,F){return F&&F.internalChannelParams&&F.internalChannelParams[y]||N}function Tk(y){this.Aa=0,this.i=[],this.j=new Me,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Hf("failFast",!1,y),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Hf("baseRetryDelayMs",5e3,y),this.cb=Hf("retryDelaySeedMs",1e4,y),this.Wa=Hf("forwardChannelMaxRetries",2,y),this.wa=Hf("forwardChannelRequestTimeoutMs",2e4,y),this.pa=y&&y.xmlHttpFactory||void 0,this.Xa=y&&y.Tb||void 0,this.Ca=y&&y.useFetchStreams||!1,this.L=void 0,this.J=y&&y.supportsCrossDomainXhr||!1,this.K="",this.h=new si(y&&y.concurrentRequestLimit),this.Da=new Ii,this.P=y&&y.fastHandshake||!1,this.O=y&&y.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=y&&y.Rb||!1,y&&y.xa&&this.j.xa(),y&&y.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&y&&y.detectBufferingProxy||!1,this.ja=void 0,y&&y.longPollingTimeout&&0<y.longPollingTimeout&&(this.ja=y.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Tk.prototype,t.la=8,t.G=1,t.connect=function(y,N,F,G){Z(0),this.W=y,this.H=N||{},F&&G!==void 0&&(this.H.OSID=F,this.H.OAID=G),this.F=this.X,this.I=Mk(this,null,this.W),yy(this)};function y_(y){if(Ik(y),y.G==3){var N=y.U++,F=Xn(y.I);if(ue(F,"SID",y.K),ue(F,"RID",N),ue(F,"TYPE","terminate"),qf(y,F),N=new Ce(y,y.j,N),N.L=2,N.v=Pe(Xn(F)),F=!1,l.navigator&&l.navigator.sendBeacon)try{F=l.navigator.sendBeacon(N.v.toString(),"")}catch{}!F&&l.Image&&(new Image().src=N.v,F=!0),F||(N.g=Lk(N.j,null),N.g.ea(N.v)),N.F=Date.now(),Ei(N)}Dk(y)}function gy(y){y.g&&(v_(y),y.g.cancel(),y.g=null)}function Ik(y){gy(y),y.u&&(l.clearTimeout(y.u),y.u=null),xy(y),y.h.cancel(),y.s&&(typeof y.s=="number"&&l.clearTimeout(y.s),y.s=null)}function yy(y){if(!Ti(y.h)&&!y.s){y.s=!0;var N=y.Ga;q||O(),W||(q(),W=!0),te.add(N,y),y.B=0}}function Gq(y,N){return Ln(y.h)>=y.h.j-(y.s?1:0)?!1:y.s?(y.i=N.D.concat(y.i),!0):y.G==1||y.G==2||y.B>=(y.Va?0:y.Wa)?!1:(y.s=_e(f(y.Ga,y,N),jk(y,y.B)),y.B++,!0)}t.Ga=function(y){if(this.s)if(this.s=null,this.G==1){if(!y){this.U=Math.floor(1e5*Math.random()),y=this.U++;const ge=new Ce(this,this.j,y);let Ae=this.o;if(this.S&&(Ae?(Ae=I(Ae),A(Ae,this.S)):Ae=this.S),this.m!==null||this.O||(ge.H=Ae,Ae=null),this.P)e:{for(var N=0,F=0;F<this.i.length;F++){t:{var G=this.i[F];if("__data__"in G.map&&(G=G.map.__data__,typeof G=="string")){G=G.length;break t}G=void 0}if(G===void 0)break;if(N+=G,4096<N){N=F;break e}if(N===4096||F===this.i.length-1){N=F+1;break e}}N=1e3}else N=1e3;N=Pk(this,ge,N),F=Xn(this.I),ue(F,"RID",y),ue(F,"CVER",22),this.D&&ue(F,"X-HTTP-Session-Id",this.D),qf(this,F),Ae&&(this.O?N="headers="+encodeURIComponent(String(Zo(Ae)))+"&"+N:this.m&&Ni(F,this.m,Ae)),_o(this.h,ge),this.Ua&&ue(F,"TYPE","init"),this.P?(ue(F,"$req",N),ue(F,"SID","null"),ge.T=!0,vn(ge,F,null)):vn(ge,F,N),this.G=2}}else this.G==3&&(y?Nk(this,y):this.i.length==0||Ti(this.h)||Nk(this))};function Nk(y,N){var F;N?F=N.l:F=y.U++;const G=Xn(y.I);ue(G,"SID",y.K),ue(G,"RID",F),ue(G,"AID",y.T),qf(y,G),y.m&&y.o&&Ni(G,y.m,y.o),F=new Ce(y,y.j,F,y.B+1),y.m===null&&(F.H=y.o),N&&(y.i=N.D.concat(y.i)),N=Pk(y,F,1e3),F.I=Math.round(.5*y.wa)+Math.round(.5*y.wa*Math.random()),_o(y.h,F),vn(F,G,N)}function qf(y,N){y.H&&k(y.H,function(F,G){ue(N,G,F)}),y.l&&nu({},function(F,G){ue(N,G,F)})}function Pk(y,N,F){F=Math.min(y.i.length,F);var G=y.l?f(y.l.Na,y.l,y):null;e:{var ge=y.i;let Ae=-1;for(;;){const rt=["count="+F];Ae==-1?0<F?(Ae=ge[0].g,rt.push("ofs="+Ae)):Ae=0:rt.push("ofs="+Ae);let Un=!0;for(let ds=0;ds<F;ds++){let pn=ge[ds].g;const Es=ge[ds].map;if(pn-=Ae,0>pn)Ae=Math.max(0,ge[ds].g-100),Un=!1;else try{Td(Es,rt,"req"+pn+"_")}catch{G&&G(Es)}}if(Un){G=rt.join("&");break e}}}return y=y.i.splice(0,F),N.D=y,G}function Ak(y){if(!y.g&&!y.u){y.Y=1;var N=y.Fa;q||O(),W||(q(),W=!0),te.add(N,y),y.v=0}}function x_(y){return y.g||y.u||3<=y.v?!1:(y.Y++,y.u=_e(f(y.Fa,y),jk(y,y.v)),y.v++,!0)}t.Fa=function(){if(this.u=null,kk(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var y=2*this.R;this.j.info("BP detection timer enabled: "+y),this.A=_e(f(this.ab,this),y)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Z(10),gy(this),kk(this))};function v_(y){y.A!=null&&(l.clearTimeout(y.A),y.A=null)}function kk(y){y.g=new Ce(y,y.j,"rpc",y.Y),y.m===null&&(y.g.H=y.o),y.g.O=0;var N=Xn(y.qa);ue(N,"RID","rpc"),ue(N,"SID",y.K),ue(N,"AID",y.T),ue(N,"CI",y.F?"0":"1"),!y.F&&y.ja&&ue(N,"TO",y.ja),ue(N,"TYPE","xmlhttp"),qf(y,N),y.m&&y.o&&Ni(N,y.m,y.o),y.L&&(y.g.I=y.L);var F=y.g;y=y.ia,F.L=1,F.v=Pe(Xn(N)),F.m=null,F.P=!0,es(F,y)}t.Za=function(){this.C!=null&&(this.C=null,gy(this),x_(this),Z(19))};function xy(y){y.C!=null&&(l.clearTimeout(y.C),y.C=null)}function Rk(y,N){var F=null;if(y.g==N){xy(y),v_(y),y.g=null;var G=2}else if(ii(y.h,N))F=N.D,Qo(y.h,N),G=1;else return;if(y.G!=0){if(N.o)if(G==1){F=N.m?N.m.length:0,N=Date.now()-N.F;var ge=y.B;G=un(),B(G,new he(G,F)),yy(y)}else Ak(y);else if(ge=N.s,ge==3||ge==0&&0<N.X||!(G==1&&Gq(y,N)||G==2&&x_(y)))switch(F&&0<F.length&&(N=y.h,N.i=N.i.concat(F)),ge){case 1:su(y,5);break;case 4:su(y,10);break;case 3:su(y,6);break;default:su(y,2)}}}function jk(y,N){let F=y.Ta+Math.floor(Math.random()*y.cb);return y.isActive()||(F*=2),F*N}function su(y,N){if(y.j.info("Error code "+N),N==2){var F=f(y.fb,y),G=y.Xa;const ge=!G;G=new vt(G||"//www.google.com/images/cleardot.gif"),l.location&&l.location.protocol=="http"||de(G,"https"),Pe(G),ge?Tt(G.toString(),F):kn(G.toString(),F)}else Z(2);y.G=0,y.l&&y.l.sa(N),Dk(y),Ik(y)}t.fb=function(y){y?(this.j.info("Successfully pinged google.com"),Z(2)):(this.j.info("Failed to ping google.com"),Z(1))};function Dk(y){if(y.G=0,y.ka=[],y.l){const N=eu(y.h);(N.length!=0||y.i.length!=0)&&(w(y.ka,N),w(y.ka,y.i),y.h.i.length=0,x(y.i),y.i.length=0),y.l.ra()}}function Mk(y,N,F){var G=F instanceof vt?Xn(F):new vt(F);if(G.g!="")N&&(G.g=N+"."+G.g),ae(G,G.s);else{var ge=l.location;G=ge.protocol,N=N?N+"."+ge.hostname:ge.hostname,ge=+ge.port;var Ae=new vt(null);G&&de(Ae,G),N&&(Ae.g=N),ge&&ae(Ae,ge),F&&(Ae.l=F),G=Ae}return F=y.D,N=y.ya,F&&N&&ue(G,F,N),ue(G,"VER",y.la),qf(y,G),G}function Lk(y,N,F){if(N&&!y.J)throw Error("Can't create secondary domain capable XhrIo object.");return N=y.Ca&&!y.pa?new Zn(new Qn({eb:F})):new Zn(y.pa),N.Ha(y.J),N}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Fk(){}t=Fk.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function vy(){}vy.prototype.g=function(y,N){return new Pi(y,N)};function Pi(y,N){Se.call(this),this.g=new Tk(N),this.l=y,this.h=N&&N.messageUrlParams||null,y=N&&N.messageHeaders||null,N&&N.clientProtocolHeaderRequired&&(y?y["X-Client-Protocol"]="webchannel":y={"X-Client-Protocol":"webchannel"}),this.g.o=y,y=N&&N.initMessageHeaders||null,N&&N.messageContentType&&(y?y["X-WebChannel-Content-Type"]=N.messageContentType:y={"X-WebChannel-Content-Type":N.messageContentType}),N&&N.va&&(y?y["X-WebChannel-Client-Profile"]=N.va:y={"X-WebChannel-Client-Profile":N.va}),this.g.S=y,(y=N&&N.Sb)&&!_(y)&&(this.g.m=y),this.v=N&&N.supportsCrossDomainXhr||!1,this.u=N&&N.sendRawJson||!1,(N=N&&N.httpSessionIdParam)&&!_(N)&&(this.g.D=N,y=this.h,y!==null&&N in y&&(y=this.h,N in y&&delete y[N])),this.j=new Id(this)}g(Pi,Se),Pi.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Pi.prototype.close=function(){y_(this.g)},Pi.prototype.o=function(y){var N=this.g;if(typeof y=="string"){var F={};F.__data__=y,y=F}else this.u&&(F={},F.__data__=Be(y),y=F);N.i.push(new Pn(N.Ya++,y)),N.G==3&&yy(N)},Pi.prototype.N=function(){this.g.l=null,delete this.j,y_(this.g),delete this.g,Pi.aa.N.call(this)};function Ok(y){In.call(this),y.__headers__&&(this.headers=y.__headers__,this.statusCode=y.__status__,delete y.__headers__,delete y.__status__);var N=y.__sm__;if(N){e:{for(const F in N){y=F;break e}y=void 0}(this.i=y)&&(y=this.i,N=N!==null&&y in N?N[y]:void 0),this.data=N}else this.data=y}g(Ok,In);function $k(){Fr.call(this),this.status=1}g($k,Fr);function Id(y){this.g=y}g(Id,Fk),Id.prototype.ua=function(){B(this.g,"a")},Id.prototype.ta=function(y){B(this.g,new Ok(y))},Id.prototype.sa=function(y){B(this.g,new $k)},Id.prototype.ra=function(){B(this.g,"b")},vy.prototype.createWebChannel=vy.prototype.g,Pi.prototype.send=Pi.prototype.o,Pi.prototype.open=Pi.prototype.m,Pi.prototype.close=Pi.prototype.close,p6=function(){return new vy},m6=function(){return un()},f6=zn,KE={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},le.NO_ERROR=0,le.TIMEOUT=8,le.HTTP_ERROR=6,Xx=le,be.COMPLETE="complete",h6=be,Rt.EventType=sn,sn.OPEN="a",sn.CLOSE="b",sn.ERROR="c",sn.MESSAGE="d",Se.prototype.listen=Se.prototype.K,Pm=Rt,Zn.prototype.listenOnce=Zn.prototype.L,Zn.prototype.getLastError=Zn.prototype.Ka,Zn.prototype.getLastErrorCode=Zn.prototype.Ba,Zn.prototype.getStatus=Zn.prototype.Z,Zn.prototype.getResponseJson=Zn.prototype.Oa,Zn.prototype.getResponseText=Zn.prototype.oa,Zn.prototype.send=Zn.prototype.ea,Zn.prototype.setWithCredentials=Zn.prototype.Ha,d6=Zn}).apply(typeof Qy<"u"?Qy:typeof self<"u"?self:typeof window<"u"?window:{});const bD="@firebase/firestore",_D="4.7.16";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gs{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}gs.UNAUTHENTICATED=new gs(null),gs.GOOGLE_CREDENTIALS=new gs("google-credentials-uid"),gs.FIRST_PARTY=new gs("first-party-uid"),gs.MOCK_USER=new gs("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Df="11.8.1";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ed=new sN("@firebase/firestore");function Kd(){return ed.logLevel}function Ye(t,...e){if(ed.logLevel<=an.DEBUG){const n=e.map(gN);ed.debug(`Firestore (${Df}): ${t}`,...n)}}function Ys(t,...e){if(ed.logLevel<=an.ERROR){const n=e.map(gN);ed.error(`Firestore (${Df}): ${t}`,...n)}}function td(t,...e){if(ed.logLevel<=an.WARN){const n=e.map(gN);ed.warn(`Firestore (${Df}): ${t}`,...n)}}function gN(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wt(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,g6(t,r,n)}function g6(t,e,n){let r=`FIRESTORE (${Df}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ys(r),new Error(r)}function St(t,e,n,r){let s="Unexpected state";typeof n=="string"?s=n:r=n,t||g6(e,s,r)}function qt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const De={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ot extends Xo{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Wde{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(gs.UNAUTHENTICATED))}shutdown(){}}class Hde{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class qde{constructor(e){this.t=e,this.currentUser=gs.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){St(this.o===void 0,42304);let r=this.i;const s=c=>this.i!==r?(r=this.i,n(c)):Promise.resolve();let i=new wa;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new wa,e.enqueueRetryable(()=>s(this.currentUser))};const o=()=>{const c=i;e.enqueueRetryable(async()=>{await c.promise,await s(this.currentUser)})},l=c=>{Ye("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.o&&(this.auth.addAuthTokenListener(this.o),o())};this.t.onInit(c=>l(c)),setTimeout(()=>{if(!this.auth){const c=this.t.getImmediate({optional:!0});c?l(c):(Ye("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new wa)}},0),o()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(Ye("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(St(typeof r.accessToken=="string",31837,{l:r}),new y6(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return St(e===null||typeof e=="string",2055,{h:e}),new gs(e)}}class Kde{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=gs.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Yde{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new Kde(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(gs.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class SD{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Jde{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Ks(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){St(this.o===void 0,3512);const r=i=>{i.error!=null&&Ye("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${i.error.message}`);const o=i.token!==this.m;return this.m=i.token,Ye("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?n(i.token):Promise.resolve()};this.o=i=>{e.enqueueRetryable(()=>r(i))};const s=i=>{Ye("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=i,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(i=>s(i)),setTimeout(()=>{if(!this.appCheck){const i=this.V.getImmediate({optional:!0});i?s(i):Ye("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new SD(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(St(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new SD(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xde(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function x6(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class v6{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const s=Xde(40);for(let i=0;i<s.length;++i)r.length<20&&s[i]<n&&(r+=e.charAt(s[i]%62))}return r}}function Vt(t,e){return t<e?-1:t>e?1:0}function YE(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),s=e.codePointAt(n);if(r!==s){if(r<128&&s<128)return Vt(r,s);{const i=x6(),o=Qde(i.encode(CD(t,n)),i.encode(CD(e,n)));return o!==0?o:Vt(r,s)}}n+=r>65535?2:1}return Vt(t.length,e.length)}function CD(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function Qde(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Vt(t[n],e[n]);return Vt(t.length,e.length)}function nf(t,e,n){return t.length===e.length&&t.every((r,s)=>n(r,e[s]))}function w6(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ED=-62135596800,TD=1e6;class xr{static now(){return xr.fromMillis(Date.now())}static fromDate(e){return xr.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*TD);return new xr(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ot(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ot(De.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<ED)throw new ot(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ot(De.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/TD}_compareTo(e){return this.seconds===e.seconds?Vt(this.nanoseconds,e.nanoseconds):Vt(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-ED;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class It{static fromTimestamp(e){return new It(e)}static min(){return new It(new xr(0,0))}static max(){return new It(new xr(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ID="__name__";class sa{constructor(e,n,r){n===void 0?n=0:n>e.length&&wt(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&wt(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return sa.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof sa?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let s=0;s<r;s++){const i=sa.compareSegments(e.get(s),n.get(s));if(i!==0)return i}return Vt(e.length,n.length)}static compareSegments(e,n){const r=sa.isNumericId(e),s=sa.isNumericId(n);return r&&!s?-1:!r&&s?1:r&&s?sa.extractNumericId(e).compare(sa.extractNumericId(n)):YE(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return dc.fromString(e.substring(4,e.length-2))}}class En extends sa{construct(e,n,r){return new En(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ot(De.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(s=>s.length>0))}return new En(n)}static emptyPath(){return new En([])}}const Zde=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class pr extends sa{construct(e,n,r){return new pr(e,n,r)}static isValidIdentifier(e){return Zde.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),pr.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===ID}static keyField(){return new pr([ID])}static fromServerFormat(e){const n=[];let r="",s=0;const i=()=>{if(r.length===0)throw new ot(De.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let o=!1;for(;s<e.length;){const l=e[s];if(l==="\\"){if(s+1===e.length)throw new ot(De.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const c=e[s+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new ot(De.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=c,s+=2}else l==="`"?(o=!o,s++):l!=="."||o?(r+=l,s++):(i(),s++)}if(i(),o)throw new ot(De.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new pr(n)}static emptyPath(){return new pr([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dt{constructor(e){this.path=e}static fromPath(e){return new dt(En.fromString(e))}static fromName(e){return new dt(En.fromString(e).popFirst(5))}static empty(){return new dt(En.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&En.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return En.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new dt(new En(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yp=-1;class yw{constructor(e,n,r,s){this.indexId=e,this.collectionGroup=n,this.fields=r,this.indexState=s}}function JE(t){return t.fields.find(e=>e.kind===2)}function du(t){return t.fields.filter(e=>e.kind!==2)}yw.UNKNOWN_ID=-1;class Qx{constructor(e,n){this.fieldPath=e,this.kind=n}}class Jp{constructor(e,n){this.sequenceNumber=e,this.offset=n}static empty(){return new Jp(0,Xi.min())}}function ehe(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,s=It.fromTimestamp(r===1e9?new xr(n+1,0):new xr(n,r));return new Xi(s,dt.empty(),e)}function b6(t){return new Xi(t.readTime,t.key,Yp)}class Xi{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Xi(It.min(),dt.empty(),Yp)}static max(){return new Xi(It.max(),dt.empty(),Yp)}}function yN(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=dt.comparator(t.documentKey,e.documentKey),n!==0?n:Vt(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _6="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class S6{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function pd(t){if(t.code!==De.FAILED_PRECONDITION||t.message!==_6)throw t;Ye("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ve{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&wt(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new ve((r,s)=>{this.nextCallback=i=>{this.wrapSuccess(e,i).next(r,s)},this.catchCallback=i=>{this.wrapFailure(n,i).next(r,s)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof ve?n:ve.resolve(n)}catch(n){return ve.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):ve.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):ve.reject(n)}static resolve(e){return new ve((n,r)=>{n(e)})}static reject(e){return new ve((n,r)=>{r(e)})}static waitFor(e){return new ve((n,r)=>{let s=0,i=0,o=!1;e.forEach(l=>{++s,l.next(()=>{++i,o&&i===s&&n()},c=>r(c))}),o=!0,i===s&&n()})}static or(e){let n=ve.resolve(!1);for(const r of e)n=n.next(s=>s?ve.resolve(s):r());return n}static forEach(e,n){const r=[];return e.forEach((s,i)=>{r.push(n.call(this,s,i))}),this.waitFor(r)}static mapArray(e,n){return new ve((r,s)=>{const i=e.length,o=new Array(i);let l=0;for(let c=0;c<i;c++){const u=c;n(e[u]).next(d=>{o[u]=d,++l,l===i&&r(o)},d=>s(d))}})}static doWhile(e,n){return new ve((r,s)=>{const i=()=>{e()===!0?n().next(()=>{i()},s):r()};i()})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Oi="SimpleDb";class nb{static open(e,n,r,s){try{return new nb(n,e.transaction(s,r))}catch(i){throw new rp(n,i)}}constructor(e,n){this.action=e,this.transaction=n,this.aborted=!1,this.S=new wa,this.transaction.oncomplete=()=>{this.S.resolve()},this.transaction.onabort=()=>{n.error?this.S.reject(new rp(e,n.error)):this.S.resolve()},this.transaction.onerror=r=>{const s=xN(r.target.error);this.S.reject(new rp(e,s))}}get D(){return this.S.promise}abort(e){e&&this.S.reject(e),this.aborted||(Ye(Oi,"Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}v(){const e=this.transaction;this.aborted||typeof e.commit!="function"||e.commit()}store(e){const n=this.transaction.objectStore(e);return new nhe(n)}}class hc{static delete(e){return Ye(Oi,"Removing database:",e),xu(y5().indexedDB.deleteDatabase(e)).toPromise()}static C(){if(!E5())return!1;if(hc.F())return!0;const e=Xr(),n=hc.M(e),r=0<n&&n<10,s=C6(e),i=0<s&&s<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||i)}static F(){var e;return typeof process<"u"&&((e=process.__PRIVATE_env)===null||e===void 0?void 0:e.O)==="YES"}static N(e,n){return e.store(n)}static M(e){const n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)}constructor(e,n,r){this.name=e,this.version=n,this.B=r,this.L=null,hc.M(Xr())===12.2&&Ys("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}async k(e){return this.db||(Ye(Oi,"Opening database:",this.name),this.db=await new Promise((n,r)=>{const s=indexedDB.open(this.name,this.version);s.onsuccess=i=>{const o=i.target.result;n(o)},s.onblocked=()=>{r(new rp(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},s.onerror=i=>{const o=i.target.error;o.name==="VersionError"?r(new ot(De.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?r(new ot(De.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):r(new rp(e,o))},s.onupgradeneeded=i=>{Ye(Oi,'Database "'+this.name+'" requires upgrade from version:',i.oldVersion);const o=i.target.result;if(this.L!==null&&this.L!==i.oldVersion)throw new Error(`refusing to open IndexedDB database due to potential corruption of the IndexedDB database data; this corruption could be caused by clicking the "clear site data" button in a web browser; try reloading the web page to re-initialize the IndexedDB database: lastClosedDbVersion=${this.L}, event.oldVersion=${i.oldVersion}, event.newVersion=${i.newVersion}, db.version=${o.version}`);this.B.q(o,s.transaction,i.oldVersion,this.version).next(()=>{Ye(Oi,"Database upgrade to version "+this.version+" complete")})}}),this.db.addEventListener("close",n=>{const r=n.target;this.L=r.version},{passive:!0})),this.$&&(this.db.onversionchange=n=>this.$(n)),this.db}U(e){this.$=e,this.db&&(this.db.onversionchange=n=>e(n))}async runTransaction(e,n,r,s){const i=n==="readonly";let o=0;for(;;){++o;try{this.db=await this.k(e);const l=nb.open(this.db,e,i?"readonly":"readwrite",r),c=s(l).next(u=>(l.v(),u)).catch(u=>(l.abort(u),ve.reject(u))).toPromise();return c.catch(()=>{}),await l.D,c}catch(l){const c=l,u=c.name!=="FirebaseError"&&o<3;if(Ye(Oi,"Transaction failed with error:",c.message,"Retrying:",u),this.close(),!u)return Promise.reject(c)}}}close(){this.db&&this.db.close(),this.db=void 0}}function C6(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class the{constructor(e){this.K=e,this.W=!1,this.G=null}get isDone(){return this.W}get j(){return this.G}set cursor(e){this.K=e}done(){this.W=!0}H(e){this.G=e}delete(){return xu(this.K.delete())}}class rp extends ot{constructor(e,n){super(De.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${n}`),this.name="IndexedDbTransactionError"}}function Wc(t){return t.name==="IndexedDbTransactionError"}class nhe{constructor(e){this.store=e}put(e,n){let r;return n!==void 0?(Ye(Oi,"PUT",this.store.name,e,n),r=this.store.put(n,e)):(Ye(Oi,"PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),xu(r)}add(e){return Ye(Oi,"ADD",this.store.name,e,e),xu(this.store.add(e))}get(e){return xu(this.store.get(e)).next(n=>(n===void 0&&(n=null),Ye(Oi,"GET",this.store.name,e,n),n))}delete(e){return Ye(Oi,"DELETE",this.store.name,e),xu(this.store.delete(e))}count(){return Ye(Oi,"COUNT",this.store.name),xu(this.store.count())}J(e,n){const r=this.options(e,n),s=r.index?this.store.index(r.index):this.store;if(typeof s.getAll=="function"){const i=s.getAll(r.range);return new ve((o,l)=>{i.onerror=c=>{l(c.target.error)},i.onsuccess=c=>{o(c.target.result)}})}{const i=this.cursor(r),o=[];return this.Y(i,(l,c)=>{o.push(c)}).next(()=>o)}}Z(e,n){const r=this.store.getAll(e,n===null?void 0:n);return new ve((s,i)=>{r.onerror=o=>{i(o.target.error)},r.onsuccess=o=>{s(o.target.result)}})}X(e,n){Ye(Oi,"DELETE ALL",this.store.name);const r=this.options(e,n);r.ee=!1;const s=this.cursor(r);return this.Y(s,(i,o,l)=>l.delete())}te(e,n){let r;n?r=e:(r={},n=e);const s=this.cursor(r);return this.Y(s,n)}ne(e){const n=this.cursor({});return new ve((r,s)=>{n.onerror=i=>{const o=xN(i.target.error);s(o)},n.onsuccess=i=>{const o=i.target.result;o?e(o.primaryKey,o.value).next(l=>{l?o.continue():r()}):r()}})}Y(e,n){const r=[];return new ve((s,i)=>{e.onerror=o=>{i(o.target.error)},e.onsuccess=o=>{const l=o.target.result;if(!l)return void s();const c=new the(l),u=n(l.primaryKey,l.value,c);if(u instanceof ve){const d=u.catch(h=>(c.done(),ve.reject(h)));r.push(d)}c.isDone?s():c.j===null?l.continue():l.continue(c.j)}}).next(()=>ve.waitFor(r))}options(e,n){let r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}}cursor(e){let n="next";if(e.reverse&&(n="prev"),e.index){const r=this.store.index(e.index);return e.ee?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)}}function xu(t){return new ve((e,n)=>{t.onsuccess=r=>{const s=r.target.result;e(s)},t.onerror=r=>{const s=xN(r.target.error);n(s)}})}let ND=!1;function xN(t){const e=hc.M(Xr());if(e>=12.2&&e<13){const n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){const r=new ot("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${n}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return ND||(ND=!0,setTimeout(()=>{throw r},0)),r}}return t}const sp="IndexBackfiller";class rhe{constructor(e,n){this.asyncQueue=e,this.re=n,this.task=null}start(){this.ie(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}ie(e){Ye(sp,`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,async()=>{this.task=null;try{const n=await this.re.se();Ye(sp,`Documents written: ${n}`)}catch(n){Wc(n)?Ye(sp,"Ignoring IndexedDB error during index backfill: ",n):await pd(n)}await this.ie(6e4)})}}class she{constructor(e,n){this.localStore=e,this.persistence=n}async se(e=50){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",n=>this.oe(n,e))}oe(e,n){const r=new Set;let s=n,i=!0;return ve.doWhile(()=>i===!0&&s>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next(o=>{if(o!==null&&!r.has(o))return Ye(sp,`Processing collection: ${o}`),this._e(e,o,s).next(l=>{s-=l,r.add(o)});i=!1})).next(()=>n-s)}_e(e,n,r){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,n).next(s=>this.localStore.localDocuments.getNextDocuments(e,n,s,r).next(i=>{const o=i.changes;return this.localStore.indexManager.updateIndexEntries(e,o).next(()=>this.ae(s,i)).next(l=>(Ye(sp,`Updating offset: ${l}`),this.localStore.indexManager.updateCollectionGroup(e,n,l))).next(()=>o.size)}))}ae(e,n){let r=e;return n.changes.forEach((s,i)=>{const o=b6(i);yN(o,r)>0&&(r=o)}),new Xi(r.readTime,r.documentKey,Math.max(n.batchId,e.largestBatchId))}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uo{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}uo.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $u=-1;function rb(t){return t==null}function Xp(t){return t===0&&1/t==-1/0}function ihe(t){return typeof t=="number"&&Number.isInteger(t)&&!Xp(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xw="";function Ls(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=PD(e)),e=ohe(t.get(n),e);return PD(e)}function ohe(t,e){let n=e;const r=t.length;for(let s=0;s<r;s++){const i=t.charAt(s);switch(i){case"\0":n+="";break;case xw:n+="";break;default:n+=i}}return n}function PD(t){return t+xw+""}function ua(t){const e=t.length;if(St(e>=2,64408,{path:t}),e===2)return St(t.charAt(0)===xw&&t.charAt(1)==="",56145,{path:t}),En.emptyPath();const n=e-2,r=[];let s="";for(let i=0;i<e;){const o=t.indexOf(xw,i);switch((o<0||o>n)&&wt(50515,{path:t}),t.charAt(o+1)){case"":const l=t.substring(i,o);let c;s.length===0?c=l:(s+=l,c=s,s=""),r.push(c);break;case"":s+=t.substring(i,o),s+="\0";break;case"":s+=t.substring(i,o+1);break;default:wt(61167,{path:t})}i=o+2}return new En(r)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hu="remoteDocuments",Vg="owner",Dd="owner",Qp="mutationQueues",ahe="userId",Ro="mutations",AD="batchId",Ru="userMutationsIndex",kD=["userId","batchId"];/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zx(t,e){return[t,Ls(e)]}function E6(t,e,n){return[t,Ls(e),n]}const lhe={},rf="documentMutations",vw="remoteDocumentsV14",che=["prefixPath","collectionGroup","readTime","documentId"],ev="documentKeyIndex",uhe=["prefixPath","collectionGroup","documentId"],T6="collectionGroupIndex",dhe=["collectionGroup","readTime","prefixPath","documentId"],Zp="remoteDocumentGlobal",XE="remoteDocumentGlobalKey",sf="targets",I6="queryTargetsIndex",hhe=["canonicalId","targetId"],of="targetDocuments",fhe=["targetId","path"],vN="documentTargetsIndex",mhe=["path","targetId"],ww="targetGlobalKey",Vu="targetGlobal",eg="collectionParents",phe=["collectionId","parent"],af="clientMetadata",ghe="clientId",sb="bundles",yhe="bundleId",ib="namedQueries",xhe="name",wN="indexConfiguration",vhe="indexId",QE="collectionGroupIndex",whe="collectionGroup",ip="indexState",bhe=["indexId","uid"],N6="sequenceNumberIndex",_he=["uid","sequenceNumber"],op="indexEntries",She=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],P6="documentKeyIndex",Che=["indexId","uid","orderedDocumentKey"],ob="documentOverlays",Ehe=["userId","collectionPath","documentId"],ZE="collectionPathOverlayIndex",The=["userId","collectionPath","largestBatchId"],A6="collectionGroupOverlayIndex",Ihe=["userId","collectionGroup","largestBatchId"],bN="globals",Nhe="name",k6=[Qp,Ro,rf,hu,sf,Vg,Vu,of,af,Zp,eg,sb,ib],Phe=[...k6,ob],R6=[Qp,Ro,rf,vw,sf,Vg,Vu,of,af,Zp,eg,sb,ib,ob],j6=R6,_N=[...j6,wN,ip,op],Ahe=_N,D6=[..._N,bN],khe=D6;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT extends S6{constructor(e,n){super(),this.he=e,this.currentSequenceNumber=n}}function Qr(t,e){const n=qt(t);return hc.N(n.he,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function RD(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Hc(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function M6(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ur{constructor(e,n){this.comparator=e,this.root=n||ys.EMPTY}insert(e,n){return new ur(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,ys.BLACK,null,null))}remove(e){return new ur(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ys.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const s=this.comparator(e,r.key);if(s===0)return n+r.left.size;s<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Zy(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Zy(this.root,e,this.comparator,!1)}getReverseIterator(){return new Zy(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Zy(this.root,e,this.comparator,!0)}}class Zy{constructor(e,n,r,s){this.isReverse=s,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=n?r(e.key,n):1,n&&s&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(i===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ys{constructor(e,n,r,s,i){this.key=e,this.value=n,this.color=r??ys.RED,this.left=s??ys.EMPTY,this.right=i??ys.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,s,i){return new ys(e??this.key,n??this.value,r??this.color,s??this.left,i??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let s=this;const i=r(e,s.key);return s=i<0?s.copy(null,null,null,s.left.insert(e,n,r),null):i===0?s.copy(null,n,null,null,null):s.copy(null,null,null,null,s.right.insert(e,n,r)),s.fixUp()}removeMin(){if(this.left.isEmpty())return ys.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,s=this;if(n(e,s.key)<0)s.left.isEmpty()||s.left.isRed()||s.left.left.isRed()||(s=s.moveRedLeft()),s=s.copy(null,null,null,s.left.remove(e,n),null);else{if(s.left.isRed()&&(s=s.rotateRight()),s.right.isEmpty()||s.right.isRed()||s.right.left.isRed()||(s=s.moveRedRight()),n(e,s.key)===0){if(s.right.isEmpty())return ys.EMPTY;r=s.right.min(),s=s.copy(r.key,r.value,null,null,s.right.removeMin())}s=s.copy(null,null,null,null,s.right.remove(e,n))}return s.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,ys.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,ys.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw wt(43730,{key:this.key,value:this.value});if(this.right.isRed())throw wt(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw wt(27949);return e+(this.isRed()?0:1)}}ys.EMPTY=null,ys.RED=!0,ys.BLACK=!1;ys.EMPTY=new class{constructor(){this.size=0}get key(){throw wt(57766)}get value(){throw wt(16141)}get color(){throw wt(16727)}get left(){throw wt(29726)}get right(){throw wt(36894)}copy(e,n,r,s,i){return this}insert(e,n,r){return new ys(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mn{constructor(e){this.comparator=e,this.data=new ur(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const s=r.getNext();if(this.comparator(s.key,e[1])>=0)return;n(s.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new jD(this.data.getIterator())}getIteratorFrom(e){return new jD(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Mn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(this.comparator(s,i)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Mn(this.comparator);return n.data=e,n}}class jD{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function Md(t){return t.hasNext()?t.getNext():void 0}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hi{constructor(e){this.fields=e,e.sort(pr.comparator)}static empty(){return new hi([])}unionWith(e){let n=new Mn(pr.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new hi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return nf(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L6 extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gr{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(s){try{return atob(s)}catch(i){throw typeof DOMException<"u"&&i instanceof DOMException?new L6("Invalid base64 string: "+i):i}}(e);return new Gr(n)}static fromUint8Array(e){const n=function(s){let i="";for(let o=0;o<s.length;++o)i+=String.fromCharCode(s[o]);return i}(e);return new Gr(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Vt(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Gr.EMPTY_BYTE_STRING=new Gr("");const Rhe=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function dl(t){if(St(!!t,39018),typeof t=="string"){let e=0;const n=Rhe.exec(t);if(St(!!n,46558,{timestamp:t}),n[1]){let s=n[1];s=(s+"000000000").substr(0,9),e=Number(s)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ar(t.seconds),nanos:ar(t.nanos)}}function ar(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function hl(t){return typeof t=="string"?Gr.fromBase64String(t):Gr.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F6="server_timestamp",O6="__type__",$6="__previous_value__",V6="__local_write_time__";function SN(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[O6])===null||n===void 0?void 0:n.stringValue)===F6}function ab(t){const e=t.mapValue.fields[$6];return SN(e)?ab(e):e}function tg(t){const e=dl(t.mapValue.fields[V6].timestampValue);return new xr(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jhe{constructor(e,n,r,s,i,o,l,c,u,d){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=s,this.ssl=i,this.forceLongPolling=o,this.autoDetectLongPolling=l,this.longPollingOptions=c,this.useFetchStreams=u,this.isUsingEmulator=d}}const bw="(default)";class nd{constructor(e,n){this.projectId=e,this.database=n||bw}static empty(){return new nd("","")}get isDefaultDatabase(){return this.database===bw}isEqual(e){return e instanceof nd&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CN="__type__",U6="__max__",Ql={mapValue:{fields:{__type__:{stringValue:U6}}}},EN="__vector__",lf="value",tv={nullValue:"NULL_VALUE"};function Cc(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?SN(t)?4:B6(t)?9007199254740991:lb(t)?10:11:wt(28295,{value:t})}function Ta(t,e){if(t===e)return!0;const n=Cc(t);if(n!==Cc(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return tg(t).isEqual(tg(e));case 3:return function(s,i){if(typeof s.timestampValue=="string"&&typeof i.timestampValue=="string"&&s.timestampValue.length===i.timestampValue.length)return s.timestampValue===i.timestampValue;const o=dl(s.timestampValue),l=dl(i.timestampValue);return o.seconds===l.seconds&&o.nanos===l.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(s,i){return hl(s.bytesValue).isEqual(hl(i.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(s,i){return ar(s.geoPointValue.latitude)===ar(i.geoPointValue.latitude)&&ar(s.geoPointValue.longitude)===ar(i.geoPointValue.longitude)}(t,e);case 2:return function(s,i){if("integerValue"in s&&"integerValue"in i)return ar(s.integerValue)===ar(i.integerValue);if("doubleValue"in s&&"doubleValue"in i){const o=ar(s.doubleValue),l=ar(i.doubleValue);return o===l?Xp(o)===Xp(l):isNaN(o)&&isNaN(l)}return!1}(t,e);case 9:return nf(t.arrayValue.values||[],e.arrayValue.values||[],Ta);case 10:case 11:return function(s,i){const o=s.mapValue.fields||{},l=i.mapValue.fields||{};if(RD(o)!==RD(l))return!1;for(const c in o)if(o.hasOwnProperty(c)&&(l[c]===void 0||!Ta(o[c],l[c])))return!1;return!0}(t,e);default:return wt(52216,{left:t})}}function ng(t,e){return(t.values||[]).find(n=>Ta(n,e))!==void 0}function Ec(t,e){if(t===e)return 0;const n=Cc(t),r=Cc(e);if(n!==r)return Vt(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Vt(t.booleanValue,e.booleanValue);case 2:return function(i,o){const l=ar(i.integerValue||i.doubleValue),c=ar(o.integerValue||o.doubleValue);return l<c?-1:l>c?1:l===c?0:isNaN(l)?isNaN(c)?0:-1:1}(t,e);case 3:return DD(t.timestampValue,e.timestampValue);case 4:return DD(tg(t),tg(e));case 5:return YE(t.stringValue,e.stringValue);case 6:return function(i,o){const l=hl(i),c=hl(o);return l.compareTo(c)}(t.bytesValue,e.bytesValue);case 7:return function(i,o){const l=i.split("/"),c=o.split("/");for(let u=0;u<l.length&&u<c.length;u++){const d=Vt(l[u],c[u]);if(d!==0)return d}return Vt(l.length,c.length)}(t.referenceValue,e.referenceValue);case 8:return function(i,o){const l=Vt(ar(i.latitude),ar(o.latitude));return l!==0?l:Vt(ar(i.longitude),ar(o.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return MD(t.arrayValue,e.arrayValue);case 10:return function(i,o){var l,c,u,d;const h=i.fields||{},f=o.fields||{},m=(l=h[lf])===null||l===void 0?void 0:l.arrayValue,g=(c=f[lf])===null||c===void 0?void 0:c.arrayValue,x=Vt(((u=m==null?void 0:m.values)===null||u===void 0?void 0:u.length)||0,((d=g==null?void 0:g.values)===null||d===void 0?void 0:d.length)||0);return x!==0?x:MD(m,g)}(t.mapValue,e.mapValue);case 11:return function(i,o){if(i===Ql.mapValue&&o===Ql.mapValue)return 0;if(i===Ql.mapValue)return 1;if(o===Ql.mapValue)return-1;const l=i.fields||{},c=Object.keys(l),u=o.fields||{},d=Object.keys(u);c.sort(),d.sort();for(let h=0;h<c.length&&h<d.length;++h){const f=YE(c[h],d[h]);if(f!==0)return f;const m=Ec(l[c[h]],u[d[h]]);if(m!==0)return m}return Vt(c.length,d.length)}(t.mapValue,e.mapValue);default:throw wt(23264,{Pe:n})}}function DD(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Vt(t,e);const n=dl(t),r=dl(e),s=Vt(n.seconds,r.seconds);return s!==0?s:Vt(n.nanos,r.nanos)}function MD(t,e){const n=t.values||[],r=e.values||[];for(let s=0;s<n.length&&s<r.length;++s){const i=Ec(n[s],r[s]);if(i)return i}return Vt(n.length,r.length)}function cf(t){return tT(t)}function tT(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=dl(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return hl(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return dt.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",s=!0;for(const i of n.values||[])s?s=!1:r+=",",r+=tT(i);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let s="{",i=!0;for(const o of r)i?i=!1:s+=",",s+=`${o}:${tT(n.fields[o])}`;return s+"}"}(t.mapValue):wt(61005,{value:t})}function nv(t){switch(Cc(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=ab(t);return e?16+nv(e):16;case 5:return 2*t.stringValue.length;case 6:return hl(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((s,i)=>s+nv(i),0)}(t.arrayValue);case 10:case 11:return function(r){let s=0;return Hc(r.fields,(i,o)=>{s+=i.length+nv(o)}),s}(t.mapValue);default:throw wt(13486,{value:t})}}function rg(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function nT(t){return!!t&&"integerValue"in t}function sg(t){return!!t&&"arrayValue"in t}function LD(t){return!!t&&"nullValue"in t}function FD(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function rv(t){return!!t&&"mapValue"in t}function lb(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[CN])===null||n===void 0?void 0:n.stringValue)===EN}function ap(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Hc(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=ap(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=ap(t.arrayValue.values[n]);return e}return Object.assign({},t)}function B6(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===U6}const z6={mapValue:{fields:{[CN]:{stringValue:EN},[lf]:{arrayValue:{}}}}};function Dhe(t){return"nullValue"in t?tv:"booleanValue"in t?{booleanValue:!1}:"integerValue"in t||"doubleValue"in t?{doubleValue:NaN}:"timestampValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in t?{stringValue:""}:"bytesValue"in t?{bytesValue:""}:"referenceValue"in t?rg(nd.empty(),dt.empty()):"geoPointValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in t?{arrayValue:{}}:"mapValue"in t?lb(t)?z6:{mapValue:{}}:wt(35942,{value:t})}function Mhe(t){return"nullValue"in t?{booleanValue:!1}:"booleanValue"in t?{doubleValue:NaN}:"integerValue"in t||"doubleValue"in t?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in t?{stringValue:""}:"stringValue"in t?{bytesValue:""}:"bytesValue"in t?rg(nd.empty(),dt.empty()):"referenceValue"in t?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in t?{arrayValue:{}}:"arrayValue"in t?z6:"mapValue"in t?lb(t)?{mapValue:{}}:Ql:wt(61959,{value:t})}function OD(t,e){const n=Ec(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?-1:!t.inclusive&&e.inclusive?1:0}function $D(t,e){const n=Ec(t.value,e.value);return n!==0?n:t.inclusive&&!e.inclusive?1:!t.inclusive&&e.inclusive?-1:0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ms{constructor(e){this.value=e}static empty(){return new Ms({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!rv(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=ap(n)}setAll(e){let n=pr.emptyPath(),r={},s=[];e.forEach((o,l)=>{if(!n.isImmediateParentOf(l)){const c=this.getFieldsMap(n);this.applyChanges(c,r,s),r={},s=[],n=l.popLast()}o?r[l.lastSegment()]=ap(o):s.push(l.lastSegment())});const i=this.getFieldsMap(n);this.applyChanges(i,r,s)}delete(e){const n=this.field(e.popLast());rv(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ta(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let s=n.mapValue.fields[e.get(r)];rv(s)&&s.mapValue.fields||(s={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=s),n=s}return n.mapValue.fields}applyChanges(e,n,r){Hc(n,(s,i)=>e[s]=i);for(const s of r)delete e[s]}clone(){return new Ms(ap(this.value))}}function G6(t){const e=[];return Hc(t.fields,(n,r)=>{const s=new pr([n]);if(rv(r)){const i=G6(r.mapValue).fields;if(i.length===0)e.push(s);else for(const o of i)e.push(s.child(o))}else e.push(s)}),new hi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cr{constructor(e,n,r,s,i,o,l){this.key=e,this.documentType=n,this.version=r,this.readTime=s,this.createTime=i,this.data=o,this.documentState=l}static newInvalidDocument(e){return new Cr(e,0,It.min(),It.min(),It.min(),Ms.empty(),0)}static newFoundDocument(e,n,r,s){return new Cr(e,1,n,It.min(),r,s,0)}static newNoDocument(e,n){return new Cr(e,2,n,It.min(),It.min(),Ms.empty(),0)}static newUnknownDocument(e,n){return new Cr(e,3,n,It.min(),It.min(),Ms.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(It.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ms.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ms.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=It.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Cr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Cr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uf{constructor(e,n){this.position=e,this.inclusive=n}}function VD(t,e,n){let r=0;for(let s=0;s<t.position.length;s++){const i=e[s],o=t.position[s];if(i.field.isKeyField()?r=dt.comparator(dt.fromName(o.referenceValue),n.key):r=Ec(o,n.data.field(i.field)),i.dir==="desc"&&(r*=-1),r!==0)break}return r}function UD(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ta(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _w{constructor(e,n="asc"){this.field=e,this.dir=n}}function Lhe(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class W6{}class ln extends W6{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new Fhe(e,n,r):n==="array-contains"?new Vhe(e,r):n==="in"?new X6(e,r):n==="not-in"?new Uhe(e,r):n==="array-contains-any"?new Bhe(e,r):new ln(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new Ohe(e,r):new $he(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(Ec(n,this.value)):n!==null&&Cc(this.value)===Cc(n)&&this.matchesComparison(Ec(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return wt(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class jn extends W6{constructor(e,n){super(),this.filters=e,this.op=n,this.Te=null}static create(e,n){return new jn(e,n)}matches(e){return df(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function df(t){return t.op==="and"}function rT(t){return t.op==="or"}function TN(t){return H6(t)&&df(t)}function H6(t){for(const e of t.filters)if(e instanceof jn)return!1;return!0}function sT(t){if(t instanceof ln)return t.field.canonicalString()+t.op.toString()+cf(t.value);if(TN(t))return t.filters.map(e=>sT(e)).join(",");{const e=t.filters.map(n=>sT(n)).join(",");return`${t.op}(${e})`}}function q6(t,e){return t instanceof ln?function(r,s){return s instanceof ln&&r.op===s.op&&r.field.isEqual(s.field)&&Ta(r.value,s.value)}(t,e):t instanceof jn?function(r,s){return s instanceof jn&&r.op===s.op&&r.filters.length===s.filters.length?r.filters.reduce((i,o,l)=>i&&q6(o,s.filters[l]),!0):!1}(t,e):void wt(19439)}function K6(t,e){const n=t.filters.concat(e);return jn.create(n,t.op)}function Y6(t){return t instanceof ln?function(n){return`${n.field.canonicalString()} ${n.op} ${cf(n.value)}`}(t):t instanceof jn?function(n){return n.op.toString()+" {"+n.getFilters().map(Y6).join(" ,")+"}"}(t):"Filter"}class Fhe extends ln{constructor(e,n,r){super(e,n,r),this.key=dt.fromName(r.referenceValue)}matches(e){const n=dt.comparator(e.key,this.key);return this.matchesComparison(n)}}class Ohe extends ln{constructor(e,n){super(e,"in",n),this.keys=J6("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class $he extends ln{constructor(e,n){super(e,"not-in",n),this.keys=J6("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function J6(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>dt.fromName(r.referenceValue))}class Vhe extends ln{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return sg(n)&&ng(n.arrayValue,this.value)}}class X6 extends ln{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&ng(this.value.arrayValue,n)}}class Uhe extends ln{constructor(e,n){super(e,"not-in",n)}matches(e){if(ng(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!ng(this.value.arrayValue,n)}}class Bhe extends ln{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!sg(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>ng(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zhe{constructor(e,n=null,r=[],s=[],i=null,o=null,l=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=s,this.limit=i,this.startAt=o,this.endAt=l,this.Ie=null}}function iT(t,e=null,n=[],r=[],s=null,i=null,o=null){return new zhe(t,e,n,r,s,i,o)}function rd(t){const e=qt(t);if(e.Ie===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>sT(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(i){return i.field.canonicalString()+i.dir}(r)).join(","),rb(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>cf(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>cf(r)).join(",")),e.Ie=n}return e.Ie}function Ug(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!Lhe(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!q6(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!UD(t.startAt,e.startAt)&&UD(t.endAt,e.endAt)}function Sw(t){return dt.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}function Cw(t,e){return t.filters.filter(n=>n instanceof ln&&n.field.isEqual(e))}function BD(t,e,n){let r=tv,s=!0;for(const i of Cw(t,e)){let o=tv,l=!0;switch(i.op){case"<":case"<=":o=Dhe(i.value);break;case"==":case"in":case">=":o=i.value;break;case">":o=i.value,l=!1;break;case"!=":case"not-in":o=tv}OD({value:r,inclusive:s},{value:o,inclusive:l})<0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];OD({value:r,inclusive:s},{value:o,inclusive:n.inclusive})<0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}function zD(t,e,n){let r=Ql,s=!0;for(const i of Cw(t,e)){let o=Ql,l=!0;switch(i.op){case">=":case">":o=Mhe(i.value),l=!1;break;case"==":case"in":case"<=":o=i.value;break;case"<":o=i.value,l=!1;break;case"!=":case"not-in":o=Ql}$D({value:r,inclusive:s},{value:o,inclusive:l})>0&&(r=o,s=l)}if(n!==null){for(let i=0;i<t.orderBy.length;++i)if(t.orderBy[i].field.isEqual(e)){const o=n.position[i];$D({value:r,inclusive:s},{value:o,inclusive:n.inclusive})>0&&(r=o,s=n.inclusive);break}}return{value:r,inclusive:s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(e,n=null,r=[],s=[],i=null,o="F",l=null,c=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=s,this.limit=i,this.limitType=o,this.startAt=l,this.endAt=c,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function Ghe(t,e,n,r,s,i,o,l){return new Bg(t,e,n,r,s,i,o,l)}function zg(t){return new Bg(t)}function GD(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Q6(t){return t.collectionGroup!==null}function lp(t){const e=qt(t);if(e.Ee===null){e.Ee=[];const n=new Set;for(const i of e.explicitOrderBy)e.Ee.push(i),n.add(i.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(o){let l=new Mn(pr.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(u=>{u.isInequality()&&(l=l.add(u.field))})}),l})(e).forEach(i=>{n.has(i.canonicalString())||i.isKeyField()||e.Ee.push(new _w(i,r))}),n.has(pr.keyField().canonicalString())||e.Ee.push(new _w(pr.keyField(),r))}return e.Ee}function po(t){const e=qt(t);return e.de||(e.de=Whe(e,lp(t))),e.de}function Whe(t,e){if(t.limitType==="F")return iT(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(s=>{const i=s.dir==="desc"?"asc":"desc";return new _w(s.field,i)});const n=t.endAt?new uf(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new uf(t.startAt.position,t.startAt.inclusive):null;return iT(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function oT(t,e){const n=t.filters.concat([e]);return new Bg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Ew(t,e,n){return new Bg(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function cb(t,e){return Ug(po(t),po(e))&&t.limitType===e.limitType}function Z6(t){return`${rd(po(t))}|lt:${t.limitType}`}function Yd(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(s=>Y6(s)).join(", ")}]`),rb(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(s=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(s)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(s=>cf(s)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(s=>cf(s)).join(",")),`Target(${r})`}(po(t))}; limitType=${t.limitType})`}function Gg(t,e){return e.isFoundDocument()&&function(r,s){const i=s.key.path;return r.collectionGroup!==null?s.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(i):dt.isDocumentKey(r.path)?r.path.isEqual(i):r.path.isImmediateParentOf(i)}(t,e)&&function(r,s){for(const i of lp(r))if(!i.field.isKeyField()&&s.data.field(i.field)===null)return!1;return!0}(t,e)&&function(r,s){for(const i of r.filters)if(!i.matches(s))return!1;return!0}(t,e)&&function(r,s){return!(r.startAt&&!function(o,l,c){const u=VD(o,l,c);return o.inclusive?u<=0:u<0}(r.startAt,lp(r),s)||r.endAt&&!function(o,l,c){const u=VD(o,l,c);return o.inclusive?u>=0:u>0}(r.endAt,lp(r),s))}(t,e)}function Hhe(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function eB(t){return(e,n)=>{let r=!1;for(const s of lp(t)){const i=qhe(s,e,n);if(i!==0)return i;r=r||s.field.isKeyField()}return 0}}function qhe(t,e,n){const r=t.field.isKeyField()?dt.comparator(e.key,n.key):function(i,o,l){const c=o.data.field(i),u=l.data.field(i);return c!==null&&u!==null?Ec(c,u):wt(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return wt(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _l{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[s,i]of r)if(this.equalsFn(s,e))return i}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),s=this.inner[r];if(s===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let i=0;i<s.length;i++)if(this.equalsFn(s[i][0],e))return void(s[i]=[e,n]);s.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],e))return r.length===1?delete this.inner[n]:r.splice(s,1),this.innerSize--,!0;return!1}forEach(e){Hc(this.inner,(n,r)=>{for(const[s,i]of r)e(s,i)})}isEmpty(){return M6(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Khe=new ur(dt.comparator);function Gi(){return Khe}const tB=new ur(dt.comparator);function Am(...t){let e=tB;for(const n of t)e=e.insert(n.key,n);return e}function nB(t){let e=tB;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function da(){return cp()}function rB(){return cp()}function cp(){return new _l(t=>t.toString(),(t,e)=>t.isEqual(e))}const Yhe=new ur(dt.comparator),Jhe=new Mn(dt.comparator);function Qt(...t){let e=Jhe;for(const n of t)e=e.add(n);return e}const Xhe=new Mn(Vt);function Qhe(){return Xhe}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IN(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xp(e)?"-0":e}}function sB(t){return{integerValue:""+t}}function iB(t,e){return ihe(e)?sB(e):IN(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ub{constructor(){this._=void 0}}function Zhe(t,e,n){return t instanceof ig?function(s,i){const o={fields:{[O6]:{stringValue:F6},[V6]:{timestampValue:{seconds:s.seconds,nanos:s.nanoseconds}}}};return i&&SN(i)&&(i=ab(i)),i&&(o.fields[$6]=i),{mapValue:o}}(n,e):t instanceof hf?aB(t,e):t instanceof ff?lB(t,e):function(s,i){const o=oB(s,i),l=WD(o)+WD(s.Re);return nT(o)&&nT(s.Re)?sB(l):IN(s.serializer,l)}(t,e)}function efe(t,e,n){return t instanceof hf?aB(t,e):t instanceof ff?lB(t,e):n}function oB(t,e){return t instanceof mf?function(r){return nT(r)||function(i){return!!i&&"doubleValue"in i}(r)}(e)?e:{integerValue:0}:null}class ig extends ub{}class hf extends ub{constructor(e){super(),this.elements=e}}function aB(t,e){const n=cB(e);for(const r of t.elements)n.some(s=>Ta(s,r))||n.push(r);return{arrayValue:{values:n}}}class ff extends ub{constructor(e){super(),this.elements=e}}function lB(t,e){let n=cB(e);for(const r of t.elements)n=n.filter(s=>!Ta(s,r));return{arrayValue:{values:n}}}class mf extends ub{constructor(e,n){super(),this.serializer=e,this.Re=n}}function WD(t){return ar(t.integerValue||t.doubleValue)}function cB(t){return sg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uB{constructor(e,n){this.field=e,this.transform=n}}function tfe(t,e){return t.field.isEqual(e.field)&&function(r,s){return r instanceof hf&&s instanceof hf||r instanceof ff&&s instanceof ff?nf(r.elements,s.elements,Ta):r instanceof mf&&s instanceof mf?Ta(r.Re,s.Re):r instanceof ig&&s instanceof ig}(t.transform,e.transform)}class nfe{constructor(e,n){this.version=e,this.transformResults=n}}class Js{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Js}static exists(e){return new Js(void 0,e)}static updateTime(e){return new Js(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sv(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class db{}function dB(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new hb(t.key,Js.none()):new Mf(t.key,t.data,Js.none());{const n=t.data,r=Ms.empty();let s=new Mn(pr.comparator);for(let i of e.fields)if(!s.has(i)){let o=n.field(i);o===null&&i.length>1&&(i=i.popLast(),o=n.field(i)),o===null?r.delete(i):r.set(i,o),s=s.add(i)}return new Sl(t.key,r,new hi(s.toArray()),Js.none())}}function rfe(t,e,n){t instanceof Mf?function(s,i,o){const l=s.value.clone(),c=qD(s.fieldTransforms,i,o.transformResults);l.setAll(c),i.convertToFoundDocument(o.version,l).setHasCommittedMutations()}(t,e,n):t instanceof Sl?function(s,i,o){if(!sv(s.precondition,i))return void i.convertToUnknownDocument(o.version);const l=qD(s.fieldTransforms,i,o.transformResults),c=i.data;c.setAll(hB(s)),c.setAll(l),i.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(t,e,n):function(s,i,o){i.convertToNoDocument(o.version).setHasCommittedMutations()}(0,e,n)}function up(t,e,n,r){return t instanceof Mf?function(i,o,l,c){if(!sv(i.precondition,o))return l;const u=i.value.clone(),d=KD(i.fieldTransforms,c,o);return u.setAll(d),o.convertToFoundDocument(o.version,u).setHasLocalMutations(),null}(t,e,n,r):t instanceof Sl?function(i,o,l,c){if(!sv(i.precondition,o))return l;const u=KD(i.fieldTransforms,c,o),d=o.data;return d.setAll(hB(i)),d.setAll(u),o.convertToFoundDocument(o.version,d).setHasLocalMutations(),l===null?null:l.unionWith(i.fieldMask.fields).unionWith(i.fieldTransforms.map(h=>h.field))}(t,e,n,r):function(i,o,l){return sv(i.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):l}(t,e,n)}function sfe(t,e){let n=null;for(const r of t.fieldTransforms){const s=e.data.field(r.field),i=oB(r.transform,s||null);i!=null&&(n===null&&(n=Ms.empty()),n.set(r.field,i))}return n||null}function HD(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,s){return r===void 0&&s===void 0||!(!r||!s)&&nf(r,s,(i,o)=>tfe(i,o))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Mf extends db{constructor(e,n,r,s=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=s,this.type=0}getFieldMask(){return null}}class Sl extends db{constructor(e,n,r,s,i=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=s,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function hB(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function qD(t,e,n){const r=new Map;St(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let s=0;s<n.length;s++){const i=t[s],o=i.transform,l=e.data.field(i.field);r.set(i.field,efe(o,l,n[s]))}return r}function KD(t,e,n){const r=new Map;for(const s of t){const i=s.transform,o=n.data.field(s.field);r.set(s.field,Zhe(i,o,e))}return r}class hb extends db{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class fB extends db{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NN{constructor(e,n,r,s){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=s}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let s=0;s<this.mutations.length;s++){const i=this.mutations[s];i.key.isEqual(e.key)&&rfe(i,e,r[s])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=up(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=up(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=rB();return this.mutations.forEach(s=>{const i=e.get(s.key),o=i.overlayedDocument;let l=this.applyToLocalView(o,i.mutatedFields);l=n.has(s.key)?null:l;const c=dB(o,l);c!==null&&r.set(s.key,c),o.isValidDocument()||o.convertToNoDocument(It.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Qt())}isEqual(e){return this.batchId===e.batchId&&nf(this.mutations,e.mutations,(n,r)=>HD(n,r))&&nf(this.baseMutations,e.baseMutations,(n,r)=>HD(n,r))}}class PN{constructor(e,n,r,s){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=s}static from(e,n,r){St(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let s=function(){return Yhe}();const i=e.mutations;for(let o=0;o<i.length;o++)s=s.insert(i[o].key,r[o].version);return new PN(e,n,r,s)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ife{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Or,hn;function ofe(t){switch(t){case De.OK:return wt(64938);case De.CANCELLED:case De.UNKNOWN:case De.DEADLINE_EXCEEDED:case De.RESOURCE_EXHAUSTED:case De.INTERNAL:case De.UNAVAILABLE:case De.UNAUTHENTICATED:return!1;case De.INVALID_ARGUMENT:case De.NOT_FOUND:case De.ALREADY_EXISTS:case De.PERMISSION_DENIED:case De.FAILED_PRECONDITION:case De.ABORTED:case De.OUT_OF_RANGE:case De.UNIMPLEMENTED:case De.DATA_LOSS:return!0;default:return wt(15467,{code:t})}}function mB(t){if(t===void 0)return Ys("GRPC error has no .code"),De.UNKNOWN;switch(t){case Or.OK:return De.OK;case Or.CANCELLED:return De.CANCELLED;case Or.UNKNOWN:return De.UNKNOWN;case Or.DEADLINE_EXCEEDED:return De.DEADLINE_EXCEEDED;case Or.RESOURCE_EXHAUSTED:return De.RESOURCE_EXHAUSTED;case Or.INTERNAL:return De.INTERNAL;case Or.UNAVAILABLE:return De.UNAVAILABLE;case Or.UNAUTHENTICATED:return De.UNAUTHENTICATED;case Or.INVALID_ARGUMENT:return De.INVALID_ARGUMENT;case Or.NOT_FOUND:return De.NOT_FOUND;case Or.ALREADY_EXISTS:return De.ALREADY_EXISTS;case Or.PERMISSION_DENIED:return De.PERMISSION_DENIED;case Or.FAILED_PRECONDITION:return De.FAILED_PRECONDITION;case Or.ABORTED:return De.ABORTED;case Or.OUT_OF_RANGE:return De.OUT_OF_RANGE;case Or.UNIMPLEMENTED:return De.UNIMPLEMENTED;case Or.DATA_LOSS:return De.DATA_LOSS;default:return wt(39323,{code:t})}}(hn=Or||(Or={}))[hn.OK=0]="OK",hn[hn.CANCELLED=1]="CANCELLED",hn[hn.UNKNOWN=2]="UNKNOWN",hn[hn.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",hn[hn.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",hn[hn.NOT_FOUND=5]="NOT_FOUND",hn[hn.ALREADY_EXISTS=6]="ALREADY_EXISTS",hn[hn.PERMISSION_DENIED=7]="PERMISSION_DENIED",hn[hn.UNAUTHENTICATED=16]="UNAUTHENTICATED",hn[hn.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",hn[hn.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",hn[hn.ABORTED=10]="ABORTED",hn[hn.OUT_OF_RANGE=11]="OUT_OF_RANGE",hn[hn.UNIMPLEMENTED=12]="UNIMPLEMENTED",hn[hn.INTERNAL=13]="INTERNAL",hn[hn.UNAVAILABLE=14]="UNAVAILABLE",hn[hn.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const afe=new dc([4294967295,4294967295],0);function YD(t){const e=x6().encode(t),n=new u6;return n.update(e),new Uint8Array(n.digest())}function JD(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),s=e.getUint32(8,!0),i=e.getUint32(12,!0);return[new dc([n,r],0),new dc([s,i],0)]}class kN{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new km(`Invalid padding: ${n}`);if(r<0)throw new km(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new km(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new km(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*e.length-n,this.ye=dc.fromNumber(this.pe)}we(e,n,r){let s=e.add(n.multiply(dc.fromNumber(r)));return s.compare(afe)===1&&(s=new dc([s.getBits(0),s.getBits(1)],0)),s.modulo(this.ye).toNumber()}Se(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const n=YD(e),[r,s]=JD(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);if(!this.Se(o))return!1}return!0}static create(e,n,r){const s=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),o=new kN(i,s,n);return r.forEach(l=>o.insert(l)),o}insert(e){if(this.pe===0)return;const n=YD(e),[r,s]=JD(n);for(let i=0;i<this.hashCount;i++){const o=this.we(r,s,i);this.be(o)}}be(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class km extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fb{constructor(e,n,r,s,i){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=s,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const s=new Map;return s.set(e,Wg.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new fb(It.min(),s,new ur(Vt),Gi(),Qt())}}class Wg{constructor(e,n,r,s,i){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=s,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Wg(r,n,Qt(),Qt(),Qt())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iv{constructor(e,n,r,s){this.De=e,this.removedTargetIds=n,this.key=r,this.ve=s}}class pB{constructor(e,n){this.targetId=e,this.Ce=n}}class gB{constructor(e,n,r=Gr.EMPTY_BYTE_STRING,s=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=s}}class XD{constructor(){this.Fe=0,this.Me=QD(),this.xe=Gr.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Qt(),n=Qt(),r=Qt();return this.Me.forEach((s,i)=>{switch(i){case 0:e=e.add(s);break;case 2:n=n.add(s);break;case 1:r=r.add(s);break;default:wt(38017,{changeType:i})}}),new Wg(this.xe,this.Oe,e,n,r)}Qe(){this.Ne=!1,this.Me=QD()}$e(e,n){this.Ne=!0,this.Me=this.Me.insert(e,n)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,St(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class lfe{constructor(e){this.ze=e,this.je=new Map,this.He=Gi(),this.Je=ex(),this.Ye=ex(),this.Ze=new ur(Vt)}Xe(e){for(const n of e.De)e.ve&&e.ve.isFoundDocument()?this.et(n,e.ve):this.tt(n,e.key,e.ve);for(const n of e.removedTargetIds)this.tt(n,e.key,e.ve)}nt(e){this.forEachTarget(e,n=>{const r=this.rt(n);switch(e.state){case 0:this.it(n)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(e.resumeToken));break;default:wt(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.je.forEach((r,s)=>{this.it(s)&&n(s)})}ot(e){const n=e.targetId,r=e.Ce.count,s=this._t(n);if(s){const i=s.target;if(Sw(i))if(r===0){const o=new dt(i.path);this.tt(n,o,Cr.newNoDocument(o,It.min()))}else St(r===1,20013,{expectedCount:r});else{const o=this.ut(n);if(o!==r){const l=this.ct(e),c=l?this.lt(l,e,o):1;if(c!==0){this.st(n);const u=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,u)}}}}}ct(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:s=0},hashCount:i=0}=n;let o,l;try{o=hl(r).toUint8Array()}catch(c){if(c instanceof L6)return td("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{l=new kN(o,s,i)}catch(c){return td(c instanceof km?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return l.pe===0?null:l}lt(e,n,r){return n.Ce.count===r-this.Tt(e,n.targetId)?0:2}Tt(e,n){const r=this.ze.getRemoteKeysForTarget(n);let s=0;return r.forEach(i=>{const o=this.ze.Pt(),l=`projects/${o.projectId}/databases/${o.database}/documents/${i.path.canonicalString()}`;e.mightContain(l)||(this.tt(n,i,null),s++)}),s}It(e){const n=new Map;this.je.forEach((i,o)=>{const l=this._t(o);if(l){if(i.current&&Sw(l.target)){const c=new dt(l.target.path);this.Et(c).has(o)||this.dt(o,c)||this.tt(o,c,Cr.newNoDocument(c,e))}i.Le&&(n.set(o,i.qe()),i.Qe())}});let r=Qt();this.Ye.forEach((i,o)=>{let l=!0;o.forEachWhile(c=>{const u=this._t(c);return!u||u.purpose==="TargetPurposeLimboResolution"||(l=!1,!1)}),l&&(r=r.add(i))}),this.He.forEach((i,o)=>o.setReadTime(e));const s=new fb(e,n,this.Ze,this.He,r);return this.He=Gi(),this.Je=ex(),this.Ye=ex(),this.Ze=new ur(Vt),s}et(e,n){if(!this.it(e))return;const r=this.dt(e,n.key)?2:0;this.rt(e).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(e)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(e))}tt(e,n,r){if(!this.it(e))return;const s=this.rt(e);this.dt(e,n)?s.$e(n,1):s.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(e)),this.Ye=this.Ye.insert(n,this.At(n).add(e)),r&&(this.He=this.He.insert(n,r))}removeTarget(e){this.je.delete(e)}ut(e){const n=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let n=this.je.get(e);return n||(n=new XD,this.je.set(e,n)),n}At(e){let n=this.Ye.get(e);return n||(n=new Mn(Vt),this.Ye=this.Ye.insert(e,n)),n}Et(e){let n=this.Je.get(e);return n||(n=new Mn(Vt),this.Je=this.Je.insert(e,n)),n}it(e){const n=this._t(e)!==null;return n||Ye("WatchChangeAggregator","Detected inactive target",e),n}_t(e){const n=this.je.get(e);return n&&n.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new XD),this.ze.getRemoteKeysForTarget(e).forEach(n=>{this.tt(e,n,null)})}dt(e,n){return this.ze.getRemoteKeysForTarget(e).has(n)}}function ex(){return new ur(dt.comparator)}function QD(){return new ur(dt.comparator)}const cfe=(()=>({asc:"ASCENDING",desc:"DESCENDING"}))(),ufe=(()=>({"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"}))(),dfe=(()=>({and:"AND",or:"OR"}))();class hfe{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function aT(t,e){return t.useProto3Json||rb(e)?e:{value:e}}function pf(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function yB(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function ffe(t,e){return pf(t,e.toTimestamp())}function Qs(t){return St(!!t,49232),It.fromTimestamp(function(n){const r=dl(n);return new xr(r.seconds,r.nanos)}(t))}function RN(t,e){return lT(t,e).canonicalString()}function lT(t,e){const n=function(s){return new En(["projects",s.projectId,"databases",s.database])}(t).child("documents");return e===void 0?n:n.child(e)}function xB(t){const e=En.fromString(t);return St(IB(e),10190,{key:e.toString()}),e}function Tw(t,e){return RN(t.databaseId,e.path)}function Uu(t,e){const n=xB(e);if(n.get(1)!==t.databaseId.projectId)throw new ot(De.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ot(De.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new dt(bB(n))}function vB(t,e){return RN(t.databaseId,e)}function wB(t){const e=xB(t);return e.length===4?En.emptyPath():bB(e)}function cT(t){return new En(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function bB(t){return St(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function ZD(t,e,n){return{name:Tw(t,e),fields:n.value.mapValue.fields}}function mfe(t,e,n){const r=Uu(t,e.name),s=Qs(e.updateTime),i=e.createTime?Qs(e.createTime):It.min(),o=new Ms({mapValue:{fields:e.fields}}),l=Cr.newFoundDocument(r,s,i,o);return n&&l.setHasCommittedMutations(),n?l.setHasCommittedMutations():l}function pfe(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(u){return u==="NO_CHANGE"?0:u==="ADD"?1:u==="REMOVE"?2:u==="CURRENT"?3:u==="RESET"?4:wt(39313,{state:u})}(e.targetChange.targetChangeType||"NO_CHANGE"),s=e.targetChange.targetIds||[],i=function(u,d){return u.useProto3Json?(St(d===void 0||typeof d=="string",58123),Gr.fromBase64String(d||"")):(St(d===void 0||d instanceof Buffer||d instanceof Uint8Array,16193),Gr.fromUint8Array(d||new Uint8Array))}(t,e.targetChange.resumeToken),o=e.targetChange.cause,l=o&&function(u){const d=u.code===void 0?De.UNKNOWN:mB(u.code);return new ot(d,u.message||"")}(o);n=new gB(r,s,i,l||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const s=Uu(t,r.document.name),i=Qs(r.document.updateTime),o=r.document.createTime?Qs(r.document.createTime):It.min(),l=new Ms({mapValue:{fields:r.document.fields}}),c=Cr.newFoundDocument(s,i,o,l),u=r.targetIds||[],d=r.removedTargetIds||[];n=new iv(u,d,c.key,c)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const s=Uu(t,r.document),i=r.readTime?Qs(r.readTime):It.min(),o=Cr.newNoDocument(s,i),l=r.removedTargetIds||[];n=new iv([],l,o.key,o)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const s=Uu(t,r.document),i=r.removedTargetIds||[];n=new iv([],i,s,null)}else{if(!("filter"in e))return wt(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:s=0,unchangedNames:i}=r,o=new ife(s,i),l=r.targetId;n=new pB(l,o)}}return n}function Iw(t,e){let n;if(e instanceof Mf)n={update:ZD(t,e.key,e.value)};else if(e instanceof hb)n={delete:Tw(t,e.key)};else if(e instanceof Sl)n={update:ZD(t,e.key,e.data),updateMask:bfe(e.fieldMask)};else{if(!(e instanceof fB))return wt(16599,{ft:e.type});n={verify:Tw(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(i,o){const l=o.transform;if(l instanceof ig)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(l instanceof hf)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:l.elements}};if(l instanceof ff)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:l.elements}};if(l instanceof mf)return{fieldPath:o.field.canonicalString(),increment:l.Re};throw wt(20930,{transform:o.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(s,i){return i.updateTime!==void 0?{updateTime:ffe(s,i.updateTime)}:i.exists!==void 0?{exists:i.exists}:wt(27497)}(t,e.precondition)),n}function uT(t,e){const n=e.currentDocument?function(i){return i.updateTime!==void 0?Js.updateTime(Qs(i.updateTime)):i.exists!==void 0?Js.exists(i.exists):Js.none()}(e.currentDocument):Js.none(),r=e.updateTransforms?e.updateTransforms.map(s=>function(o,l){let c=null;if("setToServerValue"in l)St(l.setToServerValue==="REQUEST_TIME",16630,{proto:l}),c=new ig;else if("appendMissingElements"in l){const d=l.appendMissingElements.values||[];c=new hf(d)}else if("removeAllFromArray"in l){const d=l.removeAllFromArray.values||[];c=new ff(d)}else"increment"in l?c=new mf(o,l.increment):wt(16584,{proto:l});const u=pr.fromServerFormat(l.fieldPath);return new uB(u,c)}(t,s)):[];if(e.update){e.update.name;const s=Uu(t,e.update.name),i=new Ms({mapValue:{fields:e.update.fields}});if(e.updateMask){const o=function(c){const u=c.fieldPaths||[];return new hi(u.map(d=>pr.fromServerFormat(d)))}(e.updateMask);return new Sl(s,i,o,n,r)}return new Mf(s,i,n,r)}if(e.delete){const s=Uu(t,e.delete);return new hb(s,n)}if(e.verify){const s=Uu(t,e.verify);return new fB(s,n)}return wt(1463,{proto:e})}function gfe(t,e){return t&&t.length>0?(St(e!==void 0,14353),t.map(n=>function(s,i){let o=s.updateTime?Qs(s.updateTime):Qs(i);return o.isEqual(It.min())&&(o=Qs(i)),new nfe(o,s.transformResults||[])}(n,e))):[]}function _B(t,e){return{documents:[vB(t,e.path)]}}function SB(t,e){const n={structuredQuery:{}},r=e.path;let s;e.collectionGroup!==null?(s=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(s=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=vB(t,s);const i=function(u){if(u.length!==0)return TB(jn.create(u,"and"))}(e.filters);i&&(n.structuredQuery.where=i);const o=function(u){if(u.length!==0)return u.map(d=>function(f){return{field:Jd(f.field),direction:xfe(f.dir)}}(d))}(e.orderBy);o&&(n.structuredQuery.orderBy=o);const l=aT(t,e.limit);return l!==null&&(n.structuredQuery.limit=l),e.startAt&&(n.structuredQuery.startAt=function(u){return{before:u.inclusive,values:u.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(u){return{before:!u.inclusive,values:u.position}}(e.endAt)),{gt:n,parent:s}}function CB(t){let e=wB(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let s=null;if(r>0){St(r===1,65062);const d=n.from[0];d.allDescendants?s=d.collectionId:e=e.child(d.collectionId)}let i=[];n.where&&(i=function(h){const f=EB(h);return f instanceof jn&&TN(f)?f.getFilters():[f]}(n.where));let o=[];n.orderBy&&(o=function(h){return h.map(f=>function(g){return new _w(Xd(g.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(g.direction))}(f))}(n.orderBy));let l=null;n.limit&&(l=function(h){let f;return f=typeof h=="object"?h.value:h,rb(f)?null:f}(n.limit));let c=null;n.startAt&&(c=function(h){const f=!!h.before,m=h.values||[];return new uf(m,f)}(n.startAt));let u=null;return n.endAt&&(u=function(h){const f=!h.before,m=h.values||[];return new uf(m,f)}(n.endAt)),Ghe(e,s,o,i,l,"F",c,u)}function yfe(t,e){const n=function(s){switch(s){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return wt(28987,{purpose:s})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function EB(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Xd(n.unaryFilter.field);return ln.create(r,"==",{doubleValue:NaN});case"IS_NULL":const s=Xd(n.unaryFilter.field);return ln.create(s,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const i=Xd(n.unaryFilter.field);return ln.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const o=Xd(n.unaryFilter.field);return ln.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return wt(61313);default:return wt(60726)}}(t):t.fieldFilter!==void 0?function(n){return ln.create(Xd(n.fieldFilter.field),function(s){switch(s){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return wt(58110);default:return wt(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return jn.create(n.compositeFilter.filters.map(r=>EB(r)),function(s){switch(s){case"AND":return"and";case"OR":return"or";default:return wt(1026)}}(n.compositeFilter.op))}(t):wt(30097,{filter:t})}function xfe(t){return cfe[t]}function vfe(t){return ufe[t]}function wfe(t){return dfe[t]}function Jd(t){return{fieldPath:t.canonicalString()}}function Xd(t){return pr.fromServerFormat(t.fieldPath)}function TB(t){return t instanceof ln?function(n){if(n.op==="=="){if(FD(n.value))return{unaryFilter:{field:Jd(n.field),op:"IS_NAN"}};if(LD(n.value))return{unaryFilter:{field:Jd(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(FD(n.value))return{unaryFilter:{field:Jd(n.field),op:"IS_NOT_NAN"}};if(LD(n.value))return{unaryFilter:{field:Jd(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Jd(n.field),op:vfe(n.op),value:n.value}}}(t):t instanceof jn?function(n){const r=n.getFilters().map(s=>TB(s));return r.length===1?r[0]:{compositeFilter:{op:wfe(n.op),filters:r}}}(t):wt(54877,{filter:t})}function bfe(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function IB(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ha{constructor(e,n,r,s,i=It.min(),o=It.min(),l=Gr.EMPTY_BYTE_STRING,c=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=s,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=l,this.expectedCount=c}withSequenceNumber(e){return new Ha(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Ha(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ha(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class NB{constructor(e){this.wt=e}}function _fe(t,e){let n;if(e.document)n=mfe(t.wt,e.document,!!e.hasCommittedMutations);else if(e.noDocument){const r=dt.fromSegments(e.noDocument.path),s=id(e.noDocument.readTime);n=Cr.newNoDocument(r,s),e.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!e.unknownDocument)return wt(56709);{const r=dt.fromSegments(e.unknownDocument.path),s=id(e.unknownDocument.version);n=Cr.newUnknownDocument(r,s)}}return e.readTime&&n.setReadTime(function(s){const i=new xr(s[0],s[1]);return It.fromTimestamp(i)}(e.readTime)),n}function eM(t,e){const n=e.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Nw(e.readTime),hasCommittedMutations:e.hasCommittedMutations};if(e.isFoundDocument())r.document=function(i,o){return{name:Tw(i,o.key),fields:o.data.value.mapValue.fields,updateTime:pf(i,o.version.toTimestamp()),createTime:pf(i,o.createTime.toTimestamp())}}(t.wt,e);else if(e.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:sd(e.version)};else{if(!e.isUnknownDocument())return wt(57904,{document:e});r.unknownDocument={path:n.path.toArray(),version:sd(e.version)}}return r}function Nw(t){const e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function sd(t){const e=t.toTimestamp();return{seconds:e.seconds,nanoseconds:e.nanoseconds}}function id(t){const e=new xr(t.seconds,t.nanoseconds);return It.fromTimestamp(e)}function vu(t,e){const n=(e.baseMutations||[]).map(i=>uT(t.wt,i));for(let i=0;i<e.mutations.length-1;++i){const o=e.mutations[i];if(i+1<e.mutations.length&&e.mutations[i+1].transform!==void 0){const l=e.mutations[i+1];o.updateTransforms=l.transform.fieldTransforms,e.mutations.splice(i+1,1),++i}}const r=e.mutations.map(i=>uT(t.wt,i)),s=xr.fromMillis(e.localWriteTimeMs);return new NN(e.batchId,s,n,r)}function Rm(t){const e=id(t.readTime),n=t.lastLimboFreeSnapshotVersion!==void 0?id(t.lastLimboFreeSnapshotVersion):It.min();let r;return r=function(i){return i.documents!==void 0}(t.query)?function(i){const o=i.documents.length;return St(o===1,1966,{count:o}),po(zg(wB(i.documents[0])))}(t.query):function(i){return po(CB(i))}(t.query),new Ha(r,t.targetId,"TargetPurposeListen",t.lastListenSequenceNumber,e,n,Gr.fromBase64String(t.resumeToken))}function PB(t,e){const n=sd(e.snapshotVersion),r=sd(e.lastLimboFreeSnapshotVersion);let s;s=Sw(e.target)?_B(t.wt,e.target):SB(t.wt,e.target).gt;const i=e.resumeToken.toBase64();return{targetId:e.targetId,canonicalId:rd(e.target),readTime:n,resumeToken:i,lastListenSequenceNumber:e.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:s}}function AB(t){const e=CB({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Ew(e,e.limit,"L"):e}function yS(t,e){return new AN(e.largestBatchId,uT(t.wt,e.overlayMutation))}function tM(t,e){const n=e.path.lastSegment();return[t,Ls(e.path.popLast()),n]}function nM(t,e,n,r){return{indexId:t,uid:e,sequenceNumber:n,readTime:sd(r.readTime),documentKey:Ls(r.documentKey.path),largestBatchId:r.largestBatchId}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sfe{getBundleMetadata(e,n){return rM(e).get(n).next(r=>{if(r)return function(i){return{id:i.bundleId,createTime:id(i.createTime),version:i.version}}(r)})}saveBundleMetadata(e,n){return rM(e).put(function(s){return{bundleId:s.id,createTime:sd(Qs(s.createTime)),version:s.version}}(n))}getNamedQuery(e,n){return sM(e).get(n).next(r=>{if(r)return function(i){return{name:i.name,query:AB(i.bundledQuery),readTime:id(i.readTime)}}(r)})}saveNamedQuery(e,n){return sM(e).put(function(s){return{name:s.name,readTime:sd(Qs(s.readTime)),bundledQuery:s.bundledQuery}}(n))}}function rM(t){return Qr(t,sb)}function sM(t){return Qr(t,ib)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mb{constructor(e,n){this.serializer=e,this.userId=n}static St(e,n){const r=n.uid||"";return new mb(e,r)}getOverlay(e,n){return cm(e).get(tM(this.userId,n)).next(r=>r?yS(this.serializer,r):null)}getOverlays(e,n){const r=da();return ve.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){const s=[];return r.forEach((i,o)=>{const l=new AN(n,o);s.push(this.bt(e,l))}),ve.waitFor(s)}removeOverlaysForBatchId(e,n,r){const s=new Set;n.forEach(o=>s.add(Ls(o.getCollectionPath())));const i=[];return s.forEach(o=>{const l=IDBKeyRange.bound([this.userId,o,r],[this.userId,o,r+1],!1,!0);i.push(cm(e).X(ZE,l))}),ve.waitFor(i)}getOverlaysForCollection(e,n,r){const s=da(),i=Ls(n),o=IDBKeyRange.bound([this.userId,i,r],[this.userId,i,Number.POSITIVE_INFINITY],!0);return cm(e).J(ZE,o).next(l=>{for(const c of l){const u=yS(this.serializer,c);s.set(u.getKey(),u)}return s})}getOverlaysForCollectionGroup(e,n,r,s){const i=da();let o;const l=IDBKeyRange.bound([this.userId,n,r],[this.userId,n,Number.POSITIVE_INFINITY],!0);return cm(e).te({index:A6,range:l},(c,u,d)=>{const h=yS(this.serializer,u);i.size()<s||h.largestBatchId===o?(i.set(h.getKey(),h),o=h.largestBatchId):d.done()}).next(()=>i)}bt(e,n){return cm(e).put(function(s,i,o){const[l,c,u]=tM(i,o.mutation.key);return{userId:i,collectionPath:c,documentId:u,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:Iw(s.wt,o.mutation)}}(this.serializer,this.userId,n))}}function cm(t){return Qr(t,ob)}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cfe{Dt(e){return Qr(e,bN)}getSessionToken(e){return this.Dt(e).get("sessionToken").next(n=>{const r=n==null?void 0:n.value;return r?Gr.fromUint8Array(r):Gr.EMPTY_BYTE_STRING})}setSessionToken(e,n){return this.Dt(e).put({name:"sessionToken",value:n.toUint8Array()})}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wu{constructor(){}vt(e,n){this.Ct(e,n),n.Ft()}Ct(e,n){if("nullValue"in e)this.Mt(n,5);else if("booleanValue"in e)this.Mt(n,10),n.xt(e.booleanValue?1:0);else if("integerValue"in e)this.Mt(n,15),n.xt(ar(e.integerValue));else if("doubleValue"in e){const r=ar(e.doubleValue);isNaN(r)?this.Mt(n,13):(this.Mt(n,15),Xp(r)?n.xt(0):n.xt(r))}else if("timestampValue"in e){let r=e.timestampValue;this.Mt(n,20),typeof r=="string"&&(r=dl(r)),n.Ot(`${r.seconds||""}`),n.xt(r.nanos||0)}else if("stringValue"in e)this.Nt(e.stringValue,n),this.Bt(n);else if("bytesValue"in e)this.Mt(n,30),n.Lt(hl(e.bytesValue)),this.Bt(n);else if("referenceValue"in e)this.kt(e.referenceValue,n);else if("geoPointValue"in e){const r=e.geoPointValue;this.Mt(n,45),n.xt(r.latitude||0),n.xt(r.longitude||0)}else"mapValue"in e?B6(e)?this.Mt(n,Number.MAX_SAFE_INTEGER):lb(e)?this.qt(e.mapValue,n):(this.Qt(e.mapValue,n),this.Bt(n)):"arrayValue"in e?(this.$t(e.arrayValue,n),this.Bt(n)):wt(19022,{Ut:e})}Nt(e,n){this.Mt(n,25),this.Kt(e,n)}Kt(e,n){n.Ot(e)}Qt(e,n){const r=e.fields||{};this.Mt(n,55);for(const s of Object.keys(r))this.Nt(s,n),this.Ct(r[s],n)}qt(e,n){var r,s;const i=e.fields||{};this.Mt(n,53);const o=lf,l=((s=(r=i[o].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.length)||0;this.Mt(n,15),n.xt(ar(l)),this.Nt(o,n),this.Ct(i[o],n)}$t(e,n){const r=e.values||[];this.Mt(n,50);for(const s of r)this.Ct(s,n)}kt(e,n){this.Mt(n,37),dt.fromName(e).path.forEach(r=>{this.Mt(n,60),this.Kt(r,n)})}Mt(e,n){e.xt(n)}Bt(e){e.xt(2)}}wu.Wt=new wu;/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law | agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES | CONDITIONS OF ANY KIND, either express | implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ld=255;function Efe(t){if(t===0)return 8;let e=0;return t>>4||(e+=4,t<<=4),t>>6||(e+=2,t<<=2),t>>7||(e+=1),e}function iM(t){const e=64-function(r){let s=0;for(let i=0;i<8;++i){const o=Efe(255&r[i]);if(s+=o,o!==8)break}return s}(t);return Math.ceil(e/8)}class Tfe{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Gt(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.zt(r.value),r=n.next();this.jt()}Ht(e){const n=e[Symbol.iterator]();let r=n.next();for(;!r.done;)this.Jt(r.value),r=n.next();this.Yt()}Zt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.zt(r);else if(r<2048)this.zt(960|r>>>6),this.zt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.zt(480|r>>>12),this.zt(128|63&r>>>6),this.zt(128|63&r);else{const s=n.codePointAt(0);this.zt(240|s>>>18),this.zt(128|63&s>>>12),this.zt(128|63&s>>>6),this.zt(128|63&s)}}this.jt()}Xt(e){for(const n of e){const r=n.charCodeAt(0);if(r<128)this.Jt(r);else if(r<2048)this.Jt(960|r>>>6),this.Jt(128|63&r);else if(n<"\uD800"||"\uDBFF"<n)this.Jt(480|r>>>12),this.Jt(128|63&r>>>6),this.Jt(128|63&r);else{const s=n.codePointAt(0);this.Jt(240|s>>>18),this.Jt(128|63&s>>>12),this.Jt(128|63&s>>>6),this.Jt(128|63&s)}}this.Yt()}en(e){const n=this.tn(e),r=iM(n);this.nn(1+r),this.buffer[this.position++]=255&r;for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=255&n[s]}rn(e){const n=this.tn(e),r=iM(n);this.nn(1+r),this.buffer[this.position++]=~(255&r);for(let s=n.length-r;s<n.length;++s)this.buffer[this.position++]=~(255&n[s])}sn(){this._n(Ld),this._n(255)}an(){this.un(Ld),this.un(255)}reset(){this.position=0}seed(e){this.nn(e.length),this.buffer.set(e,this.position),this.position+=e.length}cn(){return this.buffer.slice(0,this.position)}tn(e){const n=function(i){const o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,i,!1),new Uint8Array(o.buffer)}(e),r=!!(128&n[0]);n[0]^=r?255:128;for(let s=1;s<n.length;++s)n[s]^=r?255:0;return n}zt(e){const n=255&e;n===0?(this._n(0),this._n(255)):n===Ld?(this._n(Ld),this._n(0)):this._n(n)}Jt(e){const n=255&e;n===0?(this.un(0),this.un(255)):n===Ld?(this.un(Ld),this.un(0)):this.un(e)}jt(){this._n(0),this._n(1)}Yt(){this.un(0),this.un(1)}_n(e){this.nn(1),this.buffer[this.position++]=e}un(e){this.nn(1),this.buffer[this.position++]=~e}nn(e){const n=e+this.position;if(n<=this.buffer.length)return;let r=2*this.buffer.length;r<n&&(r=n);const s=new Uint8Array(r);s.set(this.buffer),this.buffer=s}}class Ife{constructor(e){this.ln=e}Lt(e){this.ln.Gt(e)}Ot(e){this.ln.Zt(e)}xt(e){this.ln.en(e)}Ft(){this.ln.sn()}}class Nfe{constructor(e){this.ln=e}Lt(e){this.ln.Ht(e)}Ot(e){this.ln.Xt(e)}xt(e){this.ln.rn(e)}Ft(){this.ln.an()}}class um{constructor(){this.ln=new Tfe,this.hn=new Ife(this.ln),this.Pn=new Nfe(this.ln)}seed(e){this.ln.seed(e)}Tn(e){return e===0?this.hn:this.Pn}cn(){return this.ln.cn()}reset(){this.ln.reset()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bu{constructor(e,n,r,s){this.In=e,this.En=n,this.dn=r,this.An=s}Rn(){const e=this.An.length,n=e===0||this.An[e-1]===255?e+1:e,r=new Uint8Array(n);return r.set(this.An,0),n!==e?r.set([0],this.An.length):++r[r.length-1],new bu(this.In,this.En,this.dn,r)}Vn(e,n,r){return{indexId:this.In,uid:e,arrayValue:ov(this.dn),directionalValue:ov(this.An),orderedDocumentKey:ov(n),documentKey:r.path.toArray()}}mn(e,n,r){const s=this.Vn(e,n,r);return[s.indexId,s.uid,s.arrayValue,s.directionalValue,s.orderedDocumentKey,s.documentKey]}}function Il(t,e){let n=t.In-e.In;return n!==0?n:(n=oM(t.dn,e.dn),n!==0?n:(n=oM(t.An,e.An),n!==0?n:dt.comparator(t.En,e.En)))}function oM(t,e){for(let n=0;n<t.length&&n<e.length;++n){const r=t[n]-e[n];if(r!==0)return r}return t.length-e.length}function ov(t){return C5()?function(n){let r="";for(let s=0;s<n.length;s++)r+=String.fromCharCode(n[s]);return r}(t):t}function aM(t){return typeof t!="string"?t:function(n){const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}(t)}class lM{constructor(e){this.fn=new Mn((n,r)=>pr.comparator(n.field,r.field)),this.collectionId=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment(),this.gn=e.orderBy,this.pn=[];for(const n of e.filters){const r=n;r.isInequality()?this.fn=this.fn.add(r):this.pn.push(r)}}get yn(){return this.fn.size>1}wn(e){if(St(e.collectionGroup===this.collectionId,49279),this.yn)return!1;const n=JE(e);if(n!==void 0&&!this.Sn(n))return!1;const r=du(e);let s=new Set,i=0,o=0;for(;i<r.length&&this.Sn(r[i]);++i)s=s.add(r[i].fieldPath.canonicalString());if(i===r.length)return!0;if(this.fn.size>0){const l=this.fn.getIterator().getNext();if(!s.has(l.field.canonicalString())){const c=r[i];if(!this.bn(l,c)||!this.Dn(this.gn[o++],c))return!1}++i}for(;i<r.length;++i){const l=r[i];if(o>=this.gn.length||!this.Dn(this.gn[o++],l))return!1}return!0}vn(){if(this.yn)return null;let e=new Mn(pr.comparator);const n=[];for(const r of this.pn)if(!r.field.isKeyField())if(r.op==="array-contains"||r.op==="array-contains-any")n.push(new Qx(r.field,2));else{if(e.has(r.field))continue;e=e.add(r.field),n.push(new Qx(r.field,0))}for(const r of this.gn)r.field.isKeyField()||e.has(r.field)||(e=e.add(r.field),n.push(new Qx(r.field,r.dir==="asc"?0:1)));return new yw(yw.UNKNOWN_ID,this.collectionId,n,Jp.empty())}Sn(e){for(const n of this.pn)if(this.bn(n,e))return!0;return!1}bn(e,n){if(e===void 0||!e.field.isEqual(n.fieldPath))return!1;const r=e.op==="array-contains"||e.op==="array-contains-any";return n.kind===2===r}Dn(e,n){return!!e.field.isEqual(n.fieldPath)&&(n.kind===0&&e.dir==="asc"||n.kind===1&&e.dir==="desc")}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kB(t){var e,n;if(St(t instanceof ln||t instanceof jn,20012),t instanceof ln){if(t instanceof X6){const s=((n=(e=t.value.arrayValue)===null||e===void 0?void 0:e.values)===null||n===void 0?void 0:n.map(i=>ln.create(t.field,"==",i)))||[];return jn.create(s,"or")}return t}const r=t.filters.map(s=>kB(s));return jn.create(r,t.op)}function Pfe(t){if(t.getFilters().length===0)return[];const e=fT(kB(t));return St(RB(e),7391),dT(e)||hT(e)?[e]:e.getFilters()}function dT(t){return t instanceof ln}function hT(t){return t instanceof jn&&TN(t)}function RB(t){return dT(t)||hT(t)||function(n){if(n instanceof jn&&rT(n)){for(const r of n.getFilters())if(!dT(r)&&!hT(r))return!1;return!0}return!1}(t)}function fT(t){if(St(t instanceof ln||t instanceof jn,34018),t instanceof ln)return t;if(t.filters.length===1)return fT(t.filters[0]);const e=t.filters.map(r=>fT(r));let n=jn.create(e,t.op);return n=Pw(n),RB(n)?n:(St(n instanceof jn,64498),St(df(n),40251),St(n.filters.length>1,57927),n.filters.reduce((r,s)=>jN(r,s)))}function jN(t,e){let n;return St(t instanceof ln||t instanceof jn,38388),St(e instanceof ln||e instanceof jn,25473),n=t instanceof ln?e instanceof ln?function(s,i){return jn.create([s,i],"and")}(t,e):cM(t,e):e instanceof ln?cM(e,t):function(s,i){if(St(s.filters.length>0&&i.filters.length>0,48005),df(s)&&df(i))return K6(s,i.getFilters());const o=rT(s)?s:i,l=rT(s)?i:s,c=o.filters.map(u=>jN(u,l));return jn.create(c,"or")}(t,e),Pw(n)}function cM(t,e){if(df(e))return K6(e,t.getFilters());{const n=e.filters.map(r=>jN(t,r));return jn.create(n,"or")}}function Pw(t){if(St(t instanceof ln||t instanceof jn,11850),t instanceof ln)return t;const e=t.getFilters();if(e.length===1)return Pw(e[0]);if(H6(t))return t;const n=e.map(s=>Pw(s)),r=[];return n.forEach(s=>{s instanceof ln?r.push(s):s instanceof jn&&(s.op===t.op?r.push(...s.filters):r.push(s))}),r.length===1?r[0]:jn.create(r,t.op)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Afe{constructor(){this.Cn=new DN}addToCollectionParentIndex(e,n){return this.Cn.add(n),ve.resolve()}getCollectionParents(e,n){return ve.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return ve.resolve()}deleteFieldIndex(e,n){return ve.resolve()}deleteAllFieldIndexes(e){return ve.resolve()}createTargetIndexes(e,n){return ve.resolve()}getDocumentsMatchingTarget(e,n){return ve.resolve(null)}getIndexType(e,n){return ve.resolve(0)}getFieldIndexes(e,n){return ve.resolve([])}getNextCollectionGroupToUpdate(e){return ve.resolve(null)}getMinOffset(e,n){return ve.resolve(Xi.min())}getMinOffsetFromCollectionGroup(e,n){return ve.resolve(Xi.min())}updateCollectionGroup(e,n,r){return ve.resolve()}updateIndexEntries(e,n){return ve.resolve()}}class DN{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n]||new Mn(En.comparator),i=!s.has(r);return this.index[n]=s.add(r),i}has(e){const n=e.lastSegment(),r=e.popLast(),s=this.index[n];return s&&s.has(r)}getEntries(e){return(this.index[e]||new Mn(En.comparator)).toArray()}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uM="IndexedDbIndexManager",tx=new Uint8Array(0);class kfe{constructor(e,n){this.databaseId=n,this.Fn=new DN,this.Mn=new _l(r=>rd(r),(r,s)=>Ug(r,s)),this.uid=e.uid||""}addToCollectionParentIndex(e,n){if(!this.Fn.has(n)){const r=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(()=>{this.Fn.add(n)});const i={collectionId:r,parent:Ls(s)};return dM(e).put(i)}return ve.resolve()}getCollectionParents(e,n){const r=[],s=IDBKeyRange.bound([n,""],[w6(n),""],!1,!0);return dM(e).J(s).next(i=>{for(const o of i){if(o.collectionId!==n)break;r.push(ua(o.parent))}return r})}addFieldIndex(e,n){const r=dm(e),s=function(l){return{indexId:l.indexId,collectionGroup:l.collectionGroup,fields:l.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(n);delete s.indexId;const i=r.add(s);if(n.indexState){const o=Od(e);return i.next(l=>{o.put(nM(l,this.uid,n.indexState.sequenceNumber,n.indexState.offset))})}return i.next()}deleteFieldIndex(e,n){const r=dm(e),s=Od(e),i=Fd(e);return r.delete(n.indexId).next(()=>s.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0))).next(()=>i.delete(IDBKeyRange.bound([n.indexId],[n.indexId+1],!1,!0)))}deleteAllFieldIndexes(e){const n=dm(e),r=Fd(e),s=Od(e);return n.X().next(()=>r.X()).next(()=>s.X())}createTargetIndexes(e,n){return ve.forEach(this.xn(n),r=>this.getIndexType(e,r).next(s=>{if(s===0||s===1){const i=new lM(r).vn();if(i!=null)return this.addFieldIndex(e,i)}}))}getDocumentsMatchingTarget(e,n){const r=Fd(e);let s=!0;const i=new Map;return ve.forEach(this.xn(n),o=>this.On(e,o).next(l=>{s&&(s=!!l),i.set(o,l)})).next(()=>{if(s){let o=Qt();const l=[];return ve.forEach(i,(c,u)=>{Ye(uM,`Using index ${function(C){return`id=${C.indexId}|cg=${C.collectionGroup}|f=${C.fields.map(T=>`${T.fieldPath}:${T.kind}`).join(",")}`}(c)} to execute ${rd(n)}`);const d=function(C,T){const R=JE(T);if(R===void 0)return null;for(const k of Cw(C,R.fieldPath))switch(k.op){case"array-contains-any":return k.value.arrayValue.values||[];case"array-contains":return[k.value]}return null}(u,c),h=function(C,T){const R=new Map;for(const k of du(T))for(const E of Cw(C,k.fieldPath))switch(E.op){case"==":case"in":R.set(k.fieldPath.canonicalString(),E.value);break;case"not-in":case"!=":return R.set(k.fieldPath.canonicalString(),E.value),Array.from(R.values())}return null}(u,c),f=function(C,T){const R=[];let k=!0;for(const E of du(T)){const I=E.kind===0?BD(C,E.fieldPath,C.startAt):zD(C,E.fieldPath,C.startAt);R.push(I.value),k&&(k=I.inclusive)}return new uf(R,k)}(u,c),m=function(C,T){const R=[];let k=!0;for(const E of du(T)){const I=E.kind===0?zD(C,E.fieldPath,C.endAt):BD(C,E.fieldPath,C.endAt);R.push(I.value),k&&(k=I.inclusive)}return new uf(R,k)}(u,c),g=this.Nn(c,u,f),x=this.Nn(c,u,m),w=this.Bn(c,u,h),v=this.Ln(c.indexId,d,g,f.inclusive,x,m.inclusive,w);return ve.forEach(v,_=>r.Z(_,n.limit).next(C=>{C.forEach(T=>{const R=dt.fromSegments(T.documentKey);o.has(R)||(o=o.add(R),l.push(R))})}))}).next(()=>l)}return ve.resolve(null)})}xn(e){let n=this.Mn.get(e);return n||(e.filters.length===0?n=[e]:n=Pfe(jn.create(e.filters,"and")).map(r=>iT(e.path,e.collectionGroup,e.orderBy,r.getFilters(),e.limit,e.startAt,e.endAt)),this.Mn.set(e,n),n)}Ln(e,n,r,s,i,o,l){const c=(n!=null?n.length:1)*Math.max(r.length,i.length),u=c/(n!=null?n.length:1),d=[];for(let h=0;h<c;++h){const f=n?this.kn(n[h/u]):tx,m=this.qn(e,f,r[h%u],s),g=this.Qn(e,f,i[h%u],o),x=l.map(w=>this.qn(e,f,w,!0));d.push(...this.createRange(m,g,x))}return d}qn(e,n,r,s){const i=new bu(e,dt.empty(),n,r);return s?i:i.Rn()}Qn(e,n,r,s){const i=new bu(e,dt.empty(),n,r);return s?i.Rn():i}On(e,n){const r=new lM(n),s=n.collectionGroup!=null?n.collectionGroup:n.path.lastSegment();return this.getFieldIndexes(e,s).next(i=>{let o=null;for(const l of i)r.wn(l)&&(!o||l.fields.length>o.fields.length)&&(o=l);return o})}getIndexType(e,n){let r=2;const s=this.xn(n);return ve.forEach(s,i=>this.On(e,i).next(o=>{o?r!==0&&o.fields.length<function(c){let u=new Mn(pr.comparator),d=!1;for(const h of c.filters)for(const f of h.getFlattenedFilters())f.field.isKeyField()||(f.op==="array-contains"||f.op==="array-contains-any"?d=!0:u=u.add(f.field));for(const h of c.orderBy)h.field.isKeyField()||(u=u.add(h.field));return u.size+(d?1:0)}(i)&&(r=1):r=0})).next(()=>function(o){return o.limit!==null}(n)&&s.length>1&&r===2?1:r)}$n(e,n){const r=new um;for(const s of du(e)){const i=n.data.field(s.fieldPath);if(i==null)return null;const o=r.Tn(s.kind);wu.Wt.vt(i,o)}return r.cn()}kn(e){const n=new um;return wu.Wt.vt(e,n.Tn(0)),n.cn()}Un(e,n){const r=new um;return wu.Wt.vt(rg(this.databaseId,n),r.Tn(function(i){const o=du(i);return o.length===0?0:o[o.length-1].kind}(e))),r.cn()}Bn(e,n,r){if(r===null)return[];let s=[];s.push(new um);let i=0;for(const o of du(e)){const l=r[i++];for(const c of s)if(this.Kn(n,o.fieldPath)&&sg(l))s=this.Wn(s,o,l);else{const u=c.Tn(o.kind);wu.Wt.vt(l,u)}}return this.Gn(s)}Nn(e,n,r){return this.Bn(e,n,r.position)}Gn(e){const n=[];for(let r=0;r<e.length;++r)n[r]=e[r].cn();return n}Wn(e,n,r){const s=[...e],i=[];for(const o of r.arrayValue.values||[])for(const l of s){const c=new um;c.seed(l.cn()),wu.Wt.vt(o,c.Tn(n.kind)),i.push(c)}return i}Kn(e,n){return!!e.filters.find(r=>r instanceof ln&&r.field.isEqual(n)&&(r.op==="in"||r.op==="not-in"))}getFieldIndexes(e,n){const r=dm(e),s=Od(e);return(n?r.J(QE,IDBKeyRange.bound(n,n)):r.J()).next(i=>{const o=[];return ve.forEach(i,l=>s.get([l.indexId,this.uid]).next(c=>{o.push(function(d,h){const f=h?new Jp(h.sequenceNumber,new Xi(id(h.readTime),new dt(ua(h.documentKey)),h.largestBatchId)):Jp.empty(),m=d.fields.map(([g,x])=>new Qx(pr.fromServerFormat(g),x));return new yw(d.indexId,d.collectionGroup,m,f)}(l,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next(n=>n.length===0?null:(n.sort((r,s)=>{const i=r.indexState.sequenceNumber-s.indexState.sequenceNumber;return i!==0?i:Vt(r.collectionGroup,s.collectionGroup)}),n[0].collectionGroup))}updateCollectionGroup(e,n,r){const s=dm(e),i=Od(e);return this.zn(e).next(o=>s.J(QE,IDBKeyRange.bound(n,n)).next(l=>ve.forEach(l,c=>i.put(nM(c.indexId,this.uid,o,r)))))}updateIndexEntries(e,n){const r=new Map;return ve.forEach(n,(s,i)=>{const o=r.get(s.collectionGroup);return(o?ve.resolve(o):this.getFieldIndexes(e,s.collectionGroup)).next(l=>(r.set(s.collectionGroup,l),ve.forEach(l,c=>this.jn(e,s,c).next(u=>{const d=this.Hn(i,c);return u.isEqual(d)?ve.resolve():this.Jn(e,i,c,u,d)}))))})}Yn(e,n,r,s){return Fd(e).put(s.Vn(this.uid,this.Un(r,n.key),n.key))}Zn(e,n,r,s){return Fd(e).delete(s.mn(this.uid,this.Un(r,n.key),n.key))}jn(e,n,r){const s=Fd(e);let i=new Mn(Il);return s.te({index:P6,range:IDBKeyRange.only([r.indexId,this.uid,ov(this.Un(r,n))])},(o,l)=>{i=i.add(new bu(r.indexId,n,aM(l.arrayValue),aM(l.directionalValue)))}).next(()=>i)}Hn(e,n){let r=new Mn(Il);const s=this.$n(n,e);if(s==null)return r;const i=JE(n);if(i!=null){const o=e.data.field(i.fieldPath);if(sg(o))for(const l of o.arrayValue.values||[])r=r.add(new bu(n.indexId,e.key,this.kn(l),s))}else r=r.add(new bu(n.indexId,e.key,tx,s));return r}Jn(e,n,r,s,i){Ye(uM,"Updating index entries for document '%s'",n.key);const o=[];return function(c,u,d,h,f){const m=c.getIterator(),g=u.getIterator();let x=Md(m),w=Md(g);for(;x||w;){let v=!1,_=!1;if(x&&w){const C=d(x,w);C<0?_=!0:C>0&&(v=!0)}else x!=null?_=!0:v=!0;v?(h(w),w=Md(g)):_?(f(x),x=Md(m)):(x=Md(m),w=Md(g))}}(s,i,Il,l=>{o.push(this.Yn(e,n,r,l))},l=>{o.push(this.Zn(e,n,r,l))}),ve.waitFor(o)}zn(e){let n=1;return Od(e).te({index:N6,reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(r,s,i)=>{i.done(),n=s.sequenceNumber+1}).next(()=>n)}createRange(e,n,r){r=r.sort((o,l)=>Il(o,l)).filter((o,l,c)=>!l||Il(o,c[l-1])!==0);const s=[];s.push(e);for(const o of r){const l=Il(o,e),c=Il(o,n);if(l===0)s[0]=e.Rn();else if(l>0&&c<0)s.push(o),s.push(o.Rn());else if(c>0)break}s.push(n);const i=[];for(let o=0;o<s.length;o+=2){if(this.Xn(s[o],s[o+1]))return[];const l=s[o].mn(this.uid,tx,dt.empty()),c=s[o+1].mn(this.uid,tx,dt.empty());i.push(IDBKeyRange.bound(l,c))}return i}Xn(e,n){return Il(e,n)>0}getMinOffsetFromCollectionGroup(e,n){return this.getFieldIndexes(e,n).next(hM)}getMinOffset(e,n){return ve.mapArray(this.xn(n),r=>this.On(e,r).next(s=>s||wt(44426))).next(hM)}}function dM(t){return Qr(t,eg)}function Fd(t){return Qr(t,op)}function dm(t){return Qr(t,wN)}function Od(t){return Qr(t,ip)}function hM(t){St(t.length!==0,28825);let e=t[0].indexState.offset,n=e.largestBatchId;for(let r=1;r<t.length;r++){const s=t[r].indexState.offset;yN(s,e)<0&&(e=s),n<s.largestBatchId&&(n=s.largestBatchId)}return new Xi(e.readTime,e.documentKey,n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fM={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},jB=41943040;class Rs{static withCacheSize(e){return new Rs(e,Rs.DEFAULT_COLLECTION_PERCENTILE,Rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DB(t,e,n){const r=t.store(Ro),s=t.store(rf),i=[],o=IDBKeyRange.only(n.batchId);let l=0;const c=r.te({range:o},(d,h,f)=>(l++,f.delete()));i.push(c.next(()=>{St(l===1,47070,{batchId:n.batchId})}));const u=[];for(const d of n.mutations){const h=E6(e,d.key.path,n.batchId);i.push(s.delete(h)),u.push(d.key)}return ve.waitFor(i).next(()=>u)}function Aw(t){if(!t)return 0;let e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw wt(14731);e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Rs.DEFAULT_COLLECTION_PERCENTILE=10,Rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Rs.DEFAULT=new Rs(jB,Rs.DEFAULT_COLLECTION_PERCENTILE,Rs.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Rs.DISABLED=new Rs(-1,0,0);class pb{constructor(e,n,r,s){this.userId=e,this.serializer=n,this.indexManager=r,this.referenceDelegate=s,this.er={}}static St(e,n,r,s){St(e.uid!=="",64387);const i=e.isAuthenticated()?e.uid:"";return new pb(i,n,r,s)}checkEmpty(e){let n=!0;const r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Nl(e).te({index:Ru,range:r},(s,i,o)=>{n=!1,o.done()}).next(()=>n)}addMutationBatch(e,n,r,s){const i=Qd(e),o=Nl(e);return o.add({}).next(l=>{St(typeof l=="number",49019);const c=new NN(l,n,r,s),u=function(m,g,x){const w=x.baseMutations.map(_=>Iw(m.wt,_)),v=x.mutations.map(_=>Iw(m.wt,_));return{userId:g,batchId:x.batchId,localWriteTimeMs:x.localWriteTime.toMillis(),baseMutations:w,mutations:v}}(this.serializer,this.userId,c),d=[];let h=new Mn((f,m)=>Vt(f.canonicalString(),m.canonicalString()));for(const f of s){const m=E6(this.userId,f.key.path,l);h=h.add(f.key.path.popLast()),d.push(o.put(u)),d.push(i.put(m,lhe))}return h.forEach(f=>{d.push(this.indexManager.addToCollectionParentIndex(e,f))}),e.addOnCommittedListener(()=>{this.er[l]=c.keys()}),ve.waitFor(d).next(()=>c)})}lookupMutationBatch(e,n){return Nl(e).get(n).next(r=>r?(St(r.userId===this.userId,48,"Unexpected user for mutation batch",{userId:r.userId,batchId:n}),vu(this.serializer,r)):null)}tr(e,n){return this.er[n]?ve.resolve(this.er[n]):this.lookupMutationBatch(e,n).next(r=>{if(r){const s=r.keys();return this.er[n]=s,s}return null})}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=IDBKeyRange.lowerBound([this.userId,r]);let i=null;return Nl(e).te({index:Ru,range:s},(o,l,c)=>{l.userId===this.userId&&(St(l.batchId>=r,47524,{nr:r}),i=vu(this.serializer,l)),c.done()}).next(()=>i)}getHighestUnacknowledgedBatchId(e){const n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let r=$u;return Nl(e).te({index:Ru,range:n,reverse:!0},(s,i,o)=>{r=i.batchId,o.done()}).next(()=>r)}getAllMutationBatches(e){const n=IDBKeyRange.bound([this.userId,$u],[this.userId,Number.POSITIVE_INFINITY]);return Nl(e).J(Ru,n).next(r=>r.map(s=>vu(this.serializer,s)))}getAllMutationBatchesAffectingDocumentKey(e,n){const r=Zx(this.userId,n.path),s=IDBKeyRange.lowerBound(r),i=[];return Qd(e).te({range:s},(o,l,c)=>{const[u,d,h]=o,f=ua(d);if(u===this.userId&&n.path.isEqual(f))return Nl(e).get(h).next(m=>{if(!m)throw wt(61480,{rr:o,batchId:h});St(m.userId===this.userId,10503,"Unexpected user for mutation batch",{userId:m.userId,batchId:h}),i.push(vu(this.serializer,m))});c.done()}).next(()=>i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Mn(Vt);const s=[];return n.forEach(i=>{const o=Zx(this.userId,i.path),l=IDBKeyRange.lowerBound(o),c=Qd(e).te({range:l},(u,d,h)=>{const[f,m,g]=u,x=ua(m);f===this.userId&&i.path.isEqual(x)?r=r.add(g):h.done()});s.push(c)}),ve.waitFor(s).next(()=>this.ir(e,r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1,i=Zx(this.userId,r),o=IDBKeyRange.lowerBound(i);let l=new Mn(Vt);return Qd(e).te({range:o},(c,u,d)=>{const[h,f,m]=c,g=ua(f);h===this.userId&&r.isPrefixOf(g)?g.length===s&&(l=l.add(m)):d.done()}).next(()=>this.ir(e,l))}ir(e,n){const r=[],s=[];return n.forEach(i=>{s.push(Nl(e).get(i).next(o=>{if(o===null)throw wt(35274,{batchId:i});St(o.userId===this.userId,9748,"Unexpected user for mutation batch",{userId:o.userId,batchId:i}),r.push(vu(this.serializer,o))}))}),ve.waitFor(s).next(()=>r)}removeMutationBatch(e,n){return DB(e.he,this.userId,n).next(r=>(e.addOnCommittedListener(()=>{this.sr(n.batchId)}),ve.forEach(r,s=>this.referenceDelegate.markPotentiallyOrphaned(e,s))))}sr(e){delete this.er[e]}performConsistencyCheck(e){return this.checkEmpty(e).next(n=>{if(!n)return ve.resolve();const r=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),s=[];return Qd(e).te({range:r},(i,o,l)=>{if(i[0]===this.userId){const c=ua(i[1]);s.push(c)}else l.done()}).next(()=>{St(s.length===0,56720,{_r:s.map(i=>i.canonicalString())})})})}containsKey(e,n){return MB(e,this.userId,n)}ar(e){return LB(e).get(this.userId).next(n=>n||{userId:this.userId,lastAcknowledgedBatchId:$u,lastStreamToken:""})}}function MB(t,e,n){const r=Zx(e,n.path),s=r[1],i=IDBKeyRange.lowerBound(r);let o=!1;return Qd(t).te({range:i,ee:!0},(l,c,u)=>{const[d,h,f]=l;d===e&&h===s&&(o=!0),u.done()}).next(()=>o)}function Nl(t){return Qr(t,Ro)}function Qd(t){return Qr(t,rf)}function LB(t){return Qr(t,Qp)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class od{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new od(0)}static lr(){return new od(-1)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rfe{constructor(e,n){this.referenceDelegate=e,this.serializer=n}allocateTargetId(e){return this.hr(e).next(n=>{const r=new od(n.highestTargetId);return n.highestTargetId=r.next(),this.Pr(e,n).next(()=>n.highestTargetId)})}getLastRemoteSnapshotVersion(e){return this.hr(e).next(n=>It.fromTimestamp(new xr(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(e){return this.hr(e).next(n=>n.highestListenSequenceNumber)}setTargetsMetadata(e,n,r){return this.hr(e).next(s=>(s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),this.Pr(e,s)))}addTargetData(e,n){return this.Tr(e,n).next(()=>this.hr(e).next(r=>(r.targetCount+=1,this.Ir(n,r),this.Pr(e,r))))}updateTargetData(e,n){return this.Tr(e,n)}removeTargetData(e,n){return this.removeMatchingKeysForTargetId(e,n.targetId).next(()=>$d(e).delete(n.targetId)).next(()=>this.hr(e)).next(r=>(St(r.targetCount>0,8065),r.targetCount-=1,this.Pr(e,r)))}removeTargets(e,n,r){let s=0;const i=[];return $d(e).te((o,l)=>{const c=Rm(l);c.sequenceNumber<=n&&r.get(c.targetId)===null&&(s++,i.push(this.removeTargetData(e,c)))}).next(()=>ve.waitFor(i)).next(()=>s)}forEachTarget(e,n){return $d(e).te((r,s)=>{const i=Rm(s);n(i)})}hr(e){return mM(e).get(ww).next(n=>(St(n!==null,2888),n))}Pr(e,n){return mM(e).put(ww,n)}Tr(e,n){return $d(e).put(PB(this.serializer,n))}Ir(e,n){let r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r}getTargetCount(e){return this.hr(e).next(n=>n.targetCount)}getTargetData(e,n){const r=rd(n),s=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]);let i=null;return $d(e).te({range:s,index:I6},(o,l,c)=>{const u=Rm(l);Ug(n,u.target)&&(i=u,c.done())}).next(()=>i)}addMatchingKeys(e,n,r){const s=[],i=ql(e);return n.forEach(o=>{const l=Ls(o.path);s.push(i.put({targetId:r,path:l})),s.push(this.referenceDelegate.addReference(e,r,o))}),ve.waitFor(s)}removeMatchingKeys(e,n,r){const s=ql(e);return ve.forEach(n,i=>{const o=Ls(i.path);return ve.waitFor([s.delete([r,o]),this.referenceDelegate.removeReference(e,r,i)])})}removeMatchingKeysForTargetId(e,n){const r=ql(e),s=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(s)}getMatchingKeysForTargetId(e,n){const r=IDBKeyRange.bound([n],[n+1],!1,!0),s=ql(e);let i=Qt();return s.te({range:r,ee:!0},(o,l,c)=>{const u=ua(o[1]),d=new dt(u);i=i.add(d)}).next(()=>i)}containsKey(e,n){const r=Ls(n.path),s=IDBKeyRange.bound([r],[w6(r)],!1,!0);let i=0;return ql(e).te({index:vN,ee:!0,range:s},([o,l],c,u)=>{o!==0&&(i++,u.done())}).next(()=>i>0)}Rt(e,n){return $d(e).get(n).next(r=>r?Rm(r):null)}}function $d(t){return Qr(t,sf)}function mM(t){return Qr(t,Vu)}function ql(t){return Qr(t,of)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pM="LruGarbageCollector",jfe=1048576;function gM([t,e],[n,r]){const s=Vt(t,n);return s===0?Vt(e,r):s}class Dfe{constructor(e){this.Er=e,this.buffer=new Mn(gM),this.dr=0}Ar(){return++this.dr}Rr(e){const n=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();gM(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class FB{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){Ye(pM,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Wc(n)?Ye(pM,"Ignoring IndexedDB error during garbage collection: ",n):await pd(n)}await this.mr(3e5)})}}class Mfe{constructor(e,n){this.gr=e,this.params=n}calculateTargetCount(e,n){return this.gr.pr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return ve.resolve(uo.le);const r=new Dfe(n);return this.gr.forEachTarget(e,s=>r.Rr(s.sequenceNumber)).next(()=>this.gr.yr(e,s=>r.Rr(s))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.gr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.gr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(Ye("LruGarbageCollector","Garbage collection skipped; disabled"),ve.resolve(fM)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(Ye("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),fM):this.wr(e,n))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,n){let r,s,i,o,l,c,u;const d=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(h=>(h>this.params.maximumSequenceNumbersToCollect?(Ye("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${h}`),s=this.params.maximumSequenceNumbersToCollect):s=h,o=Date.now(),this.nthSequenceNumber(e,s))).next(h=>(r=h,l=Date.now(),this.removeTargets(e,r,n))).next(h=>(i=h,c=Date.now(),this.removeOrphanedDocuments(e,r))).next(h=>(u=Date.now(),Kd()<=an.DEBUG&&Ye("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-d}ms
	Determined least recently used ${s} in `+(l-o)+`ms
	Removed ${i} targets in `+(c-l)+`ms
	Removed ${h} documents in `+(u-c)+`ms
Total Duration: ${u-d}ms`),ve.resolve({didRun:!0,sequenceNumbersCollected:s,targetsRemoved:i,documentsRemoved:h})))}}function OB(t,e){return new Mfe(t,e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lfe{constructor(e,n){this.db=e,this.garbageCollector=OB(this,n)}pr(e){const n=this.Sr(e);return this.db.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}forEachTarget(e,n){return this.db.getTargetCache().forEachTarget(e,n)}yr(e,n){return this.br(e,(r,s)=>n(s))}addReference(e,n,r){return nx(e,r)}removeReference(e,n,r){return nx(e,r)}removeTargets(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)}markPotentiallyOrphaned(e,n){return nx(e,n)}Dr(e,n){return function(s,i){let o=!1;return LB(s).ne(l=>MB(s,l,i).next(c=>(c&&(o=!0),ve.resolve(!c)))).next(()=>o)}(e,n)}removeOrphanedDocuments(e,n){const r=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[];let i=0;return this.br(e,(o,l)=>{if(l<=n){const c=this.Dr(e,o).next(u=>{if(!u)return i++,r.getEntry(e,o).next(()=>(r.removeEntry(o,It.min()),ql(e).delete(function(h){return[0,Ls(h.path)]}(o))))});s.push(c)}}).next(()=>ve.waitFor(s)).next(()=>r.apply(e)).next(()=>i)}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)}updateLimboDocument(e,n){return nx(e,n)}br(e,n){const r=ql(e);let s,i=uo.le;return r.te({index:vN},([o,l],{path:c,sequenceNumber:u})=>{o===0?(i!==uo.le&&n(new dt(ua(s)),i),i=u,s=c):i=uo.le}).next(()=>{i!==uo.le&&n(new dt(ua(s)),i)})}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function nx(t,e){return ql(t).put(function(r,s){return{targetId:0,path:Ls(r.path),sequenceNumber:s}}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $B{constructor(){this.changes=new _l(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Cr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?ve.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ffe{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,n,r){return iu(e).put(r)}removeEntry(e,n,r){return iu(e).delete(function(i,o){const l=i.path.toArray();return[l.slice(0,l.length-2),l[l.length-2],Nw(o),l[l.length-1]]}(n,r))}updateMetadata(e,n){return this.getMetadata(e).next(r=>(r.byteSize+=n,this.vr(e,r)))}getEntry(e,n){let r=Cr.newInvalidDocument(n);return iu(e).te({index:ev,range:IDBKeyRange.only(hm(n))},(s,i)=>{r=this.Cr(n,i)}).next(()=>r)}Fr(e,n){let r={size:0,document:Cr.newInvalidDocument(n)};return iu(e).te({index:ev,range:IDBKeyRange.only(hm(n))},(s,i)=>{r={document:this.Cr(n,i),size:Aw(i)}}).next(()=>r)}getEntries(e,n){let r=Gi();return this.Mr(e,n,(s,i)=>{const o=this.Cr(s,i);r=r.insert(s,o)}).next(()=>r)}Or(e,n){let r=Gi(),s=new ur(dt.comparator);return this.Mr(e,n,(i,o)=>{const l=this.Cr(i,o);r=r.insert(i,l),s=s.insert(i,Aw(o))}).next(()=>({documents:r,Nr:s}))}Mr(e,n,r){if(n.isEmpty())return ve.resolve();let s=new Mn(vM);n.forEach(c=>s=s.add(c));const i=IDBKeyRange.bound(hm(s.first()),hm(s.last())),o=s.getIterator();let l=o.getNext();return iu(e).te({index:ev,range:i},(c,u,d)=>{const h=dt.fromSegments([...u.prefixPath,u.collectionGroup,u.documentId]);for(;l&&vM(l,h)<0;)r(l,null),l=o.getNext();l&&l.isEqual(h)&&(r(l,u),l=o.hasNext()?o.getNext():null),l?d.H(hm(l)):d.done()}).next(()=>{for(;l;)r(l,null),l=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(e,n,r,s,i){const o=n.path,l=[o.popLast().toArray(),o.lastSegment(),Nw(r.readTime),r.documentKey.path.isEmpty()?"":r.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return iu(e).J(IDBKeyRange.bound(l,c,!0)).next(u=>{i==null||i.incrementDocumentReadCount(u.length);let d=Gi();for(const h of u){const f=this.Cr(dt.fromSegments(h.prefixPath.concat(h.collectionGroup,h.documentId)),h);f.isFoundDocument()&&(Gg(n,f)||s.has(f.key))&&(d=d.insert(f.key,f))}return d})}getAllFromCollectionGroup(e,n,r,s){let i=Gi();const o=xM(n,r),l=xM(n,Xi.max());return iu(e).te({index:T6,range:IDBKeyRange.bound(o,l,!0)},(c,u,d)=>{const h=this.Cr(dt.fromSegments(u.prefixPath.concat(u.collectionGroup,u.documentId)),u);i=i.insert(h.key,h),i.size===s&&d.done()}).next(()=>i)}newChangeBuffer(e){return new Ofe(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next(n=>n.byteSize)}getMetadata(e){return yM(e).get(XE).next(n=>(St(!!n,20021),n))}vr(e,n){return yM(e).put(XE,n)}Cr(e,n){if(n){const r=_fe(this.serializer,n);if(!(r.isNoDocument()&&r.version.isEqual(It.min())))return r}return Cr.newInvalidDocument(e)}}function VB(t){return new Ffe(t)}class Ofe extends $B{constructor(e,n){super(),this.Br=e,this.trackRemovals=n,this.Lr=new _l(r=>r.toString(),(r,s)=>r.isEqual(s))}applyChanges(e){const n=[];let r=0,s=new Mn((i,o)=>Vt(i.canonicalString(),o.canonicalString()));return this.changes.forEach((i,o)=>{const l=this.Lr.get(i);if(n.push(this.Br.removeEntry(e,i,l.readTime)),o.isValidDocument()){const c=eM(this.Br.serializer,o);s=s.add(i.path.popLast());const u=Aw(c);r+=u-l.size,n.push(this.Br.addEntry(e,i,c))}else if(r-=l.size,this.trackRemovals){const c=eM(this.Br.serializer,o.convertToNoDocument(It.min()));n.push(this.Br.addEntry(e,i,c))}}),s.forEach(i=>{n.push(this.Br.indexManager.addToCollectionParentIndex(e,i))}),n.push(this.Br.updateMetadata(e,r)),ve.waitFor(n)}getFromCache(e,n){return this.Br.Fr(e,n).next(r=>(this.Lr.set(n,{size:r.size,readTime:r.document.readTime}),r.document))}getAllFromCache(e,n){return this.Br.Or(e,n).next(({documents:r,Nr:s})=>(s.forEach((i,o)=>{this.Lr.set(i,{size:o,readTime:r.get(i).readTime})}),r))}}function yM(t){return Qr(t,Zp)}function iu(t){return Qr(t,vw)}function hm(t){const e=t.path.toArray();return[e.slice(0,e.length-2),e[e.length-2],e[e.length-1]]}function xM(t,e){const n=e.documentKey.path.toArray();return[t,Nw(e.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function vM(t,e){const n=t.path.toArray(),r=e.path.toArray();let s=0;for(let i=0;i<n.length-2&&i<r.length-2;++i)if(s=Vt(n[i],r[i]),s)return s;return s=Vt(n.length,r.length),s||(s=Vt(n[n.length-2],r[r.length-2]),s||Vt(n[n.length-1],r[r.length-1]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $fe{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UB{constructor(e,n,r,s){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=s}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(s=>(r=s,this.remoteDocumentCache.getEntry(e,n))).next(s=>(r!==null&&up(r.mutation,s,hi.empty(),xr.now()),s))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Qt()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Qt()){const s=da();return this.populateOverlays(e,s,n).next(()=>this.computeViews(e,n,s,r).next(i=>{let o=Am();return i.forEach((l,c)=>{o=o.insert(l,c.overlayedDocument)}),o}))}getOverlayedDocuments(e,n){const r=da();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Qt()))}populateOverlays(e,n,r){const s=[];return r.forEach(i=>{n.has(i)||s.push(i)}),this.documentOverlayCache.getOverlays(e,s).next(i=>{i.forEach((o,l)=>{n.set(o,l)})})}computeViews(e,n,r,s){let i=Gi();const o=cp(),l=function(){return cp()}();return n.forEach((c,u)=>{const d=r.get(u.key);s.has(u.key)&&(d===void 0||d.mutation instanceof Sl)?i=i.insert(u.key,u):d!==void 0?(o.set(u.key,d.mutation.getFieldMask()),up(d.mutation,u,d.mutation.getFieldMask(),xr.now())):o.set(u.key,hi.empty())}),this.recalculateAndSaveOverlays(e,i).next(c=>(c.forEach((u,d)=>o.set(u,d)),n.forEach((u,d)=>{var h;return l.set(u,new $fe(d,(h=o.get(u))!==null&&h!==void 0?h:null))}),l))}recalculateAndSaveOverlays(e,n){const r=cp();let s=new ur((o,l)=>o-l),i=Qt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(o=>{for(const l of o)l.keys().forEach(c=>{const u=n.get(c);if(u===null)return;let d=r.get(c)||hi.empty();d=l.applyToLocalView(u,d),r.set(c,d);const h=(s.get(l.batchId)||Qt()).add(c);s=s.insert(l.batchId,h)})}).next(()=>{const o=[],l=s.getReverseIterator();for(;l.hasNext();){const c=l.getNext(),u=c.key,d=c.value,h=rB();d.forEach(f=>{if(!i.has(f)){const m=dB(n.get(f),r.get(f));m!==null&&h.set(f,m),i=i.add(f)}}),o.push(this.documentOverlayCache.saveOverlays(e,u,h))}return ve.waitFor(o)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,s){return function(o){return dt.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Q6(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,s):this.getDocumentsMatchingCollectionQuery(e,n,r,s)}getNextDocuments(e,n,r,s){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,s).next(i=>{const o=s-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,s-i.size):ve.resolve(da());let l=Yp,c=i;return o.next(u=>ve.forEach(u,(d,h)=>(l<h.largestBatchId&&(l=h.largestBatchId),i.get(d)?ve.resolve():this.remoteDocumentCache.getEntry(e,d).next(f=>{c=c.insert(d,f)}))).next(()=>this.populateOverlays(e,u,i)).next(()=>this.computeViews(e,c,u,Qt())).next(d=>({batchId:l,changes:nB(d)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new dt(n)).next(r=>{let s=Am();return r.isFoundDocument()&&(s=s.insert(r.key,r)),s})}getDocumentsMatchingCollectionGroupQuery(e,n,r,s){const i=n.collectionGroup;let o=Am();return this.indexManager.getCollectionParents(e,i).next(l=>ve.forEach(l,c=>{const u=function(h,f){return new Bg(f,null,h.explicitOrderBy.slice(),h.filters.slice(),h.limit,h.limitType,h.startAt,h.endAt)}(n,c.child(i));return this.getDocumentsMatchingCollectionQuery(e,u,r,s).next(d=>{d.forEach((h,f)=>{o=o.insert(h,f)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(e,n,r,s){let i;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(o=>(i=o,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,i,s))).next(o=>{i.forEach((c,u)=>{const d=u.getKey();o.get(d)===null&&(o=o.insert(d,Cr.newInvalidDocument(d)))});let l=Am();return o.forEach((c,u)=>{const d=i.get(c);d!==void 0&&up(d.mutation,u,hi.empty(),xr.now()),Gg(n,u)&&(l=l.insert(c,u))}),l})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vfe{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,n){return ve.resolve(this.kr.get(n))}saveBundleMetadata(e,n){return this.kr.set(n.id,function(s){return{id:s.id,version:s.version,createTime:Qs(s.createTime)}}(n)),ve.resolve()}getNamedQuery(e,n){return ve.resolve(this.qr.get(n))}saveNamedQuery(e,n){return this.qr.set(n.name,function(s){return{name:s.name,query:AB(s.bundledQuery),readTime:Qs(s.readTime)}}(n)),ve.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ufe{constructor(){this.overlays=new ur(dt.comparator),this.Qr=new Map}getOverlay(e,n){return ve.resolve(this.overlays.get(n))}getOverlays(e,n){const r=da();return ve.forEach(n,s=>this.getOverlay(e,s).next(i=>{i!==null&&r.set(s,i)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((s,i)=>{this.bt(e,n,i)}),ve.resolve()}removeOverlaysForBatchId(e,n,r){const s=this.Qr.get(r);return s!==void 0&&(s.forEach(i=>this.overlays=this.overlays.remove(i)),this.Qr.delete(r)),ve.resolve()}getOverlaysForCollection(e,n,r){const s=da(),i=n.length+1,o=new dt(n.child("")),l=this.overlays.getIteratorFrom(o);for(;l.hasNext();){const c=l.getNext().value,u=c.getKey();if(!n.isPrefixOf(u.path))break;u.path.length===i&&c.largestBatchId>r&&s.set(c.getKey(),c)}return ve.resolve(s)}getOverlaysForCollectionGroup(e,n,r,s){let i=new ur((u,d)=>u-d);const o=this.overlays.getIterator();for(;o.hasNext();){const u=o.getNext().value;if(u.getKey().getCollectionGroup()===n&&u.largestBatchId>r){let d=i.get(u.largestBatchId);d===null&&(d=da(),i=i.insert(u.largestBatchId,d)),d.set(u.getKey(),u)}}const l=da(),c=i.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((u,d)=>l.set(u,d)),!(l.size()>=s)););return ve.resolve(l)}bt(e,n,r){const s=this.overlays.get(r.key);if(s!==null){const o=this.Qr.get(s.largestBatchId).delete(r.key);this.Qr.set(s.largestBatchId,o)}this.overlays=this.overlays.insert(r.key,new AN(n,r));let i=this.Qr.get(n);i===void 0&&(i=Qt(),this.Qr.set(n,i)),this.Qr.set(n,i.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bfe{constructor(){this.sessionToken=Gr.EMPTY_BYTE_STRING}getSessionToken(e){return ve.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,ve.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MN{constructor(){this.$r=new Mn(ss.Ur),this.Kr=new Mn(ss.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,n){const r=new ss(e,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.zr(new ss(e,n))}jr(e,n){e.forEach(r=>this.removeReference(r,n))}Hr(e){const n=new dt(new En([])),r=new ss(n,e),s=new ss(n,e+1),i=[];return this.Kr.forEachInRange([r,s],o=>{this.zr(o),i.push(o.key)}),i}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const n=new dt(new En([])),r=new ss(n,e),s=new ss(n,e+1);let i=Qt();return this.Kr.forEachInRange([r,s],o=>{i=i.add(o.key)}),i}containsKey(e){const n=new ss(e,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class ss{constructor(e,n){this.key=e,this.Zr=n}static Ur(e,n){return dt.comparator(e.key,n.key)||Vt(e.Zr,n.Zr)}static Wr(e,n){return Vt(e.Zr,n.Zr)||dt.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zfe{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new Mn(ss.Ur)}checkEmpty(e){return ve.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,s){const i=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const o=new NN(i,n,r,s);this.mutationQueue.push(o);for(const l of s)this.Xr=this.Xr.add(new ss(l.key,i)),this.indexManager.addToCollectionParentIndex(e,l.key.path.popLast());return ve.resolve(o)}lookupMutationBatch(e,n){return ve.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,s=this.ti(r),i=s<0?0:s;return ve.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return ve.resolve(this.mutationQueue.length===0?$u:this.nr-1)}getAllMutationBatches(e){return ve.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new ss(n,0),s=new ss(n,Number.POSITIVE_INFINITY),i=[];return this.Xr.forEachInRange([r,s],o=>{const l=this.ei(o.Zr);i.push(l)}),ve.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Mn(Vt);return n.forEach(s=>{const i=new ss(s,0),o=new ss(s,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([i,o],l=>{r=r.add(l.Zr)})}),ve.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,s=r.length+1;let i=r;dt.isDocumentKey(i)||(i=i.child(""));const o=new ss(new dt(i),0);let l=new Mn(Vt);return this.Xr.forEachWhile(c=>{const u=c.key.path;return!!r.isPrefixOf(u)&&(u.length===s&&(l=l.add(c.Zr)),!0)},o),ve.resolve(this.ni(l))}ni(e){const n=[];return e.forEach(r=>{const s=this.ei(r);s!==null&&n.push(s)}),n}removeMutationBatch(e,n){St(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return ve.forEach(n.mutations,s=>{const i=new ss(s.key,n.batchId);return r=r.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,n){const r=new ss(n,0),s=this.Xr.firstAfterOrEqual(r);return ve.resolve(n.isEqual(s&&s.key))}performConsistencyCheck(e){return this.mutationQueue.length,ve.resolve()}ri(e,n){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const n=this.ti(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gfe{constructor(e){this.ii=e,this.docs=function(){return new ur(dt.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,s=this.docs.get(r),i=s?s.size:0,o=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:o}),this.size+=o-i,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return ve.resolve(r?r.document.mutableCopy():Cr.newInvalidDocument(n))}getEntries(e,n){let r=Gi();return n.forEach(s=>{const i=this.docs.get(s);r=r.insert(s,i?i.document.mutableCopy():Cr.newInvalidDocument(s))}),ve.resolve(r)}getDocumentsMatchingQuery(e,n,r,s){let i=Gi();const o=n.path,l=new dt(o.child("__id-9223372036854775808__")),c=this.docs.getIteratorFrom(l);for(;c.hasNext();){const{key:u,value:{document:d}}=c.getNext();if(!o.isPrefixOf(u.path))break;u.path.length>o.length+1||yN(b6(d),r)<=0||(s.has(d.key)||Gg(n,d))&&(i=i.insert(d.key,d.mutableCopy()))}return ve.resolve(i)}getAllFromCollectionGroup(e,n,r,s){wt(9500)}si(e,n){return ve.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Wfe(this)}getSize(e){return ve.resolve(this.size)}}class Wfe extends $B{constructor(e){super(),this.Br=e}applyChanges(e){const n=[];return this.changes.forEach((r,s)=>{s.isValidDocument()?n.push(this.Br.addEntry(e,s)):this.Br.removeEntry(r)}),ve.waitFor(n)}getFromCache(e,n){return this.Br.getEntry(e,n)}getAllFromCache(e,n){return this.Br.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hfe{constructor(e){this.persistence=e,this.oi=new _l(n=>rd(n),Ug),this.lastRemoteSnapshotVersion=It.min(),this.highestTargetId=0,this._i=0,this.ai=new MN,this.targetCount=0,this.ui=od.cr()}forEachTarget(e,n){return this.oi.forEach((r,s)=>n(s)),ve.resolve()}getLastRemoteSnapshotVersion(e){return ve.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return ve.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),ve.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),ve.resolve()}Tr(e){this.oi.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ui=new od(n),this.highestTargetId=n),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,n){return this.Tr(n),this.targetCount+=1,ve.resolve()}updateTargetData(e,n){return this.Tr(n),ve.resolve()}removeTargetData(e,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,ve.resolve()}removeTargets(e,n,r){let s=0;const i=[];return this.oi.forEach((o,l)=>{l.sequenceNumber<=n&&r.get(l.targetId)===null&&(this.oi.delete(o),i.push(this.removeMatchingKeysForTargetId(e,l.targetId)),s++)}),ve.waitFor(i).next(()=>s)}getTargetCount(e){return ve.resolve(this.targetCount)}getTargetData(e,n){const r=this.oi.get(n)||null;return ve.resolve(r)}addMatchingKeys(e,n,r){return this.ai.Gr(n,r),ve.resolve()}removeMatchingKeys(e,n,r){this.ai.jr(n,r);const s=this.persistence.referenceDelegate,i=[];return s&&n.forEach(o=>{i.push(s.markPotentiallyOrphaned(e,o))}),ve.waitFor(i)}removeMatchingKeysForTargetId(e,n){return this.ai.Hr(n),ve.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ai.Yr(n);return ve.resolve(r)}containsKey(e,n){return ve.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LN{constructor(e,n){this.ci={},this.overlays={},this.li=new uo(0),this.hi=!1,this.hi=!0,this.Pi=new Bfe,this.referenceDelegate=e(this),this.Ti=new Hfe(this),this.indexManager=new Afe,this.remoteDocumentCache=function(s){return new Gfe(s)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new NB(n),this.Ei=new Vfe(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new Ufe,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ci[e.toKey()];return r||(r=new zfe(n,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,n,r){Ye("MemoryPersistence","Starting transaction:",e);const s=new qfe(this.li.next());return this.referenceDelegate.di(),r(s).next(i=>this.referenceDelegate.Ai(s).next(()=>i)).toPromise().then(i=>(s.raiseOnCommittedEvent(),i))}Ri(e,n){return ve.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,n)))}}class qfe extends S6{constructor(e){super(),this.currentSequenceNumber=e}}class gb{constructor(e){this.persistence=e,this.Vi=new MN,this.mi=null}static fi(e){return new gb(e)}get gi(){if(this.mi)return this.mi;throw wt(60996)}addReference(e,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),ve.resolve()}removeReference(e,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),ve.resolve()}markPotentiallyOrphaned(e,n){return this.gi.add(n.toString()),ve.resolve()}removeTarget(e,n){this.Vi.Hr(n.targetId).forEach(s=>this.gi.add(s.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(s=>{s.forEach(i=>this.gi.add(i.toString()))}).next(()=>r.removeTargetData(e,n))}di(){this.mi=new Set}Ai(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return ve.forEach(this.gi,r=>{const s=dt.fromPath(r);return this.pi(e,s).next(i=>{i||n.removeEntry(s,It.min())})}).next(()=>(this.mi=null,n.apply(e)))}updateLimboDocument(e,n){return this.pi(e,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(e){return 0}pi(e,n){return ve.or([()=>ve.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ri(e,n)])}}class kw{constructor(e,n){this.persistence=e,this.yi=new _l(r=>Ls(r.path),(r,s)=>r.isEqual(s)),this.garbageCollector=OB(this,n)}static fi(e,n){return new kw(e,n)}di(){}Ai(e){return ve.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}pr(e){const n=this.Sr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(s=>r+s))}Sr(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}yr(e,n){return ve.forEach(this.yi,(r,s)=>this.Dr(e,r,s).next(i=>i?ve.resolve():n(s)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const s=this.persistence.getRemoteDocumentCache(),i=s.newChangeBuffer();return s.si(e,o=>this.Dr(e,o,n).next(l=>{l||(r++,i.removeEntry(o,It.min()))})).next(()=>i.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.yi.set(n,e.currentSequenceNumber),ve.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),ve.resolve()}removeReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),ve.resolve()}updateLimboDocument(e,n){return this.yi.set(n,e.currentSequenceNumber),ve.resolve()}Ii(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=nv(e.data.value)),n}Dr(e,n,r){return ve.or([()=>this.persistence.Ri(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const s=this.yi.get(n);return ve.resolve(s!==void 0&&s>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kfe{constructor(e){this.serializer=e}q(e,n,r,s){const i=new nb("createOrUpgrade",n);r<1&&s>=1&&(function(c){c.createObjectStore(Vg)}(e),function(c){c.createObjectStore(Qp,{keyPath:ahe}),c.createObjectStore(Ro,{keyPath:AD,autoIncrement:!0}).createIndex(Ru,kD,{unique:!0}),c.createObjectStore(rf)}(e),wM(e),function(c){c.createObjectStore(hu)}(e));let o=ve.resolve();return r<3&&s>=3&&(r!==0&&(function(c){c.deleteObjectStore(of),c.deleteObjectStore(sf),c.deleteObjectStore(Vu)}(e),wM(e)),o=o.next(()=>function(c){const u=c.store(Vu),d={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:It.min().toTimestamp(),targetCount:0};return u.put(ww,d)}(i))),r<4&&s>=4&&(r!==0&&(o=o.next(()=>function(c,u){return u.store(Ro).J().next(h=>{c.deleteObjectStore(Ro),c.createObjectStore(Ro,{keyPath:AD,autoIncrement:!0}).createIndex(Ru,kD,{unique:!0});const f=u.store(Ro),m=h.map(g=>f.put(g));return ve.waitFor(m)})}(e,i))),o=o.next(()=>{(function(c){c.createObjectStore(af,{keyPath:ghe})})(e)})),r<5&&s>=5&&(o=o.next(()=>this.wi(i))),r<6&&s>=6&&(o=o.next(()=>(function(c){c.createObjectStore(Zp)}(e),this.Si(i)))),r<7&&s>=7&&(o=o.next(()=>this.bi(i))),r<8&&s>=8&&(o=o.next(()=>this.Di(e,i))),r<9&&s>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(e)})),r<10&&s>=10&&(o=o.next(()=>this.Ci(i))),r<11&&s>=11&&(o=o.next(()=>{(function(c){c.createObjectStore(sb,{keyPath:yhe})})(e),function(c){c.createObjectStore(ib,{keyPath:xhe})}(e)})),r<12&&s>=12&&(o=o.next(()=>{(function(c){const u=c.createObjectStore(ob,{keyPath:Ehe});u.createIndex(ZE,The,{unique:!1}),u.createIndex(A6,Ihe,{unique:!1})})(e)})),r<13&&s>=13&&(o=o.next(()=>function(c){const u=c.createObjectStore(vw,{keyPath:che});u.createIndex(ev,uhe),u.createIndex(T6,dhe)}(e)).next(()=>this.Fi(e,i)).next(()=>e.deleteObjectStore(hu))),r<14&&s>=14&&(o=o.next(()=>this.Mi(e,i))),r<15&&s>=15&&(o=o.next(()=>function(c){c.createObjectStore(wN,{keyPath:vhe,autoIncrement:!0}).createIndex(QE,whe,{unique:!1}),c.createObjectStore(ip,{keyPath:bhe}).createIndex(N6,_he,{unique:!1}),c.createObjectStore(op,{keyPath:She}).createIndex(P6,Che,{unique:!1})}(e))),r<16&&s>=16&&(o=o.next(()=>{n.objectStore(ip).clear()}).next(()=>{n.objectStore(op).clear()})),r<17&&s>=17&&(o=o.next(()=>{(function(c){c.createObjectStore(bN,{keyPath:Nhe})})(e)})),r<18&&s>=18&&C5()&&(o=o.next(()=>{n.objectStore(ip).clear()}).next(()=>{n.objectStore(op).clear()})),o}Si(e){let n=0;return e.store(hu).te((r,s)=>{n+=Aw(s)}).next(()=>{const r={byteSize:n};return e.store(Zp).put(XE,r)})}wi(e){const n=e.store(Qp),r=e.store(Ro);return n.J().next(s=>ve.forEach(s,i=>{const o=IDBKeyRange.bound([i.userId,$u],[i.userId,i.lastAcknowledgedBatchId]);return r.J(Ru,o).next(l=>ve.forEach(l,c=>{St(c.userId===i.userId,18650,"Cannot process batch from unexpected user",{batchId:c.batchId});const u=vu(this.serializer,c);return DB(e,i.userId,u).next(()=>{})}))}))}bi(e){const n=e.store(of),r=e.store(hu);return e.store(Vu).get(ww).next(s=>{const i=[];return r.te((o,l)=>{const c=new En(o),u=function(h){return[0,Ls(h)]}(c);i.push(n.get(u).next(d=>d?ve.resolve():(h=>n.put({targetId:0,path:Ls(h),sequenceNumber:s.highestListenSequenceNumber}))(c)))}).next(()=>ve.waitFor(i))})}Di(e,n){e.createObjectStore(eg,{keyPath:phe});const r=n.store(eg),s=new DN,i=o=>{if(s.add(o)){const l=o.lastSegment(),c=o.popLast();return r.put({collectionId:l,parent:Ls(c)})}};return n.store(hu).te({ee:!0},(o,l)=>{const c=new En(o);return i(c.popLast())}).next(()=>n.store(rf).te({ee:!0},([o,l,c],u)=>{const d=ua(l);return i(d.popLast())}))}Ci(e){const n=e.store(sf);return n.te((r,s)=>{const i=Rm(s),o=PB(this.serializer,i);return n.put(o)})}Fi(e,n){const r=n.store(hu),s=[];return r.te((i,o)=>{const l=n.store(vw),c=function(h){return h.document?new dt(En.fromString(h.document.name).popFirst(5)):h.noDocument?dt.fromSegments(h.noDocument.path):h.unknownDocument?dt.fromSegments(h.unknownDocument.path):wt(36783)}(o).path.toArray(),u={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};s.push(l.put(u))}).next(()=>ve.waitFor(s))}Mi(e,n){const r=n.store(Ro),s=VB(this.serializer),i=new LN(gb.fi,this.serializer.wt);return r.J().next(o=>{const l=new Map;return o.forEach(c=>{var u;let d=(u=l.get(c.userId))!==null&&u!==void 0?u:Qt();vu(this.serializer,c).keys().forEach(h=>d=d.add(h)),l.set(c.userId,d)}),ve.forEach(l,(c,u)=>{const d=new gs(u),h=mb.St(this.serializer,d),f=i.getIndexManager(d),m=pb.St(d,this.serializer,f,i.referenceDelegate);return new UB(s,m,h,f).recalculateAndSaveOverlaysForDocumentKeys(new eT(n,uo.le),c).next()})})}}function wM(t){t.createObjectStore(of,{keyPath:fhe}).createIndex(vN,mhe,{unique:!0}),t.createObjectStore(sf,{keyPath:"targetId"}).createIndex(I6,hhe,{unique:!0}),t.createObjectStore(Vu)}const Pl="IndexedDbPersistence",xS=18e5,vS=5e3,wS="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Yfe="main";class FN{constructor(e,n,r,s,i,o,l,c,u,d,h=18){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.xi=i,this.window=o,this.document=l,this.Oi=u,this.Ni=d,this.Bi=h,this.li=null,this.hi=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Li=null,this.inForeground=!1,this.ki=null,this.qi=null,this.Qi=Number.NEGATIVE_INFINITY,this.$i=f=>Promise.resolve(),!FN.C())throw new ot(De.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Lfe(this,s),this.Ui=n+Yfe,this.serializer=new NB(c),this.Ki=new hc(this.Ui,this.Bi,new Kfe(this.serializer)),this.Pi=new Cfe,this.Ti=new Rfe(this.referenceDelegate,this.serializer),this.remoteDocumentCache=VB(this.serializer),this.Ei=new Sfe,this.window&&this.window.localStorage?this.Wi=this.window.localStorage:(this.Wi=null,d===!1&&Ys(Pl,"LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.Gi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ot(De.FAILED_PRECONDITION,wS);return this.zi(),this.ji(),this.Hi(),this.runTransaction("getHighestListenSequenceNumber","readonly",e=>this.Ti.getHighestSequenceNumber(e))}).then(e=>{this.li=new uo(e,this.Oi)}).then(()=>{this.hi=!0}).catch(e=>(this.Ki&&this.Ki.close(),Promise.reject(e)))}Ji(e){return this.$i=async n=>{if(this.started)return e(n)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ki.U(async n=>{n.newVersion===null&&await e()})}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.xi.enqueueAndForget(async()=>{this.started&&await this.Gi()}))}Gi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",e=>rx(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.Yi(e).next(n=>{n||(this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)))})}).next(()=>this.Zi(e)).next(n=>this.isPrimary&&!n?this.Xi(e).next(()=>!1):!!n&&this.es(e).next(()=>!0))).catch(e=>{if(Wc(e))return Ye(Pl,"Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Ye(Pl,"Releasing owner lease after error during lease refresh",e),!1}).then(e=>{this.isPrimary!==e&&this.xi.enqueueRetryable(()=>this.$i(e)),this.isPrimary=e})}Yi(e){return fm(e).get(Dd).next(n=>ve.resolve(this.ts(n)))}ns(e){return rx(e).delete(this.clientId)}async rs(){if(this.isPrimary&&!this.ss(this.Qi,xS)){this.Qi=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",n=>{const r=Qr(n,af);return r.J().next(s=>{const i=this._s(s,xS),o=s.filter(l=>i.indexOf(l)===-1);return ve.forEach(o,l=>r.delete(l.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Wi)for(const n of e)this.Wi.removeItem(this.us(n.clientId))}}Hi(){this.qi=this.xi.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.Gi().then(()=>this.rs()).then(()=>this.Hi()))}ts(e){return!!e&&e.ownerId===this.clientId}Zi(e){return this.Ni?ve.resolve(!0):fm(e).get(Dd).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,vS)&&!this.cs(n.ownerId)){if(this.ts(n)&&this.networkEnabled)return!0;if(!this.ts(n)){if(!n.allowTabSynchronization)throw new ot(De.FAILED_PRECONDITION,wS);return!1}}return!(!this.networkEnabled||!this.inForeground)||rx(e).J().next(r=>this._s(r,vS).find(s=>{if(this.clientId!==s.clientId){const i=!this.networkEnabled&&s.networkEnabled,o=!this.inForeground&&s.inForeground,l=this.networkEnabled===s.networkEnabled;if(i||o&&l)return!0}return!1})===void 0)}).next(n=>(this.isPrimary!==n&&Ye(Pl,`Client ${n?"is":"is not"} eligible for a primary lease.`),n))}async shutdown(){this.hi=!1,this.ls(),this.qi&&(this.qi.cancel(),this.qi=null),this.hs(),this.Ps(),await this.Ki.runTransaction("shutdown","readwrite",[Vg,af],e=>{const n=new eT(e,uo.le);return this.Xi(n).next(()=>this.ns(n))}),this.Ki.close(),this.Ts()}_s(e,n){return e.filter(r=>this.ss(r.updateTimeMs,n)&&!this.cs(r.clientId))}Is(){return this.runTransaction("getActiveClients","readonly",e=>rx(e).J().next(n=>this._s(n,xS).map(r=>r.clientId)))}get started(){return this.hi}getGlobalsCache(){return this.Pi}getMutationQueue(e,n){return pb.St(e,this.serializer,n,this.referenceDelegate)}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new kfe(e,this.serializer.wt.databaseId)}getDocumentOverlayCache(e){return mb.St(this.serializer,e)}getBundleCache(){return this.Ei}runTransaction(e,n,r){Ye(Pl,"Starting transaction:",e);const s=n==="readonly"?"readonly":"readwrite",i=function(c){return c===18?khe:c===17?D6:c===16?Ahe:c===15?_N:c===14?j6:c===13?R6:c===12?Phe:c===11?k6:void wt(60245)}(this.Bi);let o;return this.Ki.runTransaction(e,s,i,l=>(o=new eT(l,this.li?this.li.next():uo.le),n==="readwrite-primary"?this.Yi(o).next(c=>!!c||this.Zi(o)).next(c=>{if(!c)throw Ys(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.xi.enqueueRetryable(()=>this.$i(!1)),new ot(De.FAILED_PRECONDITION,_6);return r(o)}).next(c=>this.es(o).next(()=>c)):this.Es(o).next(()=>r(o)))).then(l=>(o.raiseOnCommittedEvent(),l))}Es(e){return fm(e).get(Dd).next(n=>{if(n!==null&&this.ss(n.leaseTimestampMs,vS)&&!this.cs(n.ownerId)&&!this.ts(n)&&!(this.Ni||this.allowTabSynchronization&&n.allowTabSynchronization))throw new ot(De.FAILED_PRECONDITION,wS)})}es(e){const n={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return fm(e).put(Dd,n)}static C(){return hc.C()}Xi(e){const n=fm(e);return n.get(Dd).next(r=>this.ts(r)?(Ye(Pl,"Releasing primary lease."),n.delete(Dd)):ve.resolve())}ss(e,n){const r=Date.now();return!(e<r-n)&&(!(e>r)||(Ys(`Detected an update time that is in the future: ${e} > ${r}`),!1))}zi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.ki=()=>{this.xi.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.Gi()))},this.document.addEventListener("visibilitychange",this.ki),this.inForeground=this.document.visibilityState==="visible")}hs(){this.ki&&(this.document.removeEventListener("visibilitychange",this.ki),this.ki=null)}ji(){var e;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.Li=()=>{this.ls();const n=/(?:Version|Mobile)\/1[456]/;S5()&&(navigator.appVersion.match(n)||navigator.userAgent.match(n))&&this.xi.enterRestrictedMode(!0),this.xi.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Li))}Ps(){this.Li&&(this.window.removeEventListener("pagehide",this.Li),this.Li=null)}cs(e){var n;try{const r=((n=this.Wi)===null||n===void 0?void 0:n.getItem(this.us(e)))!==null;return Ye(Pl,`Client '${e}' ${r?"is":"is not"} zombied in LocalStorage`),r}catch(r){return Ys(Pl,"Failed to get zombied client id.",r),!1}}ls(){if(this.Wi)try{this.Wi.setItem(this.us(this.clientId),String(Date.now()))}catch(e){Ys("Failed to set zombie client id.",e)}}Ts(){if(this.Wi)try{this.Wi.removeItem(this.us(this.clientId))}catch{}}us(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function fm(t){return Qr(t,Vg)}function rx(t){return Qr(t,af)}function Jfe(t,e){let n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{constructor(e,n,r,s){this.targetId=e,this.fromCache=n,this.ds=r,this.As=s}static Rs(e,n){let r=Qt(),s=Qt();for(const i of n.docChanges)switch(i.type){case 0:r=r.add(i.doc.key);break;case 1:s=s.add(i.doc.key)}return new ON(e,n.fromCache,r,s)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xfe{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class BB{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return S5()?8:C6(Xr())>0?6:4}()}initialize(e,n){this.ys=e,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(e,n,r,s){const i={result:null};return this.ws(e,n).next(o=>{i.result=o}).next(()=>{if(!i.result)return this.Ss(e,n,s,r).next(o=>{i.result=o})}).next(()=>{if(i.result)return;const o=new Xfe;return this.bs(e,n,o).next(l=>{if(i.result=l,this.fs)return this.Ds(e,n,o,l.size)})}).next(()=>i.result)}Ds(e,n,r,s){return r.documentReadCount<this.gs?(Kd()<=an.DEBUG&&Ye("QueryEngine","SDK will not create cache indexes for query:",Yd(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),ve.resolve()):(Kd()<=an.DEBUG&&Ye("QueryEngine","Query:",Yd(n),"scans",r.documentReadCount,"local documents and returns",s,"documents as results."),r.documentReadCount>this.ps*s?(Kd()<=an.DEBUG&&Ye("QueryEngine","The SDK decides to create cache indexes for query:",Yd(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,po(n))):ve.resolve())}ws(e,n){if(GD(n))return ve.resolve(null);let r=po(n);return this.indexManager.getIndexType(e,r).next(s=>s===0?null:(n.limit!==null&&s===1&&(n=Ew(n,null,"F"),r=po(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{const o=Qt(...i);return this.ys.getDocuments(e,o).next(l=>this.indexManager.getMinOffset(e,r).next(c=>{const u=this.vs(n,l);return this.Cs(n,u,o,c.readTime)?this.ws(e,Ew(n,null,"F")):this.Fs(e,u,n,c)}))})))}Ss(e,n,r,s){return GD(n)||s.isEqual(It.min())?ve.resolve(null):this.ys.getDocuments(e,r).next(i=>{const o=this.vs(n,i);return this.Cs(n,o,r,s)?ve.resolve(null):(Kd()<=an.DEBUG&&Ye("QueryEngine","Re-using previous result from %s to execute query: %s",s.toString(),Yd(n)),this.Fs(e,o,n,ehe(s,Yp)).next(l=>l))})}vs(e,n){let r=new Mn(eB(e));return n.forEach((s,i)=>{Gg(e,i)&&(r=r.add(i))}),r}Cs(e,n,r,s){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const i=e.limitType==="F"?n.last():n.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(s)>0)}bs(e,n,r){return Kd()<=an.DEBUG&&Ye("QueryEngine","Using full collection scan to execute query:",Yd(n)),this.ys.getDocumentsMatchingQuery(e,n,Xi.min(),r)}Fs(e,n,r,s){return this.ys.getDocumentsMatchingQuery(e,r,s).next(i=>(n.forEach(o=>{i=i.insert(o.key,o)}),i))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $N="LocalStore",Qfe=3e8;class Zfe{constructor(e,n,r,s){this.persistence=e,this.Ms=n,this.serializer=s,this.xs=new ur(Vt),this.Os=new _l(i=>rd(i),Ug),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new UB(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.xs))}}function zB(t,e,n,r){return new Zfe(t,e,n,r)}async function GB(t,e){const n=qt(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let s;return n.mutationQueue.getAllMutationBatches(r).next(i=>(s=i,n.Ls(e),n.mutationQueue.getAllMutationBatches(r))).next(i=>{const o=[],l=[];let c=Qt();for(const u of s){o.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}for(const u of i){l.push(u.batchId);for(const d of u.mutations)c=c.add(d.key)}return n.localDocuments.getDocuments(r,c).next(u=>({ks:u,removedBatchIds:o,addedBatchIds:l}))})})}function eme(t,e){const n=qt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const s=e.batch.keys(),i=n.Bs.newChangeBuffer({trackRemovals:!0});return function(l,c,u,d){const h=u.batch,f=h.keys();let m=ve.resolve();return f.forEach(g=>{m=m.next(()=>d.getEntry(c,g)).next(x=>{const w=u.docVersions.get(g);St(w!==null,48541),x.version.compareTo(w)<0&&(h.applyToRemoteDocument(x,u),x.isValidDocument()&&(x.setReadTime(u.commitVersion),d.addEntry(x)))})}),m.next(()=>l.mutationQueue.removeMutationBatch(c,h))}(n,r,e,i).next(()=>i.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,s,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(l){let c=Qt();for(let u=0;u<l.mutationResults.length;++u)l.mutationResults[u].transformResults.length>0&&(c=c.add(l.batch.mutations[u].key));return c}(e))).next(()=>n.localDocuments.getDocuments(r,s))})}function WB(t){const e=qt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ti.getLastRemoteSnapshotVersion(n))}function tme(t,e){const n=qt(t),r=e.snapshotVersion;let s=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",i=>{const o=n.Bs.newChangeBuffer({trackRemovals:!0});s=n.xs;const l=[];e.targetChanges.forEach((d,h)=>{const f=s.get(h);if(!f)return;l.push(n.Ti.removeMatchingKeys(i,d.removedDocuments,h).next(()=>n.Ti.addMatchingKeys(i,d.addedDocuments,h)));let m=f.withSequenceNumber(i.currentSequenceNumber);e.targetMismatches.get(h)!==null?m=m.withResumeToken(Gr.EMPTY_BYTE_STRING,It.min()).withLastLimboFreeSnapshotVersion(It.min()):d.resumeToken.approximateByteSize()>0&&(m=m.withResumeToken(d.resumeToken,r)),s=s.insert(h,m),function(x,w,v){return x.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-x.snapshotVersion.toMicroseconds()>=Qfe?!0:v.addedDocuments.size+v.modifiedDocuments.size+v.removedDocuments.size>0}(f,m,d)&&l.push(n.Ti.updateTargetData(i,m))});let c=Gi(),u=Qt();if(e.documentUpdates.forEach(d=>{e.resolvedLimboDocuments.has(d)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(i,d))}),l.push(nme(i,o,e.documentUpdates).next(d=>{c=d.qs,u=d.Qs})),!r.isEqual(It.min())){const d=n.Ti.getLastRemoteSnapshotVersion(i).next(h=>n.Ti.setTargetsMetadata(i,i.currentSequenceNumber,r));l.push(d)}return ve.waitFor(l).next(()=>o.apply(i)).next(()=>n.localDocuments.getLocalViewOfDocuments(i,c,u)).next(()=>c)}).then(i=>(n.xs=s,i))}function nme(t,e,n){let r=Qt(),s=Qt();return n.forEach(i=>r=r.add(i)),e.getEntries(t,r).next(i=>{let o=Gi();return n.forEach((l,c)=>{const u=i.get(l);c.isFoundDocument()!==u.isFoundDocument()&&(s=s.add(l)),c.isNoDocument()&&c.version.isEqual(It.min())?(e.removeEntry(l,c.readTime),o=o.insert(l,c)):!u.isValidDocument()||c.version.compareTo(u.version)>0||c.version.compareTo(u.version)===0&&u.hasPendingWrites?(e.addEntry(c),o=o.insert(l,c)):Ye($N,"Ignoring outdated watch update for ",l,". Current version:",u.version," Watch version:",c.version)}),{qs:o,Qs:s}})}function rme(t,e){const n=qt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=$u),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function sme(t,e){const n=qt(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let s;return n.Ti.getTargetData(r,e).next(i=>i?(s=i,ve.resolve(s)):n.Ti.allocateTargetId(r).next(o=>(s=new Ha(e,o,"TargetPurposeListen",r.currentSequenceNumber),n.Ti.addTargetData(r,s).next(()=>s))))}).then(r=>{const s=n.xs.get(r.targetId);return(s===null||r.snapshotVersion.compareTo(s.snapshotVersion)>0)&&(n.xs=n.xs.insert(r.targetId,r),n.Os.set(e,r.targetId)),r})}async function mT(t,e,n){const r=qt(t),s=r.xs.get(e),i=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",i,o=>r.persistence.referenceDelegate.removeTarget(o,s))}catch(o){if(!Wc(o))throw o;Ye($N,`Failed to update sequence numbers for target ${e}: ${o}`)}r.xs=r.xs.remove(e),r.Os.delete(s.target)}function bM(t,e,n){const r=qt(t);let s=It.min(),i=Qt();return r.persistence.runTransaction("Execute query","readwrite",o=>function(c,u,d){const h=qt(c),f=h.Os.get(d);return f!==void 0?ve.resolve(h.xs.get(f)):h.Ti.getTargetData(u,d)}(r,o,po(e)).next(l=>{if(l)return s=l.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(o,l.targetId).next(c=>{i=c})}).next(()=>r.Ms.getDocumentsMatchingQuery(o,e,n?s:It.min(),n?i:Qt())).next(l=>(ime(r,Hhe(e),l),{documents:l,$s:i})))}function ime(t,e,n){let r=t.Ns.get(e)||It.min();n.forEach((s,i)=>{i.readTime.compareTo(r)>0&&(r=i.readTime)}),t.Ns.set(e,r)}class _M{constructor(){this.activeTargetIds=Qhe()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class HB{constructor(){this.xo=new _M,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,n,r){this.Oo[e]=n}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new _M,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ome{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const SM="ConnectivityMonitor";class CM{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){Ye(SM,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){Ye(SM,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let sx=null;function pT(){return sx===null?sx=function(){return 268435456+Math.round(2147483648*Math.random())}():sx++,"0x"+sx.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bS="RestConnection",ame={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class lme{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+e.host,this.Wo=`projects/${r}/databases/${s}`,this.Go=this.databaseId.database===bw?`project_id=${r}`:`project_id=${r}&database_id=${s}`}zo(e,n,r,s,i){const o=pT(),l=this.jo(e,n.toUriEncodedString());Ye(bS,`Sending RPC '${e}' ${o}:`,l,r);const c={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(c,s,i);const{host:u}=new URL(l),d=Uc(u);return this.Jo(e,l,c,r,d).then(h=>(Ye(bS,`Received RPC '${e}' ${o}: `,h),h),h=>{throw td(bS,`RPC '${e}' ${o} failed with error: `,h,"url: ",l,"request:",r),h})}Yo(e,n,r,s,i,o){return this.zo(e,n,r,s,i)}Ho(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Df}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((s,i)=>e[i]=s),r&&r.headers.forEach((s,i)=>e[i]=s)}jo(e,n){const r=ame[e];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cme{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ps="WebChannelConnection";class ume extends lme{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,s,i){const o=pT();return new Promise((l,c)=>{const u=new d6;u.setWithCredentials(!0),u.listenOnce(h6.COMPLETE,()=>{try{switch(u.getLastErrorCode()){case Xx.NO_ERROR:const h=u.getResponseJson();Ye(Ps,`XHR for RPC '${e}' ${o} received:`,JSON.stringify(h)),l(h);break;case Xx.TIMEOUT:Ye(Ps,`RPC '${e}' ${o} timed out`),c(new ot(De.DEADLINE_EXCEEDED,"Request time out"));break;case Xx.HTTP_ERROR:const f=u.getStatus();if(Ye(Ps,`RPC '${e}' ${o} failed with status:`,f,"response text:",u.getResponseText()),f>0){let m=u.getResponseJson();Array.isArray(m)&&(m=m[0]);const g=m==null?void 0:m.error;if(g&&g.status&&g.message){const x=function(v){const _=v.toLowerCase().replace(/_/g,"-");return Object.values(De).indexOf(_)>=0?_:De.UNKNOWN}(g.status);c(new ot(x,g.message))}else c(new ot(De.UNKNOWN,"Server responded with status "+u.getStatus()))}else c(new ot(De.UNAVAILABLE,"Connection failed."));break;default:wt(9055,{l_:e,streamId:o,h_:u.getLastErrorCode(),P_:u.getLastError()})}}finally{Ye(Ps,`RPC '${e}' ${o} completed.`)}});const d=JSON.stringify(s);Ye(Ps,`RPC '${e}' ${o} sending request:`,s),u.send(n,"POST",d,r,15)})}T_(e,n,r){const s=pT(),i=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],o=p6(),l=m6(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},u=this.longPollingOptions.timeoutSeconds;u!==void 0&&(c.longPollingTimeout=Math.round(1e3*u)),this.useFetchStreams&&(c.useFetchStreams=!0),this.Ho(c.initMessageHeaders,n,r),c.encodeInitMessageHeaders=!0;const d=i.join("");Ye(Ps,`Creating RPC '${e}' stream ${s}: ${d}`,c);const h=o.createWebChannel(d,c);let f=!1,m=!1;const g=new cme({Zo:w=>{m?Ye(Ps,`Not sending because RPC '${e}' stream ${s} is closed:`,w):(f||(Ye(Ps,`Opening RPC '${e}' stream ${s} transport.`),h.open(),f=!0),Ye(Ps,`RPC '${e}' stream ${s} sending:`,w),h.send(w))},Xo:()=>h.close()}),x=(w,v,_)=>{w.listen(v,C=>{try{_(C)}catch(T){setTimeout(()=>{throw T},0)}})};return x(h,Pm.EventType.OPEN,()=>{m||(Ye(Ps,`RPC '${e}' stream ${s} transport opened.`),g.__())}),x(h,Pm.EventType.CLOSE,()=>{m||(m=!0,Ye(Ps,`RPC '${e}' stream ${s} transport closed`),g.u_())}),x(h,Pm.EventType.ERROR,w=>{m||(m=!0,td(Ps,`RPC '${e}' stream ${s} transport errored. Name:`,w.name,"Message:",w.message),g.u_(new ot(De.UNAVAILABLE,"The operation could not be completed")))}),x(h,Pm.EventType.MESSAGE,w=>{var v;if(!m){const _=w.data[0];St(!!_,16349);const C=_,T=(C==null?void 0:C.error)||((v=C[0])===null||v===void 0?void 0:v.error);if(T){Ye(Ps,`RPC '${e}' stream ${s} received error:`,T);const R=T.status;let k=function(P){const A=Or[P];if(A!==void 0)return mB(A)}(R),E=T.message;k===void 0&&(k=De.INTERNAL,E="Unknown error status: "+R+" with message "+T.message),m=!0,g.u_(new ot(k,E)),h.close()}else Ye(Ps,`RPC '${e}' stream ${s} received:`,_),g.c_(_)}}),x(l,f6.STAT_EVENT,w=>{w.stat===KE.PROXY?Ye(Ps,`RPC '${e}' stream ${s} detected buffering proxy`):w.stat===KE.NOPROXY&&Ye(Ps,`RPC '${e}' stream ${s} detected no buffering proxy`)}),setTimeout(()=>{g.a_()},0),g}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dme(){return typeof window<"u"?window:null}function av(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yb(t){return new hfe(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qB{constructor(e,n,r=1e3,s=1.5,i=6e4){this.xi=e,this.timerId=n,this.I_=r,this.E_=s,this.d_=i,this.A_=0,this.R_=null,this.V_=Date.now(),this.reset()}reset(){this.A_=0}m_(){this.A_=this.d_}f_(e){this.cancel();const n=Math.floor(this.A_+this.g_()),r=Math.max(0,Date.now()-this.V_),s=Math.max(0,n-r);s>0&&Ye("ExponentialBackoff",`Backing off for ${s} ms (base delay: ${this.A_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.R_=this.xi.enqueueAfterDelay(this.timerId,s,()=>(this.V_=Date.now(),e())),this.A_*=this.E_,this.A_<this.I_&&(this.A_=this.I_),this.A_>this.d_&&(this.A_=this.d_)}p_(){this.R_!==null&&(this.R_.skipDelay(),this.R_=null)}cancel(){this.R_!==null&&(this.R_.cancel(),this.R_=null)}g_(){return(Math.random()-.5)*this.A_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const EM="PersistentStream";class KB{constructor(e,n,r,s,i,o,l,c){this.xi=e,this.y_=r,this.w_=s,this.connection=i,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=l,this.listener=c,this.state=0,this.S_=0,this.b_=null,this.D_=null,this.stream=null,this.v_=0,this.C_=new qB(e,n)}F_(){return this.state===1||this.state===5||this.M_()}M_(){return this.state===2||this.state===3}start(){this.v_=0,this.state!==4?this.auth():this.x_()}async stop(){this.F_()&&await this.close(0)}O_(){this.state=0,this.C_.reset()}N_(){this.M_()&&this.b_===null&&(this.b_=this.xi.enqueueAfterDelay(this.y_,6e4,()=>this.B_()))}L_(e){this.k_(),this.stream.send(e)}async B_(){if(this.M_())return this.close(0)}k_(){this.b_&&(this.b_.cancel(),this.b_=null)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}async close(e,n){this.k_(),this.q_(),this.C_.cancel(),this.S_++,e!==4?this.C_.reset():n&&n.code===De.RESOURCE_EXHAUSTED?(Ys(n.toString()),Ys("Using maximum backoff delay to prevent overloading the backend."),this.C_.m_()):n&&n.code===De.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.Q_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(n)}Q_(){}auth(){this.state=1;const e=this.U_(this.S_),n=this.S_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,s])=>{this.S_===n&&this.K_(r,s)},r=>{e(()=>{const s=new ot(De.UNKNOWN,"Fetching auth token failed: "+r.message);return this.W_(s)})})}K_(e,n){const r=this.U_(this.S_);this.stream=this.G_(e,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.D_=this.xi.enqueueAfterDelay(this.w_,1e4,()=>(this.M_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(s=>{r(()=>this.W_(s))}),this.stream.onMessage(s=>{r(()=>++this.v_==1?this.z_(s):this.onNext(s))})}x_(){this.state=5,this.C_.f_(async()=>{this.state=0,this.start()})}W_(e){return Ye(EM,`close with error: ${e}`),this.stream=null,this.close(4,e)}U_(e){return n=>{this.xi.enqueueAndForget(()=>this.S_===e?n():(Ye(EM,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class hme extends KB{constructor(e,n,r,s,i,o){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}G_(e,n){return this.connection.T_("Listen",e,n)}z_(e){return this.onNext(e)}onNext(e){this.C_.reset();const n=pfe(this.serializer,e),r=function(i){if(!("targetChange"in i))return It.min();const o=i.targetChange;return o.targetIds&&o.targetIds.length?It.min():o.readTime?Qs(o.readTime):It.min()}(e);return this.listener.j_(n,r)}H_(e){const n={};n.database=cT(this.serializer),n.addTarget=function(i,o){let l;const c=o.target;if(l=Sw(c)?{documents:_B(i,c)}:{query:SB(i,c).gt},l.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){l.resumeToken=yB(i,o.resumeToken);const u=aT(i,o.expectedCount);u!==null&&(l.expectedCount=u)}else if(o.snapshotVersion.compareTo(It.min())>0){l.readTime=pf(i,o.snapshotVersion.toTimestamp());const u=aT(i,o.expectedCount);u!==null&&(l.expectedCount=u)}return l}(this.serializer,e);const r=yfe(this.serializer,e);r&&(n.labels=r),this.L_(n)}J_(e){const n={};n.database=cT(this.serializer),n.removeTarget=e,this.L_(n)}}class fme extends KB{constructor(e,n,r,s,i,o){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,s,o),this.serializer=i}get Y_(){return this.v_>0}start(){this.lastStreamToken=void 0,super.start()}Q_(){this.Y_&&this.Z_([])}G_(e,n){return this.connection.T_("Write",e,n)}z_(e){return St(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,St(!e.writeResults||e.writeResults.length===0,55816),this.listener.X_()}onNext(e){St(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.C_.reset();const n=gfe(e.writeResults,e.commitTime),r=Qs(e.commitTime);return this.listener.ea(r,n)}ta(){const e={};e.database=cT(this.serializer),this.L_(e)}Z_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Iw(this.serializer,r))};this.L_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mme{}class pme extends mme{constructor(e,n,r,s){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=s,this.na=!1}ra(){if(this.na)throw new ot(De.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,n,r,s){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([i,o])=>this.connection.zo(e,lT(n,r),s,i,o)).catch(i=>{throw i.name==="FirebaseError"?(i.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),i):new ot(De.UNKNOWN,i.toString())})}Yo(e,n,r,s,i){return this.ra(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,l])=>this.connection.Yo(e,lT(n,r),s,o,l,i)).catch(o=>{throw o.name==="FirebaseError"?(o.code===De.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ot(De.UNKNOWN,o.toString())})}terminate(){this.na=!0,this.connection.terminate()}}class gme{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.ia=0,this.sa=null,this.oa=!0}_a(){this.ia===0&&(this.aa("Unknown"),this.sa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.sa=null,this.ua("Backend didn't respond within 10 seconds."),this.aa("Offline"),Promise.resolve())))}ca(e){this.state==="Online"?this.aa("Unknown"):(this.ia++,this.ia>=1&&(this.la(),this.ua(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.aa("Offline")))}set(e){this.la(),this.ia=0,e==="Online"&&(this.oa=!1),this.aa(e)}aa(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ua(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.oa?(Ys(n),this.oa=!1):Ye("OnlineStateTracker",n)}la(){this.sa!==null&&(this.sa.cancel(),this.sa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ad="RemoteStore";class yme{constructor(e,n,r,s,i){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.ha=[],this.Pa=new Map,this.Ta=new Set,this.Ia=[],this.Ea=i,this.Ea.No(o=>{r.enqueueAndForget(async()=>{gd(this)&&(Ye(ad,"Restarting streams for network reachability change."),await async function(c){const u=qt(c);u.Ta.add(4),await Hg(u),u.da.set("Unknown"),u.Ta.delete(4),await xb(u)}(this))})}),this.da=new gme(r,s)}}async function xb(t){if(gd(t))for(const e of t.Ia)await e(!0)}async function Hg(t){for(const e of t.Ia)await e(!1)}function YB(t,e){const n=qt(t);n.Pa.has(e.targetId)||(n.Pa.set(e.targetId,e),zN(n)?BN(n):Lf(n).M_()&&UN(n,e))}function VN(t,e){const n=qt(t),r=Lf(n);n.Pa.delete(e),r.M_()&&JB(n,e),n.Pa.size===0&&(r.M_()?r.N_():gd(n)&&n.da.set("Unknown"))}function UN(t,e){if(t.Aa.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(It.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}Lf(t).H_(e)}function JB(t,e){t.Aa.Ke(e),Lf(t).J_(e)}function BN(t){t.Aa=new lfe({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Pa.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),Lf(t).start(),t.da._a()}function zN(t){return gd(t)&&!Lf(t).F_()&&t.Pa.size>0}function gd(t){return qt(t).Ta.size===0}function XB(t){t.Aa=void 0}async function xme(t){t.da.set("Online")}async function vme(t){t.Pa.forEach((e,n)=>{UN(t,e)})}async function wme(t,e){XB(t),zN(t)?(t.da.ca(e),BN(t)):t.da.set("Unknown")}async function bme(t,e,n){if(t.da.set("Online"),e instanceof gB&&e.state===2&&e.cause)try{await async function(s,i){const o=i.cause;for(const l of i.targetIds)s.Pa.has(l)&&(await s.remoteSyncer.rejectListen(l,o),s.Pa.delete(l),s.Aa.removeTarget(l))}(t,e)}catch(r){Ye(ad,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await Rw(t,r)}else if(e instanceof iv?t.Aa.Xe(e):e instanceof pB?t.Aa.ot(e):t.Aa.nt(e),!n.isEqual(It.min()))try{const r=await WB(t.localStore);n.compareTo(r)>=0&&await function(i,o){const l=i.Aa.It(o);return l.targetChanges.forEach((c,u)=>{if(c.resumeToken.approximateByteSize()>0){const d=i.Pa.get(u);d&&i.Pa.set(u,d.withResumeToken(c.resumeToken,o))}}),l.targetMismatches.forEach((c,u)=>{const d=i.Pa.get(c);if(!d)return;i.Pa.set(c,d.withResumeToken(Gr.EMPTY_BYTE_STRING,d.snapshotVersion)),JB(i,c);const h=new Ha(d.target,c,u,d.sequenceNumber);UN(i,h)}),i.remoteSyncer.applyRemoteEvent(l)}(t,n)}catch(r){Ye(ad,"Failed to raise snapshot:",r),await Rw(t,r)}}async function Rw(t,e,n){if(!Wc(e))throw e;t.Ta.add(1),await Hg(t),t.da.set("Offline"),n||(n=()=>WB(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{Ye(ad,"Retrying IndexedDB access"),await n(),t.Ta.delete(1),await xb(t)})}function QB(t,e){return e().catch(n=>Rw(t,n,e))}async function qg(t){const e=qt(t),n=Tc(e);let r=e.ha.length>0?e.ha[e.ha.length-1].batchId:$u;for(;_me(e);)try{const s=await rme(e.localStore,r);if(s===null){e.ha.length===0&&n.N_();break}r=s.batchId,Sme(e,s)}catch(s){await Rw(e,s)}ZB(e)&&ez(e)}function _me(t){return gd(t)&&t.ha.length<10}function Sme(t,e){t.ha.push(e);const n=Tc(t);n.M_()&&n.Y_&&n.Z_(e.mutations)}function ZB(t){return gd(t)&&!Tc(t).F_()&&t.ha.length>0}function ez(t){Tc(t).start()}async function Cme(t){Tc(t).ta()}async function Eme(t){const e=Tc(t);for(const n of t.ha)e.Z_(n.mutations)}async function Tme(t,e,n){const r=t.ha.shift(),s=PN.from(r,e,n);await QB(t,()=>t.remoteSyncer.applySuccessfulWrite(s)),await qg(t)}async function Ime(t,e){e&&Tc(t).Y_&&await async function(r,s){if(function(o){return ofe(o)&&o!==De.ABORTED}(s.code)){const i=r.ha.shift();Tc(r).O_(),await QB(r,()=>r.remoteSyncer.rejectFailedWrite(i.batchId,s)),await qg(r)}}(t,e),ZB(t)&&ez(t)}async function TM(t,e){const n=qt(t);n.asyncQueue.verifyOperationInProgress(),Ye(ad,"RemoteStore received new credentials");const r=gd(n);n.Ta.add(3),await Hg(n),r&&n.da.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ta.delete(3),await xb(n)}async function Nme(t,e){const n=qt(t);e?(n.Ta.delete(2),await xb(n)):e||(n.Ta.add(2),await Hg(n),n.da.set("Unknown"))}function Lf(t){return t.Ra||(t.Ra=function(n,r,s){const i=qt(n);return i.ra(),new hme(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:xme.bind(null,t),n_:vme.bind(null,t),i_:wme.bind(null,t),j_:bme.bind(null,t)}),t.Ia.push(async e=>{e?(t.Ra.O_(),zN(t)?BN(t):t.da.set("Unknown")):(await t.Ra.stop(),XB(t))})),t.Ra}function Tc(t){return t.Va||(t.Va=function(n,r,s){const i=qt(n);return i.ra(),new fme(r,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,s)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:Cme.bind(null,t),i_:Ime.bind(null,t),X_:Eme.bind(null,t),ea:Tme.bind(null,t)}),t.Ia.push(async e=>{e?(t.Va.O_(),await qg(t)):(await t.Va.stop(),t.ha.length>0&&(Ye(ad,`Stopping write stream with ${t.ha.length} pending writes`),t.ha=[]))})),t.Va}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class GN{constructor(e,n,r,s,i){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=s,this.removalCallback=i,this.deferred=new wa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,s,i){const o=Date.now()+r,l=new GN(e,n,o,s,i);return l.start(r),l}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ot(De.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function WN(t,e){if(Ys("AsyncQueue",`${e}: ${t}`),Wc(t))return new ot(De.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lh{static emptySet(e){return new Lh(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||dt.comparator(n.key,r.key):(n,r)=>dt.comparator(n.key,r.key),this.keyedMap=Am(),this.sortedSet=new ur(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Lh)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const s=n.getNext().key,i=r.getNext().key;if(!s.isEqual(i))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Lh;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class IM{constructor(){this.ma=new ur(dt.comparator)}track(e){const n=e.doc.key,r=this.ma.get(n);r?e.type!==0&&r.type===3?this.ma=this.ma.insert(n,e):e.type===3&&r.type!==1?this.ma=this.ma.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.ma=this.ma.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.ma=this.ma.remove(n):e.type===1&&r.type===2?this.ma=this.ma.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.ma=this.ma.insert(n,{type:2,doc:e.doc}):wt(63341,{Vt:e,fa:r}):this.ma=this.ma.insert(n,e)}ga(){const e=[];return this.ma.inorderTraversal((n,r)=>{e.push(r)}),e}}class gf{constructor(e,n,r,s,i,o,l,c,u){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=s,this.mutatedKeys=i,this.fromCache=o,this.syncStateChanged=l,this.excludesMetadataChanges=c,this.hasCachedResults=u}static fromInitialDocuments(e,n,r,s,i){const o=[];return n.forEach(l=>{o.push({type:0,doc:l})}),new gf(e,n,Lh.emptySet(n),o,r,s,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&cb(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let s=0;s<n.length;s++)if(n[s].type!==r[s].type||!n[s].doc.isEqual(r[s].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pme{constructor(){this.pa=void 0,this.ya=[]}wa(){return this.ya.some(e=>e.Sa())}}class Ame{constructor(){this.queries=NM(),this.onlineState="Unknown",this.ba=new Set}terminate(){(function(n,r){const s=qt(n),i=s.queries;s.queries=NM(),i.forEach((o,l)=>{for(const c of l.ya)c.onError(r)})})(this,new ot(De.ABORTED,"Firestore shutting down"))}}function NM(){return new _l(t=>Z6(t),cb)}async function HN(t,e){const n=qt(t);let r=3;const s=e.query;let i=n.queries.get(s);i?!i.wa()&&e.Sa()&&(r=2):(i=new Pme,r=e.Sa()?0:1);try{switch(r){case 0:i.pa=await n.onListen(s,!0);break;case 1:i.pa=await n.onListen(s,!1);break;case 2:await n.onFirstRemoteStoreListen(s)}}catch(o){const l=WN(o,`Initialization of query '${Yd(e.query)}' failed`);return void e.onError(l)}n.queries.set(s,i),i.ya.push(e),e.Da(n.onlineState),i.pa&&e.va(i.pa)&&KN(n)}async function qN(t,e){const n=qt(t),r=e.query;let s=3;const i=n.queries.get(r);if(i){const o=i.ya.indexOf(e);o>=0&&(i.ya.splice(o,1),i.ya.length===0?s=e.Sa()?0:1:!i.wa()&&e.Sa()&&(s=2))}switch(s){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function kme(t,e){const n=qt(t);let r=!1;for(const s of e){const i=s.query,o=n.queries.get(i);if(o){for(const l of o.ya)l.va(s)&&(r=!0);o.pa=s}}r&&KN(n)}function Rme(t,e,n){const r=qt(t),s=r.queries.get(e);if(s)for(const i of s.ya)i.onError(n);r.queries.delete(e)}function KN(t){t.ba.forEach(e=>{e.next()})}var gT,PM;(PM=gT||(gT={})).Ca="default",PM.Cache="cache";class YN{constructor(e,n,r){this.query=e,this.Fa=n,this.Ma=!1,this.xa=null,this.onlineState="Unknown",this.options=r||{}}va(e){if(!this.options.includeMetadataChanges){const r=[];for(const s of e.docChanges)s.type!==3&&r.push(s);e=new gf(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Ma?this.Oa(e)&&(this.Fa.next(e),n=!0):this.Na(e,this.onlineState)&&(this.Ba(e),n=!0),this.xa=e,n}onError(e){this.Fa.error(e)}Da(e){this.onlineState=e;let n=!1;return this.xa&&!this.Ma&&this.Na(this.xa,e)&&(this.Ba(this.xa),n=!0),n}Na(e,n){if(!e.fromCache||!this.Sa())return!0;const r=n!=="Offline";return(!this.options.La||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Oa(e){if(e.docChanges.length>0)return!0;const n=this.xa&&this.xa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}Ba(e){e=gf.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Ma=!0,this.Fa.next(e)}Sa(){return this.options.source!==gT.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tz{constructor(e){this.key=e}}class nz{constructor(e){this.key=e}}class jme{constructor(e,n){this.query=e,this.Ga=n,this.za=null,this.hasCachedResults=!1,this.current=!1,this.ja=Qt(),this.mutatedKeys=Qt(),this.Ha=eB(e),this.Ja=new Lh(this.Ha)}get Ya(){return this.Ga}Za(e,n){const r=n?n.Xa:new IM,s=n?n.Ja:this.Ja;let i=n?n.mutatedKeys:this.mutatedKeys,o=s,l=!1;const c=this.query.limitType==="F"&&s.size===this.query.limit?s.last():null,u=this.query.limitType==="L"&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal((d,h)=>{const f=s.get(d),m=Gg(this.query,h)?h:null,g=!!f&&this.mutatedKeys.has(f.key),x=!!m&&(m.hasLocalMutations||this.mutatedKeys.has(m.key)&&m.hasCommittedMutations);let w=!1;f&&m?f.data.isEqual(m.data)?g!==x&&(r.track({type:3,doc:m}),w=!0):this.eu(f,m)||(r.track({type:2,doc:m}),w=!0,(c&&this.Ha(m,c)>0||u&&this.Ha(m,u)<0)&&(l=!0)):!f&&m?(r.track({type:0,doc:m}),w=!0):f&&!m&&(r.track({type:1,doc:f}),w=!0,(c||u)&&(l=!0)),w&&(m?(o=o.add(m),i=x?i.add(d):i.delete(d)):(o=o.delete(d),i=i.delete(d)))}),this.query.limit!==null)for(;o.size>this.query.limit;){const d=this.query.limitType==="F"?o.last():o.first();o=o.delete(d.key),i=i.delete(d.key),r.track({type:1,doc:d})}return{Ja:o,Xa:r,Cs:l,mutatedKeys:i}}eu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,s){const i=this.Ja;this.Ja=e.Ja,this.mutatedKeys=e.mutatedKeys;const o=e.Xa.ga();o.sort((d,h)=>function(m,g){const x=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return wt(20277,{Vt:w})}};return x(m)-x(g)}(d.type,h.type)||this.Ha(d.doc,h.doc)),this.tu(r),s=s!=null&&s;const l=n&&!s?this.nu():[],c=this.ja.size===0&&this.current&&!s?1:0,u=c!==this.za;return this.za=c,o.length!==0||u?{snapshot:new gf(this.query,e.Ja,i,o,e.mutatedKeys,c===0,u,!1,!!r&&r.resumeToken.approximateByteSize()>0),ru:l}:{ru:l}}Da(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Ja:this.Ja,Xa:new IM,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ru:[]}}iu(e){return!this.Ga.has(e)&&!!this.Ja.has(e)&&!this.Ja.get(e).hasLocalMutations}tu(e){e&&(e.addedDocuments.forEach(n=>this.Ga=this.Ga.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ga=this.Ga.delete(n)),this.current=e.current)}nu(){if(!this.current)return[];const e=this.ja;this.ja=Qt(),this.Ja.forEach(r=>{this.iu(r.key)&&(this.ja=this.ja.add(r.key))});const n=[];return e.forEach(r=>{this.ja.has(r)||n.push(new nz(r))}),this.ja.forEach(r=>{e.has(r)||n.push(new tz(r))}),n}su(e){this.Ga=e.$s,this.ja=Qt();const n=this.Za(e.documents);return this.applyChanges(n,!0)}ou(){return gf.fromInitialDocuments(this.query,this.Ja,this.mutatedKeys,this.za===0,this.hasCachedResults)}}const JN="SyncEngine";class Dme{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class Mme{constructor(e){this.key=e,this._u=!1}}class Lme{constructor(e,n,r,s,i,o){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=s,this.currentUser=i,this.maxConcurrentLimboResolutions=o,this.au={},this.uu=new _l(l=>Z6(l),cb),this.cu=new Map,this.lu=new Set,this.hu=new ur(dt.comparator),this.Pu=new Map,this.Tu=new MN,this.Iu={},this.Eu=new Map,this.du=od.lr(),this.onlineState="Unknown",this.Au=void 0}get isPrimaryClient(){return this.Au===!0}}async function Fme(t,e,n=!0){const r=lz(t);let s;const i=r.uu.get(e);return i?(r.sharedClientState.addLocalQueryTarget(i.targetId),s=i.view.ou()):s=await rz(r,e,n,!0),s}async function Ome(t,e){const n=lz(t);await rz(n,e,!0,!1)}async function rz(t,e,n,r){const s=await sme(t.localStore,po(e)),i=s.targetId,o=t.sharedClientState.addLocalQueryTarget(i,n);let l;return r&&(l=await $me(t,e,i,o==="current",s.resumeToken)),t.isPrimaryClient&&n&&YB(t.remoteStore,s),l}async function $me(t,e,n,r,s){t.Ru=(h,f,m)=>async function(x,w,v,_){let C=w.view.Za(v);C.Cs&&(C=await bM(x.localStore,w.query,!1).then(({documents:E})=>w.view.Za(E,C)));const T=_&&_.targetChanges.get(w.targetId),R=_&&_.targetMismatches.get(w.targetId)!=null,k=w.view.applyChanges(C,x.isPrimaryClient,T,R);return kM(x,w.targetId,k.ru),k.snapshot}(t,h,f,m);const i=await bM(t.localStore,e,!0),o=new jme(e,i.$s),l=o.Za(i.documents),c=Wg.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",s),u=o.applyChanges(l,t.isPrimaryClient,c);kM(t,n,u.ru);const d=new Dme(e,n,o);return t.uu.set(e,d),t.cu.has(n)?t.cu.get(n).push(e):t.cu.set(n,[e]),u.snapshot}async function Vme(t,e,n){const r=qt(t),s=r.uu.get(e),i=r.cu.get(s.targetId);if(i.length>1)return r.cu.set(s.targetId,i.filter(o=>!cb(o,e))),void r.uu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(s.targetId),r.sharedClientState.isActiveQueryTarget(s.targetId)||await mT(r.localStore,s.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(s.targetId),n&&VN(r.remoteStore,s.targetId),yT(r,s.targetId)}).catch(pd)):(yT(r,s.targetId),await mT(r.localStore,s.targetId,!0))}async function Ume(t,e){const n=qt(t),r=n.uu.get(e),s=n.cu.get(r.targetId);n.isPrimaryClient&&s.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),VN(n.remoteStore,r.targetId))}async function Bme(t,e,n){const r=cz(t);try{const s=await function(o,l){const c=qt(o),u=xr.now(),d=l.reduce((m,g)=>m.add(g.key),Qt());let h,f;return c.persistence.runTransaction("Locally write mutations","readwrite",m=>{let g=Gi(),x=Qt();return c.Bs.getEntries(m,d).next(w=>{g=w,g.forEach((v,_)=>{_.isValidDocument()||(x=x.add(v))})}).next(()=>c.localDocuments.getOverlayedDocuments(m,g)).next(w=>{h=w;const v=[];for(const _ of l){const C=sfe(_,h.get(_.key).overlayedDocument);C!=null&&v.push(new Sl(_.key,C,G6(C.value.mapValue),Js.exists(!0)))}return c.mutationQueue.addMutationBatch(m,u,v,l)}).next(w=>{f=w;const v=w.applyToLocalDocumentSet(h,x);return c.documentOverlayCache.saveOverlays(m,w.batchId,v)})}).then(()=>({batchId:f.batchId,changes:nB(h)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(s.batchId),function(o,l,c){let u=o.Iu[o.currentUser.toKey()];u||(u=new ur(Vt)),u=u.insert(l,c),o.Iu[o.currentUser.toKey()]=u}(r,s.batchId,n),await Kg(r,s.changes),await qg(r.remoteStore)}catch(s){const i=WN(s,"Failed to persist write");n.reject(i)}}async function sz(t,e){const n=qt(t);try{const r=await tme(n.localStore,e);e.targetChanges.forEach((s,i)=>{const o=n.Pu.get(i);o&&(St(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1,22616),s.addedDocuments.size>0?o._u=!0:s.modifiedDocuments.size>0?St(o._u,14607):s.removedDocuments.size>0&&(St(o._u,42227),o._u=!1))}),await Kg(n,r,e)}catch(r){await pd(r)}}function AM(t,e,n){const r=qt(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const s=[];r.uu.forEach((i,o)=>{const l=o.view.Da(e);l.snapshot&&s.push(l.snapshot)}),function(o,l){const c=qt(o);c.onlineState=l;let u=!1;c.queries.forEach((d,h)=>{for(const f of h.ya)f.Da(l)&&(u=!0)}),u&&KN(c)}(r.eventManager,e),s.length&&r.au.j_(s),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function zme(t,e,n){const r=qt(t);r.sharedClientState.updateQueryState(e,"rejected",n);const s=r.Pu.get(e),i=s&&s.key;if(i){let o=new ur(dt.comparator);o=o.insert(i,Cr.newNoDocument(i,It.min()));const l=Qt().add(i),c=new fb(It.min(),new Map,new ur(Vt),o,l);await sz(r,c),r.hu=r.hu.remove(i),r.Pu.delete(e),XN(r)}else await mT(r.localStore,e,!1).then(()=>yT(r,e,n)).catch(pd)}async function Gme(t,e){const n=qt(t),r=e.batch.batchId;try{const s=await eme(n.localStore,e);oz(n,r,null),iz(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Kg(n,s)}catch(s){await pd(s)}}async function Wme(t,e,n){const r=qt(t);try{const s=await function(o,l){const c=qt(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",u=>{let d;return c.mutationQueue.lookupMutationBatch(u,l).next(h=>(St(h!==null,37113),d=h.keys(),c.mutationQueue.removeMutationBatch(u,h))).next(()=>c.mutationQueue.performConsistencyCheck(u)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(u,d,l)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(u,d)).next(()=>c.localDocuments.getDocuments(u,d))})}(r.localStore,e);oz(r,e,n),iz(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Kg(r,s)}catch(s){await pd(s)}}function iz(t,e){(t.Eu.get(e)||[]).forEach(n=>{n.resolve()}),t.Eu.delete(e)}function oz(t,e,n){const r=qt(t);let s=r.Iu[r.currentUser.toKey()];if(s){const i=s.get(e);i&&(n?i.reject(n):i.resolve(),s=s.remove(e)),r.Iu[r.currentUser.toKey()]=s}}function yT(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.cu.get(e))t.uu.delete(r),n&&t.au.Vu(r,n);t.cu.delete(e),t.isPrimaryClient&&t.Tu.Hr(e).forEach(r=>{t.Tu.containsKey(r)||az(t,r)})}function az(t,e){t.lu.delete(e.path.canonicalString());const n=t.hu.get(e);n!==null&&(VN(t.remoteStore,n),t.hu=t.hu.remove(e),t.Pu.delete(n),XN(t))}function kM(t,e,n){for(const r of n)r instanceof tz?(t.Tu.addReference(r.key,e),Hme(t,r)):r instanceof nz?(Ye(JN,"Document no longer in limbo: "+r.key),t.Tu.removeReference(r.key,e),t.Tu.containsKey(r.key)||az(t,r.key)):wt(19791,{mu:r})}function Hme(t,e){const n=e.key,r=n.path.canonicalString();t.hu.get(n)||t.lu.has(r)||(Ye(JN,"New document in limbo: "+n),t.lu.add(r),XN(t))}function XN(t){for(;t.lu.size>0&&t.hu.size<t.maxConcurrentLimboResolutions;){const e=t.lu.values().next().value;t.lu.delete(e);const n=new dt(En.fromString(e)),r=t.du.next();t.Pu.set(r,new Mme(n)),t.hu=t.hu.insert(n,r),YB(t.remoteStore,new Ha(po(zg(n.path)),r,"TargetPurposeLimboResolution",uo.le))}}async function Kg(t,e,n){const r=qt(t),s=[],i=[],o=[];r.uu.isEmpty()||(r.uu.forEach((l,c)=>{o.push(r.Ru(c,e,n).then(u=>{var d;if((u||n)&&r.isPrimaryClient){const h=u?!u.fromCache:(d=n==null?void 0:n.targetChanges.get(c.targetId))===null||d===void 0?void 0:d.current;r.sharedClientState.updateQueryState(c.targetId,h?"current":"not-current")}if(u){s.push(u);const h=ON.Rs(c.targetId,u);i.push(h)}}))}),await Promise.all(o),r.au.j_(s),await async function(c,u){const d=qt(c);try{await d.persistence.runTransaction("notifyLocalViewChanges","readwrite",h=>ve.forEach(u,f=>ve.forEach(f.ds,m=>d.persistence.referenceDelegate.addReference(h,f.targetId,m)).next(()=>ve.forEach(f.As,m=>d.persistence.referenceDelegate.removeReference(h,f.targetId,m)))))}catch(h){if(!Wc(h))throw h;Ye($N,"Failed to update sequence numbers: "+h)}for(const h of u){const f=h.targetId;if(!h.fromCache){const m=d.xs.get(f),g=m.snapshotVersion,x=m.withLastLimboFreeSnapshotVersion(g);d.xs=d.xs.insert(f,x)}}}(r.localStore,i))}async function qme(t,e){const n=qt(t);if(!n.currentUser.isEqual(e)){Ye(JN,"User change. New user:",e.toKey());const r=await GB(n.localStore,e);n.currentUser=e,function(i,o){i.Eu.forEach(l=>{l.forEach(c=>{c.reject(new ot(De.CANCELLED,o))})}),i.Eu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Kg(n,r.ks)}}function Kme(t,e){const n=qt(t),r=n.Pu.get(e);if(r&&r._u)return Qt().add(r.key);{let s=Qt();const i=n.cu.get(e);if(!i)return s;for(const o of i){const l=n.uu.get(o);s=s.unionWith(l.view.Ya)}return s}}function lz(t){const e=qt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=sz.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Kme.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=zme.bind(null,e),e.au.j_=kme.bind(null,e.eventManager),e.au.Vu=Rme.bind(null,e.eventManager),e}function cz(t){const e=qt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Gme.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Wme.bind(null,e),e}class og{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=yb(e.databaseInfo.databaseId),this.sharedClientState=this.pu(e),this.persistence=this.yu(e),await this.persistence.start(),this.localStore=this.wu(e),this.gcScheduler=this.Su(e,this.localStore),this.indexBackfillerScheduler=this.bu(e,this.localStore)}Su(e,n){return null}bu(e,n){return null}wu(e){return zB(this.persistence,new BB,e.initialUser,this.serializer)}yu(e){return new LN(gb.fi,this.serializer)}pu(e){return new HB}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}og.provider={build:()=>new og};class Yme extends og{constructor(e){super(),this.cacheSizeBytes=e}Su(e,n){St(this.persistence.referenceDelegate instanceof kw,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new FB(r,e.asyncQueue,n)}yu(e){const n=this.cacheSizeBytes!==void 0?Rs.withCacheSize(this.cacheSizeBytes):Rs.DEFAULT;return new LN(r=>kw.fi(r,n),this.serializer)}}class Jme extends og{constructor(e,n,r){super(),this.Du=e,this.cacheSizeBytes=n,this.forceOwnership=r,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Du.initialize(this,e),await cz(this.Du.syncEngine),await qg(this.Du.remoteStore),await this.persistence.Ji(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))}wu(e){return zB(this.persistence,new BB,e.initialUser,this.serializer)}Su(e,n){const r=this.persistence.referenceDelegate.garbageCollector;return new FB(r,e.asyncQueue,n)}bu(e,n){const r=new she(n,this.persistence);return new rhe(e.asyncQueue,r)}yu(e){const n=Jfe(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),r=this.cacheSizeBytes!==void 0?Rs.withCacheSize(this.cacheSizeBytes):Rs.DEFAULT;return new FN(this.synchronizeTabs,n,e.clientId,r,e.asyncQueue,dme(),av(),this.serializer,this.sharedClientState,!!this.forceOwnership)}pu(e){return new HB}}class jw{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>AM(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=qme.bind(null,this.syncEngine),await Nme(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new Ame}()}createDatastore(e){const n=yb(e.databaseInfo.databaseId),r=function(i){return new ume(i)}(e.databaseInfo);return function(i,o,l,c){return new pme(i,o,l,c)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,s,i,o,l){return new yme(r,s,i,o,l)}(this.localStore,this.datastore,e.asyncQueue,n=>AM(this.syncEngine,n,0),function(){return CM.C()?new CM:new ome}())}createSyncEngine(e,n){return function(s,i,o,l,c,u,d){const h=new Lme(s,i,o,l,c,u);return d&&(h.Au=!0),h}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(s){const i=qt(s);Ye(ad,"RemoteStore shutting down."),i.Ta.add(5),await Hg(i),i.Ea.shutdown(),i.da.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}jw.provider={build:()=>new jw};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QN{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.vu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.vu(this.observer.error,e):Ys("Uncaught Error in snapshot listener:",e.toString()))}Cu(){this.muted=!0}vu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ic="FirestoreClient";class Xme{constructor(e,n,r,s,i){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=s,this.user=gs.UNAUTHENTICATED,this.clientId=v6.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(r,async o=>{Ye(Ic,"Received user=",o.uid),await this.authCredentialListener(o),this.user=o}),this.appCheckCredentials.start(r,o=>(Ye(Ic,"Received new app check token=",o),this.appCheckCredentialListener(o,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=WN(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function _S(t,e){t.asyncQueue.verifyOperationInProgress(),Ye(Ic,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async s=>{r.isEqual(s)||(await GB(e.localStore,s),r=s)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function RM(t,e){t.asyncQueue.verifyOperationInProgress();const n=await Qme(t);Ye(Ic,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>TM(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,s)=>TM(e.remoteStore,s)),t._onlineComponents=e}async function Qme(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){Ye(Ic,"Using user provided OfflineComponentProvider");try{await _S(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(s){return s.name==="FirebaseError"?s.code===De.FAILED_PRECONDITION||s.code===De.UNIMPLEMENTED:!(typeof DOMException<"u"&&s instanceof DOMException)||s.code===22||s.code===20||s.code===11}(n))throw n;td("Error using user provided cache. Falling back to memory cache: "+n),await _S(t,new og)}}else Ye(Ic,"Using default OfflineComponentProvider"),await _S(t,new Yme(void 0));return t._offlineComponents}async function uz(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(Ye(Ic,"Using user provided OnlineComponentProvider"),await RM(t,t._uninitializedComponentsProvider._online)):(Ye(Ic,"Using default OnlineComponentProvider"),await RM(t,new jw))),t._onlineComponents}function Zme(t){return uz(t).then(e=>e.syncEngine)}async function Dw(t){const e=await uz(t),n=e.eventManager;return n.onListen=Fme.bind(null,e.syncEngine),n.onUnlisten=Vme.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=Ome.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=Ume.bind(null,e.syncEngine),n}function epe(t,e,n={}){const r=new wa;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new QN({next:f=>{d.Cu(),o.enqueueAndForget(()=>qN(i,h));const m=f.docs.has(l);!m&&f.fromCache?u.reject(new ot(De.UNAVAILABLE,"Failed to get document because the client is offline.")):m&&f.fromCache&&c&&c.source==="server"?u.reject(new ot(De.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new YN(zg(l.path),d,{includeMetadataChanges:!0,La:!0});return HN(i,h)}(await Dw(t),t.asyncQueue,e,n,r)),r.promise}function tpe(t,e,n={}){const r=new wa;return t.asyncQueue.enqueueAndForget(async()=>function(i,o,l,c,u){const d=new QN({next:f=>{d.Cu(),o.enqueueAndForget(()=>qN(i,h)),f.fromCache&&c.source==="server"?u.reject(new ot(De.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):u.resolve(f)},error:f=>u.reject(f)}),h=new YN(l,d,{includeMetadataChanges:!0,La:!0});return HN(i,h)}(await Dw(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function dz(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jM=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function hz(t,e,n){if(!n)throw new ot(De.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function npe(t,e,n,r){if(e===!0&&r===!0)throw new ot(De.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function DM(t){if(!dt.isDocumentKey(t))throw new ot(De.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function MM(t){if(dt.isDocumentKey(t))throw new ot(De.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function vb(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":wt(12329,{type:typeof t})}function yi(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ot(De.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=vb(t);throw new ot(De.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}function rpe(t,e){if(e<=0)throw new ot(De.INVALID_ARGUMENT,`Function ${t}() requires a positive number, but it was: ${e}.`)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fz="firestore.googleapis.com",LM=!0;class FM{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ot(De.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=fz,this.ssl=LM}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:LM;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=jB;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<jfe)throw new ot(De.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}npe("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=dz((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(i){if(i.timeoutSeconds!==void 0){if(isNaN(i.timeoutSeconds))throw new ot(De.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (must not be NaN)`);if(i.timeoutSeconds<5)throw new ot(De.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (minimum allowed value is 5)`);if(i.timeoutSeconds>30)throw new ot(De.INVALID_ARGUMENT,`invalid long polling timeout: ${i.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,s){return r.timeoutSeconds===s.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class wb{constructor(e,n,r,s){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=s,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new FM({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ot(De.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ot(De.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new FM(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Wde;switch(r.type){case"firstParty":return new Yde(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ot(De.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=jM.get(n);r&&(Ye("ComponentProvider","Removing Datastore"),jM.delete(n),r.terminate())}(this),Promise.resolve()}}function spe(t,e,n,r={}){var s;t=yi(t,wb);const i=Uc(e),o=t._getSettings(),l=Object.assign(Object.assign({},o),{emulatorOptions:t._getEmulatorOptions()}),c=`${e}:${n}`;i&&(J0(`https://${c}`),X0("Firestore",!0)),o.host!==fz&&o.host!==c&&td("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u=Object.assign(Object.assign({},o),{host:c,ssl:i,emulatorOptions:r});if(!Xu(u,l)&&(t._setSettings(u),r.mockUserToken)){let d,h;if(typeof r.mockUserToken=="string")d=r.mockUserToken,h=gs.MOCK_USER;else{d=b5(r.mockUserToken,(s=t._app)===null||s===void 0?void 0:s.options.projectId);const f=r.mockUserToken.sub||r.mockUserToken.user_id;if(!f)throw new ot(De.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");h=new gs(f)}t._authCredentials=new Hde(new y6(d,h))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qc{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new qc(this.firestore,e,this._query)}}class Fs{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new fc(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Fs(this.firestore,e,this._key)}}class fc extends qc{constructor(e,n,r){super(e,n,zg(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Fs(this.firestore,null,new dt(e))}withConverter(e){return new fc(this.firestore,e,this._path)}}function ki(t,e,...n){if(t=Jn(t),hz("collection","path",e),t instanceof wb){const r=En.fromString(e,...n);return MM(r),new fc(t,null,r)}{if(!(t instanceof Fs||t instanceof fc))throw new ot(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(En.fromString(e,...n));return MM(r),new fc(t.firestore,null,r)}}function rs(t,e,...n){if(t=Jn(t),arguments.length===1&&(e=v6.newId()),hz("doc","path",e),t instanceof wb){const r=En.fromString(e,...n);return DM(r),new Fs(t,null,new dt(r))}{if(!(t instanceof Fs||t instanceof fc))throw new ot(De.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(En.fromString(e,...n));return DM(r),new Fs(t.firestore,t instanceof fc?t.converter:null,new dt(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OM="AsyncQueue";class $M{constructor(e=Promise.resolve()){this.zu=[],this.ju=!1,this.Hu=[],this.Ju=null,this.Yu=!1,this.Zu=!1,this.Xu=[],this.C_=new qB(this,"async_queue_retry"),this.ec=()=>{const r=av();r&&Ye(OM,"Visibility state changed to "+r.visibilityState),this.C_.p_()},this.tc=e;const n=av();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.ec)}get isShuttingDown(){return this.ju}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.nc(),this.rc(e)}enterRestrictedMode(e){if(!this.ju){this.ju=!0,this.Zu=e||!1;const n=av();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.ec)}}enqueue(e){if(this.nc(),this.ju)return new Promise(()=>{});const n=new wa;return this.rc(()=>this.ju&&this.Zu?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.zu.push(e),this.sc()))}async sc(){if(this.zu.length!==0){try{await this.zu[0](),this.zu.shift(),this.C_.reset()}catch(e){if(!Wc(e))throw e;Ye(OM,"Operation failed with retryable error: "+e)}this.zu.length>0&&this.C_.f_(()=>this.sc())}}rc(e){const n=this.tc.then(()=>(this.Yu=!0,e().catch(r=>{throw this.Ju=r,this.Yu=!1,Ys("INTERNAL UNHANDLED ERROR: ",VM(r)),r}).then(r=>(this.Yu=!1,r))));return this.tc=n,n}enqueueAfterDelay(e,n,r){this.nc(),this.Xu.indexOf(e)>-1&&(n=0);const s=GN.createAndSchedule(this,e,n,r,i=>this.oc(i));return this.Hu.push(s),s}nc(){this.Ju&&wt(47125,{_c:VM(this.Ju)})}verifyOperationInProgress(){}async ac(){let e;do e=this.tc,await e;while(e!==this.tc)}uc(e){for(const n of this.Hu)if(n.timerId===e)return!0;return!1}cc(e){return this.ac().then(()=>{this.Hu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Hu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.ac()})}lc(e){this.Xu.push(e)}oc(e){const n=this.Hu.indexOf(e);this.Hu.splice(n,1)}}function VM(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UM(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const s=n;for(const i of r)if(i in s&&typeof s[i]=="function")return!0;return!1}(t,["next","error","complete"])}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ipe=-1;class fl extends wb{constructor(e,n,r,s){super(e,n,r,s),this.type="firestore",this._queue=new $M,this._persistenceKey=(s==null?void 0:s.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new $M(e),this._firestoreClient=void 0,await e}}}function ope(t,e){const n=typeof t=="object"?t:Q0(),r=typeof t=="string"?t:e||bw,s=Mg(n,"firestore").getImmediate({identifier:r});if(!s._initialized){const i=rN("firestore");i&&spe(s,...i)}return s}function bb(t){if(t._terminated)throw new ot(De.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||mz(t),t._firestoreClient}function mz(t){var e,n,r;const s=t._freezeSettings(),i=function(l,c,u,d){return new jhe(l,c,u,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,dz(d.experimentalLongPollingOptions),d.useFetchStreams,d.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,s);t._componentsProvider||!((n=s.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=s.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:s.localCache._offlineComponentProvider,_online:s.localCache._onlineComponentProvider}),t._firestoreClient=new Xme(t._authCredentials,t._appCheckCredentials,t._queue,i,t._componentsProvider&&function(l){const c=l==null?void 0:l._online.build();return{_offline:l==null?void 0:l._offline.build(c),_online:c}}(t._componentsProvider))}function ape(t,e){td("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=t._freezeSettings();return lpe(t,jw.provider,{build:r=>new Jme(r,n.cacheSizeBytes,e==null?void 0:e.forceOwnership)}),Promise.resolve()}function lpe(t,e,n){if((t=yi(t,fl))._firestoreClient||t._terminated)throw new ot(De.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(t._componentsProvider||t._getSettings().localCache)throw new ot(De.FAILED_PRECONDITION,"SDK cache is already specified.");t._componentsProvider={_online:e,_offline:n},mz(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yf{constructor(e){this._byteString=e}static fromBase64String(e){try{return new yf(Gr.fromBase64String(e))}catch(n){throw new ot(De.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new yf(Gr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _b{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ot(De.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new pr(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sb{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZN{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ot(De.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ot(De.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Vt(this._lat,e._lat)||Vt(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eP{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,s){if(r.length!==s.length)return!1;for(let i=0;i<r.length;++i)if(r[i]!==s[i])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cpe=/^__.*__$/;class upe{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Sl(e,this.data,this.fieldMask,n,this.fieldTransforms):new Mf(e,this.data,n,this.fieldTransforms)}}class pz{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new Sl(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function gz(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw wt(40011,{hc:t})}}class tP{constructor(e,n,r,s,i,o){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=s,i===void 0&&this.Pc(),this.fieldTransforms=i||[],this.fieldMask=o||[]}get path(){return this.settings.path}get hc(){return this.settings.hc}Tc(e){return new tP(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ic(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.dc(e),s}Ac(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),s=this.Tc({path:r,Ec:!1});return s.Pc(),s}Rc(e){return this.Tc({path:void 0,Ec:!0})}Vc(e){return Mw(e,this.settings.methodName,this.settings.mc||!1,this.path,this.settings.fc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Pc(){if(this.path)for(let e=0;e<this.path.length;e++)this.dc(this.path.get(e))}dc(e){if(e.length===0)throw this.Vc("Document fields must not be empty");if(gz(this.hc)&&cpe.test(e))throw this.Vc('Document fields cannot begin and end with "__"')}}class dpe{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||yb(e)}gc(e,n,r,s=!1){return new tP({hc:e,methodName:n,fc:r,path:pr.emptyPath(),Ec:!1,mc:s},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function nP(t){const e=t._freezeSettings(),n=yb(t._databaseId);return new dpe(t._databaseId,!!e.ignoreUndefinedProperties,n)}function hpe(t,e,n,r,s,i={}){const o=t.gc(i.merge||i.mergeFields?2:0,e,n,s);sP("Data must be an object, but it was:",o,r);const l=yz(r,o);let c,u;if(i.merge)c=new hi(o.fieldMask),u=o.fieldTransforms;else if(i.mergeFields){const d=[];for(const h of i.mergeFields){const f=xT(e,h,n);if(!o.contains(f))throw new ot(De.INVALID_ARGUMENT,`Field '${f}' is specified in your field mask but missing from your input data.`);vz(d,f)||d.push(f)}c=new hi(d),u=o.fieldTransforms.filter(h=>c.covers(h.field))}else c=null,u=o.fieldTransforms;return new upe(new Ms(l),c,u)}class Cb extends Sb{_toFieldTransform(e){if(e.hc!==2)throw e.hc===1?e.Vc(`${this._methodName}() can only appear at the top level of your update data`):e.Vc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Cb}}class rP extends Sb{constructor(e,n){super(e),this.wc=n}_toFieldTransform(e){const n=new mf(e.serializer,iB(e.serializer,this.wc));return new uB(e.path,n)}isEqual(e){return e instanceof rP&&this.wc===e.wc}}function fpe(t,e,n,r){const s=t.gc(1,e,n);sP("Data must be an object, but it was:",s,r);const i=[],o=Ms.empty();Hc(r,(c,u)=>{const d=iP(e,c,n);u=Jn(u);const h=s.Ac(d);if(u instanceof Cb)i.push(d);else{const f=Yg(u,h);f!=null&&(i.push(d),o.set(d,f))}});const l=new hi(i);return new pz(o,l,s.fieldTransforms)}function mpe(t,e,n,r,s,i){const o=t.gc(1,e,n),l=[xT(e,r,n)],c=[s];if(i.length%2!=0)throw new ot(De.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let f=0;f<i.length;f+=2)l.push(xT(e,i[f])),c.push(i[f+1]);const u=[],d=Ms.empty();for(let f=l.length-1;f>=0;--f)if(!vz(u,l[f])){const m=l[f];let g=c[f];g=Jn(g);const x=o.Ac(m);if(g instanceof Cb)u.push(m);else{const w=Yg(g,x);w!=null&&(u.push(m),d.set(m,w))}}const h=new hi(u);return new pz(d,h,o.fieldTransforms)}function ppe(t,e,n,r=!1){return Yg(n,t.gc(r?4:3,e))}function Yg(t,e){if(xz(t=Jn(t)))return sP("Unsupported field value:",e,t),yz(t,e);if(t instanceof Sb)return function(r,s){if(!gz(s.hc))throw s.Vc(`${r._methodName}() can only be used with update() and set()`);if(!s.path)throw s.Vc(`${r._methodName}() is not currently supported inside arrays`);const i=r._toFieldTransform(s);i&&s.fieldTransforms.push(i)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Ec&&e.hc!==4)throw e.Vc("Nested arrays are not supported");return function(r,s){const i=[];let o=0;for(const l of r){let c=Yg(l,s.Rc(o));c==null&&(c={nullValue:"NULL_VALUE"}),i.push(c),o++}return{arrayValue:{values:i}}}(t,e)}return function(r,s){if((r=Jn(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return iB(s.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const i=xr.fromDate(r);return{timestampValue:pf(s.serializer,i)}}if(r instanceof xr){const i=new xr(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:pf(s.serializer,i)}}if(r instanceof ZN)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof yf)return{bytesValue:yB(s.serializer,r._byteString)};if(r instanceof Fs){const i=s.databaseId,o=r.firestore._databaseId;if(!o.isEqual(i))throw s.Vc(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${i.projectId}/${i.database}`);return{referenceValue:RN(r.firestore._databaseId||s.databaseId,r._key.path)}}if(r instanceof eP)return function(o,l){return{mapValue:{fields:{[CN]:{stringValue:EN},[lf]:{arrayValue:{values:o.toArray().map(u=>{if(typeof u!="number")throw l.Vc("VectorValues must only contain numeric values.");return IN(l.serializer,u)})}}}}}}(r,s);throw s.Vc(`Unsupported field value: ${vb(r)}`)}(t,e)}function yz(t,e){const n={};return M6(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Hc(t,(r,s)=>{const i=Yg(s,e.Ic(r));i!=null&&(n[r]=i)}),{mapValue:{fields:n}}}function xz(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xr||t instanceof ZN||t instanceof yf||t instanceof Fs||t instanceof Sb||t instanceof eP)}function sP(t,e,n){if(!xz(n)||!function(s){return typeof s=="object"&&s!==null&&(Object.getPrototypeOf(s)===Object.prototype||Object.getPrototypeOf(s)===null)}(n)){const r=vb(n);throw r==="an object"?e.Vc(t+" a custom object"):e.Vc(t+" "+r)}}function xT(t,e,n){if((e=Jn(e))instanceof _b)return e._internalPath;if(typeof e=="string")return iP(t,e);throw Mw("Field path arguments must be of type string or ",t,!1,void 0,n)}const gpe=new RegExp("[~\\*/\\[\\]]");function iP(t,e,n){if(e.search(gpe)>=0)throw Mw(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new _b(...e.split("."))._internalPath}catch{throw Mw(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function Mw(t,e,n,r,s){const i=r&&!r.isEmpty(),o=s!==void 0;let l=`Function ${e}() called with invalid data`;n&&(l+=" (via `toFirestore()`)"),l+=". ";let c="";return(i||o)&&(c+=" (found",i&&(c+=` in field ${r}`),o&&(c+=` in document ${s}`),c+=")"),new ot(De.INVALID_ARGUMENT,l+t+c)}function vz(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wz{constructor(e,n,r,s,i){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=s,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Fs(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ype(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(oP("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ype extends wz{data(){return super.data()}}function oP(t,e){return typeof e=="string"?iP(t,e):e instanceof _b?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bz(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ot(De.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class aP{}class _z extends aP{}function vT(t,e,...n){let r=[];e instanceof aP&&r.push(e),r=r.concat(n),function(i){const o=i.filter(c=>c instanceof lP).length,l=i.filter(c=>c instanceof Eb).length;if(o>1||o>0&&l>0)throw new ot(De.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const s of r)t=s._apply(t);return t}class Eb extends _z{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Eb(e,n,r)}_apply(e){const n=this._parse(e);return Sz(e._query,n),new qc(e.firestore,e.converter,oT(e._query,n))}_parse(e){const n=nP(e.firestore);return function(i,o,l,c,u,d,h){let f;if(u.isKeyField()){if(d==="array-contains"||d==="array-contains-any")throw new ot(De.INVALID_ARGUMENT,`Invalid Query. You can't perform '${d}' queries on documentId().`);if(d==="in"||d==="not-in"){zM(h,d);const g=[];for(const x of h)g.push(BM(c,i,x));f={arrayValue:{values:g}}}else f=BM(c,i,h)}else d!=="in"&&d!=="not-in"&&d!=="array-contains-any"||zM(h,d),f=ppe(l,o,h,d==="in"||d==="not-in");return ln.create(u,d,f)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function wT(t,e,n){const r=e,s=oP("where",t);return Eb._create(s,r,n)}class lP extends aP{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new lP(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:jn.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(s,i){let o=s;const l=i.getFlattenedFilters();for(const c of l)Sz(o,c),o=oT(o,c)}(e._query,n),new qc(e.firestore,e.converter,oT(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class cP extends _z{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new cP(e,n,r)}_apply(e){return new qc(e.firestore,e.converter,Ew(e._query,this._limit,this._limitType))}}function xpe(t){return rpe("limit",t),cP._create("limit",t,"F")}function BM(t,e,n){if(typeof(n=Jn(n))=="string"){if(n==="")throw new ot(De.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Q6(e)&&n.indexOf("/")!==-1)throw new ot(De.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(En.fromString(n));if(!dt.isDocumentKey(r))throw new ot(De.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return rg(t,new dt(r))}if(n instanceof Fs)return rg(t,n._key);throw new ot(De.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${vb(n)}.`)}function zM(t,e){if(!Array.isArray(t)||t.length===0)throw new ot(De.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function Sz(t,e){const n=function(s,i){for(const o of s)for(const l of o.getFlattenedFilters())if(i.indexOf(l.op)>=0)return l.op;return null}(t.filters,function(s){switch(s){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ot(De.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ot(De.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class vpe{convertValue(e,n="none"){switch(Cc(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ar(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(hl(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw wt(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Hc(e,(s,i)=>{r[s]=this.convertValue(i,n)}),r}convertVectorValue(e){var n,r,s;const i=(s=(r=(n=e.fields)===null||n===void 0?void 0:n[lf].arrayValue)===null||r===void 0?void 0:r.values)===null||s===void 0?void 0:s.map(o=>ar(o.doubleValue));return new eP(i)}convertGeoPoint(e){return new ZN(ar(e.latitude),ar(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=ab(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(tg(e));default:return null}}convertTimestamp(e){const n=dl(e);return new xr(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=En.fromString(e);St(IB(r),9688,{name:e});const s=new nd(r.get(1),r.get(3)),i=new dt(r.popFirst(5));return s.isEqual(n)||Ys(`Document ${i} contains a document reference within a different database (${s.projectId}/${s.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),i}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wpe(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jm{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Cz extends wz{constructor(e,n,r,s,i,o){super(e,n,r,s,o),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new lv(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(oP("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class lv extends Cz{data(e={}){return super.data(e)}}class Ez{constructor(e,n,r,s){this._firestore=e,this._userDataWriter=n,this._snapshot=s,this.metadata=new jm(s.hasPendingWrites,s.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new lv(this._firestore,this._userDataWriter,r.key,r,new jm(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ot(De.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(s,i){if(s._snapshot.oldDocs.isEmpty()){let o=0;return s._snapshot.docChanges.map(l=>{const c=new lv(s._firestore,s._userDataWriter,l.doc.key,l.doc,new jm(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);return l.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=s._snapshot.oldDocs;return s._snapshot.docChanges.filter(l=>i||l.type!==3).map(l=>{const c=new lv(s._firestore,s._userDataWriter,l.doc.key,l.doc,new jm(s._snapshot.mutatedKeys.has(l.doc.key),s._snapshot.fromCache),s.query.converter);let u=-1,d=-1;return l.type!==0&&(u=o.indexOf(l.doc.key),o=o.delete(l.doc.key)),l.type!==1&&(o=o.add(l.doc),d=o.indexOf(l.doc.key)),{type:bpe(l.type),doc:c,oldIndex:u,newIndex:d}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function bpe(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return wt(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function uP(t){t=yi(t,Fs);const e=yi(t.firestore,fl);return epe(bb(e),t._key).then(n=>Iz(e,t,n))}class dP extends vpe{constructor(e){super(),this.firestore=e}convertBytes(e){return new yf(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Fs(this.firestore,null,n)}}function Ri(t){t=yi(t,qc);const e=yi(t.firestore,fl),n=bb(e),r=new dP(e);return bz(t._query),tpe(n,t._query).then(s=>new Ez(e,r,t,s))}function Fh(t,e,n){t=yi(t,Fs);const r=yi(t.firestore,fl),s=wpe(t.converter,e,n);return hP(r,[hpe(nP(r),"setDoc",t._key,s,t.converter!==null,n).toMutation(t._key,Js.none())])}function Zd(t,e,n,...r){t=yi(t,Fs);const s=yi(t.firestore,fl),i=nP(s);let o;return o=typeof(e=Jn(e))=="string"||e instanceof _b?mpe(i,"updateDoc",t._key,e,n,r):fpe(i,"updateDoc",t._key,e),hP(s,[o.toMutation(t._key,Js.exists(!0))])}function SS(t){return hP(yi(t.firestore,fl),[new hb(t._key,Js.none())])}function Tz(t,...e){var n,r,s;t=Jn(t);let i={includeMetadataChanges:!1,source:"default"},o=0;typeof e[o]!="object"||UM(e[o])||(i=e[o],o++);const l={includeMetadataChanges:i.includeMetadataChanges,source:i.source};if(UM(e[o])){const h=e[o];e[o]=(n=h.next)===null||n===void 0?void 0:n.bind(h),e[o+1]=(r=h.error)===null||r===void 0?void 0:r.bind(h),e[o+2]=(s=h.complete)===null||s===void 0?void 0:s.bind(h)}let c,u,d;if(t instanceof Fs)u=yi(t.firestore,fl),d=zg(t._key.path),c={next:h=>{e[o]&&e[o](Iz(u,t,h))},error:e[o+1],complete:e[o+2]};else{const h=yi(t,qc);u=yi(h.firestore,fl),d=h._query;const f=new dP(u);c={next:m=>{e[o]&&e[o](new Ez(u,f,h,m))},error:e[o+1],complete:e[o+2]},bz(t._query)}return function(f,m,g,x){const w=new QN(x),v=new YN(m,w,g);return f.asyncQueue.enqueueAndForget(async()=>HN(await Dw(f),v)),()=>{w.Cu(),f.asyncQueue.enqueueAndForget(async()=>qN(await Dw(f),v))}}(bb(u),d,l,c)}function hP(t,e){return function(r,s){const i=new wa;return r.asyncQueue.enqueueAndForget(async()=>Bme(await Zme(r),s,i)),i.promise}(bb(t),e)}function Iz(t,e,n){const r=n.docs.get(e._key),s=new dP(t);return new Cz(t,s,e._key,r,new jm(n.hasPendingWrites,n.fromCache),e.converter)}function _pe(t){return new rP("increment",t)}(function(e,n=!0){(function(s){Df=s})(md),Sc(new ll("firestore",(r,{instanceIdentifier:s,options:i})=>{const o=r.getProvider("app").getImmediate(),l=new fl(new qde(r.getProvider("auth-internal")),new Jde(o,r.getProvider("app-check-internal")),function(u,d){if(!Object.prototype.hasOwnProperty.apply(u.options,["projectId"]))throw new ot(De.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new nd(u.options.projectId,d)}(o,s),o);return i=Object.assign({useFetchStreams:n},i),l._setSettings(i),l},"PUBLIC").setMultipleInstances(!0)),mo(bD,_D,e),mo(bD,_D,"esm2017")})();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nz="firebasestorage.googleapis.com",Pz="storageBucket",Spe=2*60*1e3,Cpe=10*60*1e3;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ar extends Xo{constructor(e,n,r=0){super(CS(e),`Firebase Storage: ${n} (${CS(e)})`),this.status_=r,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,Ar.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return CS(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}
${this.customData.serverResponse}`:this.message=this._baseMessage}}var Pr;(function(t){t.UNKNOWN="unknown",t.OBJECT_NOT_FOUND="object-not-found",t.BUCKET_NOT_FOUND="bucket-not-found",t.PROJECT_NOT_FOUND="project-not-found",t.QUOTA_EXCEEDED="quota-exceeded",t.UNAUTHENTICATED="unauthenticated",t.UNAUTHORIZED="unauthorized",t.UNAUTHORIZED_APP="unauthorized-app",t.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",t.INVALID_CHECKSUM="invalid-checksum",t.CANCELED="canceled",t.INVALID_EVENT_NAME="invalid-event-name",t.INVALID_URL="invalid-url",t.INVALID_DEFAULT_BUCKET="invalid-default-bucket",t.NO_DEFAULT_BUCKET="no-default-bucket",t.CANNOT_SLICE_BLOB="cannot-slice-blob",t.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",t.NO_DOWNLOAD_URL="no-download-url",t.INVALID_ARGUMENT="invalid-argument",t.INVALID_ARGUMENT_COUNT="invalid-argument-count",t.APP_DELETED="app-deleted",t.INVALID_ROOT_OPERATION="invalid-root-operation",t.INVALID_FORMAT="invalid-format",t.INTERNAL_ERROR="internal-error",t.UNSUPPORTED_ENVIRONMENT="unsupported-environment"})(Pr||(Pr={}));function CS(t){return"storage/"+t}function fP(){const t="An unknown error occurred, please check the error payload for server response.";return new Ar(Pr.UNKNOWN,t)}function Epe(t){return new Ar(Pr.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function Tpe(t){return new Ar(Pr.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function Ipe(){const t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ar(Pr.UNAUTHENTICATED,t)}function Npe(){return new Ar(Pr.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project.")}function Ppe(t){return new Ar(Pr.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function Ape(){return new Ar(Pr.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function kpe(){return new Ar(Pr.CANCELED,"User canceled the upload/download.")}function Rpe(t){return new Ar(Pr.INVALID_URL,"Invalid URL '"+t+"'.")}function jpe(t){return new Ar(Pr.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function Dpe(){return new Ar(Pr.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+Pz+"' property when initializing the app?")}function Mpe(){return new Ar(Pr.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function Lpe(){return new Ar(Pr.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function Fpe(t){return new Ar(Pr.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`)}function bT(t){return new Ar(Pr.INVALID_ARGUMENT,t)}function Az(){return new Ar(Pr.APP_DELETED,"The Firebase app was deleted.")}function Ope(t){return new Ar(Pr.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function dp(t,e){return new Ar(Pr.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function mm(t){throw new Ar(Pr.INTERNAL_ERROR,"Internal error: "+t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wi{constructor(e,n){this.bucket=e,this.path_=n}get path(){return this.path_}get isRoot(){return this.path.length===0}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,n){let r;try{r=Wi.makeFromUrl(e,n)}catch{return new Wi(e,"")}if(r.path==="")return r;throw jpe(e)}static makeFromUrl(e,n){let r=null;const s="([A-Za-z0-9.\\-_]+)";function i(T){T.path.charAt(T.path.length-1)==="/"&&(T.path_=T.path_.slice(0,-1))}const o="(/(.*))?$",l=new RegExp("^gs://"+s+o,"i"),c={bucket:1,path:3};function u(T){T.path_=decodeURIComponent(T.path)}const d="v[A-Za-z0-9_]+",h=n.replace(/[.]/g,"\\."),f="(/([^?#]*).*)?$",m=new RegExp(`^https?://${h}/${d}/b/${s}/o${f}`,"i"),g={bucket:1,path:3},x=n===Nz?"(?:storage.googleapis.com|storage.cloud.google.com)":n,w="([^?#]*)",v=new RegExp(`^https?://${x}/${s}/${w}`,"i"),C=[{regex:l,indices:c,postModify:i},{regex:m,indices:g,postModify:u},{regex:v,indices:{bucket:1,path:2},postModify:u}];for(let T=0;T<C.length;T++){const R=C[T],k=R.regex.exec(e);if(k){const E=k[R.indices.bucket];let I=k[R.indices.path];I||(I=""),r=new Wi(E,I),R.postModify(r);break}}if(r==null)throw Rpe(e);return r}}class $pe{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vpe(t,e,n){let r=1,s=null,i=null,o=!1,l=0;function c(){return l===2}let u=!1;function d(...w){u||(u=!0,e.apply(null,w))}function h(w){s=setTimeout(()=>{s=null,t(m,c())},w)}function f(){i&&clearTimeout(i)}function m(w,...v){if(u){f();return}if(w){f(),d.call(null,w,...v);return}if(c()||o){f(),d.call(null,w,...v);return}r<64&&(r*=2);let C;l===1?(l=2,C=0):C=(r+Math.random())*1e3,h(C)}let g=!1;function x(w){g||(g=!0,f(),!u&&(s!==null?(w||(l=2),clearTimeout(s),h(0)):w||(l=1)))}return h(0),i=setTimeout(()=>{o=!0,x(!0)},n),x}function Upe(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Bpe(t){return t!==void 0}function zpe(t){return typeof t=="object"&&!Array.isArray(t)}function mP(t){return typeof t=="string"||t instanceof String}function GM(t){return pP()&&t instanceof Blob}function pP(){return typeof Blob<"u"}function WM(t,e,n,r){if(r<e)throw bT(`Invalid value for '${t}'. Expected ${e} or greater.`);if(r>n)throw bT(`Invalid value for '${t}'. Expected ${n} or less.`)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gP(t,e,n){let r=e;return n==null&&(r=`https://${e}`),`${n}://${r}/v0${t}`}function kz(t){const e=encodeURIComponent;let n="?";for(const r in t)if(t.hasOwnProperty(r)){const s=e(r)+"="+e(t[r]);n=n+s+"&"}return n=n.slice(0,-1),n}var Bu;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Bu||(Bu={}));/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gpe(t,e){const n=t>=500&&t<600,s=[408,429].indexOf(t)!==-1,i=e.indexOf(t)!==-1;return n||s||i}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wpe{constructor(e,n,r,s,i,o,l,c,u,d,h,f=!0,m=!1){this.url_=e,this.method_=n,this.headers_=r,this.body_=s,this.successCodes_=i,this.additionalRetryCodes_=o,this.callback_=l,this.errorCallback_=c,this.timeout_=u,this.progressCallback_=d,this.connectionFactory_=h,this.retry=f,this.isUsingEmulator=m,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((g,x)=>{this.resolve_=g,this.reject_=x,this.start_()})}start_(){const e=(r,s)=>{if(s){r(!1,new ix(!1,null,!0));return}const i=this.connectionFactory_();this.pendingConnection_=i;const o=l=>{const c=l.loaded,u=l.lengthComputable?l.total:-1;this.progressCallback_!==null&&this.progressCallback_(c,u)};this.progressCallback_!==null&&i.addUploadProgressListener(o),i.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then(()=>{this.progressCallback_!==null&&i.removeUploadProgressListener(o),this.pendingConnection_=null;const l=i.getErrorCode()===Bu.NO_ERROR,c=i.getStatus();if(!l||Gpe(c,this.additionalRetryCodes_)&&this.retry){const d=i.getErrorCode()===Bu.ABORT;r(!1,new ix(!1,null,d));return}const u=this.successCodes_.indexOf(c)!==-1;r(!0,new ix(u,i))})},n=(r,s)=>{const i=this.resolve_,o=this.reject_,l=s.connection;if(s.wasSuccessCode)try{const c=this.callback_(l,l.getResponse());Bpe(c)?i(c):i()}catch(c){o(c)}else if(l!==null){const c=fP();c.serverResponse=l.getErrorText(),this.errorCallback_?o(this.errorCallback_(l,c)):o(c)}else if(s.canceled){const c=this.appDelete_?Az():kpe();o(c)}else{const c=Ape();o(c)}};this.canceled_?n(!1,new ix(!1,null,!0)):this.backoffId_=Vpe(e,n,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&Upe(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()}}class ix{constructor(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}}function Hpe(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function qpe(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function Kpe(t,e){e&&(t["X-Firebase-GMPID"]=e)}function Ype(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function Jpe(t,e,n,r,s,i,o=!0,l=!1){const c=kz(t.urlParams),u=t.url+c,d=Object.assign({},t.headers);return Kpe(d,e),Hpe(d,n),qpe(d,i),Ype(d,r),new Wpe(u,t.method,d,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,s,o,l)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xpe(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function Qpe(...t){const e=Xpe();if(e!==void 0){const n=new e;for(let r=0;r<t.length;r++)n.append(t[r]);return n.getBlob()}else{if(pP())return new Blob(t);throw new Ar(Pr.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}}function Zpe(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ege(t){if(typeof atob>"u")throw Fpe("base-64");return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ha={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class ES{constructor(e,n){this.data=e,this.contentType=n||null}}function tge(t,e){switch(t){case ha.RAW:return new ES(Rz(e));case ha.BASE64:case ha.BASE64URL:return new ES(jz(t,e));case ha.DATA_URL:return new ES(rge(e),sge(e))}throw fP()}function Rz(t){const e=[];for(let n=0;n<t.length;n++){let r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296)if(!(n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320))e.push(239,191,189);else{const i=r,o=t.charCodeAt(++n);r=65536|(i&1023)<<10|o&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function nge(t){let e;try{e=decodeURIComponent(t)}catch{throw dp(ha.DATA_URL,"Malformed data URL.")}return Rz(e)}function jz(t,e){switch(t){case ha.BASE64:{const s=e.indexOf("-")!==-1,i=e.indexOf("_")!==-1;if(s||i)throw dp(t,"Invalid character '"+(s?"-":"_")+"' found: is it base64url encoded?");break}case ha.BASE64URL:{const s=e.indexOf("+")!==-1,i=e.indexOf("/")!==-1;if(s||i)throw dp(t,"Invalid character '"+(s?"+":"/")+"' found: is it base64 encoded?");e=e.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=ege(e)}catch(s){throw s.message.includes("polyfill")?s:dp(t,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class Dz{constructor(e){this.base64=!1,this.contentType=null;const n=e.match(/^data:([^,]+)?,/);if(n===null)throw dp(ha.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const r=n[1]||null;r!=null&&(this.base64=ige(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}}function rge(t){const e=new Dz(t);return e.base64?jz(ha.BASE64,e.rest):nge(e.rest)}function sge(t){return new Dz(t).contentType}function ige(t,e){return t.length>=e.length?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e,n){let r=0,s="";GM(e)?(this.data_=e,r=e.size,s=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=s}size(){return this.size_}type(){return this.type_}slice(e,n){if(GM(this.data_)){const r=this.data_,s=Zpe(r,e,n);return s===null?null:new Kl(s)}else{const r=new Uint8Array(this.data_.buffer,e,n-e);return new Kl(r,!0)}}static getBlob(...e){if(pP()){const n=e.map(r=>r instanceof Kl?r.data_:r);return new Kl(Qpe.apply(null,n))}else{const n=e.map(o=>mP(o)?tge(ha.RAW,o).data:o.data_);let r=0;n.forEach(o=>{r+=o.byteLength});const s=new Uint8Array(r);let i=0;return n.forEach(o=>{for(let l=0;l<o.length;l++)s[i++]=o[l]}),new Kl(s,!0)}}uploadData(){return this.data_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mz(t){let e;try{e=JSON.parse(t)}catch{return null}return zpe(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oge(t){if(t.length===0)return null;const e=t.lastIndexOf("/");return e===-1?"":t.slice(0,e)}function age(t,e){const n=e.split("/").filter(r=>r.length>0).join("/");return t.length===0?n:t+"/"+n}function Lz(t){const e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lge(t,e){return e}class zs{constructor(e,n,r,s){this.server=e,this.local=n||e,this.writable=!!r,this.xform=s||lge}}let ox=null;function cge(t){return!mP(t)||t.length<2?t:Lz(t)}function Fz(){if(ox)return ox;const t=[];t.push(new zs("bucket")),t.push(new zs("generation")),t.push(new zs("metageneration")),t.push(new zs("name","fullPath",!0));function e(i,o){return cge(o)}const n=new zs("name");n.xform=e,t.push(n);function r(i,o){return o!==void 0?Number(o):o}const s=new zs("size");return s.xform=r,t.push(s),t.push(new zs("timeCreated")),t.push(new zs("updated")),t.push(new zs("md5Hash",null,!0)),t.push(new zs("cacheControl",null,!0)),t.push(new zs("contentDisposition",null,!0)),t.push(new zs("contentEncoding",null,!0)),t.push(new zs("contentLanguage",null,!0)),t.push(new zs("contentType",null,!0)),t.push(new zs("metadata","customMetadata",!0)),ox=t,ox}function uge(t,e){function n(){const r=t.bucket,s=t.fullPath,i=new Wi(r,s);return e._makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function dge(t,e,n){const r={};r.type="file";const s=n.length;for(let i=0;i<s;i++){const o=n[i];r[o.local]=o.xform(r,e[o.server])}return uge(r,t),r}function Oz(t,e,n){const r=Mz(e);return r===null?null:dge(t,r,n)}function hge(t,e,n,r){const s=Mz(e);if(s===null||!mP(s.downloadTokens))return null;const i=s.downloadTokens;if(i.length===0)return null;const o=encodeURIComponent;return i.split(",").map(u=>{const d=t.bucket,h=t.fullPath,f="/b/"+o(d)+"/o/"+o(h),m=gP(f,n,r),g=kz({alt:"media",token:u});return m+g})[0]}function fge(t,e){const n={},r=e.length;for(let s=0;s<r;s++){const i=e[s];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}class $z{constructor(e,n,r,s){this.url=e,this.method=n,this.handler=r,this.timeout=s,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vz(t){if(!t)throw fP()}function mge(t,e){function n(r,s){const i=Oz(t,s,e);return Vz(i!==null),i}return n}function pge(t,e){function n(r,s){const i=Oz(t,s,e);return Vz(i!==null),hge(i,s,t.host,t._protocol)}return n}function Uz(t){function e(n,r){let s;return n.getStatus()===401?n.getErrorText().includes("Firebase App Check token is invalid")?s=Npe():s=Ipe():n.getStatus()===402?s=Tpe(t.bucket):n.getStatus()===403?s=Ppe(t.path):s=r,s.status=n.getStatus(),s.serverResponse=r.serverResponse,s}return e}function gge(t){const e=Uz(t);function n(r,s){let i=e(r,s);return r.getStatus()===404&&(i=Epe(t.path)),i.serverResponse=s.serverResponse,i}return n}function yge(t,e,n){const r=e.fullServerUrl(),s=gP(r,t.host,t._protocol),i="GET",o=t.maxOperationRetryTime,l=new $z(s,i,pge(t,n),o);return l.errorHandler=gge(e),l}function xge(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function vge(t,e,n){const r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=xge(null,e)),r}function wge(t,e,n,r,s){const i=e.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};function l(){let C="";for(let T=0;T<2;T++)C=C+Math.random().toString().slice(2);return C}const c=l();o["Content-Type"]="multipart/related; boundary="+c;const u=vge(e,r,s),d=fge(u,n),h="--"+c+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+d+`\r
--`+c+`\r
Content-Type: `+u.contentType+`\r
\r
`,f=`\r
--`+c+"--",m=Kl.getBlob(h,r,f);if(m===null)throw Mpe();const g={name:u.fullPath},x=gP(i,t.host,t._protocol),w="POST",v=t.maxUploadRetryTime,_=new $z(x,w,mge(t,n),v);return _.urlParams=g,_.headers=o,_.body=m.uploadData(),_.errorHandler=Uz(e),_}class bge{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=Bu.NO_ERROR,this.sendPromise_=new Promise(e=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=Bu.ABORT,e()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=Bu.NETWORK_ERROR,e()}),this.xhr_.addEventListener("load",()=>{e()})})}send(e,n,r,s,i){if(this.sent_)throw mm("cannot .send() more than once");if(Uc(e)&&r&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(n,e,!0),i!==void 0)for(const o in i)i.hasOwnProperty(o)&&this.xhr_.setRequestHeader(o,i[o].toString());return s!==void 0?this.xhr_.send(s):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw mm("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw mm("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}}getResponse(){if(!this.sent_)throw mm("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw mm("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)}}class _ge extends bge{initXhr(){this.xhr_.responseType="text"}}function Bz(){return new _ge}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ld{constructor(e,n){this._service=e,n instanceof Wi?this._location=n:this._location=Wi.makeFromUrl(n,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,n){return new ld(e,n)}get root(){const e=new Wi(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return Lz(this._location.path)}get storage(){return this._service}get parent(){const e=oge(this._location.path);if(e===null)return null;const n=new Wi(this._location.bucket,e);return new ld(this._service,n)}_throwIfRoot(e){if(this._location.path==="")throw Ope(e)}}function Sge(t,e,n){t._throwIfRoot("uploadBytes");const r=wge(t.storage,t._location,Fz(),new Kl(e,!0),n);return t.storage.makeRequestWithTokens(r,Bz).then(s=>({metadata:s,ref:t}))}function Cge(t){t._throwIfRoot("getDownloadURL");const e=yge(t.storage,t._location,Fz());return t.storage.makeRequestWithTokens(e,Bz).then(n=>{if(n===null)throw Lpe();return n})}function Ege(t,e){const n=age(t._location.path,e),r=new Wi(t._location.bucket,n);return new ld(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tge(t){return/^[A-Za-z]+:\/\//.test(t)}function Ige(t,e){return new ld(t,e)}function zz(t,e){if(t instanceof yP){const n=t;if(n._bucket==null)throw Dpe();const r=new ld(n,n._bucket);return e!=null?zz(r,e):r}else return e!==void 0?Ege(t,e):t}function Nge(t,e){if(e&&Tge(e)){if(t instanceof yP)return Ige(t,e);throw bT("To use ref(service, url), the first argument must be a Storage instance.")}else return zz(t,e)}function HM(t,e){const n=e==null?void 0:e[Pz];return n==null?null:Wi.makeFromBucketSpec(n,t)}function Pge(t,e,n,r={}){t.host=`${e}:${n}`;const s=Uc(e);s&&(J0(`https://${t.host}`),X0("Storage",!0)),t._isUsingEmulator=!0,t._protocol=s?"https":"http";const{mockUserToken:i}=r;i&&(t._overrideAuthToken=typeof i=="string"?i:b5(i,t.app.options.projectId))}class yP{constructor(e,n,r,s,i,o=!1){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._url=s,this._firebaseVersion=i,this._isUsingEmulator=o,this._bucket=null,this._host=Nz,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=Spe,this._maxUploadRetryTime=Cpe,this._requests=new Set,s!=null?this._bucket=Wi.makeFromBucketSpec(s,this._host):this._bucket=HM(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,this._url!=null?this._bucket=Wi.makeFromBucketSpec(this._url,e):this._bucket=HM(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){WM("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){WM("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const n=await e.getToken();if(n!==null)return n.accessToken}return null}async _getAppCheckToken(){if(Ks(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});return e?(await e.getToken()).token:null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(e=>e.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ld(this,e)}_makeRequest(e,n,r,s,i=!0){if(this._deleted)return new $pe(Az());{const o=Jpe(e,this._appId,r,s,n,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(o),o.getPromise().then(()=>this._requests.delete(o),()=>this._requests.delete(o)),o}}async makeRequestWithTokens(e,n){const[r,s]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,n,r,s).getPromise()}}const qM="@firebase/storage",KM="0.13.12";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Gz="storage";function ph(t,e,n){return t=Jn(t),Sge(t,e,n)}function gh(t){return t=Jn(t),Cge(t)}function yh(t,e){return t=Jn(t),Nge(t,e)}function Age(t=Q0(),e){t=Jn(t);const r=Mg(t,Gz).getImmediate({identifier:e}),s=rN("storage");return s&&kge(r,...s),r}function kge(t,e,n,r={}){Pge(t,e,n,r)}function Rge(t,{instanceIdentifier:e}){const n=t.getProvider("app").getImmediate(),r=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal");return new yP(n,r,s,e,md)}function jge(){Sc(new ll(Gz,Rge,"PUBLIC").setMultipleInstances(!0)),mo(qM,KM,""),mo(qM,KM,"esm2017")}jge();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Dge="type.googleapis.com/google.protobuf.Int64Value",Mge="type.googleapis.com/google.protobuf.UInt64Value";function Wz(t,e){const n={};for(const r in t)t.hasOwnProperty(r)&&(n[r]=e(t[r]));return n}function Lw(t){if(t==null)return null;if(t instanceof Number&&(t=t.valueOf()),typeof t=="number"&&isFinite(t)||t===!0||t===!1||Object.prototype.toString.call(t)==="[object String]")return t;if(t instanceof Date)return t.toISOString();if(Array.isArray(t))return t.map(e=>Lw(e));if(typeof t=="function"||typeof t=="object")return Wz(t,e=>Lw(e));throw new Error("Data cannot be encoded in JSON: "+t)}function xf(t){if(t==null)return t;if(t["@type"])switch(t["@type"]){case Dge:case Mge:{const e=Number(t.value);if(isNaN(e))throw new Error("Data cannot be decoded from JSON: "+t);return e}default:throw new Error("Data cannot be decoded from JSON: "+t)}return Array.isArray(t)?t.map(e=>xf(e)):typeof t=="function"||typeof t=="object"?Wz(t,e=>xf(e)):t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xP="functions";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const YM={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class fi extends Xo{constructor(e,n,r){super(`${xP}/${e}`,n||""),this.details=r,Object.setPrototypeOf(this,fi.prototype)}}function Lge(t){if(t>=200&&t<300)return"ok";switch(t){case 0:return"internal";case 400:return"invalid-argument";case 401:return"unauthenticated";case 403:return"permission-denied";case 404:return"not-found";case 409:return"aborted";case 429:return"resource-exhausted";case 499:return"cancelled";case 500:return"internal";case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline-exceeded"}return"unknown"}function Fw(t,e){let n=Lge(t),r=n,s;try{const i=e&&e.error;if(i){const o=i.status;if(typeof o=="string"){if(!YM[o])return new fi("internal","internal");n=YM[o],r=o}const l=i.message;typeof l=="string"&&(r=l),s=i.details,s!==void 0&&(s=xf(s))}}catch{}return n==="ok"?null:new fi(n,r,s)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fge{constructor(e,n,r,s){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,Ks(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=n.getImmediate({optional:!0}),this.messaging=r.getImmediate({optional:!0}),this.auth||n.get().then(i=>this.auth=i,()=>{}),this.messaging||r.get().then(i=>this.messaging=i,()=>{}),this.appCheck||s==null||s.get().then(i=>this.appCheck=i,()=>{})}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e==null?void 0:e.accessToken}catch{return}}async getMessagingToken(){if(!(!this.messaging||!("Notification"in self)||Notification.permission!=="granted"))try{return await this.messaging.getToken()}catch{return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const n=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return n.error?null:n.token}return null}async getContext(e){const n=await this.getAuthToken(),r=await this.getMessagingToken(),s=await this.getAppCheckToken(e);return{authToken:n,messagingToken:r,appCheckToken:s}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _T="us-central1",Oge=/^data: (.*?)(?:\n|$)/;function $ge(t){let e=null;return{promise:new Promise((n,r)=>{e=setTimeout(()=>{r(new fi("deadline-exceeded","deadline-exceeded"))},t)}),cancel:()=>{e&&clearTimeout(e)}}}class Vge{constructor(e,n,r,s,i=_T,o=(...l)=>fetch(...l)){this.app=e,this.fetchImpl=o,this.emulatorOrigin=null,this.contextProvider=new Fge(e,n,r,s),this.cancelAllRequests=new Promise(l=>{this.deleteService=()=>Promise.resolve(l())});try{const l=new URL(i);this.customDomain=l.origin+(l.pathname==="/"?"":l.pathname),this.region=_T}catch{this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const n=this.app.options.projectId;return this.emulatorOrigin!==null?`${this.emulatorOrigin}/${n}/${this.region}/${e}`:this.customDomain!==null?`${this.customDomain}/${e}`:`https://${this.region}-${n}.cloudfunctions.net/${e}`}}function Uge(t,e,n){const r=Uc(e);t.emulatorOrigin=`http${r?"s":""}://${e}:${n}`,r&&(J0(t.emulatorOrigin),X0("Functions",!0))}function Bge(t,e,n){const r=s=>Gge(t,e,s,n||{});return r.stream=(s,i)=>Hge(t,e,s,i),r}async function zge(t,e,n,r){n["Content-Type"]="application/json";let s;try{s=await r(t,{method:"POST",body:JSON.stringify(e),headers:n})}catch{return{status:0,json:null}}let i=null;try{i=await s.json()}catch{}return{status:s.status,json:i}}async function Hz(t,e){const n={},r=await t.contextProvider.getContext(e.limitedUseAppCheckTokens);return r.authToken&&(n.Authorization="Bearer "+r.authToken),r.messagingToken&&(n["Firebase-Instance-ID-Token"]=r.messagingToken),r.appCheckToken!==null&&(n["X-Firebase-AppCheck"]=r.appCheckToken),n}function Gge(t,e,n,r){const s=t._url(e);return Wge(t,s,n,r)}async function Wge(t,e,n,r){n=Lw(n);const s={data:n},i=await Hz(t,r),o=r.timeout||7e4,l=$ge(o),c=await Promise.race([zge(e,s,i,t.fetchImpl),l.promise,t.cancelAllRequests]);if(l.cancel(),!c)throw new fi("cancelled","Firebase Functions instance was deleted.");const u=Fw(c.status,c.json);if(u)throw u;if(!c.json)throw new fi("internal","Response is not valid JSON object.");let d=c.json.data;if(typeof d>"u"&&(d=c.json.result),typeof d>"u")throw new fi("internal","Response is missing data field.");return{data:xf(d)}}function Hge(t,e,n,r){const s=t._url(e);return qge(t,s,n,r||{})}async function qge(t,e,n,r){var s;n=Lw(n);const i={data:n},o=await Hz(t,r);o["Content-Type"]="application/json",o.Accept="text/event-stream";let l;try{l=await t.fetchImpl(e,{method:"POST",body:JSON.stringify(i),headers:o,signal:r==null?void 0:r.signal})}catch(m){if(m instanceof Error&&m.name==="AbortError"){const x=new fi("cancelled","Request was cancelled.");return{data:Promise.reject(x),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(x)}}}}}}const g=Fw(0,null);return{data:Promise.reject(g),stream:{[Symbol.asyncIterator](){return{next(){return Promise.reject(g)}}}}}}let c,u;const d=new Promise((m,g)=>{c=m,u=g});(s=r==null?void 0:r.signal)===null||s===void 0||s.addEventListener("abort",()=>{const m=new fi("cancelled","Request was cancelled.");u(m)});const h=l.body.getReader(),f=Kge(h,c,u,r==null?void 0:r.signal);return{stream:{[Symbol.asyncIterator](){const m=f.getReader();return{async next(){const{value:g,done:x}=await m.read();return{value:g,done:x}},async return(){return await m.cancel(),{done:!0,value:void 0}}}}},data:d}}function Kge(t,e,n,r){const s=(o,l)=>{const c=o.match(Oge);if(!c)return;const u=c[1];try{const d=JSON.parse(u);if("result"in d){e(xf(d.result));return}if("message"in d){l.enqueue(xf(d.message));return}if("error"in d){const h=Fw(0,d);l.error(h),n(h);return}}catch(d){if(d instanceof fi){l.error(d),n(d);return}}},i=new TextDecoder;return new ReadableStream({start(o){let l="";return c();async function c(){if(r!=null&&r.aborted){const u=new fi("cancelled","Request was cancelled");return o.error(u),n(u),Promise.resolve()}try{const{value:u,done:d}=await t.read();if(d){l.trim()&&s(l.trim(),o),o.close();return}if(r!=null&&r.aborted){const f=new fi("cancelled","Request was cancelled");o.error(f),n(f),await t.cancel();return}l+=i.decode(u,{stream:!0});const h=l.split(`
`);l=h.pop()||"";for(const f of h)f.trim()&&s(f.trim(),o);return c()}catch(u){const d=u instanceof fi?u:Fw(0,null);o.error(d),n(d)}}},cancel(){return t.cancel()}})}const JM="@firebase/functions",XM="0.12.8";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yge="auth-internal",Jge="app-check-internal",Xge="messaging-internal";function Qge(t){const e=(n,{instanceIdentifier:r})=>{const s=n.getProvider("app").getImmediate(),i=n.getProvider(Yge),o=n.getProvider(Xge),l=n.getProvider(Jge);return new Vge(s,i,o,l,r)};Sc(new ll(xP,e,"PUBLIC").setMultipleInstances(!0)),mo(JM,XM,t),mo(JM,XM,"esm2017")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ow(t=Q0(),e=_T){const r=Mg(Jn(t),xP).getImmediate({identifier:e}),s=rN("functions");return s&&Zge(r,...s),r}function Zge(t,e,n){Uge(Jn(t),e,n)}function Xa(t,e,n){return Bge(Jn(t),e,n)}Qge();function mc(t){return t?t.toLowerCase().replace(/\s+/g,"-"):""}const eye={apiKey:"AIzaSyD-SN32SMJ0KvfJOTfQZhUybhMNYhJUFwk",authDomain:"fresh-dfe30.firebaseapp.com",projectId:"fresh-dfe30",storageBucket:"fresh-dfe30.firebasestorage.app",messagingSenderId:"351642971625",appId:"1:351642971625:web:0fce09447c86ab9b0a6f78"},Tb=N5(eye),hp=zde(Tb),qz=ope(Tb),xh=Age(Tb),Oh=Ow(Tb);try{ape(qz,{cacheSizeBytes:ipe}).then(()=>{console.log("Firestore offline persistence enabled.")}).catch(t=>{t.code=="failed-precondition"?console.warn("Firestore offline persistence failed: Multiple tabs open or other precondition failed.",t):t.code=="unimplemented"?console.warn("Firestore offline persistence failed: Browser does not support required features.",t):console.error("Firestore offline persistence failed with error: ",t)})}catch(t){console.error("Error enabling Firestore offline persistence: ",t)}const gn=qz;async function ST(t){if(!t||typeof t!="string"||t.trim()==="")return!1;const e=t.trim().toLowerCase();try{const n=ki(gn,"stores"),r=vT(n,wT("name_lowercase","==",e),xpe(1));return!(await Ri(r)).empty}catch(n){throw console.error("Error checking store name availability in Firestore:",n),new Error("Failed to check store name availability due to a database error.")}}const Kz=p.createContext(),tye=({children:t})=>{const[e,n]=p.useState(null),[r,s]=p.useState(null),[i,o]=p.useState(null),[l,c]=p.useState(!0),[u,d]=p.useState(null);p.useEffect(()=>{let g=()=>{};const x=kue(hp,async w=>{if(c(!0),n(w),s(w),g(),w){const v=rs(gn,"profiles",w.uid);g=Tz(v,_=>{if(_.exists()){const C=_.data();o(C),d((C==null?void 0:C.role)||"store_owner"),console.log("AuthContext: Profile updated from snapshot:",C)}else console.warn("AuthContext: No profile found for user:",w.uid),o(null),d("store_owner");c(!1)},_=>{console.error("AuthContext: Error listening to profile:",_.message),o(null),d(null),c(!1)})}else o(null),d(null),c(!1)});return()=>{x(),g()}},[]);const m={user:e,session:r,profile:i,isAuthenticated:!!r&&!!e,userRole:u,loadingRole:l,logout:async()=>{try{await Rue(hp),console.log("User signed out successfully.")}catch(g){console.error("Error signing out: ",g)}},subscriptionStatus:"inactive"};return a.jsx(Kz.Provider,{value:m,children:t})},ls=()=>{const t=p.useContext(Kz);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},vP=t=>rs(gn,"users",t),CT=async t=>{const e=vP(t);(await uP(e)).exists()||await Fh(e,{credits:100})},nye=async t=>{if(!t)return 0;const e=vP(t),n=await uP(e);return n.exists()?n.data().credits:(await CT(t),100)},ba=async(t,e)=>await nye(t)>=e,Qa=async(t,e)=>{if(!t)throw new Error("User not authenticated");if(!await ba(t,e))throw new Error("Insufficient credits");const r=vP(t);await Zd(r,{credits:_pe(-e)})},wP=p.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"}),Ib=p.createContext({}),Nb=p.createContext(null),Pb=typeof document<"u",Jg=Pb?p.useLayoutEffect:p.useEffect,Yz=p.createContext({strict:!1}),bP=t=>t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),rye="framerAppearId",Jz="data-"+bP(rye);function sye(t,e,n,r){const{visualElement:s}=p.useContext(Ib),i=p.useContext(Yz),o=p.useContext(Nb),l=p.useContext(wP).reducedMotion,c=p.useRef();r=r||i.renderer,!c.current&&r&&(c.current=r(t,{visualState:e,parent:s,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current;p.useInsertionEffect(()=>{u&&u.update(n,o)});const d=p.useRef(!!(n[Jz]&&!window.HandoffComplete));return Jg(()=>{u&&(u.render(),d.current&&u.animationState&&u.animationState.animateChanges())}),p.useEffect(()=>{u&&(u.updateFeatures(),!d.current&&u.animationState&&u.animationState.animateChanges(),d.current&&(d.current=!1,window.HandoffComplete=!0))}),u}function vh(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function iye(t,e,n){return p.useCallback(r=>{r&&t.mount&&t.mount(r),e&&(r?e.mount(r):e.unmount()),n&&(typeof n=="function"?n(r):vh(n)&&(n.current=r))},[e])}function ag(t){return typeof t=="string"||Array.isArray(t)}function Ab(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}const _P=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],SP=["initial",..._P];function kb(t){return Ab(t.animate)||SP.some(e=>ag(t[e]))}function Xz(t){return!!(kb(t)||t.variants)}function oye(t,e){if(kb(t)){const{initial:n,animate:r}=t;return{initial:n===!1||ag(n)?n:void 0,animate:ag(r)?r:void 0}}return t.inherit!==!1?e:{}}function aye(t){const{initial:e,animate:n}=oye(t,p.useContext(Ib));return p.useMemo(()=>({initial:e,animate:n}),[QM(e),QM(n)])}function QM(t){return Array.isArray(t)?t.join(" "):t}const ZM={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},lg={};for(const t in ZM)lg[t]={isEnabled:e=>ZM[t].some(n=>!!e[n])};function lye(t){for(const e in t)lg[e]={...lg[e],...t[e]}}const CP=p.createContext({}),Qz=p.createContext({}),cye=Symbol.for("motionComponentSymbol");function uye({preloadedFeatures:t,createVisualElement:e,useRender:n,useVisualState:r,Component:s}){t&&lye(t);function i(l,c){let u;const d={...p.useContext(wP),...l,layoutId:dye(l)},{isStatic:h}=d,f=aye(l),m=r(l,h);if(!h&&Pb){f.visualElement=sye(s,m,d,e);const g=p.useContext(Qz),x=p.useContext(Yz).strict;f.visualElement&&(u=f.visualElement.loadFeatures(d,x,t,g))}return p.createElement(Ib.Provider,{value:f},u&&f.visualElement?p.createElement(u,{visualElement:f.visualElement,...d}):null,n(s,l,iye(m,f.visualElement,c),m,h,f.visualElement))}const o=p.forwardRef(i);return o[cye]=s,o}function dye({layoutId:t}){const e=p.useContext(CP).id;return e&&t!==void 0?e+"-"+t:t}function hye(t){function e(r,s={}){return uye(t(r,s))}if(typeof Proxy>"u")return e;const n=new Map;return new Proxy(e,{get:(r,s)=>(n.has(s)||n.set(s,e(s)),n.get(s))})}const fye=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function EP(t){return typeof t!="string"||t.includes("-")?!1:!!(fye.indexOf(t)>-1||/[A-Z]/.test(t))}const $w={};function mye(t){Object.assign($w,t)}const Xg=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],yd=new Set(Xg);function Zz(t,{layout:e,layoutId:n}){return yd.has(t)||t.startsWith("origin")||(e||n!==void 0)&&(!!$w[t]||t==="opacity")}const vi=t=>!!(t&&t.getVelocity),pye={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},gye=Xg.length;function yye(t,{enableHardwareAcceleration:e=!0,allowTransformNone:n=!0},r,s){let i="";for(let o=0;o<gye;o++){const l=Xg[o];if(t[l]!==void 0){const c=pye[l]||l;i+=`${c}(${t[l]}) `}}return e&&!t.z&&(i+="translateZ(0)"),i=i.trim(),s?i=s(t,r?"":i):n&&r&&(i="none"),i}const e9=t=>e=>typeof e=="string"&&e.startsWith(t),t9=e9("--"),ET=e9("var(--"),xye=/var\s*\(\s*--[\w-]+(\s*,\s*(?:(?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)+)?\s*\)/g,vye=(t,e)=>e&&typeof t=="number"?e.transform(t):t,Nc=(t,e,n)=>Math.min(Math.max(n,t),e),xd={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},fp={...xd,transform:t=>Nc(0,1,t)},ax={...xd,default:1},mp=t=>Math.round(t*1e5)/1e5,Rb=/(-)?([\d]*\.?[\d])+/g,n9=/(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))/gi,wye=/^(#[0-9a-f]{3,8}|(rgb|hsl)a?\((-?[\d\.]+%?[,\s]+){2}(-?[\d\.]+%?)\s*[\,\/]?\s*[\d\.]*%?\))$/i;function Qg(t){return typeof t=="string"}const Zg=t=>({test:e=>Qg(e)&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Ll=Zg("deg"),_a=Zg("%"),Ft=Zg("px"),bye=Zg("vh"),_ye=Zg("vw"),e4={..._a,parse:t=>_a.parse(t)/100,transform:t=>_a.transform(t*100)},t4={...xd,transform:Math.round},r9={borderWidth:Ft,borderTopWidth:Ft,borderRightWidth:Ft,borderBottomWidth:Ft,borderLeftWidth:Ft,borderRadius:Ft,radius:Ft,borderTopLeftRadius:Ft,borderTopRightRadius:Ft,borderBottomRightRadius:Ft,borderBottomLeftRadius:Ft,width:Ft,maxWidth:Ft,height:Ft,maxHeight:Ft,size:Ft,top:Ft,right:Ft,bottom:Ft,left:Ft,padding:Ft,paddingTop:Ft,paddingRight:Ft,paddingBottom:Ft,paddingLeft:Ft,margin:Ft,marginTop:Ft,marginRight:Ft,marginBottom:Ft,marginLeft:Ft,rotate:Ll,rotateX:Ll,rotateY:Ll,rotateZ:Ll,scale:ax,scaleX:ax,scaleY:ax,scaleZ:ax,skew:Ll,skewX:Ll,skewY:Ll,distance:Ft,translateX:Ft,translateY:Ft,translateZ:Ft,x:Ft,y:Ft,z:Ft,perspective:Ft,transformPerspective:Ft,opacity:fp,originX:e4,originY:e4,originZ:Ft,zIndex:t4,fillOpacity:fp,strokeOpacity:fp,numOctaves:t4};function TP(t,e,n,r){const{style:s,vars:i,transform:o,transformOrigin:l}=t;let c=!1,u=!1,d=!0;for(const h in e){const f=e[h];if(t9(h)){i[h]=f;continue}const m=r9[h],g=vye(f,m);if(yd.has(h)){if(c=!0,o[h]=g,!d)continue;f!==(m.default||0)&&(d=!1)}else h.startsWith("origin")?(u=!0,l[h]=g):s[h]=g}if(e.transform||(c||r?s.transform=yye(t.transform,n,d,r):s.transform&&(s.transform="none")),u){const{originX:h="50%",originY:f="50%",originZ:m=0}=l;s.transformOrigin=`${h} ${f} ${m}`}}const IP=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function s9(t,e,n){for(const r in e)!vi(e[r])&&!Zz(r,n)&&(t[r]=e[r])}function Sye({transformTemplate:t},e,n){return p.useMemo(()=>{const r=IP();return TP(r,e,{enableHardwareAcceleration:!n},t),Object.assign({},r.vars,r.style)},[e])}function Cye(t,e,n){const r=t.style||{},s={};return s9(s,r,t),Object.assign(s,Sye(t,e,n)),t.transformValues?t.transformValues(s):s}function Eye(t,e,n){const r={},s=Cye(t,e,n);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,s.userSelect=s.WebkitUserSelect=s.WebkitTouchCallout="none",s.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=s,r}const Tye=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","transformValues","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Vw(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||Tye.has(t)}let i9=t=>!Vw(t);function Iye(t){t&&(i9=e=>e.startsWith("on")?!Vw(e):t(e))}try{Iye(require("@emotion/is-prop-valid").default)}catch{}function Nye(t,e,n){const r={};for(const s in t)s==="values"&&typeof t.values=="object"||(i9(s)||n===!0&&Vw(s)||!e&&!Vw(s)||t.draggable&&s.startsWith("onDrag"))&&(r[s]=t[s]);return r}function n4(t,e,n){return typeof t=="string"?t:Ft.transform(e+n*t)}function Pye(t,e,n){const r=n4(e,t.x,t.width),s=n4(n,t.y,t.height);return`${r} ${s}`}const Aye={offset:"stroke-dashoffset",array:"stroke-dasharray"},kye={offset:"strokeDashoffset",array:"strokeDasharray"};function Rye(t,e,n=1,r=0,s=!0){t.pathLength=1;const i=s?Aye:kye;t[i.offset]=Ft.transform(-r);const o=Ft.transform(e),l=Ft.transform(n);t[i.array]=`${o} ${l}`}function NP(t,{attrX:e,attrY:n,attrScale:r,originX:s,originY:i,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},d,h,f){if(TP(t,u,d,f),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:m,style:g,dimensions:x}=t;m.transform&&(x&&(g.transform=m.transform),delete m.transform),x&&(s!==void 0||i!==void 0||g.transform)&&(g.transformOrigin=Pye(x,s!==void 0?s:.5,i!==void 0?i:.5)),e!==void 0&&(m.x=e),n!==void 0&&(m.y=n),r!==void 0&&(m.scale=r),o!==void 0&&Rye(m,o,l,c,!1)}const o9=()=>({...IP(),attrs:{}}),PP=t=>typeof t=="string"&&t.toLowerCase()==="svg";function jye(t,e,n,r){const s=p.useMemo(()=>{const i=o9();return NP(i,e,{enableHardwareAcceleration:!1},PP(r),t.transformTemplate),{...i.attrs,style:{...i.style}}},[e]);if(t.style){const i={};s9(i,t.style,t),s.style={...i,...s.style}}return s}function Dye(t=!1){return(n,r,s,{latestValues:i},o)=>{const c=(EP(n)?jye:Eye)(r,i,o,n),d={...Nye(r,typeof n=="string",t),...c,ref:s},{children:h}=r,f=p.useMemo(()=>vi(h)?h.get():h,[h]);return p.createElement(n,{...d,children:f})}}function a9(t,{style:e,vars:n},r,s){Object.assign(t.style,e,s&&s.getProjectionStyles(r));for(const i in n)t.style.setProperty(i,n[i])}const l9=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function c9(t,e,n,r){a9(t,e,void 0,r);for(const s in e.attrs)t.setAttribute(l9.has(s)?s:bP(s),e.attrs[s])}function AP(t,e){const{style:n}=t,r={};for(const s in n)(vi(n[s])||e.style&&vi(e.style[s])||Zz(s,t))&&(r[s]=n[s]);return r}function u9(t,e){const n=AP(t,e);for(const r in t)if(vi(t[r])||vi(e[r])){const s=Xg.indexOf(r)!==-1?"attr"+r.charAt(0).toUpperCase()+r.substring(1):r;n[s]=t[r]}return n}function kP(t,e,n,r={},s={}){return typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"&&(e=e(n!==void 0?n:t.custom,r,s)),e}function ey(t){const e=p.useRef(null);return e.current===null&&(e.current=t()),e.current}const Uw=t=>Array.isArray(t),Mye=t=>!!(t&&typeof t=="object"&&t.mix&&t.toValue),Lye=t=>Uw(t)?t[t.length-1]||0:t;function cv(t){const e=vi(t)?t.get():t;return Mye(e)?e.toValue():e}function Fye({scrapeMotionValuesFromProps:t,createRenderState:e,onMount:n},r,s,i){const o={latestValues:Oye(r,s,i,t),renderState:e()};return n&&(o.mount=l=>n(r,l,o)),o}const d9=t=>(e,n)=>{const r=p.useContext(Ib),s=p.useContext(Nb),i=()=>Fye(t,e,r,s);return n?i():ey(i)};function Oye(t,e,n,r){const s={},i=r(t,{});for(const f in i)s[f]=cv(i[f]);let{initial:o,animate:l}=t;const c=kb(t),u=Xz(t);e&&u&&!c&&t.inherit!==!1&&(o===void 0&&(o=e.initial),l===void 0&&(l=e.animate));let d=n?n.initial===!1:!1;d=d||o===!1;const h=d?l:o;return h&&typeof h!="boolean"&&!Ab(h)&&(Array.isArray(h)?h:[h]).forEach(m=>{const g=kP(t,m);if(!g)return;const{transitionEnd:x,transition:w,...v}=g;for(const _ in v){let C=v[_];if(Array.isArray(C)){const T=d?C.length-1:0;C=C[T]}C!==null&&(s[_]=C)}for(const _ in x)s[_]=x[_]}),s}const Er=t=>t;class r4{constructor(){this.order=[],this.scheduled=new Set}add(e){if(!this.scheduled.has(e))return this.scheduled.add(e),this.order.push(e),!0}remove(e){const n=this.order.indexOf(e);n!==-1&&(this.order.splice(n,1),this.scheduled.delete(e))}clear(){this.order.length=0,this.scheduled.clear()}}function $ye(t){let e=new r4,n=new r4,r=0,s=!1,i=!1;const o=new WeakSet,l={schedule:(c,u=!1,d=!1)=>{const h=d&&s,f=h?e:n;return u&&o.add(c),f.add(c)&&h&&s&&(r=e.order.length),c},cancel:c=>{n.remove(c),o.delete(c)},process:c=>{if(s){i=!0;return}if(s=!0,[e,n]=[n,e],n.clear(),r=e.order.length,r)for(let u=0;u<r;u++){const d=e.order[u];d(c),o.has(d)&&(l.schedule(d),t())}s=!1,i&&(i=!1,l.process(c))}};return l}const lx=["prepare","read","update","preRender","render","postRender"],Vye=40;function Uye(t,e){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=lx.reduce((h,f)=>(h[f]=$ye(()=>n=!0),h),{}),o=h=>i[h].process(s),l=()=>{const h=performance.now();n=!1,s.delta=r?1e3/60:Math.max(Math.min(h-s.timestamp,Vye),1),s.timestamp=h,s.isProcessing=!0,lx.forEach(o),s.isProcessing=!1,n&&e&&(r=!1,t(l))},c=()=>{n=!0,r=!0,s.isProcessing||t(l)};return{schedule:lx.reduce((h,f)=>{const m=i[f];return h[f]=(g,x=!1,w=!1)=>(n||c(),m.schedule(g,x,w)),h},{}),cancel:h=>lx.forEach(f=>i[f].cancel(h)),state:s,steps:i}}const{schedule:bn,cancel:Ho,state:ms,steps:TS}=Uye(typeof requestAnimationFrame<"u"?requestAnimationFrame:Er,!0),Bye={useVisualState:d9({scrapeMotionValuesFromProps:u9,createRenderState:o9,onMount:(t,e,{renderState:n,latestValues:r})=>{bn.read(()=>{try{n.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{n.dimensions={x:0,y:0,width:0,height:0}}}),bn.render(()=>{NP(n,r,{enableHardwareAcceleration:!1},PP(e.tagName),t.transformTemplate),c9(e,n)})}})},zye={useVisualState:d9({scrapeMotionValuesFromProps:AP,createRenderState:IP})};function Gye(t,{forwardMotionProps:e=!1},n,r){return{...EP(t)?Bye:zye,preloadedFeatures:n,useRender:Dye(e),createVisualElement:r,Component:t}}function qa(t,e,n,r={passive:!0}){return t.addEventListener(e,n,r),()=>t.removeEventListener(e,n)}const h9=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1;function jb(t,e="page"){return{point:{x:t[e+"X"],y:t[e+"Y"]}}}const Wye=t=>e=>h9(e)&&t(e,jb(e));function Za(t,e,n,r){return qa(t,e,Wye(n),r)}const Hye=(t,e)=>n=>e(t(n)),pc=(...t)=>t.reduce(Hye);function f9(t){let e=null;return()=>{const n=()=>{e=null};return e===null?(e=t,n):!1}}const s4=f9("dragHorizontal"),i4=f9("dragVertical");function m9(t){let e=!1;if(t==="y")e=i4();else if(t==="x")e=s4();else{const n=s4(),r=i4();n&&r?e=()=>{n(),r()}:(n&&n(),r&&r())}return e}function p9(){const t=m9(!0);return t?(t(),!1):!0}class Kc{constructor(e){this.isMounted=!1,this.node=e}update(){}}function o4(t,e){const n="pointer"+(e?"enter":"leave"),r="onHover"+(e?"Start":"End"),s=(i,o)=>{if(i.pointerType==="touch"||p9())return;const l=t.getProps();t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",e),l[r]&&bn.update(()=>l[r](i,o))};return Za(t.current,n,s,{passive:!t.getProps()[r]})}class qye extends Kc{mount(){this.unmount=pc(o4(this.node,!0),o4(this.node,!1))}unmount(){}}class Kye extends Kc{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=pc(qa(this.node.current,"focus",()=>this.onFocus()),qa(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const g9=(t,e)=>e?t===e?!0:g9(t,e.parentElement):!1;function IS(t,e){if(!e)return;const n=new PointerEvent("pointer"+t);e(n,jb(n))}class Yye extends Kc{constructor(){super(...arguments),this.removeStartListeners=Er,this.removeEndListeners=Er,this.removeAccessibleListeners=Er,this.startPointerPress=(e,n)=>{if(this.isPressing)return;this.removeEndListeners();const r=this.node.getProps(),i=Za(window,"pointerup",(l,c)=>{if(!this.checkPressEnd())return;const{onTap:u,onTapCancel:d,globalTapTarget:h}=this.node.getProps();bn.update(()=>{!h&&!g9(this.node.current,l.target)?d&&d(l,c):u&&u(l,c)})},{passive:!(r.onTap||r.onPointerUp)}),o=Za(window,"pointercancel",(l,c)=>this.cancelPress(l,c),{passive:!(r.onTapCancel||r.onPointerCancel)});this.removeEndListeners=pc(i,o),this.startPress(e,n)},this.startAccessiblePress=()=>{const e=i=>{if(i.key!=="Enter"||this.isPressing)return;const o=l=>{l.key!=="Enter"||!this.checkPressEnd()||IS("up",(c,u)=>{const{onTap:d}=this.node.getProps();d&&bn.update(()=>d(c,u))})};this.removeEndListeners(),this.removeEndListeners=qa(this.node.current,"keyup",o),IS("down",(l,c)=>{this.startPress(l,c)})},n=qa(this.node.current,"keydown",e),r=()=>{this.isPressing&&IS("cancel",(i,o)=>this.cancelPress(i,o))},s=qa(this.node.current,"blur",r);this.removeAccessibleListeners=pc(n,s)}}startPress(e,n){this.isPressing=!0;const{onTapStart:r,whileTap:s}=this.node.getProps();s&&this.node.animationState&&this.node.animationState.setActive("whileTap",!0),r&&bn.update(()=>r(e,n))}checkPressEnd(){return this.removeEndListeners(),this.isPressing=!1,this.node.getProps().whileTap&&this.node.animationState&&this.node.animationState.setActive("whileTap",!1),!p9()}cancelPress(e,n){if(!this.checkPressEnd())return;const{onTapCancel:r}=this.node.getProps();r&&bn.update(()=>r(e,n))}mount(){const e=this.node.getProps(),n=Za(e.globalTapTarget?window:this.node.current,"pointerdown",this.startPointerPress,{passive:!(e.onTapStart||e.onPointerStart)}),r=qa(this.node.current,"focus",this.startAccessiblePress);this.removeStartListeners=pc(n,r)}unmount(){this.removeStartListeners(),this.removeEndListeners(),this.removeAccessibleListeners()}}const TT=new WeakMap,NS=new WeakMap,Jye=t=>{const e=TT.get(t.target);e&&e(t)},Xye=t=>{t.forEach(Jye)};function Qye({root:t,...e}){const n=t||document;NS.has(n)||NS.set(n,{});const r=NS.get(n),s=JSON.stringify(e);return r[s]||(r[s]=new IntersectionObserver(Xye,{root:t,...e})),r[s]}function Zye(t,e,n){const r=Qye(e);return TT.set(t,n),r.observe(t),()=>{TT.delete(t),r.unobserve(t)}}const exe={some:0,all:1};class txe extends Kc{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=e,o={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:exe[s]},l=c=>{const{isIntersecting:u}=c;if(this.isInView===u||(this.isInView=u,i&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:d,onViewportLeave:h}=this.node.getProps(),f=u?d:h;f&&f(c)};return Zye(this.node.current,o,l)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:n}=this.node;["amount","margin","root"].some(nxe(e,n))&&this.startObserver()}unmount(){}}function nxe({viewport:t={}},{viewport:e={}}={}){return n=>t[n]!==e[n]}const rxe={inView:{Feature:txe},tap:{Feature:Yye},focus:{Feature:Kye},hover:{Feature:qye}};function y9(t,e){if(!Array.isArray(e))return!1;const n=e.length;if(n!==t.length)return!1;for(let r=0;r<n;r++)if(e[r]!==t[r])return!1;return!0}function sxe(t){const e={};return t.values.forEach((n,r)=>e[r]=n.get()),e}function ixe(t){const e={};return t.values.forEach((n,r)=>e[r]=n.getVelocity()),e}function Db(t,e,n){const r=t.getProps();return kP(r,e,n!==void 0?n:r.custom,sxe(t),ixe(t))}let x9=Er,Mb=Er;const gc=t=>t*1e3,el=t=>t/1e3,oxe={current:!1},v9=t=>Array.isArray(t)&&typeof t[0]=="number";function w9(t){return!!(!t||typeof t=="string"&&b9[t]||v9(t)||Array.isArray(t)&&t.every(w9))}const Dm=([t,e,n,r])=>`cubic-bezier(${t}, ${e}, ${n}, ${r})`,b9={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:Dm([0,.65,.55,1]),circOut:Dm([.55,0,1,.45]),backIn:Dm([.31,.01,.66,-.59]),backOut:Dm([.33,1.53,.69,.99])};function _9(t){if(t)return v9(t)?Dm(t):Array.isArray(t)?t.map(_9):b9[t]}function axe(t,e,n,{delay:r=0,duration:s,repeat:i=0,repeatType:o="loop",ease:l,times:c}={}){const u={[e]:n};c&&(u.offset=c);const d=_9(l);return Array.isArray(d)&&(u.easing=d),t.animate(u,{delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:o==="reverse"?"alternate":"normal"})}function lxe(t,{repeat:e,repeatType:n="loop"}){const r=e&&n!=="loop"&&e%2===1?0:t.length-1;return t[r]}const S9=(t,e,n)=>(((1-3*n+3*e)*t+(3*n-6*e))*t+3*e)*t,cxe=1e-7,uxe=12;function dxe(t,e,n,r,s){let i,o,l=0;do o=e+(n-e)/2,i=S9(o,r,s)-t,i>0?n=o:e=o;while(Math.abs(i)>cxe&&++l<uxe);return o}function ty(t,e,n,r){if(t===e&&n===r)return Er;const s=i=>dxe(i,0,1,t,n);return i=>i===0||i===1?i:S9(s(i),e,r)}const hxe=ty(.42,0,1,1),fxe=ty(0,0,.58,1),C9=ty(.42,0,.58,1),mxe=t=>Array.isArray(t)&&typeof t[0]!="number",E9=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,T9=t=>e=>1-t(1-e),RP=t=>1-Math.sin(Math.acos(t)),I9=T9(RP),pxe=E9(RP),N9=ty(.33,1.53,.69,.99),jP=T9(N9),gxe=E9(jP),yxe=t=>(t*=2)<1?.5*jP(t):.5*(2-Math.pow(2,-10*(t-1))),xxe={linear:Er,easeIn:hxe,easeInOut:C9,easeOut:fxe,circIn:RP,circInOut:pxe,circOut:I9,backIn:jP,backInOut:gxe,backOut:N9,anticipate:yxe},a4=t=>{if(Array.isArray(t)){Mb(t.length===4);const[e,n,r,s]=t;return ty(e,n,r,s)}else if(typeof t=="string")return xxe[t];return t},DP=(t,e)=>n=>!!(Qg(n)&&wye.test(n)&&n.startsWith(t)||e&&Object.prototype.hasOwnProperty.call(n,e)),P9=(t,e,n)=>r=>{if(!Qg(r))return r;const[s,i,o,l]=r.match(Rb);return{[t]:parseFloat(s),[e]:parseFloat(i),[n]:parseFloat(o),alpha:l!==void 0?parseFloat(l):1}},vxe=t=>Nc(0,255,t),PS={...xd,transform:t=>Math.round(vxe(t))},ju={test:DP("rgb","red"),parse:P9("red","green","blue"),transform:({red:t,green:e,blue:n,alpha:r=1})=>"rgba("+PS.transform(t)+", "+PS.transform(e)+", "+PS.transform(n)+", "+mp(fp.transform(r))+")"};function wxe(t){let e="",n="",r="",s="";return t.length>5?(e=t.substring(1,3),n=t.substring(3,5),r=t.substring(5,7),s=t.substring(7,9)):(e=t.substring(1,2),n=t.substring(2,3),r=t.substring(3,4),s=t.substring(4,5),e+=e,n+=n,r+=r,s+=s),{red:parseInt(e,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const IT={test:DP("#"),parse:wxe,transform:ju.transform},wh={test:DP("hsl","hue"),parse:P9("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:n,alpha:r=1})=>"hsla("+Math.round(t)+", "+_a.transform(mp(e))+", "+_a.transform(mp(n))+", "+mp(fp.transform(r))+")"},Hs={test:t=>ju.test(t)||IT.test(t)||wh.test(t),parse:t=>ju.test(t)?ju.parse(t):wh.test(t)?wh.parse(t):IT.parse(t),transform:t=>Qg(t)?t:t.hasOwnProperty("red")?ju.transform(t):wh.transform(t)},gr=(t,e,n)=>-n*t+n*e+t;function AS(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+(e-t)*6*n:n<1/2?e:n<2/3?t+(e-t)*(2/3-n)*6:t}function bxe({hue:t,saturation:e,lightness:n,alpha:r}){t/=360,e/=100,n/=100;let s=0,i=0,o=0;if(!e)s=i=o=n;else{const l=n<.5?n*(1+e):n+e-n*e,c=2*n-l;s=AS(c,l,t+1/3),i=AS(c,l,t),o=AS(c,l,t-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(o*255),alpha:r}}const kS=(t,e,n)=>{const r=t*t;return Math.sqrt(Math.max(0,n*(e*e-r)+r))},_xe=[IT,ju,wh],Sxe=t=>_xe.find(e=>e.test(t));function l4(t){const e=Sxe(t);let n=e.parse(t);return e===wh&&(n=bxe(n)),n}const A9=(t,e)=>{const n=l4(t),r=l4(e),s={...n};return i=>(s.red=kS(n.red,r.red,i),s.green=kS(n.green,r.green,i),s.blue=kS(n.blue,r.blue,i),s.alpha=gr(n.alpha,r.alpha,i),ju.transform(s))};function Cxe(t){var e,n;return isNaN(t)&&Qg(t)&&(((e=t.match(Rb))===null||e===void 0?void 0:e.length)||0)+(((n=t.match(n9))===null||n===void 0?void 0:n.length)||0)>0}const k9={regex:xye,countKey:"Vars",token:"${v}",parse:Er},R9={regex:n9,countKey:"Colors",token:"${c}",parse:Hs.parse},j9={regex:Rb,countKey:"Numbers",token:"${n}",parse:xd.parse};function RS(t,{regex:e,countKey:n,token:r,parse:s}){const i=t.tokenised.match(e);i&&(t["num"+n]=i.length,t.tokenised=t.tokenised.replace(e,r),t.values.push(...i.map(s)))}function Bw(t){const e=t.toString(),n={value:e,tokenised:e,values:[],numVars:0,numColors:0,numNumbers:0};return n.value.includes("var(--")&&RS(n,k9),RS(n,R9),RS(n,j9),n}function D9(t){return Bw(t).values}function M9(t){const{values:e,numColors:n,numVars:r,tokenised:s}=Bw(t),i=e.length;return o=>{let l=s;for(let c=0;c<i;c++)c<r?l=l.replace(k9.token,o[c]):c<r+n?l=l.replace(R9.token,Hs.transform(o[c])):l=l.replace(j9.token,mp(o[c]));return l}}const Exe=t=>typeof t=="number"?0:t;function Txe(t){const e=D9(t);return M9(t)(e.map(Exe))}const Pc={test:Cxe,parse:D9,createTransformer:M9,getAnimatableNone:Txe},L9=(t,e)=>n=>`${n>0?e:t}`;function F9(t,e){return typeof t=="number"?n=>gr(t,e,n):Hs.test(t)?A9(t,e):t.startsWith("var(")?L9(t,e):$9(t,e)}const O9=(t,e)=>{const n=[...t],r=n.length,s=t.map((i,o)=>F9(i,e[o]));return i=>{for(let o=0;o<r;o++)n[o]=s[o](i);return n}},Ixe=(t,e)=>{const n={...t,...e},r={};for(const s in n)t[s]!==void 0&&e[s]!==void 0&&(r[s]=F9(t[s],e[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}},$9=(t,e)=>{const n=Pc.createTransformer(e),r=Bw(t),s=Bw(e);return r.numVars===s.numVars&&r.numColors===s.numColors&&r.numNumbers>=s.numNumbers?pc(O9(r.values,s.values),n):L9(t,e)},vf=(t,e,n)=>{const r=e-t;return r===0?1:(n-t)/r},c4=(t,e)=>n=>gr(t,e,n);function Nxe(t){return typeof t=="number"?c4:typeof t=="string"?Hs.test(t)?A9:$9:Array.isArray(t)?O9:typeof t=="object"?Ixe:c4}function Pxe(t,e,n){const r=[],s=n||Nxe(t[0]),i=t.length-1;for(let o=0;o<i;o++){let l=s(t[o],t[o+1]);if(e){const c=Array.isArray(e)?e[o]||Er:e;l=pc(c,l)}r.push(l)}return r}function Lb(t,e,{clamp:n=!0,ease:r,mixer:s}={}){const i=t.length;if(Mb(i===e.length),i===1)return()=>e[0];t[0]>t[i-1]&&(t=[...t].reverse(),e=[...e].reverse());const o=Pxe(e,r,s),l=o.length,c=u=>{let d=0;if(l>1)for(;d<t.length-2&&!(u<t[d+1]);d++);const h=vf(t[d],t[d+1],u);return o[d](h)};return n?u=>c(Nc(t[0],t[i-1],u)):c}function Axe(t,e){const n=t[t.length-1];for(let r=1;r<=e;r++){const s=vf(0,e,r);t.push(gr(n,1,s))}}function V9(t){const e=[0];return Axe(e,t.length-1),e}function kxe(t,e){return t.map(n=>n*e)}function Rxe(t,e){return t.map(()=>e||C9).splice(0,t.length-1)}function zw({duration:t=300,keyframes:e,times:n,ease:r="easeInOut"}){const s=mxe(r)?r.map(a4):a4(r),i={done:!1,value:e[0]},o=kxe(n&&n.length===e.length?n:V9(e),t),l=Lb(o,e,{ease:Array.isArray(s)?s:Rxe(e,s)});return{calculatedDuration:t,next:c=>(i.value=l(c),i.done=c>=t,i)}}function MP(t,e){return e?t*(1e3/e):0}const jxe=5;function U9(t,e,n){const r=Math.max(e-jxe,0);return MP(n-t(r),e-r)}const jS=.001,Dxe=.01,u4=10,Mxe=.05,Lxe=1;function Fxe({duration:t=800,bounce:e=.25,velocity:n=0,mass:r=1}){let s,i;x9(t<=gc(u4));let o=1-e;o=Nc(Mxe,Lxe,o),t=Nc(Dxe,u4,el(t)),o<1?(s=u=>{const d=u*o,h=d*t,f=d-n,m=NT(u,o),g=Math.exp(-h);return jS-f/m*g},i=u=>{const h=u*o*t,f=h*n+n,m=Math.pow(o,2)*Math.pow(u,2)*t,g=Math.exp(-h),x=NT(Math.pow(u,2),o);return(-s(u)+jS>0?-1:1)*((f-m)*g)/x}):(s=u=>{const d=Math.exp(-u*t),h=(u-n)*t+1;return-jS+d*h},i=u=>{const d=Math.exp(-u*t),h=(n-u)*(t*t);return d*h});const l=5/t,c=$xe(s,i,l);if(t=gc(t),isNaN(c))return{stiffness:100,damping:10,duration:t};{const u=Math.pow(c,2)*r;return{stiffness:u,damping:o*2*Math.sqrt(r*u),duration:t}}}const Oxe=12;function $xe(t,e,n){let r=n;for(let s=1;s<Oxe;s++)r=r-t(r)/e(r);return r}function NT(t,e){return t*Math.sqrt(1-e*e)}const Vxe=["duration","bounce"],Uxe=["stiffness","damping","mass"];function d4(t,e){return e.some(n=>t[n]!==void 0)}function Bxe(t){let e={velocity:0,stiffness:100,damping:10,mass:1,isResolvedFromDuration:!1,...t};if(!d4(t,Uxe)&&d4(t,Vxe)){const n=Fxe(t);e={...e,...n,mass:1},e.isResolvedFromDuration=!0}return e}function B9({keyframes:t,restDelta:e,restSpeed:n,...r}){const s=t[0],i=t[t.length-1],o={done:!1,value:s},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:f}=Bxe({...r,velocity:-el(r.velocity||0)}),m=h||0,g=c/(2*Math.sqrt(l*u)),x=i-s,w=el(Math.sqrt(l/u)),v=Math.abs(x)<5;n||(n=v?.01:2),e||(e=v?.005:.5);let _;if(g<1){const C=NT(w,g);_=T=>{const R=Math.exp(-g*w*T);return i-R*((m+g*w*x)/C*Math.sin(C*T)+x*Math.cos(C*T))}}else if(g===1)_=C=>i-Math.exp(-w*C)*(x+(m+w*x)*C);else{const C=w*Math.sqrt(g*g-1);_=T=>{const R=Math.exp(-g*w*T),k=Math.min(C*T,300);return i-R*((m+g*w*x)*Math.sinh(k)+C*x*Math.cosh(k))/C}}return{calculatedDuration:f&&d||null,next:C=>{const T=_(C);if(f)o.done=C>=d;else{let R=m;C!==0&&(g<1?R=U9(_,C,T):R=0);const k=Math.abs(R)<=n,E=Math.abs(i-T)<=e;o.done=k&&E}return o.value=o.done?i:T,o}}}function h4({keyframes:t,velocity:e=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:o,min:l,max:c,restDelta:u=.5,restSpeed:d}){const h=t[0],f={done:!1,value:h},m=I=>l!==void 0&&I<l||c!==void 0&&I>c,g=I=>l===void 0?c:c===void 0||Math.abs(l-I)<Math.abs(c-I)?l:c;let x=n*e;const w=h+x,v=o===void 0?w:o(w);v!==w&&(x=v-h);const _=I=>-x*Math.exp(-I/r),C=I=>v+_(I),T=I=>{const P=_(I),A=C(I);f.done=Math.abs(P)<=u,f.value=f.done?v:A};let R,k;const E=I=>{m(f.value)&&(R=I,k=B9({keyframes:[f.value,g(f.value)],velocity:U9(C,I,f.value),damping:s,stiffness:i,restDelta:u,restSpeed:d}))};return E(0),{calculatedDuration:null,next:I=>{let P=!1;return!k&&R===void 0&&(P=!0,T(I),E(I)),R!==void 0&&I>R?k.next(I-R):(!P&&T(I),f)}}}const zxe=t=>{const e=({timestamp:n})=>t(n);return{start:()=>bn.update(e,!0),stop:()=>Ho(e),now:()=>ms.isProcessing?ms.timestamp:performance.now()}},f4=2e4;function m4(t){let e=0;const n=50;let r=t.next(e);for(;!r.done&&e<f4;)e+=n,r=t.next(e);return e>=f4?1/0:e}const Gxe={decay:h4,inertia:h4,tween:zw,keyframes:zw,spring:B9};function Gw({autoplay:t=!0,delay:e=0,driver:n=zxe,keyframes:r,type:s="keyframes",repeat:i=0,repeatDelay:o=0,repeatType:l="loop",onPlay:c,onStop:u,onComplete:d,onUpdate:h,...f}){let m=1,g=!1,x,w;const v=()=>{w=new Promise(V=>{x=V})};v();let _;const C=Gxe[s]||zw;let T;C!==zw&&typeof r[0]!="number"&&(T=Lb([0,100],r,{clamp:!1}),r=[0,100]);const R=C({...f,keyframes:r});let k;l==="mirror"&&(k=C({...f,keyframes:[...r].reverse(),velocity:-(f.velocity||0)}));let E="idle",I=null,P=null,A=null;R.calculatedDuration===null&&i&&(R.calculatedDuration=m4(R));const{calculatedDuration:D}=R;let j=1/0,M=1/0;D!==null&&(j=D+o,M=j*(i+1)-o);let z=0;const U=V=>{if(P===null)return;m>0&&(P=Math.min(P,V)),m<0&&(P=Math.min(V-M/m,P)),I!==null?z=I:z=Math.round(V-P)*m;const H=z-e*(m>=0?1:-1),L=m>=0?H<0:H>M;z=Math.max(H,0),E==="finished"&&I===null&&(z=M);let ee=z,pe=R;if(i){const Fe=Math.min(z,M)/j;let Ve=Math.floor(Fe),Ge=Fe%1;!Ge&&Fe>=1&&(Ge=1),Ge===1&&Ve--,Ve=Math.min(Ve,i+1),!!(Ve%2)&&(l==="reverse"?(Ge=1-Ge,o&&(Ge-=o/j)):l==="mirror"&&(pe=k)),ee=Nc(0,1,Ge)*j}const xe=L?{done:!1,value:r[0]}:pe.next(ee);T&&(xe.value=T(xe.value));let{done:we}=xe;!L&&D!==null&&(we=m>=0?z>=M:z<=0);const Ie=I===null&&(E==="finished"||E==="running"&&we);return h&&h(xe.value),Ie&&W(),xe},K=()=>{_&&_.stop(),_=void 0},q=()=>{E="idle",K(),x(),v(),P=A=null},W=()=>{E="finished",d&&d(),K(),x()},te=()=>{if(g)return;_||(_=n(U));const V=_.now();c&&c(),I!==null?P=V-I:(!P||E==="finished")&&(P=V),E==="finished"&&v(),A=P,I=null,E="running",_.start()};t&&te();const O={then(V,H){return w.then(V,H)},get time(){return el(z)},set time(V){V=gc(V),z=V,I!==null||!_||m===0?I=V:P=_.now()-V/m},get duration(){const V=R.calculatedDuration===null?m4(R):R.calculatedDuration;return el(V)},get speed(){return m},set speed(V){V===m||!_||(m=V,O.time=el(z))},get state(){return E},play:te,pause:()=>{E="paused",I=z},stop:()=>{g=!0,E!=="idle"&&(E="idle",u&&u(),q())},cancel:()=>{A!==null&&U(A),q()},complete:()=>{E="finished"},sample:V=>(P=0,U(V))};return O}function Wxe(t){let e;return()=>(e===void 0&&(e=t()),e)}const Hxe=Wxe(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),qxe=new Set(["opacity","clipPath","filter","transform","backgroundColor"]),cx=10,Kxe=2e4,Yxe=(t,e)=>e.type==="spring"||t==="backgroundColor"||!w9(e.ease);function Jxe(t,e,{onUpdate:n,onComplete:r,...s}){if(!(Hxe()&&qxe.has(e)&&!s.repeatDelay&&s.repeatType!=="mirror"&&s.damping!==0&&s.type!=="inertia"))return!1;let o=!1,l,c,u=!1;const d=()=>{c=new Promise(C=>{l=C})};d();let{keyframes:h,duration:f=300,ease:m,times:g}=s;if(Yxe(e,s)){const C=Gw({...s,repeat:0,delay:0});let T={done:!1,value:h[0]};const R=[];let k=0;for(;!T.done&&k<Kxe;)T=C.sample(k),R.push(T.value),k+=cx;g=void 0,h=R,f=k-cx,m="linear"}const x=axe(t.owner.current,e,h,{...s,duration:f,ease:m,times:g}),w=()=>{u=!1,x.cancel()},v=()=>{u=!0,bn.update(w),l(),d()};return x.onfinish=()=>{u||(t.set(lxe(h,s)),r&&r(),v())},{then(C,T){return c.then(C,T)},attachTimeline(C){return x.timeline=C,x.onfinish=null,Er},get time(){return el(x.currentTime||0)},set time(C){x.currentTime=gc(C)},get speed(){return x.playbackRate},set speed(C){x.playbackRate=C},get duration(){return el(f)},play:()=>{o||(x.play(),Ho(w))},pause:()=>x.pause(),stop:()=>{if(o=!0,x.playState==="idle")return;const{currentTime:C}=x;if(C){const T=Gw({...s,autoplay:!1});t.setWithVelocity(T.sample(C-cx).value,T.sample(C).value,cx)}v()},complete:()=>{u||x.finish()},cancel:v}}function Xxe({keyframes:t,delay:e,onUpdate:n,onComplete:r}){const s=()=>(n&&n(t[t.length-1]),r&&r(),{time:0,speed:1,duration:0,play:Er,pause:Er,stop:Er,then:i=>(i(),Promise.resolve()),cancel:Er,complete:Er});return e?Gw({keyframes:[0,1],duration:0,delay:e,onComplete:s}):s()}const Qxe={type:"spring",stiffness:500,damping:25,restSpeed:10},Zxe=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),eve={type:"keyframes",duration:.8},tve={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},nve=(t,{keyframes:e})=>e.length>2?eve:yd.has(t)?t.startsWith("scale")?Zxe(e[1]):Qxe:tve,PT=(t,e)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Pc.test(e)||e==="0")&&!e.startsWith("url(")),rve=new Set(["brightness","contrast","saturate","opacity"]);function sve(t){const[e,n]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[r]=n.match(Rb)||[];if(!r)return t;const s=n.replace(r,"");let i=rve.has(e)?1:0;return r!==n&&(i*=100),e+"("+i+s+")"}const ive=/([a-z-]*)\(.*?\)/g,AT={...Pc,getAnimatableNone:t=>{const e=t.match(ive);return e?e.map(sve).join(" "):t}},ove={...r9,color:Hs,backgroundColor:Hs,outlineColor:Hs,fill:Hs,stroke:Hs,borderColor:Hs,borderTopColor:Hs,borderRightColor:Hs,borderBottomColor:Hs,borderLeftColor:Hs,filter:AT,WebkitFilter:AT},LP=t=>ove[t];function z9(t,e){let n=LP(t);return n!==AT&&(n=Pc),n.getAnimatableNone?n.getAnimatableNone(e):void 0}const G9=t=>/^0[^.\s]+$/.test(t);function ave(t){if(typeof t=="number")return t===0;if(t!==null)return t==="none"||t==="0"||G9(t)}function lve(t,e,n,r){const s=PT(e,n);let i;Array.isArray(n)?i=[...n]:i=[null,n];const o=r.from!==void 0?r.from:t.get();let l;const c=[];for(let u=0;u<i.length;u++)i[u]===null&&(i[u]=u===0?o:i[u-1]),ave(i[u])&&c.push(u),typeof i[u]=="string"&&i[u]!=="none"&&i[u]!=="0"&&(l=i[u]);if(s&&c.length&&l)for(let u=0;u<c.length;u++){const d=c[u];i[d]=z9(e,l)}return i}function cve({when:t,delay:e,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:o,repeatDelay:l,from:c,elapsed:u,...d}){return!!Object.keys(d).length}function FP(t,e){return t[e]||t.default||t}const uve={skipAnimations:!1},OP=(t,e,n,r={})=>s=>{const i=FP(r,t)||{},o=i.delay||r.delay||0;let{elapsed:l=0}=r;l=l-gc(o);const c=lve(e,t,n,i),u=c[0],d=c[c.length-1],h=PT(t,u),f=PT(t,d);let m={keyframes:c,velocity:e.getVelocity(),ease:"easeOut",...i,delay:-l,onUpdate:g=>{e.set(g),i.onUpdate&&i.onUpdate(g)},onComplete:()=>{s(),i.onComplete&&i.onComplete()}};if(cve(i)||(m={...m,...nve(t,m)}),m.duration&&(m.duration=gc(m.duration)),m.repeatDelay&&(m.repeatDelay=gc(m.repeatDelay)),!h||!f||oxe.current||i.type===!1||uve.skipAnimations)return Xxe(m);if(!r.isHandoff&&e.owner&&e.owner.current instanceof HTMLElement&&!e.owner.getProps().onUpdate){const g=Jxe(e,t,m);if(g)return g}return Gw(m)};function Ww(t){return!!(vi(t)&&t.add)}const W9=t=>/^\-?\d*\.?\d+$/.test(t);function $P(t,e){t.indexOf(e)===-1&&t.push(e)}function VP(t,e){const n=t.indexOf(e);n>-1&&t.splice(n,1)}class UP{constructor(){this.subscriptions=[]}add(e){return $P(this.subscriptions,e),()=>VP(this.subscriptions,e)}notify(e,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](e,n,r);else for(let i=0;i<s;i++){const o=this.subscriptions[i];o&&o(e,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const dve=t=>!isNaN(parseFloat(t)),pp={current:void 0};class hve{constructor(e,n={}){this.version="10.18.0",this.timeDelta=0,this.lastUpdated=0,this.canTrackVelocity=!1,this.events={},this.updateAndNotify=(r,s=!0)=>{this.prev=this.current,this.current=r;const{delta:i,timestamp:o}=ms;this.lastUpdated!==o&&(this.timeDelta=i,this.lastUpdated=o,bn.postRender(this.scheduleVelocityCheck)),this.prev!==this.current&&this.events.change&&this.events.change.notify(this.current),this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()),s&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.scheduleVelocityCheck=()=>bn.postRender(this.velocityCheck),this.velocityCheck=({timestamp:r})=>{r!==this.lastUpdated&&(this.prev=this.current,this.events.velocityChange&&this.events.velocityChange.notify(this.getVelocity()))},this.hasAnimated=!1,this.prev=this.current=e,this.canTrackVelocity=dve(this.current),this.owner=n.owner}onChange(e){return this.on("change",e)}on(e,n){this.events[e]||(this.events[e]=new UP);const r=this.events[e].add(n);return e==="change"?()=>{r(),bn.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,n){this.passiveEffect=e,this.stopPassiveEffect=n}set(e,n=!0){!n||!this.passiveEffect?this.updateAndNotify(e,n):this.passiveEffect(e,this.updateAndNotify)}setWithVelocity(e,n,r){this.set(n),this.prev=e,this.timeDelta=r}jump(e){this.updateAndNotify(e),this.prev=e,this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return pp.current&&pp.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){return this.canTrackVelocity?MP(parseFloat(this.current)-parseFloat(this.prev),this.timeDelta):0}start(e){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=e(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Lo(t,e){return new hve(t,e)}const H9=t=>e=>e.test(t),fve={test:t=>t==="auto",parse:t=>t},q9=[xd,Ft,_a,Ll,_ye,bye,fve],pm=t=>q9.find(H9(t)),mve=[...q9,Hs,Pc],pve=t=>mve.find(H9(t));function gve(t,e,n){t.hasValue(e)?t.getValue(e).set(n):t.addValue(e,Lo(n))}function yve(t,e){const n=Db(t,e);let{transitionEnd:r={},transition:s={},...i}=n?t.makeTargetAnimatable(n,!1):{};i={...i,...r};for(const o in i){const l=Lye(i[o]);gve(t,o,l)}}function xve(t,e,n){var r,s;const i=Object.keys(e).filter(l=>!t.hasValue(l)),o=i.length;if(o)for(let l=0;l<o;l++){const c=i[l],u=e[c];let d=null;Array.isArray(u)&&(d=u[0]),d===null&&(d=(s=(r=n[c])!==null&&r!==void 0?r:t.readValue(c))!==null&&s!==void 0?s:e[c]),d!=null&&(typeof d=="string"&&(W9(d)||G9(d))?d=parseFloat(d):!pve(d)&&Pc.test(u)&&(d=z9(c,u)),t.addValue(c,Lo(d,{owner:t})),n[c]===void 0&&(n[c]=d),d!==null&&t.setBaseTarget(c,d))}}function vve(t,e){return e?(e[t]||e.default||e).from:void 0}function wve(t,e,n){const r={};for(const s in t){const i=vve(s,e);if(i!==void 0)r[s]=i;else{const o=n.getValue(s);o&&(r[s]=o.get())}}return r}function bve({protectedKeys:t,needsAnimating:e},n){const r=t.hasOwnProperty(n)&&e[n]!==!0;return e[n]=!1,r}function _ve(t,e){const n=t.get();if(Array.isArray(e)){for(let r=0;r<e.length;r++)if(e[r]!==n)return!0}else return n!==e}function K9(t,e,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=t.getDefaultTransition(),transitionEnd:o,...l}=t.makeTargetAnimatable(e);const c=t.getValue("willChange");r&&(i=r);const u=[],d=s&&t.animationState&&t.animationState.getState()[s];for(const h in l){const f=t.getValue(h),m=l[h];if(!f||m===void 0||d&&bve(d,h))continue;const g={delay:n,elapsed:0,...FP(i||{},h)};if(window.HandoffAppearAnimations){const v=t.getProps()[Jz];if(v){const _=window.HandoffAppearAnimations(v,h,f,bn);_!==null&&(g.elapsed=_,g.isHandoff=!0)}}let x=!g.isHandoff&&!_ve(f,m);if(g.type==="spring"&&(f.getVelocity()||g.velocity)&&(x=!1),f.animation&&(x=!1),x)continue;f.start(OP(h,f,m,t.shouldReduceMotion&&yd.has(h)?{type:!1}:g));const w=f.animation;Ww(c)&&(c.add(h),w.then(()=>c.remove(h))),u.push(w)}return o&&Promise.all(u).then(()=>{o&&yve(t,o)}),u}function kT(t,e,n={}){const r=Db(t,e,n.custom);let{transition:s=t.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all(K9(t,r,n)):()=>Promise.resolve(),o=t.variantChildren&&t.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return Sve(t,e,u+c,d,h,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[c,u]=l==="beforeChildren"?[i,o]:[o,i];return c().then(()=>u())}else return Promise.all([i(),o(n.delay)])}function Sve(t,e,n=0,r=0,s=1,i){const o=[],l=(t.variantChildren.size-1)*r,c=s===1?(u=0)=>u*r:(u=0)=>l-u*r;return Array.from(t.variantChildren).sort(Cve).forEach((u,d)=>{u.notify("AnimationStart",e),o.push(kT(u,e,{...i,delay:n+c(d)}).then(()=>u.notify("AnimationComplete",e)))}),Promise.all(o)}function Cve(t,e){return t.sortNodePosition(e)}function Eve(t,e,n={}){t.notify("AnimationStart",e);let r;if(Array.isArray(e)){const s=e.map(i=>kT(t,i,n));r=Promise.all(s)}else if(typeof e=="string")r=kT(t,e,n);else{const s=typeof e=="function"?Db(t,e,n.custom):e;r=Promise.all(K9(t,s,n))}return r.then(()=>t.notify("AnimationComplete",e))}const Tve=[..._P].reverse(),Ive=_P.length;function Nve(t){return e=>Promise.all(e.map(({animation:n,options:r})=>Eve(t,n,r)))}function Pve(t){let e=Nve(t);const n=kve();let r=!0;const s=(c,u)=>{const d=Db(t,u);if(d){const{transition:h,transitionEnd:f,...m}=d;c={...c,...m,...f}}return c};function i(c){e=c(t)}function o(c,u){const d=t.getProps(),h=t.getVariantContext(!0)||{},f=[],m=new Set;let g={},x=1/0;for(let v=0;v<Ive;v++){const _=Tve[v],C=n[_],T=d[_]!==void 0?d[_]:h[_],R=ag(T),k=_===u?C.isActive:null;k===!1&&(x=v);let E=T===h[_]&&T!==d[_]&&R;if(E&&r&&t.manuallyAnimateOnMount&&(E=!1),C.protectedKeys={...g},!C.isActive&&k===null||!T&&!C.prevProp||Ab(T)||typeof T=="boolean")continue;let P=Ave(C.prevProp,T)||_===u&&C.isActive&&!E&&R||v>x&&R,A=!1;const D=Array.isArray(T)?T:[T];let j=D.reduce(s,{});k===!1&&(j={});const{prevResolvedValues:M={}}=C,z={...M,...j},U=K=>{P=!0,m.has(K)&&(A=!0,m.delete(K)),C.needsAnimating[K]=!0};for(const K in z){const q=j[K],W=M[K];if(g.hasOwnProperty(K))continue;let te=!1;Uw(q)&&Uw(W)?te=!y9(q,W):te=q!==W,te?q!==void 0?U(K):m.add(K):q!==void 0&&m.has(K)?U(K):C.protectedKeys[K]=!0}C.prevProp=T,C.prevResolvedValues=j,C.isActive&&(g={...g,...j}),r&&t.blockInitialAnimation&&(P=!1),P&&(!E||A)&&f.push(...D.map(K=>({animation:K,options:{type:_,...c}})))}if(m.size){const v={};m.forEach(_=>{const C=t.getBaseTarget(_);C!==void 0&&(v[_]=C)}),f.push({animation:v})}let w=!!f.length;return r&&(d.initial===!1||d.initial===d.animate)&&!t.manuallyAnimateOnMount&&(w=!1),r=!1,w?e(f):Promise.resolve()}function l(c,u,d){var h;if(n[c].isActive===u)return Promise.resolve();(h=t.variantChildren)===null||h===void 0||h.forEach(m=>{var g;return(g=m.animationState)===null||g===void 0?void 0:g.setActive(c,u)}),n[c].isActive=u;const f=o(d,c);for(const m in n)n[m].protectedKeys={};return f}return{animateChanges:o,setActive:l,setAnimateFunction:i,getState:()=>n}}function Ave(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!y9(e,t):!1}function ou(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function kve(){return{animate:ou(!0),whileInView:ou(),whileHover:ou(),whileTap:ou(),whileDrag:ou(),whileFocus:ou(),exit:ou()}}class Rve extends Kc{constructor(e){super(e),e.animationState||(e.animationState=Pve(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();this.unmount(),Ab(e)&&(this.unmount=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:n}=this.node.prevProps||{};e!==n&&this.updateAnimationControlsSubscription()}unmount(){}}let jve=0;class Dve extends Kc{constructor(){super(...arguments),this.id=jve++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:n,custom:r}=this.node.presenceContext,{isPresent:s}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===s)return;const i=this.node.animationState.setActive("exit",!e,{custom:r??this.node.getProps().custom});n&&!e&&i.then(()=>n(this.id))}mount(){const{register:e}=this.node.presenceContext||{};e&&(this.unmount=e(this.id))}unmount(){}}const Mve={animation:{Feature:Rve},exit:{Feature:Dve}},p4=(t,e)=>Math.abs(t-e);function Lve(t,e){const n=p4(t.x,e.x),r=p4(t.y,e.y);return Math.sqrt(n**2+r**2)}class Y9{constructor(e,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=MS(this.lastMoveEventInfo,this.history),f=this.startEvent!==null,m=Lve(h.offset,{x:0,y:0})>=3;if(!f&&!m)return;const{point:g}=h,{timestamp:x}=ms;this.history.push({...g,timestamp:x});const{onStart:w,onMove:v}=this.handlers;f||(w&&w(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),v&&v(this.lastMoveEvent,h)},this.handlePointerMove=(h,f)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=DS(f,this.transformPagePoint),bn.update(this.updatePoint,!0)},this.handlePointerUp=(h,f)=>{this.end();const{onEnd:m,onSessionEnd:g,resumeAnimation:x}=this.handlers;if(this.dragSnapToOrigin&&x&&x(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=MS(h.type==="pointercancel"?this.lastMoveEventInfo:DS(f,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,w),g&&g(h,w)},!h9(e))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const o=jb(e),l=DS(o,this.transformPagePoint),{point:c}=l,{timestamp:u}=ms;this.history=[{...c,timestamp:u}];const{onSessionStart:d}=n;d&&d(e,MS(l,this.history)),this.removeListeners=pc(Za(this.contextWindow,"pointermove",this.handlePointerMove),Za(this.contextWindow,"pointerup",this.handlePointerUp),Za(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),Ho(this.updatePoint)}}function DS(t,e){return e?{point:e(t.point)}:t}function g4(t,e){return{x:t.x-e.x,y:t.y-e.y}}function MS({point:t},e){return{point:t,delta:g4(t,J9(e)),offset:g4(t,Fve(e)),velocity:Ove(e,.1)}}function Fve(t){return t[0]}function J9(t){return t[t.length-1]}function Ove(t,e){if(t.length<2)return{x:0,y:0};let n=t.length-1,r=null;const s=J9(t);for(;n>=0&&(r=t[n],!(s.timestamp-r.timestamp>gc(e)));)n--;if(!r)return{x:0,y:0};const i=el(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const o={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return o.x===1/0&&(o.x=0),o.y===1/0&&(o.y=0),o}function Qi(t){return t.max-t.min}function RT(t,e=0,n=.01){return Math.abs(t-e)<=n}function y4(t,e,n,r=.5){t.origin=r,t.originPoint=gr(e.min,e.max,t.origin),t.scale=Qi(n)/Qi(e),(RT(t.scale,1,1e-4)||isNaN(t.scale))&&(t.scale=1),t.translate=gr(n.min,n.max,t.origin)-t.originPoint,(RT(t.translate)||isNaN(t.translate))&&(t.translate=0)}function gp(t,e,n,r){y4(t.x,e.x,n.x,r?r.originX:void 0),y4(t.y,e.y,n.y,r?r.originY:void 0)}function x4(t,e,n){t.min=n.min+e.min,t.max=t.min+Qi(e)}function $ve(t,e,n){x4(t.x,e.x,n.x),x4(t.y,e.y,n.y)}function v4(t,e,n){t.min=e.min-n.min,t.max=t.min+Qi(e)}function yp(t,e,n){v4(t.x,e.x,n.x),v4(t.y,e.y,n.y)}function Vve(t,{min:e,max:n},r){return e!==void 0&&t<e?t=r?gr(e,t,r.min):Math.max(t,e):n!==void 0&&t>n&&(t=r?gr(n,t,r.max):Math.min(t,n)),t}function w4(t,e,n){return{min:e!==void 0?t.min+e:void 0,max:n!==void 0?t.max+n-(t.max-t.min):void 0}}function Uve(t,{top:e,left:n,bottom:r,right:s}){return{x:w4(t.x,n,s),y:w4(t.y,e,r)}}function b4(t,e){let n=e.min-t.min,r=e.max-t.max;return e.max-e.min<t.max-t.min&&([n,r]=[r,n]),{min:n,max:r}}function Bve(t,e){return{x:b4(t.x,e.x),y:b4(t.y,e.y)}}function zve(t,e){let n=.5;const r=Qi(t),s=Qi(e);return s>r?n=vf(e.min,e.max-r,t.min):r>s&&(n=vf(t.min,t.max-s,e.min)),Nc(0,1,n)}function Gve(t,e){const n={};return e.min!==void 0&&(n.min=e.min-t.min),e.max!==void 0&&(n.max=e.max-t.min),n}const jT=.35;function Wve(t=jT){return t===!1?t=0:t===!0&&(t=jT),{x:_4(t,"left","right"),y:_4(t,"top","bottom")}}function _4(t,e,n){return{min:S4(t,e),max:S4(t,n)}}function S4(t,e){return typeof t=="number"?t:t[e]||0}const C4=()=>({translate:0,scale:1,origin:0,originPoint:0}),bh=()=>({x:C4(),y:C4()}),E4=()=>({min:0,max:0}),$r=()=>({x:E4(),y:E4()});function ro(t){return[t("x"),t("y")]}function X9({top:t,left:e,right:n,bottom:r}){return{x:{min:e,max:n},y:{min:t,max:r}}}function Hve({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function qve(t,e){if(!e)return t;const n=e({x:t.left,y:t.top}),r=e({x:t.right,y:t.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function LS(t){return t===void 0||t===1}function DT({scale:t,scaleX:e,scaleY:n}){return!LS(t)||!LS(e)||!LS(n)}function fu(t){return DT(t)||Q9(t)||t.z||t.rotate||t.rotateX||t.rotateY}function Q9(t){return T4(t.x)||T4(t.y)}function T4(t){return t&&t!=="0%"}function Hw(t,e,n){const r=t-n,s=e*r;return n+s}function I4(t,e,n,r,s){return s!==void 0&&(t=Hw(t,s,r)),Hw(t,n,r)+e}function MT(t,e=0,n=1,r,s){t.min=I4(t.min,e,n,r,s),t.max=I4(t.max,e,n,r,s)}function Z9(t,{x:e,y:n}){MT(t.x,e.translate,e.scale,e.originPoint),MT(t.y,n.translate,n.scale,n.originPoint)}function Kve(t,e,n,r=!1){const s=n.length;if(!s)return;e.x=e.y=1;let i,o;for(let l=0;l<s;l++){i=n[l],o=i.projectionDelta;const c=i.instance;c&&c.style&&c.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&_h(t,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),o&&(e.x*=o.x.scale,e.y*=o.y.scale,Z9(t,o)),r&&fu(i.latestValues)&&_h(t,i.latestValues))}e.x=N4(e.x),e.y=N4(e.y)}function N4(t){return Number.isInteger(t)||t>1.0000000000001||t<.999999999999?t:1}function Ul(t,e){t.min=t.min+e,t.max=t.max+e}function P4(t,e,[n,r,s]){const i=e[s]!==void 0?e[s]:.5,o=gr(t.min,t.max,i);MT(t,e[n],e[r],o,e.scale)}const Yve=["x","scaleX","originX"],Jve=["y","scaleY","originY"];function _h(t,e){P4(t.x,e,Yve),P4(t.y,e,Jve)}function e8(t,e){return X9(qve(t.getBoundingClientRect(),e))}function Xve(t,e,n){const r=e8(t,n),{scroll:s}=e;return s&&(Ul(r.x,s.offset.x),Ul(r.y,s.offset.y)),r}const t8=({current:t})=>t?t.ownerDocument.defaultView:null,Qve=new WeakMap;class Zve{constructor(e){this.openGlobalLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=$r(),this.visualElement=e}start(e,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=d=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(jb(d,"page").point)},i=(d,h)=>{const{drag:f,dragPropagation:m,onDragStart:g}=this.getProps();if(f&&!m&&(this.openGlobalLock&&this.openGlobalLock(),this.openGlobalLock=m9(f),!this.openGlobalLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ro(w=>{let v=this.getAxisMotionValue(w).get()||0;if(_a.test(v)){const{projection:_}=this.visualElement;if(_&&_.layout){const C=_.layout.layoutBox[w];C&&(v=Qi(C)*(parseFloat(v)/100))}}this.originPoint[w]=v}),g&&bn.update(()=>g(d,h),!1,!0);const{animationState:x}=this.visualElement;x&&x.setActive("whileDrag",!0)},o=(d,h)=>{const{dragPropagation:f,dragDirectionLock:m,onDirectionLock:g,onDrag:x}=this.getProps();if(!f&&!this.openGlobalLock)return;const{offset:w}=h;if(m&&this.currentDirection===null){this.currentDirection=ewe(w),this.currentDirection!==null&&g&&g(this.currentDirection);return}this.updateAxis("x",h.point,w),this.updateAxis("y",h.point,w),this.visualElement.render(),x&&x(d,h)},l=(d,h)=>this.stop(d,h),c=()=>ro(d=>{var h;return this.getAnimationState(d)==="paused"&&((h=this.getAxisMotionValue(d).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new Y9(e,{onSessionStart:s,onStart:i,onMove:o,onSessionEnd:l,resumeAnimation:c},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:t8(this.visualElement)})}stop(e,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&bn.update(()=>i(e,n))}cancel(){this.isDragging=!1;const{projection:e,animationState:n}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openGlobalLock&&(this.openGlobalLock(),this.openGlobalLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(e,n,r){const{drag:s}=this.getProps();if(!r||!ux(e,s,this.currentDirection))return;const i=this.getAxisMotionValue(e);let o=this.originPoint[e]+r[e];this.constraints&&this.constraints[e]&&(o=Vve(o,this.constraints[e],this.elastic[e])),i.set(o)}resolveConstraints(){var e;const{dragConstraints:n,dragElastic:r}=this.getProps(),s=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(e=this.visualElement.projection)===null||e===void 0?void 0:e.layout,i=this.constraints;n&&vh(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&s?this.constraints=Uve(s.layoutBox,n):this.constraints=!1,this.elastic=Wve(r),i!==this.constraints&&s&&this.constraints&&!this.hasMutatedConstraints&&ro(o=>{this.getAxisMotionValue(o)&&(this.constraints[o]=Gve(s.layoutBox[o],this.constraints[o]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:n}=this.getProps();if(!e||!vh(e))return!1;const r=e.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=Xve(r,s.root,this.visualElement.getTransformPagePoint());let o=Bve(s.layout.layoutBox,i);if(n){const l=n(Hve(o));this.hasMutatedConstraints=!!l,l&&(o=X9(l))}return o}startAnimation(e){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:o,onDragTransitionEnd:l}=this.getProps(),c=this.constraints||{},u=ro(d=>{if(!ux(d,n,this.currentDirection))return;let h=c&&c[d]||{};o&&(h={min:0,max:0});const f=s?200:1e6,m=s?40:1e7,g={type:"inertia",velocity:r?e[d]:0,bounceStiffness:f,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...h};return this.startAxisValueAnimation(d,g)});return Promise.all(u).then(l)}startAxisValueAnimation(e,n){const r=this.getAxisMotionValue(e);return r.start(OP(e,r,0,n))}stopAnimation(){ro(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){ro(e=>{var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(e){var n;return(n=this.getAxisMotionValue(e).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(e){const n="_drag"+e.toUpperCase(),r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(e,(r.initial?r.initial[e]:void 0)||0)}snapToCursor(e){ro(n=>{const{drag:r}=this.getProps();if(!ux(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:o,max:l}=s.layout.layoutBox[n];i.set(e[n]-gr(o,l,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!vh(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};ro(o=>{const l=this.getAxisMotionValue(o);if(l){const c=l.get();s[o]=zve({min:c,max:c},this.constraints[o])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ro(o=>{if(!ux(o,e,null))return;const l=this.getAxisMotionValue(o),{min:c,max:u}=this.constraints[o];l.set(gr(c,u,s[o]))})}addListeners(){if(!this.visualElement.current)return;Qve.set(this.visualElement,this);const e=this.visualElement.current,n=Za(e,"pointerdown",c=>{const{drag:u,dragListener:d=!0}=this.getProps();u&&d&&this.start(c)}),r=()=>{const{dragConstraints:c}=this.getProps();vh(c)&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),r();const o=qa(window,"resize",()=>this.scalePositionWithinConstraints()),l=s.addEventListener("didUpdate",({delta:c,hasLayoutChanged:u})=>{this.isDragging&&u&&(ro(d=>{const h=this.getAxisMotionValue(d);h&&(this.originPoint[d]+=c[d].translate,h.set(h.get()+c[d].translate))}),this.visualElement.render())});return()=>{o(),n(),i(),l&&l()}}getProps(){const e=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:o=jT,dragMomentum:l=!0}=e;return{...e,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:o,dragMomentum:l}}}function ux(t,e,n){return(e===!0||e===t)&&(n===null||n===t)}function ewe(t,e=10){let n=null;return Math.abs(t.y)>e?n="y":Math.abs(t.x)>e&&(n="x"),n}class twe extends Kc{constructor(e){super(e),this.removeGroupControls=Er,this.removeListeners=Er,this.controls=new Zve(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Er}unmount(){this.removeGroupControls(),this.removeListeners()}}const A4=t=>(e,n)=>{t&&bn.update(()=>t(e,n))};class nwe extends Kc{constructor(){super(...arguments),this.removePointerDownListener=Er}onPointerDown(e){this.session=new Y9(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:t8(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:A4(e),onStart:A4(n),onMove:r,onEnd:(i,o)=>{delete this.session,s&&bn.update(()=>s(i,o))}}}mount(){this.removePointerDownListener=Za(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}function rwe(){const t=p.useContext(Nb);if(t===null)return[!0,null];const{isPresent:e,onExitComplete:n,register:r}=t,s=p.useId();return p.useEffect(()=>r(s),[]),!e&&n?[!1,()=>n&&n(s)]:[!0]}const uv={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function k4(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const gm={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(Ft.test(t))t=parseFloat(t);else return t;const n=k4(t,e.target.x),r=k4(t,e.target.y);return`${n}% ${r}%`}},swe={correct:(t,{treeScale:e,projectionDelta:n})=>{const r=t,s=Pc.parse(t);if(s.length>5)return r;const i=Pc.createTransformer(t),o=typeof s[0]!="number"?1:0,l=n.x.scale*e.x,c=n.y.scale*e.y;s[0+o]/=l,s[1+o]/=c;const u=gr(l,c,.5);return typeof s[2+o]=="number"&&(s[2+o]/=u),typeof s[3+o]=="number"&&(s[3+o]/=u),i(s)}};class iwe extends ht.Component{componentDidMount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=e;mye(owe),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),uv.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,o=r.projection;return o&&(o.isPresent=i,s||e.layoutDependency!==n||n===void 0?o.willUpdate():this.safeToRemove(),e.isPresent!==i&&(i?o.promote():o.relegate()||bn.postRender(()=>{const l=o.getStack();(!l||!l.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),queueMicrotask(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=e;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function n8(t){const[e,n]=rwe(),r=p.useContext(CP);return ht.createElement(iwe,{...t,layoutGroup:r,switchLayoutGroup:p.useContext(Qz),isPresent:e,safeToRemove:n})}const owe={borderRadius:{...gm,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:gm,borderTopRightRadius:gm,borderBottomLeftRadius:gm,borderBottomRightRadius:gm,boxShadow:swe},r8=["TopLeft","TopRight","BottomLeft","BottomRight"],awe=r8.length,R4=t=>typeof t=="string"?parseFloat(t):t,j4=t=>typeof t=="number"||Ft.test(t);function lwe(t,e,n,r,s,i){s?(t.opacity=gr(0,n.opacity!==void 0?n.opacity:1,cwe(r)),t.opacityExit=gr(e.opacity!==void 0?e.opacity:1,0,uwe(r))):i&&(t.opacity=gr(e.opacity!==void 0?e.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let o=0;o<awe;o++){const l=`border${r8[o]}Radius`;let c=D4(e,l),u=D4(n,l);if(c===void 0&&u===void 0)continue;c||(c=0),u||(u=0),c===0||u===0||j4(c)===j4(u)?(t[l]=Math.max(gr(R4(c),R4(u),r),0),(_a.test(u)||_a.test(c))&&(t[l]+="%")):t[l]=u}(e.rotate||n.rotate)&&(t.rotate=gr(e.rotate||0,n.rotate||0,r))}function D4(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const cwe=s8(0,.5,I9),uwe=s8(.5,.95,Er);function s8(t,e,n){return r=>r<t?0:r>e?1:n(vf(t,e,r))}function M4(t,e){t.min=e.min,t.max=e.max}function no(t,e){M4(t.x,e.x),M4(t.y,e.y)}function L4(t,e,n,r,s){return t-=e,t=Hw(t,1/n,r),s!==void 0&&(t=Hw(t,1/s,r)),t}function dwe(t,e=0,n=1,r=.5,s,i=t,o=t){if(_a.test(e)&&(e=parseFloat(e),e=gr(o.min,o.max,e/100)-o.min),typeof e!="number")return;let l=gr(i.min,i.max,r);t===i&&(l-=e),t.min=L4(t.min,e,n,l,s),t.max=L4(t.max,e,n,l,s)}function F4(t,e,[n,r,s],i,o){dwe(t,e[n],e[r],e[s],e.scale,i,o)}const hwe=["x","scaleX","originX"],fwe=["y","scaleY","originY"];function O4(t,e,n,r){F4(t.x,e,hwe,n?n.x:void 0,r?r.x:void 0),F4(t.y,e,fwe,n?n.y:void 0,r?r.y:void 0)}function $4(t){return t.translate===0&&t.scale===1}function i8(t){return $4(t.x)&&$4(t.y)}function mwe(t,e){return t.x.min===e.x.min&&t.x.max===e.x.max&&t.y.min===e.y.min&&t.y.max===e.y.max}function o8(t,e){return Math.round(t.x.min)===Math.round(e.x.min)&&Math.round(t.x.max)===Math.round(e.x.max)&&Math.round(t.y.min)===Math.round(e.y.min)&&Math.round(t.y.max)===Math.round(e.y.max)}function V4(t){return Qi(t.x)/Qi(t.y)}class pwe{constructor(){this.members=[]}add(e){$P(this.members,e),e.scheduleRender()}remove(e){if(VP(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(e){const n=this.members.findIndex(s=>e===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(e,n){const r=this.lead;if(e!==r&&(this.prevLead=r,this.lead=e,e.show(),r)){r.instance&&r.scheduleRender(),e.scheduleRender(),e.resumeFrom=r,n&&(e.resumeFrom.preserveOpacity=!0),r.snapshot&&(e.snapshot=r.snapshot,e.snapshot.latestValues=r.animationValues||r.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0);const{crossfade:s}=e.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:n,resumingFrom:r}=e;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function U4(t,e,n){let r="";const s=t.x.translate/e.x,i=t.y.translate/e.y;if((s||i)&&(r=`translate3d(${s}px, ${i}px, 0) `),(e.x!==1||e.y!==1)&&(r+=`scale(${1/e.x}, ${1/e.y}) `),n){const{rotate:c,rotateX:u,rotateY:d}=n;c&&(r+=`rotate(${c}deg) `),u&&(r+=`rotateX(${u}deg) `),d&&(r+=`rotateY(${d}deg) `)}const o=t.x.scale*e.x,l=t.y.scale*e.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const gwe=(t,e)=>t.depth-e.depth;class ywe{constructor(){this.children=[],this.isDirty=!1}add(e){$P(this.children,e),this.isDirty=!0}remove(e){VP(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(gwe),this.isDirty=!1,this.children.forEach(e)}}function xwe(t,e){const n=performance.now(),r=({timestamp:s})=>{const i=s-n;i>=e&&(Ho(r),t(i-e))};return bn.read(r,!0),()=>Ho(r)}function vwe(t){window.MotionDebug&&window.MotionDebug.record(t)}function wwe(t){return t instanceof SVGElement&&t.tagName!=="svg"}function bwe(t,e,n){const r=vi(t)?t:Lo(t);return r.start(OP("",r,e,n)),r.animation}const B4=["","X","Y","Z"],_we={visibility:"hidden"},z4=1e3;let Swe=0;const mu={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0};function a8({attachResizeListener:t,defaultParent:e,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(o={},l=e==null?void 0:e()){this.id=Swe++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,mu.totalNodes=mu.resolvedTargetDeltas=mu.recalculatedProjection=0,this.nodes.forEach(Twe),this.nodes.forEach(kwe),this.nodes.forEach(Rwe),this.nodes.forEach(Iwe),vwe(mu)},this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=o,this.root=l?l.root||l:this,this.path=l?[...l.path,l]:[],this.parent=l,this.depth=l?l.depth+1:0;for(let c=0;c<this.path.length;c++)this.path[c].shouldResetTransform=!0;this.root===this&&(this.nodes=new ywe)}addEventListener(o,l){return this.eventHandlers.has(o)||this.eventHandlers.set(o,new UP),this.eventHandlers.get(o).add(l)}notifyListeners(o,...l){const c=this.eventHandlers.get(o);c&&c.notify(...l)}hasListeners(o){return this.eventHandlers.has(o)}mount(o,l=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=wwe(o),this.instance=o;const{layoutId:c,layout:u,visualElement:d}=this.options;if(d&&!d.current&&d.mount(o),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),l&&(u||c)&&(this.isLayoutDirty=!0),t){let h;const f=()=>this.root.updateBlockedByResize=!1;t(o,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=xwe(f,250),uv.hasAnimatedSinceResize&&(uv.hasAnimatedSinceResize=!1,this.nodes.forEach(W4))})}c&&this.root.registerSharedNode(c,this),this.options.animate!==!1&&d&&(c||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f,hasRelativeTargetChanged:m,layout:g})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const x=this.options.transition||d.getDefaultTransition()||Fwe,{onLayoutAnimationStart:w,onLayoutAnimationComplete:v}=d.getProps(),_=!this.targetLayout||!o8(this.targetLayout,g)||m,C=!f&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||C||f&&(_||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,C);const T={...FP(x,"layout"),onPlay:w,onComplete:v};(d.shouldReduceMotion||this.options.layoutRoot)&&(T.delay=0,T.type=!1),this.startAnimation(T)}else f||W4(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=g})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const o=this.getStack();o&&o.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Ho(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(jwe),this.animationId++)}getTransformTemplate(){const{visualElement:o}=this.options;return o&&o.getProps().transformTemplate}willUpdate(o=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let d=0;d<this.path.length;d++){const h=this.path[d];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:l,layout:c}=this.options;if(l===void 0&&!c)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),o&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(G4);return}this.isUpdating||this.nodes.forEach(Pwe),this.isUpdating=!1,this.nodes.forEach(Awe),this.nodes.forEach(Cwe),this.nodes.forEach(Ewe),this.clearAllSnapshots();const l=performance.now();ms.delta=Nc(0,1e3/60,l-ms.timestamp),ms.timestamp=l,ms.isProcessing=!0,TS.update.process(ms),TS.preRender.process(ms),TS.render.process(ms),ms.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>this.update()))}clearAllSnapshots(){this.nodes.forEach(Nwe),this.sharedNodes.forEach(Dwe)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,bn.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){bn.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let c=0;c<this.path.length;c++)this.path[c].updateScroll();const o=this.layout;this.layout=this.measure(!1),this.layoutCorrected=$r(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:l}=this.options;l&&l.notify("LayoutMeasure",this.layout.layoutBox,o?o.layoutBox:void 0)}updateScroll(o="measure"){let l=!!(this.options.layoutScroll&&this.instance);this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===o&&(l=!1),l&&(this.scroll={animationId:this.root.animationId,phase:o,isRoot:r(this.instance),offset:n(this.instance)})}resetTransform(){if(!s)return;const o=this.isLayoutDirty||this.shouldResetTransform,l=this.projectionDelta&&!i8(this.projectionDelta),c=this.getTransformTemplate(),u=c?c(this.latestValues,""):void 0,d=u!==this.prevTransformTemplateValue;o&&(l||fu(this.latestValues)||d)&&(s(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(o=!0){const l=this.measurePageBox();let c=this.removeElementScroll(l);return o&&(c=this.removeTransform(c)),Owe(c),{animationId:this.root.animationId,measuredBox:l,layoutBox:c,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:o}=this.options;if(!o)return $r();const l=o.measureViewportBox(),{scroll:c}=this.root;return c&&(Ul(l.x,c.offset.x),Ul(l.y,c.offset.y)),l}removeElementScroll(o){const l=$r();no(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;if(u!==this.root&&d&&h.layoutScroll){if(d.isRoot){no(l,o);const{scroll:f}=this.root;f&&(Ul(l.x,-f.offset.x),Ul(l.y,-f.offset.y))}Ul(l.x,d.offset.x),Ul(l.y,d.offset.y)}}return l}applyTransform(o,l=!1){const c=$r();no(c,o);for(let u=0;u<this.path.length;u++){const d=this.path[u];!l&&d.options.layoutScroll&&d.scroll&&d!==d.root&&_h(c,{x:-d.scroll.offset.x,y:-d.scroll.offset.y}),fu(d.latestValues)&&_h(c,d.latestValues)}return fu(this.latestValues)&&_h(c,this.latestValues),c}removeTransform(o){const l=$r();no(l,o);for(let c=0;c<this.path.length;c++){const u=this.path[c];if(!u.instance||!fu(u.latestValues))continue;DT(u.latestValues)&&u.updateSnapshot();const d=$r(),h=u.measurePageBox();no(d,h),O4(l,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,d)}return fu(this.latestValues)&&O4(l,this.latestValues),l}setTargetDelta(o){this.targetDelta=o,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(o){this.options={...this.options,...o,crossfade:o.crossfade!==void 0?o.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ms.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(o=!1){var l;const c=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=c.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=c.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=c.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==c;if(!(o||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((l=this.parent)===null||l===void 0)&&l.isProjectionDirty||this.attemptToResolveRelativeTarget))return;const{layout:h,layoutId:f}=this.options;if(!(!this.layout||!(h||f))){if(this.resolvedRelativeTargetAt=ms.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$r(),this.relativeTargetOrigin=$r(),yp(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),no(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=$r(),this.targetWithTransforms=$r()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),$ve(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):no(this.target,this.layout.layoutBox),Z9(this.target,this.targetDelta)):no(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=$r(),this.relativeTargetOrigin=$r(),yp(this.relativeTargetOrigin,this.target,m.target),no(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}mu.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||DT(this.parent.latestValues)||Q9(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var o;const l=this.getLead(),c=!!this.resumingFrom||this!==l;let u=!0;if((this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty)&&(u=!1),c&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===ms.timestamp&&(u=!1),u)return;const{layout:d,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(d||h))return;no(this.layoutCorrected,this.layout.layoutBox);const f=this.treeScale.x,m=this.treeScale.y;Kve(this.layoutCorrected,this.treeScale,this.path,c),l.layout&&!l.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(l.target=l.layout.layoutBox);const{target:g}=l;if(!g){this.projectionTransform&&(this.projectionDelta=bh(),this.projectionTransform="none",this.scheduleRender());return}this.projectionDelta||(this.projectionDelta=bh(),this.projectionDeltaWithTransform=bh());const x=this.projectionTransform;gp(this.projectionDelta,this.layoutCorrected,g,this.latestValues),this.projectionTransform=U4(this.projectionDelta,this.treeScale),(this.projectionTransform!==x||this.treeScale.x!==f||this.treeScale.y!==m)&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",g)),mu.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(o=!0){if(this.options.scheduleRender&&this.options.scheduleRender(),o){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}setAnimationOrigin(o,l=!1){const c=this.snapshot,u=c?c.latestValues:{},d={...this.latestValues},h=bh();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!l;const f=$r(),m=c?c.source:void 0,g=this.layout?this.layout.source:void 0,x=m!==g,w=this.getStack(),v=!w||w.members.length<=1,_=!!(x&&!v&&this.options.crossfade===!0&&!this.path.some(Lwe));this.animationProgress=0;let C;this.mixTargetDelta=T=>{const R=T/1e3;H4(h.x,o.x,R),H4(h.y,o.y,R),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(yp(f,this.layout.layoutBox,this.relativeParent.layout.layoutBox),Mwe(this.relativeTarget,this.relativeTargetOrigin,f,R),C&&mwe(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=$r()),no(C,this.relativeTarget)),x&&(this.animationValues=d,lwe(d,u,this.latestValues,R,_,v)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=R},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(o){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Ho(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=bn.update(()=>{uv.hasAnimatedSinceResize=!0,this.currentAnimation=bwe(0,z4,{...o,onUpdate:l=>{this.mixTargetDelta(l),o.onUpdate&&o.onUpdate(l)},onComplete:()=>{o.onComplete&&o.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const o=this.getStack();o&&o.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(z4),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const o=this.getLead();let{targetWithTransforms:l,target:c,layout:u,latestValues:d}=o;if(!(!l||!c||!u)){if(this!==o&&this.layout&&u&&l8(this.options.animationType,this.layout.layoutBox,u.layoutBox)){c=this.target||$r();const h=Qi(this.layout.layoutBox.x);c.x.min=o.target.x.min,c.x.max=c.x.min+h;const f=Qi(this.layout.layoutBox.y);c.y.min=o.target.y.min,c.y.max=c.y.min+f}no(l,c),_h(l,d),gp(this.projectionDeltaWithTransform,this.layoutCorrected,l,d)}}registerSharedNode(o,l){this.sharedNodes.has(o)||this.sharedNodes.set(o,new pwe),this.sharedNodes.get(o).add(l);const u=l.options.initialPromotionConfig;l.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(l):void 0})}isLead(){const o=this.getStack();return o?o.lead===this:!0}getLead(){var o;const{layoutId:l}=this.options;return l?((o=this.getStack())===null||o===void 0?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:l}=this.options;return l?(o=this.getStack())===null||o===void 0?void 0:o.prevLead:void 0}getStack(){const{layoutId:o}=this.options;if(o)return this.root.sharedNodes.get(o)}promote({needsReset:o,transition:l,preserveFollowOpacity:c}={}){const u=this.getStack();u&&u.promote(this,c),o&&(this.projectionDelta=void 0,this.needsReset=!0),l&&this.setOptions({transition:l})}relegate(){const o=this.getStack();return o?o.relegate(this):!1}resetRotation(){const{visualElement:o}=this.options;if(!o)return;let l=!1;const{latestValues:c}=o;if((c.rotate||c.rotateX||c.rotateY||c.rotateZ)&&(l=!0),!l)return;const u={};for(let d=0;d<B4.length;d++){const h="rotate"+B4[d];c[h]&&(u[h]=c[h],o.setStaticValue(h,0))}o.render();for(const d in u)o.setStaticValue(d,u[d]);o.scheduleRender()}getProjectionStyles(o){var l,c;if(!this.instance||this.isSVG)return;if(!this.isVisible)return _we;const u={visibility:""},d=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=cv(o==null?void 0:o.pointerEvents)||"",u.transform=d?d(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const x={};return this.options.layoutId&&(x.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,x.pointerEvents=cv(o==null?void 0:o.pointerEvents)||""),this.hasProjected&&!fu(this.latestValues)&&(x.transform=d?d({},""):"none",this.hasProjected=!1),x}const f=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=U4(this.projectionDeltaWithTransform,this.treeScale,f),d&&(u.transform=d(f,u.transform));const{x:m,y:g}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${g.origin*100}% 0`,h.animationValues?u.opacity=h===this?(c=(l=f.opacity)!==null&&l!==void 0?l:this.latestValues.opacity)!==null&&c!==void 0?c:1:this.preserveOpacity?this.latestValues.opacity:f.opacityExit:u.opacity=h===this?f.opacity!==void 0?f.opacity:"":f.opacityExit!==void 0?f.opacityExit:0;for(const x in $w){if(f[x]===void 0)continue;const{correct:w,applyTo:v}=$w[x],_=u.transform==="none"?f[x]:w(f[x],h);if(v){const C=v.length;for(let T=0;T<C;T++)u[v[T]]=_}else u[x]=_}return this.options.layoutId&&(u.pointerEvents=h===this?cv(o==null?void 0:o.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(o=>{var l;return(l=o.currentAnimation)===null||l===void 0?void 0:l.stop()}),this.root.nodes.forEach(G4),this.root.sharedNodes.clear()}}}function Cwe(t){t.updateLayout()}function Ewe(t){var e;const n=((e=t.resumeFrom)===null||e===void 0?void 0:e.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&n&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=t.layout,{animationType:i}=t.options,o=n.source!==t.layout.source;i==="size"?ro(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=Qi(f);f.min=r[h].min,f.max=f.min+m}):l8(i,n.layoutBox,r)&&ro(h=>{const f=o?n.measuredBox[h]:n.layoutBox[h],m=Qi(r[h]);f.max=f.min+m,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[h].max=t.relativeTarget[h].min+m)});const l=bh();gp(l,r,n.layoutBox);const c=bh();o?gp(c,t.applyTransform(s,!0),n.measuredBox):gp(c,r,n.layoutBox);const u=!i8(l);let d=!1;if(!t.resumeFrom){const h=t.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:f,layout:m}=h;if(f&&m){const g=$r();yp(g,n.layoutBox,f.layoutBox);const x=$r();yp(x,r,m.layoutBox),o8(g,x)||(d=!0),h.options.layoutRoot&&(t.relativeTarget=x,t.relativeTargetOrigin=g,t.relativeParent=h)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:c,layoutDelta:l,hasLayoutChanged:u,hasRelativeTargetChanged:d})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function Twe(t){mu.totalNodes++,t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function Iwe(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function Nwe(t){t.clearSnapshot()}function G4(t){t.clearMeasurements()}function Pwe(t){t.isLayoutDirty=!1}function Awe(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function W4(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function kwe(t){t.resolveTargetDelta()}function Rwe(t){t.calcProjection()}function jwe(t){t.resetRotation()}function Dwe(t){t.removeLeadSnapshot()}function H4(t,e,n){t.translate=gr(e.translate,0,n),t.scale=gr(e.scale,1,n),t.origin=e.origin,t.originPoint=e.originPoint}function q4(t,e,n,r){t.min=gr(e.min,n.min,r),t.max=gr(e.max,n.max,r)}function Mwe(t,e,n,r){q4(t.x,e.x,n.x,r),q4(t.y,e.y,n.y,r)}function Lwe(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const Fwe={duration:.45,ease:[.4,0,.1,1]},K4=t=>typeof navigator<"u"&&navigator.userAgent.toLowerCase().includes(t),Y4=K4("applewebkit/")&&!K4("chrome/")?Math.round:Er;function J4(t){t.min=Y4(t.min),t.max=Y4(t.max)}function Owe(t){J4(t.x),J4(t.y)}function l8(t,e,n){return t==="position"||t==="preserve-aspect"&&!RT(V4(e),V4(n),.2)}const $we=a8({attachResizeListener:(t,e)=>qa(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),FS={current:void 0},c8=a8({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!FS.current){const t=new $we({});t.mount(window),t.setOptions({layoutScroll:!0}),FS.current=t}return FS.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Vwe={pan:{Feature:nwe},drag:{Feature:twe,ProjectionNode:c8,MeasureLayout:n8}},Uwe=/var\((--[a-zA-Z0-9-_]+),? ?([a-zA-Z0-9 ()%#.,-]+)?\)/;function Bwe(t){const e=Uwe.exec(t);if(!e)return[,];const[,n,r]=e;return[n,r]}function LT(t,e,n=1){const[r,s]=Bwe(t);if(!r)return;const i=window.getComputedStyle(e).getPropertyValue(r);if(i){const o=i.trim();return W9(o)?parseFloat(o):o}else return ET(s)?LT(s,e,n+1):s}function zwe(t,{...e},n){const r=t.current;if(!(r instanceof Element))return{target:e,transitionEnd:n};n&&(n={...n}),t.values.forEach(s=>{const i=s.get();if(!ET(i))return;const o=LT(i,r);o&&s.set(o)});for(const s in e){const i=e[s];if(!ET(i))continue;const o=LT(i,r);o&&(e[s]=o,n||(n={}),n[s]===void 0&&(n[s]=i))}return{target:e,transitionEnd:n}}const Gwe=new Set(["width","height","top","left","right","bottom","x","y","translateX","translateY"]),u8=t=>Gwe.has(t),Wwe=t=>Object.keys(t).some(u8),X4=t=>t===xd||t===Ft,Q4=(t,e)=>parseFloat(t.split(", ")[e]),Z4=(t,e)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const s=r.match(/^matrix3d\((.+)\)$/);if(s)return Q4(s[1],e);{const i=r.match(/^matrix\((.+)\)$/);return i?Q4(i[1],t):0}},Hwe=new Set(["x","y","z"]),qwe=Xg.filter(t=>!Hwe.has(t));function Kwe(t){const e=[];return qwe.forEach(n=>{const r=t.getValue(n);r!==void 0&&(e.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),e.length&&t.render(),e}const wf={width:({x:t},{paddingLeft:e="0",paddingRight:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),height:({y:t},{paddingTop:e="0",paddingBottom:n="0"})=>t.max-t.min-parseFloat(e)-parseFloat(n),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:Z4(4,13),y:Z4(5,14)};wf.translateX=wf.x;wf.translateY=wf.y;const Ywe=(t,e,n)=>{const r=e.measureViewportBox(),s=e.current,i=getComputedStyle(s),{display:o}=i,l={};o==="none"&&e.setStaticValue("display",t.display||"block"),n.forEach(u=>{l[u]=wf[u](r,i)}),e.render();const c=e.measureViewportBox();return n.forEach(u=>{const d=e.getValue(u);d&&d.jump(l[u]),t[u]=wf[u](c,i)}),t},Jwe=(t,e,n={},r={})=>{e={...e},r={...r};const s=Object.keys(e).filter(u8);let i=[],o=!1;const l=[];if(s.forEach(c=>{const u=t.getValue(c);if(!t.hasValue(c))return;let d=n[c],h=pm(d);const f=e[c];let m;if(Uw(f)){const g=f.length,x=f[0]===null?1:0;d=f[x],h=pm(d);for(let w=x;w<g&&f[w]!==null;w++)m?Mb(pm(f[w])===m):m=pm(f[w])}else m=pm(f);if(h!==m)if(X4(h)&&X4(m)){const g=u.get();typeof g=="string"&&u.set(parseFloat(g)),typeof f=="string"?e[c]=parseFloat(f):Array.isArray(f)&&m===Ft&&(e[c]=f.map(parseFloat))}else h!=null&&h.transform&&(m!=null&&m.transform)&&(d===0||f===0)?d===0?u.set(m.transform(d)):e[c]=h.transform(f):(o||(i=Kwe(t),o=!0),l.push(c),r[c]=r[c]!==void 0?r[c]:e[c],u.jump(f))}),l.length){const c=l.indexOf("height")>=0?window.pageYOffset:null,u=Ywe(e,t,l);return i.length&&i.forEach(([d,h])=>{t.getValue(d).set(h)}),t.render(),Pb&&c!==null&&window.scrollTo({top:c}),{target:u,transitionEnd:r}}else return{target:e,transitionEnd:r}};function Xwe(t,e,n,r){return Wwe(e)?Jwe(t,e,n,r):{target:e,transitionEnd:r}}const Qwe=(t,e,n,r)=>{const s=zwe(t,e,r);return e=s.target,r=s.transitionEnd,Xwe(t,e,n,r)},FT={current:null},d8={current:!1};function Zwe(){if(d8.current=!0,!!Pb)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>FT.current=t.matches;t.addListener(e),e()}else FT.current=!1}function e0e(t,e,n){const{willChange:r}=e;for(const s in e){const i=e[s],o=n[s];if(vi(i))t.addValue(s,i),Ww(r)&&r.add(s);else if(vi(o))t.addValue(s,Lo(i,{owner:t})),Ww(r)&&r.remove(s);else if(o!==i)if(t.hasValue(s)){const l=t.getValue(s);!l.hasAnimated&&l.set(i)}else{const l=t.getStaticValue(s);t.addValue(s,Lo(l!==void 0?l:i,{owner:t}))}}for(const s in n)e[s]===void 0&&t.removeValue(s);return e}const eL=new WeakMap,h8=Object.keys(lg),t0e=h8.length,tL=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"],n0e=SP.length;class r0e{constructor({parent:e,props:n,presenceContext:r,reducedMotionConfig:s,visualState:i},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.scheduleRender=()=>bn.render(this.render,!1,!0);const{latestValues:l,renderState:c}=i;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=e,this.props=n,this.presenceContext=r,this.depth=e?e.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.isControllingVariants=kb(n),this.isVariantNode=Xz(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{});for(const h in d){const f=d[h];l[h]!==void 0&&vi(f)&&(f.set(l[h],!1),Ww(u)&&u.add(h))}}scrapeMotionValuesFromProps(e,n){return{}}mount(e){this.current=e,eL.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),d8.current||Zwe(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:FT.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){eL.delete(this.current),this.projection&&this.projection.unmount(),Ho(this.notifyUpdate),Ho(this.render),this.valueSubscriptions.forEach(e=>e()),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const e in this.events)this.events[e].clear();for(const e in this.features)this.features[e].unmount();this.current=null}bindToMotionValue(e,n){const r=yd.has(e),s=n.on("change",o=>{this.latestValues[e]=o,this.props.onUpdate&&bn.update(this.notifyUpdate,!1,!0),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);this.valueSubscriptions.set(e,()=>{s(),i()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}loadFeatures({children:e,...n},r,s,i){let o,l;for(let c=0;c<t0e;c++){const u=h8[c],{isEnabled:d,Feature:h,ProjectionNode:f,MeasureLayout:m}=lg[u];f&&(o=f),d(n)&&(!this.features[u]&&h&&(this.features[u]=new h(this)),m&&(l=m))}if((this.type==="html"||this.type==="svg")&&!this.projection&&o){this.projection=new o(this.latestValues,this.parent&&this.parent.projection);const{layoutId:c,layout:u,drag:d,dragConstraints:h,layoutScroll:f,layoutRoot:m}=n;this.projection.setOptions({layoutId:c,layout:u,alwaysMeasureLayout:!!d||h&&vh(h),visualElement:this,scheduleRender:()=>this.scheduleRender(),animationType:typeof u=="string"?u:"both",initialPromotionConfig:i,layoutScroll:f,layoutRoot:m})}return l}updateFeatures(){for(const e in this.features){const n=this.features[e];n.isMounted?n.update():(n.mount(),n.isMounted=!0)}}triggerBuild(){this.build(this.renderState,this.latestValues,this.options,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):$r()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,n){this.latestValues[e]=n}makeTargetAnimatable(e,n=!0){return this.makeTargetAnimatableFromInstance(e,this.props,n)}update(e,n){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<tL.length;r++){const s=tL[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i=e["on"+s];i&&(this.propEventSubscriptions[s]=this.on(s,i))}this.prevMotionValues=e0e(this,this.scrapeMotionValuesFromProps(e,this.prevProps),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}getVariantContext(e=!1){if(e)return this.parent?this.parent.getVariantContext():void 0;if(!this.isControllingVariants){const r=this.parent?this.parent.getVariantContext()||{}:{};return this.props.initial!==void 0&&(r.initial=this.props.initial),r}const n={};for(let r=0;r<n0e;r++){const s=SP[r],i=this.props[s];(ag(i)||i===!1)&&(n[s]=i)}return n}addVariantChild(e){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(e),()=>n.variantChildren.delete(e)}addValue(e,n){n!==this.values.get(e)&&(this.removeValue(e),this.bindToMotionValue(e,n)),this.values.set(e,n),this.latestValues[e]=n.get()}removeValue(e){this.values.delete(e);const n=this.valueSubscriptions.get(e);n&&(n(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,n){if(this.props.values&&this.props.values[e])return this.props.values[e];let r=this.values.get(e);return r===void 0&&n!==void 0&&(r=Lo(n,{owner:this}),this.addValue(e,r)),r}readValue(e){var n;return this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:(n=this.getBaseTargetFromProps(this.props,e))!==null&&n!==void 0?n:this.readValueFromInstance(this.current,e,this.options)}setBaseTarget(e,n){this.baseTarget[e]=n}getBaseTarget(e){var n;const{initial:r}=this.props,s=typeof r=="string"||typeof r=="object"?(n=kP(this.props,r))===null||n===void 0?void 0:n[e]:void 0;if(r&&s!==void 0)return s;const i=this.getBaseTargetFromProps(this.props,e);return i!==void 0&&!vi(i)?i:this.initialValues[e]!==void 0&&s===void 0?void 0:this.baseTarget[e]}on(e,n){return this.events[e]||(this.events[e]=new UP),this.events[e].add(n)}notify(e,...n){this.events[e]&&this.events[e].notify(...n)}}class f8 extends r0e{sortInstanceNodePosition(e,n){return e.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(e,n){return e.style?e.style[n]:void 0}removeValueFromRenderState(e,{vars:n,style:r}){delete n[e],delete r[e]}makeTargetAnimatableFromInstance({transition:e,transitionEnd:n,...r},{transformValues:s},i){let o=wve(r,e||{},this);if(s&&(n&&(n=s(n)),r&&(r=s(r)),o&&(o=s(o))),i){xve(this,r,o);const l=Qwe(this,r,o,n);n=l.transitionEnd,r=l.target}return{transition:e,transitionEnd:n,...r}}}function s0e(t){return window.getComputedStyle(t)}class i0e extends f8{constructor(){super(...arguments),this.type="html"}readValueFromInstance(e,n){if(yd.has(n)){const r=LP(n);return r&&r.default||0}else{const r=s0e(e),s=(t9(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(e,{transformPagePoint:n}){return e8(e,n)}build(e,n,r,s){TP(e,n,r,s.transformTemplate)}scrapeMotionValuesFromProps(e,n){return AP(e,n)}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;vi(e)&&(this.childSubscription=e.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}renderInstance(e,n,r,s){a9(e,n,r,s)}}class o0e extends f8{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1}getBaseTargetFromProps(e,n){return e[n]}readValueFromInstance(e,n){if(yd.has(n)){const r=LP(n);return r&&r.default||0}return n=l9.has(n)?n:bP(n),e.getAttribute(n)}measureInstanceViewportBox(){return $r()}scrapeMotionValuesFromProps(e,n){return u9(e,n)}build(e,n,r,s){NP(e,n,r,this.isSVGTag,s.transformTemplate)}renderInstance(e,n,r,s){c9(e,n,r,s)}mount(e){this.isSVGTag=PP(e.tagName),super.mount(e)}}const a0e=(t,e)=>EP(t)?new o0e(e,{enableHardwareAcceleration:!1}):new i0e(e,{enableHardwareAcceleration:!0}),l0e={layout:{ProjectionNode:c8,MeasureLayout:n8}},c0e={...Mve,...rxe,...Vwe,...l0e},Ct=hye((t,e)=>Gye(t,e,c0e,a0e));function m8(){const t=p.useRef(!1);return Jg(()=>(t.current=!0,()=>{t.current=!1}),[]),t}function u0e(){const t=m8(),[e,n]=p.useState(0),r=p.useCallback(()=>{t.current&&n(e+1)},[e]);return[p.useCallback(()=>bn.postRender(r),[r]),e]}class d0e extends p.Component{getSnapshotBeforeUpdate(e){const n=this.props.childRef.current;if(n&&e.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function h0e({children:t,isPresent:e}){const n=p.useId(),r=p.useRef(null),s=p.useRef({width:0,height:0,top:0,left:0});return p.useInsertionEffect(()=>{const{width:i,height:o,top:l,left:c}=s.current;if(e||!r.current||!i||!o)return;r.current.dataset.motionPopId=n;const u=document.createElement("style");return document.head.appendChild(u),u.sheet&&u.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${i}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${c}px !important;
          }
        `),()=>{document.head.removeChild(u)}},[e]),p.createElement(d0e,{isPresent:e,childRef:r,sizeRef:s},p.cloneElement(t,{ref:r}))}const OS=({children:t,initial:e,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:o})=>{const l=ey(f0e),c=p.useId(),u=p.useMemo(()=>({id:c,initial:e,isPresent:n,custom:s,onExitComplete:d=>{l.set(d,!0);for(const h of l.values())if(!h)return;r&&r()},register:d=>(l.set(d,!1),()=>l.delete(d))}),i?void 0:[n]);return p.useMemo(()=>{l.forEach((d,h)=>l.set(h,!1))},[n]),p.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),o==="popLayout"&&(t=p.createElement(h0e,{isPresent:n},t)),p.createElement(Nb.Provider,{value:u},t)};function f0e(){return new Map}function m0e(t){return p.useEffect(()=>()=>t(),[])}const pu=t=>t.key||"";function p0e(t,e){t.forEach(n=>{const r=pu(n);e.set(r,n)})}function g0e(t){const e=[];return p.Children.forEach(t,n=>{p.isValidElement(n)&&e.push(n)}),e}const Ac=({children:t,custom:e,initial:n=!0,onExitComplete:r,exitBeforeEnter:s,presenceAffectsLayout:i=!0,mode:o="sync"})=>{const l=p.useContext(CP).forceRender||u0e()[0],c=m8(),u=g0e(t);let d=u;const h=p.useRef(new Map).current,f=p.useRef(d),m=p.useRef(new Map).current,g=p.useRef(!0);if(Jg(()=>{g.current=!1,p0e(u,m),f.current=d}),m0e(()=>{g.current=!0,m.clear(),h.clear()}),g.current)return p.createElement(p.Fragment,null,d.map(_=>p.createElement(OS,{key:pu(_),isPresent:!0,initial:n?void 0:!1,presenceAffectsLayout:i,mode:o},_)));d=[...d];const x=f.current.map(pu),w=u.map(pu),v=x.length;for(let _=0;_<v;_++){const C=x[_];w.indexOf(C)===-1&&!h.has(C)&&h.set(C,void 0)}return o==="wait"&&h.size&&(d=[]),h.forEach((_,C)=>{if(w.indexOf(C)!==-1)return;const T=m.get(C);if(!T)return;const R=x.indexOf(C);let k=_;if(!k){const E=()=>{h.delete(C);const I=Array.from(m.keys()).filter(P=>!w.includes(P));if(I.forEach(P=>m.delete(P)),f.current=u.filter(P=>{const A=pu(P);return A===C||I.includes(A)}),!h.size){if(c.current===!1)return;l(),r&&r()}};k=p.createElement(OS,{key:pu(T),isPresent:!1,onExitComplete:E,custom:e,presenceAffectsLayout:i,mode:o},T),h.set(C,k)}d.splice(R,0,k)}),d=d.map(_=>{const C=_.key;return h.has(C)?_:p.createElement(OS,{key:pu(_),isPresent:!0,presenceAffectsLayout:i,mode:o},_)}),p.createElement(p.Fragment,null,h.size?d:d.map(_=>p.cloneElement(_)))};function y0e(t){const e=ey(()=>Lo(t)),{isStatic:n}=p.useContext(wP);if(n){const[,r]=p.useState(t);p.useEffect(()=>e.on("change",r),[])}return e}const x0e=t=>t&&typeof t=="object"&&t.mix,v0e=t=>x0e(t)?t.mix:void 0;function w0e(...t){const e=!Array.isArray(t[0]),n=e?0:-1,r=t[0+n],s=t[1+n],i=t[2+n],o=t[3+n],l=Lb(s,i,{mixer:v0e(i[0]),...o});return e?l(r):l}function p8(t,e){const n=y0e(e()),r=()=>n.set(e());return r(),Jg(()=>{const s=()=>bn.update(r,!1,!0),i=t.map(o=>o.on("change",s));return()=>{i.forEach(o=>o()),Ho(r)}}),n}function b0e(t){pp.current=[],t();const e=p8(pp.current,t);return pp.current=void 0,e}function $S(t,e,n,r){if(typeof t=="function")return b0e(t);const s=typeof e=="function"?e:w0e(e,n,r);return Array.isArray(t)?nL(t,s):nL([t],([i])=>s(i))}function nL(t,e){const n=ey(()=>[]);return p8(t,()=>{n.length=0;const r=t.length;for(let s=0;s<r;s++)n[s]=t[s].get();return e(n)})}function g8(t,e,n){var r;if(typeof t=="string"){let s=document;e&&(Mb(!!e.current),s=e.current),n?((r=n[t])!==null&&r!==void 0||(n[t]=s.querySelectorAll(t)),t=n[t]):t=s.querySelectorAll(t)}else t instanceof Element&&(t=[t]);return Array.from(t||[])}const dv=new WeakMap;let Fl;function _0e(t,e){if(e){const{inlineSize:n,blockSize:r}=e[0];return{width:n,height:r}}else return t instanceof SVGElement&&"getBBox"in t?t.getBBox():{width:t.offsetWidth,height:t.offsetHeight}}function S0e({target:t,contentRect:e,borderBoxSize:n}){var r;(r=dv.get(t))===null||r===void 0||r.forEach(s=>{s({target:t,contentSize:e,get size(){return _0e(t,n)}})})}function C0e(t){t.forEach(S0e)}function E0e(){typeof ResizeObserver>"u"||(Fl=new ResizeObserver(C0e))}function T0e(t,e){Fl||E0e();const n=g8(t);return n.forEach(r=>{let s=dv.get(r);s||(s=new Set,dv.set(r,s)),s.add(e),Fl==null||Fl.observe(r)}),()=>{n.forEach(r=>{const s=dv.get(r);s==null||s.delete(e),s!=null&&s.size||Fl==null||Fl.unobserve(r)})}}const hv=new Set;let xp;function I0e(){xp=()=>{const t={width:window.innerWidth,height:window.innerHeight},e={target:window,size:t,contentSize:t};hv.forEach(n=>n(e))},window.addEventListener("resize",xp)}function N0e(t){return hv.add(t),xp||I0e(),()=>{hv.delete(t),!hv.size&&xp&&(xp=void 0)}}function P0e(t,e){return typeof t=="function"?N0e(t):T0e(t,e)}const A0e=50,rL=()=>({current:0,offset:[],progress:0,scrollLength:0,targetOffset:0,targetLength:0,containerLength:0,velocity:0}),k0e=()=>({time:0,x:rL(),y:rL()}),R0e={x:{length:"Width",position:"Left"},y:{length:"Height",position:"Top"}};function sL(t,e,n,r){const s=n[e],{length:i,position:o}=R0e[e],l=s.current,c=n.time;s.current=t["scroll"+o],s.scrollLength=t["scroll"+i]-t["client"+i],s.offset.length=0,s.offset[0]=0,s.offset[1]=s.scrollLength,s.progress=vf(0,s.scrollLength,s.current);const u=r-c;s.velocity=u>A0e?0:MP(s.current-l,u)}function j0e(t,e,n){sL(t,"x",e,n),sL(t,"y",e,n),e.time=n}function D0e(t,e){const n={x:0,y:0};let r=t;for(;r&&r!==e;)if(r instanceof HTMLElement)n.x+=r.offsetLeft,n.y+=r.offsetTop,r=r.offsetParent;else if(r.tagName==="svg"){const s=r.getBoundingClientRect();r=r.parentElement;const i=r.getBoundingClientRect();n.x+=s.left-i.left,n.y+=s.top-i.top}else if(r instanceof SVGGraphicsElement){const{x:s,y:i}=r.getBBox();n.x+=s,n.y+=i;let o=null,l=r.parentNode;for(;!o;)l.tagName==="svg"&&(o=l),l=r.parentNode;r=o}else break;return n}const M0e={Enter:[[0,1],[1,1]],Exit:[[0,0],[1,0]],Any:[[1,0],[0,1]],All:[[0,0],[1,1]]},OT={start:0,center:.5,end:1};function iL(t,e,n=0){let r=0;if(OT[t]!==void 0&&(t=OT[t]),typeof t=="string"){const s=parseFloat(t);t.endsWith("px")?r=s:t.endsWith("%")?t=s/100:t.endsWith("vw")?r=s/100*document.documentElement.clientWidth:t.endsWith("vh")?r=s/100*document.documentElement.clientHeight:t=s}return typeof t=="number"&&(r=e*t),n+r}const L0e=[0,0];function F0e(t,e,n,r){let s=Array.isArray(t)?t:L0e,i=0,o=0;return typeof t=="number"?s=[t,t]:typeof t=="string"&&(t=t.trim(),t.includes(" ")?s=t.split(" "):s=[t,OT[t]?t:"0"]),i=iL(s[0],n,r),o=iL(s[1],e),i-o}const O0e={x:0,y:0};function $0e(t){return"getBBox"in t&&t.tagName!=="svg"?t.getBBox():{width:t.clientWidth,height:t.clientHeight}}function V0e(t,e,n){let{offset:r=M0e.All}=n;const{target:s=t,axis:i="y"}=n,o=i==="y"?"height":"width",l=s!==t?D0e(s,t):O0e,c=s===t?{width:t.scrollWidth,height:t.scrollHeight}:$0e(s),u={width:t.clientWidth,height:t.clientHeight};e[i].offset.length=0;let d=!e[i].interpolate;const h=r.length;for(let f=0;f<h;f++){const m=F0e(r[f],u[o],c[o],l[i]);!d&&m!==e[i].interpolatorOffsets[f]&&(d=!0),e[i].offset[f]=m}d&&(e[i].interpolate=Lb(e[i].offset,V9(r)),e[i].interpolatorOffsets=[...e[i].offset]),e[i].progress=e[i].interpolate(e[i].current)}function U0e(t,e=t,n){if(n.x.targetOffset=0,n.y.targetOffset=0,e!==t){let r=e;for(;r&&r!==t;)n.x.targetOffset+=r.offsetLeft,n.y.targetOffset+=r.offsetTop,r=r.offsetParent}n.x.targetLength=e===t?e.scrollWidth:e.clientWidth,n.y.targetLength=e===t?e.scrollHeight:e.clientHeight,n.x.containerLength=t.clientWidth,n.y.containerLength=t.clientHeight}function B0e(t,e,n,r={}){return{measure:()=>U0e(t,r.target,n),update:s=>{j0e(t,n,s),(r.offset||r.target)&&V0e(t,n,r)},notify:()=>e(n)}}const ym=new WeakMap,oL=new WeakMap,VS=new WeakMap,aL=t=>t===document.documentElement?window:t;function z0e(t,{container:e=document.documentElement,...n}={}){let r=VS.get(e);r||(r=new Set,VS.set(e,r));const s=k0e(),i=B0e(e,t,s,n);if(r.add(i),!ym.has(e)){const l=()=>{for(const f of r)f.measure()},c=()=>{for(const f of r)f.update(ms.timestamp)},u=()=>{for(const f of r)f.notify()},d=()=>{bn.read(l,!1,!0),bn.read(c,!1,!0),bn.update(u,!1,!0)};ym.set(e,d);const h=aL(e);window.addEventListener("resize",d,{passive:!0}),e!==document.documentElement&&oL.set(e,P0e(e,d)),h.addEventListener("scroll",d,{passive:!0})}const o=ym.get(e);return bn.read(o,!1,!0),()=>{var l;Ho(o);const c=VS.get(e);if(!c||(c.delete(i),c.size))return;const u=ym.get(e);ym.delete(e),u&&(aL(e).removeEventListener("scroll",u),(l=oL.get(e))===null||l===void 0||l(),window.removeEventListener("resize",u))}}function lL(t,e){x9(!!(!e||e.current))}const G0e=()=>({scrollX:Lo(0),scrollY:Lo(0),scrollXProgress:Lo(0),scrollYProgress:Lo(0)});function W0e({container:t,target:e,layoutEffect:n=!0,...r}={}){const s=ey(G0e);return(n?Jg:p.useEffect)(()=>(lL("target",e),lL("container",t),z0e(({x:o,y:l})=>{s.scrollX.set(o.current),s.scrollXProgress.set(o.progress),s.scrollY.set(l.current),s.scrollYProgress.set(l.progress)},{...r,container:(t==null?void 0:t.current)||void 0,target:(e==null?void 0:e.current)||void 0})),[t,e,JSON.stringify(r.offset)]),s}const H0e={some:0,all:1};function q0e(t,e,{root:n,margin:r,amount:s="some"}={}){const i=g8(t),o=new WeakMap,l=u=>{u.forEach(d=>{const h=o.get(d.target);if(d.isIntersecting!==!!h)if(d.isIntersecting){const f=e(d);typeof f=="function"?o.set(d.target,f):c.unobserve(d.target)}else h&&(h(d),o.delete(d.target))})},c=new IntersectionObserver(l,{root:n,rootMargin:r,threshold:typeof s=="number"?s:H0e[s]});return i.forEach(u=>c.observe(u)),()=>c.disconnect()}function K0e(t,{root:e,margin:n,amount:r,once:s=!1}={}){const[i,o]=p.useState(!1);return p.useEffect(()=>{if(!t.current||s&&i)return;const l=()=>(o(!0),s?void 0:()=>o(!1)),c={root:e&&e.current||void 0,margin:n,amount:r};return q0e(t.current,l,c)},[e,t,n,s,r]),i}function Y0e(t,[e,n]){return Math.min(n,Math.max(e,t))}function J0e(t,e){return p.useReducer((n,r)=>e[n][r]??n,t)}var BP="ScrollArea",[y8,jje]=bi(BP),[X0e,bo]=y8(BP),x8=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...o}=t,[l,c]=p.useState(null),[u,d]=p.useState(null),[h,f]=p.useState(null),[m,g]=p.useState(null),[x,w]=p.useState(null),[v,_]=p.useState(0),[C,T]=p.useState(0),[R,k]=p.useState(!1),[E,I]=p.useState(!1),P=mn(e,D=>c(D)),A=W0(s);return a.jsx(X0e,{scope:n,type:r,dir:A,scrollHideDelay:i,scrollArea:l,viewport:u,onViewportChange:d,content:h,onContentChange:f,scrollbarX:m,onScrollbarXChange:g,scrollbarXEnabled:R,onScrollbarXEnabledChange:k,scrollbarY:x,onScrollbarYChange:w,scrollbarYEnabled:E,onScrollbarYEnabledChange:I,onCornerWidthChange:_,onCornerHeightChange:T,children:a.jsx(Wt.div,{dir:A,...o,ref:P,style:{position:"relative","--radix-scroll-area-corner-width":v+"px","--radix-scroll-area-corner-height":C+"px",...t.style}})})});x8.displayName=BP;var v8="ScrollAreaViewport",w8=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=t,o=bo(v8,n),l=p.useRef(null),c=mn(e,l,o.onViewportChange);return a.jsxs(a.Fragment,{children:[a.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),a.jsx(Wt.div,{"data-radix-scroll-area-viewport":"",...i,ref:c,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...t.style},children:a.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});w8.displayName=v8;var ka="ScrollAreaScrollbar",zP=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=bo(ka,t.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:o}=s,l=t.orientation==="horizontal";return p.useEffect(()=>(l?i(!0):o(!0),()=>{l?i(!1):o(!1)}),[l,i,o]),s.type==="hover"?a.jsx(Q0e,{...r,ref:e,forceMount:n}):s.type==="scroll"?a.jsx(Z0e,{...r,ref:e,forceMount:n}):s.type==="auto"?a.jsx(b8,{...r,ref:e,forceMount:n}):s.type==="always"?a.jsx(GP,{...r,ref:e}):null});zP.displayName=ka;var Q0e=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=bo(ka,t.__scopeScrollArea),[i,o]=p.useState(!1);return p.useEffect(()=>{const l=s.scrollArea;let c=0;if(l){const u=()=>{window.clearTimeout(c),o(!0)},d=()=>{c=window.setTimeout(()=>o(!1),s.scrollHideDelay)};return l.addEventListener("pointerenter",u),l.addEventListener("pointerleave",d),()=>{window.clearTimeout(c),l.removeEventListener("pointerenter",u),l.removeEventListener("pointerleave",d)}}},[s.scrollArea,s.scrollHideDelay]),a.jsx(_s,{present:n||i,children:a.jsx(b8,{"data-state":i?"visible":"hidden",...r,ref:e})})}),Z0e=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=bo(ka,t.__scopeScrollArea),i=t.orientation==="horizontal",o=Ob(()=>c("SCROLL_END"),100),[l,c]=J0e("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return p.useEffect(()=>{if(l==="idle"){const u=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(u)}},[l,s.scrollHideDelay,c]),p.useEffect(()=>{const u=s.viewport,d=i?"scrollLeft":"scrollTop";if(u){let h=u[d];const f=()=>{const m=u[d];h!==m&&(c("SCROLL"),o()),h=m};return u.addEventListener("scroll",f),()=>u.removeEventListener("scroll",f)}},[s.viewport,i,c,o]),a.jsx(_s,{present:n||l!=="hidden",children:a.jsx(GP,{"data-state":l==="hidden"?"hidden":"visible",...r,ref:e,onPointerEnter:gt(t.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:gt(t.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),b8=p.forwardRef((t,e)=>{const n=bo(ka,t.__scopeScrollArea),{forceMount:r,...s}=t,[i,o]=p.useState(!1),l=t.orientation==="horizontal",c=Ob(()=>{if(n.viewport){const u=n.viewport.offsetWidth<n.viewport.scrollWidth,d=n.viewport.offsetHeight<n.viewport.scrollHeight;o(l?u:d)}},10);return bf(n.viewport,c),bf(n.content,c),a.jsx(_s,{present:r||i,children:a.jsx(GP,{"data-state":i?"visible":"hidden",...s,ref:e})})}),GP=p.forwardRef((t,e)=>{const{orientation:n="vertical",...r}=t,s=bo(ka,t.__scopeScrollArea),i=p.useRef(null),o=p.useRef(0),[l,c]=p.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),u=T8(l.viewport,l.content),d={...r,sizes:l,onSizesChange:c,hasThumb:u>0&&u<1,onThumbChange:f=>i.current=f,onThumbPointerUp:()=>o.current=0,onThumbPointerDown:f=>o.current=f};function h(f,m){return ibe(f,o.current,l,m)}return n==="horizontal"?a.jsx(ebe,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollLeft,m=cL(f,l,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollLeft=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollLeft=h(f,s.dir))}}):n==="vertical"?a.jsx(tbe,{...d,ref:e,onThumbPositionChange:()=>{if(s.viewport&&i.current){const f=s.viewport.scrollTop,m=cL(f,l);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:f=>{s.viewport&&(s.viewport.scrollTop=f)},onDragScroll:f=>{s.viewport&&(s.viewport.scrollTop=h(f))}}):null}),ebe=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=bo(ka,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=mn(e,c,i.onScrollbarXChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(S8,{"data-orientation":"horizontal",...s,ref:u,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Fb(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.x),onDragScroll:d=>t.onDragScroll(d.x),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollLeft+d.deltaX;t.onWheelScroll(f),N8(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:Kw(o.paddingLeft),paddingEnd:Kw(o.paddingRight)}})}})}),tbe=p.forwardRef((t,e)=>{const{sizes:n,onSizesChange:r,...s}=t,i=bo(ka,t.__scopeScrollArea),[o,l]=p.useState(),c=p.useRef(null),u=mn(e,c,i.onScrollbarYChange);return p.useEffect(()=>{c.current&&l(getComputedStyle(c.current))},[c]),a.jsx(S8,{"data-orientation":"vertical",...s,ref:u,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Fb(n)+"px",...t.style},onThumbPointerDown:d=>t.onThumbPointerDown(d.y),onDragScroll:d=>t.onDragScroll(d.y),onWheelScroll:(d,h)=>{if(i.viewport){const f=i.viewport.scrollTop+d.deltaY;t.onWheelScroll(f),N8(f,h)&&d.preventDefault()}},onResize:()=>{c.current&&i.viewport&&o&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:Kw(o.paddingTop),paddingEnd:Kw(o.paddingBottom)}})}})}),[nbe,_8]=y8(ka),S8=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:o,onThumbPointerDown:l,onThumbPositionChange:c,onDragScroll:u,onWheelScroll:d,onResize:h,...f}=t,m=bo(ka,n),[g,x]=p.useState(null),w=mn(e,P=>x(P)),v=p.useRef(null),_=p.useRef(""),C=m.viewport,T=r.content-r.viewport,R=Br(d),k=Br(c),E=Ob(h,10);function I(P){if(v.current){const A=P.clientX-v.current.left,D=P.clientY-v.current.top;u({x:A,y:D})}}return p.useEffect(()=>{const P=A=>{const D=A.target;(g==null?void 0:g.contains(D))&&R(A,T)};return document.addEventListener("wheel",P,{passive:!1}),()=>document.removeEventListener("wheel",P,{passive:!1})},[C,g,T,R]),p.useEffect(k,[r,k]),bf(g,E),bf(m.content,E),a.jsx(nbe,{scope:n,scrollbar:g,hasThumb:s,onThumbChange:Br(i),onThumbPointerUp:Br(o),onThumbPositionChange:k,onThumbPointerDown:Br(l),children:a.jsx(Wt.div,{...f,ref:w,style:{position:"absolute",...f.style},onPointerDown:gt(t.onPointerDown,P=>{P.button===0&&(P.target.setPointerCapture(P.pointerId),v.current=g.getBoundingClientRect(),_.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),I(P))}),onPointerMove:gt(t.onPointerMove,I),onPointerUp:gt(t.onPointerUp,P=>{const A=P.target;A.hasPointerCapture(P.pointerId)&&A.releasePointerCapture(P.pointerId),document.body.style.webkitUserSelect=_.current,m.viewport&&(m.viewport.style.scrollBehavior=""),v.current=null})})})}),qw="ScrollAreaThumb",C8=p.forwardRef((t,e)=>{const{forceMount:n,...r}=t,s=_8(qw,t.__scopeScrollArea);return a.jsx(_s,{present:n||s.hasThumb,children:a.jsx(rbe,{ref:e,...r})})}),rbe=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,style:r,...s}=t,i=bo(qw,n),o=_8(qw,n),{onThumbPositionChange:l}=o,c=mn(e,h=>o.onThumbChange(h)),u=p.useRef(void 0),d=Ob(()=>{u.current&&(u.current(),u.current=void 0)},100);return p.useEffect(()=>{const h=i.viewport;if(h){const f=()=>{if(d(),!u.current){const m=obe(h,l);u.current=m,l()}};return l(),h.addEventListener("scroll",f),()=>h.removeEventListener("scroll",f)}},[i.viewport,d,l]),a.jsx(Wt.div,{"data-state":o.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:gt(t.onPointerDownCapture,h=>{const m=h.target.getBoundingClientRect(),g=h.clientX-m.left,x=h.clientY-m.top;o.onThumbPointerDown({x:g,y:x})}),onPointerUp:gt(t.onPointerUp,o.onThumbPointerUp)})});C8.displayName=qw;var WP="ScrollAreaCorner",E8=p.forwardRef((t,e)=>{const n=bo(WP,t.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?a.jsx(sbe,{...t,ref:e}):null});E8.displayName=WP;var sbe=p.forwardRef((t,e)=>{const{__scopeScrollArea:n,...r}=t,s=bo(WP,n),[i,o]=p.useState(0),[l,c]=p.useState(0),u=!!(i&&l);return bf(s.scrollbarX,()=>{var h;const d=((h=s.scrollbarX)==null?void 0:h.offsetHeight)||0;s.onCornerHeightChange(d),c(d)}),bf(s.scrollbarY,()=>{var h;const d=((h=s.scrollbarY)==null?void 0:h.offsetWidth)||0;s.onCornerWidthChange(d),o(d)}),u?a.jsx(Wt.div,{...r,ref:e,style:{width:i,height:l,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function Kw(t){return t?parseInt(t,10):0}function T8(t,e){const n=t/e;return isNaN(n)?0:n}function Fb(t){const e=T8(t.viewport,t.content),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,r=(t.scrollbar.size-n)*e;return Math.max(r,18)}function ibe(t,e,n,r="ltr"){const s=Fb(n),i=s/2,o=e||i,l=s-o,c=n.scrollbar.paddingStart+o,u=n.scrollbar.size-n.scrollbar.paddingEnd-l,d=n.content-n.viewport,h=r==="ltr"?[0,d]:[d*-1,0];return I8([c,u],h)(t)}function cL(t,e,n="ltr"){const r=Fb(e),s=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,i=e.scrollbar.size-s,o=e.content-e.viewport,l=i-r,c=n==="ltr"?[0,o]:[o*-1,0],u=Y0e(t,c);return I8([0,o],[0,l])(u)}function I8(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function N8(t,e){return t>0&&t<e}var obe=(t,e=()=>{})=>{let n={left:t.scrollLeft,top:t.scrollTop},r=0;return function s(){const i={left:t.scrollLeft,top:t.scrollTop},o=n.left!==i.left,l=n.top!==i.top;(o||l)&&e(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function Ob(t,e){const n=Br(t),r=p.useRef(0);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),p.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,e)},[n,e])}function bf(t,e){const n=Br(e);Ca(()=>{let r=0;if(t){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(t),()=>{window.cancelAnimationFrame(r),s.unobserve(t)}}},[t,n])}var P8=x8,abe=w8,lbe=E8;const ws=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(P8,{ref:r,className:bt("relative overflow-hidden",t),...n,children:[a.jsx(abe,{className:"h-full w-full rounded-[inherit]",children:e}),a.jsx(HP,{}),a.jsx(lbe,{})]}));ws.displayName=P8.displayName;const HP=ht.forwardRef(({className:t,orientation:e="vertical",...n},r)=>a.jsx(zP,{ref:r,orientation:e,className:bt("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...n,children:a.jsx(C8,{className:"relative flex-1 rounded-full bg-border"})}));HP.displayName=zP.displayName;const $T="RFC3986",VT={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},cbe="RFC1738",ube=Array.isArray,ta=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),US=1024,dbe=(t,e,n,r,s)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(l){return"%26%23"+parseInt(l.slice(2),16)+"%3B"});let o="";for(let l=0;l<i.length;l+=US){const c=i.length>=US?i.slice(l,l+US):i,u=[];for(let d=0;d<c.length;++d){let h=c.charCodeAt(d);if(h===45||h===46||h===95||h===126||h>=48&&h<=57||h>=65&&h<=90||h>=97&&h<=122||s===cbe&&(h===40||h===41)){u[u.length]=c.charAt(d);continue}if(h<128){u[u.length]=ta[h];continue}if(h<2048){u[u.length]=ta[192|h>>6]+ta[128|h&63];continue}if(h<55296||h>=57344){u[u.length]=ta[224|h>>12]+ta[128|h>>6&63]+ta[128|h&63];continue}d+=1,h=65536+((h&1023)<<10|c.charCodeAt(d)&1023),u[u.length]=ta[240|h>>18]+ta[128|h>>12&63]+ta[128|h>>6&63]+ta[128|h&63]}o+=u.join("")}return o};function hbe(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function uL(t,e){if(ube(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const fbe=Object.prototype.hasOwnProperty,A8={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},ia=Array.isArray,mbe=Array.prototype.push,k8=function(t,e){mbe.apply(t,ia(e)?e:[e])},pbe=Date.prototype.toISOString,Kr={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:dbe,encodeValuesOnly:!1,format:$T,formatter:VT[$T],indices:!1,serializeDate(t){return pbe.call(t)},skipNulls:!1,strictNullHandling:!1};function gbe(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const BS={};function R8(t,e,n,r,s,i,o,l,c,u,d,h,f,m,g,x,w,v){let _=t,C=v,T=0,R=!1;for(;(C=C.get(BS))!==void 0&&!R;){const A=C.get(t);if(T+=1,typeof A<"u"){if(A===T)throw new RangeError("Cyclic object value");R=!0}typeof C.get(BS)>"u"&&(T=0)}if(typeof u=="function"?_=u(e,_):_ instanceof Date?_=f==null?void 0:f(_):n==="comma"&&ia(_)&&(_=uL(_,function(A){return A instanceof Date?f==null?void 0:f(A):A})),_===null){if(i)return c&&!x?c(e,Kr.encoder,w,"key",m):e;_=""}if(gbe(_)||hbe(_)){if(c){const A=x?e:c(e,Kr.encoder,w,"key",m);return[(g==null?void 0:g(A))+"="+(g==null?void 0:g(c(_,Kr.encoder,w,"value",m)))]}return[(g==null?void 0:g(e))+"="+(g==null?void 0:g(String(_)))]}const k=[];if(typeof _>"u")return k;let E;if(n==="comma"&&ia(_))x&&c&&(_=uL(_,c)),E=[{value:_.length>0?_.join(",")||null:void 0}];else if(ia(u))E=u;else{const A=Object.keys(_);E=d?A.sort(d):A}const I=l?String(e).replace(/\./g,"%2E"):String(e),P=r&&ia(_)&&_.length===1?I+"[]":I;if(s&&ia(_)&&_.length===0)return P+"[]";for(let A=0;A<E.length;++A){const D=E[A],j=typeof D=="object"&&typeof D.value<"u"?D.value:_[D];if(o&&j===null)continue;const M=h&&l?D.replace(/\./g,"%2E"):D,z=ia(_)?typeof n=="function"?n(P,M):P:P+(h?"."+M:"["+M+"]");v.set(t,T);const U=new WeakMap;U.set(BS,v),k8(k,R8(j,z,n,r,s,i,o,l,n==="comma"&&x&&ia(_)?null:c,u,d,h,f,m,g,x,w,U))}return k}function ybe(t=Kr){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||Kr.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=$T;if(typeof t.format<"u"){if(!fbe.call(VT,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=VT[n];let s=Kr.filter;(typeof t.filter=="function"||ia(t.filter))&&(s=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in A8?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=Kr.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const o=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:Kr.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:Kr.addQueryPrefix,allowDots:o,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:Kr.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:Kr.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?Kr.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:Kr.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:Kr.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:Kr.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:Kr.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:Kr.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:Kr.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:Kr.strictNullHandling}}function xbe(t,e={}){let n=t;const r=ybe(e);let s,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):ia(r.filter)&&(i=r.filter,s=i);const o=[];if(typeof n!="object"||n===null)return"";const l=A8[r.arrayFormat],c=l==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const u=new WeakMap;for(let f=0;f<s.length;++f){const m=s[f];r.skipNulls&&n[m]===null||k8(o,R8(n[m],m,l,c,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,u))}const d=o.join(r.delimiter);let h=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?h+="utf8=%26%2310003%3B&":h+="utf8=%E2%9C%93&"),d.length>0?h+d:""}const eh="4.103.0";let dL=!1,vp,j8,D8,UT,M8,L8,F8,O8,$8;function vbe(t,e={auto:!1}){if(dL)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(vp)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${vp}'\``);dL=e.auto,vp=t.kind,j8=t.fetch,t.Request,t.Response,t.Headers,D8=t.FormData,t.Blob,UT=t.File,M8=t.ReadableStream,L8=t.getMultipartRequestOptions,F8=t.getDefaultAgent,O8=t.fileFromPath,$8=t.isFsReadStream}class wbe{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function bbe({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import … from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(o){throw new Error(`this environment is missing the following Web Fetch API type: ${o.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(o,l)=>({...l,body:new wbe(o)}),getDefaultAgent:o=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:o=>!1}}const V8=()=>{vp||vbe(bbe(),{auto:!0})};V8();class Ot extends Error{}class bs extends Ot{constructor(e,n,r,s){super(`${bs.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s==null?void 0:s["x-request-id"],this.error=n;const i=n;this.code=i==null?void 0:i.code,this.param=i==null?void 0:i.param,this.type=i==null?void 0:i.type}static makeMessage(e,n,r){const s=n!=null&&n.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new $b({message:r,cause:zT(n)});const i=n==null?void 0:n.error;return e===400?new U8(e,i,r,s):e===401?new B8(e,i,r,s):e===403?new z8(e,i,r,s):e===404?new G8(e,i,r,s):e===409?new W8(e,i,r,s):e===422?new H8(e,i,r,s):e===429?new q8(e,i,r,s):e>=500?new K8(e,i,r,s):new bs(e,i,r,s)}}class ho extends bs{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class $b extends bs{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class qP extends $b{constructor({message:e}={}){super({message:e??"Request timed out."})}}class U8 extends bs{}class B8 extends bs{}class z8 extends bs{}class G8 extends bs{}class W8 extends bs{}class H8 extends bs{}class q8 extends bs{}class K8 extends bs{}class Y8 extends Ot{constructor(){super("Could not parse response content as the length limit was reached")}}class J8 extends Ot{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}var dx=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},au=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ji;class Vb{constructor(){ji.set(this,void 0),this.buffer=new Uint8Array,dx(this,ji,null,"f")}decode(e){if(e==null)return[];const n=e instanceof ArrayBuffer?new Uint8Array(e):typeof e=="string"?new TextEncoder().encode(e):e;let r=new Uint8Array(this.buffer.length+n.length);r.set(this.buffer),r.set(n,this.buffer.length),this.buffer=r;const s=[];let i;for(;(i=_be(this.buffer,au(this,ji,"f")))!=null;){if(i.carriage&&au(this,ji,"f")==null){dx(this,ji,i.index,"f");continue}if(au(this,ji,"f")!=null&&(i.index!==au(this,ji,"f")+1||i.carriage)){s.push(this.decodeText(this.buffer.slice(0,au(this,ji,"f")-1))),this.buffer=this.buffer.slice(au(this,ji,"f")),dx(this,ji,null,"f");continue}const o=au(this,ji,"f")!==null?i.preceding-1:i.preceding,l=this.decodeText(this.buffer.slice(0,o));s.push(l),this.buffer=this.buffer.slice(i.index),dx(this,ji,null,"f")}return s}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new Ot(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new Ot(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new Ot("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){return this.buffer.length?this.decode(`
`):[]}}ji=new WeakMap;Vb.NEWLINE_CHARS=new Set([`
`,"\r"]);Vb.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function _be(t,e){for(let s=e??0;s<t.length;s++){if(t[s]===10)return{preceding:s,index:s+1,carriage:!1};if(t[s]===13)return{preceding:s,index:s+1,carriage:!0}}return null}function Sbe(t){for(let r=0;r<t.length-1;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}function X8(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n!=null&&n.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class fa{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const o of Cbe(e,n))if(!i){if(o.data.startsWith("[DONE]")){i=!0;continue}if(o.event===null||o.event.startsWith("response.")||o.event.startsWith("transcript.")){let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(l&&l.error)throw new bs(void 0,l.error,void 0,sG(e.headers));yield l}else{let l;try{l=JSON.parse(o.data)}catch(c){throw console.error("Could not parse message into JSON:",o.data),console.error("From chunk:",o.raw),c}if(o.event=="error")throw new bs(void 0,l.error,l.message,void 0);yield{event:o.event,data:l}}}i=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{i||n.abort()}}return new fa(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const o=new Vb,l=X8(e);for await(const c of l)for(const u of o.decode(c))yield u;for(const c of o.flush())yield c}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let o=!1;try{for await(const l of s())o||l&&(yield JSON.parse(l));o=!0}catch(l){if(l instanceof Error&&l.name==="AbortError")return;throw l}finally{o||n.abort()}}return new fa(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const o=r.next();e.push(o),n.push(o)}return i.shift()}});return[new fa(()=>s(e),this.controller),new fa(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new M8({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:o}=await n.next();if(o)return s.close();const l=r.encode(JSON.stringify(i)+`
`);s.enqueue(l)}catch(i){s.error(i)}},async cancel(){var s;await((s=n.return)==null?void 0:s.call(n))}})}}async function*Cbe(t,e){if(!t.body)throw e.abort(),new Ot("Attempted to iterate over a response with no body");const n=new Tbe,r=new Vb,s=X8(t.body);for await(const i of Ebe(s))for(const o of r.decode(i)){const l=n.decode(o);l&&(yield l)}for(const i of r.flush()){const o=n.decode(i);o&&(yield o)}}async function*Ebe(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=Sbe(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}class Tbe{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=Ibe(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function Ibe(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}const Q8=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",Z8=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&Ub(t),Ub=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",Nbe=t=>Z8(t)||Q8(t)||$8(t);async function eG(t,e,n){var s;if(t=await t,Z8(t))return t;if(Q8(t)){const i=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const o=Ub(i)?[await i.arrayBuffer()]:[i];return new UT(o,e,n)}const r=await Pbe(t);if(e||(e=kbe(t)??"unknown_file"),!(n!=null&&n.type)){const i=(s=r[0])==null?void 0:s.type;typeof i=="string"&&(n={...n,type:i})}return new UT(r,e,n)}async function Pbe(t){var n;let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(Ub(t))e.push(await t.arrayBuffer());else if(Rbe(t))for await(const r of t)e.push(r);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${(n=t==null?void 0:t.constructor)==null?void 0:n.name}; props: ${Abe(t)}`);return e}function Abe(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function kbe(t){var e;return zS(t.name)||zS(t.filename)||((e=zS(t.path))==null?void 0:e.split(/[\\/]/).pop())}const zS=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},Rbe=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",hL=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",cd=async t=>{const e=await jbe(t.body);return L8(e,t)},jbe=async t=>{const e=new D8;return await Promise.all(Object.entries(t||{}).map(([n,r])=>BT(e,n,r))),e},BT=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(Nbe(n)){const r=await eG(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>BT(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>BT(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var Dbe=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},Mbe=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},hx;V8();async function tG(t){var o;const{response:e}=t;if(t.options.stream)return yc("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):fa.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type"),r=(o=n==null?void 0:n.split(";")[0])==null?void 0:o.trim();if((r==null?void 0:r.includes("application/json"))||(r==null?void 0:r.endsWith("+json"))){const l=await e.json();return yc("response",e.status,e.url,e.headers,l),nG(l,e)}const i=await e.text();return yc("response",e.status,e.url,e.headers,i),i}function nG(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class Bb extends Promise{constructor(e,n=tG){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new Bb(this.responsePromise,async n=>nG(e(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class Lbe{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=GS("maxRetries",n),this.timeout=GS("timeout",r),this.httpAgent=s,this.fetch=i??j8}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...Ube(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${Wbe()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&Ub(s==null?void 0:s.body)?new DataView(await s.body.arrayBuffer()):(s==null?void 0:s.body)instanceof DataView?s.body:(s==null?void 0:s.body)instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s==null?void 0:s.body)?new DataView(s.body.buffer):s==null?void 0:s.body;return{method:e,path:n,...s,body:i}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:n=0}={}){var x;const r={...e},{method:s,path:i,query:o,headers:l={}}=r,c=ArrayBuffer.isView(r.body)||r.__binaryRequest&&typeof r.body=="string"?r.body:hL(r.body)?r.body.body:r.body?JSON.stringify(r.body,null,2):null,u=this.calculateContentLength(c),d=this.buildURL(i,o);"timeout"in r&&GS("timeout",r.timeout),r.timeout=r.timeout??this.timeout;const h=r.httpAgent??this.httpAgent??F8(d),f=r.timeout+1e3;typeof((x=h==null?void 0:h.options)==null?void 0:x.timeout)=="number"&&f>(h.options.timeout??0)&&(h.options.timeout=f),this.idempotencyHeader&&s!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),l[this.idempotencyHeader]=e.idempotencyKey);const m=this.buildHeaders({options:r,headers:l,contentLength:u,retryCount:n});return{req:{method:s,...c&&{body:c},headers:m,...h&&{agent:h},signal:r.signal??null},url:d,timeout:r.timeout}}buildHeaders({options:e,headers:n,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const o=this.defaultHeaders(e);return gL(i,o),gL(i,n),hL(e.body)&&vp!=="node"&&delete i["content-type"],mx(o,"x-stainless-retry-count")===void 0&&mx(n,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),mx(o,"x-stainless-timeout")===void 0&&mx(n,"x-stainless-timeout")===void 0&&e.timeout&&(i["x-stainless-timeout"]=String(Math.trunc(e.timeout/1e3))),this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return bs.generate(e,n,r,s)}request(e,n=null){return new Bb(this.makeRequest(e,n))}async makeRequest(e,n){var h,f;const r=await e,s=r.maxRetries??this.maxRetries;n==null&&(n=s),await this.prepareOptions(r);const{req:i,url:o,timeout:l}=this.buildRequest(r,{retryCount:s-n});if(await this.prepareRequest(i,{url:o,options:r}),yc("request",o,r,i.headers),(h=r.signal)!=null&&h.aborted)throw new ho;const c=new AbortController,u=await this.fetchWithTimeout(o,i,l,c).catch(zT);if(u instanceof Error){if((f=r.signal)!=null&&f.aborted)throw new ho;if(n)return this.retryRequest(r,n);throw u.name==="AbortError"?new qP:new $b({cause:u})}const d=sG(u.headers);if(!u.ok){if(n&&this.shouldRetry(u)){const _=`retrying, ${n} attempts remaining`;return yc(`response (error; ${_})`,u.status,o,d),this.retryRequest(r,n,d)}const m=await u.text().catch(_=>zT(_).message),g=Bbe(m),x=g?void 0:m;throw yc(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,u.status,o,d,x),this.makeStatusError(u.status,g,x,d)}return{response:u,options:r,controller:c}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new Fbe(this,r,e)}buildURL(e,n){const r=Gbe(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return iG(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new Ot(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...o}=n||{};i&&i.addEventListener("abort",()=>s.abort());const l=setTimeout(()=>s.abort(),r),c={signal:s.signal,...o};return c.method&&(c.method=c.method.toUpperCase()),this.fetch.call(void 0,e,c).finally(()=>{clearTimeout(l)})}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r==null?void 0:r["retry-after-ms"];if(i){const l=parseFloat(i);Number.isNaN(l)||(s=l)}const o=r==null?void 0:r["retry-after"];if(o&&!s){const l=parseFloat(o);Number.isNaN(l)?s=Date.parse(o)-Date.now():s=l*1e3}if(!(s&&0<=s&&s<60*1e3)){const l=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,l)}return await ny(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,o=Math.min(.5*Math.pow(2,i),8),l=1-Math.random()*.25;return o*l*1e3}getUserAgent(){return`${this.constructor.name}/JS ${eh}`}}class rG{constructor(e,n,r,s){hx.set(this,void 0),Dbe(this,hx,e,"f"),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new Ot("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await Mbe(this,hx,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(hx=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class Fbe extends Bb{constructor(e,n,r){super(n,async s=>new r(e,s.response,await tG(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const sG=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),Obe={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__metadata:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},dr=t=>typeof t=="object"&&t!==null&&!iG(t)&&Object.keys(t).every(e=>oG(Obe,e)),$be=()=>{var e;if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eh,"X-Stainless-OS":mL(Deno.build.os),"X-Stainless-Arch":fL(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:((e=Deno.version)==null?void 0:e.deno)??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eh,"X-Stainless-OS":mL(process.platform),"X-Stainless-Arch":fL(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=Vbe();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":eh,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function Vbe(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,o=r[3]||0;return{browser:e,version:`${s}.${i}.${o}`}}}return null}const fL=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",mL=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let pL;const Ube=()=>pL??(pL=$be()),Bbe=t=>{try{return JSON.parse(t)}catch{return}},zbe=/^[a-z][a-z0-9+.-]*:/i,Gbe=t=>zbe.test(t),ny=t=>new Promise(e=>setTimeout(e,t)),GS=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new Ot(`${t} must be an integer`);if(e<0)throw new Ot(`${t} must be a positive integer`);return e},zT=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},fx=t=>{var e,n,r,s,i;if(typeof process<"u")return((n=(e=process.env)==null?void 0:e[t])==null?void 0:n.trim())??void 0;if(typeof Deno<"u")return(i=(s=(r=Deno.env)==null?void 0:r.get)==null?void 0:s.call(r,t))==null?void 0:i.trim()};function iG(t){if(!t)return!0;for(const e in t)return!1;return!0}function oG(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function gL(t,e){for(const n in e){if(!oG(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}const yL=new Set(["authorization","api-key"]);function yc(t,...e){var n;if(typeof process<"u"&&((n=process==null?void 0:process.env)==null?void 0:n.DEBUG)==="true"){const r=e.map(s=>{if(!s)return s;if(s.headers){const o={...s,headers:{...s.headers}};for(const l in s.headers)yL.has(l.toLowerCase())&&(o.headers[l]="REDACTED");return o}let i=null;for(const o in s)yL.has(o.toLowerCase())&&(i??(i={...s}),i[o]="REDACTED");return i??s});console.log(`OpenAI:DEBUG:${t}`,...r)}}const Wbe=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),Hbe=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",qbe=t=>typeof(t==null?void 0:t.get)=="function",mx=(t,e)=>{var r;const n=e.toLowerCase();if(qbe(t)){const s=((r=e[0])==null?void 0:r.toUpperCase())+e.substring(1).replace(/([^\w])(\w)/g,(i,o,l)=>o+l.toUpperCase());for(const i of[e,n,e.toUpperCase(),s]){const o=t.get(i);if(o)return o}}for(const[s,i]of Object.entries(t))if(s.toLowerCase()===n)return Array.isArray(i)?(i.length<=1||console.warn(`Received ${i.length} entries for the ${e} header, using the first entry.`),i[0]):i},Kbe=t=>{if(typeof Buffer<"u"){const e=Buffer.from(t,"base64");return Array.from(new Float32Array(e.buffer,e.byteOffset,e.length/Float32Array.BYTES_PER_ELEMENT))}else{const e=atob(t),n=e.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=e.charCodeAt(s);return Array.from(new Float32Array(r.buffer))}};function WS(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class zb extends rG{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class Zr extends rG{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.has_more=r.has_more||!1}getPaginatedItems(){return this.data??[]}hasNextPage(){return this.has_more===!1?!1:super.hasNextPage()}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){var r;const e=this.getPaginatedItems();if(!e.length)return null;const n=(r=e[e.length-1])==null?void 0:r.id;return n?{params:{after:n}}:null}}class Ut{constructor(e){this._client=e}}let aG=class extends Ut{list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/chat/completions/${e}/messages`,Ybe,{query:n,...r})}},Gb=class extends Ut{constructor(){super(...arguments),this.messages=new aG(this._client)}create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}retrieve(e,n){return this._client.get(`/chat/completions/${e}`,n)}update(e,n,r){return this._client.post(`/chat/completions/${e}`,{body:n,...r})}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/chat/completions",Wb,{query:e,...n})}del(e,n){return this._client.delete(`/chat/completions/${e}`,n)}};class Wb extends Zr{}class Ybe extends Zr{}Gb.ChatCompletionsPage=Wb;Gb.Messages=aG;let Hb=class extends Ut{constructor(){super(...arguments),this.completions=new Gb(this._client)}};Hb.Completions=Gb;Hb.ChatCompletionsPage=Wb;class lG extends Ut{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:{Accept:"application/octet-stream",...n==null?void 0:n.headers},__binaryResponse:!0})}}class cG extends Ut{create(e,n){return this._client.post("/audio/transcriptions",cd({body:e,...n,stream:e.stream??!1,__metadata:{model:e.model}}))}}class uG extends Ut{create(e,n){return this._client.post("/audio/translations",cd({body:e,...n,__metadata:{model:e.model}}))}}class ry extends Ut{constructor(){super(...arguments),this.transcriptions=new cG(this._client),this.translations=new uG(this._client),this.speech=new lG(this._client)}}ry.Transcriptions=cG;ry.Translations=uG;ry.Speech=lG;class KP extends Ut{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/batches",YP,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class YP extends Zr{}KP.BatchesPage=YP;var Io=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},fr=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},GT,fv,mv,Mm,Lm,pv,Fm,Ma,Om,Yw,Jw,th,dG;class JP{constructor(){GT.add(this),this.controller=new AbortController,fv.set(this,void 0),mv.set(this,()=>{}),Mm.set(this,()=>{}),Lm.set(this,void 0),pv.set(this,()=>{}),Fm.set(this,()=>{}),Ma.set(this,{}),Om.set(this,!1),Yw.set(this,!1),Jw.set(this,!1),th.set(this,!1),Io(this,fv,new Promise((e,n)=>{Io(this,mv,e,"f"),Io(this,Mm,n,"f")}),"f"),Io(this,Lm,new Promise((e,n)=>{Io(this,pv,e,"f"),Io(this,Fm,n,"f")}),"f"),fr(this,fv,"f").catch(()=>{}),fr(this,Lm,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},fr(this,GT,"m",dG).bind(this))},0)}_connected(){this.ended||(fr(this,mv,"f").call(this),this._emit("connect"))}get ended(){return fr(this,Om,"f")}get errored(){return fr(this,Yw,"f")}get aborted(){return fr(this,Jw,"f")}abort(){this.controller.abort()}on(e,n){return(fr(this,Ma,"f")[e]||(fr(this,Ma,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=fr(this,Ma,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(fr(this,Ma,"f")[e]||(fr(this,Ma,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{Io(this,th,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){Io(this,th,!0,"f"),await fr(this,Lm,"f")}_emit(e,...n){if(fr(this,Om,"f"))return;e==="end"&&(Io(this,Om,!0,"f"),fr(this,pv,"f").call(this));const r=fr(this,Ma,"f")[e];if(r&&(fr(this,Ma,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!fr(this,th,"f")&&!(r!=null&&r.length)&&Promise.reject(s),fr(this,Mm,"f").call(this,s),fr(this,Fm,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!fr(this,th,"f")&&!(r!=null&&r.length)&&Promise.reject(s),fr(this,Mm,"f").call(this,s),fr(this,Fm,"f").call(this,s),this._emit("end")}}_emitFinal(){}}fv=new WeakMap,mv=new WeakMap,Mm=new WeakMap,Lm=new WeakMap,pv=new WeakMap,Fm=new WeakMap,Ma=new WeakMap,Om=new WeakMap,Yw=new WeakMap,Jw=new WeakMap,th=new WeakMap,GT=new WeakSet,dG=function(e){if(Io(this,Yw,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new ho),e instanceof ho)return Io(this,Jw,!0,"f"),this._emit("abort",e);if(e instanceof Ot)return this._emit("error",e);if(e instanceof Error){const n=new Ot(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new Ot(String(e)))};var Et=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},Ai=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},ps,WT,oa,gv,Po,Du,Sh,_u,Xw,Mi,yv,xv,wp,$m,Vm,xL,vL,wL,bL,_L,SL,CL;class Fo extends JP{constructor(){super(...arguments),ps.add(this),WT.set(this,[]),oa.set(this,{}),gv.set(this,{}),Po.set(this,void 0),Du.set(this,void 0),Sh.set(this,void 0),_u.set(this,void 0),Xw.set(this,void 0),Mi.set(this,void 0),yv.set(this,void 0),xv.set(this,void 0),wp.set(this,void 0)}[(WT=new WeakMap,oa=new WeakMap,gv=new WeakMap,Po=new WeakMap,Du=new WeakMap,Sh=new WeakMap,_u=new WeakMap,Xw=new WeakMap,Mi=new WeakMap,yv=new WeakMap,xv=new WeakMap,wp=new WeakMap,ps=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new Fo;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){var i;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=fa.fromReadableStream(e,this.controller);for await(const o of s)Et(this,ps,"m",$m).call(this,o);if((i=s.controller.signal)!=null&&i.aborted)throw new ho;return this._addRun(Et(this,ps,"m",Vm).call(this))}toReadableStream(){return new fa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const o=new Fo;return o._run(()=>o._runToolAssistantStream(e,n,r,s,{...i,headers:{...i==null?void 0:i.headers,"X-Stainless-Helper-Method":"stream"}})),o}async _createToolAssistantStream(e,n,r,s,i){var u;const o=i==null?void 0:i.signal;o&&(o.aborted&&this.controller.abort(),o.addEventListener("abort",()=>this.controller.abort()));const l={...s,stream:!0},c=await e.submitToolOutputs(n,r,l,{...i,signal:this.controller.signal});this._connected();for await(const d of c)Et(this,ps,"m",$m).call(this,d);if((u=c.controller.signal)!=null&&u.aborted)throw new ho;return this._addRun(Et(this,ps,"m",Vm).call(this))}static createThreadAssistantStream(e,n,r){const s=new Fo;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new Fo;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s==null?void 0:s.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return Et(this,yv,"f")}currentRun(){return Et(this,xv,"f")}currentMessageSnapshot(){return Et(this,Po,"f")}currentRunStepSnapshot(){return Et(this,wp,"f")}async finalRunSteps(){return await this.done(),Object.values(Et(this,oa,"f"))}async finalMessages(){return await this.done(),Object.values(Et(this,gv,"f"))}async finalRun(){if(await this.done(),!Et(this,Du,"f"))throw Error("Final run was not received.");return Et(this,Du,"f")}async _createThreadAssistantStream(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},o=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const c of o)Et(this,ps,"m",$m).call(this,c);if((l=o.controller.signal)!=null&&l.aborted)throw new ho;return this._addRun(Et(this,ps,"m",Vm).call(this))}async _createAssistantStream(e,n,r,s){var c;const i=s==null?void 0:s.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const o={...r,stream:!0},l=await e.create(n,o,{...s,signal:this.controller.signal});this._connected();for await(const u of l)Et(this,ps,"m",$m).call(this,u);if((c=l.controller.signal)!=null&&c.aborted)throw new ho;return this._addRun(Et(this,ps,"m",Vm).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(WS(i)&&WS(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(o=>typeof o=="string"||typeof o=="number")){i.push(...s);continue}for(const o of s){if(!WS(o))throw new Error(`Expected array delta entry to be an object but got: ${o}`);const l=o.index;if(l==null)throw console.error(o),new Error("Expected array delta entry to have an `index` property");if(typeof l!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${l}`);const c=i[l];c==null?i.push(o):i[l]=this.accumulateDelta(c,o)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}}$m=function(e){if(!this.ended)switch(Ai(this,yv,e,"f"),Et(this,ps,"m",wL).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.incomplete":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":Et(this,ps,"m",CL).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Et(this,ps,"m",vL).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":Et(this,ps,"m",xL).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},Vm=function(){if(this.ended)throw new Ot("stream has ended, this shouldn't happen");if(!Et(this,Du,"f"))throw Error("Final run has not been received");return Et(this,Du,"f")},xL=function(e){const[n,r]=Et(this,ps,"m",_L).call(this,e,Et(this,Po,"f"));Ai(this,Po,n,"f"),Et(this,gv,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];(i==null?void 0:i.type)=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,o=n.content[s.index];if(o&&o.type=="text")this._emit("textDelta",i,o.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=Et(this,Sh,"f")){if(Et(this,_u,"f"))switch(Et(this,_u,"f").type){case"text":this._emit("textDone",Et(this,_u,"f").text,Et(this,Po,"f"));break;case"image_file":this._emit("imageFileDone",Et(this,_u,"f").image_file,Et(this,Po,"f"));break}Ai(this,Sh,s.index,"f")}Ai(this,_u,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(Et(this,Sh,"f")!==void 0){const s=e.data.content[Et(this,Sh,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,Et(this,Po,"f"));break;case"text":this._emit("textDone",s.text,Et(this,Po,"f"));break}}Et(this,Po,"f")&&this._emit("messageDone",e.data),Ai(this,Po,void 0,"f")}},vL=function(e){const n=Et(this,ps,"m",bL).call(this,e);switch(Ai(this,wp,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==Et(this,Xw,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(Et(this,Mi,"f")&&this._emit("toolCallDone",Et(this,Mi,"f")),Ai(this,Xw,i.index,"f"),Ai(this,Mi,n.step_details.tool_calls[i.index],"f"),Et(this,Mi,"f")&&this._emit("toolCallCreated",Et(this,Mi,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":Ai(this,wp,void 0,"f"),e.data.step_details.type=="tool_calls"&&Et(this,Mi,"f")&&(this._emit("toolCallDone",Et(this,Mi,"f")),Ai(this,Mi,void 0,"f")),this._emit("runStepDone",e.data,n);break}},wL=function(e){Et(this,WT,"f").push(e),this._emit("event",e)},bL=function(e){switch(e.event){case"thread.run.step.created":return Et(this,oa,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=Et(this,oa,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=Fo.accumulateDelta(n,r.delta);Et(this,oa,"f")[e.data.id]=s}return Et(this,oa,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":Et(this,oa,"f")[e.data.id]=e.data;break}if(Et(this,oa,"f")[e.data.id])return Et(this,oa,"f")[e.data.id];throw new Error("No snapshot available")},_L=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let o=n.content[i.index];n.content[i.index]=Et(this,ps,"m",SL).call(this,i,o)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},SL=function(e,n){return Fo.accumulateDelta(n,e)},CL=function(e){switch(Ai(this,xv,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":Ai(this,Du,e.data,"f"),Et(this,Mi,"f")&&(this._emit("toolCallDone",Et(this,Mi,"f")),Ai(this,Mi,void 0,"f"));break}};class XP extends Ut{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/assistants",QP,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class QP extends Zr{}XP.AssistantsPage=QP;function EL(t){return typeof t.parse=="function"}const $h=t=>(t==null?void 0:t.role)==="assistant",hG=t=>(t==null?void 0:t.role)==="function",fG=t=>(t==null?void 0:t.role)==="tool";function ZP(t){return(t==null?void 0:t.$brand)==="auto-parseable-response-format"}function sy(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function Jbe(t,e){return!e||!mG(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,...n.message.tool_calls?{tool_calls:n.message.tool_calls}:void 0}}))}:eA(t,e)}function eA(t,e){const n=t.choices.map(r=>{var s;if(r.finish_reason==="length")throw new Y8;if(r.finish_reason==="content_filter")throw new J8;return{...r,message:{...r.message,...r.message.tool_calls?{tool_calls:((s=r.message.tool_calls)==null?void 0:s.map(i=>Qbe(e,i)))??void 0}:void 0,parsed:r.message.content&&!r.message.refusal?Xbe(e,r.message.content):null}}});return{...t,choices:n}}function Xbe(t,e){var n,r;return((n=t.response_format)==null?void 0:n.type)!=="json_schema"?null:((r=t.response_format)==null?void 0:r.type)==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function Qbe(t,e){var r;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return{...e,function:{...e.function,parsed_arguments:sy(n)?n.$parseRaw(e.function.arguments):n!=null&&n.function.strict?JSON.parse(e.function.arguments):null}}}function Zbe(t,e){var r;if(!t)return!1;const n=(r=t.tools)==null?void 0:r.find(s=>{var i;return((i=s.function)==null?void 0:i.name)===e.function.name});return sy(n)||(n==null?void 0:n.function.strict)||!1}function mG(t){var e;return ZP(t.response_format)?!0:((e=t.tools)==null?void 0:e.some(n=>sy(n)||n.type==="function"&&n.function.strict===!0))??!1}function e_e(t){for(const e of t??[]){if(e.type!=="function")throw new Ot(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new Ot(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var oi=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},As,HT,Qw,qT,KT,YT,pG,JT;const TL=10;class gG extends JP{constructor(){super(...arguments),As.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){var r;this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=(r=e.choices[0])==null?void 0:r.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(hG(e)||fG(e))&&e.content)this._emit("functionCallResult",e.content);else if($h(e)&&e.function_call)this._emit("functionCall",e.function_call);else if($h(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new Ot("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),oi(this,As,"m",HT).call(this)}async finalMessage(){return await this.done(),oi(this,As,"m",Qw).call(this)}async finalFunctionCall(){return await this.done(),oi(this,As,"m",qT).call(this)}async finalFunctionCallResult(){return await this.done(),oi(this,As,"m",KT).call(this)}async totalUsage(){return await this.done(),oi(this,As,"m",YT).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=oi(this,As,"m",Qw).call(this);n&&this._emit("finalMessage",n);const r=oi(this,As,"m",HT).call(this);r&&this._emit("finalContent",r);const s=oi(this,As,"m",qT).call(this);s&&this._emit("finalFunctionCall",s);const i=oi(this,As,"m",KT).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(o=>o.usage)&&this._emit("totalUsage",oi(this,As,"m",YT).call(this))}async _createChatCompletion(e,n,r){const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),oi(this,As,"m",pG).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(eA(i,n))}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){var f;const s="function",{function_call:i="auto",stream:o,...l}=n,c=typeof i!="string"&&(i==null?void 0:i.name),{maxChatCompletions:u=TL}=r||{},d={};for(const m of n.functions)d[m.name||m.function.name]=m;const h=n.functions.map(m=>({name:m.name||m.function.name,parameters:m.parameters,description:m.description}));for(const m of n.messages)this._addMessage(m,!1);for(let m=0;m<u;++m){const x=(f=(await this._createChatCompletion(e,{...l,function_call:i,functions:h,messages:[...this.messages]},r)).choices[0])==null?void 0:f.message;if(!x)throw new Ot("missing message in ChatCompletion response");if(!x.function_call)return;const{name:w,arguments:v}=x.function_call,_=d[w];if(_){if(c&&c!==w){const k=`Invalid function_call: ${JSON.stringify(w)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,name:w,content:k});continue}}else{const k=`Invalid function_call: ${JSON.stringify(w)}. Available options are: ${h.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:w,content:k});continue}let C;try{C=EL(_)?await _.parse(v):v}catch(k){this._addMessage({role:s,name:w,content:k instanceof Error?k.message:String(k)});continue}const T=await _.function(C,this),R=oi(this,As,"m",JT).call(this,T);if(this._addMessage({role:s,name:w,content:R}),c)return}}async _runTools(e,n,r){var m,g,x;const s="tool",{tool_choice:i="auto",stream:o,...l}=n,c=typeof i!="string"&&((m=i==null?void 0:i.function)==null?void 0:m.name),{maxChatCompletions:u=TL}=r||{},d=n.tools.map(w=>{if(sy(w)){if(!w.$callback)throw new Ot("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:w.$callback,name:w.function.name,description:w.function.description||"",parameters:w.function.parameters,parse:w.$parseRaw,strict:!0}}}return w}),h={};for(const w of d)w.type==="function"&&(h[w.function.name||w.function.function.name]=w.function);const f="tools"in n?d.map(w=>w.type==="function"?{type:"function",function:{name:w.function.name||w.function.function.name,parameters:w.function.parameters,description:w.function.description,strict:w.function.strict}}:w):void 0;for(const w of n.messages)this._addMessage(w,!1);for(let w=0;w<u;++w){const _=(g=(await this._createChatCompletion(e,{...l,tool_choice:i,tools:f,messages:[...this.messages]},r)).choices[0])==null?void 0:g.message;if(!_)throw new Ot("missing message in ChatCompletion response");if(!((x=_.tool_calls)!=null&&x.length))return;for(const C of _.tool_calls){if(C.type!=="function")continue;const T=C.id,{name:R,arguments:k}=C.function,E=h[R];if(E){if(c&&c!==R){const D=`Invalid tool_call: ${JSON.stringify(R)}. ${JSON.stringify(c)} requested. Please try again`;this._addMessage({role:s,tool_call_id:T,content:D});continue}}else{const D=`Invalid tool_call: ${JSON.stringify(R)}. Available options are: ${Object.keys(h).map(j=>JSON.stringify(j)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:T,content:D});continue}let I;try{I=EL(E)?await E.parse(k):k}catch(D){const j=D instanceof Error?D.message:String(D);this._addMessage({role:s,tool_call_id:T,content:j});continue}const P=await E.function(I,this),A=oi(this,As,"m",JT).call(this,P);if(this._addMessage({role:s,tool_call_id:T,content:A}),c)return}}}}As=new WeakSet,HT=function(){return oi(this,As,"m",Qw).call(this).content??null},Qw=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if($h(n)){const{function_call:r,...s}=n,i={...s,content:n.content??null,refusal:n.refusal??null};return r&&(i.function_call=r),i}}throw new Ot("stream ended without producing a ChatCompletionMessage with role=assistant")},qT=function(){var e,n;for(let r=this.messages.length-1;r>=0;r--){const s=this.messages[r];if($h(s)&&(s!=null&&s.function_call))return s.function_call;if($h(s)&&((e=s==null?void 0:s.tool_calls)!=null&&e.length))return(n=s.tool_calls.at(-1))==null?void 0:n.function}},KT=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(hG(n)&&n.content!=null||fG(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>{var s;return r.role==="assistant"&&((s=r.tool_calls)==null?void 0:s.some(i=>i.type==="function"&&i.id===n.tool_call_id))}))return n.content}},YT=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},pG=function(e){if(e.n!=null&&e.n>1)throw new Ot("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},JT=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class cg extends gG{static runFunctions(e,n,r){const s=new cg,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new cg,i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e,n=!0){super._addMessage(e,n),$h(e)&&e.content&&this._emit("content",e.content)}}const yG=1,xG=2,vG=4,wG=8,bG=16,_G=32,SG=64,CG=128,EG=256,TG=CG|EG,IG=bG|_G|TG|SG,NG=yG|xG|IG,PG=vG|wG,t_e=NG|PG,ns={STR:yG,NUM:xG,ARR:vG,OBJ:wG,NULL:bG,BOOL:_G,NAN:SG,INFINITY:CG,MINUS_INFINITY:EG,INF:TG,SPECIAL:IG,ATOM:NG,COLLECTION:PG,ALL:t_e};class n_e extends Error{}class r_e extends Error{}function s_e(t,e=ns.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return i_e(t.trim(),e)}const i_e=(t,e)=>{const n=t.length;let r=0;const s=f=>{throw new n_e(`${f} at position ${r}`)},i=f=>{throw new r_e(`${f} at position ${r}`)},o=()=>(h(),r>=n&&s("Unexpected end of input"),t[r]==='"'?l():t[r]==="{"?c():t[r]==="["?u():t.substring(r,r+4)==="null"||ns.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||ns.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||ns.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||ns.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||ns.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||ns.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):d()),l=()=>{const f=r;let m=!1;for(r++;r<n&&(t[r]!=='"'||m&&t[r-1]==="\\");)m=t[r]==="\\"?!m:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(f,++r-Number(m)))}catch(g){i(String(g))}else if(ns.STR&e)try{return JSON.parse(t.substring(f,r-Number(m))+'"')}catch{return JSON.parse(t.substring(f,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},c=()=>{r++,h();const f={};try{for(;t[r]!=="}";){if(h(),r>=n&&ns.OBJ&e)return f;const m=l();h(),r++;try{const g=o();Object.defineProperty(f,m,{value:g,writable:!0,enumerable:!0,configurable:!0})}catch(g){if(ns.OBJ&e)return f;throw g}h(),t[r]===","&&r++}}catch{if(ns.OBJ&e)return f;s("Expected '}' at end of object")}return r++,f},u=()=>{r++;const f=[];try{for(;t[r]!=="]";)f.push(o()),h(),t[r]===","&&r++}catch{if(ns.ARR&e)return f;s("Expected ']' at end of array")}return r++,f},d=()=>{if(r===0){t==="-"&&ns.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(m){if(ns.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(m))}}const f=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(ns.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(f,r))}catch{t.substring(f,r)==="-"&&ns.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(f,t.lastIndexOf("e")))}catch(g){i(String(g))}}},h=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return o()},IL=t=>s_e(t,ns.ALL^ns.NUM);var Vd=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},On=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},qr,Da,Ud,Al,HS,px,qS,KS,YS,gx,JS,NL;class ug extends gG{constructor(e){super(),qr.add(this),Da.set(this,void 0),Ud.set(this,void 0),Al.set(this,void 0),Vd(this,Da,e,"f"),Vd(this,Ud,[],"f")}get currentChatCompletionSnapshot(){return On(this,Al,"f")}static fromReadableStream(e){const n=new ug(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new ug(n);return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){var o;super._createChatCompletion;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),On(this,qr,"m",HS).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const l of i)On(this,qr,"m",qS).call(this,l);if((o=i.controller.signal)!=null&&o.aborted)throw new ho;return this._addChatCompletion(On(this,qr,"m",gx).call(this))}async _fromReadableStream(e,n){var o;const r=n==null?void 0:n.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),On(this,qr,"m",HS).call(this),this._connected();const s=fa.fromReadableStream(e,this.controller);let i;for await(const l of s)i&&i!==l.id&&this._addChatCompletion(On(this,qr,"m",gx).call(this)),On(this,qr,"m",qS).call(this,l),i=l.id;if((o=s.controller.signal)!=null&&o.aborted)throw new ho;return this._addChatCompletion(On(this,qr,"m",gx).call(this))}[(Da=new WeakMap,Ud=new WeakMap,Al=new WeakMap,qr=new WeakSet,HS=function(){this.ended||Vd(this,Al,void 0,"f")},px=function(n){let r=On(this,Ud,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},On(this,Ud,"f")[n.index]=r,r)},qS=function(n){var s,i,o,l,c,u,d,h,f,m,g,x,w,v,_;if(this.ended)return;const r=On(this,qr,"m",NL).call(this,n);this._emit("chunk",n,r);for(const C of n.choices){const T=r.choices[C.index];C.delta.content!=null&&((s=T.message)==null?void 0:s.role)==="assistant"&&((i=T.message)!=null&&i.content)&&(this._emit("content",C.delta.content,T.message.content),this._emit("content.delta",{delta:C.delta.content,snapshot:T.message.content,parsed:T.message.parsed})),C.delta.refusal!=null&&((o=T.message)==null?void 0:o.role)==="assistant"&&((l=T.message)!=null&&l.refusal)&&this._emit("refusal.delta",{delta:C.delta.refusal,snapshot:T.message.refusal}),((c=C.logprobs)==null?void 0:c.content)!=null&&((u=T.message)==null?void 0:u.role)==="assistant"&&this._emit("logprobs.content.delta",{content:(d=C.logprobs)==null?void 0:d.content,snapshot:((h=T.logprobs)==null?void 0:h.content)??[]}),((f=C.logprobs)==null?void 0:f.refusal)!=null&&((m=T.message)==null?void 0:m.role)==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:(g=C.logprobs)==null?void 0:g.refusal,snapshot:((x=T.logprobs)==null?void 0:x.refusal)??[]});const R=On(this,qr,"m",px).call(this,T);T.finish_reason&&(On(this,qr,"m",YS).call(this,T),R.current_tool_call_index!=null&&On(this,qr,"m",KS).call(this,T,R.current_tool_call_index));for(const k of C.delta.tool_calls??[])R.current_tool_call_index!==k.index&&(On(this,qr,"m",YS).call(this,T),R.current_tool_call_index!=null&&On(this,qr,"m",KS).call(this,T,R.current_tool_call_index)),R.current_tool_call_index=k.index;for(const k of C.delta.tool_calls??[]){const E=(w=T.message.tool_calls)==null?void 0:w[k.index];E!=null&&E.type&&((E==null?void 0:E.type)==="function"?this._emit("tool_calls.function.arguments.delta",{name:(v=E.function)==null?void 0:v.name,index:k.index,arguments:E.function.arguments,parsed_arguments:E.function.parsed_arguments,arguments_delta:((_=k.function)==null?void 0:_.arguments)??""}):(E==null||E.type,void 0))}}},KS=function(n,r){var o,l,c;if(On(this,qr,"m",px).call(this,n).done_tool_calls.has(r))return;const i=(o=n.message.tool_calls)==null?void 0:o[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const u=(c=(l=On(this,Da,"f"))==null?void 0:l.tools)==null?void 0:c.find(d=>d.type==="function"&&d.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:sy(u)?u.$parseRaw(i.function.arguments):u!=null&&u.function.strict?JSON.parse(i.function.arguments):null})}else i.type},YS=function(n){var s,i;const r=On(this,qr,"m",px).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const o=On(this,qr,"m",JS).call(this);this._emit("content.done",{content:n.message.content,parsed:o?o.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),(s=n.logprobs)!=null&&s.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),(i=n.logprobs)!=null&&i.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},gx=function(){if(this.ended)throw new Ot("stream has ended, this shouldn't happen");const n=On(this,Al,"f");if(!n)throw new Ot("request ended without sending any chunks");return Vd(this,Al,void 0,"f"),Vd(this,Ud,[],"f"),o_e(n,On(this,Da,"f"))},JS=function(){var r;const n=(r=On(this,Da,"f"))==null?void 0:r.response_format;return ZP(n)?n:null},NL=function(n){var r,s,i,o;let l=On(this,Al,"f");const{choices:c,...u}=n;l?Object.assign(l,u):l=Vd(this,Al,{...u,choices:[]},"f");for(const{delta:d,finish_reason:h,index:f,logprobs:m=null,...g}of n.choices){let x=l.choices[f];if(x||(x=l.choices[f]={finish_reason:h,index:f,message:{},logprobs:m,...g}),m)if(!x.logprobs)x.logprobs=Object.assign({},m);else{const{content:k,refusal:E,...I}=m;Object.assign(x.logprobs,I),k&&((r=x.logprobs).content??(r.content=[]),x.logprobs.content.push(...k)),E&&((s=x.logprobs).refusal??(s.refusal=[]),x.logprobs.refusal.push(...E))}if(h&&(x.finish_reason=h,On(this,Da,"f")&&mG(On(this,Da,"f")))){if(h==="length")throw new Y8;if(h==="content_filter")throw new J8}if(Object.assign(x,g),!d)continue;const{content:w,refusal:v,function_call:_,role:C,tool_calls:T,...R}=d;if(Object.assign(x.message,R),v&&(x.message.refusal=(x.message.refusal||"")+v),C&&(x.message.role=C),_&&(x.message.function_call?(_.name&&(x.message.function_call.name=_.name),_.arguments&&((i=x.message.function_call).arguments??(i.arguments=""),x.message.function_call.arguments+=_.arguments)):x.message.function_call=_),w&&(x.message.content=(x.message.content||"")+w,!x.message.refusal&&On(this,qr,"m",JS).call(this)&&(x.message.parsed=IL(x.message.content))),T){x.message.tool_calls||(x.message.tool_calls=[]);for(const{index:k,id:E,type:I,function:P,...A}of T){const D=(o=x.message.tool_calls)[k]??(o[k]={});Object.assign(D,A),E&&(D.id=E),I&&(D.type=I),P&&(D.function??(D.function={name:P.name??"",arguments:""})),P!=null&&P.name&&(D.function.name=P.name),P!=null&&P.arguments&&(D.function.arguments+=P.arguments,Zbe(On(this,Da,"f"),D)&&(D.function.parsed_arguments=IL(D.function.arguments)))}}}return l},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new fa(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function o_e(t,e){const{id:n,choices:r,created:s,model:i,system_fingerprint:o,...l}=t,c={...l,id:n,choices:r.map(({message:u,finish_reason:d,index:h,logprobs:f,...m})=>{if(!d)throw new Ot(`missing finish_reason for choice ${h}`);const{content:g=null,function_call:x,tool_calls:w,...v}=u,_=u.role;if(!_)throw new Ot(`missing role for choice ${h}`);if(x){const{arguments:C,name:T}=x;if(C==null)throw new Ot(`missing function_call.arguments for choice ${h}`);if(!T)throw new Ot(`missing function_call.name for choice ${h}`);return{...m,message:{content:g,function_call:{arguments:C,name:T},role:_,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}return w?{...m,index:h,finish_reason:d,logprobs:f,message:{...v,role:_,content:g,refusal:u.refusal??null,tool_calls:w.map((C,T)=>{const{function:R,type:k,id:E,...I}=C,{arguments:P,name:A,...D}=R||{};if(E==null)throw new Ot(`missing choices[${h}].tool_calls[${T}].id
${yx(t)}`);if(k==null)throw new Ot(`missing choices[${h}].tool_calls[${T}].type
${yx(t)}`);if(A==null)throw new Ot(`missing choices[${h}].tool_calls[${T}].function.name
${yx(t)}`);if(P==null)throw new Ot(`missing choices[${h}].tool_calls[${T}].function.arguments
${yx(t)}`);return{...I,id:E,type:k,function:{...D,name:A,arguments:P}}})}}:{...m,message:{...v,content:g,role:_,refusal:u.refusal??null},finish_reason:d,index:h,logprobs:f}}),created:s,model:i,object:"chat.completion",...o?{system_fingerprint:o}:{}};return Jbe(c,e)}function yx(t){return JSON.stringify(t)}class Vh extends ug{static fromReadableStream(e){const n=new Vh(null);return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new Vh(null),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Vh(n),i={...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let AG=class extends Ut{parse(e,n){return e_e(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n==null?void 0:n.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>eA(r,e))}runFunctions(e,n){return e.stream?Vh.runFunctions(this._client,e,n):cg.runFunctions(this._client,e,n)}runTools(e,n){return e.stream?Vh.runTools(this._client,e,n):cg.runTools(this._client,e,n)}stream(e,n){return ug.createChatCompletion(this._client,e,n)}};class XT extends Ut{constructor(){super(...arguments),this.completions=new AG(this._client)}}(function(t){t.Completions=AG})(XT||(XT={}));class kG extends Ut{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class RG extends Ut{create(e,n){return this._client.post("/realtime/transcription_sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}}class qb extends Ut{constructor(){super(...arguments),this.sessions=new kG(this._client),this.transcriptionSessions=new RG(this._client)}}qb.Sessions=kG;qb.TranscriptionSessions=RG;class tA extends Ut{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,nA,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class nA extends Zr{}tA.MessagesPage=nA;class rA extends Ut{retrieve(e,n,r,s={},i){return dr(s)?this.retrieve(e,n,r,{},s):this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i==null?void 0:i.headers}})}list(e,n,r={},s){return dr(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,sA,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}}class sA extends Zr{}rA.RunStepsPage=sA;let iy=class extends Ut{constructor(){super(...arguments),this.steps=new rA(this._client)}create(e,n,r){const{include:s,...i}=n;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,iA,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return Fo.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:{...r==null?void 0:r.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await ny(l);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return Fo.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return Fo.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}};class iA extends Zr{}iy.RunsPage=iA;iy.Steps=rA;iy.RunStepsPage=sA;class Ff extends Ut{constructor(){super(...arguments),this.runs=new iy(this._client),this.messages=new tA(this._client)}create(e={},n){return dr(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return Fo.createThreadAssistantStream(e,this._client.beta.threads,n)}}Ff.Runs=iy;Ff.RunsPage=iA;Ff.Messages=tA;Ff.MessagesPage=nA;class Of extends Ut{constructor(){super(...arguments),this.realtime=new qb(this._client),this.chat=new XT(this._client),this.assistants=new XP(this._client),this.threads=new Ff(this._client)}}Of.Realtime=qb;Of.Assistants=XP;Of.AssistantsPage=QP;Of.Threads=Ff;class jG extends Ut{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let DG=class extends Ut{retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}/content`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}},Kb=class extends Ut{constructor(){super(...arguments),this.content=new DG(this._client)}create(e,n,r){return this._client.post(`/containers/${e}/files`,cd({body:n,...r}))}retrieve(e,n,r){return this._client.get(`/containers/${e}/files/${n}`,r)}list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/containers/${e}/files`,oA,{query:n,...r})}del(e,n,r){return this._client.delete(`/containers/${e}/files/${n}`,{...r,headers:{Accept:"*/*",...r==null?void 0:r.headers}})}};class oA extends Zr{}Kb.FileListResponsesPage=oA;Kb.Content=DG;class oy extends Ut{constructor(){super(...arguments),this.files=new Kb(this._client)}create(e,n){return this._client.post("/containers",{body:e,...n})}retrieve(e,n){return this._client.get(`/containers/${e}`,n)}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/containers",aA,{query:e,...n})}del(e,n){return this._client.delete(`/containers/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class aA extends Zr{}oy.ContainerListResponsesPage=aA;oy.Files=Kb;oy.FileListResponsesPage=oA;class MG extends Ut{create(e,n){const r=!!e.encoding_format;let s=r?e.encoding_format:"base64";r&&yc("Request","User defined encoding_format:",e.encoding_format);const i=this._client.post("/embeddings",{body:{...e,encoding_format:s},...n});return r?i:(yc("response","Decoding base64 embeddings to float32 array"),i._thenUnwrap(o=>(o&&o.data&&o.data.forEach(l=>{const c=l.embedding;l.embedding=Kbe(c)}),o)))}}class lA extends Ut{retrieve(e,n,r,s){return this._client.get(`/evals/${e}/runs/${n}/output_items/${r}`,s)}list(e,n,r={},s){return dr(r)?this.list(e,n,{},r):this._client.getAPIList(`/evals/${e}/runs/${n}/output_items`,cA,{query:r,...s})}}class cA extends Zr{}lA.OutputItemListResponsesPage=cA;class ay extends Ut{constructor(){super(...arguments),this.outputItems=new lA(this._client)}create(e,n,r){return this._client.post(`/evals/${e}/runs`,{body:n,...r})}retrieve(e,n,r){return this._client.get(`/evals/${e}/runs/${n}`,r)}list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/evals/${e}/runs`,uA,{query:n,...r})}del(e,n,r){return this._client.delete(`/evals/${e}/runs/${n}`,r)}cancel(e,n,r){return this._client.post(`/evals/${e}/runs/${n}`,r)}}class uA extends Zr{}ay.RunListResponsesPage=uA;ay.OutputItems=lA;ay.OutputItemListResponsesPage=cA;class ly extends Ut{constructor(){super(...arguments),this.runs=new ay(this._client)}create(e,n){return this._client.post("/evals",{body:e,...n})}retrieve(e,n){return this._client.get(`/evals/${e}`,n)}update(e,n,r){return this._client.post(`/evals/${e}`,{body:n,...r})}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/evals",dA,{query:e,...n})}del(e,n){return this._client.delete(`/evals/${e}`,n)}}class dA extends Zr{}ly.EvalListResponsesPage=dA;ly.Runs=ay;ly.RunListResponsesPage=uA;let hA=class extends Ut{create(e,n){return this._client.post("/files",cd({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/files",fA,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/binary",...n==null?void 0:n.headers},__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,n)}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let o=await this.retrieve(e);for(;!o.status||!s.has(o.status);)if(await ny(n),o=await this.retrieve(e),Date.now()-i>r)throw new qP({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return o}};class fA extends Zr{}hA.FileObjectsPage=fA;class LG extends Ut{}let FG=class extends Ut{run(e,n){return this._client.post("/fine_tuning/alpha/graders/run",{body:e,...n})}validate(e,n){return this._client.post("/fine_tuning/alpha/graders/validate",{body:e,...n})}};class mA extends Ut{constructor(){super(...arguments),this.graders=new FG(this._client)}}mA.Graders=FG;class pA extends Ut{create(e,n,r){return this._client.getAPIList(`/fine_tuning/checkpoints/${e}/permissions`,gA,{body:n,method:"post",...r})}retrieve(e,n={},r){return dr(n)?this.retrieve(e,{},n):this._client.get(`/fine_tuning/checkpoints/${e}/permissions`,{query:n,...r})}del(e,n,r){return this._client.delete(`/fine_tuning/checkpoints/${e}/permissions/${n}`,r)}}class gA extends zb{}pA.PermissionCreateResponsesPage=gA;let Yb=class extends Ut{constructor(){super(...arguments),this.permissions=new pA(this._client)}};Yb.Permissions=pA;Yb.PermissionCreateResponsesPage=gA;class yA extends Ut{list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,xA,{query:n,...r})}}class xA extends Zr{}yA.FineTuningJobCheckpointsPage=xA;class $f extends Ut{constructor(){super(...arguments),this.checkpoints=new yA(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",vA,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return dr(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,wA,{query:n,...r})}pause(e,n){return this._client.post(`/fine_tuning/jobs/${e}/pause`,n)}resume(e,n){return this._client.post(`/fine_tuning/jobs/${e}/resume`,n)}}class vA extends Zr{}class wA extends Zr{}$f.FineTuningJobsPage=vA;$f.FineTuningJobEventsPage=wA;$f.Checkpoints=yA;$f.FineTuningJobCheckpointsPage=xA;class Yc extends Ut{constructor(){super(...arguments),this.methods=new LG(this._client),this.jobs=new $f(this._client),this.checkpoints=new Yb(this._client),this.alpha=new mA(this._client)}}Yc.Methods=LG;Yc.Jobs=$f;Yc.FineTuningJobsPage=vA;Yc.FineTuningJobEventsPage=wA;Yc.Checkpoints=Yb;Yc.Alpha=mA;class OG extends Ut{}class bA extends Ut{constructor(){super(...arguments),this.graderModels=new OG(this._client)}}bA.GraderModels=OG;class $G extends Ut{createVariation(e,n){return this._client.post("/images/variations",cd({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",cd({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}class _A extends Ut{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",SA,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class SA extends zb{}_A.ModelsPage=SA;class VG extends Ut{create(e,n){return this._client.post("/moderations",{body:e,...n})}}function a_e(t,e){return!e||!c_e(e)?{...t,output_parsed:null,output:t.output.map(n=>n.type==="function_call"?{...n,parsed_arguments:null}:n.type==="message"?{...n,content:n.content.map(r=>({...r,parsed:null}))}:n)}:UG(t,e)}function UG(t,e){const n=t.output.map(s=>{if(s.type==="function_call")return{...s,parsed_arguments:h_e(e,s)};if(s.type==="message"){const i=s.content.map(o=>o.type==="output_text"?{...o,parsed:l_e(e,o.text)}:o);return{...s,content:i}}return s}),r=Object.assign({},t,{output:n});return Object.getOwnPropertyDescriptor(t,"output_text")||QT(r),Object.defineProperty(r,"output_parsed",{enumerable:!0,get(){for(const s of r.output)if(s.type==="message"){for(const i of s.content)if(i.type==="output_text"&&i.parsed!==null)return i.parsed}return null}}),r}function l_e(t,e){var n,r,s,i;return((r=(n=t.text)==null?void 0:n.format)==null?void 0:r.type)!=="json_schema"?null:"$parseRaw"in((s=t.text)==null?void 0:s.format)?((i=t.text)==null?void 0:i.format).$parseRaw(e):JSON.parse(e)}function c_e(t){var e;return!!ZP((e=t.text)==null?void 0:e.format)}function u_e(t){return(t==null?void 0:t.$brand)==="auto-parseable-tool"}function d_e(t,e){return t.find(n=>n.type==="function"&&n.name===e)}function h_e(t,e){const n=d_e(t.tools??[],e.name);return{...e,...e,parsed_arguments:u_e(n)?n.$parseRaw(e.arguments):n!=null&&n.strict?JSON.parse(e.arguments):null}}function QT(t){const e=[];for(const n of t.output)if(n.type==="message")for(const r of n.content)r.type==="output_text"&&e.push(r.text);t.output_text=e.join("")}class BG extends Ut{list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/responses/${e}/input_items`,m_e,{query:n,...r})}}var Bd=globalThis&&globalThis.__classPrivateFieldSet||function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},kl=globalThis&&globalThis.__classPrivateFieldGet||function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},zd,xx,Rl,vx,PL,AL,kL,RL;class CA extends JP{constructor(e){super(),zd.add(this),xx.set(this,void 0),Rl.set(this,void 0),vx.set(this,void 0),Bd(this,xx,e,"f")}static createResponse(e,n,r){const s=new CA(n);return s._run(()=>s._createOrRetrieveResponse(e,n,{...r,headers:{...r==null?void 0:r.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createOrRetrieveResponse(e,n,r){var l;const s=r==null?void 0:r.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),kl(this,zd,"m",PL).call(this);let i,o=null;"response_id"in n?(i=await e.responses.retrieve(n.response_id,{stream:!0},{...r,signal:this.controller.signal,stream:!0}),o=n.starting_after??null):i=await e.responses.create({...n,stream:!0},{...r,signal:this.controller.signal}),this._connected();for await(const c of i)kl(this,zd,"m",AL).call(this,c,o);if((l=i.controller.signal)!=null&&l.aborted)throw new ho;return kl(this,zd,"m",kL).call(this)}[(xx=new WeakMap,Rl=new WeakMap,vx=new WeakMap,zd=new WeakSet,PL=function(){this.ended||Bd(this,Rl,void 0,"f")},AL=function(n,r){if(this.ended)return;const s=(o,l)=>{(r==null||l.sequence_number>r)&&this._emit(o,l)},i=kl(this,zd,"m",RL).call(this,n);switch(s("event",n),n.type){case"response.output_text.delta":{const o=i.output[n.output_index];if(!o)throw new Ot(`missing output at index ${n.output_index}`);if(o.type==="message"){const l=o.content[n.content_index];if(!l)throw new Ot(`missing content at index ${n.content_index}`);if(l.type!=="output_text")throw new Ot(`expected content to be 'output_text', got ${l.type}`);s("response.output_text.delta",{...n,snapshot:l.text})}break}case"response.function_call_arguments.delta":{const o=i.output[n.output_index];if(!o)throw new Ot(`missing output at index ${n.output_index}`);o.type==="function_call"&&s("response.function_call_arguments.delta",{...n,snapshot:o.arguments});break}default:s(n.type,n);break}},kL=function(){if(this.ended)throw new Ot("stream has ended, this shouldn't happen");const n=kl(this,Rl,"f");if(!n)throw new Ot("request ended without sending any events");Bd(this,Rl,void 0,"f");const r=f_e(n,kl(this,xx,"f"));return Bd(this,vx,r,"f"),r},RL=function(n){let r=kl(this,Rl,"f");if(!r){if(n.type!=="response.created")throw new Ot(`When snapshot hasn't been set yet, expected 'response.created' event, got ${n.type}`);return r=Bd(this,Rl,n.response,"f"),r}switch(n.type){case"response.output_item.added":{r.output.push(n.item);break}case"response.content_part.added":{const s=r.output[n.output_index];if(!s)throw new Ot(`missing output at index ${n.output_index}`);s.type==="message"&&s.content.push(n.part);break}case"response.output_text.delta":{const s=r.output[n.output_index];if(!s)throw new Ot(`missing output at index ${n.output_index}`);if(s.type==="message"){const i=s.content[n.content_index];if(!i)throw new Ot(`missing content at index ${n.content_index}`);if(i.type!=="output_text")throw new Ot(`expected content to be 'output_text', got ${i.type}`);i.text+=n.delta}break}case"response.function_call_arguments.delta":{const s=r.output[n.output_index];if(!s)throw new Ot(`missing output at index ${n.output_index}`);s.type==="function_call"&&(s.arguments+=n.delta);break}case"response.completed":{Bd(this,Rl,n.response,"f");break}}return r},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,o)=>n.push({resolve:i,reject:o})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}async finalResponse(){await this.done();const e=kl(this,vx,"f");if(!e)throw new Ot("stream ended without producing a ChatCompletion");return e}}function f_e(t,e){return a_e(t,e)}class EA extends Ut{constructor(){super(...arguments),this.inputItems=new BG(this._client)}create(e,n){return this._client.post("/responses",{body:e,...n,stream:e.stream??!1})._thenUnwrap(r=>("object"in r&&r.object==="response"&&QT(r),r))}retrieve(e,n={},r){return dr(n)&&r===void 0?this.retrieve(e,{},n):this._client.get(`/responses/${e}`,{query:n,...r,stream:n.stream??!1})._thenUnwrap(s=>("object"in s&&s.object==="response"&&QT(s),s))}del(e,n){return this._client.delete(`/responses/${e}`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}parse(e,n){return this._client.responses.create(e,n)._thenUnwrap(r=>UG(r,e))}stream(e,n){return CA.createResponse(this._client,e,n)}cancel(e,n){return this._client.post(`/responses/${e}/cancel`,{...n,headers:{Accept:"*/*",...n==null?void 0:n.headers}})}}class m_e extends Zr{}EA.InputItems=BG;class zG extends Ut{create(e,n,r){return this._client.post(`/uploads/${e}/parts`,cd({body:n,...r}))}}class TA extends Ut{constructor(){super(...arguments),this.parts=new zG(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(`/uploads/${e}/complete`,{body:n,...r})}}TA.Parts=zG;const p_e=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};class Jb extends Ut{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}update(e,n,r,s){return this._client.post(`/vector_stores/${e}/files/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}list(e,n={},r){return dr(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,Xb,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),o=i.data;switch(o.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=i.response.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await ny(l);break;case"failed":case"completed":return o}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}content(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/files/${n}/content`,IA,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class Xb extends Zr{}class IA extends zb{}Jb.VectorStoreFilesPage=Xb;Jb.FileContentResponsesPage=IA;class GG extends Ut{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return dr(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,Xb,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s==null?void 0:s.headers}})}async poll(e,n,r){const s={...r==null?void 0:r.headers,"X-Stainless-Poll-Helper":"true"};for(r!=null&&r.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:o}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let l=5e3;if(r!=null&&r.pollIntervalMs)l=r.pollIntervalMs;else{const c=o.headers.get("openai-poll-after-ms");if(c){const u=parseInt(c);isNaN(u)||(l=u)}}await ny(l);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=(s==null?void 0:s.maxConcurrency)??5,o=Math.min(i,n.length),l=this._client,c=n.values(),u=[...r];async function d(f){for(let m of f){const g=await l.files.create({file:m,purpose:"assistants"},s);u.push(g.id)}}const h=Array(o).fill(c).map(d);return await p_e(h),await this.createAndPoll(e,{file_ids:u})}}class Jc extends Ut{constructor(){super(...arguments),this.files=new Jb(this._client),this.fileBatches=new GG(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}list(e={},n){return dr(e)?this.list({},e):this._client.getAPIList("/vector_stores",NA,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n==null?void 0:n.headers}})}search(e,n,r){return this._client.getAPIList(`/vector_stores/${e}/search`,PA,{body:n,method:"post",...r,headers:{"OpenAI-Beta":"assistants=v2",...r==null?void 0:r.headers}})}}class NA extends Zr{}class PA extends zb{}Jc.VectorStoresPage=NA;Jc.VectorStoreSearchResponsesPage=PA;Jc.Files=Jb;Jc.VectorStoreFilesPage=Xb;Jc.FileContentResponsesPage=IA;Jc.FileBatches=GG;var WG;class Yt extends Lbe{constructor({baseURL:e=fx("OPENAI_BASE_URL"),apiKey:n=fx("OPENAI_API_KEY"),organization:r=fx("OPENAI_ORG_ID")??null,project:s=fx("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new Ot("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const o={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!o.dangerouslyAllowBrowser&&Hbe())throw new Ot(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:o.baseURL,timeout:o.timeout??6e5,httpAgent:o.httpAgent,maxRetries:o.maxRetries,fetch:o.fetch}),this.completions=new jG(this),this.chat=new Hb(this),this.embeddings=new MG(this),this.files=new hA(this),this.images=new $G(this),this.audio=new ry(this),this.moderations=new VG(this),this.models=new _A(this),this.fineTuning=new Yc(this),this.graders=new bA(this),this.vectorStores=new Jc(this),this.beta=new Of(this),this.batches=new KP(this),this.uploads=new TA(this),this.responses=new EA(this),this.evals=new ly(this),this.containers=new oy(this),this._options=o,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return xbe(e,{arrayFormat:"brackets"})}}WG=Yt;Yt.OpenAI=WG;Yt.DEFAULT_TIMEOUT=6e5;Yt.OpenAIError=Ot;Yt.APIError=bs;Yt.APIConnectionError=$b;Yt.APIConnectionTimeoutError=qP;Yt.APIUserAbortError=ho;Yt.NotFoundError=G8;Yt.ConflictError=W8;Yt.RateLimitError=q8;Yt.BadRequestError=U8;Yt.AuthenticationError=B8;Yt.InternalServerError=K8;Yt.PermissionDeniedError=z8;Yt.UnprocessableEntityError=H8;Yt.toFile=eG;Yt.fileFromPath=O8;Yt.Completions=jG;Yt.Chat=Hb;Yt.ChatCompletionsPage=Wb;Yt.Embeddings=MG;Yt.Files=hA;Yt.FileObjectsPage=fA;Yt.Images=$G;Yt.Audio=ry;Yt.Moderations=VG;Yt.Models=_A;Yt.ModelsPage=SA;Yt.FineTuning=Yc;Yt.Graders=bA;Yt.VectorStores=Jc;Yt.VectorStoresPage=NA;Yt.VectorStoreSearchResponsesPage=PA;Yt.Beta=Of;Yt.Batches=KP;Yt.BatchesPage=YP;Yt.Uploads=TA;Yt.Responses=EA;Yt.Evals=ly;Yt.EvalListResponsesPage=dA;Yt.Containers=oy;Yt.ContainerListResponsesPage=aA;const g_e=Yt,y_e="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",x_e=new g_e({apiKey:y_e,dangerouslyAllowBrowser:!0});async function HG(t,e={}){if(!t||typeof t!="string"||t.trim()==="")throw new Error("A valid prompt string is required for OpenAI image generation.");console.log(`[OpenAI] Generating image with prompt: "${t}"`);try{const n=await x_e.images.generate({model:"gpt-image-1",prompt:t,n:e.n||1,size:e.size||"1024x1024",quality:e.quality||"auto",response_format:"b64_json"});if(console.log("[OpenAI] Image generation response:",n),n.data&&n.data.length>0&&n.data[0].b64_json)return{b64_json:n.data[0].b64_json,alt:`OpenAI generated image for: ${t.substring(0,50)}`,revised_prompt:n.data[0].revised_prompt};throw new Error("No image data found in OpenAI response.")}catch(n){throw console.error("[OpenAI] Error generating image:",n),n.response&&n.response.data&&n.response.data.error?new Error(`OpenAI API Error: ${n.response.data.error.message}`):n}}const so=[{name:"Canvas",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Canvas.jpeg?alt=media&token=bfcade71-3242-4fc1-a623-1779f4b4773c",category:"Wall Art"},{name:"Hat",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Hat.jpeg?alt=media&token=e71e8dd0-2fc8-49ba-be13-98fd3909db3c",category:"Apparel"},{name:"Black hoodie",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Hoodie.jpeg?alt=media&token=90fee73f-96f5-4372-9f15-44e44403adca",category:"Apparel"},{name:"Mug",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Mug.png?alt=media&token=ff8dd2df-7dad-4ef7-8fa8-7867a6770dba",category:"Drinkware"},{name:"Notebook",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Notebook.jpeg?alt=media&token=807b6222-96ad-4179-a11a-16406c4b4509",category:"Stationery"},{name:"Pillow",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Pillow.webp?alt=media&token=50f5c317-8c39-4c48-b55c-d1da9216fa2e",category:"Home Decor"},{name:"Shirt",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Shirt.webp?alt=media&token=7c5f9b2f-6161-4a01-b9eb-1ae7813f3d6c",category:"Apparel"},{name:"Totebag",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Totebag.jpeg?alt=media&token=2d4dad9f-53d8-45b5-afce-5cef1a8e9f1c",category:"Accessories"},{name:"Travel mug",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Travelmug.jpeg?alt=media&token=312cd2d7-add0-4180-8872-355ec15ed00e",category:"Drinkware"},{name:"Blanket",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Bl.webp?alt=media&token=882cefc9-c725-40e7-a225-69f91d3ea2f6",category:"Home Decor"}],Zw=[{value:"fashion",label:"Fashion & Apparel"},{value:"electronics",label:"Electronics & Gadgets"},{value:"food",label:"Food & Beverage"},{value:"jewelry",label:"Jewelry & Accessories"},{value:"homedecor",label:"Home Decor & Furnishings"},{value:"beauty",label:"Beauty & Personal Care"},{value:"books",label:"Books & Media"},{value:"sports",label:"Sports & Outdoors"},{value:"toys",label:"Toys & Games"},{value:"art_collectibles",label:"Art & Collectibles"},{value:"general",label:"General Merchandise"}],AA=["fashion","quotes","personalized","print on demand","home decor","digital services","art/design","jewelry","collectibles","courses","books","garden","electronics","games","sports","productivity","toys","automotive","tools","marketing","content creation","ui/ux design","web/app development"],dg=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{const c=s.toDataURL("image/png").split(",")[1];e({base64ImageData:c,mimeType:"image/png"})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas."))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),v_e=t=>new Promise((e,n)=>{if(!t||!(t instanceof File))return n(new Error("Invalid file object provided."));const r=new FileReader;r.onload=()=>{const s=r.result;try{const i=s.split(",");if(i.length<2)throw new Error("Invalid data URL structure from FileReader.");const o=i[1];e({base64ImageData:o,mimeType:t.type})}catch(i){console.error("Error parsing data URL from FileReader:",s,i),n(new Error(`Invalid data URL format from FileReader: ${i.message}`))}},r.onerror=s=>{console.error("FileReader error:",s),n(new Error("Failed to read the file."))},r.readAsDataURL(t)}),w_e="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk";async function b_e(t){const e=new _n({apiKey:w_e}),n={type:He.ARRAY,items:{type:He.STRING},description:"An array of relevant tags for the store."},r=`
    Given the following store data, please select the most relevant tags from the provided list.
    You can select multiple tags if they are relevant. If no tags are relevant, return an empty array.

    Store Name: ${t.name}
    Store Description: ${t.description}
    Store Niche: ${t.niche}

    Products:
    ${t.products.map(s=>`- ${s.name}: ${s.description}`).join(`
`)}

    Available Tags:
    ${AA.join(", ")}

    Return a JSON array of the selected tags.
  `;try{const s=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:r}]}],config:{responseMimeType:"application/json",responseSchema:n}}),i=s.text;if(typeof i!="string"||i.trim()==="")throw console.error("Model did not return a text response for tags. Response:",JSON.stringify(s)),new Error("Model response for tags was empty or not a string.");try{const o=JSON.parse(i);return Array.isArray(o)&&o.every(l=>typeof l=="string")?{tags:o}:(console.error("Parsed tags are not an array of strings:",o),{error:"AI response was not in the expected format (array of strings).",rawResponse:i})}catch(o){return console.error("Failed to parse JSON response for tags:",i,"ParseError:",o),{error:"Failed to parse tags from AI.",rawResponse:i}}}catch(s){return console.error("Error generating tags:",s),{error:`Error generating tags: ${s.message}`}}}const __e="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk",S_e=[{category:Tr.HARM_CATEGORY_HARASSMENT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_HATE_SPEECH,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE}],C_e=t=>{if(!t)return null;const e=t.split(",");if(e.length<2)return null;const n=e[0].match(/:(.*?);/);if(!n||n.length<2)return null;const r=n[1],s=atob(e[1]);let i=s.length;const o=new Uint8Array(i);for(;i--;)o[i]=s.charCodeAt(i);return new Blob([o],{type:r})};async function qG(t,e,n=null,r="image/png",s=[],i=(u,d)=>console.log(`ProductGen Progress: ${u}%, Message: ${d||""}`),o=0,l=5,c=""){if(!t||!e)throw new Error("Product type and store name are required to generate a product.");const u=new _n({apiKey:__e});let d=`You are an expert product creator for e-commerce stores.
Generate a product for a store named "${e}" that sells ${t}.
The overall theme and request for the store is: "${c}". Use this full prompt to ensure the product aligns well with the user's vision.

The product should include:
1. A catchy title.
2. A brief description (15-25 words).
3. A realistic price (e.g., 29.99, 45.00).
4. Relevant product options/variants (e.g., for a shirt: Size [S, M, L, XL], Color [White, Black, Blue]; for a shoe: Size [8, 9, 10], Color [Red, Grey]). Generate 1 to 2 variant types, each with 2 to 5 option values. If no variants are typically applicable for the product type, return an empty array for "variants".
5. A visually appealing product image.

Return the text details (title, description, price, variants) as a single JSON object in the text part of your response.
Your entire text response MUST be ONLY a valid JSON object. Do not include any other words, phrases, or conversational text before or after the JSON object.
The JSON object should strictly follow this format:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": [
    { "name": "Size", "values": ["S", "M", "L", "XL"] },
    { "name": "Color", "values": ["White", "Black", "Blue"] }
  ]
}
Or, if no variants apply:
{
  "title": "Example Product Title",
  "description": "This is a fantastic example product, perfect for your needs and desires.",
  "price": "19.99",
  "variants": []
}


Generate an image for this product in the image part of your response.`,h=d;if(s&&s.length>0&&(h+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n){let _=d;s&&s.length>0&&(_+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),n&&(_+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`),console.log(n?`[geminiProductGeneration Function] Generating product with logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`:`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}else{let _=d;s&&s.length>0&&(_+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),console.log(`[geminiProductGeneration Function] Generating product without logo for type: ${t}, store: ${e}. Excluding: ${s.join(", ")}`)}let f=null,m=null,g="",x=0;const w=3;let v=[];for(;x<w;){x++,console.log(`[geminiProductGeneration Function] Attempt ${x} to generate content...`);const _=o+(x-1)/w*(l*.2);i(_,`Generating product (attempt ${x}/${w})...`);let C=d;s&&s.length>0&&(C+=`

IMPORTANT: The new product MUST be distinct and different from the following products already generated for this store: "${s.join('", "')}". Focus on creating variety.`),v.length>0&&(C+=`

ADDITIONALLY IMPORTANT: Avoid re-generating the following titles which were duplicates in previous attempts of THIS request: "${v.join('", "')}". Ensure the new title is truly novel and not similar to these.`),n&&(C+=`

A logo image is also provided. Subtly incorporate this logo onto the product, its packaging, or in the scene if appropriate. For example, it could be a small brand mark on the item or a logo in the background if it's a lifestyle shot. Ensure the product remains the main focus.`);const T=[{text:C}];if(n&&T.push({inlineData:{data:n,mimeType:r}}),x===1){const R=[...s,...v];console.log(`[geminiProductGeneration Function] Generating product for type: ${t}, store: ${e}. Initial exclusions (if any): ${R.join(", ")||"None"}. Logo: ${n?"Yes":"No"}`)}try{const R=await u.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:T,safetySettings:S_e,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});f=null,m=null;let k="";if(R.candidates&&R.candidates.length>0&&R.candidates[0].content&&R.candidates[0].content.parts)for(const E of R.candidates[0].content.parts)if(E.text){k+=E.text;try{const I=E.text.trim();let P=null;const A=I.match(/```json\s*([\s\S]*?)\s*```/);if(A&&A[1])P=A[1],console.log(`[geminiProductGeneration Function] Attempt ${x}: Found JSON in markdown block.`);else{const D=I.indexOf("{"),j=I.lastIndexOf("}");D!==-1&&j>D&&(P=I.substring(D,j+1),console.log(`[geminiProductGeneration Function] Attempt ${x}: Extracted potential JSON between first '{' and last '}'.`))}P?(f=JSON.parse(P),console.log(`[geminiProductGeneration Function] Attempt ${x}: Successfully parsed JSON.`)):E.text&&(E.text.includes("{")||E.text.includes("}"))?console.warn(`[geminiProductGeneration Function] Attempt ${x}: Text part contained braces but simple extraction failed. Text:`,E.text):E.text&&console.warn(`[geminiProductGeneration Function] Attempt ${x}: No JSON structure (markdown or simple braces) found in text part:`,E.text)}catch(I){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Error parsing JSON. Attempted to parse: "${typeof jsonStringToParse=="string"?jsonStringToParse:"[jsonStringToParse was not a string or was null]"}". Original text from part:`,E.text,"Error:",I.message),f=null}}else E.inlineData&&E.inlineData.data&&(m=E.inlineData.data,console.log(`[geminiProductGeneration Function] Attempt ${x}: Image data found.`));if(g+=(g?`
---
Attempt `+x+`:
`:"Attempt "+x+`:
`)+k,f&&f.title){const E=f.title.toLowerCase();i(o+l*.8,`Validating product details for "${f.title}"...`);const I=s.some(A=>A.toLowerCase()===E),P=v.some(A=>A.toLowerCase()===E);if(I||P)console.warn(`[geminiProductGeneration Function] Attempt ${x}: Generated title "${f.title}" is a duplicate. Adding to exclusion list for next attempt.`),v.push(f.title),f=null;else if(!f.price||typeof f.price!="string"&&typeof f.price!="number"||String(f.price).trim()==="")console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique, but price is missing or invalid. Price:`,f.price),f=null;else if(!f.variants||!Array.isArray(f.variants))console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" is unique and price is valid, but variants are missing or not an array. Variants:`,f.variants),f=null;else for(const A of f.variants)if(!A.name||typeof A.name!="string"||!Array.isArray(A.values)||!A.values.every(D=>typeof D=="string")){console.warn(`[geminiProductGeneration Function] Attempt ${x}: Product title "${f.title}" has malformed variant entry. Variant:`,A),f=null;break}}if(f&&f.title&&(f.price||f.price===0)&&f.variants&&m){console.log(`[geminiProductGeneration Function] Successfully generated complete and unique product data (including variants) on attempt ${x}.`);break}else m||console.warn(`[geminiProductGeneration Function] Attempt ${x} missing image data.`),f?(f.title||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing title.`),!f.price&&f.price!==0&&console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing price.`),f.variants||console.warn(`[geminiProductGeneration Function] Attempt ${x} text details missing variants or variants malformed.`)):console.warn(`[geminiProductGeneration Function] Attempt ${x} missing text details (or title was duplicate/price missing/variants malformed).`)}catch(R){console.error(`[geminiProductGeneration Function] Error during attempt ${x}:`,R.message,R.stack),g+=(g?`
---
`:"")+`Attempt ${x} Error: ${R.message}`}x>=w&&(!f||!m)&&console.error(`[geminiProductGeneration Function] Exhausted ${w} attempts. Product generation failed.`)}if(!f||!m){let _=`Failed to generate complete and unique product data after ${w} attempts. `;throw f||(_+="Text details (or unique title) missing. "),m||(_+="Image data missing. "),console.error(_,"Accumulated raw text responses:",g),new Error(_+`Last raw text (if any): ${g}`)}if(typeof f.title!="string"||typeof f.description!="string"||typeof f.price!="string"&&typeof f.price!="number"||!Array.isArray(f.variants)||!f.variants.every(_=>typeof _.name=="string"&&Array.isArray(_.values)&&_.values.every(C=>typeof C=="string")))throw console.error("[geminiProductGeneration Function] Parsed product details are not in the expected format:",f),new Error("AI response for product details was not in the expected format (title, description, price, variants).");if(f.price=String(f.price),console.log("[geminiProductGeneration Function] Successfully generated product details (including variants) and image data."),m){const _=`data:image/png;base64,${m}`,C=C_e(_);if(C){const T=Pt(),k=`product_images_generated/${`${e.replace(/\s+/g,"_").toLowerCase()}_${f.title.replace(/\s+/g,"_").toLowerCase().substring(0,20)}_${T}.png`}`,E=yh(xh,k);try{i(o+l*.9,`Uploading image for "${f.title}"...`),await ph(E,C);const I=await gh(E);return console.log(`[geminiProductGeneration Function] Image uploaded to Firebase Storage: ${I}`),i(o+l,`Product "${f.title}" generated successfully.`),{...f,images:[I]}}catch(I){throw console.error("[geminiProductGeneration Function] Error uploading image to Firebase Storage:",I),new Error(`Failed to upload generated image to Firebase Storage: ${I.message}`)}}else throw console.error("[geminiProductGeneration Function] Failed to convert base64 image data to Blob."),new Error("Failed to process generated image data for upload.")}else return i(o+l,`Product "${f.title}" generated (no image).`),{...f,images:[]}}const E_e="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk",jL=new _n({apiKey:E_e});async function KG(t,e,n,r=[],s=(l,c)=>console.log(`CollectionGen Progress: ${l}%, Message: ${c||""}`),i=0,o=5){const l=()=>null,c=n&&n.length>0?n.map(h=>`- ${h.name}: ${h.description||"No description."}`).filter(Boolean).join(`
`):"various items",u=r.length>0?`Do NOT use any of the following names: ${r.join(", ")}.`:"",d=`
    You are an AI assistant for an e-commerce store named "${e}" that sells "${t}".
    Based on the following products (name and description): 
${c}
Suggest a compelling and UNIQUE collection name and a short, engaging description (max 2 sentences) for a new collection.
    The collection should group related products or highlight a specific theme.
    ${u}
    Provide the output in a JSON format like this:
    {
      "name": "Collection Name",
      "description": "Collection Description",
      "product_names": ["Product Name 1", "Product Name 2"]
    }
    Ensure the collection name is concise, unique from the provided list (if any), and the description is appealing.
    The "product_names" array should contain a selection of 2 to 4 relevant product names from the provided product list that fit well within this new collection.
  `;s(i+o*.1,"Generating collection details...");try{const h=await jL.models.generateContent({model:"gemini-2.0-flash",contents:[{text:d}],config:{responseModalities:[yn.TEXT]}});let f="";if(h&&h.candidates&&h.candidates.length>0&&h.candidates[0].content&&h.candidates[0].content.parts&&h.candidates[0].content.parts.length>0)for(const _ of h.candidates[0].content.parts)_.text&&(f+=_.text);if(!f)return console.error("Gemini text generation did not return any text content. Full response:",h),console.warn("Returning fallback collection due to no text from AI."),l();let m;try{const _=f.match(/```json\n([\s\S]*?)\n```/);if(_&&_[1])m=JSON.parse(_[1]);else try{m=JSON.parse(f)}catch{console.warn("Failed to parse Gemini response as JSON directly, trying to extract from text:",f);const T=f.indexOf("{"),R=f.lastIndexOf("}");if(T!==-1&&R!==-1&&R>T){const k=f.substring(T,R+1);try{m=JSON.parse(k)}catch(E){throw console.error("Final attempt to parse extracted JSON failed:",k,E),E}}else throw new Error("No valid JSON structure found in response.")}}catch(_){return console.error("Failed to parse Gemini response as JSON:",f,_),console.warn("Returning fallback collection due to JSON parsing error."),l()}if(!m||!m.name||!m.description||!Array.isArray(m.product_names)||m.product_names.length===0)return console.error("AI did not return valid collection data (name, description, or non-empty product_names array):",m),console.warn("Returning fallback collection due to invalid/incomplete AI data."),s(i+o*.5,"Failed to get valid collection details."),l();s(i+o*.5,`Collection details "${m.name}" received.`);const g=_=>{if(typeof _!="string")return"";let C=_.toLowerCase();return C=C.replace(/\b(a|an|the)\b/g,""),C.endsWith("s")&&C.length>3&&(C=C.slice(0,-1)),C=C.replace(/[^a-z0-9\s]/g,"").replace(/\s+/g," ").trim(),C},x=[];m.product_names&&n&&m.product_names.forEach(_=>{const C=g(_);if(!C){console.warn(`AI product name "${_}" normalized to an empty string. Skipping.`);return}let T=null;T=n.find(R=>g(R.name)===C),T||(T=n.find(R=>{const k=g(R.name);return k.includes(C)||C.includes(k)})),T&&T.name?(x.push(T.name),console.log(`Matched AI product "${_}" (normalized: "${C}") to existing product "${T.name}" (using name as ID)`)):console.warn(`Product name "${_}" (normalized: "${C}") from AI response not found in provided product list or missing name after normalization and fallback search.`)});const w=`A vibrant and appealing e-commerce collection image for "${m.name}", described as "${m.description}", suitable for a store selling ${t}.`;let v=null;s(i+o*.6,`Generating image for collection "${m.name}"...`);try{const _=[{text:w}],C=await jL.models.generateContent({model:"gemini-2.0-flash-preview-image-generation",contents:_,config:{responseModalities:[yn.TEXT,yn.IMAGE]}});if(C&&C.candidates&&C.candidates.length>0&&C.candidates[0].content&&C.candidates[0].content.parts&&C.candidates[0].content.parts.length>0){for(const T of C.candidates[0].content.parts)if(T.inlineData&&T.inlineData.data){v=T.inlineData.data;break}}v?s(void 0,`Image generated for collection "${m.name}".`):(console.warn(`Gemini image generation did not return image data for collection: "${m.name}". Full Response:`,C),s(void 0,`Image generation failed for collection "${m.name}".`))}catch(_){console.error(`Error generating image for collection "${m.name}" with Gemini:`,_),s(void 0,`Error generating image for collection "${m.name}".`)}return s(i+o,`Collection "${m.name}" processing complete.`),{name:m.name,description:m.description,imageData:v,product_ids:x}}catch(h){return console.error("Error generating collection with Gemini:",h),console.warn("Returning fallback collection due to an unexpected error in generation process."),s(i+o,"Collection generation failed (unexpected error)."),l()}}const T_e="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk",YG=async t=>{var i,o;if(!t||t.length===0)return{error:"No images provided for analysis."};const e=new _n({apiKey:T_e}),n=t.map(l=>{if(!l.base64||!l.mimeType)throw console.error("Image object is missing base64 or mimeType:",l.name),new Error(`Image ${l.name} is missing data for AI processing.`);return{inlineData:{data:l.base64.startsWith("data:")?l.base64.split(",")[1]:l.base64,mimeType:l.mimeType}}}),r=`
    Analyze the following product images (${t.map(l=>l.name).join(", ")}). 
    Based on these images, provide the following details for setting up an e-commerce store.
    Please format your response as a single, valid JSON object with the exact keys specified below.

    1.  "productType": A concise category or niche for these products (e.g., "Handcrafted Leather Goods", "Vintage Streetwear", "Artisanal Coffee Beans").
    2.  "storeNameSuggestions": An array of 3-5 creative and relevant store name suggestions.
    3.  "logoDescription": A brief description of a suitable logo concept (e.g., "A minimalist line art of a coffee bean with earthy tones").
    4.  "products": An array of objects, one for each uploaded image. For each product, analyze its specific image content to generate the following:
        *   "originalImageName": The filename of the original image (use the names provided in this prompt, e.g., "${((i=t[0])==null?void 0:i.name)||"example_image.jpg"}").
        *   "name": A catchy and descriptive product name directly inspired by the visual details in THIS specific image.
        *   "price": A suggested retail price for THIS specific product, considering its appearance and likely category (e.g., "29.99"). Ensure this is a string representing a number.
        *   "description": A compelling product description (2-3 sentences) highlighting key visual features and benefits of THIS specific product shown in its image.
    5.  "collections": An array of 3 distinct collection suggestions, each with:
        *   "name": Collection name (e.g., "New Arrivals", "Essentials", "Gifts Under $50").
        *   "description": A brief description for the collection.
    6.  "storePrompt": A short paragraph describing the overall style, feel, and target audience for a store selling these products. This will be used as a base for further AI generation of store content.

    Example for a single product in the "products" array:
    {
      "originalImageName": "${((o=t[0])==null?void 0:o.name)||"example_image.jpg"}",
      "name": "Rustic Leather Wallet",
      "price": "45.00",
      "description": "Hand-stitched full-grain leather wallet with a timeless design. Perfect for everyday carry, offering both style and durability."
    }
  `,s={type:He.OBJECT,properties:{productType:{type:He.STRING},storeNameSuggestions:{type:He.ARRAY,items:{type:He.STRING}},logoDescription:{type:He.STRING},products:{type:He.ARRAY,items:{type:He.OBJECT,properties:{originalImageName:{type:He.STRING},name:{type:He.STRING},price:{type:He.STRING},description:{type:He.STRING}},required:["originalImageName","name","price","description"]}},collections:{type:He.ARRAY,items:{type:He.OBJECT,properties:{name:{type:He.STRING},description:{type:He.STRING}},required:["name","description"]}},storePrompt:{type:He.STRING}},required:["productType","storeNameSuggestions","logoDescription","products","collections","storePrompt"]};try{console.log("[geminiImageUnderstanding] Sending prompt to Gemini with images:",t.map(h=>h.name));const l=await e.models.generateContent({model:"gemini-2.0-flash",contents:[{role:"user",parts:[{text:r},...n]}],config:{responseMimeType:"application/json",responseSchema:s}});if(console.log("[geminiImageUnderstanding] Full API call response object:",JSON.stringify(l,null,2)),!l||typeof l.text!="string"){let h="Invalid or missing response from API.";return l&&l.promptFeedback&&l.promptFeedback.blockReason?(h=`Request blocked: ${l.promptFeedback.blockReason}. ${l.promptFeedback.blockReasonMessage||""}`,console.error(`[geminiImageUnderstanding] Request blocked. Reason: ${l.promptFeedback.blockReason}, Message: ${l.promptFeedback.blockReasonMessage}`)):l&&l.candidates&&l.candidates.length>0&&l.candidates[0].finishReason!=="STOP"&&l.candidates[0].finishReason!=="MODEL_SPECIFIED_STOP"?(h=`Generation stopped for reason: ${l.candidates[0].finishReason}.`,console.error(`[geminiImageUnderstanding] Generation stopped. Reason: ${l.candidates[0].finishReason}`)):console.error("[geminiImageUnderstanding] API response is invalid or text property is missing/not a string. Full response:",l),{error:`AI analysis failed: ${h}`}}const c=l.text;if(c.trim()==="")return console.error("[geminiImageUnderstanding] Model did not return a text response (empty string). Full API Response:",JSON.stringify(l)),{error:"AI analysis failed: Model response was empty or not text."};let u;try{u=JSON.parse(c)}catch(h){return console.error("[geminiImageUnderstanding] Failed to parse Gemini JSON response:",c,"ParseError:",h),{error:"AI analysis failed: Could not understand the response from Gemini (invalid JSON)."}}if(!u.productType||!Array.isArray(u.storeNameSuggestions)||!Array.isArray(u.products)||!Array.isArray(u.collections)||!u.storePrompt)return console.error("[geminiImageUnderstanding] Gemini response missing required fields or incorrect types:",u),{error:"AI analysis failed: The response from Gemini was incomplete or malformed."};const d=u.products.map(h=>{let f=[],m="Untitled Product (AI)",g="0.00",x="No description provided by AI.",w=null;if(h&&typeof h=="object")if(m=h.name||m,g=h.price||g,x=h.description||x,w=h.originalImageName||null,typeof h.originalImageName=="string"){const v=t.find(_=>_&&_.name===h.originalImageName);v&&typeof v.base64=="string"?f=[v.base64]:console.warn(`[geminiImageUnderstanding] Original image or its base64 not found for product with AI-provided originalImageName: "${h.originalImageName}". AI Product Name: "${h.name}"`)}else console.warn("[geminiImageUnderstanding] Product item from AI is missing 'originalImageName' string or is invalid:",h);else console.warn("[geminiImageUnderstanding] Invalid product item received from AI (not an object):",h);return{...h&&typeof h=="object"?h:{},name:m,price:g,description:x,originalImageName:w,images:f}});return{productType:u.productType,storeNameSuggestions:u.storeNameSuggestions,logoDescription:u.logoDescription,products:d,collections:u.collections,storePrompt:u.storePrompt,error:null}}catch(l){return console.error("[geminiImageUnderstanding] Error calling Gemini API or processing response:",l),{error:`AI analysis API call failed: ${l.message}`}}},JG=new _n({apiKey:"AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk"}),I_e=async t=>{if(!t)throw new Error("URL is required for analysis.");try{const e=JG.getGenerativeModel({model:"gemini-1.5-flash-preview-0514",tools:[{urlContext:{}}]}),n=`
      Analyze the content of the provided URL and extract the following information:
      1.  **Primary Topic/Theme:** What is the main subject of the page? (e.g., "E-commerce site for handmade leather goods", "Blog about minimalist interior design").
      2.  **Brand/Store Name:** Identify the name of the brand or store.
      3.  **Key Products/Services:** List the main products or services offered.
      4.  **Target Audience:** Describe the likely target audience.
      5.  **Visual Style/Aesthetics:** Describe the visual design, color palette, and overall aesthetic of the website.
      6.  **Key Marketing Phrases/Slogans:** Extract any prominent marketing messages or slogans.

      URL: ${t}
    `;return(await(await e.generateContent({contents:[{role:"user",parts:[{text:n}]}]})).response).text()}catch(e){throw console.error(`Error analyzing URL ${t}:`,e),new Error(`Failed to analyze content for URL: ${t}.`)}},N_e=async t=>{if(!t||t.length===0)return"";try{const e=await Promise.all(t.map(o=>I_e(o)));if(e.length===1)return e[0];const n=JG.getGenerativeModel({model:"gemini-1.5-flash-preview-0514"}),r=`
      You have been provided with analyses from multiple URLs. Synthesize this information into a single, coherent summary. 
      Identify common themes, brand identity, product categories, and target audience. 
      If there are conflicting details, note them. The goal is to create a unified creative brief that can be used to generate a new online store.

      Analyses:
      ${e.join(`

---

`)}
    `;return(await(await n.generateContent({contents:[{role:"user",parts:[{text:r}]}]})).response).text()}catch(e){throw console.error("Error synthesizing URL analyses:",e),new Error("Failed to synthesize analyses from multiple URLs.")}},P_e="2025-04",Qb=async(t,e,n,r={})=>{var l,c;if(!t||t==="your-shop-name.myshopify.com"||!e||e==="YOUR_SHOPIFY_STOREFRONT_ACCESS_TOKEN")throw new Error("Shopify domain or access token is not configured or is using placeholder values.");let s=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");s.includes(".")?!s.endsWith(".myshopify.com")&&s.includes("."):s=`${s}.myshopify.com`,s.includes(".")||(s=`${s}.myshopify.com`);let i=t.trim().replace(/^(https?:\/\/)/,"").replace(/\/$/,"");i.includes(".")||(i=`${i}.myshopify.com`);const o=`https://${i}/api/${P_e}/graphql.json`;try{const u=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-Shopify-Storefront-Access-Token":e},body:JSON.stringify({query:n,variables:r})});if(!u.ok){let h;try{h=await u.json()}catch{}const f=((c=(l=h==null?void 0:h.errors)==null?void 0:l[0])==null?void 0:c.message)||`Shopify API request failed: ${u.status} ${u.statusText}`;throw console.error("Shopify API Error:",h||u.statusText),new Error(f)}const d=await u.json();if(d.errors)throw console.error("Shopify GraphQL Errors:",d.errors),new Error(d.errors.map(h=>h.message).join(", "));return d.data}catch(u){throw console.error("Error fetching from Shopify Storefront API:",u),u}},A_e=`
  query GetShopMetadata {
    shop {
      name
      description 
      primaryDomain {
        host
        url
      }
      brand {
        logo {
          image { # Reverted to use image field
            url
            altText
          }
        }
        squareLogo { # Added, assuming similar structure
          image {
            url
            altText # Assuming altText is available, can be removed if not
          }
        }
        coverImage {
          image { # Reverted to use image field
            url
            altText
          }
        }
        slogan
        shortDescription # Added
        colors {
          primary {
            background
            foreground
          }
          secondary {
            background
            foreground
          }
        }
      }
    }
  }
`,k_e=`
  query GetProducts($first: Int = 10, $cursor: String) {
    products(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description # Changed from descriptionHtml
          handle
          tags
          images(first: 5) { # Changed from first: 1
            edges {
              node {
                url
                altText
              }
            }
          }
          variants(first: 5) { # Changed from first: 1
            edges {
              node {
                id # Added for variants
                title # Added for variants
                availableForSale # Added
                sku # Added from debug guide example
                price: priceV2 { # Changed from priceRange.minVariantPrice to priceV2, aliased to price
                    amount
                    currencyCode
                }
                image {
                   url
                   altText
                }
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,R_e=`
  query GetCollections($first: Int = 10, $cursor: String) {
    collections(first: $first, after: $cursor) {
      edges {
        node {
          id
          title
          description
          handle
          products(first: 5) { # Example: fetch first 5 products in each collection
            edges {
              node {
                id
                title
              }
            }
          }
        }
      }
      pageInfo {
        hasNextPage
        endCursor
      }
    }
  }
`,j_e=`
  query GetLocalizationInfo @inContext(country: "US") { # Defaulting to US, can be parameterized
    localization {
      availableCountries {
        isoCode
        name
        currency {
          isoCode
          name
          symbol
        }
      }
      availableLanguages {
        isoCode
        name
        endonymName
      }
    }
  }
`,_f=()=>["#3B82F6","#8B5CF6","#EC4899","#10B981","#F59E0B","#EF4444","#6366F1","#14B8A6","#F97316"][Math.floor(Math.random()*9)],kA=()=>["Inter","Roboto","Poppins","Montserrat","Open Sans"][Math.floor(Math.random()*5)],RA=()=>["grid","list"][Math.floor(Math.random()*2)],D_e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>{e({base64:r.result,mimeType:t.type,name:t.name})},r.onerror=s=>n(s)}),M_e=async(t,e,n,r,{fetchPexelsImages:s=lo,generateId:i=Pt}={})=>{const o=[],l={fashion:{min:20,max:200},electronics:{min:50,max:1300},food:{min:5,max:50},jewelry:{min:100,max:1e3},general:{min:10,max:300}},c=l[t]||l.general,u={fashion:["Classic Tee","Urban Jeans","Silk Scarf","Leather Boots","Summer Dress","Knit Sweater"],electronics:["HD Webcam","Noise-Cancelling Buds","Smart Display","Gaming Pad","Portable Drive","VR Headset"],food:["Artisan Bread","Gourmet Cheese","Organic Berries","Craft Coffee","Spiced Nuts","Dark Chocolate Bar"],jewelry:["Pearl Necklace","Sapphire Ring","Gold Hoops","Charm Bracelet","Silver Cufflinks","Diamond Studs"],general:["Utility Tool","Desk Organizer","Travel Mug","Yoga Mat","Scented Candle","Board Game"]},h=[...u[t]||u.general].sort(()=>.5-Math.random()).slice(0,e),f=h.map(g=>`${t} ${g} product shot`),m=await s(f.join(";"),e,"square");for(let g=0;g<e;g++){const x=h[g],w=m[g];let v;if(w&&w.src&&w.src.medium&&r)try{console.log(`[generateAIProductsData] Overlaying logo on Pexels image: ${w.src.medium}`),v=await overlayLogoOnProductImage(w.src.medium,r)}catch(_){console.error(`[generateAIProductsData] Failed to overlay logo on ${w.src.medium}, using original.`,_),v=w.src.medium}else w&&w.src&&w.src.medium?v=w.src.medium:v=`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(x)}`;o.push({id:`product-ai-${i()}`,name:x,price:parseFloat((Math.random()*(c.max-c.min)+c.min).toFixed(2)),description:Gse(t,x),rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,image:{id:w&&w.id||i(),src:{medium:v},alt:w&&w.alt||`Product image for ${x}`},storeName:n})}return o},L_e=async(t,{fetchPexelsImages:e=lo,generateId:n=Pt}={})=>{var T,R,k,E,I,P,A,D,j,M,z,U,K;const r=`store-wizard-${n()}`,{productType:s,storeName:i,logoUrl:o,products:l,prompt:c}=t;let u=[];(l.source==="ai"||l.source==="printOnDemand"||l.source==="manual")&&(u=l.items.map(q=>({id:q.id||`product-wizard-${n()}`,name:q.name,price:parseFloat(q.price)||0,description:q.description||"",images:q.images&&q.images.length>0?q.images:[`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(q.name||"Product")}`],image:{id:n(),src:{medium:q.images&&q.images.length>0?q.images[0]:`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(q.name||"Product")}`},alt:q.name||"Product Image"},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,isPrintOnDemand:q.isPrintOnDemand||!1,podDetails:q.podDetails||null,variants:q.variants||[]})));const d=3,h=await e(`${s} ${i} hero slideshow ${c}`,d,"landscape"),f=h.length>0?h[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},m=await $a(`${s} ${i} store ambiance ${c}`,1,"landscape"),g=await NI(s,i,c),x=await $a(g.featuresVideoQuery,1,"landscape");g.featuresVideoUrl=((T=x[0])==null?void 0:T.url)||null;const w=await e(`${i} ${s} abstract background`,1,"landscape"),v=((k=(R=w[0])==null?void 0:R.src)==null?void 0:k.large)||((I=(E=w[0])==null?void 0:E.src)==null?void 0:I.original)||"",_="v1";let C={...g,heroSlideshowImages:h.map(q=>({src:q.src.large,alt:q.alt||i+" hero image"})),...((P=t.content)==null?void 0:P.hero)&&{heroTitle:t.content.hero.heroTitle||g.heroTitle,heroDescription:t.content.hero.heroDescription||g.heroDescription},...((A=t.content)==null?void 0:A.storeWay)&&{storeWay:t.content.storeWay},imageRightSection:null,videoLeftSection:null};if(t.template_version==="sharp"){u.slice(0,3).map(O=>O.name).join(", ");const q={name:i,niche:s,description:c||`A ${s} store called ${i}`},W=await y3(q);if(W&&!W.error){const O=W.title||`${i} craftsmanship`,V=await e(O,1,"landscape");C.imageRightSection={...W,imageUrl:((j=(D=V[0])==null?void 0:D.src)==null?void 0:j.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const te=await x3(q);if(te&&!te.error){const O=te.title||`${i} product action`,V=await $a(O,1,"landscape");C.videoLeftSection={...te,videoUrl:((M=V[0])==null?void 0:M.url)||null,videoPosterUrl:((z=V[0])==null?void 0:z.image)||null}}}return{id:r,name:i,template_version:_,type:s,niche:s,description:C.heroDescription||g.heroDescription,prompt:c||`A ${s} store called ${i}`,products:u,collections:t.collections.items.map(q=>({id:q.id||`collection-wizard-${n()}`,name:q.name,description:q.description,imageUrl:q.imageUrl,product_ids:q.product_ids||[]})),hero_image:f,content:C,hero_video_url:((U=m[0])==null?void 0:U.url)||null,hero_video_poster_url:((K=m[0])==null?void 0:K.image)||null,logo_url:t.logoUrlDark||t.logoUrlLight||`https://via.placeholder.com/100x100.png?text=${i.substring(0,1)}`,logo_url_light:t.logoUrlLight||null,logo_url_dark:t.logoUrlDark||null,theme:{primaryColor:_f(),secondaryColor:_f(),fontFamily:kA(),layout:RA()},data_source:"wizard",card_background_url:v}},XS=async(t,{storeNameOverride:e=null,nicheDetails:n=null,isPrintOnDemand:r=!1,isDropshipping:s=!1,contextFiles:i=[],contextURLs:o=[],generateProducts:l=!0,fetchPexelsImages:c=lo,generateId:u=Pt}={},d=(h,f)=>{console.log(`Progress: ${h}%, Message: ${f||"(no message)"}`)})=>{var fe,je,ie,$e,me,Ue,et,ct,Mt,Sn,en,rn,kt,xn;const h=(re,Se)=>{typeof re=="number"&&!isNaN(re)?d(re,Se):Se&&d(void 0,Se)};h(0,"Initializing store generation...");const f=`store-ai-${u()}`;let m=t,g=null,x=null;if(o&&o.length>0&&o.some(re=>re.trim()!=="")){h(2,"Analyzing context URLs...");try{const re=await N_e(o.filter(Se=>Se.trim()!==""));re?(m=`${t}

--- AI URL Analysis Context ---
${re}`,h(5,"URL analysis complete.")):h(5,"URL analysis did not return content.")}catch(re){console.error("[generateStoreFromPromptData] Error during URL analysis:",re),h(5,"URL analysis failed, continuing with prompt.")}}const w=i.filter(re=>re.type.startsWith("image/"));if(w.length>0){h(5,"Analyzing context images...");try{const re=w.map(D_e),Se=await Promise.all(re);g=await YG(Se),g&&!g.error?(console.log("[generateStoreFromPromptData] Image analysis successful:",g),h(10,"Image analysis complete."),m+=`

--- AI Image Analysis Context ---
${g.storePrompt}`,x=g.productType):(console.warn("[generateStoreFromPromptData] Image analysis failed or returned an error:",g==null?void 0:g.error),h(10,"Image analysis failed, continuing with prompt."))}catch(re){console.error("[generateStoreFromPromptData] Error during image analysis preparation:",re),h(10,"Image analysis failed, continuing with prompt.")}}const v=i.filter(re=>!re.type.startsWith("image/"));v.length>0&&(m+=`

--- Additional Context Files ---
`+v.map(re=>re.name).join(`
`));const _=m.toLowerCase().split(" ");let C="general";x?C=x:n&&n.name?C=n.name.toLowerCase().replace(/ /g,"-")||"general":_.some(re=>["clothing","fashion","apparel","wear"].includes(re))?C="fashion":_.some(re=>["tech","electronics","gadget","digital"].includes(re))?C="electronics":_.some(re=>["food","grocery","meal","organic"].includes(re))?C="food":_.some(re=>["jewelry","accessory","watch","luxury"].includes(re))&&(C="jewelry");let T=e,R=null;if(!T&&g&&g.storeNameSuggestions&&g.storeNameSuggestions.length>0&&(T=g.storeNameSuggestions[0],console.log(`[generateStoreFromPromptData] Using store name from image analysis: "${T}"`)),!T)try{R=await Fse(t),R&&(T=R,console.log(`[generateStoreFromPromptData] Extracted store name via Gemini Function Calling: "${T}" (Raw response: "${R}")`))}catch(re){console.error("[generateStoreFromPromptData] Error during Gemini function call for name extraction:",re)}if(!T)try{console.log(`[generateStoreFromPromptData] No name from override or function call. Attempting AI name suggestion using prompt: "${t}"`),h(void 0,"Suggesting store names...");const re=await TI(t);if(re&&re.suggestions&&re.suggestions.length>0)T=re.suggestions[0],console.log(`[generateStoreFromPromptData] AI generated store name: ${T}`);else{console.warn("[generateStoreFromPromptData] AI name generation yielded no suggestions. Falling back to heuristic.");const Se=t.split(" ").filter(B=>B.charAt(0)===B.charAt(0).toUpperCase()&&B.length>2);Se.length>0&&(T=Se[0])}}catch(re){console.error("[generateStoreFromPromptData] Error during AI store name generation:",re);const Se=t.split(" ").filter(B=>B.charAt(0)===B.charAt(0).toUpperCase()&&B.length>2);Se.length>0&&(T=Se[0])}T||(T=`${C.charAt(0).toUpperCase()+C.slice(1)} Emporium ${u().substring(0,4)}`,console.log(`[generateStoreFromPromptData] Using final fallback store name: ${T}`)),T&&T.length>50&&(T=T.substring(0,50));let k=null,E=null,I=null,P=`https://via.placeholder.com/100x100.png?text=${T.substring(0,1)}`;try{console.log(`[generateStoreFromPromptData] Generating logo for: ${T}`),h(10,`Generating logo for ${T}...`);const re=(g==null?void 0:g.logoDescription)||m,Se=await kg(re,h);if(Se){E=Se.logoUrlLight,I=Se.logoUrlDark,I?P=I:E&&(P=E);const B=E||I;if(B&&B.startsWith("data:image/")){const X=B.split(",");X.length===2&&(k=X[1])}console.log(`[generateStoreFromPromptData] Logos generated for ${T}. Light: ${!!E}, Dark: ${!!I}`),d(20,`${T} logo generated.`)}else console.warn(`[generateStoreFromPromptData] Logo generation did not return expected result for ${T}.`),h(20,`Logo generation issue for ${T}.`)}catch(re){console.error(`[generateStoreFromPromptData] Error generating logo for ${T}:`,re),h(20,`Error generating logo for ${T}.`)}h(25,`Generating ${C} products...`);const A=[],D=[],j=25,M=45;if(l)if(g&&g.products&&g.products.length>0)console.log("[generateStoreFromPromptData] Using products from image analysis."),h(25,"Populating products from image analysis..."),g.products.forEach(re=>{A.push({id:`product-img-analysis-${u()}`,name:re.name,price:parseFloat(re.price)||0,description:re.description,images:re.images,image:{id:u(),src:{medium:re.images[0]},alt:re.name},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,variants:[]}),D.push(re.name.toLowerCase().trim())}),h(j+M,`${A.length} products populated from analysis.`);else{let B=0;for(console.log(`[generateStoreFromPromptData] Attempting to generate 6 unique products for ${T} (type: ${C}).`);A.length<6&&B<12;){B++;const X=j+Math.floor(A.length/6*M);h(X,`Generating product ${A.length+1}/6...`);try{console.log(`[generateStoreFromPromptData] Generating product attempt ${B} (aiming for ${A.length+1}/6 unique products)... Excluding titles: ${D.join(", ")}`);const ne=await qG(C,T,k,"image/png",D,h,X,M/6,m);if(ne&&ne.images&&ne.images.length>0&&ne.title&&ne.title.trim()!==""&&typeof ne.price=="string"&&typeof ne.description=="string"){const Y=ne.title.toLowerCase().trim();if(D.includes(Y))console.warn(`[generateStoreFromPromptData] Duplicate product title generated and skipped: "${ne.title}". Attempt ${B}/12.`);else{let Ne=ne.variants||[];if(C==="fashion"){const ce=Ne.some(Re=>Re.name.toLowerCase()==="size"),Ee=Ne.some(Re=>Re.name.toLowerCase()==="color");ce||Ne.push({name:"Size",values:["S","M","L","XL"]}),Ee||Ne.push({name:"Color",values:["White","Black","Blue","Red"]})}A.push({id:`product-gemini-${u()}`,name:ne.title,price:parseFloat(ne.price)||0,description:ne.description,images:ne.images,image:{id:u(),src:{medium:ne.images[0]},alt:ne.title},rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*80)+20,variants:Ne}),D.push(Y),console.log(`[generateStoreFromPromptData] Product "${ne.title}" generated successfully and is unique. (${A.length}/6)`),h(j+Math.floor(A.length/6*M),`Product "${ne.title}" generated.`)}}else console.warn(`[generateStoreFromPromptData] Failed to generate complete data (or image) for product attempt ${B}. Data:`,ne)}catch(ne){console.error(`[generateStoreFromPromptData] Error during product generation attempt ${B}:`,ne)}}h(j+M,`${A.length} products generated.`),A.length<6&&console.warn(`[generateStoreFromPromptData] Could only generate ${A.length} unique products after 12 total attempts.`),A.length===0&&6>0&&console.warn("[generateStoreFromPromptData] No products were generated successfully. The store will be created with an empty product list.")}const z=3,U=await c(`${C} ${T} hero slideshow ${t}`,z,"landscape"),K=U.length>0?U[0]:{src:{large:"https://via.placeholder.com/1200x800.png?text=Hero+Image"},alt:"Placeholder Hero Image"},W=(await v3({name:T,niche:C,description:m})).query||`${C} ${T} store ambiance ${t}`,te=await $a(W,1,"landscape"),O=await $a(`${T} ${C} product showcase`,1,"landscape");await $a(`${T} ${C} craftsmanship process`,1,"landscape");const V={name:T,niche:C,description:m},H=await p3(V),L=await g3(V),ee=await II(V),pe=await NI(C,T,m),xe=await c(`${T} ${C} store background`,1,"landscape"),we=((je=(fe=xe[0])==null?void 0:fe.src)==null?void 0:je.large)||(($e=(ie=xe[0])==null?void 0:ie.src)==null?void 0:$e.original)||"";let Ie="fresh";if(n&&n.templates&&n.templates.length>0){const re=n.templates.some(Se=>Se.toLowerCase()==="sharp");if(C==="technology"&&re)Ie="sharp";else{const Se=n.templates[0].toLowerCase();["classic","modern","v1"].includes(Se)?Ie="v1":Se==="premium"?Ie="premium":Se==="sharp"?Ie="sharp":Se==="sleek"&&(Ie="sleek")}}else t.toLowerCase().includes("modern")?Ie="v1":t.toLowerCase().includes("premium")?Ie="premium":t.toLowerCase().includes("sharp")?Ie="sharp":t.toLowerCase().includes("sleek")&&(Ie="sleek");Ie==="modern"&&(Ie="v1");let Fe={url:null,poster:null};if(Ie==="v2"){const re=await $a(`${T} ${C} customer experience why choose us`,1,"landscape");Fe.url=((me=re[0])==null?void 0:me.url)||null,Fe.poster=((Ue=re[0])==null?void 0:Ue.image)||null}const Ve=[];h(95,"Loading storefront...");let Ge={id:f,name:T,template_version:Ie,type:C,niche:C,description:H&&!H.error?H.heroDescription:pe.heroDescription,prompt:m,products:A,collections:Ve,hero_image:K,hero_video_url:((et=te[0])==null?void 0:et.url)||null,hero_video_poster_url:((ct=te[0])==null?void 0:ct.image)||null,logo_url:P,logo_url_light:E,logo_url_dark:I,theme:{primaryColor:(n==null?void 0:n.primaryColor)||(await _2(V)).primaryColor||_f(),secondaryColor:(n==null?void 0:n.secondaryColor)||(await _2(V)).secondaryColor||_f(),fontFamily:kA(),layout:RA()},content:{...pe,...H&&!H.error&&{heroTitle:H.heroTitle||pe.heroTitle,heroDescription:H.heroDescription||pe.heroDescription},...L&&!L.error&&{storeWay:L},...ee&&!ee.error&&{storeFeatures:ee},heroSlideshowImages:U.map(re=>({src:re.src.large,alt:re.alt||T+" hero image"})),imageRightSection:null,videoLeftSection:null},data_source:"ai",card_background_url:we};if(Ie==="sharp"){A.slice(0,3).map(B=>B.name).join(", ");const re=await y3(V);if(re&&!re.error){const B=re.title||`${T} craftsmanship`,X=await c(B,1,"landscape");Ge.content.imageRightSection={...re,imageUrl:((Sn=(Mt=X[0])==null?void 0:Mt.src)==null?void 0:Sn.large)||"https://images.pexels.com/photos/3184418/pexels-photo-3184418.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1"}}const Se=await x3(V);if(Se&&!Se.error){const B=Se.title||`${T} product action`,X=await $a(B,1,"landscape");Ge.content.videoLeftSection={...Se,videoUrl:((en=X[0])==null?void 0:en.url)||null,videoPosterUrl:((rn=X[0])==null?void 0:rn.image)||null}}Ge.content.heroFollowUpVideoUrl=((kt=O[0])==null?void 0:kt.url)||null,Ge.content.heroFollowUpVideoPosterUrl=((xn=O[0])==null?void 0:xn.image)||null}else Ie==="fresh"&&(Ge.content.featuresVideoUrl=Fe.url,Ge.content.featuresVideoPosterUrl=Fe.poster);return Ie!=="sharp"&&(Ge.content.heroFollowUpVideoUrl=null,Ge.content.heroFollowUpVideoPosterUrl=null),Ie!=="fresh"&&(Ge.content.featuresVideoUrl=null,Ge.content.featuresVideoPosterUrl=null),Ge},QS=async(t,e,n,r,s,i,o,l,c)=>{var d,h;const u=[];if(n.length>0){const f=r||s?3:2,m=[],g=f*2;let x=0;for(i(o,"Generating collections for products..."),console.log(`[generateCollectionsForProducts] Attempting to generate ${f} collections for ${e}.`);u.length<f&&x<g;){x++;const w=o+Math.floor((u.length+1)/f*l);i(w,`Generating collection ${u.length+1}/${f} (Attempt ${x})...`);try{const v=await KG(t,e,n,m,i,w,l/f);if(v&&!v.error&&v.name){let _="";if(v.imageData)_=`data:image/png;base64,${v.imageData}`;else{const C=`${v.name} ${t} collection banner`;_=((h=(d=(await lo(C,1,"landscape"))[0])==null?void 0:d.src)==null?void 0:h.large)||`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(v.name||"Collection")}`}u.push({id:`collection-gemini-${c()}`,name:v.name,description:v.description,imageUrl:_,product_ids:v.product_ids||[]}),m.push(v.name),i(w,`Collection "${v.name}" generated.`)}else console.warn(v===null?`[generateCollectionsForProducts] Collection generation returned null (fallback prevented), attempt ${x}.`:`[generateCollectionsForProducts] Failed to generate complete data for collection attempt ${x}. Error: ${v==null?void 0:v.error}`)}catch(v){console.error(`[generateCollectionsForProducts] Error during collection generation attempt ${x}:`,v)}}i(o+l,`${u.length} collections generated.`)}else console.warn(`[generateCollectionsForProducts] Skipping collection generation as no products were provided for ${e}.`),i(o+l,"Skipped collection generation (no products).");return u},F_e=async(t,e)=>(await Qb(t,e,A_e)).shop,O_e=async(t,e,n=10,r=null)=>(await Qb(t,e,R_e,{first:n,cursor:r})).collections,$_e=async(t,e,n=10,r=null)=>(await Qb(t,e,k_e,{first:n,cursor:r})).products,V_e=async(t,e,n="US",r="EN")=>(await Qb(t,e,j_e,{})).localization,U_e=async(t,e,n,{generateId:r=Pt}={},s=null)=>{var h,f,m,g,x,w,v,_,C,T,R;console.log("Mapping BigCommerce Data:",{bcStoreSettings:t,bcProducts:e,domain:n,generatedLogoDataUrl:s});const i=e.map(k=>{var E,I,P,A,D,j,M;return{id:((E=k.entityId)==null?void 0:E.toString())||`bc-product-${r()}`,name:k.name||"Unnamed Product",description:k.description||`Product: ${k.name||"Unnamed Product"}`,price:parseFloat(((P=(I=k.prices)==null?void 0:I.price)==null?void 0:P.value)||0),currencyCode:((D=(A=k.prices)==null?void 0:A.price)==null?void 0:D.currencyCode)||"USD",image:{id:`bc-img-${r()}`,src:{medium:((j=k.defaultImage)==null?void 0:j.url)||`https://via.placeholder.com/400x400.png?text=${encodeURIComponent(k.name||"Product")}`},alt:((M=k.defaultImage)==null?void 0:M.altText)||k.name||"Product Image"},sku:k.sku||"",rating:(Math.random()*1.5+3.5).toFixed(1),stock:Math.floor(Math.random()*100)+10}}),o=s||((f=(h=t.logo)==null?void 0:h.image)==null?void 0:f.url)||`https://via.placeholder.com/100x100.png?text=${(t.storeName||"S").substring(0,1)}`,l=await NI("general",t.storeName||"My BigCommerce Store",t.description),c=await $a(l.featuresVideoQuery,1,"landscape");l.featuresVideoUrl=((m=c[0])==null?void 0:m.url)||null;const u=await lo(`${t.storeName||"store"} background`,1,"landscape"),d=((x=(g=u[0])==null?void 0:g.src)==null?void 0:x.large)||((v=(w=u[0])==null?void 0:w.src)==null?void 0:v.original)||"";return{id:`store-bc-${(t.storeHash||n).replace(/[\.\/\:]/g,"-")}-${r()}`,name:t.storeName||"My BigCommerce Store",type:"bigcommerce-imported",description:t.description||`Store imported from ${n}`||l.heroDescription,products:i,hero_image:{id:r(),src:{large:((C=(_=t.logo)==null?void 0:_.image)==null?void 0:C.url)||`https://via.placeholder.com/1200x800.png?text=${encodeURIComponent(t.storeName||"Store")}`},alt:((R=(T=t.logo)==null?void 0:T.image)==null?void 0:R.altText)||t.storeName||"Store Hero"},logo_url:o,theme:{primaryColor:_f(),secondaryColor:_f(),fontFamily:kA(),layout:RA()},content:{...l,heroTitle:`Welcome to ${t.storeName||"Our Store"}`,heroDescription:t.description||l.heroDescription},data_source:"bigcommerce",card_background_url:d}};async function B_e(t,e){const n=`
    query StoreSettings {
      site {
        settings {
          storeName
          storeHash
          status
          logo {
            title
            image {
              url(width: 500)
              altText
            }
          }
        }
      }
    }
  `;if(typeof t!="string"||!t.trim()){const i=new TypeError("Invalid or empty storeDomain provided to fetchStoreSettings.");throw console.error(i.message,{storeDomain:t}),i}if(typeof e!="string"||!e.trim()){const i=new TypeError("Invalid or empty token provided to fetchStoreSettings.");throw console.error(i.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),i}const r=`https://${t}/graphql`,s={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})};console.log(`[fetchStoreSettings] Attempting to fetch: ${r}`,{domain:t,tokenProvided:!!e,queryLength:n.length});try{let i;try{i=await fetch(r,s)}catch(l){console.error(`[fetchStoreSettings] Initial fetch to ${r} failed:`,l);let c=`Initial fetch to ${r} failed.`;throw l.name==="TypeError"?c+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${l.message}`:c+=` Error: ${l.message||"Unknown network error"}`,new Error(c)}if(console.log(`[fetchStoreSettings] Response from ${r} - Status: ${i.status}, Complexity: ${i.headers.get("X-Bc-GraphQL-Complexity")}`),!i.ok){let l=`Could not retrieve error body (status: ${i.status}).`;try{l=await i.text()}catch(c){console.warn("Failed to read error response body:",c)}throw new Error(`HTTP error ${i.status} for ${r}: ${l}`)}let o;try{o=await i.json()}catch(l){let c="Could not retrieve raw response text after JSON parse failure.";try{c=await(await fetch(r,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:n})})).text()}catch(u){console.warn("Failed to re-fetch for raw text:",u)}throw console.error("Failed to parse JSON response from BigCommerce.",l,{graphqlUrl:r,rawTextPreview:c.substring(0,500)}),new Error(`Failed to parse JSON response from ${r}. Preview: ${c.substring(0,200)}...`)}if(o.errors)throw console.error("BigCommerce GraphQL errors (fetchStoreSettings):",o.errors,{graphqlUrl:r}),new Error(`GraphQL error: ${o.errors.map(l=>l.message).join(", ")}`);if(!o.data||!o.data.site||!o.data.site.settings)throw console.error("Invalid data structure in BigCommerce response (fetchStoreSettings):",o.data,{graphqlUrl:r}),new Error("Invalid data structure received from BigCommerce API for store settings.");return o.data.site.settings}catch(i){throw i.message.startsWith("Invalid or empty storeDomain")||i.message.startsWith("Invalid or empty token")||i.message.startsWith("HTTP error")||i.message.startsWith("GraphQL error")||i.message.startsWith("Failed to parse JSON")||i.message.startsWith("Network error")||console.error(`[fetchStoreSettings] Unexpected error for ${r}:`,i.name,i.message,i.stack,i),i}}async function DL(t,e){var l,c;let n=[],r=null,s=!0;if(typeof t!="string"||!t.trim()){const u=new TypeError("Invalid or empty storeDomain provided to fetchAllProducts.");throw console.error(u.message,{storeDomain:t}),u}if(typeof e!="string"||!e.trim()){const u=new TypeError("Invalid or empty token provided to fetchAllProducts.");throw console.error(u.message,{tokenProvided:typeof e=="string"&&e.length>0?"Yes":"No"}),u}const i=`https://${t}/graphql`,o=`
    query ProductsPage($first: Int!, $after: String) {
      site {
        products(first: $first, after: $after) {
          pageInfo {
            hasNextPage
            endCursor
          }
          edges {
            node {
              entityId
              name
              sku
              defaultImage {
                url(width: 800)
                altText
              }
              prices {
                price { value currencyCode }
                retailPrice { value currencyCode }
              }
            }
          }
        }
      }
    }
  `;console.log(`[fetchAllProducts] Starting to fetch products from: ${i}`,{domain:t,tokenProvided:!!e});try{let u=1;for(;s;){const d={first:50,after:r},h={method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${e}`,Accept:"application/json"},body:JSON.stringify({query:o,variables:d})};let f;try{f=await fetch(i,h)}catch(x){console.error(`[fetchAllProducts] Initial fetch (Page ${u}) to ${i} failed:`,x);let w=`Initial fetch (Page ${u}) to ${i} failed.`;throw x.name==="TypeError"?w+=` This is often due to a CORS misconfiguration (check 'allowed_cors_origins' for your BigCommerce Storefront API token), a DNS issue, or the server not being reachable. Please check the browser's Network DevTools for more specific error messages. Original error: ${x.message}`:w+=` Error: ${x.message||"Unknown network error"}`,new Error(w)}if(console.log(`[fetchAllProducts] Response (Page ${u}) from ${i} - Status: ${f.status}, Complexity: ${f.headers.get("X-Bc-GraphQL-Complexity")}`),u++,!f.ok){let x=`Could not retrieve error body (status: ${f.status}).`;try{x=await f.text()}catch(w){console.warn("[fetchAllProducts] Failed to read error response body:",w)}throw new Error(`HTTP error ${f.status} for ${i} (products): ${x}`)}let m;try{m=await f.json()}catch(x){let w="Could not retrieve raw response text after JSON parse failure (fetchAllProducts).";try{w=await(await fetch(i,h)).text()}catch{}throw console.error("[fetchAllProducts] Failed to parse JSON response from BigCommerce.",x,{graphqlUrl:i,rawTextPreview:w.substring(0,500)}),new Error(`Failed to parse JSON response from ${i} (products). Preview: ${w.substring(0,200)}...`)}if(m.errors)throw console.error("[fetchAllProducts] BigCommerce GraphQL errors:",m.errors,{graphqlUrl:i}),new Error(`GraphQL error (products): ${m.errors.map(x=>x.message).join(", ")}`);const g=(c=(l=m.data)==null?void 0:l.site)==null?void 0:c.products;if(!g||!g.edges||!g.pageInfo)throw console.error("[fetchAllProducts] Invalid data structure in BigCommerce response:",m.data,{graphqlUrl:i}),new Error("Invalid data structure received from BigCommerce API for products.");g.edges.forEach(x=>n.push(x.node)),s=g.pageInfo.hasNextPage,r=g.pageInfo.endCursor}return n}catch(u){throw u.message.startsWith("Invalid or empty storeDomain")||u.message.startsWith("Invalid or empty token")||u.message.startsWith("HTTP error")||u.message.startsWith("GraphQL error")||u.message.startsWith("Failed to parse JSON")||u.message.startsWith("Network error")||console.error(`[fetchAllProducts] Unexpected error for ${i}:`,u.name,u.message,u.stack,u),u}}const Ke=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("rounded-xl border bg-card text-card-foreground shadow-sm",t),...e}));Ke.displayName="Card";const at=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("flex flex-col space-y-1.5 p-6",t),...e}));at.displayName="CardHeader";const lt=ht.forwardRef(({className:t,...e},n)=>a.jsx("h3",{ref:n,className:bt("text-2xl font-semibold leading-none tracking-tight",t),...e}));lt.displayName="CardTitle";const Kt=ht.forwardRef(({className:t,...e},n)=>a.jsx("p",{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));Kt.displayName="CardDescription";const st=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("p-6 pt-0",t),...e}));st.displayName="CardContent";const vd=ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("flex items-center p-6 pt-0",t),...e}));vd.displayName="CardFooter";const z_e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),G_e=({isOpen:t,onClose:e,products:n,onFinalize:r})=>{const[s,i]=p.useState([]),[o,l]=p.useState(!1),[c,u]=p.useState({}),[d,h]=p.useState({}),[f,m]=p.useState(null),[g,x]=p.useState(!1),{toast:w}=Ss(),{generatePodCollectionFromDesign:v,addPendingPodCollectionData:_,isGeneratingPodCollection:C,currentStore:T,isGenerating:R}=$n();p.useEffect(()=>{n&&i(n.map(V=>{var L,ee,pe;let H=[];if(Array.isArray(V.images)?H=[...V.images]:(ee=(L=V.image)==null?void 0:L.src)!=null&&ee.medium&&(H=[V.image.src.medium]),V.isPrintOnDemand&&((pe=V.podDetails)!=null&&pe.originalDesignImageUrl)){const xe=H.findIndex(we=>we!==V.podDetails.originalDesignImageUrl);if(xe>0){const we=H.splice(xe,1)[0];H.unshift(we)}}return{...V,images:H,variants:Array.isArray(V.variants)?V.variants.map(xe=>({...xe,values:Array.isArray(xe.values)?[...xe.values]:[]})):[]}}))},[n]);const k=(V,H,L)=>{i(ee=>{const pe=[...ee];return pe[V]={...pe[V],[H]:L},pe})},E=async(V,H)=>{if(H)try{const L=await z_e(H);i(ee=>{const pe=[...ee],xe=Array.isArray(pe[V].images)?pe[V].images:[];return pe[V].images=[...xe,L],pe})}catch(L){console.error("Error converting file to base64:",L),w({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},I=(V,H)=>{i(L=>{const ee=[...L];return ee[V].images=ee[V].images.filter((pe,xe)=>xe!==H),ee})},P=async V=>{w({title:"Image Generation",description:"AI Image generation for this product is not yet implemented in this modal."}),console.log("Attempting to generate image for product at index:",V,s[V].name)},A=async V=>{const H=s[V];if(!H||!H.name){w({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const L=H.images&&H.images.length>0?H.images[0]:null;if(!L){w({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}u(ee=>({...ee,[V]:!0}));try{const{base64ImageData:ee,mimeType:pe}=await dg(L),xe=H.name;let we=[];try{const Fe=await K0(ee,pe,xe);Fe&&Fe.length>0&&we.push(...Fe.slice(0,2)),w({title:"Angles Generated",description:`${Math.min(2,(Fe==null?void 0:Fe.length)||0)} angle images generated.`,variant:"success"})}catch(Fe){console.error("Error generating angles:",Fe),w({title:"Angle Generation Failed",description:Fe.message,variant:"destructive"})}const Ie=[`Place this product, "${xe}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${xe}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const Fe of Ie)try{const Ve=await Wo(ee,pe,Fe);Ve&&Ve.editedImageData&&we.push(`data:${Ve.newMimeType};base64,${Ve.editedImageData}`)}catch(Ve){console.error(`Error generating context image with prompt "${Fe}":`,Ve),w({title:"Context Image Failed",description:`Failed for: ${Fe.substring(0,30)}...`,variant:"destructive"})}w({title:"Context Images Attempted",description:`Attempted to generate ${Ie.length} context images.`,variant:"success"}),we.length>0?i(Fe=>{const Ve=[...Fe],Ge=Ve[V],fe=Array.isArray(Ge.images)?Ge.images:[],je=new Set(fe),ie=we.filter($e=>!je.has($e));return ie.length>0?(Ge.images=[...fe,...ie],w({title:"Visuals Added",description:`${ie.length} new images added.`,variant:"success"})):w({title:"Visuals Generated",description:"Generated images were already present.",variant:"default"}),Ve}):w({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"})}catch(ee){console.error("Error in handleGenerateMoreVisuals:",ee),w({title:"Visual Generation Error",description:ee.message,variant:"destructive"})}finally{u(ee=>({...ee,[V]:!1}))}},D=(V,H,L)=>{i(ee=>{const pe=[...ee],xe={...pe[V]};return xe.variants=[...xe.variants||[]],xe.variants[H]={...xe.variants[H],name:L},pe[V]=xe,pe})},j=(V,H,L,ee)=>{i(pe=>{const xe=[...pe],we={...xe[V]};we.variants=[...we.variants||[]];const Ie={...we.variants[H]};return Ie.values=[...Ie.values||[]],Ie.values[L]=ee,we.variants[H]=Ie,xe[V]=we,xe})},M=(V,H)=>{i(L=>{const ee=[...L],pe={...ee[V]};pe.variants=[...pe.variants||[]];const xe={...pe.variants[H]};return xe.values=[...xe.values||[],""],pe.variants[H]=xe,ee[V]=pe,ee})},z=(V,H,L)=>{i(ee=>{const pe=[...ee],xe={...pe[V]};xe.variants=[...xe.variants||[]];const we={...xe.variants[H]};return we.values=(we.values||[]).filter((Ie,Fe)=>Fe!==L),xe.variants[H]=we,pe[V]=xe,pe})},U=V=>{i(H=>{const L=[...H],ee={...L[V]};return ee.variants=[...ee.variants||[],{name:"",values:[""]}],L[V]=ee,L})},K=(V,H)=>{i(L=>{const ee=[...L],pe={...ee[V]};return pe.variants=(pe.variants||[]).filter((xe,we)=>we!==H),ee[V]=pe,ee})},q=()=>{if(!s.every(H=>H.name&&H.name.trim()!==""&&(H.price||H.price===0)&&String(H.price).trim()!=="")){w({title:"Missing Information",description:"Please ensure all products have a name and a valid price.",variant:"destructive"});return}r(s)},W=V=>{m(V),x(!0)},te=async V=>{var we;const H=s[V];if(!H||!((we=H.podDetails)!=null&&we.originalDesignImageUrl)){w({title:"Error",description:"Product details or original design image missing for POD collection.",variant:"destructive"});return}const L=H.podDetails.originalDesignImageUrl,ee=H.podDetails.designPrompt||`Design based on ${H.name}`,pe=H.podDetails.baseProductName||H.name,xe=await v(L,ee,pe);xe&&xe.newProducts&&xe.newCollection?_({newProducts:xe.newProducts,newCollection:xe.newCollection}):console.error("POD Collection generation in modal failed or returned no data.")},O=async V=>{const H=s[V];if(!H||!H.name){w({title:"Missing Product Name",description:"Product name is required to generate a description.",variant:"destructive"});return}h(L=>({...L,[V]:!0}));try{const L={name:T==null?void 0:T.name,niche:T==null?void 0:T.niche,targetAudience:T==null?void 0:T.targetAudience,style:T==null?void 0:T.style},ee=await Ose(H,L);if(ee.description)k(V,"description",ee.description),w({title:"Description Generated",description:"The product description has been updated.",variant:"success"});else throw new Error(ee.error||"Failed to generate description.")}catch(L){console.error("Error generating product description:",L),w({title:"Description Generation Failed",description:L.message,variant:"destructive"})}finally{h(L=>({...L,[V]:!1}))}};return t?a.jsxs(a.Fragment,{children:[a.jsx(zr,{open:t,onOpenChange:V=>!V&&e(),children:a.jsxs(Dr,{className:"max-w-3xl",children:[a.jsxs(Mr,{children:[a.jsx(Lr,{children:"Finalize Your Products"}),a.jsx(_i,{children:"Review and edit the AI-generated products before creating your store."})]}),a.jsx(ws,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"space-y-6 pr-4",children:s.map((V,H)=>{var L;return a.jsxs(Ke,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:`productName-${H}`,children:"Product Name"}),a.jsx(qe,{id:`productName-${H}`,value:V.name,onChange:ee=>k(H,"name",ee.target.value),placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:`productPrice-${H}`,children:"Price (USD)"}),a.jsx(qe,{id:`productPrice-${H}`,type:"number",value:V.price,onChange:ee=>k(H,"price",ee.target.value),placeholder:"0.00"})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ke,{htmlFor:`productDescription-${H}`,children:"Description"}),a.jsx(Cn,{id:`productDescription-${H}`,value:V.description,onChange:ee=>k(H,"description",ee.target.value),placeholder:"Product Description",rows:3}),V.isDropshipping&&a.jsxs($,{type:"button",variant:"outline",size:"sm",className:"absolute bottom-2 right-2 text-xs h-7",onClick:()=>O(H),disabled:d[H]||!V.name,children:[d[H]?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate"]})]}),a.jsxs("div",{className:"space-y-2 mb-[3px]",children:[a.jsx(ke,{children:"Product Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(V.images||[]).map((ee,pe)=>a.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>W(ee),children:[a.jsx("img",{src:ee,alt:`Product ${H+1} image ${pe+1}`,className:"w-full h-full object-contain rounded-md border"}),a.jsx($,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>I(H,pe),children:a.jsx(Bn,{className:"h-3 w-3"})})]},pe))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${H}`).click(),children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsx(qe,{id:`productImageUpload-${H}`,type:"file",accept:"image/*",className:"hidden",onChange:ee=>E(H,ee.target.files[0])}),a.jsxs($,{type:"button",variant:"outline",size:"sm",onClick:()=>P(H),disabled:o||!V.name,children:[o?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs($,{type:"button",variant:"outline",size:"sm",onClick:()=>A(H),disabled:c[H]||!V.name||!V.images||V.images.length===0,children:[c[H]?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"More Angles/Context"]})]}),V.isPrintOnDemand&&((L=V.podDetails)==null?void 0:L.originalDesignImageUrl)&&a.jsxs($,{type:"button",variant:"outline",size:"sm",className:"mt-2 w-full",onClick:()=>te(H),disabled:c[H]||C,children:[C&&c[H]!==!0?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Jie,{className:"mr-2 h-4 w-4"}),"Create Full POD Collection"]})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(V.variants||[]).map((ee,pe)=>a.jsxs(Ke,{className:"p-2 space-y-2 bg-muted/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ke,{htmlFor:`variantName-${H}-${pe}`,className:"text-xs",children:"Option Name"}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>K(H,pe),className:"h-6 w-6",children:a.jsx(Bn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(qe,{id:`variantName-${H}-${pe}`,value:ee.name||"",onChange:xe=>D(H,pe,xe.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(ke,{className:"text-xs",children:"Option Values (comma-separated or add one by one)"}),(ee.values||[]).map((xe,we)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(qe,{value:xe||"",onChange:Ie=>j(H,pe,we,Ie.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>z(H,pe,we),className:"h-6 w-6",children:a.jsx(Bn,{className:"h-3 w-3 text-destructive"})})]},we)),a.jsxs($,{variant:"outline",size:"sm",onClick:()=>M(H,pe),className:"text-xs h-7",children:[a.jsx(Ui,{className:"mr-1 h-3 w-3"})," Add Value"]})]},pe)),a.jsxs($,{variant:"outline",onClick:()=>U(H),className:"w-full text-sm h-8",children:[a.jsx(Ui,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},V.id||H)})})}),a.jsxs(Nr,{children:[a.jsx(al,{asChild:!0,children:a.jsx($,{type:"button",variant:"outline",onClick:e,disabled:R,children:"Cancel"})}),a.jsxs($,{type:"button",onClick:q,disabled:R,children:[R?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Finalize and Create Store"]})]})]})}),g&&f&&a.jsx(zr,{open:g,onOpenChange:x,children:a.jsxs(Dr,{className:"max-w-xl max-h-[80vh]",children:[a.jsx(Mr,{children:a.jsx(Lr,{children:"Enlarged Image"})}),a.jsx("div",{className:"flex justify-center items-center p-4 max-h-[70vh]",children:a.jsx("img",{src:f,alt:"Enlarged product",className:"max-w-full max-h-full object-contain"})})]})})]}):null};function Tn(){return Tn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},Tn.apply(null,arguments)}function ML(t,[e,n]){return Math.min(n,Math.max(e,t))}function os(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function jA(t,e=[]){let n=[];function r(i,o){const l=p.createContext(o),c=n.length;n=[...n,o];function u(h){const{scope:f,children:m,...g}=h,x=(f==null?void 0:f[t][c])||l,w=p.useMemo(()=>g,Object.values(g));return p.createElement(x.Provider,{value:w},m)}function d(h,f){const m=(f==null?void 0:f[t][c])||l,g=p.useContext(m);if(g)return g;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return u.displayName=i+"Provider",[u,d]}const s=()=>{const i=n.map(o=>p.createContext(o));return function(l){const c=(l==null?void 0:l[t])||i;return p.useMemo(()=>({[`__scope${t}`]:{...l,[t]:c}}),[l,c])}};return s.scopeName=t,[r,W_e(s,...e)]}function W_e(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((l,{useScope:c,scopeName:u})=>{const h=c(i)[`__scope${u}`];return{...l,...h}},{});return p.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}function H_e(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function XG(...t){return e=>t.forEach(n=>H_e(n,e))}function $s(...t){return p.useCallback(XG(...t),t)}const hg=p.forwardRef((t,e)=>{const{children:n,...r}=t,s=p.Children.toArray(n),i=s.find(K_e);if(i){const o=i.props.children,l=s.map(c=>c===i?p.Children.count(o)>1?p.Children.only(null):p.isValidElement(o)?o.props.children:null:c);return p.createElement(ZT,Tn({},r,{ref:e}),p.isValidElement(o)?p.cloneElement(o,void 0,l):null)}return p.createElement(ZT,Tn({},r,{ref:e}),n)});hg.displayName="Slot";const ZT=p.forwardRef((t,e)=>{const{children:n,...r}=t;return p.isValidElement(n)?p.cloneElement(n,{...Y_e(r,n.props),ref:e?XG(e,n.ref):n.ref}):p.Children.count(n)>1?p.Children.only(null):null});ZT.displayName="SlotClone";const q_e=({children:t})=>p.createElement(p.Fragment,null,t);function K_e(t){return p.isValidElement(t)&&t.type===q_e}function Y_e(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...l)=>{i(...l),s(...l)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function J_e(t){const e=t+"CollectionProvider",[n,r]=jA(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=m=>{const{scope:g,children:x}=m,w=ht.useRef(null),v=ht.useRef(new Map).current;return ht.createElement(s,{scope:g,itemMap:v,collectionRef:w},x)},l=t+"CollectionSlot",c=ht.forwardRef((m,g)=>{const{scope:x,children:w}=m,v=i(l,x),_=$s(g,v.collectionRef);return ht.createElement(hg,{ref:_},w)}),u=t+"CollectionItemSlot",d="data-radix-collection-item",h=ht.forwardRef((m,g)=>{const{scope:x,children:w,...v}=m,_=ht.useRef(null),C=$s(g,_),T=i(u,x);return ht.useEffect(()=>(T.itemMap.set(_,{ref:_,...v}),()=>void T.itemMap.delete(_))),ht.createElement(hg,{[d]:"",ref:C},w)});function f(m){const g=i(t+"CollectionConsumer",m);return ht.useCallback(()=>{const w=g.collectionRef.current;if(!w)return[];const v=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(g.itemMap.values()).sort((T,R)=>v.indexOf(T.ref.current)-v.indexOf(R.ref.current))},[g.collectionRef,g.itemMap])}return[{Provider:o,Slot:c,ItemSlot:h},f,r]}const X_e=p.createContext(void 0);function Q_e(t){const e=p.useContext(X_e);return t||e||"ltr"}const Z_e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Cs=Z_e.reduce((t,e)=>{const n=p.forwardRef((r,s)=>{const{asChild:i,...o}=r,l=i?hg:e;return p.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),p.createElement(l,Tn({},o,{ref:s}))});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function eSe(t,e){t&&xl.flushSync(()=>t.dispatchEvent(e))}function ml(t){const e=p.useRef(t);return p.useEffect(()=>{e.current=t}),p.useMemo(()=>(...n)=>{var r;return(r=e.current)===null||r===void 0?void 0:r.call(e,...n)},[])}function tSe(t,e=globalThis==null?void 0:globalThis.document){const n=ml(t);p.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r),()=>e.removeEventListener("keydown",r)},[n,e])}const e1="dismissableLayer.update",nSe="dismissableLayer.pointerDownOutside",rSe="dismissableLayer.focusOutside";let LL;const sSe=p.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),iSe=p.forwardRef((t,e)=>{var n;const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:s,onPointerDownOutside:i,onFocusOutside:o,onInteractOutside:l,onDismiss:c,...u}=t,d=p.useContext(sSe),[h,f]=p.useState(null),m=(n=h==null?void 0:h.ownerDocument)!==null&&n!==void 0?n:globalThis==null?void 0:globalThis.document,[,g]=p.useState({}),x=$s(e,I=>f(I)),w=Array.from(d.layers),[v]=[...d.layersWithOutsidePointerEventsDisabled].slice(-1),_=w.indexOf(v),C=h?w.indexOf(h):-1,T=d.layersWithOutsidePointerEventsDisabled.size>0,R=C>=_,k=oSe(I=>{const P=I.target,A=[...d.branches].some(D=>D.contains(P));!R||A||(i==null||i(I),l==null||l(I),I.defaultPrevented||c==null||c())},m),E=aSe(I=>{const P=I.target;[...d.branches].some(D=>D.contains(P))||(o==null||o(I),l==null||l(I),I.defaultPrevented||c==null||c())},m);return tSe(I=>{C===d.layers.size-1&&(s==null||s(I),!I.defaultPrevented&&c&&(I.preventDefault(),c()))},m),p.useEffect(()=>{if(h)return r&&(d.layersWithOutsidePointerEventsDisabled.size===0&&(LL=m.body.style.pointerEvents,m.body.style.pointerEvents="none"),d.layersWithOutsidePointerEventsDisabled.add(h)),d.layers.add(h),FL(),()=>{r&&d.layersWithOutsidePointerEventsDisabled.size===1&&(m.body.style.pointerEvents=LL)}},[h,m,r,d]),p.useEffect(()=>()=>{h&&(d.layers.delete(h),d.layersWithOutsidePointerEventsDisabled.delete(h),FL())},[h,d]),p.useEffect(()=>{const I=()=>g({});return document.addEventListener(e1,I),()=>document.removeEventListener(e1,I)},[]),p.createElement(Cs.div,Tn({},u,{ref:x,style:{pointerEvents:T?R?"auto":"none":void 0,...t.style},onFocusCapture:os(t.onFocusCapture,E.onFocusCapture),onBlurCapture:os(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:os(t.onPointerDownCapture,k.onPointerDownCapture)}))});function oSe(t,e=globalThis==null?void 0:globalThis.document){const n=ml(t),r=p.useRef(!1),s=p.useRef(()=>{});return p.useEffect(()=>{const i=l=>{if(l.target&&!r.current){let u=function(){QG(nSe,n,c,{discrete:!0})};const c={originalEvent:l};l.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=u,e.addEventListener("click",s.current,{once:!0})):u()}r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function aSe(t,e=globalThis==null?void 0:globalThis.document){const n=ml(t),r=p.useRef(!1);return p.useEffect(()=>{const s=i=>{i.target&&!r.current&&QG(rSe,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function FL(){const t=new CustomEvent(e1);document.dispatchEvent(t)}function QG(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?eSe(s,i):s.dispatchEvent(i)}let ZS=0;function lSe(){p.useEffect(()=>{var t,e;const n=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(t=n[0])!==null&&t!==void 0?t:OL()),document.body.insertAdjacentElement("beforeend",(e=n[1])!==null&&e!==void 0?e:OL()),ZS++,()=>{ZS===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(r=>r.remove()),ZS--}},[])}function OL(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}const eC="focusScope.autoFocusOnMount",tC="focusScope.autoFocusOnUnmount",$L={bubbles:!1,cancelable:!0},cSe=p.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[l,c]=p.useState(null),u=ml(s),d=ml(i),h=p.useRef(null),f=$s(e,x=>c(x)),m=p.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;p.useEffect(()=>{if(r){let x=function(C){if(m.paused||!l)return;const T=C.target;l.contains(T)?h.current=T:Ol(h.current,{select:!0})},w=function(C){if(m.paused||!l)return;const T=C.relatedTarget;T!==null&&(l.contains(T)||Ol(h.current,{select:!0}))},v=function(C){const T=document.activeElement;for(const R of C)R.removedNodes.length>0&&(l!=null&&l.contains(T)||Ol(l))};document.addEventListener("focusin",x),document.addEventListener("focusout",w);const _=new MutationObserver(v);return l&&_.observe(l,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",x),document.removeEventListener("focusout",w),_.disconnect()}}},[r,l,m.paused]),p.useEffect(()=>{if(l){UL.add(m);const x=document.activeElement;if(!l.contains(x)){const v=new CustomEvent(eC,$L);l.addEventListener(eC,u),l.dispatchEvent(v),v.defaultPrevented||(uSe(pSe(ZG(l)),{select:!0}),document.activeElement===x&&Ol(l))}return()=>{l.removeEventListener(eC,u),setTimeout(()=>{const v=new CustomEvent(tC,$L);l.addEventListener(tC,d),l.dispatchEvent(v),v.defaultPrevented||Ol(x??document.body,{select:!0}),l.removeEventListener(tC,d),UL.remove(m)},0)}}},[l,u,d,m]);const g=p.useCallback(x=>{if(!n&&!r||m.paused)return;const w=x.key==="Tab"&&!x.altKey&&!x.ctrlKey&&!x.metaKey,v=document.activeElement;if(w&&v){const _=x.currentTarget,[C,T]=dSe(_);C&&T?!x.shiftKey&&v===T?(x.preventDefault(),n&&Ol(C,{select:!0})):x.shiftKey&&v===C&&(x.preventDefault(),n&&Ol(T,{select:!0})):v===_&&x.preventDefault()}},[n,r,m.paused]);return p.createElement(Cs.div,Tn({tabIndex:-1},o,{ref:f,onKeyDown:g}))});function uSe(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ol(r,{select:e}),document.activeElement!==n)return}function dSe(t){const e=ZG(t),n=VL(e,t),r=VL(e.reverse(),t);return[n,r]}function ZG(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function VL(t,e){for(const n of t)if(!hSe(n,{upTo:e}))return n}function hSe(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function fSe(t){return t instanceof HTMLInputElement&&"select"in t}function Ol(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&fSe(t)&&e&&t.select()}}const UL=mSe();function mSe(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=BL(t,e),t.unshift(e)},remove(e){var n;t=BL(t,e),(n=t[0])===null||n===void 0||n.resume()}}}function BL(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function pSe(t){return t.filter(e=>e.tagName!=="A")}const wo=globalThis!=null&&globalThis.document?p.useLayoutEffect:()=>{},gSe=d0["useId".toString()]||(()=>{});let ySe=0;function e7(t){const[e,n]=p.useState(gSe());return wo(()=>{t||n(r=>r??String(ySe++))},[t]),t||(e?`radix-${e}`:"")}const xSe=["top","right","bottom","left"],kc=Math.min,$i=Math.max,e0=Math.round,wx=Math.floor,Sa=t=>({x:t,y:t}),vSe={left:"right",right:"left",bottom:"top",top:"bottom"},wSe={start:"end",end:"start"};function t1(t,e,n){return $i(t,kc(e,n))}function pl(t,e){return typeof t=="function"?t(e):t}function gl(t){return t.split("-")[0]}function Vf(t){return t.split("-")[1]}function DA(t){return t==="x"?"y":"x"}function MA(t){return t==="y"?"height":"width"}function ma(t){return["top","bottom"].includes(gl(t))?"y":"x"}function LA(t){return DA(ma(t))}function bSe(t,e,n){n===void 0&&(n=!1);const r=Vf(t),s=LA(t),i=MA(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=t0(o)),[o,t0(o)]}function _Se(t){const e=t0(t);return[n1(t),e,n1(e)]}function n1(t){return t.replace(/start|end/g,e=>wSe[e])}function SSe(t,e,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?i:o;default:return[]}}function CSe(t,e,n,r){const s=Vf(t);let i=SSe(gl(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(n1)))),i}function t0(t){return t.replace(/left|right|bottom|top/g,e=>vSe[e])}function ESe(t){return{top:0,right:0,bottom:0,left:0,...t}}function t7(t){return typeof t!="number"?ESe(t):{top:t,right:t,bottom:t,left:t}}function n0(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function zL(t,e,n){let{reference:r,floating:s}=t;const i=ma(e),o=LA(e),l=MA(o),c=gl(e),u=i==="y",d=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,f=r[l]/2-s[l]/2;let m;switch(c){case"top":m={x:d,y:r.y-s.height};break;case"bottom":m={x:d,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:h};break;case"left":m={x:r.x-s.width,y:h};break;default:m={x:r.x,y:r.y}}switch(Vf(e)){case"start":m[o]-=f*(n&&u?-1:1);break;case"end":m[o]+=f*(n&&u?-1:1);break}return m}const TSe=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,l=i.filter(Boolean),c=await(o.isRTL==null?void 0:o.isRTL(e));let u=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:d,y:h}=zL(u,r,c),f=r,m={},g=0;for(let x=0;x<l.length;x++){const{name:w,fn:v}=l[x],{x:_,y:C,data:T,reset:R}=await v({x:d,y:h,initialPlacement:r,placement:f,strategy:s,middlewareData:m,rects:u,platform:o,elements:{reference:t,floating:e}});d=_??d,h=C??h,m={...m,[w]:{...m[w],...T}},R&&g<=50&&(g++,typeof R=="object"&&(R.placement&&(f=R.placement),R.rects&&(u=R.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):R.rects),{x:d,y:h}=zL(u,f,c)),x=-1)}return{x:d,y:h,placement:f,strategy:s,middlewareData:m}};async function fg(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:l,strategy:c}=t,{boundary:u="clippingAncestors",rootBoundary:d="viewport",elementContext:h="floating",altBoundary:f=!1,padding:m=0}=pl(e,t),g=t7(m),w=l[f?h==="floating"?"reference":"floating":h],v=n0(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(w)))==null||n?w:w.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(l.floating)),boundary:u,rootBoundary:d,strategy:c})),_=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,C=await(i.getOffsetParent==null?void 0:i.getOffsetParent(l.floating)),T=await(i.isElement==null?void 0:i.isElement(C))?await(i.getScale==null?void 0:i.getScale(C))||{x:1,y:1}:{x:1,y:1},R=n0(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:l,rect:_,offsetParent:C,strategy:c}):_);return{top:(v.top-R.top+g.top)/T.y,bottom:(R.bottom-v.bottom+g.bottom)/T.y,left:(v.left-R.left+g.left)/T.x,right:(R.right-v.right+g.right)/T.x}}const ISe=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:l,middlewareData:c}=e,{element:u,padding:d=0}=pl(t,e)||{};if(u==null)return{};const h=t7(d),f={x:n,y:r},m=LA(s),g=MA(m),x=await o.getDimensions(u),w=m==="y",v=w?"top":"left",_=w?"bottom":"right",C=w?"clientHeight":"clientWidth",T=i.reference[g]+i.reference[m]-f[m]-i.floating[g],R=f[m]-i.reference[m],k=await(o.getOffsetParent==null?void 0:o.getOffsetParent(u));let E=k?k[C]:0;(!E||!await(o.isElement==null?void 0:o.isElement(k)))&&(E=l.floating[C]||i.floating[g]);const I=T/2-R/2,P=E/2-x[g]/2-1,A=kc(h[v],P),D=kc(h[_],P),j=A,M=E-x[g]-D,z=E/2-x[g]/2+I,U=t1(j,z,M),K=!c.arrow&&Vf(s)!=null&&z!==U&&i.reference[g]/2-(z<j?A:D)-x[g]/2<0,q=K?z<j?z-j:z-M:0;return{[m]:f[m]+q,data:{[m]:U,centerOffset:z-U-q,...K&&{alignmentOffset:q}},reset:K}}}),NSe=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:l,platform:c,elements:u}=e,{mainAxis:d=!0,crossAxis:h=!0,fallbackPlacements:f,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:g="none",flipAlignment:x=!0,...w}=pl(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const v=gl(s),_=ma(l),C=gl(l)===l,T=await(c.isRTL==null?void 0:c.isRTL(u.floating)),R=f||(C||!x?[t0(l)]:_Se(l)),k=g!=="none";!f&&k&&R.push(...CSe(l,x,g,T));const E=[l,...R],I=await fg(e,w),P=[];let A=((r=i.flip)==null?void 0:r.overflows)||[];if(d&&P.push(I[v]),h){const z=bSe(s,o,T);P.push(I[z[0]],I[z[1]])}if(A=[...A,{placement:s,overflows:P}],!P.every(z=>z<=0)){var D,j;const z=(((D=i.flip)==null?void 0:D.index)||0)+1,U=E[z];if(U&&(!(h==="alignment"?_!==ma(U):!1)||A.every(W=>W.overflows[0]>0&&ma(W.placement)===_)))return{data:{index:z,overflows:A},reset:{placement:U}};let K=(j=A.filter(q=>q.overflows[0]<=0).sort((q,W)=>q.overflows[1]-W.overflows[1])[0])==null?void 0:j.placement;if(!K)switch(m){case"bestFit":{var M;const q=(M=A.filter(W=>{if(k){const te=ma(W.placement);return te===_||te==="y"}return!0}).map(W=>[W.placement,W.overflows.filter(te=>te>0).reduce((te,O)=>te+O,0)]).sort((W,te)=>W[1]-te[1])[0])==null?void 0:M[0];q&&(K=q);break}case"initialPlacement":K=l;break}if(s!==K)return{reset:{placement:K}}}return{}}}};function GL(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function WL(t){return xSe.some(e=>t[e]>=0)}const PSe=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=pl(t,e);switch(r){case"referenceHidden":{const i=await fg(e,{...s,elementContext:"reference"}),o=GL(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:WL(o)}}}case"escaped":{const i=await fg(e,{...s,altBoundary:!0}),o=GL(i,n.floating);return{data:{escapedOffsets:o,escaped:WL(o)}}}default:return{}}}}};async function ASe(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=gl(n),l=Vf(n),c=ma(n)==="y",u=["left","top"].includes(o)?-1:1,d=i&&c?-1:1,h=pl(e,t);let{mainAxis:f,crossAxis:m,alignmentAxis:g}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return l&&typeof g=="number"&&(m=l==="end"?g*-1:g),c?{x:m*d,y:f*u}:{x:f*u,y:m*d}}const kSe=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:l}=e,c=await ASe(e,t);return o===((n=l.offset)==null?void 0:n.placement)&&(r=l.arrow)!=null&&r.alignmentOffset?{}:{x:s+c.x,y:i+c.y,data:{...c,placement:o}}}}},RSe=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:l={fn:w=>{let{x:v,y:_}=w;return{x:v,y:_}}},...c}=pl(t,e),u={x:n,y:r},d=await fg(e,c),h=ma(gl(s)),f=DA(h);let m=u[f],g=u[h];if(i){const w=f==="y"?"top":"left",v=f==="y"?"bottom":"right",_=m+d[w],C=m-d[v];m=t1(_,m,C)}if(o){const w=h==="y"?"top":"left",v=h==="y"?"bottom":"right",_=g+d[w],C=g-d[v];g=t1(_,g,C)}const x=l.fn({...e,[f]:m,[h]:g});return{...x,data:{x:x.x-n,y:x.y-r,enabled:{[f]:i,[h]:o}}}}}},jSe=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:l=0,mainAxis:c=!0,crossAxis:u=!0}=pl(t,e),d={x:n,y:r},h=ma(s),f=DA(h);let m=d[f],g=d[h];const x=pl(l,e),w=typeof x=="number"?{mainAxis:x,crossAxis:0}:{mainAxis:0,crossAxis:0,...x};if(c){const C=f==="y"?"height":"width",T=i.reference[f]-i.floating[C]+w.mainAxis,R=i.reference[f]+i.reference[C]-w.mainAxis;m<T?m=T:m>R&&(m=R)}if(u){var v,_;const C=f==="y"?"width":"height",T=["top","left"].includes(gl(s)),R=i.reference[h]-i.floating[C]+(T&&((v=o.offset)==null?void 0:v[h])||0)+(T?0:w.crossAxis),k=i.reference[h]+i.reference[C]+(T?0:((_=o.offset)==null?void 0:_[h])||0)-(T?w.crossAxis:0);g<R?g=R:g>k&&(g=k)}return{[f]:m,[h]:g}}}},DSe=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:o,elements:l}=e,{apply:c=()=>{},...u}=pl(t,e),d=await fg(e,u),h=gl(s),f=Vf(s),m=ma(s)==="y",{width:g,height:x}=i.floating;let w,v;h==="top"||h==="bottom"?(w=h,v=f===(await(o.isRTL==null?void 0:o.isRTL(l.floating))?"start":"end")?"left":"right"):(v=h,w=f==="end"?"top":"bottom");const _=x-d.top-d.bottom,C=g-d.left-d.right,T=kc(x-d[w],_),R=kc(g-d[v],C),k=!e.middlewareData.shift;let E=T,I=R;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(I=C),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(E=_),k&&!f){const A=$i(d.left,0),D=$i(d.right,0),j=$i(d.top,0),M=$i(d.bottom,0);m?I=g-2*(A!==0||D!==0?A+D:$i(d.left,d.right)):E=x-2*(j!==0||M!==0?j+M:$i(d.top,d.bottom))}await c({...e,availableWidth:I,availableHeight:E});const P=await o.getDimensions(l.floating);return g!==P.width||x!==P.height?{reset:{rects:!0}}:{}}}};function Zb(){return typeof window<"u"}function Uf(t){return n7(t)?(t.nodeName||"").toLowerCase():"#document"}function Ki(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Ra(t){var e;return(e=(n7(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function n7(t){return Zb()?t instanceof Node||t instanceof Ki(t).Node:!1}function qo(t){return Zb()?t instanceof Element||t instanceof Ki(t).Element:!1}function Ia(t){return Zb()?t instanceof HTMLElement||t instanceof Ki(t).HTMLElement:!1}function HL(t){return!Zb()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ki(t).ShadowRoot}function cy(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=Ko(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function MSe(t){return["table","td","th"].includes(Uf(t))}function e_(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function FA(t){const e=OA(),n=qo(t)?Ko(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function LSe(t){let e=Rc(t);for(;Ia(e)&&!Sf(e);){if(FA(e))return e;if(e_(e))return null;e=Rc(e)}return null}function OA(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Sf(t){return["html","body","#document"].includes(Uf(t))}function Ko(t){return Ki(t).getComputedStyle(t)}function t_(t){return qo(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function Rc(t){if(Uf(t)==="html")return t;const e=t.assignedSlot||t.parentNode||HL(t)&&t.host||Ra(t);return HL(e)?e.host:e}function r7(t){const e=Rc(t);return Sf(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ia(e)&&cy(e)?e:r7(e)}function mg(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=r7(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=Ki(s);if(i){const l=r1(o);return e.concat(o,o.visualViewport||[],cy(s)?s:[],l&&n?mg(l):[])}return e.concat(s,mg(s,[],n))}function r1(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function s7(t){const e=Ko(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Ia(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,l=e0(n)!==i||e0(r)!==o;return l&&(n=i,r=o),{width:n,height:r,$:l}}function $A(t){return qo(t)?t:t.contextElement}function Uh(t){const e=$A(t);if(!Ia(e))return Sa(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=s7(e);let o=(i?e0(n.width):n.width)/r,l=(i?e0(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!l||!Number.isFinite(l))&&(l=1),{x:o,y:l}}const FSe=Sa(0);function i7(t){const e=Ki(t);return!OA()||!e.visualViewport?FSe:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function OSe(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Ki(t)?!1:e}function ud(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=$A(t);let o=Sa(1);e&&(r?qo(r)&&(o=Uh(r)):o=Uh(t));const l=OSe(i,n,r)?i7(i):Sa(0);let c=(s.left+l.x)/o.x,u=(s.top+l.y)/o.y,d=s.width/o.x,h=s.height/o.y;if(i){const f=Ki(i),m=r&&qo(r)?Ki(r):r;let g=f,x=r1(g);for(;x&&r&&m!==g;){const w=Uh(x),v=x.getBoundingClientRect(),_=Ko(x),C=v.left+(x.clientLeft+parseFloat(_.paddingLeft))*w.x,T=v.top+(x.clientTop+parseFloat(_.paddingTop))*w.y;c*=w.x,u*=w.y,d*=w.x,h*=w.y,c+=C,u+=T,g=Ki(x),x=r1(g)}}return n0({width:d,height:h,x:c,y:u})}function VA(t,e){const n=t_(t).scrollLeft;return e?e.left+n:ud(Ra(t)).left+n}function o7(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=r.left+e.scrollLeft-(n?0:VA(t,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function $Se(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=Ra(r),l=e?e_(e.floating):!1;if(r===o||l&&i)return n;let c={scrollLeft:0,scrollTop:0},u=Sa(1);const d=Sa(0),h=Ia(r);if((h||!h&&!i)&&((Uf(r)!=="body"||cy(o))&&(c=t_(r)),Ia(r))){const m=ud(r);u=Uh(r),d.x=m.x+r.clientLeft,d.y=m.y+r.clientTop}const f=o&&!h&&!i?o7(o,c,!0):Sa(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-c.scrollLeft*u.x+d.x+f.x,y:n.y*u.y-c.scrollTop*u.y+d.y+f.y}}function VSe(t){return Array.from(t.getClientRects())}function USe(t){const e=Ra(t),n=t_(t),r=t.ownerDocument.body,s=$i(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=$i(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+VA(t);const l=-n.scrollTop;return Ko(r).direction==="rtl"&&(o+=$i(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:l}}function BSe(t,e){const n=Ki(t),r=Ra(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,l=0,c=0;if(s){i=s.width,o=s.height;const u=OA();(!u||u&&e==="fixed")&&(l=s.offsetLeft,c=s.offsetTop)}return{width:i,height:o,x:l,y:c}}function zSe(t,e){const n=ud(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=Ia(t)?Uh(t):Sa(1),o=t.clientWidth*i.x,l=t.clientHeight*i.y,c=s*i.x,u=r*i.y;return{width:o,height:l,x:c,y:u}}function qL(t,e,n){let r;if(e==="viewport")r=BSe(t,n);else if(e==="document")r=USe(Ra(t));else if(qo(e))r=zSe(e,n);else{const s=i7(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return n0(r)}function a7(t,e){const n=Rc(t);return n===e||!qo(n)||Sf(n)?!1:Ko(n).position==="fixed"||a7(n,e)}function GSe(t,e){const n=e.get(t);if(n)return n;let r=mg(t,[],!1).filter(l=>qo(l)&&Uf(l)!=="body"),s=null;const i=Ko(t).position==="fixed";let o=i?Rc(t):t;for(;qo(o)&&!Sf(o);){const l=Ko(o),c=FA(o);!c&&l.position==="fixed"&&(s=null),(i?!c&&!s:!c&&l.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||cy(o)&&!c&&a7(t,o))?r=r.filter(d=>d!==o):s=l,o=Rc(o)}return e.set(t,r),r}function WSe(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?e_(e)?[]:GSe(e,this._c):[].concat(n),r],l=o[0],c=o.reduce((u,d)=>{const h=qL(e,d,s);return u.top=$i(h.top,u.top),u.right=kc(h.right,u.right),u.bottom=kc(h.bottom,u.bottom),u.left=$i(h.left,u.left),u},qL(e,l,s));return{width:c.right-c.left,height:c.bottom-c.top,x:c.left,y:c.top}}function HSe(t){const{width:e,height:n}=s7(t);return{width:e,height:n}}function qSe(t,e,n){const r=Ia(e),s=Ra(e),i=n==="fixed",o=ud(t,!0,i,e);let l={scrollLeft:0,scrollTop:0};const c=Sa(0);function u(){c.x=VA(s)}if(r||!r&&!i)if((Uf(e)!=="body"||cy(s))&&(l=t_(e)),r){const m=ud(e,!0,i,e);c.x=m.x+e.clientLeft,c.y=m.y+e.clientTop}else s&&u();i&&!r&&s&&u();const d=s&&!r&&!i?o7(s,l):Sa(0),h=o.left+l.scrollLeft-c.x-d.x,f=o.top+l.scrollTop-c.y-d.y;return{x:h,y:f,width:o.width,height:o.height}}function nC(t){return Ko(t).position==="static"}function KL(t,e){if(!Ia(t)||Ko(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Ra(t)===n&&(n=n.ownerDocument.body),n}function l7(t,e){const n=Ki(t);if(e_(t))return n;if(!Ia(t)){let s=Rc(t);for(;s&&!Sf(s);){if(qo(s)&&!nC(s))return s;s=Rc(s)}return n}let r=KL(t,e);for(;r&&MSe(r)&&nC(r);)r=KL(r,e);return r&&Sf(r)&&nC(r)&&!FA(r)?n:r||LSe(t)||n}const KSe=async function(t){const e=this.getOffsetParent||l7,n=this.getDimensions,r=await n(t.floating);return{reference:qSe(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function YSe(t){return Ko(t).direction==="rtl"}const JSe={convertOffsetParentRelativeRectToViewportRelativeRect:$Se,getDocumentElement:Ra,getClippingRect:WSe,getOffsetParent:l7,getElementRects:KSe,getClientRects:VSe,getDimensions:HSe,getScale:Uh,isElement:qo,isRTL:YSe};function c7(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function XSe(t,e){let n=null,r;const s=Ra(t);function i(){var l;clearTimeout(r),(l=n)==null||l.disconnect(),n=null}function o(l,c){l===void 0&&(l=!1),c===void 0&&(c=1),i();const u=t.getBoundingClientRect(),{left:d,top:h,width:f,height:m}=u;if(l||e(),!f||!m)return;const g=wx(h),x=wx(s.clientWidth-(d+f)),w=wx(s.clientHeight-(h+m)),v=wx(d),C={rootMargin:-g+"px "+-x+"px "+-w+"px "+-v+"px",threshold:$i(0,kc(1,c))||1};let T=!0;function R(k){const E=k[0].intersectionRatio;if(E!==c){if(!T)return o();E?o(!1,E):r=setTimeout(()=>{o(!1,1e-7)},1e3)}E===1&&!c7(u,t.getBoundingClientRect())&&o(),T=!1}try{n=new IntersectionObserver(R,{...C,root:s.ownerDocument})}catch{n=new IntersectionObserver(R,C)}n.observe(t)}return o(!0),i}function u7(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:l=typeof IntersectionObserver=="function",animationFrame:c=!1}=r,u=$A(t),d=s||i?[...u?mg(u):[],...mg(e)]:[];d.forEach(v=>{s&&v.addEventListener("scroll",n,{passive:!0}),i&&v.addEventListener("resize",n)});const h=u&&l?XSe(u,n):null;let f=-1,m=null;o&&(m=new ResizeObserver(v=>{let[_]=v;_&&_.target===u&&m&&(m.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var C;(C=m)==null||C.observe(e)})),n()}),u&&!c&&m.observe(u),m.observe(e));let g,x=c?ud(t):null;c&&w();function w(){const v=ud(t);x&&!c7(x,v)&&n(),x=v,g=requestAnimationFrame(w)}return n(),()=>{var v;d.forEach(_=>{s&&_.removeEventListener("scroll",n),i&&_.removeEventListener("resize",n)}),h==null||h(),(v=m)==null||v.disconnect(),m=null,c&&cancelAnimationFrame(g)}}const QSe=kSe,ZSe=RSe,eCe=NSe,tCe=DSe,nCe=PSe,YL=ISe,rCe=jSe,sCe=(t,e,n)=>{const r=new Map,s={platform:JSe,...n},i={...s.platform,_c:r};return TSe(t,e,{...s,platform:i})};var iCe=typeof document<"u",oCe=function(){},vv=iCe?p.useLayoutEffect:oCe;function r0(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!r0(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!r0(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function d7(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function JL(t,e){const n=d7(t);return Math.round(e*n)/n}function rC(t){const e=p.useRef(t);return vv(()=>{e.current=t}),e}function h7(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:l=!0,whileElementsMounted:c,open:u}=t,[d,h]=p.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,m]=p.useState(r);r0(f,r)||m(r);const[g,x]=p.useState(null),[w,v]=p.useState(null),_=p.useCallback(W=>{W!==k.current&&(k.current=W,x(W))},[]),C=p.useCallback(W=>{W!==E.current&&(E.current=W,v(W))},[]),T=i||g,R=o||w,k=p.useRef(null),E=p.useRef(null),I=p.useRef(d),P=c!=null,A=rC(c),D=rC(s),j=rC(u),M=p.useCallback(()=>{if(!k.current||!E.current)return;const W={placement:e,strategy:n,middleware:f};D.current&&(W.platform=D.current),sCe(k.current,E.current,W).then(te=>{const O={...te,isPositioned:j.current!==!1};z.current&&!r0(I.current,O)&&(I.current=O,xl.flushSync(()=>{h(O)}))})},[f,e,n,D,j]);vv(()=>{u===!1&&I.current.isPositioned&&(I.current.isPositioned=!1,h(W=>({...W,isPositioned:!1})))},[u]);const z=p.useRef(!1);vv(()=>(z.current=!0,()=>{z.current=!1}),[]),vv(()=>{if(T&&(k.current=T),R&&(E.current=R),T&&R){if(A.current)return A.current(T,R,M);M()}},[T,R,M,A,P]);const U=p.useMemo(()=>({reference:k,floating:E,setReference:_,setFloating:C}),[_,C]),K=p.useMemo(()=>({reference:T,floating:R}),[T,R]),q=p.useMemo(()=>{const W={position:n,left:0,top:0};if(!K.floating)return W;const te=JL(K.floating,d.x),O=JL(K.floating,d.y);return l?{...W,transform:"translate("+te+"px, "+O+"px)",...d7(K.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:te,top:O}},[n,l,K.floating,d.x,d.y]);return p.useMemo(()=>({...d,update:M,refs:U,elements:K,floatingStyles:q}),[d,M,U,K,q])}const aCe=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?YL({element:r.current,padding:s}).fn(n):{}:r?YL({element:r,padding:s}).fn(n):{}}}},f7=(t,e)=>({...QSe(t),options:[t,e]}),m7=(t,e)=>({...ZSe(t),options:[t,e]}),p7=(t,e)=>({...rCe(t),options:[t,e]}),g7=(t,e)=>({...eCe(t),options:[t,e]}),y7=(t,e)=>({...tCe(t),options:[t,e]}),x7=(t,e)=>({...nCe(t),options:[t,e]}),v7=(t,e)=>({...aCe(t),options:[t,e]});function lCe(t){const[e,n]=p.useState(void 0);return wo(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}const w7="Popper",[b7,_7]=jA(w7),[cCe,S7]=b7(w7),uCe=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return p.createElement(cCe,{scope:e,anchor:r,onAnchorChange:s},n)},dCe="PopperAnchor",hCe=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=S7(dCe,n),o=p.useRef(null),l=$s(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:p.createElement(Cs.div,Tn({},s,{ref:l}))}),C7="PopperContent",[fCe,Kje]=b7(C7),mCe=p.forwardRef((t,e)=>{var n,r,s,i,o,l,c,u;const{__scopePopper:d,side:h="bottom",sideOffset:f=0,align:m="center",alignOffset:g=0,arrowPadding:x=0,collisionBoundary:w=[],collisionPadding:v=0,sticky:_="partial",hideWhenDetached:C=!1,avoidCollisions:T=!0,onPlaced:R,...k}=t,E=S7(C7,d),[I,P]=p.useState(null),A=$s(e,ie=>P(ie)),[D,j]=p.useState(null),M=lCe(D),z=(n=M==null?void 0:M.width)!==null&&n!==void 0?n:0,U=(r=M==null?void 0:M.height)!==null&&r!==void 0?r:0,K=h+(m!=="center"?"-"+m:""),q=typeof v=="number"?v:{top:0,right:0,bottom:0,left:0,...v},W=Array.isArray(w)?w:[w],te=W.length>0,O={padding:q,boundary:W.filter(pCe),altBoundary:te},{refs:V,floatingStyles:H,placement:L,isPositioned:ee,middlewareData:pe}=h7({strategy:"fixed",placement:K,whileElementsMounted:u7,elements:{reference:E.anchor},middleware:[f7({mainAxis:f+U,alignmentAxis:g}),T&&m7({mainAxis:!0,crossAxis:!1,limiter:_==="partial"?p7():void 0,...O}),T&&g7({...O}),y7({...O,apply:({elements:ie,rects:$e,availableWidth:me,availableHeight:Ue})=>{const{width:et,height:ct}=$e.reference,Mt=ie.floating.style;Mt.setProperty("--radix-popper-available-width",`${me}px`),Mt.setProperty("--radix-popper-available-height",`${Ue}px`),Mt.setProperty("--radix-popper-anchor-width",`${et}px`),Mt.setProperty("--radix-popper-anchor-height",`${ct}px`)}}),D&&v7({element:D,padding:x}),gCe({arrowWidth:z,arrowHeight:U}),C&&x7({strategy:"referenceHidden"})]}),[xe,we]=E7(L),Ie=ml(R);wo(()=>{ee&&(Ie==null||Ie())},[ee,Ie]);const Fe=(s=pe.arrow)===null||s===void 0?void 0:s.x,Ve=(i=pe.arrow)===null||i===void 0?void 0:i.y,Ge=((o=pe.arrow)===null||o===void 0?void 0:o.centerOffset)!==0,[fe,je]=p.useState();return wo(()=>{I&&je(window.getComputedStyle(I).zIndex)},[I]),p.createElement("div",{ref:V.setFloating,"data-radix-popper-content-wrapper":"",style:{...H,transform:ee?H.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:fe,"--radix-popper-transform-origin":[(l=pe.transformOrigin)===null||l===void 0?void 0:l.x,(c=pe.transformOrigin)===null||c===void 0?void 0:c.y].join(" ")},dir:t.dir},p.createElement(fCe,{scope:d,placedSide:xe,onArrowChange:j,arrowX:Fe,arrowY:Ve,shouldHideArrow:Ge},p.createElement(Cs.div,Tn({"data-side":xe,"data-align":we},k,{ref:A,style:{...k.style,animation:ee?void 0:"none",opacity:(u=pe.hide)!==null&&u!==void 0&&u.referenceHidden?0:void 0}}))))});function pCe(t){return t!==null}const gCe=t=>({name:"transformOrigin",options:t,fn(e){var n,r,s,i,o;const{placement:l,rects:c,middlewareData:u}=e,h=((n=u.arrow)===null||n===void 0?void 0:n.centerOffset)!==0,f=h?0:t.arrowWidth,m=h?0:t.arrowHeight,[g,x]=E7(l),w={start:"0%",center:"50%",end:"100%"}[x],v=((r=(s=u.arrow)===null||s===void 0?void 0:s.x)!==null&&r!==void 0?r:0)+f/2,_=((i=(o=u.arrow)===null||o===void 0?void 0:o.y)!==null&&i!==void 0?i:0)+m/2;let C="",T="";return g==="bottom"?(C=h?w:`${v}px`,T=`${-m}px`):g==="top"?(C=h?w:`${v}px`,T=`${c.floating.height+m}px`):g==="right"?(C=`${-m}px`,T=h?w:`${_}px`):g==="left"&&(C=`${c.floating.width+m}px`,T=h?w:`${_}px`),{data:{x:C,y:T}}}});function E7(t){const[e,n="center"]=t.split("-");return[e,n]}const yCe=uCe,xCe=hCe,vCe=mCe,wCe=p.forwardRef((t,e)=>{var n;const{container:r=globalThis==null||(n=globalThis.document)===null||n===void 0?void 0:n.body,...s}=t;return r?vI.createPortal(p.createElement(Cs.div,Tn({},s,{ref:e})),r):null});function XL({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=bCe({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,l=ml(n),c=p.useCallback(u=>{if(i){const h=typeof u=="function"?u(t):u;h!==t&&l(h)}else s(u)},[i,t,s,l]);return[o,c]}function bCe({defaultProp:t,onChange:e}){const n=p.useState(t),[r]=n,s=p.useRef(r),i=ml(e);return p.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}function _Ce(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}const SCe=p.forwardRef((t,e)=>p.createElement(Cs.span,Tn({},t,{ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}})));var T7=uU(),sC=function(){},n_=p.forwardRef(function(t,e){var n=p.useRef(null),r=p.useState({onScrollCapture:sC,onWheelCapture:sC,onTouchMoveCapture:sC}),s=r[0],i=r[1],o=t.forwardProps,l=t.children,c=t.className,u=t.removeScrollBar,d=t.enabled,h=t.shards,f=t.sideCar,m=t.noIsolation,g=t.inert,x=t.allowPinchZoom,w=t.as,v=w===void 0?"div":w,_=Rf(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),C=f,T=cU([n,e]),R=Ds(Ds({},_),s);return p.createElement(p.Fragment,null,d&&p.createElement(C,{sideCar:T7,removeScrollBar:u,shards:h,noIsolation:m,inert:g,setCallbacks:i,allowPinchZoom:!!x,lockRef:n}),o?p.cloneElement(p.Children.only(l),Ds(Ds({},R),{ref:T})):p.createElement(v,Ds({},R,{className:c,ref:T}),l))});n_.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};n_.classNames={fullWidth:ep,zeroRight:Zm};var s1=!1;if(typeof window<"u")try{var bx=Object.defineProperty({},"passive",{get:function(){return s1=!0,!0}});window.addEventListener("test",bx,bx),window.removeEventListener("test",bx,bx)}catch{s1=!1}var Gd=s1?{passive:!1}:!1,CCe=function(t){return t.tagName==="TEXTAREA"},I7=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!CCe(t)&&n[e]==="visible")},ECe=function(t){return I7(t,"overflowY")},TCe=function(t){return I7(t,"overflowX")},QL=function(t,e){var n=e;do{typeof ShadowRoot<"u"&&n instanceof ShadowRoot&&(n=n.host);var r=N7(t,n);if(r){var s=P7(t,n),i=s[1],o=s[2];if(i>o)return!0}n=n.parentNode}while(n&&n!==document.body);return!1},ICe=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},NCe=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},N7=function(t,e){return t==="v"?ECe(e):TCe(e)},P7=function(t,e){return t==="v"?ICe(e):NCe(e)},PCe=function(t,e){return t==="h"&&e==="rtl"?-1:1},ACe=function(t,e,n,r,s){var i=PCe(t,window.getComputedStyle(e).direction),o=i*r,l=n.target,c=e.contains(l),u=!1,d=o>0,h=0,f=0;do{var m=P7(t,l),g=m[0],x=m[1],w=m[2],v=x-w-i*g;(g||v)&&N7(t,l)&&(h+=v,f+=g),l=l.parentNode}while(!c&&l!==document.body||c&&(e.contains(l)||e===l));return(d&&(s&&h===0||!s&&o>h)||!d&&(s&&f===0||!s&&-o>f))&&(u=!0),u},_x=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},ZL=function(t){return[t.deltaX,t.deltaY]},eF=function(t){return t&&"current"in t?t.current:t},kCe=function(t,e){return t[0]===e[0]&&t[1]===e[1]},RCe=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},jCe=0,Wd=[];function DCe(t){var e=p.useRef([]),n=p.useRef([0,0]),r=p.useRef(),s=p.useState(jCe++)[0],i=p.useState(function(){return BI()})[0],o=p.useRef(t);p.useEffect(function(){o.current=t},[t]),p.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var x=lU([t.lockRef.current],(t.shards||[]).map(eF),!0).filter(Boolean);return x.forEach(function(w){return w.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),x.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var l=p.useCallback(function(x,w){if("touches"in x&&x.touches.length===2)return!o.current.allowPinchZoom;var v=_x(x),_=n.current,C="deltaX"in x?x.deltaX:_[0]-v[0],T="deltaY"in x?x.deltaY:_[1]-v[1],R,k=x.target,E=Math.abs(C)>Math.abs(T)?"h":"v";if("touches"in x&&E==="h"&&k.type==="range")return!1;var I=QL(E,k);if(!I)return!0;if(I?R=E:(R=E==="v"?"h":"v",I=QL(E,k)),!I)return!1;if(!r.current&&"changedTouches"in x&&(C||T)&&(r.current=R),!R)return!0;var P=r.current||R;return ACe(P,w,x,P==="h"?C:T,!0)},[]),c=p.useCallback(function(x){var w=x;if(!(!Wd.length||Wd[Wd.length-1]!==i)){var v="deltaY"in w?ZL(w):_x(w),_=e.current.filter(function(R){return R.name===w.type&&R.target===w.target&&kCe(R.delta,v)})[0];if(_&&_.should){w.cancelable&&w.preventDefault();return}if(!_){var C=(o.current.shards||[]).map(eF).filter(Boolean).filter(function(R){return R.contains(w.target)}),T=C.length>0?l(w,C[0]):!o.current.noIsolation;T&&w.cancelable&&w.preventDefault()}}},[]),u=p.useCallback(function(x,w,v,_){var C={name:x,delta:w,target:v,should:_};e.current.push(C),setTimeout(function(){e.current=e.current.filter(function(T){return T!==C})},1)},[]),d=p.useCallback(function(x){n.current=_x(x),r.current=void 0},[]),h=p.useCallback(function(x){u(x.type,ZL(x),x.target,l(x,t.lockRef.current))},[]),f=p.useCallback(function(x){u(x.type,_x(x),x.target,l(x,t.lockRef.current))},[]);p.useEffect(function(){return Wd.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:f}),document.addEventListener("wheel",c,Gd),document.addEventListener("touchmove",c,Gd),document.addEventListener("touchstart",d,Gd),function(){Wd=Wd.filter(function(x){return x!==i}),document.removeEventListener("wheel",c,Gd),document.removeEventListener("touchmove",c,Gd),document.removeEventListener("touchstart",d,Gd)}},[]);var m=t.removeScrollBar,g=t.inert;return p.createElement(p.Fragment,null,g?p.createElement(i,{styles:RCe(s)}):null,m?p.createElement(mU,{gapMode:"margin"}):null)}const MCe=hU(T7,DCe);var A7=p.forwardRef(function(t,e){return p.createElement(n_,Ds({},t,{ref:e,sideCar:MCe}))});A7.classNames=n_.classNames;const LCe=A7,FCe=[" ","Enter","ArrowUp","ArrowDown"],OCe=[" ","Enter"],r_="Select",[s_,i_,$Ce]=J_e(r_),[Bf,Yje]=jA(r_,[$Ce,_7]),UA=_7(),[VCe,wd]=Bf(r_),[UCe,BCe]=Bf(r_),zCe=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:s,onOpenChange:i,value:o,defaultValue:l,onValueChange:c,dir:u,name:d,autoComplete:h,disabled:f,required:m}=t,g=UA(e),[x,w]=p.useState(null),[v,_]=p.useState(null),[C,T]=p.useState(!1),R=Q_e(u),[k=!1,E]=XL({prop:r,defaultProp:s,onChange:i}),[I,P]=XL({prop:o,defaultProp:l,onChange:c}),A=p.useRef(null),D=x?!!x.closest("form"):!0,[j,M]=p.useState(new Set),z=Array.from(j).map(U=>U.props.value).join(";");return p.createElement(yCe,g,p.createElement(VCe,{required:m,scope:e,trigger:x,onTriggerChange:w,valueNode:v,onValueNodeChange:_,valueNodeHasChildren:C,onValueNodeHasChildrenChange:T,contentId:e7(),value:I,onValueChange:P,open:k,onOpenChange:E,dir:R,triggerPointerDownPosRef:A,disabled:f},p.createElement(s_.Provider,{scope:e},p.createElement(UCe,{scope:t.__scopeSelect,onNativeOptionAdd:p.useCallback(U=>{M(K=>new Set(K).add(U))},[]),onNativeOptionRemove:p.useCallback(U=>{M(K=>{const q=new Set(K);return q.delete(U),q})},[])},n)),D?p.createElement(D7,{key:z,"aria-hidden":!0,required:m,tabIndex:-1,name:d,autoComplete:h,value:I,onChange:U=>P(U.target.value),disabled:f},I===void 0?p.createElement("option",{value:""}):null,Array.from(j)):null))},GCe="SelectTrigger",WCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...s}=t,i=UA(n),o=wd(GCe,n),l=o.disabled||r,c=$s(e,o.onTriggerChange),u=i_(n),[d,h,f]=M7(g=>{const x=u().filter(_=>!_.disabled),w=x.find(_=>_.value===o.value),v=L7(x,g,w);v!==void 0&&o.onValueChange(v.value)}),m=()=>{l||(o.onOpenChange(!0),f())};return p.createElement(xCe,Tn({asChild:!0},i),p.createElement(Cs.button,Tn({type:"button",role:"combobox","aria-controls":o.contentId,"aria-expanded":o.open,"aria-required":o.required,"aria-autocomplete":"none",dir:o.dir,"data-state":o.open?"open":"closed",disabled:l,"data-disabled":l?"":void 0,"data-placeholder":o.value===void 0?"":void 0},s,{ref:c,onClick:os(s.onClick,g=>{g.currentTarget.focus()}),onPointerDown:os(s.onPointerDown,g=>{const x=g.target;x.hasPointerCapture(g.pointerId)&&x.releasePointerCapture(g.pointerId),g.button===0&&g.ctrlKey===!1&&(m(),o.triggerPointerDownPosRef.current={x:Math.round(g.pageX),y:Math.round(g.pageY)},g.preventDefault())}),onKeyDown:os(s.onKeyDown,g=>{const x=d.current!=="";!(g.ctrlKey||g.altKey||g.metaKey)&&g.key.length===1&&h(g.key),!(x&&g.key===" ")&&FCe.includes(g.key)&&(m(),g.preventDefault())})})))}),HCe="SelectValue",qCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:o,...l}=t,c=wd(HCe,n),{onValueNodeHasChildrenChange:u}=c,d=i!==void 0,h=$s(e,c.onValueNodeChange);return wo(()=>{u(d)},[u,d]),p.createElement(Cs.span,Tn({},l,{ref:h,style:{pointerEvents:"none"}}),c.value===void 0&&o!==void 0?o:i)}),KCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...s}=t;return p.createElement(Cs.span,Tn({"aria-hidden":!0},s,{ref:e}),r||"▼")}),YCe=t=>p.createElement(wCe,Tn({asChild:!0},t)),Cf="SelectContent",JCe=p.forwardRef((t,e)=>{const n=wd(Cf,t.__scopeSelect),[r,s]=p.useState();if(wo(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?xl.createPortal(p.createElement(k7,{scope:t.__scopeSelect},p.createElement(s_.Slot,{scope:t.__scopeSelect},p.createElement("div",null,t.children))),i):null}return p.createElement(XCe,Tn({},t,{ref:e}))}),Fa=10,[k7,bd]=Bf(Cf),XCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:o,side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:w,...v}=t,_=wd(Cf,n),[C,T]=p.useState(null),[R,k]=p.useState(null),E=$s(e,we=>T(we)),[I,P]=p.useState(null),[A,D]=p.useState(null),j=i_(n),[M,z]=p.useState(!1),U=p.useRef(!1);p.useEffect(()=>{if(C)return B0(C)},[C]),lSe();const K=p.useCallback(we=>{const[Ie,...Fe]=j().map(fe=>fe.ref.current),[Ve]=Fe.slice(-1),Ge=document.activeElement;for(const fe of we)if(fe===Ge||(fe==null||fe.scrollIntoView({block:"nearest"}),fe===Ie&&R&&(R.scrollTop=0),fe===Ve&&R&&(R.scrollTop=R.scrollHeight),fe==null||fe.focus(),document.activeElement!==Ge))return},[j,R]),q=p.useCallback(()=>K([I,C]),[K,I,C]);p.useEffect(()=>{M&&q()},[M,q]);const{onOpenChange:W,triggerPointerDownPosRef:te}=_;p.useEffect(()=>{if(C){let we={x:0,y:0};const Ie=Ve=>{var Ge,fe,je,ie;we={x:Math.abs(Math.round(Ve.pageX)-((Ge=(fe=te.current)===null||fe===void 0?void 0:fe.x)!==null&&Ge!==void 0?Ge:0)),y:Math.abs(Math.round(Ve.pageY)-((je=(ie=te.current)===null||ie===void 0?void 0:ie.y)!==null&&je!==void 0?je:0))}},Fe=Ve=>{we.x<=10&&we.y<=10?Ve.preventDefault():C.contains(Ve.target)||W(!1),document.removeEventListener("pointermove",Ie),te.current=null};return te.current!==null&&(document.addEventListener("pointermove",Ie),document.addEventListener("pointerup",Fe,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Ie),document.removeEventListener("pointerup",Fe,{capture:!0})}}},[C,W,te]),p.useEffect(()=>{const we=()=>W(!1);return window.addEventListener("blur",we),window.addEventListener("resize",we),()=>{window.removeEventListener("blur",we),window.removeEventListener("resize",we)}},[W]);const[O,V]=M7(we=>{const Ie=j().filter(Ge=>!Ge.disabled),Fe=Ie.find(Ge=>Ge.ref.current===document.activeElement),Ve=L7(Ie,we,Fe);Ve&&setTimeout(()=>Ve.ref.current.focus())}),H=p.useCallback((we,Ie,Fe)=>{const Ve=!U.current&&!Fe;(_.value!==void 0&&_.value===Ie||Ve)&&(P(we),Ve&&(U.current=!0))},[_.value]),L=p.useCallback(()=>C==null?void 0:C.focus(),[C]),ee=p.useCallback((we,Ie,Fe)=>{const Ve=!U.current&&!Fe;(_.value!==void 0&&_.value===Ie||Ve)&&D(we)},[_.value]),pe=r==="popper"?tF:QCe,xe=pe===tF?{side:l,sideOffset:c,align:u,alignOffset:d,arrowPadding:h,collisionBoundary:f,collisionPadding:m,sticky:g,hideWhenDetached:x,avoidCollisions:w}:{};return p.createElement(k7,{scope:n,content:C,viewport:R,onViewportChange:k,itemRefCallback:H,selectedItem:I,onItemLeave:L,itemTextRefCallback:ee,focusSelectedItem:q,selectedItemText:A,position:r,isPositioned:M,searchRef:O},p.createElement(LCe,{as:hg,allowPinchZoom:!0},p.createElement(cSe,{asChild:!0,trapped:_.open,onMountAutoFocus:we=>{we.preventDefault()},onUnmountAutoFocus:os(s,we=>{var Ie;(Ie=_.trigger)===null||Ie===void 0||Ie.focus({preventScroll:!0}),we.preventDefault()})},p.createElement(iSe,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:o,onFocusOutside:we=>we.preventDefault(),onDismiss:()=>_.onOpenChange(!1)},p.createElement(pe,Tn({role:"listbox",id:_.contentId,"data-state":_.open?"open":"closed",dir:_.dir,onContextMenu:we=>we.preventDefault()},v,xe,{onPlaced:()=>z(!0),ref:E,style:{display:"flex",flexDirection:"column",outline:"none",...v.style},onKeyDown:os(v.onKeyDown,we=>{const Ie=we.ctrlKey||we.altKey||we.metaKey;if(we.key==="Tab"&&we.preventDefault(),!Ie&&we.key.length===1&&V(we.key),["ArrowUp","ArrowDown","Home","End"].includes(we.key)){let Ve=j().filter(Ge=>!Ge.disabled).map(Ge=>Ge.ref.current);if(["ArrowUp","End"].includes(we.key)&&(Ve=Ve.slice().reverse()),["ArrowUp","ArrowDown"].includes(we.key)){const Ge=we.target,fe=Ve.indexOf(Ge);Ve=Ve.slice(fe+1)}setTimeout(()=>K(Ve)),we.preventDefault()}})}))))))}),QCe=p.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...s}=t,i=wd(Cf,n),o=bd(Cf,n),[l,c]=p.useState(null),[u,d]=p.useState(null),h=$s(e,E=>d(E)),f=i_(n),m=p.useRef(!1),g=p.useRef(!0),{viewport:x,selectedItem:w,selectedItemText:v,focusSelectedItem:_}=o,C=p.useCallback(()=>{if(i.trigger&&i.valueNode&&l&&u&&x&&w&&v){const E=i.trigger.getBoundingClientRect(),I=u.getBoundingClientRect(),P=i.valueNode.getBoundingClientRect(),A=v.getBoundingClientRect();if(i.dir!=="rtl"){const Ge=A.left-I.left,fe=P.left-Ge,je=E.left-fe,ie=E.width+je,$e=Math.max(ie,I.width),me=window.innerWidth-Fa,Ue=ML(fe,[Fa,me-$e]);l.style.minWidth=ie+"px",l.style.left=Ue+"px"}else{const Ge=I.right-A.right,fe=window.innerWidth-P.right-Ge,je=window.innerWidth-E.right-fe,ie=E.width+je,$e=Math.max(ie,I.width),me=window.innerWidth-Fa,Ue=ML(fe,[Fa,me-$e]);l.style.minWidth=ie+"px",l.style.right=Ue+"px"}const D=f(),j=window.innerHeight-Fa*2,M=x.scrollHeight,z=window.getComputedStyle(u),U=parseInt(z.borderTopWidth,10),K=parseInt(z.paddingTop,10),q=parseInt(z.borderBottomWidth,10),W=parseInt(z.paddingBottom,10),te=U+K+M+W+q,O=Math.min(w.offsetHeight*5,te),V=window.getComputedStyle(x),H=parseInt(V.paddingTop,10),L=parseInt(V.paddingBottom,10),ee=E.top+E.height/2-Fa,pe=j-ee,xe=w.offsetHeight/2,we=w.offsetTop+xe,Ie=U+K+we,Fe=te-Ie;if(Ie<=ee){const Ge=w===D[D.length-1].ref.current;l.style.bottom="0px";const fe=u.clientHeight-x.offsetTop-x.offsetHeight,je=Math.max(pe,xe+(Ge?L:0)+fe+q),ie=Ie+je;l.style.height=ie+"px"}else{const Ge=w===D[0].ref.current;l.style.top="0px";const je=Math.max(ee,U+x.offsetTop+(Ge?H:0)+xe)+Fe;l.style.height=je+"px",x.scrollTop=Ie-ee+x.offsetTop}l.style.margin=`${Fa}px 0`,l.style.minHeight=O+"px",l.style.maxHeight=j+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[f,i.trigger,i.valueNode,l,u,x,w,v,i.dir,r]);wo(()=>C(),[C]);const[T,R]=p.useState();wo(()=>{u&&R(window.getComputedStyle(u).zIndex)},[u]);const k=p.useCallback(E=>{E&&g.current===!0&&(C(),_==null||_(),g.current=!1)},[C,_]);return p.createElement(ZCe,{scope:n,contentWrapper:l,shouldExpandOnScrollRef:m,onScrollButtonChange:k},p.createElement("div",{ref:c,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:T}},p.createElement(Cs.div,Tn({},s,{ref:h,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}}))))}),tF=p.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Fa,...i}=t,o=UA(n);return p.createElement(vCe,Tn({},o,i,{ref:e,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[ZCe,BA]=Bf(Cf,{}),nF="SelectViewport",eEe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=bd(nF,n),i=BA(nF,n),o=$s(e,s.onViewportChange),l=p.useRef(0);return p.createElement(p.Fragment,null,p.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),p.createElement(s_.Slot,{scope:n},p.createElement(Cs.div,Tn({"data-radix-select-viewport":"",role:"presentation"},r,{ref:o,style:{position:"relative",flex:1,overflow:"auto",...r.style},onScroll:os(r.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=i;if(h!=null&&h.current&&d){const f=Math.abs(l.current-u.scrollTop);if(f>0){const m=window.innerHeight-Fa*2,g=parseFloat(d.style.minHeight),x=parseFloat(d.style.height),w=Math.max(g,x);if(w<m){const v=w+f,_=Math.min(m,v),C=v-_;d.style.height=_+"px",d.style.bottom==="0px"&&(u.scrollTop=C>0?C:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})}))))}),tEe="SelectGroup",[Jje,nEe]=Bf(tEe),rEe="SelectLabel",sEe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=nEe(rEe,n);return p.createElement(Cs.div,Tn({id:s.id},r,{ref:e}))}),i1="SelectItem",[iEe,R7]=Bf(i1),oEe=p.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...o}=t,l=wd(i1,n),c=bd(i1,n),u=l.value===r,[d,h]=p.useState(i??""),[f,m]=p.useState(!1),g=$s(e,v=>{var _;return(_=c.itemRefCallback)===null||_===void 0?void 0:_.call(c,v,r,s)}),x=e7(),w=()=>{s||(l.onValueChange(r),l.onOpenChange(!1))};return p.createElement(iEe,{scope:n,value:r,disabled:s,textId:x,isSelected:u,onItemTextChange:p.useCallback(v=>{h(_=>{var C;return _||((C=v==null?void 0:v.textContent)!==null&&C!==void 0?C:"").trim()})},[])},p.createElement(s_.ItemSlot,{scope:n,value:r,disabled:s,textValue:d},p.createElement(Cs.div,Tn({role:"option","aria-labelledby":x,"data-highlighted":f?"":void 0,"aria-selected":u&&f,"data-state":u?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1},o,{ref:g,onFocus:os(o.onFocus,()=>m(!0)),onBlur:os(o.onBlur,()=>m(!1)),onPointerUp:os(o.onPointerUp,w),onPointerMove:os(o.onPointerMove,v=>{if(s){var _;(_=c.onItemLeave)===null||_===void 0||_.call(c)}else v.currentTarget.focus({preventScroll:!0})}),onPointerLeave:os(o.onPointerLeave,v=>{if(v.currentTarget===document.activeElement){var _;(_=c.onItemLeave)===null||_===void 0||_.call(c)}}),onKeyDown:os(o.onKeyDown,v=>{var _;((_=c.searchRef)===null||_===void 0?void 0:_.current)!==""&&v.key===" "||(OCe.includes(v.key)&&w(),v.key===" "&&v.preventDefault())})}))))}),Sx="SelectItemText",aEe=p.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,...i}=t,o=wd(Sx,n),l=bd(Sx,n),c=R7(Sx,n),u=BCe(Sx,n),[d,h]=p.useState(null),f=$s(e,v=>h(v),c.onItemTextChange,v=>{var _;return(_=l.itemTextRefCallback)===null||_===void 0?void 0:_.call(l,v,c.value,c.disabled)}),m=d==null?void 0:d.textContent,g=p.useMemo(()=>p.createElement("option",{key:c.value,value:c.value,disabled:c.disabled},m),[c.disabled,c.value,m]),{onNativeOptionAdd:x,onNativeOptionRemove:w}=u;return wo(()=>(x(g),()=>w(g)),[x,w,g]),p.createElement(p.Fragment,null,p.createElement(Cs.span,Tn({id:c.textId},i,{ref:f})),c.isSelected&&o.valueNode&&!o.valueNodeHasChildren?xl.createPortal(i.children,o.valueNode):null)}),lEe="SelectItemIndicator",cEe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return R7(lEe,n).isSelected?p.createElement(Cs.span,Tn({"aria-hidden":!0},r,{ref:e})):null}),rF="SelectScrollUpButton",uEe=p.forwardRef((t,e)=>{const n=bd(rF,t.__scopeSelect),r=BA(rF,t.__scopeSelect),[s,i]=p.useState(!1),o=$s(e,r.onScrollButtonChange);return wo(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollTop>0;i(u)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(j7,Tn({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop-c.offsetHeight)}})):null}),sF="SelectScrollDownButton",dEe=p.forwardRef((t,e)=>{const n=bd(sF,t.__scopeSelect),r=BA(sF,t.__scopeSelect),[s,i]=p.useState(!1),o=$s(e,r.onScrollButtonChange);return wo(()=>{if(n.viewport&&n.isPositioned){let c=function(){const u=l.scrollHeight-l.clientHeight,d=Math.ceil(l.scrollTop)<u;i(d)};const l=n.viewport;return c(),l.addEventListener("scroll",c),()=>l.removeEventListener("scroll",c)}},[n.viewport,n.isPositioned]),s?p.createElement(j7,Tn({},t,{ref:o,onAutoScroll:()=>{const{viewport:l,selectedItem:c}=n;l&&c&&(l.scrollTop=l.scrollTop+c.offsetHeight)}})):null}),j7=p.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=t,i=bd("SelectScrollButton",n),o=p.useRef(null),l=i_(n),c=p.useCallback(()=>{o.current!==null&&(window.clearInterval(o.current),o.current=null)},[]);return p.useEffect(()=>()=>c(),[c]),wo(()=>{var u;const d=l().find(h=>h.ref.current===document.activeElement);d==null||(u=d.ref.current)===null||u===void 0||u.scrollIntoView({block:"nearest"})},[l]),p.createElement(Cs.div,Tn({"aria-hidden":!0},s,{ref:e,style:{flexShrink:0,...s.style},onPointerDown:os(s.onPointerDown,()=>{o.current===null&&(o.current=window.setInterval(r,50))}),onPointerMove:os(s.onPointerMove,()=>{var u;(u=i.onItemLeave)===null||u===void 0||u.call(i),o.current===null&&(o.current=window.setInterval(r,50))}),onPointerLeave:os(s.onPointerLeave,()=>{c()})}))}),hEe=p.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return p.createElement(Cs.div,Tn({"aria-hidden":!0},r,{ref:e}))}),D7=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=p.useRef(null),i=$s(e,s),o=_Ce(n);return p.useEffect(()=>{const l=s.current,c=window.HTMLSelectElement.prototype,d=Object.getOwnPropertyDescriptor(c,"value").set;if(o!==n&&d){const h=new Event("change",{bubbles:!0});d.call(l,n),l.dispatchEvent(h)}},[o,n]),p.createElement(SCe,{asChild:!0},p.createElement("select",Tn({},r,{ref:i,defaultValue:n})))});D7.displayName="BubbleSelect";function M7(t){const e=ml(t),n=p.useRef(""),r=p.useRef(0),s=p.useCallback(o=>{const l=n.current+o;e(l),function c(u){n.current=u,window.clearTimeout(r.current),u!==""&&(r.current=window.setTimeout(()=>c(""),1e3))}(l)},[e]),i=p.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return p.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function L7(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=fEe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.textValue.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function fEe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}const mEe=zCe,F7=WCe,pEe=qCe,gEe=KCe,yEe=YCe,O7=JCe,xEe=eEe,$7=sEe,V7=oEe,vEe=aEe,wEe=cEe,U7=uEe,B7=dEe,z7=hEe,xc=mEe,vc=pEe,tl=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(F7,{ref:r,className:bt("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,a.jsx(gEe,{asChild:!0,children:a.jsx(Pu,{className:"h-4 w-4 opacity-50"})})]}));tl.displayName=F7.displayName;const G7=ht.forwardRef(({className:t,...e},n)=>a.jsx(U7,{ref:n,className:bt("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(G3,{className:"h-4 w-4"})}));G7.displayName=U7.displayName;const W7=ht.forwardRef(({className:t,...e},n)=>a.jsx(B7,{ref:n,className:bt("flex cursor-default items-center justify-center py-1",t),...e,children:a.jsx(Pu,{className:"h-4 w-4"})}));W7.displayName=B7.displayName;const nl=ht.forwardRef(({className:t,children:e,position:n="popper",...r},s)=>a.jsx(yEe,{children:a.jsxs(O7,{ref:s,className:bt("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[a.jsx(G7,{}),a.jsx(xEe,{className:bt("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),a.jsx(W7,{})]})}));nl.displayName=O7.displayName;const bEe=ht.forwardRef(({className:t,...e},n)=>a.jsx($7,{ref:n,className:bt("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));bEe.displayName=$7.displayName;const nr=ht.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(V7,{ref:r,className:bt("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(wEe,{children:a.jsx(Pg,{className:"h-4 w-4"})})}),a.jsx(vEe,{children:e})]}));nr.displayName=V7.displayName;const _Ee=ht.forwardRef(({className:t,...e},n)=>a.jsx(z7,{ref:n,className:bt("-mx-1 my-1 h-px bg-muted",t),...e}));_Ee.displayName=z7.displayName;const SEe=({isOpen:t,onClose:e,designs:n,onContinue:r})=>{const[s,i]=p.useState([]),[o,l]=p.useState({}),[c,u]=p.useState(""),[d,h]=p.useState(null),{toast:f}=Ss();p.useEffect(()=>{n&&i(n)},[n]);const m=(_,C)=>{const T=so.find(R=>R.name===C);T&&i(R=>{const k=[...R];return k[_].podProductInfo=T,k[_].name=T.name,k})},g=_=>{const C=s[_],T={...C,id:Pt()};i(R=>[...R,T]),f({title:"Design Duplicated",description:`A copy of ${C.name} has been added.`})},x=_=>{const C=s[_];i(T=>T.filter((R,k)=>k!==_)),f({title:"Design Removed",description:`${C.name} has been removed.`,variant:"destructive"})},w=async _=>{if(!c){f({title:"Prompt Required",description:"Please enter a prompt to edit the image.",variant:"destructive"});return}l({[_]:{edit:!0}});const C=s[_];try{const{base64ImageData:T,mimeType:R}=await dg(C.images[0]),k=await Wo(T,R,c);if(k&&k.editedImageData){const E=[...s],I=`data:${k.newMimeType};base64,${k.editedImageData}`;E[_].images[0]=I,i(E),f({title:"Design Edited",description:"The design has been updated.",variant:"success"})}else throw new Error("Failed to get edited image data.")}catch(T){console.error("Error editing design:",T),f({title:"Edit Failed",description:T.message,variant:"destructive"})}finally{l({}),h(null),u("")}},v=async _=>{if(!c){f({title:"Prompt Required",description:"Please enter a prompt to replace the image.",variant:"destructive"});return}l({[_]:{replace:!0}});try{const C=await Rg({prompt:c});if(C&&C.imageData){const T=[...s],R=`data:${C.imageMimeType};base64,${C.imageData}`;T[_].images[0]=R,i(T),f({title:"Design Replaced",description:"A new design has been generated.",variant:"success"})}else throw new Error("Failed to get new image data.")}catch(C){console.error("Error replacing design:",C),f({title:"Replace Failed",description:C.message,variant:"destructive"})}finally{l({}),h(null),u("")}};return t?a.jsx(zr,{open:t,onOpenChange:_=>!_&&e(),children:a.jsxs(Dr,{className:"max-w-4xl",children:[a.jsxs(Mr,{children:[a.jsx(Lr,{children:"Review and Edit Your Designs"}),a.jsx(_i,{children:"Modify the generated designs before we create your logo and products."})]}),a.jsx(ws,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pr-4",children:s.map((_,C)=>{var T,R,k,E;return a.jsxs(Ke,{className:"p-4 space-y-3 flex flex-col",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:_.images[0],alt:`Design for ${_.name}`,className:"w-full h-48 object-contain rounded-md border"}),a.jsx($,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6",onClick:()=>x(C),children:a.jsx(Bn,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow space-y-2",children:[a.jsx("h4",{className:"font-semibold",children:_.name}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:`product-type-${C}`,className:"text-sm font-medium",children:"Product Type"}),a.jsxs(xc,{value:_.podProductInfo.name,onValueChange:I=>m(C,I),children:[a.jsx(tl,{children:a.jsx(vc,{placeholder:"Select product type"})}),a.jsx(nl,{children:so.map(I=>a.jsx(nr,{value:I.name,children:I.name},I.name))})]})]})]}),d===C?a.jsxs("div",{className:"space-y-2 mt-auto",children:[a.jsx(Cn,{placeholder:"Enter prompt to edit or replace...",value:c,onChange:I=>u(I.target.value)}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{onClick:()=>w(C),disabled:(T=o[C])==null?void 0:T.edit,children:[(R=o[C])!=null&&R.edit?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(rw,{className:"mr-2 h-4 w-4"}),"Apply Edit"]}),a.jsxs($,{onClick:()=>v(C),disabled:(k=o[C])==null?void 0:k.replace,children:[(E=o[C])!=null&&E.replace?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Q3,{className:"mr-2 h-4 w-4"}),"Replace"]}),a.jsx($,{variant:"ghost",onClick:()=>h(null),children:"Cancel"})]})]}):a.jsxs($,{onClick:()=>{h(C),u("")},className:"w-full",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"})," Edit or Replace"]}),a.jsxs($,{onClick:()=>g(C),variant:"outline",className:"w-full mt-2",children:[a.jsx(FI,{className:"mr-2 h-4 w-4"})," Duplicate"]})]},_.id||C)})})}),a.jsxs(Nr,{children:[a.jsx($,{type:"button",variant:"outline",onClick:e,children:"Cancel Generation"}),a.jsx($,{type:"button",onClick:()=>r(s),children:"Continue with These Designs"})]})]})}):null},sr="/placeholder-image.png",H7=p.createContext(null),$n=()=>{const t=p.useContext(H7);if(!t)throw new Error("useStore must be used within a StoreProvider");return t},iF="ecommerce-cart",CEe=({children:t})=>{const[e,n]=p.useState([]),[r,s]=p.useState(null),[i,o]=p.useState(!1),[l,c]=p.useState(0),[u,d]=p.useState(""),[h,f]=p.useState(!1),[m,g]=p.useState([]),[x,w]=p.useState("published"),{toast:v}=Ss(),_=wi(),{user:C,session:T,profile:R}=ls(),k=de=>{de==="published"||de==="edit"?w(de):(console.warn(`Invalid view mode: ${de}. Defaulting to 'published'.`),w("published"))},[E,I]=p.useState(0),[P,A]=p.useState(""),[D,j]=p.useState(""),[M,z]=p.useState(null),[U,K]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[q,W]=p.useState({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[te,O]=p.useState(null),[V,H]=p.useState(!1),[L,ee]=p.useState(null),[pe,xe]=p.useState(null),[we,Ie]=p.useState(!1),[Fe,Ve]=p.useState(null),[Ge,fe]=p.useState(null),[je,ie]=p.useState(!1),[$e,me]=p.useState(!1),[Ue,et]=p.useState(!1),[ct,Mt]=p.useState([]),[Sn,en]=p.useState(null),[rn,kt]=p.useState(!1),[xn,re]=p.useState(!1),[Se,B]=p.useState([]),[X,ne]=p.useState(null),[Y,Ne]=p.useState(!1),ce=p.useCallback(({newProducts:de,newCollection:ae})=>{Mt(oe=>[...oe,...de]),en(oe=>({...oe,collections:[...(oe==null?void 0:oe.collections)||[],ae]})),v({title:"POD Items Added",description:`${de.length} products and 1 collection are ready for finalization.`,variant:"success"})},[Mt,en,v]),[Ee,Re]=p.useState(0),[Be,_t]=p.useState(""),[mt,Ht]=p.useState(""),[tn,Rt]=p.useState(null),[sn,In]=p.useState({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),[Fr,zn]=p.useState(!1),[wr,un]=p.useState(null),Nn=async(de,ae)=>{if(!de||!ae)return console.error("Missing base64 string or path for Firebase Storage upload."),null;const oe=de.split(",")[1];if(!oe)return console.error("Invalid base64 string provided for upload."),null;const ue=yh(xh,ae),Pe={contentType:"image/png"};try{const Oe=atob(oe),ze=new Array(Oe.length);for(let Lt=0;Lt<Oe.length;Lt++)ze[Lt]=Oe.charCodeAt(Lt);const tt=new Uint8Array(ze),Ze=await ph(ue,tt,Pe),pt=await gh(Ze.ref);return console.log(`Uploaded ${ae} to Firebase Storage. URL: ${pt}`),pt}catch(Oe){throw console.error(`Error uploading ${ae} to Firebase Storage:`,Oe),Oe}},dn=p.useCallback(de=>de?de.map(ae=>{const oe={...ae};if(oe.logo_url&&oe.logo_url.startsWith("data:image/")&&oe.logo_url.length>2048&&(oe.logo_url=`${oe.logo_url.substring(0,30)}...[truncated]`),oe.hero_image&&oe.hero_image.src){const ue={...oe.hero_image.src};ue.large&&ue.large.startsWith("data:image/")&&ue.large.length>2048&&(ue.large=`${ue.large.substring(0,30)}...[truncated]`),ue.medium&&ue.medium.startsWith("data:image/")&&ue.medium.length>2048&&(ue.medium=`${ue.medium.substring(0,30)}...[truncated]`),oe.hero_image={...oe.hero_image,src:ue}}return oe.products&&Array.isArray(oe.products)&&(oe.products=oe.products.map(ue=>{const Pe={...ue};if(Pe.image&&Pe.image.src){const Oe={...Pe.image.src};Oe.medium&&Oe.medium.startsWith("data:image/")&&Oe.medium.length>2048&&(Oe.medium=`${Oe.medium.substring(0,30)}...[truncated]`),Oe.large&&Oe.large.startsWith("data:image/")&&Oe.large.length>2048&&(Oe.large=`${Oe.large.substring(0,30)}...[truncated]`),Pe.image={...Pe.image,src:Oe}}return Pe})),oe.collections&&Array.isArray(oe.collections)&&(oe.collections=oe.collections.map(ue=>{const{products:Pe,...Oe}=ue;return Oe})),oe}):[],[]),cs=p.useCallback(async()=>{f(!0),console.log("[StoreContext] loadStores called for all public stores.");let de=[],ae=[];const oe=localStorage.getItem("ecommerce-stores");if(oe)try{de=JSON.parse(oe),console.log(`[StoreContext] Loaded ${de.length} stores from localStorage.`)}catch(Pe){console.error("[StoreContext] Failed to parse localStorage stores:",Pe),v({title:"Local Cache Error",description:"Failed to load stores from local cache.",variant:"warning"}),de=[]}n(de),console.log("[StoreContext] Fetching all public stores from Firestore.");try{const Pe=ki(gn,"stores"),Oe=await Ri(Pe);if(Oe.empty)console.log("[StoreContext] No public stores found in Firestore.");else{console.log(`[StoreContext] Fetched ${Oe.size} stores from Firestore. Processing details...`);const ze=Oe.docs.map(Ze=>({id:Ze.id,...Ze.data()}));ae=await Promise.all(ze.map(async Ze=>{var pt,Lt;try{const Bt=ki(gn,"stores",Ze.id,"products"),nt=(await Ri(Bt)).docs.map(Tt=>({id:Tt.id,...Tt.data()})).map(Tt=>{let kn={src:{large:"",medium:""}};return Tt.images&&Array.isArray(Tt.images)&&Tt.images.length>0&&(kn.src.large=Tt.images[0],kn.src.medium=Tt.images[0]),{...Tt,price:Tt.priceAmount,image:kn,variants:Tt.variants||[]}}),xt={...Ze,createdAt:((Lt=(pt=Ze.created_at)==null?void 0:pt.toDate())==null?void 0:Lt.toISOString())||new Date().toISOString()};let cn=[];const Hr=ki(gn,"stores",Ze.id,"collections"),ts=(await Ri(Hr)).docs.map(Tt=>({id:Tt.id,...Tt.data()}));return ts&&ts.length>0&&(cn=await Promise.all(ts.map(async Tt=>{let kn=[];return Tt.product_ids&&Tt.product_ids.length>0&&(kn=nt.filter(hr=>Tt.product_ids.includes(hr.id))),{...Tt,image:{src:Tt.image_url||""},products:kn}}))),{...xt,products:nt,collections:cn}}catch(Bt){return console.error(`[StoreContext] Critical error processing details for store ${Ze.id}:`,Bt),{...Ze,products:[],collections:[]}}})),console.log(`[StoreContext] Finished processing details for ${ae.length} cloud stores.`)}}catch(Pe){console.error("[StoreContext] Overall critical error in fetching cloud stores:",Pe),v({title:"Cloud Loading Error",description:"A critical error occurred while fetching cloud store data.",variant:"destructive"})}const ue=[...de];ae.forEach(Pe=>{const Oe=ue.findIndex(ze=>ze.id===Pe.id);Oe>-1?ue[Oe]=Pe:ue.push(Pe)}),ue.sort((Pe,Oe)=>new Date(Oe.createdAt||Oe.created_at)-new Date(Pe.createdAt||Pe.created_at)),n(ue);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dn(ue))),console.log("[StoreContext] Updated localStorage with merged stores.")}catch(Pe){console.error("[StoreContext] Failed to save merged stores to localStorage:",Pe),v({title:"Local Cache Update Failed",description:"Could not update the local cache after cloud sync.",variant:"warning",duration:7e3})}f(!1),console.log(`[StoreContext] loadStores finished. isLoadingStores: false. Final stores count: ${e.length}`)},[v,gn,dn]),Z=p.useCallback(async(de,ae)=>{var Pe,Oe;const oe=e.find(ze=>ze.id===de);if(!oe){console.warn(`[StoreContext] updateStore: Store with ID ${de} not found in current state.`),v({title:"Update Failed",description:"Store not found for update.",variant:"destructive"});return}const ue={...oe,...ae};if(console.log(`[StoreContext] updateStore: updatedLocalStore for store ${de} - Products: ${((Pe=ue.products)==null?void 0:Pe.length)||0}, Collections: ${((Oe=ue.collections)==null?void 0:Oe.length)||0}`),n(ze=>{const tt=ze.map(Ze=>Ze.id===de?ue:Ze);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dn(tt))),console.log(`[StoreContext] updateStore: Saved ${tt.length} stores to localStorage.`)}catch(Ze){console.error("Failed to save stores to localStorage during update:",Ze),v({title:"Local Cache Update Failed",description:"Could not update the local cache for the store.",variant:"warning",duration:7e3})}return tt}),r&&r.id===de&&(s(ue),console.log(`[StoreContext] updateStore: currentStore updated for store ${de}.`)),v({title:"Store Updated (Locally)",description:"Changes saved locally."}),C){f(!0);try{const{settings:ze,products:tt,collections:Ze,user_id:pt,...Lt}=ae,Bt=rs(gn,"stores",de);await Zd(Bt,Lt),console.log(`Store ${de} synced to Firestore asynchronously.`)}catch(ze){console.error("Unexpected error during async Firestore updateStore:",ze),v({title:"Cloud Sync Error",description:"An unexpected error occurred during cloud sync.",variant:"destructive"})}finally{f(!1)}}},[e,C,v,r,s,n,f,dn]),he=async(de,ae,oe,ue,Pe)=>{if(!ue){Pe({title:"Authentication Required",description:"You must be logged in to update collections.",variant:"destructive"});return}n(Oe=>{const ze=Oe.map(tt=>{if(tt.id===de){const Ze=tt.collections.map(pt=>pt.id===ae?{...pt,products:oe}:pt);return{...tt,collections:Ze}}return tt});return localStorage.setItem("ecommerce-stores",JSON.stringify(dn(ze))),ze}),r&&r.id===de&&s(Oe=>{const ze=Oe.collections.map(tt=>tt.id===ae?{...tt,products:oe}:tt);return{...Oe,collections:ze}});try{const Oe=rs(gn,"stores",de,"collections",ae),ze=oe.map(tt=>tt.id);await Zd(Oe,{product_ids:ze}),Pe({title:"Collection Updated",description:"Your collection has been successfully updated."})}catch(Oe){console.error("Error updating collection in Firestore:",Oe),Pe({title:"Error",description:"Failed to update the collection in the cloud.",variant:"destructive"})}},_e=p.useCallback(async(de,ae)=>{if(!r||!r.id){v({title:"Error",description:"No current store selected to update.",variant:"destructive"});return}if(typeof de!="string"||de.trim()===""){v({title:"Error",description:"Invalid identifier for text content.",variant:"destructive"});return}const oe=r.id,ue=typeof r.content=="object"&&r.content!==null?r.content:{};let Pe=JSON.parse(JSON.stringify(ue));const Oe=de.split(".");let ze=Pe;for(let tt=0;tt<Oe.length-1;tt++){const Ze=Oe[tt];(!ze[Ze]||typeof ze[Ze]!="object")&&(ze[Ze]={}),ze=ze[Ze]}ze[Oe[Oe.length-1]]=ae,await Z(oe,{content:Pe})},[r,Z,v]);p.useEffect(()=>{console.log("[StoreContext] Component mounted, triggering loadStores."),cs()},[cs]),p.useEffect(()=>{localStorage.setItem(iF,JSON.stringify(m))},[m]),p.useEffect(()=>{const de=localStorage.getItem(iF);if(de)try{g(JSON.parse(de))}catch(ae){console.error("Failed to parse stored cart:",ae)}},[]);const Me=async de=>{let ae={...de};try{const nt=ae.type||ae.name||"business",xt=await lo(nt,1);xt.length>0&&(ae.card_background_url=xt[0].src.large)}catch(nt){console.error("Failed to fetch background image from Pexels:",nt),ae.card_background_url=sr}const oe=ae.name||`Store-${Pt().substring(0,6)}`;ae.name||(ae.name=oe);const ue=await Qe(oe);if(!ue.available){const nt=ue.error===!0?`Failed to verify store name "${oe}". Please try again.`:`The store name "${oe}" or a similar URL is already in use. Please choose a different name.`;throw v({title:"Store Name Unavailable",description:nt,variant:"destructive"}),new Error(nt)}ae.urlSlug=ue.slug,ae.template_version||(ae.template_version="v1");const Pe=await b_e(ae);if(Pe.tags&&Pe.tags.length>0)ae.tags=Pe.tags;else{const nt=ae.niche||"",xt=AA.filter(cn=>nt.toLowerCase().includes(cn.toLowerCase()));xt.length===0&&xt.push("general"),ae.tags=xt}ae.niche=ae.tags[0];const Oe=ae.id||Pt();let ze={...ae,id:Oe,createdAt:new Date().toISOString()},tt=ze.products||[];const Ze=new Map;let pt=[];if(tt=tt.map(nt=>({...nt,id:nt.id||Pt()})),tt.forEach(nt=>{Ze.set(nt.name,nt.id)}),C&&C.uid){ze.merchant_id=C.uid;try{const{id:nt,settings:xt,products:cn,collections:Hr,user_id:kr,...ts}=ze,Tt=rs(gn,"stores",nt);let kn=ts.logo_url;if(kn&&kn.startsWith("data:image/"))try{const Qn=`store_logos/${nt}/logo_${Pt()}.png`;kn=await Nn(kn,Qn)}catch(Qn){console.error("Error uploading store logo to Firebase Storage:",Qn),v({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),kn=sr}else kn||(kn=sr);let hr=ts.logo_url_light;if(hr&&hr.startsWith("data:image/"))try{const Qn=`store_logos/${nt}/logo_light_${Pt()}.png`;hr=await Nn(hr,Qn)}catch(Qn){console.error("Error uploading store logo to Firebase Storage:",Qn),v({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),hr=sr}let Ii=ts.logo_url_dark;if(Ii&&Ii.startsWith("data:image/"))try{const Qn=`store_logos/${nt}/logo_dark_${Pt()}.png`;Ii=await Nn(Ii,Qn)}catch(Qn){console.error("Error uploading store logo to Firebase Storage:",Qn),v({title:"Logo Upload Failed",description:"Could not upload store logo.",variant:"warning"}),Ii=sr}const Td={...ts,merchant_id:C.uid,created_at:new Date,logo_url:kn||sr,logo_url_light:hr,logo_url_dark:Ii,urlSlug:ze.urlSlug,name_lowercase:ze.name.toLowerCase(),card_background_url:ze.card_background_url,tags:ze.tags};if(await Fh(Tt,Td),console.log(`Store ${nt} saved to Firestore asynchronously.`),ze.products&&ze.products.length>0){const Qn=[];for(const Fn of ze.products){let Wn=[];if(Fn.images&&Array.isArray(Fn.images))for(const Zo of Fn.images)if(Zo.startsWith("data:image/"))try{const Ni=`store_products/${nt}/${Fn.id||Pt()}/${Pt()}.png`,Zn=await Nn(Zo,Ni);Zn?Wn.push(Zn):Wn.push(sr)}catch(Ni){console.error(`Error uploading product image for ${Fn.name}:`,Ni),v({title:"Product Image Upload Failed",description:`Could not upload image for ${Fn.name}.`,variant:"warning"}),Wn.push(sr)}else Zo?Wn.push(Zo):Wn.push(sr);Wn.length===0&&Wn.push(sr);const to={store_id:nt,name:Fn.name||`Product ${Pt().substring(0,8)}`,description:Fn.description||"No description available.",images:Wn,priceAmount:Number(Fn.price)>=0?Number(Fn.price):0,currency:"usd",inventory:10,variants:Fn.variants||[],created_at:new Date},So=rs(gn,"stores",nt,"products",Fn.id||Pt());Qn.push(Fh(So,to)),Ze.set(Fn.name,So.id)}await Promise.all(Qn)}if(ze.collections&&ze.collections.length>0){const Qn=[];for(const Fn of ze.collections){let Wn=Fn.imageUrl;if(Wn&&Wn.startsWith("data:image/"))try{const Ni=`store_collections/${nt}/${Fn.id||Pt()}/${Pt()}.png`;Wn=await Nn(Wn,Ni)}catch(Ni){console.error("Error uploading collection image to Firebase Storage:",Ni),v({title:"Collection Image Upload Failed",description:"Could not upload collection image.",variant:"warning"}),Wn=sr}else Wn||(Wn=sr);const to=(Fn.product_ids||[]).map(Ni=>Ze.get(Ni)).filter(Boolean),So={store_id:nt,name:Fn.name,description:Fn.description,image_url:Wn||sr,product_ids:to,created_at:new Date},Zo=rs(gn,"stores",nt,"collections",Fn.id||Pt());Qn.push(Fh(Zo,So)),pt.push({id:Zo.id,...So})}await Promise.all(Qn)}}catch(nt){console.error("Overall async Firestore store creation error. Code:",nt.code,"Message:",nt.message,"Full Error:",nt),setTimeout(()=>{v({title:"Cloud Sync Error",description:`Firestore error (${nt.code||"Unknown Code"}): ${nt.message}`,variant:"destructive"})},0)}}else C&&!C.uid&&(console.error("Firestore save skipped: User object is present but user.uid is undefined."),setTimeout(()=>{v({title:"User UID Missing",description:"Cannot save to cloud: User UID is missing. Please try logging out and back in.",variant:"destructive"})},0));let Lt=[];const Bt=ze.collections||[],An=tt.map(nt=>{const xt=Array.isArray(nt.images)&&nt.images.length>0?nt.images[0]:sr;return{...nt,image:{src:{medium:xt,large:xt}}}});Bt.length>0&&(Lt=Bt.map(nt=>{let xt={};if(C&&pt&&pt.length>0){const kr=pt.find(ts=>ts.name===nt.name);kr&&(xt=kr)}let cn=[];nt.product_ids&&nt.product_ids.length>0&&nt.product_ids.forEach(kr=>{const ts=Ze.get(kr);let Tt=null;ts?(Tt=An.find(kn=>kn.id===ts),Tt||kr!==ts&&(Tt=An.find(kn=>kn.id===kr))):Tt=An.find(kn=>kn.id===kr),Tt&&cn.push(Tt)});const Hr=(xt==null?void 0:xt.image_url)||nt.imageUrl||"";return{...nt,...xt,image:{src:Hr},products:cn}}));const Gn={...ze,products:An,collections:Lt};return n(nt=>{const xt=[Gn,...nt.filter(cn=>cn.id!==Gn.id)];try{localStorage.setItem("ecommerce-stores",JSON.stringify(dn(xt)))}catch(cn){console.error("Failed to save stores to localStorage during store creation:",cn),v({title:"Local Cache Update Failed",description:"Could not update the local cache after creating the store.",variant:"warning",duration:7e3})}return xt}),s(Gn),Gn},Qe=async de=>{if(!de||typeof de!="string"||de.trim()==="")return{available:!0,slug:"",error:"Name cannot be empty."};const ae=mc(de.trim());if(!ae)return{available:!0,slug:"",error:"Invalid name for URL generation."};try{const oe=ki(gn,"stores"),ue=vT(oe,wT("urlSlug","==",ae));return{available:(await Ri(ue)).empty,slug:ae}}catch(oe){return console.error("Error checking store name availability:",oe),v({title:"Name Check Failed",description:"Could not verify store name uniqueness.",variant:"destructive"}),{available:!1,slug:ae,error:!0}}},Q=async de=>{var ae,oe;o(!0),c(0),d("Initializing wizard-based store generation...");try{const ue=await L_e(de,{fetchPexelsImages:lo,generateId:Pt}),Pe=await Me(ue);return c(100),d("Store generation complete!"),Pe}catch(ue){return console.error("Error generating store from wizard:",ue),!((ae=ue.message)!=null&&ae.includes("already in use"))&&!((oe=ue.message)!=null&&oe.includes("Failed to verify store name"))&&v({title:"Wizard Generation Failed",description:ue.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),null}finally{o(!1)}},se=async(de,ae=null,oe=null,ue=[],Pe=!1,Oe=!1,ze=[],tt=[])=>{o(!0),c(0),d("Initializing generation...");try{if(Pe){d("Generating initial designs...");const pt=[so.find(Bt=>Bt.name==="Canvas"),so.find(Bt=>Bt.name==="Hat"),so.find(Bt=>Bt.name==="Black hoodie"),so.find(Bt=>Bt.name==="Mug"),so.find(Bt=>Bt.name==="Notebook"),so.find(Bt=>Bt.name==="Pillow")].filter(Boolean);let Lt=[];if(pt.length>0){const Bt=pt.slice(0,6);let An=null;if(ze&&ze.length>0){const Gn=ze.find(nt=>nt.file.type.startsWith("image/"));if(Gn)try{const{base64ImageData:nt,mimeType:xt}=await v_e(Gn.file);An={base64Data:nt,mimeType:xt},d("Processing reference image...")}catch(nt){console.error("Error processing reference image:",nt),v({title:"Image Error",description:"Could not process the uploaded reference image.",variant:"destructive"})}}for(const[Gn,nt]of Bt.entries()){c(Gn/Bt.length*100),d(`Generating design for ${nt.name}...`);const xt=await Rg({prompt:de,referenceImage:An});if(xt&&xt.imageData){const cn=`data:${xt.imageMimeType};base64,${xt.imageData}`;Lt.push({id:Pt(),name:nt.name,images:[cn],podProductInfo:nt})}}}ne({prompt:de,storeNameOverride:ae,productTypeOverride:oe}),B(Lt),re(!0),o(!1);return}let Ze;if(tt.length>0){const pt=(An,Gn)=>{c(An),Gn&&d(Gn)};Ze=await XS(de,{storeNameOverride:ae,productTypeOverride:oe,fetchPexelsImages:lo,generateId:Pt,isPrintOnDemand:!1,isDropshipping:!0,contextFiles:ze,contextURLs:[],generateProducts:!1},pt);const Lt=tt.map(An=>({id:String(An.item.itemId),name:An.item.title,description:An.item.title,price:parseFloat(An.item.sku.def.promotionPrice)||0,images:[An.item.image],isDropshipping:!0,inventory:10}));Ze.products=Lt;const Bt=await QS(Ze.type,Ze.name,Lt,!1,!0,pt,70,20,Pt);Ze.collections=Bt}else{const pt=(Lt,Bt)=>{c(Lt),Bt&&d(Bt)};if(Ze=await XS(de,{storeNameOverride:ae,productTypeOverride:oe,fetchPexelsImages:lo,generateId:Pt,isPrintOnDemand:!1,contextFiles:ze,contextURLs:[]},pt),Ze.products.length>0){const Lt=await QS(Ze.type,Ze.name,Ze.products,Pe,Oe,pt,70,20,Pt);Ze.collections=Lt}}Mt(Ze.products||[]),en(Ze),o(!1),et(!0),d("Products generated. Please review and finalize."),c(90)}catch(Ze){console.error("Error generating store from prompt:",Ze),v({title:"Generation Failed",description:Ze.message||"Failed to generate store.",variant:"destructive"}),c(0),d("Generation failed."),o(!1)}},ye=async de=>{re(!1),o(!0),c(0),d("Re-visualizing designs on products...");const{prompt:ae,storeNameOverride:oe,productTypeOverride:ue}=X;let Pe=[];try{for(const[Ze,pt]of de.entries()){const Lt=Ze/de.length*50;c(Lt);const Bt=pt.podProductInfo,An=pt.images[0],{base64ImageData:Gn,mimeType:nt}=await dg(An);d(`Visualizing design on ${Bt.name}...`);const xt=await tf(Gn,nt,Bt.imageUrl,ae,Bt.name);if(xt&&xt.visualizedImageData&&xt.productDetails){const cn=`data:${xt.visualizedImageMimeType};base64,${xt.visualizedImageData}`;Pe.push({id:Pt(),name:xt.productDetails.title||`${Bt.name} with design`,description:xt.productDetails.description||`A unique ${Bt.name}.`,price:xt.productDetails.price||"29.99",images:[An,cn],variants:xt.productDetails.variants||[],isPrintOnDemand:!0,inventory:10,podDetails:{originalDesignImageUrl:An,designPrompt:ae,baseProductName:Bt.name,baseProductImageUrl:Bt.imageUrl},category:Bt.category||"Print on Demand"})}}const Oe=(Ze,pt)=>{c(50+Ze/2),pt&&d(pt)};let ze=await XS(ae,{storeNameOverride:oe,productTypeOverride:ue,fetchPexelsImages:lo,generateId:Pt,isPrintOnDemand:!0},Oe);const tt=[...Pe,...ze.products||[]];if(ze.products=tt,ze.products.length>0){const Ze=await QS(ze.type,ze.name,ze.products,!0,!1,Oe,80,10,Pt);ze.collections=Ze}Mt(tt),en(ze),o(!1),et(!0),d("Products generated. Please review and finalize."),c(90)}catch(Oe){console.error("Error continuing store generation:",Oe),v({title:"Generation Failed",description:Oe.message||"Failed to continue store generation.",variant:"destructive"}),c(0),d("Generation failed."),o(!1)}},J=async(de,ae,oe,ue=null)=>{if(!de)return v({title:"Error",description:"Missing design image for POD collection generation.",variant:"destructive"}),null;if(ue===null)console.log("Generating POD collection data for pre-finalization stage.");else{if(!ue)return v({title:"Error",description:"Store ID is invalid for updating POD collection.",variant:"destructive"}),null;console.log(`Generating POD collection for existing store: ${ue}`)}kt(!0),v({title:"Generating POD Collection",description:"Applying design to all mockups..."});let Pe=[],Oe=`Collection from ${oe} Design`;try{const{base64ImageData:ze,mimeType:tt}=await dg(de);for(const pt of so){if(pt.name===oe){console.log(`Skipping visualization for base product: ${oe}`);continue}console.log(`Visualizing design on mockup: ${pt.name}`);const Lt=await tf(ze,tt,pt.imageUrl,ae||`Product based on ${oe} design`,pt.name);if(Lt&&Lt.visualizedImageData&&Lt.productDetails){const Bt=`data:${Lt.visualizedImageMimeType};base64,${Lt.visualizedImageData}`;Pe.push({id:Pt(),name:Lt.productDetails.title,price:parseFloat(Lt.productDetails.price),description:Lt.productDetails.description,images:[Bt],isPrintOnDemand:!0,inventory:10,podDetails:{originalDesignImageUrl:de,designPrompt:ae,baseProductName:pt.name,baseProductImageUrl:pt.imageUrl},variants:Lt.productDetails.variants||[]})}else console.warn(`Failed to visualize design on ${pt.name} for collection. Error: ${Lt==null?void 0:Lt.error}`)}if(Pe.length===0)return v({title:"Collection Generation Incomplete",description:"Could not create any new products for the collection.",variant:"warning"}),null;const Ze={id:Pt(),name:Oe,description:`A collection of products featuring the design from ${oe}. Original design prompt: ${ae||"N/A"}`,imageUrl:Pe[0].images[0]||sr,product_ids:Pe.map(pt=>pt.id)};if(ue||(Ze.products=[...Pe]),ue){const pt=e.find(An=>An.id===ue);if(!pt)throw new Error("Store not found to add the new collection.");const Lt=[...pt.products||[],...Pe],Bt=[...pt.collections||[],Ze];return await Z(ue,{products:Lt,collections:Bt}),v({title:"POD Collection Created",description:`Collection "${Oe}" with ${Pe.length} products added to store.`,variant:"success"}),{success:!0}}else return v({title:"POD Items Generated",description:`${Pe.length} products and 1 collection ready.`,variant:"info"}),{newProducts:Pe,newCollection:Ze}}catch(ze){return console.error("Error generating POD collection from design:",ze),v({title:"POD Collection Error",description:ze.message,variant:"destructive"}),null}finally{kt(!1)}},le=p.useCallback(()=>{I(0),A(""),j(""),z(null),K({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),W({edges:[],pageInfo:{hasNextPage:!1,endCursor:null}}),O(null),H(!1),ee(null),xe(null),Ie(!1),Ve(null)},[]),be=p.useCallback(async(de,ae)=>{A(de),j(ae),H(!0),ee(null),z(null);try{v({title:"Connecting to Shopify...",description:"Fetching store information."});const oe=await F_e(de,ae);if(!oe)throw new Error("Failed to fetch Shopify store metadata. The store might not exist or the token might be invalid.");return z(oe),I(2),!0}catch(oe){return console.error("Error starting Shopify import wizard (fetching metadata):",oe),ee(oe.message||"Failed to connect to Shopify and fetch store information."),v({title:"Connection Failed",description:oe.message||"Could not fetch store information.",variant:"destructive"}),!1}finally{H(!1)}},[v,A,j,H,ee,z,I]),Te=p.useCallback(()=>{Re(0),_t(""),Ht(""),Rt(null),In({items:[],pageInfo:{hasNextPage:!1,endCursor:null}}),zn(!1),un(null)},[]),Le=p.useCallback(async(de,ae)=>{const oe=de||Be,ue=ae||mt;if(!oe||!ue){un("Domain or token missing for fetching BigCommerce settings.");return}H(!0),un(null);try{const Pe=await B_e(oe,ue);Rt(Pe)}catch(Pe){console.error("Error fetching BigCommerce settings for wizard:",Pe),un(Pe.message||"Failed to fetch store settings."),v({title:"BigCommerce Settings Fetch Failed",description:Pe.message,variant:"destructive"})}finally{H(!1)}},[Be,mt,v,un,Rt,H]),Ce=p.useCallback(async(de,ae)=>{_t(de),Ht(ae),Re(2),await Le(de,ae)},[_t,Ht,Re,Le]),it=p.useCallback(async(de=10)=>{if(!Be||!mt){un("Domain or token missing for fetching BigCommerce products.");return}zn(!0),un(null);try{const ae=`
      query ProductsPreview($first: Int!) {
        site {
          products(first: $first) {
            edges {
              node {
                entityId name sku defaultImage { url(width: 200) altText }
                prices { price { value currencyCode } }
              }
            }
          }
        }
      }
    `,oe={first:de},Pe=await(await fetch(`https://${Be}/graphql`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${mt}`},body:JSON.stringify({query:ae,variables:oe})})).json();if(Pe.errors)throw new Error(Pe.errors.map(Oe=>Oe.message).join(", "));In({items:Pe.data.site.products.edges.map(Oe=>Oe.node),pageInfo:{hasNextPage:!1,endCursor:null}})}catch(ae){console.error("Error fetching BigCommerce products for wizard:",ae),un(ae.message||"Failed to fetch products."),v({title:"BigCommerce Product Fetch Failed",description:ae.message,variant:"destructive"})}finally{zn(!1)}},[Be,mt,v,un,In,zn]),ut=p.useCallback(async()=>{if(!tn||!Be||!mt)return v({title:"Import Error",description:"Missing BigCommerce data to finalize import.",variant:"destructive"}),!1;o(!0),un(null);try{const de=await DL(Be,mt),ae=U_e(tn,de,Be,{generateId:Pt},null);return await Me(ae)?(Te(),!0):!1}catch(de){return console.error("Error finalizing BigCommerce import from wizard:",de),un(de.message||"Failed to finalize BigCommerce import."),v({title:"BigCommerce Import Failed",description:de.message,variant:"destructive"}),!1}finally{o(!1)}},[tn,Be,mt,Me,Te,v,o,un,DL]),Nt=p.useCallback(async(de=10,ae=null)=>{if(!P||!D){ee("Domain or token missing for fetching products.");return}H(!0),ee(null);try{const oe=await $_e(P,D,de,ae);K(ue=>({edges:ae?[...ue.edges,...oe.edges]:oe.edges,pageInfo:oe.pageInfo}))}catch(oe){console.error("Error fetching Shopify products for wizard:",oe),ee(oe.message||"Failed to fetch products."),v({title:"Product Fetch Failed",description:oe.message,variant:"destructive"})}finally{H(!1)}},[P,D,v,ee,K,H]),vn=p.useCallback(async(de=10,ae=null)=>{if(!P||!D){ee("Domain or token missing for fetching collections.");return}H(!0),ee(null);try{const oe=await O_e(P,D,de,ae);W(ue=>({edges:ae?[...ue.edges,...oe.edges]:oe.edges,pageInfo:oe.pageInfo}))}catch(oe){console.error("Error fetching Shopify collections for wizard:",oe),ee(oe.message||"Failed to fetch collections."),v({title:"Collection Fetch Failed",description:oe.message,variant:"destructive"})}finally{H(!1)}},[P,D,v,ee,W,H]),es=p.useCallback(async(de="US",ae="EN")=>{if(!P||!D){ee("Domain or token missing for fetching localization.");return}H(!0),ee(null);try{const oe=await V_e(P,D,de,ae);O(oe)}catch(oe){console.error("Error fetching Shopify localization for wizard:",oe),ee(oe.message||"Failed to fetch localization info."),v({title:"Localization Info Fetch Failed",description:oe.message,variant:"default"})}finally{H(!1)}},[P,D,v,ee,O,H]),Vn=p.useCallback(async()=>{if(console.log("[StoreContext] Attempting to generate Shopify store logo..."),!M||!M.name){console.warn("[StoreContext] Cannot generate logo: Shopify preview metadata or store name is missing.",M),Ve("Store name is not available to generate a logo."),v({title:"Logo Generation Error",description:"Store name missing. Ensure Shopify store details were fetched correctly.",variant:"destructive"});return}const de=M.name;console.log(`[StoreContext] Generating logo for store name: "${de}"`),Ie(!0),Ve(null),xe(null);try{console.log("[StoreContext] Calling generateLogoWithGemini...");const{imageData:ae,textResponse:oe}=await kg(de);if(console.log("[StoreContext] generateLogoWithGemini response:",{imageData:ae?"imageData received (see next log)":"no imageData",textResponse:oe}),ae)console.log("[StoreContext] imageData (first 50 chars):",ae.substring(0,50)),xe(`data:image/png;base64,${ae}`),v({title:"Logo Generated!",description:"A new logo has been generated successfully."}),console.log("[StoreContext] Logo generated and state updated.");else throw console.error("[StoreContext] generateLogoWithGemini returned no imageData. Text response:",oe),new Error(oe||"Gemini did not return image data.")}catch(ae){console.error("[StoreContext] Error during Shopify store logo generation:",ae.message,ae.stack),Ve(ae.message||"Failed to generate logo."),v({title:"Logo Generation Failed",description:`Error: ${ae.message}`,variant:"destructive"})}finally{Ie(!1),console.log("[StoreContext] Finished logo generation attempt.")}},[M,v,Ve,Ie,xe]),Wr=p.useCallback(async()=>{var de,ae,oe,ue,Pe,Oe,ze,tt,Ze,pt,Lt,Bt,An,Gn;if(!M||!P||!D)return v({title:"Import Error",description:"Missing essential Shopify data to finalize import.",variant:"destructive"}),!1;o(!0),ee(null);try{const nt=U.edges.map(Tt=>Tt.node),xt=q.edges.map(Tt=>Tt.node);let cn=`Create a store named '${M.name}'.`;M.description&&(cn+=` The store's description is: "${M.description}".`),(de=M.brand)!=null&&de.slogan&&(cn+=` Slogan: "${M.brand.slogan}".`),nt.length>0&&(cn+=` It sells products like ${nt.slice(0,3).map(Tt=>Tt.title).join(", ")}.`),xt.length>0&&(cn+=` Key collections include ${xt.slice(0,2).map(Tt=>Tt.title).join(", ")}.`),(ue=(oe=(ae=M.brand)==null?void 0:ae.colors)==null?void 0:oe.primary)!=null&&ue.background&&(cn+=` The primary brand color is ${M.brand.colors.primary.background}.`),(ze=(Oe=(Pe=M.brand)==null?void 0:Pe.colors)==null?void 0:Oe.secondary)!=null&&ze.background&&(cn+=` The secondary brand color is ${M.brand.colors.secondary.background}.`);const Hr=nt.map(Tt=>{var kn,hr,Ii,Td,Qn,Fn;return{name:Tt.title,price:((Td=(Ii=(hr=(kn=Tt.variants)==null?void 0:kn.edges[0])==null?void 0:hr.node)==null?void 0:Ii.price)==null?void 0:Td.amount)||"0",description:Tt.descriptionHtml?Tt.descriptionHtml.replace(/<[^>]*>?/gm,""):Tt.description||"",images:((Qn=Tt.images)==null?void 0:Qn.edges.map(Wn=>Wn.node.url))||[],inventory:10,variants:((Fn=Tt.variants)==null?void 0:Fn.edges.map(Wn=>{var to;return{id:Wn.node.id,title:Wn.node.title,price:((to=Wn.node.price)==null?void 0:to.amount)||"0"}}))||[]}}),kr=xt.map(Tt=>{var kn,hr;return{name:Tt.title,description:Tt.descriptionHtml?Tt.descriptionHtml.replace(/<[^>]*>?/gm,""):Tt.description||"",imageUrl:((kn=Tt.image)==null?void 0:kn.url)||"",product_ids:((hr=Tt.products)==null?void 0:hr.edges.map(Ii=>Ii.node.id))||[]}}),ts={name:M.name,prompt:cn,logoUrl:pe||((pt=(Ze=(tt=M==null?void 0:M.brand)==null?void 0:tt.logo)==null?void 0:Ze.image)==null?void 0:pt.url)||((An=(Bt=(Lt=M==null?void 0:M.brand)==null?void 0:Lt.squareLogo)==null?void 0:Bt.image)==null?void 0:An.url),products:Hr,collections:kr,brandColors:(Gn=M.brand)==null?void 0:Gn.colors};return fe(ts),ie(!0),le(),I(4),me(!0),v({title:"Import Successful",description:"Store data imported. Proceed to configure and generate your store.",duration:5e3}),!0}catch(nt){return console.error("Error preparing data for StoreGenerator from Shopify import:",nt),ee(nt.message||"Failed to process Shopify data for generator."),v({title:"Import Processing Failed",description:nt.message||"Could not prepare imported data.",variant:"destructive"}),!1}finally{o(!1)}},[M,P,D,U,q,pe,Me,le,I,me,fe,ie,v,o,ee]),Ei=p.useCallback(()=>{fe(null),ie(!1)},[]),Us=p.useCallback(de=>{const ae=e.find(oe=>oe.id===de);return ae?{...ae}:null},[e]),ri=p.useCallback(de=>{const ae=e.find(oe=>mc(oe.name)===de);return ae?{...ae}:null},[e]),Bs=async de=>{console.log(`[StoreContext] getStoreBySlug called for slug: ${de}`);try{const ae=ki(gn,"stores"),oe=vT(ae,wT("urlSlug","==",de)),ue=await Ri(oe);if(ue.empty)return console.log(`[StoreContext] No store found with slug: ${de}`),null;const Pe=ue.docs[0],Oe={id:Pe.id,...Pe.data()};console.log(`[StoreContext] Found store with slug ${de}. Fetching details...`);const ze=ki(gn,"stores",Oe.id,"products"),pt=(await Ri(ze)).docs.map(xt=>({id:xt.id,...xt.data()})).map(xt=>{var cn,Hr;return{...xt,price:xt.priceAmount,image:{src:{large:((cn=xt.images)==null?void 0:cn[0])||"",medium:((Hr=xt.images)==null?void 0:Hr[0])||""}},variants:xt.variants||[]}}),Lt=ki(gn,"stores",Oe.id,"collections"),An=(await Ri(Lt)).docs.map(xt=>({id:xt.id,...xt.data()})),Gn=await Promise.all(An.map(async xt=>{const cn=pt.filter(Hr=>{var kr;return(kr=xt.product_ids)==null?void 0:kr.includes(Hr.id)});return{...xt,image:{src:xt.image_url||""},products:cn}})),nt={...Oe,products:pt,collections:Gn};return n(xt=>{const cn=xt.findIndex(Hr=>Hr.id===nt.id);if(cn>-1){const Hr=[...xt];return Hr[cn]=nt,Hr}return[...xt,nt]}),nt}catch(ae){return console.error(`[StoreContext] Error fetching store by slug ${de}:`,ae),v({title:"Error Fetching Store",description:"Could not retrieve store data from the server.",variant:"destructive"}),null}},us=p.useCallback((de,ae)=>{const oe=Us(de),ue=oe==null?void 0:oe.products.find(Pe=>Pe.id===ae);return ue?{...ue}:null},[Us]),Jt=async de=>{if(!de)return 0;try{const ae=ki(gn,"stores",de,"orders"),oe=await Ri(ae);let ue=0;return oe.forEach(Pe=>{const Oe=Pe.data();Oe.total&&typeof Oe.total=="number"&&(ue+=Oe.total)}),ue}catch(ae){return console.error(`Error fetching revenue for store ${de}:`,ae),0}},Pn=async de=>{if(!de)return 0;try{const ae=ki(gn,"stores",de,"orders"),oe=await Ri(ae),ue=new Set;return oe.forEach(Pe=>{const Oe=Pe.data();Oe.userId&&ue.add(Oe.userId)}),ue.size}catch(ae){return console.error(`Error fetching customers for store ${de}:`,ae),0}},si=async de=>{if(!de)return 0;try{const ue=(await rs(gn,"stores",de).get()).data(),Pe=(ue==null?void 0:ue.views)||0,Oe=ki(gn,"stores",de,"orders"),tt=(await Ri(Oe)).size;return Pe===0?0:tt/Pe*100}catch(ae){return console.error(`Error fetching conversion rate for store ${de}:`,ae),0}},Ti=async de=>{if(!de)return 0;try{const ue=(await rs(gn,"stores",de).get()).data(),Pe=(ue==null?void 0:ue.views)||0;return Math.floor(Pe/35)}catch(ae){return console.error(`Error fetching social score for store ${de}:`,ae),0}},Ln=async(de,ae)=>{if(!C){v({title:"Authentication Required",description:"Please log in to set a pass key.",variant:"destructive"});return}f(!0);try{const oe=rs(gn,"stores",de);await Zd(oe,{pass_key:ae}),n(ue=>{const Pe=ue.map(Oe=>Oe.id===de?{...Oe,pass_key:ae}:Oe);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dn(Pe)))}catch(Oe){console.error("Failed to save stores to localStorage after pass key update:",Oe),v({title:"Local Cache Update Failed",description:"Could not update the local cache after pass key update.",variant:"warning",duration:7e3})}return Pe}),r&&r.id===de&&s(ue=>ue?{...ue,pass_key:ae}:null),v({title:"Store Pass Key Set",description:"The pass key for the store has been updated."})}catch(oe){console.error("Unexpected error in updateStorePassKey:",oe),v({title:"Pass Key Update Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},ii=async(de,ae)=>{if(!C){v({title:"Authentication Required",description:"Please log in to assign a manager.",variant:"destructive"});return}if(!de||!ae){v({title:"Missing Information",description:"Store ID and Manager Email are required.",variant:"destructive"});return}f(!0);try{console.warn("Assign Store Manager functionality needs to be migrated to a Firebase Cloud Function or direct Firestore logic."),v({title:"Manager Assignment (Placeholder)",description:"Functionality needs Firebase Cloud Function implementation.",variant:"info"}),v({title:"Store Manager Assigned",description:`Manager ${ae} assigned to store.`})}catch(oe){console.error("Unexpected error in assignStoreManager:",oe),v({title:"Manager Assignment Error",description:"An unexpected error occurred.",variant:"destructive"})}finally{f(!1)}},_o=async(de,ae,oe)=>{if(!C){v({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const ue=e.find(ze=>ze.id===de);if(!ue){console.warn(`[StoreContext] updateProductImage: Store with ID ${de} not found.`),v({title:"Update Failed",description:"Store not found for updating product image.",variant:"destructive"});return}let Pe=oe.src.large;if(Pe&&Pe.startsWith("data:image/"))try{const ze=`store_products/${de}/${ae}/image_${Pt()}.png`,tt=await Nn(Pe,ze);tt?Pe=tt:(Pe=Pe.startsWith("data:image/")?sr:Pe,v({title:"Image Upload Failed",description:"Could not upload new product image. Using placeholder or existing.",variant:"warning"}))}catch(ze){console.error(`Error uploading new product image for ${ae}:`,ze),v({title:"Image Upload Failed",description:"Could not upload new product image.",variant:"destructive"}),Pe=sr}else Pe||(Pe=sr);const Oe=ue.products.map(ze=>ze.id===ae?{...ze,image:{...ze.image,src:{large:Pe,medium:Pe}},images:ze.images?[...ze.images.filter(tt=>tt!==ze.image.src.large),Pe]:[Pe]}:ze);try{const ze=rs(gn,"stores",de,"products",ae);await Zd(ze,{images:Oe.find(tt=>tt.id===ae).images,image:{src:{large:Pe,medium:Pe}}}),v({title:"Product Image Updated",description:"The product image has been changed."})}catch(ze){console.error("Error updating product image in Firestore:",ze),v({title:"Cloud Sync Failed",description:`Failed to save product image to cloud: ${ze.message}`,variant:"destructive"});return}n(ze=>{const tt=ze.map(Ze=>Ze.id===de?{...Ze,products:Oe}:Ze);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dn(tt)))}catch(Ze){console.error("Failed to save stores to localStorage during product image update:",Ze),v({title:"Local Cache Update Failed",description:"Could not update the local cache for product image.",variant:"warning",duration:7e3})}return tt}),r&&r.id===de&&s(ze=>ze?{...ze,products:Oe}:null)},Qo=async de=>{if(!C){v({title:"Authentication Required",description:"Please log in to delete a store.",variant:"destructive"});return}const ae=[...e];n(oe=>{const ue=oe.filter(Pe=>Pe.id!==de);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dn(ue)))}catch(Pe){console.error("Failed to save stores to localStorage during optimistic delete:",Pe),v({title:"Local Cache Update Issue",description:"Could not update the local cache during store deletion. Cloud operation will proceed.",variant:"warning",duration:7e3})}return ue}),r&&r.id===de&&s(null);try{const oe=ki(gn,"stores",de,"products"),ue=await Ri(oe),Pe=[];for(const pt of ue.docs)Pe.push(SS(rs(gn,"stores",de,"products",pt.id)));await Promise.all(Pe),console.log(`Deleted ${ue.size} products for store ${de}.`);const Oe=ki(gn,"stores",de,"collections"),ze=await Ri(Oe),tt=[];for(const pt of ze.docs)tt.push(SS(rs(gn,"stores",de,"collections",pt.id)));await Promise.all(tt),console.log(`Deleted ${ze.size} collections for store ${de}.`);const Ze=rs(gn,"stores",de);await SS(Ze),console.log(`Store ${de} deleted from Firestore.`),v({title:"Store Deleted",description:"Your store has been deleted."})}catch(oe){console.error("Error deleting store from Firestore:",oe),v({title:"Deletion Failed",description:oe.message,variant:"destructive"}),n(ae);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dn(ae)))}catch(ue){console.error("Failed to save stores to localStorage during delete rollback:",ue),v({title:"Local Cache Revert Failed",description:"Could not revert local cache changes after a failed deletion.",variant:"error",duration:8e3})}ae.find(ue=>ue.id===de)&&s(ae.find(ue=>ue.id===de)||null);return}},eu=async(de,ae,oe)=>{if(!C){v({title:"Authentication Required",description:"Please log in to update product images.",variant:"destructive"});return}const ue=e.find(tt=>tt.id===de);if(!ue){console.warn(`[StoreContext] updateProductImagesArray: Store with ID ${de} not found.`),v({title:"Update Failed",description:"Store not found for updating product images.",variant:"destructive"});return}let Pe=!1,Oe=[];for(const tt of oe)if(typeof tt=="string"&&tt.startsWith("data:image/"))try{const Ze=`store_products/${de}/${ae}/gallery_${Pt()}.png`,pt=await Nn(tt,Ze);pt?Oe.push(pt):Oe.push(sr)}catch(Ze){console.error(`Error uploading gallery image for product ${ae}:`,Ze),v({title:"Image Upload Failed",description:"Could not upload one or more product gallery images.",variant:"destructive"}),Oe.push(sr)}else typeof tt=="string"&&tt?Oe.push(tt):(console.warn(`[StoreContext] updateProductImagesArray: Invalid or empty image in newImagesArray for product ${ae}`,tt),Oe.push(sr));Oe.length===0&&oe.length>0&&Oe.push(sr);const ze=ue.products.map(tt=>{var Ze,pt;if(tt.id===ae){Pe=!0;const Lt=Oe.length>0?Oe[0]:((pt=(Ze=tt.image)==null?void 0:Ze.src)==null?void 0:pt.medium)||sr;return{...tt,images:Oe.length>0?Oe:[sr],image:{...tt.image||{id:Pt(),alt:tt.name||"Product Image"},src:{medium:Lt,large:Lt}}}}return tt});if(!Pe){console.warn(`[StoreContext] updateProductImagesArray: Product with ID ${ae} not found in store ${de}.`),v({title:"Update Failed",description:"Product not found for updating images.",variant:"destructive"});return}try{const tt=rs(gn,"stores",de,"products",ae),Ze=ze.find(pt=>pt.id===ae);if(Ze)await Zd(tt,{images:Ze.images,image:Ze.image}),v({title:"Product Images Updated",description:"The product's image gallery has been updated."});else throw new Error("Updated product data not found for Firestore update.")}catch(tt){console.error("Error updating product images array in Firestore:",tt),v({title:"Cloud Sync Failed",description:`Failed to save product images to cloud: ${tt.message}`,variant:"destructive"});return}n(tt=>{const Ze=tt.map(pt=>pt.id===de?{...pt,products:ze}:pt);try{localStorage.setItem("ecommerce-stores",JSON.stringify(dn(Ze)))}catch(pt){console.error("Failed to save stores to localStorage during product images array update:",pt),v({title:"Local Cache Update Failed",description:"Could not update the local cache for product images array.",variant:"warning",duration:7e3})}return Ze}),r&&r.id===de&&s(tt=>tt?{...tt,products:ze}:null)},Wf=(de,ae)=>{g(oe=>oe.find(Pe=>Pe.id===de.id&&Pe.storeId===ae)?oe.map(Pe=>Pe.id===de.id&&Pe.storeId===ae?{...Pe,quantity:Pe.quantity+1}:Pe):[...oe,{...de,quantity:1,storeId:ae}]),v({title:"Added to Cart",description:`${de.name} has been added to your cart.`})},tu=(de,ae)=>{g(oe=>oe.filter(ue=>!(ue.id===de&&ue.storeId===ae))),v({title:"Removed from Cart",description:"Item removed from your cart.",variant:"destructive"})},nu=(de,ae,oe)=>{if(oe<1){tu(de,ae);return}g(ue=>ue.map(Pe=>Pe.id===de&&Pe.storeId===ae?{...Pe,quantity:oe}:Pe))},ru=()=>{g([]),v({title:"Cart Cleared",description:"Your shopping cart is now empty."})},Ed=p.useCallback((de,ae)=>{const oe=e.find(Oe=>Oe.id===de);if(!oe)return console.warn(`[getUpdatesForVersion] Store with ID ${de} not found.`),{template_version:ae};let ue={template_version:ae};const Pe=oe.theme||{};return oe.template_version,ae==="v1"?["Montserrat","PremiumMain","SharpFont","FreshFont","SleekFont"].includes(Pe.fontFamily)||!Pe.fontFamily?ue.theme={...Pe,fontFamily:"Inter"}:ue.theme={...Pe}:ae==="premium"&&(ue.theme={...Pe,fontFamily:"PremiumMain"}),ue},[e]),Xn={stores:e,currentStore:r,isGenerating:i,isLoadingStores:h,cart:m,user:C,progress:l,statusMessage:u,loadStores:cs,generateStore:se,updateStoreTextContent:_e,checkStoreNameAvailability:Qe,getStoreById:Us,getStoreByName:ri,getStoreBySlug:Bs,updateStore:Z,deleteStore:Qo,setCurrentStore:s,updateStorePassKey:Ln,assignStoreManager:ii,updateStoreTemplateVersion:async(de,ae)=>{if(!de||!ae){v({title:"Error",description:"Store ID and new template version are required.",variant:"destructive"});return}const oe=Ed(de,ae);await Z(de,oe);let ue=ae;ae==="v1"?ue="Modern":ae==="premium"?ue="Premium":ae==="sharp"?ue="Sharp":ae==="fresh"?ue="Fresh":ae==="sleek"?ue="Sleek":ue=ae.charAt(0).toUpperCase()+ae.slice(1),v({title:"Template Updated",description:`Store template is now ${ue}.`})},getProductById:us,updateProductImage:_o,generateStoreFromWizard:Q,getStoreRevenue:Jt,getStoreCustomers:Pn,getStoreConversionRate:si,getStoreSocialScore:Ti,addToCart:Wf,removeFromCart:tu,updateQuantity:nu,clearCart:ru,generateAIProducts:M_e,updateProductImagesArray:eu,generatePodCollectionFromDesign:J,addPendingPodCollectionData:ce,isGeneratingPodCollection:rn,viewMode:x,setViewMode:k,shopifyWizardStep:E,setShopifyWizardStep:I,shopifyDomain:P,setShopifyDomain:A,shopifyToken:D,setShopifyToken:j,shopifyPreviewMetadata:M,shopifyPreviewProducts:U,shopifyPreviewCollections:q,shopifyLocalization:te,isFetchingShopifyPreviewData:V,shopifyImportError:L,generatedLogoImage:pe,isGeneratingLogo:we,logoGenerationError:Fe,shopifyWizardShouldShowGenerator:$e,setShopifyWizardShouldShowGenerator:me,startShopifyImportWizard:be,fetchShopifyWizardProducts:Nt,importedStoreDataForGenerator:Ge,isImportDataReadyForGenerator:je,clearImportedStoreDataForGenerator:Ei,fetchShopifyWizardCollections:vn,fetchShopifyWizardLocalization:es,generateShopifyStoreLogo:Vn,finalizeShopifyImportFromWizard:Wr,resetShopifyWizardState:le,updateShopifyPreviewMetadata:de=>{z(de)},updateShopifyPreviewProduct:de=>{K(ae=>{const oe=ae.edges.map(ue=>ue.node.id===de.id?{...ue,node:de}:ue);return{...ae,edges:oe}})},updateShopifyPreviewCollection:de=>{W(ae=>{const oe=ae.edges.map(ue=>ue.node.id===de.id?{...ue,node:de}:ue);return{...ae,edges:oe}})},updateStoreCollections:(de,ae,oe)=>he(de,ae,oe,C,v),isAuthModalOpen:Y,openAuthModal:()=>Ne(!0),closeAuthModal:()=>Ne(!1),bigCommerceWizardStep:Ee,setBigCommerceWizardStep:Re,bigCommerceStoreDomain:Be,bigCommerceApiToken:mt,bigCommercePreviewSettings:tn,bigCommercePreviewProducts:sn,isFetchingBigCommercePreviewData:Fr,bigCommerceImportError:wr,startBigCommerceImportWizard:Ce,fetchBigCommerceWizardSettings:Le,fetchBigCommerceWizardProducts:it,finalizeBigCommerceImportFromWizard:ut,resetBigCommerceWizardState:Te,closeDesignEditModal:()=>{re(!1),B([]),ne(null),o(!1),c(0),d("")},continueGenerationWithDesigns:ye,openProductFinalizationModal:(de,ae)=>{Mt(de),en(ae),et(!0)},closeProductFinalizationModal:()=>{et(!1),Mt([]),en(null),o(!1),c(0),d("")},handleFinalizeProducts:async de=>{if(!Sn){v({title:"Error",description:"Store data for finalization is missing.",variant:"destructive"}),et(!1),o(!1);return}o(!0),d("Finalizing store creation..."),c(95);const ae={...Sn,products:de};try{const oe=await Me(ae);if(oe)c(100),d("Store generation complete!"),v({title:"Store Created!",description:`Store "${oe.name}" has been created.`}),_(`/${oe.urlSlug||mc(oe.name)}`);else throw new Error("Store creation returned no result after finalization.")}catch(oe){console.error("Error during final store creation after product finalization:",oe),v({title:"Finalization Failed",description:oe.message||"Failed to create store after finalization.",variant:"destructive"}),c(0),d("Finalization failed.")}finally{et(!1),Mt([]),en(null),o(!1)}}};return a.jsxs(H7.Provider,{value:Xn,children:[t,a.jsx(SEe,{isOpen:xn,onClose:Xn.closeDesignEditModal,designs:Se,onContinue:ye}),a.jsx(G_e,{isOpen:Ue,onClose:Xn.closeProductFinalizationModal,products:ct,onFinalize:Xn.handleFinalizeProducts})]})},xm=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),EEe=({product:t,storeId:e,onContentCreated:n})=>{var X,ne;const{user:r}=ls(),{toast:s}=Ss(),{storeName:i}=k0(),o=wl(),l=(X=o.state)==null?void 0:X.product,c=(ne=o.state)==null?void 0:ne.storeData,u=t||l,{getStoreById:d,getStoreByName:h}=$n(),[f,m]=p.useState("text-to-image"),[g,x]=p.useState(""),[w,v]=p.useState(""),[_,C]=p.useState(!1),[T,R]=p.useState(!1),[k,E]=p.useState(null),[I,P]=p.useState([]),[A,D]=p.useState(!1),[j,M]=p.useState(""),[z,U]=p.useState(null),[K,q]=p.useState(!1),[W,te]=p.useState(null),[O,V]=p.useState([]),[H,L]=p.useState(""),[ee,pe]=p.useState(!1),[xe,we]=p.useState(null),[Ie,Fe]=p.useState(!1),[Ve,Ge]=p.useState([]),[fe,je]=p.useState(!1),[ie,$e]=p.useState(!1),[me,Ue]=p.useState(null),et=async()=>{var Y,Ne;if(!(!me||!me.url))try{const ce=document.createElement("a");let Ee="download";if(me.url.startsWith("data:")){const Re=me.url.match(/:(.*?);/),_t=(Re?Re[1]:"application/octet-stream").split("/")[1]||"bin";Ee=`${((Y=me.caption)==null?void 0:Y.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${_t}`,ce.href=me.url}else{const Be=await(await fetch(me.url)).blob();ce.href=URL.createObjectURL(Be);const _t=me.url.substring(me.url.lastIndexOf("/")+1).split("?")[0],mt=_t.includes(".")?_t.substring(_t.lastIndexOf(".")+1):"",Ht=me.type==="video"?"mp4":"png";Ee=_t||`${((Ne=me.caption)==null?void 0:Ne.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${mt||Ht}`}ce.download=Ee,document.body.appendChild(ce),ce.click(),document.body.removeChild(ce),me.url.startsWith("data:")||URL.revokeObjectURL(ce.href),s({title:"Download Started",description:`Downloading ${Ee}`})}catch(ce){console.error("Error downloading media:",ce),s({title:"Download Failed",description:ce.message,variant:"destructive"})}};p.useEffect(()=>{let Y=c;if(Y||(i?Y=h(i):e?Y=d(e):u&&u.store_id&&(Y=d(u.store_id))),Y&&Y.products){je(!0);const Ne=Y.products.map(ce=>{var Ee,Re,Be;return{id:ce.id,name:ce.name,image:{src:{medium:((Re=(Ee=ce.image)==null?void 0:Ee.src)==null?void 0:Re.medium)||`https://via.placeholder.com/100x100.png?text=${encodeURIComponent(((Be=ce.name)==null?void 0:Be.substring(0,10))||"P")}`}}}});Ge(Ne),je(!1)}else console.warn("[ContentCreationPage] No current store products found. Falling back to sample product catalog."),Ge([{id:"sample_prod_1",name:"Sample Product Alpha",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Alpha"}}},{id:"sample_prod_2",name:"Sample Product Beta",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Beta"}}},{id:"sample_prod_3",name:"Sample Product Gamma",image:{src:{medium:"https://via.placeholder.com/100x100.png?text=Gamma"}}}]),je(!1);u&&u.name&&(x(`A captivating image of ${u.name}`),(async()=>{D(!0);try{const ce={name:u.name,description:u.description||"",niche:(Y==null?void 0:Y.type)||u.niche||"",storeName:(Y==null?void 0:Y.name)||u.storeName||""},Ee=await Lse(ce);Ee.suggestions&&Ee.suggestions.length>0?P(Ee.suggestions):Ee.error&&console.warn("Could not fetch prompt suggestions:",Ee.error)}catch(ce){console.error("Error fetching prompt suggestions:",ce)}finally{D(!1)}})())},[u,c,i,e,d,h]);const ct=async()=>{if(!g.trim()){s({title:"Error",description:"Please enter a prompt for image generation",variant:"destructive"});return}C(!0),E(null),L("");try{if(!await ba(r.uid,5)){s({title:"Error",description:"You don't have enough credits to generate an image.",variant:"destructive"}),C(!1);return}const Ne=await L0(g);let ce=Ne.alt?[Ne.alt]:[`Image for: ${g.substring(0,30)}`];if(Ne.url)try{const{base64ImageData:Ee,mimeType:Re}=await xm(Ne.url);ce=await ca(Ee,Re,`Image of ${g}`)}catch(Ee){console.error("Error generating caption for Gemini image:",Ee),ce=[`Failed to generate caption for: ${g.substring(0,30)}`]}E({url:Ne.url,captions:ce,sourceApi:"gemini"}),ce&&ce.length>0&&L(ce[0]),await Qa(r.uid,5)}catch(Y){console.error("Error generating image with Gemini:",Y),s({title:"Image Generation Failed",description:Y.message,variant:"destructive"})}finally{C(!1)}},Mt=async()=>{if(!w.trim()){s({title:"Error",description:"Please enter a prompt for OpenAI image generation",variant:"destructive"});return}R(!0),E(null),L("");try{if(!await ba(r.uid,5)){s({title:"Error",description:"You don't have enough credits to generate an image.",variant:"destructive"}),R(!1);return}const Ne=await HG(w),ce=`data:image/png;base64,${Ne.b64_json}`;let Ee=Ne.alt?[Ne.alt]:[`OpenAI image for: ${w.substring(0,30)}`];try{const{base64ImageData:Re,mimeType:Be}=await xm(ce);Ee=await ca(Re,Be,`OpenAI-generated image of ${w}`)}catch(Re){console.error("Error generating caption for OpenAI image:",Re),Ee=[`Failed to generate caption for: ${w.substring(0,30)}`]}E({url:ce,captions:Ee,sourceApi:"openai"}),Ee&&Ee.length>0&&L(Ee[0]),await Qa(r.uid,5),s({title:"Image Generated (OpenAI)",description:"Image successfully generated using OpenAI."})}catch(Y){console.error("Error generating image with OpenAI:",Y),s({title:"OpenAI Image Generation Failed",description:Y.message,variant:"destructive"})}finally{R(!1)}},Sn=async(Y,Ne)=>{if(!Y||!Y.url){s({title:"Error",description:"No image selected to edit with Gemini.",variant:"destructive"});return}if(!Ne.trim()){s({title:"Error",description:"Please enter an edit prompt for Gemini.",variant:"destructive"});return}q(!0),te(null),L("");try{if(!await ba(r.uid,2)){s({title:"Error",description:"You don't have enough credits to edit an image.",variant:"destructive"}),q(!1);return}const{base64ImageData:Ee,mimeType:Re}=await xm(Y.url),Be=await Wo(Ee,Re,Ne);if(Be&&Be.editedImageData){const _t=`data:${Be.newMimeType};base64,${Be.editedImageData}`;let mt=Be.editTextResponse?[Be.editTextResponse]:[`Edited with Gemini: ${Y.caption||Y.id}`];try{mt=await ca(Be.editedImageData,Be.newMimeType,`Edited image based on: ${Ne}`)}catch(Ht){console.error("Error generating caption for Gemini edited image:",Ht)}te({url:_t,captions:mt,sourceApi:"gemini"}),mt&&mt.length>0&&L(mt[0]),await Qa(r.uid,2),s({title:"Image Edited (Gemini)",description:"Image successfully edited with Gemini."})}else throw new Error("Gemini image edit did not return image data.")}catch(ce){console.error("Error editing image with Gemini:",ce),s({title:"Gemini Edit Failed",description:ce.message,variant:"destructive"})}finally{q(!1)}},en=async Y=>{const Ne=Y.target.files[0];if(Ne){Fe(!0),we(null),L("");try{const ce=new FileReader;ce.onload=async Ee=>{const Re=Ee.target.result,Be=Ne.type.startsWith("video/")?"video":"image";let _t=[Ne.name];if(Be==="image")try{const{base64ImageData:mt,mimeType:Ht}=await xm(Re);_t=await ca(mt,Ht,"Uploaded image caption")}catch(mt){console.error("Error generating caption for uploaded image:",mt)}else _t=[`Uploaded video: ${Ne.name}`];we({url:Re,captions:_t,type:Be}),_t&&_t.length>0&&L(_t[0]),Fe(!1)},ce.onerror=()=>{s({title:"Upload Failed",description:"Failed to read the selected file",variant:"destructive"}),Fe(!1)},ce.readAsDataURL(Ne)}catch(ce){console.error("Error processing uploaded file:",ce),s({title:"Upload Failed",description:ce.message,variant:"destructive"}),Fe(!1)}}},rn=(Y,Ne,ce="image")=>{if(!Y){s({title:"Cannot Add",description:"Item URL is missing.",variant:"destructive"});return}const Ee={id:Pt(),type:ce,url:Y,caption:Ne||`Item ${O.length+1}`,isVideo:ce==="video"};V(Re=>[...Re,Ee]),s({title:"Added to Timeline",description:`${ce==="video"?"Video":"Image"} added to your content timeline.`}),E(null),te(null),we(null),U(null),L("")},kt=(Y,Ne)=>{const ce=[...O],Ee=ce[Y],Re=Y+Ne;Re<0||Re>=ce.length||(ce.splice(Y,1),ce.splice(Re,0,Ee),V(ce))},xn=Y=>{V(Ne=>Ne.filter(ce=>ce.id!==Y)),s({title:"Removed from Timeline",description:"Item removed."})},re=async(Y,Ne)=>{if(Y.isVideo){s({title:"Already a Video",description:"This item is already a video."});return}pe(!0);try{const{base64ImageData:ce,mimeType:Ee}=await xm(Y.url),Re=Y.caption||`Create a short video from this image: ${u?u.name:"product showcase"}`,Be=await nN(Re,ce,Ee),_t=[...O];_t[Ne]={...Y,url:Be,isVideo:!0,type:"video",caption:Y.caption+" (Veo Video)"},V(_t),s({title:"Veo Video Generated",description:"Image converted to video using Veo."})}catch(ce){console.error("Error converting to Veo video:",ce),s({title:"Veo Conversion Failed",description:ce.message,variant:"destructive"})}finally{pe(!1)}},Se=Y=>{const Ne=O.find(Ee=>Ee.id===Y);if(!Ne)return;const ce=prompt("Edit caption:",Ne.caption);ce!==null&&ce.trim()!==Ne.caption&&(V(Ee=>Ee.map(Re=>Re.id===Y?{...Re,caption:ce.trim()}:Re)),s({title:"Caption Updated"}))},B=Y=>{if(Y.image&&Y.image.src&&Y.image.src.medium){const Ne=`Product: ${Y.name}`;rn(Y.image.src.medium,Ne,"image")}else s({title:"No Image",description:`Product ${Y.name} has no image.`,variant:"destructive"});$e(!1)};return a.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-8 bg-background",children:[" ",a.jsxs("header",{className:"relative text-center pb-4",children:[a.jsx(ir,{to:"/",className:"absolute left-0 top-0",children:a.jsxs($,{variant:"outline",size:"icon",children:[a.jsx(Go,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to Home"})]})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"AI Content Creation Studio"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"Generate images, edit them, create videos, and build your content sequence."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 xl:gap-8",children:[a.jsxs("div",{className:"lg:col-span-1 space-y-6",children:[a.jsxs(Si,{value:f,onValueChange:m,className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-3",children:[a.jsxs(jt,{value:"text-to-image",children:[a.jsx(xa,{className:"mr-1 h-4 w-4 inline-block"}),"Gen Image"]}),a.jsxs(jt,{value:"image-edit",children:[a.jsx(sw,{className:"mr-1 h-4 w-4 inline-block"}),"Edit Image"]}),a.jsxs(jt,{value:"upload",children:[a.jsx(eU,{className:"mr-1 h-4 w-4 inline-block"}),"Upload"]})]}),a.jsxs(Dt,{value:"text-to-image",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(ke,{htmlFor:"text-prompt-model1",className:"text-lg font-semibold",children:"Text-to-Image (Quick)"}),a.jsx(Cn,{id:"text-prompt-model1",placeholder:"e.g., 'A futuristic cityscape at sunset'",value:g,onChange:Y=>x(Y.target.value),rows:3,className:"mt-2",disabled:_||T}),A&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading prompt suggestions..."}),I.length>0&&!A&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx(ke,{className:"text-xs text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:I.map((Y,Ne)=>a.jsx($,{variant:"outline",size:"xs",onClick:()=>x(Y),className:"text-xs",children:Y.length>40?Y.substring(0,37)+"...":Y},Ne))})]}),a.jsxs($,{onClick:ct,disabled:_||T||!g.trim(),className:"w-full mt-3",children:[_?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Generate with Quick"]}),a.jsx(zi,{className:"my-4"}),a.jsx(ke,{htmlFor:"text-prompt-model2",className:"text-lg font-semibold",children:"Text-to-Image (Quality)"}),a.jsx(Cn,{id:"text-prompt-model2",placeholder:"e.g., 'A photorealistic cat astronaut'",value:w,onChange:Y=>v(Y.target.value),rows:3,className:"mt-2",disabled:_||T}),a.jsxs($,{onClick:Mt,disabled:_||T||!w.trim(),className:"w-full mt-3",children:[T?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(q3,{className:"mr-2 h-4 w-4"}),"Generate with Quality"]}),k&&k.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:k.url,alt:`Generated by ${k.sourceApi==="gemini"?"Quick":k.sourceApi==="openai"?"Quality":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",k.sourceApi==="gemini"?"Quick":k.sourceApi==="openai"?"Quality":"AI"]}),a.jsx(ke,{className:"text-sm font-medium",children:"Choose a caption:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(k.captions||[]).map((Y,Ne)=>a.jsx($,{variant:H===Y?"default":"outline",size:"sm",onClick:()=>L(Y),className:"text-xs",children:Y},Ne))}),a.jsxs($,{onClick:()=>rn(k.url,H),size:"sm",className:"w-full mt-2",disabled:!H,children:[a.jsx(Au,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]}),a.jsxs(Dt,{value:"image-edit",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(ke,{className:"text-lg font-semibold",children:"Image Editing"}),!z&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select an image from the timeline to enable editing."}),z&&a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Editing: ",a.jsx("span",{className:"text-primary truncate",children:z.caption})]}),a.jsx("img",{src:z.url,alt:"Selected for editing",className:"w-full rounded-md object-contain max-h-48 border"}),a.jsx(ke,{htmlFor:"edit-prompt-model1",children:"Edit with Quick"}),a.jsx(Cn,{id:"edit-prompt-model1",placeholder:"Describe edits (e.g., 'change background to a beach')",value:j,onChange:Y=>M(Y.target.value),rows:2,disabled:K}),a.jsxs($,{onClick:()=>Sn(z,j),disabled:K||!j.trim(),className:"w-full",children:[K?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Edit with Quick"]})]}),W&&W.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:W.url,alt:`Edited by ${W.sourceApi==="gemini"?"Quick":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",W.sourceApi==="gemini"?"Quick":"AI"]}),a.jsx(ke,{className:"text-sm font-medium",children:"Choose a caption for the edited image:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(W.captions||[]).map((Y,Ne)=>a.jsx($,{variant:H===Y?"default":"outline",size:"sm",onClick:()=>L(Y),className:"text-xs",children:Y},Ne))}),a.jsxs($,{onClick:()=>rn(W.url,H),size:"sm",className:"w-full mt-2",disabled:!H,children:[a.jsx(Au,{className:"mr-2 h-4 w-4"})," Add Edited to Timeline"]})]})]}),a.jsxs(Dt,{value:"upload",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(ke,{htmlFor:"file-upload",className:"text-lg font-semibold",children:"Upload Image or Video"}),a.jsx(qe,{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:en,className:"mt-2",disabled:Ie}),Ie&&a.jsxs("div",{className:"mt-2 flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}),xe&&xe.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[xe.type==="image"?a.jsx("img",{src:xe.url,alt:"Uploaded content",className:"w-full rounded-md object-contain max-h-96"}):a.jsx("video",{src:xe.url,controls:!0,className:"w-full rounded-md max-h-96",children:"Your browser does not support the video tag."}),a.jsx(ke,{className:"text-sm font-medium",children:"Choose a caption for the uploaded content:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(xe.captions||[]).map((Y,Ne)=>a.jsx($,{variant:H===Y?"default":"outline",size:"sm",onClick:()=>L(Y),className:"text-xs",children:Y},Ne))}),a.jsxs($,{onClick:()=>rn(xe.url,H,xe.type),size:"sm",className:"w-full mt-2",disabled:!H,children:[a.jsx(Au,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]})]}),a.jsxs("div",{className:"p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Product Catalog"}),a.jsxs($,{variant:"outline",size:"sm",onClick:()=>$e(!ie),children:[ie?"Hide":"Show"," Products ",a.jsx(Gie,{className:"ml-2 h-4 w-4"})]})]}),ie&&a.jsx(ws,{className:"mt-2 h-48 border rounded-md p-2",children:a.jsx("div",{className:"space-y-2",children:Ve.map(Y=>{var Ne,ce;return a.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md hover:bg-muted cursor-pointer",onClick:()=>B(Y),children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:(ce=(Ne=Y.image)==null?void 0:Ne.src)==null?void 0:ce.medium,alt:Y.name,className:"w-10 h-10 object-cover rounded"}),a.jsx("span",{className:"text-sm",children:Y.name})]}),a.jsx($,{size:"xs",variant:"ghost",children:a.jsx(Au,{className:"h-4 w-4"})})]},Y.id)})})})]})]}),a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"p-4 md:p-6 border rounded-lg bg-card shadow min-h-[400px]",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Content Timeline"}),a.jsx(ws,{className:"h-[calc(100vh-350px)] min-h-[300px] pr-3",children:O.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[a.jsx(W3,{className:"h-12 w-12 mb-3"}),a.jsx("p",{children:"Your timeline is empty."}),a.jsx("p",{className:"text-sm",children:"Generate or upload content to get started."})]}):a.jsx(Ac,{children:O.map((Y,Ne)=>a.jsxs(Ct.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{type:"spring",stiffness:300,damping:30},className:"mb-3 p-3 border rounded-md flex items-start gap-3 hover:shadow-md transition-shadow bg-background cursor-pointer",onClick:()=>Ue(Y),children:[a.jsxs("div",{className:"w-24 h-24 flex-shrink-0 relative rounded overflow-hidden group bg-muted",children:[Y.isVideo?a.jsx("video",{src:Y.url,className:"w-full h-full object-cover",controls:!1,muted:!0,loop:!0,onMouseOver:ce=>ce.target.play(),onMouseOut:ce=>ce.target.pause()}):a.jsx("img",{src:Y.url,alt:Y.caption,className:"w-full h-full object-cover"}),!Y.isVideo&&a.jsx($,{size:"icon",variant:"secondary",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:ce=>{ce.stopPropagation(),re(Y,Ne)},disabled:ee,title:"Convert to Veo Video",children:ee?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx($I,{className:"h-4 w-4"})}),a.jsx($,{size:"icon",variant:"outline",className:"absolute bottom-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:ce=>{ce.stopPropagation(),U(Y),m("image-edit")},disabled:Y.isVideo,title:"Edit this image",children:a.jsx(sw,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:`text-xs font-semibold px-1.5 py-0.5 rounded-sm ${Y.isVideo?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:[Y.isVideo?"Video":"Image"," ",Ne+1]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx($,{size:"icon",variant:"ghost",onClick:ce=>{ce.stopPropagation(),kt(Ne,-1)},disabled:Ne===0,className:"h-7 w-7",children:a.jsx(J3,{className:"h-4 w-4"})}),a.jsx($,{size:"icon",variant:"ghost",onClick:ce=>{ce.stopPropagation(),kt(Ne,1)},disabled:Ne===O.length-1,className:"h-7 w-7",children:a.jsx(Y3,{className:"h-4 w-4"})}),a.jsx($,{size:"icon",variant:"ghost",onClick:ce=>{ce.stopPropagation(),Se(Y.id)},className:"h-7 w-7",children:a.jsx(X3,{className:"h-4 w-4"})}),a.jsx($,{size:"icon",variant:"ghost",onClick:ce=>{ce.stopPropagation(),xn(Y.id)},className:"h-7 w-7 text-destructive",children:a.jsx(Bn,{className:"h-4 w-4"})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-muted-foreground line-clamp-3",title:Y.caption,children:Y.caption})]})]},Y.id))})}),O.length>0&&a.jsx(zi,{className:"my-4"}),me&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Media Viewer"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs($,{variant:"outline",size:"sm",onClick:et,children:[a.jsx(OI,{className:"mr-2 h-4 w-4"}),"Download"]}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>Ue(null),children:a.jsx(Ji,{className:"h-5 w-5"})})]})]}),me.type==="image"||!me.isVideo?a.jsx("img",{src:me.url,alt:me.caption||"Viewing media",className:"w-full max-h-[60vh] rounded-md object-contain border"}):a.jsx("video",{src:me.url,controls:!0,className:"w-full max-h-[60vh] rounded-md border bg-black",children:"Your browser does not support the video tag."}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:me.caption})]})]})})]})]})};function q7(t){const e=p.useRef({value:t,previous:t});return p.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}function zA(t){const[e,n]=p.useState(void 0);return Ca(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,l;if("borderBoxSize"in i){const c=i.borderBoxSize,u=Array.isArray(c)?c[0]:c;o=u.inlineSize,l=u.blockSize}else o=t.offsetWidth,l=t.offsetHeight;n({width:o,height:l})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var o_="Switch",[TEe,Xje]=bi(o_),[IEe,NEe]=TEe(o_),K7=p.forwardRef((t,e)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c="on",onCheckedChange:u,form:d,...h}=t,[f,m]=p.useState(null),g=mn(e,C=>m(C)),x=p.useRef(!1),w=f?d||!!f.closest("form"):!0,[v,_]=Vc({prop:s,defaultProp:i??!1,onChange:u,caller:o_});return a.jsxs(IEe,{scope:n,checked:v,disabled:l,children:[a.jsx(Wt.button,{type:"button",role:"switch","aria-checked":v,"aria-required":o,"data-state":Q7(v),"data-disabled":l?"":void 0,disabled:l,value:c,...h,ref:g,onClick:gt(t.onClick,C=>{_(T=>!T),w&&(x.current=C.isPropagationStopped(),x.current||C.stopPropagation())})}),w&&a.jsx(X7,{control:f,bubbles:!x.current,name:r,value:c,checked:v,required:o,disabled:l,form:d,style:{transform:"translateX(-100%)"}})]})});K7.displayName=o_;var Y7="SwitchThumb",J7=p.forwardRef((t,e)=>{const{__scopeSwitch:n,...r}=t,s=NEe(Y7,n);return a.jsx(Wt.span,{"data-state":Q7(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:e})});J7.displayName=Y7;var PEe="SwitchBubbleInput",X7=p.forwardRef(({__scopeSwitch:t,control:e,checked:n,bubbles:r=!0,...s},i)=>{const o=p.useRef(null),l=mn(o,i),c=q7(n),u=zA(e);return p.useEffect(()=>{const d=o.current;if(!d)return;const h=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(h,"checked").set;if(c!==n&&m){const g=new Event("click",{bubbles:r});m.call(d,n),d.dispatchEvent(g)}},[c,n,r]),a.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:l,style:{...s.style,...u,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});X7.displayName=PEe;function Q7(t){return t?"checked":"unchecked"}var Z7=K7,AEe=J7;const Oo=ht.forwardRef(({className:t,...e},n)=>a.jsx(Z7,{className:bt("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...e,ref:n,children:a.jsx(AEe,{className:bt("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));Oo.displayName=Z7.displayName;var kEe="Arrow",eW=p.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return a.jsx(Wt.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:a.jsx("polygon",{points:"0,0 30,0 15,10"})})});eW.displayName=kEe;var REe=eW,GA="Popper",[tW,a_]=bi(GA),[jEe,nW]=tW(GA),rW=t=>{const{__scopePopper:e,children:n}=t,[r,s]=p.useState(null);return a.jsx(jEe,{scope:e,anchor:r,onAnchorChange:s,children:n})};rW.displayName=GA;var sW="PopperAnchor",iW=p.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=nW(sW,n),o=p.useRef(null),l=mn(e,o);return p.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:a.jsx(Wt.div,{...s,ref:l})});iW.displayName=sW;var WA="PopperContent",[DEe,MEe]=tW(WA),oW=p.forwardRef((t,e)=>{var we,Ie,Fe,Ve,Ge,fe;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:l=0,avoidCollisions:c=!0,collisionBoundary:u=[],collisionPadding:d=0,sticky:h="partial",hideWhenDetached:f=!1,updatePositionStrategy:m="optimized",onPlaced:g,...x}=t,w=nW(WA,n),[v,_]=p.useState(null),C=mn(e,je=>_(je)),[T,R]=p.useState(null),k=zA(T),E=(k==null?void 0:k.width)??0,I=(k==null?void 0:k.height)??0,P=r+(i!=="center"?"-"+i:""),A=typeof d=="number"?d:{top:0,right:0,bottom:0,left:0,...d},D=Array.isArray(u)?u:[u],j=D.length>0,M={padding:A,boundary:D.filter(FEe),altBoundary:j},{refs:z,floatingStyles:U,placement:K,isPositioned:q,middlewareData:W}=h7({strategy:"fixed",placement:P,whileElementsMounted:(...je)=>u7(...je,{animationFrame:m==="always"}),elements:{reference:w.anchor},middleware:[f7({mainAxis:s+I,alignmentAxis:o}),c&&m7({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?p7():void 0,...M}),c&&g7({...M}),y7({...M,apply:({elements:je,rects:ie,availableWidth:$e,availableHeight:me})=>{const{width:Ue,height:et}=ie.reference,ct=je.floating.style;ct.setProperty("--radix-popper-available-width",`${$e}px`),ct.setProperty("--radix-popper-available-height",`${me}px`),ct.setProperty("--radix-popper-anchor-width",`${Ue}px`),ct.setProperty("--radix-popper-anchor-height",`${et}px`)}}),T&&v7({element:T,padding:l}),OEe({arrowWidth:E,arrowHeight:I}),f&&x7({strategy:"referenceHidden",...M})]}),[te,O]=cW(K),V=Br(g);Ca(()=>{q&&(V==null||V())},[q,V]);const H=(we=W.arrow)==null?void 0:we.x,L=(Ie=W.arrow)==null?void 0:Ie.y,ee=((Fe=W.arrow)==null?void 0:Fe.centerOffset)!==0,[pe,xe]=p.useState();return Ca(()=>{v&&xe(window.getComputedStyle(v).zIndex)},[v]),a.jsx("div",{ref:z.setFloating,"data-radix-popper-content-wrapper":"",style:{...U,transform:q?U.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:pe,"--radix-popper-transform-origin":[(Ve=W.transformOrigin)==null?void 0:Ve.x,(Ge=W.transformOrigin)==null?void 0:Ge.y].join(" "),...((fe=W.hide)==null?void 0:fe.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:a.jsx(DEe,{scope:n,placedSide:te,onArrowChange:R,arrowX:H,arrowY:L,shouldHideArrow:ee,children:a.jsx(Wt.div,{"data-side":te,"data-align":O,...x,ref:C,style:{...x.style,animation:q?void 0:"none"}})})})});oW.displayName=WA;var aW="PopperArrow",LEe={top:"bottom",right:"left",bottom:"top",left:"right"},lW=p.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=MEe(aW,r),o=LEe[i.placedSide];return a.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:a.jsx(REe,{...s,ref:n,style:{...s.style,display:"block"}})})});lW.displayName=aW;function FEe(t){return t!==null}var OEe=t=>({name:"transformOrigin",options:t,fn(e){var w,v,_;const{placement:n,rects:r,middlewareData:s}=e,o=((w=s.arrow)==null?void 0:w.centerOffset)!==0,l=o?0:t.arrowWidth,c=o?0:t.arrowHeight,[u,d]=cW(n),h={start:"0%",center:"50%",end:"100%"}[d],f=(((v=s.arrow)==null?void 0:v.x)??0)+l/2,m=(((_=s.arrow)==null?void 0:_.y)??0)+c/2;let g="",x="";return u==="bottom"?(g=o?h:`${f}px`,x=`${-c}px`):u==="top"?(g=o?h:`${f}px`,x=`${r.floating.height+c}px`):u==="right"?(g=`${-c}px`,x=o?h:`${m}px`):u==="left"&&(g=`${r.floating.width+c}px`,x=o?h:`${m}px`),{data:{x:g,y:x}}}});function cW(t){const[e,n="center"]=t.split("-");return[e,n]}var uW=rW,HA=iW,dW=oW,hW=lW,o1=["Enter"," "],$Ee=["ArrowDown","PageUp","Home"],fW=["ArrowUp","PageDown","End"],VEe=[...$Ee,...fW],UEe={ltr:[...o1,"ArrowRight"],rtl:[...o1,"ArrowLeft"]},BEe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},uy="Menu",[pg,zEe,GEe]=PI(uy),[_d,mW]=bi(uy,[GEe,a_,H0]),l_=a_(),pW=H0(),[WEe,Sd]=_d(uy),[HEe,dy]=_d(uy),gW=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=t,l=l_(e),[c,u]=p.useState(null),d=p.useRef(!1),h=Br(i),f=W0(s);return p.useEffect(()=>{const m=()=>{d.current=!0,document.addEventListener("pointerdown",g,{capture:!0,once:!0}),document.addEventListener("pointermove",g,{capture:!0,once:!0})},g=()=>d.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",g,{capture:!0}),document.removeEventListener("pointermove",g,{capture:!0})}},[]),a.jsx(uW,{...l,children:a.jsx(WEe,{scope:e,open:n,onOpenChange:h,content:c,onContentChange:u,children:a.jsx(HEe,{scope:e,onClose:p.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:d,dir:f,modal:o,children:r})})})};gW.displayName=uy;var qEe="MenuAnchor",qA=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=l_(n);return a.jsx(HA,{...s,...r,ref:e})});qA.displayName=qEe;var KA="MenuPortal",[KEe,yW]=_d(KA,{forceMount:void 0}),xW=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:s}=t,i=Sd(KA,e);return a.jsx(KEe,{scope:e,forceMount:n,children:a.jsx(_s,{present:n||i.open,children:a.jsx(Tg,{asChild:!0,container:s,children:r})})})};xW.displayName=KA;var go="MenuContent",[YEe,YA]=_d(go),vW=p.forwardRef((t,e)=>{const n=yW(go,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=Sd(go,t.__scopeMenu),o=dy(go,t.__scopeMenu);return a.jsx(pg.Provider,{scope:t.__scopeMenu,children:a.jsx(_s,{present:r||i.open,children:a.jsx(pg.Slot,{scope:t.__scopeMenu,children:o.modal?a.jsx(JEe,{...s,ref:e}):a.jsx(XEe,{...s,ref:e})})})})}),JEe=p.forwardRef((t,e)=>{const n=Sd(go,t.__scopeMenu),r=p.useRef(null),s=mn(e,r);return p.useEffect(()=>{const i=r.current;if(i)return B0(i)},[]),a.jsx(JA,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:gt(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),XEe=p.forwardRef((t,e)=>{const n=Sd(go,t.__scopeMenu);return a.jsx(JA,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),QEe=Yu("MenuContent.ScrollLock"),JA=p.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEntryFocus:c,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,disableOutsideScroll:g,...x}=t,w=Sd(go,n),v=dy(go,n),_=l_(n),C=pW(n),T=zEe(n),[R,k]=p.useState(null),E=p.useRef(null),I=mn(e,E,w.onContentChange),P=p.useRef(0),A=p.useRef(""),D=p.useRef(0),j=p.useRef(null),M=p.useRef("right"),z=p.useRef(0),U=g?zI:p.Fragment,K=g?{as:QEe,allowPinchZoom:!0}:void 0,q=te=>{var we,Ie;const O=A.current+te,V=T().filter(Fe=>!Fe.disabled),H=document.activeElement,L=(we=V.find(Fe=>Fe.ref.current===H))==null?void 0:we.textValue,ee=V.map(Fe=>Fe.textValue),pe=uTe(ee,O,L),xe=(Ie=V.find(Fe=>Fe.textValue===pe))==null?void 0:Ie.ref.current;(function Fe(Ve){A.current=Ve,window.clearTimeout(P.current),Ve!==""&&(P.current=window.setTimeout(()=>Fe(""),1e3))})(O),xe&&setTimeout(()=>xe.focus())};p.useEffect(()=>()=>window.clearTimeout(P.current),[]),UI();const W=p.useCallback(te=>{var V,H;return M.current===((V=j.current)==null?void 0:V.side)&&hTe(te,(H=j.current)==null?void 0:H.area)},[]);return a.jsx(YEe,{scope:n,searchRef:A,onItemEnter:p.useCallback(te=>{W(te)&&te.preventDefault()},[W]),onItemLeave:p.useCallback(te=>{var O;W(te)||((O=E.current)==null||O.focus(),k(null))},[W]),onTriggerLeave:p.useCallback(te=>{W(te)&&te.preventDefault()},[W]),pointerGraceTimerRef:D,onPointerGraceIntentChange:p.useCallback(te=>{j.current=te},[]),children:a.jsx(U,{...K,children:a.jsx(V0,{asChild:!0,trapped:s,onMountAutoFocus:gt(i,te=>{var O;te.preventDefault(),(O=E.current)==null||O.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:a.jsx(Eg,{asChild:!0,disableOutsidePointerEvents:l,onEscapeKeyDown:u,onPointerDownOutside:d,onFocusOutside:h,onInteractOutside:f,onDismiss:m,children:a.jsx(HU,{asChild:!0,...C,dir:v.dir,orientation:"vertical",loop:r,currentTabStopId:R,onCurrentTabStopIdChange:k,onEntryFocus:gt(c,te=>{v.isUsingKeyboardRef.current||te.preventDefault()}),preventScrollOnEntryFocus:!0,children:a.jsx(dW,{role:"menu","aria-orientation":"vertical","data-state":MW(w.open),"data-radix-menu-content":"",dir:v.dir,..._,...x,ref:I,style:{outline:"none",...x.style},onKeyDown:gt(x.onKeyDown,te=>{const V=te.target.closest("[data-radix-menu-content]")===te.currentTarget,H=te.ctrlKey||te.altKey||te.metaKey,L=te.key.length===1;V&&(te.key==="Tab"&&te.preventDefault(),!H&&L&&q(te.key));const ee=E.current;if(te.target!==ee||!VEe.includes(te.key))return;te.preventDefault();const xe=T().filter(we=>!we.disabled).map(we=>we.ref.current);fW.includes(te.key)&&xe.reverse(),lTe(xe)}),onBlur:gt(t.onBlur,te=>{te.currentTarget.contains(te.target)||(window.clearTimeout(P.current),A.current="")}),onPointerMove:gt(t.onPointerMove,gg(te=>{const O=te.target,V=z.current!==te.clientX;if(te.currentTarget.contains(O)&&V){const H=te.clientX>z.current?"right":"left";M.current=H,z.current=te.clientX}}))})})})})})})});vW.displayName=go;var ZEe="MenuGroup",XA=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Wt.div,{role:"group",...r,ref:e})});XA.displayName=ZEe;var eTe="MenuLabel",wW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Wt.div,{...r,ref:e})});wW.displayName=eTe;var s0="MenuItem",oF="menu.itemSelect",c_=p.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...s}=t,i=p.useRef(null),o=dy(s0,t.__scopeMenu),l=YA(s0,t.__scopeMenu),c=mn(e,i),u=p.useRef(!1),d=()=>{const h=i.current;if(!n&&h){const f=new CustomEvent(oF,{bubbles:!0,cancelable:!0});h.addEventListener(oF,m=>r==null?void 0:r(m),{once:!0}),AI(h,f),f.defaultPrevented?u.current=!1:o.onClose()}};return a.jsx(bW,{...s,ref:c,disabled:n,onClick:gt(t.onClick,d),onPointerDown:h=>{var f;(f=t.onPointerDown)==null||f.call(t,h),u.current=!0},onPointerUp:gt(t.onPointerUp,h=>{var f;u.current||(f=h.currentTarget)==null||f.click()}),onKeyDown:gt(t.onKeyDown,h=>{const f=l.searchRef.current!=="";n||f&&h.key===" "||o1.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});c_.displayName=s0;var bW=p.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=t,o=YA(s0,n),l=pW(n),c=p.useRef(null),u=mn(e,c),[d,h]=p.useState(!1),[f,m]=p.useState("");return p.useEffect(()=>{const g=c.current;g&&m((g.textContent??"").trim())},[i.children]),a.jsx(pg.ItemSlot,{scope:n,disabled:r,textValue:s??f,children:a.jsx(qU,{asChild:!0,...l,focusable:!r,children:a.jsx(Wt.div,{role:"menuitem","data-highlighted":d?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:u,onPointerMove:gt(t.onPointerMove,gg(g=>{r?o.onItemLeave(g):(o.onItemEnter(g),g.defaultPrevented||g.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:gt(t.onPointerLeave,gg(g=>o.onItemLeave(g))),onFocus:gt(t.onFocus,()=>h(!0)),onBlur:gt(t.onBlur,()=>h(!1))})})})}),tTe="MenuCheckboxItem",_W=p.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...s}=t;return a.jsx(IW,{scope:t.__scopeMenu,checked:n,children:a.jsx(c_,{role:"menuitemcheckbox","aria-checked":i0(n)?"mixed":n,...s,ref:e,"data-state":ZA(n),onSelect:gt(s.onSelect,()=>r==null?void 0:r(i0(n)?!0:!n),{checkForDefaultPrevented:!1})})})});_W.displayName=tTe;var SW="MenuRadioGroup",[nTe,rTe]=_d(SW,{value:void 0,onValueChange:()=>{}}),CW=p.forwardRef((t,e)=>{const{value:n,onValueChange:r,...s}=t,i=Br(r);return a.jsx(nTe,{scope:t.__scopeMenu,value:n,onValueChange:i,children:a.jsx(XA,{...s,ref:e})})});CW.displayName=SW;var EW="MenuRadioItem",TW=p.forwardRef((t,e)=>{const{value:n,...r}=t,s=rTe(EW,t.__scopeMenu),i=n===s.value;return a.jsx(IW,{scope:t.__scopeMenu,checked:i,children:a.jsx(c_,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":ZA(i),onSelect:gt(r.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});TW.displayName=EW;var QA="MenuItemIndicator",[IW,sTe]=_d(QA,{checked:!1}),NW=p.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...s}=t,i=sTe(QA,n);return a.jsx(_s,{present:r||i0(i.checked)||i.checked===!0,children:a.jsx(Wt.span,{...s,ref:e,"data-state":ZA(i.checked)})})});NW.displayName=QA;var iTe="MenuSeparator",PW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return a.jsx(Wt.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});PW.displayName=iTe;var oTe="MenuArrow",AW=p.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=l_(n);return a.jsx(hW,{...s,...r,ref:e})});AW.displayName=oTe;var aTe="MenuSub",[Qje,kW]=_d(aTe),Um="MenuSubTrigger",RW=p.forwardRef((t,e)=>{const n=Sd(Um,t.__scopeMenu),r=dy(Um,t.__scopeMenu),s=kW(Um,t.__scopeMenu),i=YA(Um,t.__scopeMenu),o=p.useRef(null),{pointerGraceTimerRef:l,onPointerGraceIntentChange:c}=i,u={__scopeMenu:t.__scopeMenu},d=p.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return p.useEffect(()=>d,[d]),p.useEffect(()=>{const h=l.current;return()=>{window.clearTimeout(h),c(null)}},[l,c]),a.jsx(qA,{asChild:!0,...u,children:a.jsx(bW,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":MW(n.open),...t,ref:F0(e,s.onTriggerChange),onClick:h=>{var f;(f=t.onClick)==null||f.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:gt(t.onPointerMove,gg(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),d()},100))})),onPointerLeave:gt(t.onPointerLeave,gg(h=>{var m,g;d();const f=(m=n.content)==null?void 0:m.getBoundingClientRect();if(f){const x=(g=n.content)==null?void 0:g.dataset.side,w=x==="right",v=w?-5:5,_=f[w?"left":"right"],C=f[w?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+v,y:h.clientY},{x:_,y:f.top},{x:C,y:f.top},{x:C,y:f.bottom},{x:_,y:f.bottom}],side:x}),window.clearTimeout(l.current),l.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:gt(t.onKeyDown,h=>{var m;const f=i.searchRef.current!=="";t.disabled||f&&h.key===" "||UEe[r.dir].includes(h.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),h.preventDefault())})})})});RW.displayName=Um;var jW="MenuSubContent",DW=p.forwardRef((t,e)=>{const n=yW(go,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=Sd(go,t.__scopeMenu),o=dy(go,t.__scopeMenu),l=kW(jW,t.__scopeMenu),c=p.useRef(null),u=mn(e,c);return a.jsx(pg.Provider,{scope:t.__scopeMenu,children:a.jsx(_s,{present:r||i.open,children:a.jsx(pg.Slot,{scope:t.__scopeMenu,children:a.jsx(JA,{id:l.contentId,"aria-labelledby":l.triggerId,...s,ref:u,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:d=>{var h;o.isUsingKeyboardRef.current&&((h=c.current)==null||h.focus()),d.preventDefault()},onCloseAutoFocus:d=>d.preventDefault(),onFocusOutside:gt(t.onFocusOutside,d=>{d.target!==l.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:gt(t.onEscapeKeyDown,d=>{o.onClose(),d.preventDefault()}),onKeyDown:gt(t.onKeyDown,d=>{var m;const h=d.currentTarget.contains(d.target),f=BEe[o.dir].includes(d.key);h&&f&&(i.onOpenChange(!1),(m=l.trigger)==null||m.focus(),d.preventDefault())})})})})})});DW.displayName=jW;function MW(t){return t?"open":"closed"}function i0(t){return t==="indeterminate"}function ZA(t){return i0(t)?"indeterminate":t?"checked":"unchecked"}function lTe(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function cTe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function uTe(t,e,n){const s=e.length>1&&Array.from(e).every(u=>u===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=cTe(t,Math.max(i,0));s.length===1&&(o=o.filter(u=>u!==n));const c=o.find(u=>u.toLowerCase().startsWith(s.toLowerCase()));return c!==n?c:void 0}function dTe(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const l=e[i],c=e[o],u=l.x,d=l.y,h=c.x,f=c.y;d>r!=f>r&&n<(h-u)*(r-d)/(f-d)+u&&(s=!s)}return s}function hTe(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return dTe(n,e)}function gg(t){return e=>e.pointerType==="mouse"?t(e):void 0}var fTe=gW,mTe=qA,pTe=xW,gTe=vW,yTe=XA,xTe=wW,vTe=c_,wTe=_W,bTe=CW,_Te=TW,STe=NW,CTe=PW,ETe=AW,TTe=RW,ITe=DW,u_="DropdownMenu",[NTe,Zje]=bi(u_,[mW]),ni=mW(),[PTe,LW]=NTe(u_),FW=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:l=!0}=t,c=ni(e),u=p.useRef(null),[d,h]=Vc({prop:s,defaultProp:i??!1,onChange:o,caller:u_});return a.jsx(PTe,{scope:e,triggerId:lc(),triggerRef:u,contentId:lc(),open:d,onOpenChange:h,onOpenToggle:p.useCallback(()=>h(f=>!f),[h]),modal:l,children:a.jsx(fTe,{...c,open:d,onOpenChange:h,dir:r,modal:l,children:n})})};FW.displayName=u_;var OW="DropdownMenuTrigger",$W=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=t,i=LW(OW,n),o=ni(n);return a.jsx(mTe,{asChild:!0,...o,children:a.jsx(Wt.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:F0(e,i.triggerRef),onPointerDown:gt(t.onPointerDown,l=>{!r&&l.button===0&&l.ctrlKey===!1&&(i.onOpenToggle(),i.open||l.preventDefault())}),onKeyDown:gt(t.onKeyDown,l=>{r||(["Enter"," "].includes(l.key)&&i.onOpenToggle(),l.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(l.key)&&l.preventDefault())})})})});$W.displayName=OW;var ATe="DropdownMenuPortal",VW=t=>{const{__scopeDropdownMenu:e,...n}=t,r=ni(e);return a.jsx(pTe,{...r,...n})};VW.displayName=ATe;var UW="DropdownMenuContent",BW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=LW(UW,n),i=ni(n),o=p.useRef(!1);return a.jsx(gTe,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:e,onCloseAutoFocus:gt(t.onCloseAutoFocus,l=>{var c;o.current||(c=s.triggerRef.current)==null||c.focus(),o.current=!1,l.preventDefault()}),onInteractOutside:gt(t.onInteractOutside,l=>{const c=l.detail.originalEvent,u=c.button===0&&c.ctrlKey===!0,d=c.button===2||u;(!s.modal||d)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});BW.displayName=UW;var kTe="DropdownMenuGroup",RTe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(yTe,{...s,...r,ref:e})});RTe.displayName=kTe;var jTe="DropdownMenuLabel",zW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(xTe,{...s,...r,ref:e})});zW.displayName=jTe;var DTe="DropdownMenuItem",GW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(vTe,{...s,...r,ref:e})});GW.displayName=DTe;var MTe="DropdownMenuCheckboxItem",WW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(wTe,{...s,...r,ref:e})});WW.displayName=MTe;var LTe="DropdownMenuRadioGroup",FTe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(bTe,{...s,...r,ref:e})});FTe.displayName=LTe;var OTe="DropdownMenuRadioItem",HW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(_Te,{...s,...r,ref:e})});HW.displayName=OTe;var $Te="DropdownMenuItemIndicator",qW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(STe,{...s,...r,ref:e})});qW.displayName=$Te;var VTe="DropdownMenuSeparator",KW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(CTe,{...s,...r,ref:e})});KW.displayName=VTe;var UTe="DropdownMenuArrow",BTe=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(ETe,{...s,...r,ref:e})});BTe.displayName=UTe;var zTe="DropdownMenuSubTrigger",YW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(TTe,{...s,...r,ref:e})});YW.displayName=zTe;var GTe="DropdownMenuSubContent",JW=p.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=ni(n);return a.jsx(ITe,{...s,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});JW.displayName=GTe;var WTe=FW,HTe=$W,qTe=VW,XW=BW,QW=zW,ZW=GW,eH=WW,tH=HW,nH=qW,rH=KW,sH=YW,iH=JW;const Cx=WTe,Ex=HTe,KTe=p.forwardRef(({className:t,inset:e,children:n,...r},s)=>a.jsxs(sH,{ref:s,className:bt("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",e&&"pl-8",t),...r,children:[n,a.jsx(zie,{className:"ml-auto"})]}));KTe.displayName=sH.displayName;const YTe=p.forwardRef(({className:t,...e},n)=>a.jsx(iH,{ref:n,className:bt("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...e}));YTe.displayName=iH.displayName;const Bm=p.forwardRef(({className:t,sideOffset:e=4,...n},r)=>a.jsx(qTe,{children:a.jsx(XW,{ref:r,sideOffset:e,className:bt("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",t),...n})}));Bm.displayName=XW.displayName;const Gs=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(ZW,{ref:r,className:bt("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",e&&"pl-8",t),...n}));Gs.displayName=ZW.displayName;const JTe=p.forwardRef(({className:t,children:e,checked:n,...r},s)=>a.jsxs(eH,{ref:s,className:bt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...r,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(nH,{children:a.jsx(Pg,{className:"h-4 w-4"})})}),e]}));JTe.displayName=eH.displayName;const XTe=p.forwardRef(({className:t,children:e,...n},r)=>a.jsxs(tH,{ref:r,className:bt("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[a.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:a.jsx(nH,{children:a.jsx(Wie,{className:"h-2 w-2 fill-current"})})}),e]}));XTe.displayName=tH.displayName;const a1=p.forwardRef(({className:t,inset:e,...n},r)=>a.jsx(QW,{ref:r,className:bt("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...n}));a1.displayName=QW.displayName;const l1=p.forwardRef(({className:t,...e},n)=>a.jsx(rH,{ref:n,className:bt("-mx-1 my-1 h-px bg-muted",t),...e}));l1.displayName=rH.displayName;const aF=()=>{const{user:t}=ls(),[e,n]=p.useState(!1),[r,s]=p.useState(null),i=async()=>{if(!t){s("You must be logged in to create a business account.");return}n(!0),s(null);try{const c=(await Xa(Oh,"createConnectAccount")({email:t.email})).data;if(c&&c.accountLinkUrl)window.location.href=c.accountLinkUrl;else throw new Error("Failed to retrieve the Stripe onboarding URL.")}catch(o){console.error("Stripe Connect onboarding error:",o),s(o.message||"An unexpected error occurred."),n(!1)}};return a.jsxs("button",{onClick:i,disabled:e,className:"w-full flex items-center",children:[a.jsx(ef,{className:"mr-2 h-4 w-4"}),e?"Processing...":"Create Business Account",r&&a.jsx("p",{className:"text-xs text-destructive ml-2",children:r})]})},lF=()=>{const{profile:t}=ls(),[e,n]=p.useState(!1),[r,s]=p.useState(null);if(!(t!=null&&t.stripe_account_id)||!(t!=null&&t.stripe_charges_enabled))return null;const i=async()=>{n(!0),s(null);try{const c=(await Xa(Oh,"createLoginLink")({stripeAccountId:t.stripe_account_id})).data;if(c&&c.loginLinkUrl)window.location.href=c.loginLinkUrl;else throw new Error("Failed to retrieve the Stripe dashboard link.")}catch(o){console.error("Stripe dashboard link error:",o),s(o.message||"An unexpected error occurred."),n(!1)}};return a.jsxs("button",{onClick:i,disabled:e,className:"w-full flex items-center",children:[a.jsx(ef,{className:"mr-2 h-4 w-4"}),e?"Loading...":"Dashboard",r&&a.jsx("p",{className:"text-xs text-destructive ml-2",children:r})]})},QTe=({isOpen:t,onClose:e,onSubscribe:n})=>{const r=[{action:"Store Generation",cost:25},{action:"Image Generation",cost:5},{action:"Image Editing",cost:2},{action:"Video Generation",cost:15},{action:"Podcast Generation",cost:10}].sort((i,o)=>o.cost-i.cost),s=()=>{n(),e()};return a.jsx(zr,{open:t,onOpenChange:e,children:a.jsxs(Dr,{children:[a.jsxs(Mr,{children:[a.jsxs(Lr,{className:"flex items-center",children:[a.jsx(ew,{className:"h-6 w-6 text-yellow-500 mr-2"}),"Credit Costs"]}),a.jsx(_i,{children:"Here's a breakdown of how many credits each action costs."})]}),a.jsx("div",{className:"mt-4",children:a.jsx("ul",{className:"space-y-2",children:r.map((i,o)=>a.jsxs("li",{className:"flex justify-between items-center",children:[a.jsx("span",{children:i.action}),a.jsxs("span",{className:"font-bold flex items-center",children:[i.cost," ",a.jsx(ew,{className:"h-4 w-4 text-yellow-500 ml-1"})]})]},o))})}),a.jsxs("div",{className:"mt-6 text-center",children:[a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Get 1000 credits each month for only $12.99"}),a.jsx($,{onClick:s,className:"w-full",children:"Subscribe to Pro"})]})]})})},ek=()=>{const{isAuthenticated:t,user:e,logout:n,session:r,subscriptionStatus:s,loadingProfile:i,profile:o}=ls(),l=wi(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[w,v]=p.useState(!1),[_,C]=p.useState(!1),[T,R]=p.useState(0),[k,E]=p.useState(!1),I=s==="active",P=(o==null?void 0:o.stripe_account_id)&&(o==null?void 0:o.stripe_account_details_submitted);p.useEffect(()=>{if(t&&e){const U=rs(gn,"users",e.uid),K=Tz(U,q=>{q.exists()?R(q.data().credits):R(0)});return()=>K()}},[t,e]),p.useEffect(()=>{const U=localStorage.getItem("theme"),K=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;U==="dark"||!U&&K?(document.documentElement.classList.add("dark"),v(!0)):(document.documentElement.classList.remove("dark"),v(!1))},[]);const A=()=>{w?(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")),v(!w)},D=async()=>{try{await n(),l("/auth")}catch(U){console.error("Error logging out:",U)}},j=async()=>{if(!e){h("Authentication required. Please log in again.");return}u(!0),h(null);try{const q=(await Xa(Oh,"stripeCreatePortalSession")()).data;if(q&&q.url)window.location.href=q.url;else throw new Error(q.error||"Failed to create portal session URL.")}catch(U){console.error("Portal session error:",U),h(U.message||"An unexpected error occurred.")}finally{u(!1)}},M=async()=>{if(!e){h("Authentication required.");return}x(!0);try{const q=(await Xa(Oh,"createConnectAccount")({email:e.email})).data;if(q&&q.accountLinkUrl)window.location.href=q.accountLinkUrl;else throw new Error("Failed to retrieve the Stripe onboarding URL.")}catch(U){console.error("Stripe Connect onboarding error:",U),h(U.message||"An unexpected error occurred.")}finally{x(!1)}},z=async()=>{if(!e){h("Authentication required.");return}m(!0);try{const q=(await Xa(Oh,"createSubscriptionCheckout")({priceId:"price_1RPDinDktew9heHOLkkL3ZDv"})).data;if(q&&q.url)window.location.href=q.url;else throw new Error("Failed to retrieve the Stripe checkout URL.")}catch(U){console.error("Stripe subscription error:",U),h(U.message||"An unexpected error occurred.")}finally{m(!1)}};return a.jsxs(a.Fragment,{children:[!i&&t&&!(o!=null&&o.stripe_account_id&&(o!=null&&o.stripe_account_details_submitted))&&a.jsx("div",{className:"bg-foreground text-background py-2 px-4 text-center text-sm dark:bg-blue-700 dark:text-white",children:a.jsxs("button",{onClick:M,disabled:g,className:"relative hover:underline focus:outline-none",children:[g?"Processing...":"Create Your Business",a.jsx(soe,{className:"absolute bottom-[-10px] right-[-13px] h-4 w-4 text-white"})]})}),a.jsxs(Ct.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"w-full py-4 px-6 flex justify-between items-center sticky top-0 z-50 bg-background/80 backdrop-blur-md border-b",children:[a.jsxs(ir,{to:"/",className:"flex items-center gap-2",children:[a.jsx("img",{src:w?"https://static.wixstatic.com/media/bd2e29_20f2a8a94b7e492a9d76e0b8b14e623b~mv2.png":"https://static.wixstatic.com/media/bd2e29_695f70787cc24db4891e63da7e7529b3~mv2.png",alt:"FreshFront Logo",className:"h-10 sm:h-[60px] w-auto transition-all"}),a.jsx("span",{className:"font-bold text-lg sm:text-xl transition-all",children:"FreshFront"})]}),a.jsxs("nav",{className:"hidden md:flex items-center gap-3",children:[!I&&a.jsx($,{onClick:z,disabled:f,children:f?"Processing...":"Subscribe to Pro"}),t&&a.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2",children:[a.jsx(ew,{className:"h-5 w-5 text-yellow-500"}),a.jsx("span",{className:"font-bold",children:T})]}),a.jsxs(Cx,{children:[a.jsx(Ex,{asChild:!0,children:a.jsxs($,{variant:"ghost",size:"sm",children:["Create ",a.jsx(Pu,{className:"ml-1 h-4 w-4"})]})}),a.jsxs(Bm,{align:"end",children:[a.jsx(Gs,{asChild:!0,children:a.jsx(ir,{to:"/designer",children:"Designer"})}),a.jsx(Gs,{asChild:!0,children:a.jsx("a",{href:"https://www.musicmigo.com",target:"_blank",rel:"noopener noreferrer",children:"Music"})}),a.jsx(Gs,{asChild:!0,children:a.jsx(ir,{to:"/podcast",children:"Podcast"})}),a.jsx(Gs,{asChild:!0,children:a.jsx(ir,{to:"/video",children:"Video"})})]})]}),t&&!i&&a.jsx(a.Fragment,{children:a.jsxs(Cx,{children:[a.jsx(Ex,{asChild:!0,children:a.jsxs($,{variant:"outline",size:"sm",className:"rounded-full px-3 py-1.5 text-sm font-medium",children:[a.jsx(Bie,{className:"mr-2 h-4 w-4"})," Business ",a.jsx(Pu,{className:"ml-1 h-4 w-4"})]})}),a.jsxs(Bm,{align:"end",children:[a.jsx(a1,{children:"Stripe Connect"}),a.jsx(l1,{}),P?a.jsx(Gs,{children:a.jsx(lF,{})}):a.jsx(Gs,{children:a.jsx(aF,{})}),I&&a.jsxs(Gs,{onClick:j,disabled:c,children:[a.jsx(kh,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Billing"]}),d&&a.jsx(Gs,{disabled:!0,children:a.jsx("p",{className:"text-xs text-destructive",children:d})})]})]})}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Oo,{id:"theme-switcher-desktop",checked:w,onCheckedChange:A,"aria-label":"Toggle dark mode"}),w?a.jsx(jE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(ME,{className:"h-5 w-5 text-muted-foreground"})]}),t?a.jsxs(Cx,{children:[a.jsx(Ex,{asChild:!0,children:a.jsxs($,{variant:"ghost",className:"flex items-center gap-2",children:[(e==null?void 0:e.photoURL)&&a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-6 w-6 rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground hidden lg:inline",children:e==null?void 0:e.email}),a.jsx(Pu,{className:"h-4 w-4"})]})}),a.jsxs(Bm,{align:"end",children:[a.jsx(a1,{children:"My Account"}),a.jsx(l1,{}),I&&a.jsxs(Gs,{onClick:j,disabled:c,children:[a.jsx(kh,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Billing"]}),a.jsxs(Gs,{onClick:D,children:[a.jsx(k2,{className:"mr-2 h-4 w-4"}),"Logout"]})]})]}):a.jsxs(a.Fragment,{children:[a.jsx(ir,{to:"/auth",children:a.jsx($,{variant:"ghost",size:"sm",children:"Log In"})}),a.jsx(ir,{to:"/auth",children:a.jsx($,{size:"sm",children:"Sign Up"})})]})]}),a.jsxs("div",{className:"md:hidden flex items-center gap-2",children:[t&&a.jsxs("button",{onClick:()=>E(!0),className:"flex items-center gap-2",children:[a.jsx(ew,{className:"h-5 w-5 text-yellow-500"}),a.jsx("span",{className:"font-bold",children:T})]}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>C(!_),children:_?a.jsx(Ji,{className:"h-6 w-6"}):a.jsx(K3,{className:"h-6 w-6"})})]})]}),a.jsxs(Ac,{children:[a.jsx(QTe,{isOpen:k,onClose:()=>E(!1),onSubscribe:z}),_&&a.jsx(Ct.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"md:hidden fixed inset-x-0 top-[117px] z-40 bg-background/95 backdrop-blur-sm p-6 border-b shadow-lg",children:a.jsxs("nav",{className:"flex flex-col gap-4",children:[a.jsxs(Cx,{children:[a.jsx(Ex,{asChild:!0,children:a.jsxs($,{variant:"ghost",className:"w-full justify-start px-3 py-2 text-base",children:["Create ",a.jsx(Pu,{className:"ml-auto h-4 w-4"})]})}),a.jsxs(Bm,{align:"end",children:[a.jsx(Gs,{asChild:!0,children:a.jsx(ir,{to:"/designer",children:"Designer"})}),a.jsx(Gs,{asChild:!0,children:a.jsx("a",{href:"https://www.musicmigo.com",target:"_blank",rel:"noopener noreferrer",children:"Music"})}),a.jsx(Gs,{asChild:!0,children:a.jsx(ir,{to:"/podcast",children:"Podcast"})}),a.jsx(Gs,{asChild:!0,children:a.jsx(ir,{to:"/video",children:"Video"})})]})]}),t&&!i&&a.jsxs(a.Fragment,{children:[P?a.jsx(lF,{}):a.jsx(aF,{}),I&&a.jsxs($,{variant:"outline",onClick:j,disabled:c,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(kh,{className:"mr-2 h-4 w-4"})," ",c?"Loading...":"Manage Billing"]}),d&&a.jsx("p",{className:"text-xs text-destructive px-3 py-1",children:d})]}),a.jsxs("div",{className:"flex items-center justify-between px-3 py-2",children:[a.jsx("span",{className:"text-base",children:"Dark Mode"}),a.jsx(Oo,{id:"theme-switcher-mobile",checked:w,onCheckedChange:A,"aria-label":"Toggle dark mode"})]}),t?a.jsxs(a.Fragment,{children:[(e==null?void 0:e.photoURL)&&a.jsxs("div",{className:"flex items-center gap-2 px-3 py-2",children:[a.jsx("img",{src:e.photoURL,alt:"User avatar",className:"h-8 w-8 rounded-full"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:e==null?void 0:e.email})]}),a.jsxs($,{variant:"outline",onClick:D,className:"w-full justify-start px-3 py-2 text-base",children:[a.jsx(k2,{className:"mr-2 h-4 w-4"})," Logout"]})]}):a.jsxs(a.Fragment,{children:[a.jsx(ir,{to:"/auth",className:"w-full",children:a.jsx($,{variant:"ghost",className:"w-full justify-start px-3 py-2 text-base",children:"Log In"})}),a.jsx(ir,{to:"/auth",className:"w-full",children:a.jsx($,{className:"w-full justify-start px-3 py-2 text-base",children:"Sign Up"})})]})]})})]})]})},ZTe=({rating:t})=>{const n=Math.round(t);return a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((r,s)=>a.jsx(VI,{className:`h-4 w-4 ${s<n?"text-yellow-400 fill-yellow-400":"text-gray-300"}`},s))})},e1e=({isOpen:t,onClose:e,onAddProducts:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState(!1),[l,c]=p.useState([]),[u,d]=p.useState([]);p.useState({});const h=async()=>{if(r.trim()){o(!0),c([]);try{const x=await(await fetch(`https://us-central1-fresh-dfe30.cloudfunctions.net/aliexpressProxy?q=${encodeURIComponent(r)}`)).json();x.result&&x.result.resultList?c(x.result.resultList):(console.warn("Unexpected API response structure:",x),c([]))}catch(g){console.error("Error fetching from AliExpress API:",g),c([])}finally{o(!1)}}},f=g=>{const x=u.some(w=>w.item.itemId===g.item.itemId);d(x?w=>w.filter(v=>v.item.itemId!==g.item.itemId):w=>[...w,g])},m=()=>{n(u),e()};return a.jsx(zr,{open:t,onOpenChange:e,children:a.jsxs(Dr,{className:"max-w-4xl h-[80vh] flex flex-col",children:[a.jsx(Mr,{children:a.jsx(Lr,{children:"Search AliExpress Products"})}),a.jsxs("div",{className:"flex gap-2 p-4 border-b",children:[a.jsx(qe,{placeholder:"Search for products...",value:r,onChange:g=>s(g.target.value),onKeyPress:g=>g.key==="Enter"&&h(),className:"flex-grow"}),a.jsx($,{onClick:h,disabled:i,children:i?a.jsx(ft,{className:"animate-spin"}):a.jsx(ac,{})})]}),a.jsxs("div",{className:"flex-grow overflow-y-auto p-4",children:[i&&a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(ft,{className:"animate-spin h-8 w-8"})}),!i&&l.length===0&&a.jsx("div",{className:"text-center text-gray-500",children:"No products found."}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:l.map(g=>a.jsxs("div",{className:`border rounded-lg p-2 cursor-pointer ${u.some(x=>x.item.itemId===g.item.itemId)?"border-blue-500 ring-2 ring-blue-500":""}`,onClick:()=>f(g),children:[a.jsx("img",{src:g.item.image,alt:g.item.title,className:"w-full h-40 object-cover rounded-md mb-2"}),a.jsx("h3",{className:"text-sm font-semibold truncate",children:g.item.title}),a.jsxs("p",{className:"text-lg font-bold text-blue-600",children:["$",g.item.sku.def.promotionPrice]}),g.item.averageStarRate&&a.jsx(ZTe,{rating:g.item.averageStarRate}),a.jsx($,{variant:"outline",size:"sm",className:"w-full mt-2",onClick:x=>{x.stopPropagation(),window.open(`https:${g.item.itemUrl}`,"_blank")},children:"Visit"})]},g.item.itemId))})]}),a.jsxs(Nr,{className:"p-4 border-t",children:[a.jsx($,{variant:"outline",onClick:e,children:"Cancel"}),a.jsxs($,{onClick:m,disabled:u.length===0,children:["Add ",u.length," Products to Store"]})]})]})})};var tk="Progress",nk=100,[t1e,e2e]=bi(tk),[n1e,r1e]=t1e(tk),oH=p.forwardRef((t,e)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=s1e,...o}=t;(s||s===0)&&!cF(s)&&console.error(i1e(`${s}`,"Progress"));const l=cF(s)?s:nk;r!==null&&!uF(r,l)&&console.error(o1e(`${r}`,"Progress"));const c=uF(r,l)?r:null,u=o0(c)?i(c,l):void 0;return a.jsx(n1e,{scope:n,value:c,max:l,children:a.jsx(Wt.div,{"aria-valuemax":l,"aria-valuemin":0,"aria-valuenow":o0(c)?c:void 0,"aria-valuetext":u,role:"progressbar","data-state":cH(c,l),"data-value":c??void 0,"data-max":l,...o,ref:e})})});oH.displayName=tk;var aH="ProgressIndicator",lH=p.forwardRef((t,e)=>{const{__scopeProgress:n,...r}=t,s=r1e(aH,n);return a.jsx(Wt.div,{"data-state":cH(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:e})});lH.displayName=aH;function s1e(t,e){return`${Math.round(t/e*100)}%`}function cH(t,e){return t==null?"indeterminate":t===e?"complete":"loading"}function o0(t){return typeof t=="number"}function cF(t){return o0(t)&&!isNaN(t)&&t>0}function uF(t,e){return o0(t)&&!isNaN(t)&&t<=e&&t>=0}function i1e(t,e){return`Invalid prop \`max\` of value \`${t}\` supplied to \`${e}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${nk}\`.`}function o1e(t,e){return`Invalid prop \`value\` of value \`${t}\` supplied to \`${e}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${nk} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var uH=oH,a1e=lH;const Ua=p.forwardRef(({className:t,value:e,...n},r)=>a.jsx(uH,{ref:r,className:bt("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...n,children:a.jsx(a1e,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(e||0)}%)`}})}));Ua.displayName=uH.displayName;const l1e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),c1e=({isOpen:t,onClose:e,product:n,onSave:r,storeId:s,theme:i})=>{const[o,l]=p.useState(null),[c,u]=p.useState(!1),[d,h]=p.useState(!1),[f,m]=p.useState(null),[g,x]=p.useState(!1),{toast:w}=Ss();p.useEffect(()=>{if(n){const U=n.item&&n.item.itemId;l(U?{...n,id:n.item.itemId,name:n.item.title,description:n.item.title,price:n.item.sku.def.promotionPrice*1.5,cost:n.item.sku.def.promotionPrice,shipping:0,images:[n.item.image],variants:[],inventory_count:0}:{...n,name:n.name||n.product_title,description:n.description||n.product_description||"",price:n.price||n.target_sale_price*1.5,cost:n.cost||n.target_sale_price,shipping:n.shipping||n.shipping_cost||0,images:n.images||[n.product_main_image_url],variants:n.variants||[],inventory_count:n.inventory_count||0})}},[n]);const v=(U,K)=>{l(q=>({...q,[U]:K}))},_=async U=>{if(U)try{const K=await l1e(U);l(q=>{const W=Array.isArray(q.images)?q.images:[];return{...q,images:[...W,K]}})}catch(K){console.error("Error converting file to base64:",K),w({title:"Image Upload Error",description:"Could not process image.",variant:"destructive"})}},C=U=>{l(K=>({...K,images:K.images.filter((q,W)=>W!==U)}))},T=async()=>{if(!o||!o.name){w({title:"Missing Product Info",description:"Product name is required to generate visuals.",variant:"destructive"});return}const U=o.images&&o.images.length>0?o.images[0]:null;if(!U){w({title:"Missing Base Image",description:"At least one image is required to generate more visuals.",variant:"destructive"});return}h(!0);try{const{base64ImageData:K,mimeType:q}=await dg(U),W=o.name;let te=[];try{const V=await K0(K,q,W);V&&V.length>0&&te.push(...V.slice(0,2)),w({title:"Angles Generated",description:`${Math.min(2,(V==null?void 0:V.length)||0)} angle images generated.`,variant:"success"})}catch(V){console.error("Error generating angles:",V),w({title:"Angle Generation Failed",description:V.message,variant:"destructive"})}const O=[`Place this product, "${W}", in a realistic home setting where it might be used or displayed. Focus on a natural context.`,`Show this product, "${W}", in an outdoor lifestyle setting, highlighting its use case or appeal.`];for(const V of O)try{const H=await Wo(K,q,V);H&&H.editedImageData&&te.push(`data:${H.newMimeType};base64,${H.editedImageData}`)}catch(H){console.error(`Error generating context image with prompt "${V}":`,H),w({title:"Context Image Failed",description:`Failed for: ${V.substring(0,30)}...`,variant:"destructive"})}w({title:"Context Images Attempted",description:`Attempted to generate ${O.length} context images.`,variant:"success"}),te.length>0?l(V=>{const H=Array.isArray(V.images)?V.images:[],L=new Set(H),ee=te.filter(pe=>!L.has(pe));return ee.length>0?{...V,images:[...H,...ee]}:(w({title:"Visuals Generated",description:"Generated images were already present.",variant:"default"}),V)}):w({title:"No New Visuals",description:"Could not generate additional visuals.",variant:"default"})}catch(K){console.error("Error in handleGenerateMoreVisuals:",K),w({title:"Visual Generation Error",description:K.message,variant:"destructive"})}finally{h(!1)}},R=(U,K)=>{l(q=>{const W=[...q.variants||[]];return W[U]={...W[U],name:K},{...q,variants:W}})},k=(U,K,q)=>{l(W=>{const te=[...W.variants||[]],O={...te[U]};return O.values=[...O.values||[]],O.values[K]=q,te[U]=O,{...W,variants:te}})},E=U=>{l(K=>{const q=[...K.variants||[]],W={...q[U]};return W.values=[...W.values||[],""],q[U]=W,{...K,variants:q}})},I=(U,K)=>{l(q=>{const W=[...q.variants||[]],te={...W[U]};return te.values=(te.values||[]).filter((O,V)=>V!==K),W[U]=te,{...q,variants:W}})},P=()=>{l(U=>({...U,variants:[...U.variants||[],{name:"",values:[""]}]}))},A=U=>{l(K=>({...K,variants:(K.variants||[]).filter((q,W)=>W!==U)}))},D=async()=>{if(u(!0),!o.name||o.name.trim()===""||o.price===void 0||String(o.price).trim()===""){w({title:"Missing Information",description:"Please ensure the product has a name and a valid price.",variant:"destructive"}),u(!1);return}try{const U={...o,product_title:o.name,product_description:o.description,sale_price:o.price,target_sale_price:o.cost,shipping_cost:o.shipping,product_main_image_url:o.images[0]};await r(U,n.id),e()}catch{w({title:"Save Error",description:"Could not save product changes.",variant:"destructive"})}finally{u(!1)}},j=U=>{m(U),x(!0)};if(!t||!o)return null;const M=o.price-o.cost-o.shipping,z=o.price>0?M/o.price*100:0;return a.jsxs(a.Fragment,{children:[a.jsx(zr,{open:t,onOpenChange:U=>!U&&e(),children:a.jsxs(Dr,{className:"max-w-2xl",children:[a.jsxs(Mr,{children:[a.jsxs(Lr,{children:["Edit Product: ",n.item?n.item.title:n.product_title]}),a.jsx(_i,{children:"Make changes to the product details below."})]}),a.jsx(ws,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"space-y-4 pr-4",children:a.jsxs(Ke,{className:"p-4 space-y-3",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"productName-edit",children:"Product Name"}),a.jsx(qe,{id:"productName-edit",value:o.name,onChange:U=>v("name",U.target.value),placeholder:"Product Name"})]}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"productDescription-edit",children:"Description"}),a.jsx(Cn,{id:"productDescription-edit",value:o.description,onChange:U=>v("description",U.target.value),placeholder:"Product Description",rows:3})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(ke,{htmlFor:"productPrice-edit",children:["Price (",o.currencyCode||"USD",")"]}),a.jsx(qe,{id:"productPrice-edit",type:"number",value:o.price,onChange:U=>v("price",parseFloat(U.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx(Ua,{value:100,className:"h-2"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(ke,{htmlFor:"productCost-edit",children:"Cost"}),a.jsx(qe,{id:"productCost-edit",type:"number",value:o.cost,onChange:U=>v("cost",parseFloat(U.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx(Ua,{value:o.price>0?o.cost/o.price*100:0,className:"h-2 [&>div]:bg-red-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(ke,{htmlFor:"productShipping-edit",children:"Shipping"}),a.jsx(qe,{id:"productShipping-edit",type:"number",value:o.shipping,onChange:U=>v("shipping",parseFloat(U.target.value)||0),placeholder:"0.00",className:"w-24 text-right"})]}),a.jsx(Ua,{value:o.price>0?o.shipping/o.price*100:0,className:"h-2 [&>div]:bg-orange-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(ke,{children:"Profit"}),a.jsx(qe,{value:M.toFixed(2),disabled:!0,className:"w-24 text-right"})]}),a.jsx(Ua,{value:z,className:"h-2 [&>div]:bg-green-500"})]}),a.jsxs("div",{className:"space-y-1",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(ke,{children:"Profit Margin"}),a.jsx(qe,{value:`${z.toFixed(2)}%`,disabled:!0,className:"w-24 text-right"})]}),a.jsx(Ua,{value:z,className:"h-2 [&>div]:bg-green-500"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{children:"Product Images"}),a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:(o.images||[]).map((U,K)=>a.jsxs("div",{className:"relative group w-24 h-24 cursor-pointer",onClick:()=>j(U),children:[a.jsx("img",{src:U,alt:`Product image ${K+1}`,className:"w-full h-full object-contain rounded-md border"}),a.jsx($,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:q=>{q.stopPropagation(),C(K)},children:a.jsx(Bn,{className:"h-3 w-3"})})]},K))}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById("productImageUpload-edit").click(),children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsx(qe,{id:"productImageUpload-edit",type:"file",accept:"image/*",className:"hidden",onChange:U=>_(U.target.files[0])}),a.jsxs($,{type:"button",variant:"outline",size:"sm",onClick:T,disabled:c||d||!o.name||!o.images||o.images.length===0,children:[d?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"More Angles/Context (AI)"]})]})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(o.variants||[]).map((U,K)=>a.jsxs(Ke,{className:"p-2 space-y-2 bg-muted/10",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ke,{htmlFor:`variantName-edit-${K}`,className:"text-xs",children:"Option Name"}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>A(K),className:"h-6 w-6",children:a.jsx(Bn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(qe,{id:`variantName-edit-${K}`,value:U.name||"",onChange:q=>R(K,q.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(ke,{className:"text-xs",children:"Option Values"}),(U.values||[]).map((q,W)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(qe,{value:q||"",onChange:te=>k(K,W,te.target.value),placeholder:"e.g., Red",className:"text-sm h-8"}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>I(K,W),className:"h-6 w-6",children:a.jsx(Bn,{className:"h-3 w-3 text-destructive"})})]},W)),a.jsxs($,{variant:"outline",size:"sm",onClick:()=>E(K),className:"text-xs h-7",children:[a.jsx(Ui,{className:"mr-1 h-3 w-3"})," Add Value"]})]},K)),a.jsxs($,{variant:"outline",onClick:P,className:"w-full text-sm h-8",children:[a.jsx(Ui,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]}),a.jsxs("div",{className:"pt-3 border-t mt-3",children:[a.jsx(ke,{htmlFor:"productInventory-edit",children:"Inventory Count"}),a.jsx(qe,{id:"productInventory-edit",type:"number",value:o.inventory_count||"",onChange:U=>v("inventory_count",parseInt(U.target.value)||0),placeholder:"0"})]})]})})}),a.jsxs(Nr,{children:[a.jsx(al,{asChild:!0,children:a.jsx($,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsxs($,{type:"button",onClick:D,disabled:c,children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Save Changes"]})]})]})}),g&&f&&a.jsx(zr,{open:g,onOpenChange:x,children:a.jsxs(Dr,{className:"max-w-xl max-h-[80vh]",children:[a.jsxs(Mr,{children:[a.jsx(Lr,{children:"Enlarged Image"}),a.jsx(al,{asChild:!0,children:a.jsx($,{variant:"ghost",size:"icon",className:"absolute top-4 right-4",onClick:()=>x(!1),children:a.jsx(Ui,{className:"h-4 w-4 rotate-45"})})})]}),a.jsx("div",{className:"flex justify-center items-center p-4",children:a.jsx("img",{src:f,alt:"Enlarged product",className:"max-w-full max-h-[70vh] object-contain"})})]})})]})},dF=["Create a custom name jewelry store called 'Elegance' with diamond rings and gold necklaces, featuring a dark, sophisticated theme.","Build a website for my digital marketing, content creation and web development services, using modern glassmorphism and minimalist styles.","Design an organic food market 'GreenHarvest' with fresh produce and healthy snacks, emphasizing natural textures and earthy tones.","Make a trendy fashion boutique 'Urban Threads' with summer dresses and casual wear, aiming for a bright, minimalist aesthetic."],iC={"Healthy Food":{keywords:["healthy food","organic food","greenharvest","fresh produce","natural food","health store"],primaryColor:"green",secondaryColor:"orange",templates:["Classic","Fresh","Sleek"]},"Fast Food":{keywords:["fast food","burgers","fries","pizza","takeaway","quick serve"],primaryColor:"red",secondaryColor:"orange",templates:["Premium","Modern","Classic","Fresh","Sleek"]},Technology:{keywords:["tech","gadget","electronics","software","computer","phone","futuretech"],primaryColor:"blue",secondaryColor:"purple",templates:["Classic","Fresh","Sleek","Sharp","Premium","Modern"]},"General Store":{keywords:["general store","variety store","convenience store","department store"],primaryColor:"navy",secondaryColor:"grey",templates:["Classic","Fresh","Sleek","Premium","Modern"]},"Female Fashion/Beauty":{keywords:["female fashion","beauty","cosmetics","makeup","women's clothing","boutique","urban threads"],primaryColor:"peach",secondaryColor:"purple",templates:["Classic","Fresh","Sleek"]},Jewelry:{keywords:["jewelry","rings","necklaces","earrings","diamonds","gold","elegance"],primaryColor:"grey",secondaryColor:"darkpurple",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Fashion:{keywords:["fashion","clothing","apparel","style","wear"],primaryColor:"navyblue",secondaryColor:"mediumred",templates:["Classic","Fresh","Sleek","Premium","Modern"]},Furniture:{keywords:["furniture","home decor","sofa","table","chair","furnishings"],primaryColor:"brown",secondaryColor:"darkgrey",templates:["Classic","Fresh","Sleek"]},Default:{keywords:[],primaryColor:"blue",secondaryColor:"gray",templates:["Fresh","Classic","Sleek","Modern"]}},u1e=t=>{const e=t.toLowerCase();for(const n in iC){if(n==="Default")continue;const r=iC[n];if(r.keywords.some(s=>e.includes(s.toLowerCase())))return{...r,name:n}}return{...iC.Default,name:"General Store"}},d1e=({generatedImage:t})=>{const[e,n]=p.useState(""),[r,s]=p.useState(""),[i,o]=p.useState(null),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState(!1),[m,g]=p.useState([]),[x,w]=p.useState(null),[v,_]=p.useState(!1),[C,T]=p.useState([]),R=p.useRef(null),{generateStore:k,isGenerating:E,importedStoreDataForGenerator:I,isImportDataReadyForGenerator:P,clearImportedStoreDataForGenerator:A,stores:D,openAuthModal:j}=$n(),{isAuthenticated:M,user:z}=ls(),[U,K]=p.useState(!1),[q,W]=p.useState(null),[te,O]=p.useState([]),[V,H]=p.useState(!1),[L,ee]=p.useState(null),pe=Wse(e,500);p.useEffect(()=>{if(t){const me=atob(t.split(",")[1]),Ue=t.split(",")[0].split(":")[1].split(";")[0],et=new ArrayBuffer(me.length),ct=new Uint8Array(et);for(let en=0;en<me.length;en++)ct[en]=me.charCodeAt(en);const Mt=new Blob([et],{type:Ue}),Sn=new File([Mt],"design.png",{type:Ue});T([{file:Sn,previewUrl:t}])}},[t]),p.useEffect(()=>{(async()=>{if(!pe.trim()||V)return;H(!0),ee(null),O([]);const Ue=await TI(pe);Ue.suggestions?O(Ue.suggestions):ee(Ue.error||"Failed to get suggestions."),H(!1)})()},[pe]),p.useEffect(()=>()=>{C.forEach(me=>{me.previewUrl&&URL.revokeObjectURL(me.previewUrl)})},[C]),p.useEffect(()=>{P&&I&&(n(I.name||""),s(I.prompt||""),I.name&&Ie(I.name),A())},[P,I,A]);const xe=me=>{n(me.target.value),W(null),O([]),ee(null)},we=me=>{n(me),O([]),W(null),setTimeout(()=>Ie(me),0)},Ie=p.useCallback(async me=>{const Ue=me||e;if(!Ue.trim())return W({status:"error",message:"Store name cannot be empty."}),!1;K(!0),W(null);try{return await ST(Ue.trim())?(W({status:"claimed",message:"Not available"}),!1):(W({status:"available",message:"Available"}),!0)}catch(et){return console.error("Store name availability check failed in StoreGenerator:",et),W({status:"error",message:et.message||"Failed to check name. Please try again."}),!1}finally{K(!1)}},[e]),Fe=me=>{o(me);const Ue=dF[me],et=Ue.match(/(?:store called|store named|market|boutique) '([^']+)'/i),ct=et&&et[1]?et[1]:"";n(ct),s(Ue),W(null),ct&&setTimeout(()=>Ie(ct),0)},Ve=async me=>{if(me.preventDefault(),!M&&D.length>=1){j();return}let Ue=!1;if(q&&q.status==="available"?Ue=!0:e.trim()?Ue=await Ie(e):W({status:"error",message:"Store name cannot be empty."}),!Ue)return;if(!r.trim()){alert("Please provide a description for your store.");return}if(E||U)return;const et=u1e(r);try{if(!await ba(z.uid,25)){alert("You don't have enough credits to generate a store.");return}await k(r,e,et,[],l,u,C,m),await Qa(z.uid,25)}catch(ct){console.error("Error calling generateStore from StoreGenerator:",ct),alert(`An error occurred during the store generation step: ${ct.message}`)}},Ge=me=>{const et=Array.from(me.target.files).map(ct=>({file:ct,previewUrl:ct.type.startsWith("image/")?URL.createObjectURL(ct):null}));T(ct=>[...ct,...et])},fe=me=>{const Ue=C[me];Ue.previewUrl&&URL.revokeObjectURL(Ue.previewUrl),T(et=>et.filter((ct,Mt)=>Mt!==me))},je=me=>{g(me)},ie=me=>{w(me),_(!0)},$e=(me,Ue)=>{g(m.map(et=>et.item.itemId===Ue?me:et)),_(!1)};return a.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"w-full",children:[a.jsxs("form",{onSubmit:Ve,children:[a.jsxs("div",{className:"mb-[13px]",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"storeName",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1 ml-[6px]",children:"Store Name"}),a.jsxs("div",{className:"relative flex items-center",children:[a.jsx(qe,{id:"storeName",type:"text",placeholder:"ex. Future Furniture",className:bt("text-base flex-grow",(q==null?void 0:q.status)==="claimed"&&"border-red-500 focus:border-red-500 dark:border-red-500 dark:focus:border-red-500",(q==null?void 0:q.status)==="error"&&"border-yellow-500 focus:border-yellow-500 dark:border-yellow-500 dark:focus:border-yellow-500",(q==null?void 0:q.status)==="available"&&"border-green-500 focus:border-green-500 dark:border-green-500 dark:focus:border-green-500","pr-24"),value:e,onChange:xe,disabled:E||U}),a.jsxs($,{type:"button",variant:"ghost",size:"sm",onClick:()=>Ie(),disabled:!e.trim()||U,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[U?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(ya,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs("div",{className:"mt-1",children:[" ",U&&e.trim()&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(ft,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),q&&e.trim()&&!U&&a.jsxs("p",{className:`text-sm font-medium flex items-center ${q.status==="available"?"text-green-600":q.status==="claimed"?"text-red-600":q.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[q.status==="available"&&a.jsx(ya,{className:"h-4 w-4 mr-1"}),q.status==="claimed"&&a.jsx(Q_,{className:"h-4 w-4 mr-1"}),q.status==="error"&&a.jsx(Q_,{className:"h-4 w-4 mr-1"}),q.message]})]}),(V||te.length>0||L)&&a.jsxs("div",{className:"mt-[7px] mb-[13px]",children:[V&&a.jsxs("div",{className:"flex items-center space-x-2 animate-pulse h-8",children:[a.jsx("div",{className:"h-8 w-28 bg-gray-200 dark:bg-gray-700 rounded-md"}),a.jsx("div",{className:"h-8 w-32 bg-gray-200 dark:bg-gray-700 rounded-md"}),a.jsx("div",{className:"h-8 w-24 bg-gray-200 dark:bg-gray-700 rounded-md"})]}),!V&&te.length>0&&a.jsxs(Ct.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},transition:{duration:.5},className:"flex flex-wrap gap-2",children:[a.jsx("span",{className:"text-sm text-muted-foreground mr-2 self-center",children:"Suggestions:"}),te.map((me,Ue)=>a.jsx($,{type:"button",variant:"outline",size:"sm",onClick:()=>we(me),className:"bg-gray-100 dark:bg-gray-800 hover:bg-gray-200 dark:hover:bg-gray-700 dark:border-gray-600 saturate-0",children:me},Ue))]}),L&&a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(Q_,{className:"h-4 w-4 mr-1"})," ",L]})]})]}),a.jsxs("div",{className:"pt-0 mt-[14px] mb-[13px]",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("label",{htmlFor:"storePrompt",className:"text-sm font-medium text-gray-700 dark:text-gray-300 ml-[6px]",children:"Prompt"}),a.jsxs("div",{className:"flex items-center",children:[a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"checkbox",id:"printOnDemandCheckbox",checked:l,onChange:me=>{c(me.target.checked),me.target.checked&&d(!1)},className:bt("appearance-none h-4 w-4 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-gray-900 cursor-pointer",!l&&"border border-gray-400 dark:border-gray-500","focus:ring-orange-500",l&&"bg-orange-500 border-transparent animate-radiate-orange")}),a.jsx("label",{htmlFor:"printOnDemandCheckbox",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Print on Demand"})]}),a.jsxs("div",{className:"flex items-center space-x-2 ml-4",children:[a.jsx("input",{type:"checkbox",id:"dropshippingCheckbox",checked:u,onChange:me=>{d(me.target.checked),me.target.checked&&(c(!1),f(!0))},className:bt("appearance-none h-4 w-4 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-1 dark:focus:ring-offset-gray-900 cursor-pointer",!u&&"border border-gray-400 dark:border-gray-500","focus:ring-blue-500",u&&"bg-blue-500 border-transparent animate-radiate-blue")}),a.jsx("label",{htmlFor:"dropshippingCheckbox",className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Dropshipping"})]})]})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Cn,{id:"storePrompt",placeholder:"ex. 'A modern furniture store specializing in sustainable and innovative designs for the contemporary home. Focus on minimalist aesthetics and smart functionality.'",className:"min-h-[120px] text-base resize-none w-full pr-12",value:r,onChange:me=>s(me.target.value),disabled:E}),a.jsxs("div",{className:"absolute bottom-2 right-2 flex items-center",children:[a.jsx("div",{className:"flex items-center gap-2 mr-2",children:C.map((me,Ue)=>a.jsxs("div",{className:"relative group",children:[me.previewUrl?a.jsx("img",{src:me.previewUrl,alt:"Preview",className:"h-8 w-8 rounded-md object-cover"}):a.jsx("div",{className:"h-8 w-8 rounded-md bg-gray-200 dark:bg-gray-700 flex items-center justify-center",children:a.jsx(br,{className:"h-5 w-5 text-gray-500"})}),a.jsx($,{variant:"ghost",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 rounded-full bg-red-500 text-white opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>fe(Ue),children:a.jsx(Ji,{className:"h-3 w-3"})})]},Ue))}),a.jsx($,{type:"button",variant:"ghost",size:"icon",className:"h-8 w-8 rounded-full text-gray-500 hover:text-gray-700 dark:text-gray-400 dark:hover:text-gray-200",onClick:()=>R.current.click(),disabled:E,children:a.jsx(ioe,{className:"h-5 w-5"})})]}),a.jsx("input",{type:"file",ref:R,multiple:!0,onChange:Ge,className:"hidden",accept:"application/pdf,image/*"})]})]}),m.length>0&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Selected Dropshipping Products"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:m.map(me=>a.jsxs("div",{className:"border rounded-lg p-2 cursor-pointer",onClick:()=>ie(me),children:[a.jsx("img",{src:me.item.image,alt:me.item.title,className:"w-full h-24 object-cover rounded-md mb-2"}),a.jsx("p",{className:"text-sm truncate",children:me.item.title})]},me.item.itemId))})]})]}),a.jsx($,{type:"submit",disabled:!e.trim()||!r.trim()||E||U||q&&q.status!=="available",className:"w-full bg-gradient-to-r from-green-600 to-cyan-600 hover:from-green-700 hover:to-cyan-700 text-white mt-6",size:"lg",children:E?a.jsxs(a.Fragment,{children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Store..."]}):a.jsxs(a.Fragment,{children:[a.jsx(Ea,{className:"mr-2 h-4 w-4"}),"Generate Store"]})}),a.jsxs("div",{className:"space-y-2 mt-6",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Or try one of these examples for inspiration:"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:dF.map((me,Ue)=>a.jsx($,{type:"button",variant:"outline",className:bt("h-auto py-2 px-3 justify-start text-left text-sm font-normal",i===Ue?"bg-[#c9ccd1] text-black hover:bg-[#c9ccd1] dark:bg-[#242424] dark:text-gray-300 dark:hover:bg-[#242424]":"hover:bg-accent hover:text-accent-foreground"),onClick:()=>Fe(Ue),disabled:E,children:me},Ue))})]})]}),a.jsx(e1e,{isOpen:h,onClose:()=>f(!1),onAddProducts:je}),x&&a.jsx(c1e,{isOpen:v,onClose:()=>_(!1),product:x,onSave:$e})]})};var h1e="AlertDialog",[f1e,t2e]=bi(h1e,[bU]),Xc=bU(),m1e="AlertDialogTrigger",p1e=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Xc(n);return a.jsx(Eae,{...s,...r,ref:e})});p1e.displayName=m1e;var g1e="AlertDialogPortal",dH=t=>{const{__scopeAlertDialog:e,...n}=t,r=Xc(e);return a.jsx(FU,{...r,...n})};dH.displayName=g1e;var y1e="AlertDialogOverlay",hH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Xc(n);return a.jsx(qI,{...s,...r,ref:e})});hH.displayName=y1e;var Bh="AlertDialogContent",[x1e,v1e]=f1e(Bh),w1e=Jse("AlertDialogContent"),fH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,children:r,...s}=t,i=Xc(n),o=p.useRef(null),l=mn(e,o),c=p.useRef(null);return a.jsx(wae,{contentName:Bh,titleName:mH,docsSlug:"alert-dialog",children:a.jsx(x1e,{scope:n,cancelRef:c,children:a.jsxs(KI,{role:"alertdialog",...i,...s,ref:l,onOpenAutoFocus:gt(s.onOpenAutoFocus,u=>{var d;u.preventDefault(),(d=c.current)==null||d.focus({preventScroll:!0})}),onPointerDownOutside:u=>u.preventDefault(),onInteractOutside:u=>u.preventDefault(),children:[a.jsx(w1e,{children:r}),a.jsx(_1e,{contentRef:o})]})})})});fH.displayName=Bh;var mH="AlertDialogTitle",pH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Xc(n);return a.jsx(YI,{...s,...r,ref:e})});pH.displayName=mH;var gH="AlertDialogDescription",yH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Xc(n);return a.jsx(JI,{...s,...r,ref:e})});yH.displayName=gH;var b1e="AlertDialogAction",xH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,s=Xc(n);return a.jsx(G0,{...s,...r,ref:e})});xH.displayName=b1e;var vH="AlertDialogCancel",wH=p.forwardRef((t,e)=>{const{__scopeAlertDialog:n,...r}=t,{cancelRef:s}=v1e(vH,n),i=Xc(n),o=mn(e,s);return a.jsx(G0,{...i,...r,ref:o})});wH.displayName=vH;var _1e=({contentRef:t})=>{const e=`\`${Bh}\` requires a description for the component to be accessible for screen reader users.

You can add a description to the \`${Bh}\` by passing a \`${gH}\` component as a child, which also benefits sighted users by adding visible context to the dialog.

Alternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Bh}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.

For more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return p.useEffect(()=>{var r;document.getElementById((r=t.current)==null?void 0:r.getAttribute("aria-describedby"))||console.warn(e)},[e,t]),null},S1e=dH,bH=hH,_H=fH,SH=xH,CH=wH,EH=pH,TH=yH;const C1e=S1e,IH=ht.forwardRef(({className:t,...e},n)=>a.jsx(bH,{className:bt("fixed inset-0 z-50 bg-black/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:n}));IH.displayName=bH.displayName;const E1e=ht.forwardRef(({className:t,...e},n)=>a.jsxs(C1e,{children:[a.jsx(IH,{}),a.jsx(_H,{ref:n,className:bt("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...e})]}));E1e.displayName=_H.displayName;const T1e=ht.forwardRef(({className:t,...e},n)=>a.jsx(EH,{ref:n,className:bt("text-lg font-semibold",t),...e}));T1e.displayName=EH.displayName;const I1e=ht.forwardRef(({className:t,...e},n)=>a.jsx(TH,{ref:n,className:bt("text-sm text-muted-foreground",t),...e}));I1e.displayName=TH.displayName;const N1e=ht.forwardRef(({className:t,...e},n)=>a.jsx(SH,{ref:n,className:bt(XI(),t),...e}));N1e.displayName=SH.displayName;const P1e=ht.forwardRef(({className:t,...e},n)=>a.jsx(CH,{ref:n,className:bt(XI({variant:"outline"}),"mt-2 sm:mt-0",t),...e}));P1e.displayName=CH.displayName;/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var c1=function(t,e){return c1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var s in r)r.hasOwnProperty(s)&&(n[s]=r[s])},c1(t,e)};function A1e(t,e){c1(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}var k1e=100,R1e=100,hF=50,u1=50,d1=50;function fF(t){var e=t.className,n=t.counterClockwise,r=t.dashRatio,s=t.pathRadius,i=t.strokeWidth,o=t.style;return p.createElement("path",{className:e,style:Object.assign({},o,D1e({pathRadius:s,dashRatio:r,counterClockwise:n})),d:j1e({pathRadius:s,counterClockwise:n}),strokeWidth:i,fillOpacity:0})}function j1e(t){var e=t.pathRadius,n=t.counterClockwise,r=e,s=n?1:0;return`
      M `+u1+","+d1+`
      m 0,-`+r+`
      a `+r+","+r+" "+s+" 1 1 0,"+2*r+`
      a `+r+","+r+" "+s+" 1 1 0,-"+2*r+`
    `}function D1e(t){var e=t.counterClockwise,n=t.dashRatio,r=t.pathRadius,s=Math.PI*2*r,i=(1-n)*s;return{strokeDasharray:s+"px "+s+"px",strokeDashoffset:(e?-i:i)+"px"}}var M1e=function(t){A1e(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.getBackgroundPadding=function(){return this.props.background?this.props.backgroundPadding:0},e.prototype.getPathRadius=function(){return hF-this.props.strokeWidth/2-this.getBackgroundPadding()},e.prototype.getPathRatio=function(){var n=this.props,r=n.value,s=n.minValue,i=n.maxValue,o=Math.min(Math.max(r,s),i);return(o-s)/(i-s)},e.prototype.render=function(){var n=this.props,r=n.circleRatio,s=n.className,i=n.classes,o=n.counterClockwise,l=n.styles,c=n.strokeWidth,u=n.text,d=this.getPathRadius(),h=this.getPathRatio();return p.createElement("svg",{className:i.root+" "+s,style:l.root,viewBox:"0 0 "+k1e+" "+R1e,"data-test-id":"CircularProgressbar"},this.props.background?p.createElement("circle",{className:i.background,style:l.background,cx:u1,cy:d1,r:hF}):null,p.createElement(fF,{className:i.trail,counterClockwise:o,dashRatio:r,pathRadius:d,strokeWidth:c,style:l.trail}),p.createElement(fF,{className:i.path,counterClockwise:o,dashRatio:h*r,pathRadius:d,strokeWidth:c,style:l.path}),u?p.createElement("text",{className:i.text,style:l.text,x:u1,y:d1},u):null)},e.defaultProps={background:!1,backgroundPadding:0,circleRatio:1,classes:{root:"CircularProgressbar",trail:"CircularProgressbar-trail",path:"CircularProgressbar-path",text:"CircularProgressbar-text",background:"CircularProgressbar-background"},counterClockwise:!1,className:"",maxValue:100,minValue:0,strokeWidth:8,styles:{root:{},trail:{},path:{},text:{},background:{}},text:""},e}(p.Component);function L1e(t){var e=t.rotation,n=t.strokeLinecap,r=t.textColor,s=t.textSize,i=t.pathColor,o=t.pathTransition,l=t.pathTransitionDuration,c=t.trailColor,u=t.backgroundColor,d=e==null?void 0:"rotate("+e+"turn)",h=e==null?void 0:"center center";return{root:{},path:Tx({stroke:i,strokeLinecap:n,transform:d,transformOrigin:h,transition:o,transitionDuration:l==null?void 0:l+"s"}),trail:Tx({stroke:c,strokeLinecap:n,transform:d,transformOrigin:h}),text:Tx({fill:r,fontSize:s}),background:Tx({fill:u})}}function Tx(t){return Object.keys(t).forEach(function(e){t[e]==null&&delete t[e]}),t}const F1e=({store:t})=>{var E,I,P,A,D;const e=wi(),{deleteStore:n,updateStoreTemplateVersion:r,getStoreRevenue:s,getStoreCustomers:i,getStoreConversionRate:o,getStoreSocialScore:l}=$n(),{user:c}=ls(),[u,d]=p.useState(null),[h,f]=p.useState(0),[m,g]=p.useState(0),[x,w]=p.useState(0),v=t.merchant_id===(c==null?void 0:c.uid),_=v&&((E=t.theme)!=null&&E.primaryColor)?{boxShadow:`0 0 10px 2px ${t.theme.primaryColor}A0`}:{};p.useEffect(()=>{v&&(s(t.id).then(d),i(t.id).then(g),o(t.id).then(w),l(t.id).then(f))},[v,t.id,s,i,o,l]);let C=null;if(t.products&&t.products.length>0){const j=t.products[0];C=((P=(I=j.image)==null?void 0:I.src)==null?void 0:P.medium)||((A=j.image)==null?void 0:A.url)||(Array.isArray(j.images)&&j.images.length>0?j.images[0]:null)}const T=C||t.card_background_url,R=j=>{if(!j)return"N/A";try{const M=new Date(j);return isNaN(M.getTime())?"Invalid Date":new Intl.DateTimeFormat("en-US",{year:"numeric",month:"short",day:"numeric"}).format(M)}catch(M){return console.error("Error formatting date:",j,M),"Error Date"}},k=j=>{switch(j){case"fashion":return a.jsx(moe,{className:"h-5 w-5 text-pink-500"});case"electronics":return a.jsx(Hy,{className:"h-5 w-5 text-blue-500"});case"food":return a.jsx(Hy,{className:"h-5 w-5 text-green-500"});case"jewelry":return a.jsx(Hy,{className:"h-5 w-5 text-amber-500"});default:return a.jsx(Hy,{className:"h-5 w-5 text-gray-500"})}};return a.jsx("div",{className:"cursor-pointer",onClick:()=>{t&&t.name?e(`/${mc(t.name)}`):console.error("Store name is missing, cannot navigate to preview.")},children:a.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"store-preview relative bg-cover bg-center rounded-[15px] overflow-hidden",style:{...T?{backgroundImage:`url(${T})`}:{backgroundColor:"#374151"},..._},children:[a.jsx("div",{className:"absolute inset-0",style:{backgroundColor:(D=t.theme)!=null&&D.primaryColor?`${t.theme.primaryColor}4D`:"transparent"}}),a.jsxs(Ke,{className:"h-full overflow-hidden border-2 border-white/20 hover:border-primary/50 transition-all duration-300 bg-black/30 backdrop-blur-sm text-white rounded-[15px]",children:[" ",a.jsxs("div",{className:"relative z-10 p-1 rounded-[15px]",children:[" ",a.jsxs(at,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[t.logo_url?a.jsx("div",{className:"h-12 w-12 overflow-hidden rounded-sm",children:a.jsx("img",{src:t.logo_url,alt:`${t.name} logo`,className:"w-full h-full object-cover"})}):k(t.niche),a.jsx(lt,{className:"text-xl text-white drop-shadow-md",children:t.name})]}),a.jsx("span",{className:"px-2 py-1 bg-white/10 text-white text-xs rounded-full backdrop-blur-xs",children:t.niche?t.niche.charAt(0).toUpperCase()+t.niche.slice(1):"General"})]}),a.jsx(Kt,{className:"line-clamp-2 mt-1 text-white drop-shadow-sm",children:t.description})]}),a.jsxs(st,{className:"pb-2",children:[a.jsxs("div",{className:"flex items-center text-sm text-white drop-shadow-sm gap-1 mb-3",children:[a.jsx(LI,{className:"h-3.5 w-3.5 mr-1 text-white"}),"Created on ",R(t.created_at||t.createdAt)]}),a.jsx("div",{className:"grid grid-cols-2 gap-2",children:t&&t.products&&Array.isArray(t.products)&&t.products.length>0?t.products.slice(0,4).map(j=>{var z,U,K;const M=((U=(z=j.image)==null?void 0:z.src)==null?void 0:U.medium)||((K=j.image)==null?void 0:K.url)||(Array.isArray(j.images)&&j.images.length>0?j.images[0]:null);return a.jsxs("div",{className:"bg-white/10 p-2 rounded-md text-xs flex items-center gap-2 backdrop-blur-xs cursor-pointer",onClick:q=>{q.stopPropagation(),e(`/${mc(t.name)}/product/${encodeURIComponent(j.id)}`)},children:[M&&a.jsx("img",{src:M,alt:j.name,className:"w-8 h-8 object-cover rounded-sm"}),a.jsxs("div",{className:"flex flex-col overflow-hidden",children:[a.jsx("span",{className:"font-medium truncate text-white",children:j.name||"Unnamed Product"}),a.jsx("span",{className:"text-white",children:typeof j.price=="number"?`$${j.price.toFixed(2)}`:"Price N/A"})]})]},j.id)}):a.jsx("p",{className:"text-xs text-white col-span-2",children:t&&t.products&&t.products.length===0?"No products yet.":"Product data unavailable."})}),v&&u!==null&&a.jsxs("div",{className:"mt-4 text-left",children:[a.jsxs("p",{className:"text-lg font-semibold text-white",children:["Total Revenue: $",u.toFixed(2)]}),a.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[a.jsx("div",{style:{width:50,height:50},children:a.jsx(M1e,{value:h,text:`${h}%`,styles:L1e({textColor:"white",pathColor:"white",trailColor:"rgba(255, 255, 255, 0.2)"})})}),a.jsx("div",{children:a.jsx("p",{className:"text-sm font-semibold text-white",children:"Social Score"})})]}),a.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm text-white",children:["Customers: ",m]}),a.jsxs("p",{className:"text-sm text-white",children:["Conversion Rate: ",x.toFixed(2),"%"]})]}),a.jsx($,{variant:"outline",size:"sm",className:"bg-white/90 hover:bg-white text-slate-800 border-slate-300 hover:border-slate-400",onClick:()=>{t&&t.name?e(`/${mc(t.name)}`):console.error("Store name is missing, cannot navigate to preview.")},children:"Preview"})]})]})]}),a.jsx(vd,{className:"flex flex-col items-start gap-2 pt-2"})]})]})]})})},mF=["255, 99, 132","54, 162, 235","255, 206, 86","75, 192, 192","153, 102, 255","255, 159, 64","255, 99, 132","54, 162, 235","255, 206, 86","75, 192, 192","153, 102, 255","255, 159, 64","255, 99, 132","54, 162, 235","255, 206, 86","75, 192, 192","153, 102, 255","255, 159, 64","255, 99, 132","54, 162, 235","255, 206, 86","75, 192, 192","153, 102, 255"],O1e=()=>{const{stores:t,loadStores:e,isLoadingStores:n}=$n(),{user:r}=ls(),[s,i]=p.useState(""),[o,l]=p.useState([]);p.useEffect(()=>{r&&r.uid&&e(r.uid)},[r]);const c=p.useMemo(()=>{let h=[...t].sort((f,m)=>{const g=f.merchant_id===(r==null?void 0:r.uid),x=m.merchant_id===(r==null?void 0:r.uid);return g&&!x?-1:!g&&x?1:0});return o.length>0&&(h=h.filter(f=>o.includes(f.niche))),s&&(h=h.filter(f=>f.name.toLowerCase().includes(s.toLowerCase()))),h},[t,s,r,o]),u=d=>{l(h=>h.includes(d)?h.filter(f=>f!==d):[...h,d])};return a.jsxs(Ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.2},className:"w-full max-w-6xl mx-auto mt-8",children:[a.jsx("div",{className:"flex justify-between items-center mb-6",children:a.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"Browse"})}),a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"relative",children:[a.jsx(ac,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted-foreground"}),a.jsx(qe,{type:"search",placeholder:"Search by store name...",className:"w-full pl-10 py-2 text-base",value:s,onChange:d=>i(d.target.value)})]})}),a.jsxs(ws,{className:"w-full whitespace-nowrap rounded-md border mb-4",children:[a.jsx("div",{className:"flex w-max space-x-2 p-2",children:AA.map((d,h)=>{const f=o.includes(d),m=f?{"--glow-color":mF[h%mF.length]}:{};return a.jsx($,{variant:f?"solid":"outline",onClick:()=>u(d),className:`capitalize ${f?"pulse-glow-animation":""}`,style:m,children:d},d)})}),a.jsx(HP,{orientation:"horizontal"})]}),n&&c.length===0&&a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-lg text-muted-foreground",children:"Loading your stores..."})}),!n&&t.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("h3",{className:"text-xl font-semibold",children:"No stores found"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Get started by generating a new one!"})]}),!n&&t.length>0&&c.length===0&&a.jsxs("div",{className:"text-center py-12",children:[a.jsx("h3",{className:"text-xl font-semibold",children:"No stores match your search"}),a.jsx("p",{className:"text-muted-foreground mt-2",children:"Try a different search term or clear the search to see all your stores."})]}),c.length>0&&a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6",children:c.map(d=>a.jsx(F1e,{store:d},d.id))})]})},$1e=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState(""),{startShopifyImportWizard:l,isFetchingShopifyPreviewData:c,shopifyImportError:u,setShopifyWizardStep:d}=$n(),h=async f=>{if(f.preventDefault(),!r||!i){alert("Please enter both Shopify domain and access token.");return}await l(r,i)&&n&&n()};return a.jsx(zr,{open:t,onOpenChange:f=>{e(f)},children:a.jsxs(Dr,{className:"sm:max-w-[425px] sm:rounded-xl",children:[" ",a.jsxs(Mr,{children:[a.jsx(Lr,{children:"Connect to Shopify"}),a.jsxs(_i,{className:"text-slate-500 dark:text-slate-400",children:[" ","Enter your Shopify store domain and Storefront Access Token to begin importing."]})]}),a.jsxs("form",{onSubmit:h,className:"grid gap-4 py-4",children:[u&&a.jsx("div",{className:"col-span-4 p-2 text-sm text-red-600 bg-red-100 border border-red-300 rounded",children:u}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ke,{htmlFor:"domain",className:"text-right",children:"Domain"}),a.jsx(qe,{id:"domain",value:r,onChange:f=>s(f.target.value),placeholder:zse,className:"col-span-3",disabled:c})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ke,{htmlFor:"token",className:"text-right",children:"Token"}),a.jsx(qe,{id:"token",type:"password",value:i,onChange:f=>o(f.target.value),placeholder:"Storefront Access Token",className:"col-span-3",disabled:c})]}),a.jsxs(Nr,{children:[a.jsx($,{type:"button",variant:"outline",disabled:c,onClick:()=>e(!1),children:"Cancel"}),a.jsx($,{type:"submit",disabled:c||!r||!i,children:c?a.jsxs(a.Fragment,{children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Connecting..."]}):"Connect & Fetch Info"})]})]})]})})},V1e=({open:t,onOpenChange:e,onSuccessfulConnect:n})=>{const[r,s]=p.useState(""),[i,o]=p.useState("");p.useState(!1),p.useState(null),p.useState("");const{startBigCommerceImportWizard:l,bigCommerceImportError:c,isFetchingBigCommercePreviewData:u}=$n(),d=async h=>{if(h.preventDefault(),!r||!i){alert("Both Store Domain and API Token are required.");return}await l(r,i),n&&n({storeDomain:r,apiToken:i})};return t?a.jsx("div",{className:"w-full",children:a.jsxs("form",{onSubmit:d,children:[a.jsxs(st,{className:"space-y-4 pt-6",children:[" ",a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"bc-store-domain",children:"Store Domain"}),a.jsx(qe,{id:"bc-store-domain",type:"text",placeholder:"e.g., mystore.mybigcommerce.com",value:r,onChange:h=>s(h.target.value.trim()),disabled:u})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"bc-api-token",children:"Storefront API Token"}),a.jsx(qe,{id:"bc-api-token",type:"password",placeholder:"Enter your Storefront API Token",value:i,onChange:h=>o(h.target.value.trim()),disabled:u})]}),c&&a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(ow,{className:"mr-2 h-4 w-4"})," ",c]})]}),a.jsx(vd,{className:"flex flex-col space-y-2",children:a.jsxs($,{type:"submit",className:"w-full",disabled:u,children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(ya,{className:"mr-2 h-4 w-4"}),u?"Connecting...":"Connect to BigCommerce"]})})]})}):null},U1e="modulepreload",B1e=function(t){return"/"+t},pF={},At=function(e,n,r){if(!n||n.length===0)return e();const s=document.getElementsByTagName("link");return Promise.all(n.map(i=>{if(i=B1e(i),i in pF)return;pF[i]=!0;const o=i.endsWith(".css"),l=o?'[rel="stylesheet"]':"";if(!!r)for(let d=s.length-1;d>=0;d--){const h=s[d];if(h.href===i&&(!o||h.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${l}`))return;const u=document.createElement("link");if(u.rel=o?"stylesheet":U1e,o||(u.as="script",u.crossOrigin=""),u.href=i,document.head.appendChild(u),o)return new Promise((d,h)=>{u.addEventListener("load",d),u.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${i}`)))})})).then(()=>e()).catch(i=>{const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i})},z1e="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk",G1e=[{category:Tr.HARM_CATEGORY_HARASSMENT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_HATE_SPEECH,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE}],W1e=["Shirt","Mug","Hat","Totebag","Poster"];async function H1e(t,e){var l;if(!t)return console.warn("[geminiPromptAnalysis] User store prompt is empty. Defaulting to standard strategy."),{strategy:"standard",theme:"General",requestedProductTypes:[],isPod:!1,podConfidence:0,suggestedPodProducts:[]};const r=new _n({apiKey:z1e}).getGenerativeModel({model:"gemini-1.5-flash-latest",safetySettings:G1e}),s=so.map(c=>c.name).join(", "),i=((l=Zw.find(c=>c.value===e))==null?void 0:l.label)||e||"General",o=`
    Analyze the following user prompt for an e-commerce store and the store's product niche.
    User Prompt: "${t}"
    Product Niche: "${i}"
    Available Print-on-Demand (POD) base product types: ${s}.

    Your goal is to determine the best product generation strategy.

    Consider these scenarios:
    1.  If the prompt explicitly mentions "print on demand", "POD", "custom designs on products", "merch", or implies selling items like t-shirts, mugs, posters with custom graphics, or a store themed around a concept (e.g., "Spiderman store", "cat lovers store") where designs are applied to standard products.
    2.  If the prompt requests specific products that are typically print-on-demand (e.g., "I want to sell t-shirts and hoodies with my art", "custom phone cases").
    3.  If the prompt describes a theme (e.g., "a store for coffee lovers", "a store about space exploration") but doesn't specify products, AND the niche is NOT typically print-on-demand (e.g., food, high-end jewelry, complex electronics, furniture). In this case, a POD strategy might be appropriate to offer themed merchandise.
    4.  If the prompt requests products that are clearly NOT print-on-demand (e.g., "gourmet chocolates", "handmade silver necklaces", "custom-built drones", "artisanal wooden tables"), or if the niche itself strongly indicates non-POD products (e.g., "Restaurant", "Tech Repair Service").
    5.  If the prompt is very generic or doesn't give enough information to lean towards POD.

    Based on your analysis, return a JSON object with the following structure:
    {
      "isPod": boolean, // True if the store is likely print-on-demand focused or should use POD products.
      "podConfidence": number, // Confidence score (0.0 to 1.0) for isPod.
      "theme": "string", // A concise theme extracted from the prompt (e.g., "Vintage Cars", "Abstract Art", "Funny Quotes", "Spiderman"). If no clear theme, use "General".
      "requestedProductTypes": ["string"], // Array of specific product names mentioned in the prompt that match or are very similar to the available POD base product types. (e.g., ["Shirt", "Mug"]). Empty if none.
      "suggestedPodProducts": ["string"], // If isPod is true and requestedProductTypes is empty, suggest 3-5 relevant POD base product types from the available list based on the theme/niche. (e.g., ["Shirt", "Mug", "Poster"]). Empty otherwise.
      "generationStrategy": "string" // One of: "standard", "pod_theme_visualization", "pod_specific_products", "error"
    }

    Strategy decision logic:
    -   If "isPod" is true AND "requestedProductTypes" has items: "generationStrategy" should be "pod_specific_products".
    -   If "isPod" is true AND "requestedProductTypes" is empty (implying a themed POD store but no specific products mentioned by user): "generationStrategy" should be "pod_theme_visualization". Use "suggestedPodProducts" for this.
    -   If "isPod" is false: "generationStrategy" should be "standard".
    -   If the niche is something like food, complex tech, high-end jewelry, furniture, and the prompt doesn't strongly push for POD merch, lean towards "standard" even if a theme is mentioned. For example, a "Spiderman themed restaurant" is still "standard" for food products. A "Spiderman store" (general merch) is "pod_theme_visualization".

    Example 1 (Specific POD products):
    User Prompt: "I want to create a store selling t-shirts and coffee mugs with cool dog designs."
    Product Niche: "Fashion & Apparel"
    Expected Output: { "isPod": true, "podConfidence": 0.9, "theme": "Cool Dog Designs", "requestedProductTypes": ["Shirt", "Mug"], "suggestedPodProducts": [], "generationStrategy": "pod_specific_products" }

    Example 2 (Themed POD store, no specific products):
    User Prompt: "A store for fans of classic horror movies, with iconic imagery."
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": true, "podConfidence": 0.8, "theme": "Classic Horror Movies", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug", "Canvas"], "generationStrategy": "pod_theme_visualization" }

    Example 3 (Standard store, non-POD niche):
    User Prompt: "Selling delicious artisanal cookies and pastries."
    Product Niche: "Food & Beverage"
    Expected Output: { "isPod": false, "podConfidence": 0.1, "theme": "Artisanal Cookies and Pastries", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 4 (Themed store, but niche is non-POD, so standard products for niche, POD for merch):
    User Prompt: "A high-tech gadget store with a cyberpunk theme."
    Product Niche: "Electronics & Gadgets"
    Expected Output: { "isPod": false, "podConfidence": 0.3, "theme": "Cyberpunk", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }
    (Note: The task description implies if niche is non-POD but theme is present, we *should* call POD flow. Let's adjust this example's expectation for the AI)
    Revised Example 4 (Themed store, niche non-POD, but POD for merch is desired):
    User Prompt: "A high-tech gadget store with a cyberpunk theme. I want some cool merch too."
    Product Niche: "Electronics & Gadgets"
    Expected Output: { "isPod": true, "podConfidence": 0.7, "theme": "Cyberpunk", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug"], "generationStrategy": "pod_theme_visualization" }


    Example 5 (Unique products, not POD):
    User Prompt: "I craft unique, handmade wooden sculptures."
    Product Niche: "Art & Collectibles"
    Expected Output: { "isPod": false, "podConfidence": 0.05, "theme": "Handmade Wooden Sculptures", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 6 (Generic prompt, default to standard):
    User Prompt: "My new online shop"
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": false, "podConfidence": 0.2, "theme": "General", "requestedProductTypes": [], "suggestedPodProducts": [], "generationStrategy": "standard" }

    Example 7 (Store theme implies POD, niche is general):
    User Prompt: "A store for all things Spiderman!"
    Product Niche: "General Merchandise"
    Expected Output: { "isPod": true, "podConfidence": 0.9, "theme": "Spiderman", "requestedProductTypes": [], "suggestedPodProducts": ["Shirt", "Poster", "Mug", "Hat", "Canvas"], "generationStrategy": "pod_theme_visualization" }

    Ensure the "theme" is concise. If "requestedProductTypes" are found, "suggestedPodProducts" should usually be empty. If "isPod" is true and "requestedProductTypes" is empty, "suggestedPodProducts" MUST be populated with 3-5 relevant items from the available POD list.
    The entire response MUST be a single JSON object.
  `;try{const d=(await r.generateContent(o)).response.text();let h;const f=d.match(/```json\s*([\s\S]*?)\s*```/);if(f&&f[1])h=JSON.parse(f[1]);else{const m=d.indexOf("{"),g=d.lastIndexOf("}");if(m!==-1&&g>m)h=JSON.parse(d.substring(m,g+1));else throw new Error("No JSON object found in response.")}return h.isPod&&(!h.requestedProductTypes||h.requestedProductTypes.length===0)&&(!h.suggestedPodProducts||h.suggestedPodProducts.length===0)&&(h.suggestedPodProducts=W1e.slice(0,Math.floor(Math.random()*3)+3),console.warn(`[geminiPromptAnalysis] POD strategy indicated but no specific or suggested POD products returned by AI. Defaulting suggestions: ${h.suggestedPodProducts.join(", ")}`)),h.strategy||(h.isPod&&h.requestedProductTypes&&h.requestedProductTypes.length>0?h.strategy="pod_specific_products":h.isPod?h.strategy="pod_theme_visualization":h.strategy="standard"),console.log("[geminiPromptAnalysis] Analysis result:",h),h}catch(c){return console.error("[geminiPromptAnalysis] Error analyzing store prompt:",c),{error:c.message,strategy:"error",theme:"General",requestedProductTypes:[],isPod:!1,podConfidence:0,suggestedPodProducts:[]}}}const q1e=MI("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function yg({className:t,variant:e,...n}){return a.jsx("div",{className:bt(q1e({variant:e}),t),...n})}var d_="Checkbox",[K1e,n2e]=bi(d_),[Y1e,rk]=K1e(d_);function J1e(t){const{__scopeCheckbox:e,checked:n,children:r,defaultChecked:s,disabled:i,form:o,name:l,onCheckedChange:c,required:u,value:d="on",internal_do_not_use_render:h}=t,[f,m]=Vc({prop:n,defaultProp:s??!1,onChange:c,caller:d_}),[g,x]=p.useState(null),[w,v]=p.useState(null),_=p.useRef(!1),C=g?!!o||!!g.closest("form"):!0,T={checked:f,disabled:i,setChecked:m,control:g,setControl:x,name:l,form:o,value:d,hasConsumerStoppedPropagationRef:_,required:u,defaultChecked:wc(s)?!1:s,isFormControl:C,bubbleInput:w,setBubbleInput:v};return a.jsx(Y1e,{scope:e,...T,children:X1e(h)?h(T):r})}var NH="CheckboxTrigger",PH=p.forwardRef(({__scopeCheckbox:t,onKeyDown:e,onClick:n,...r},s)=>{const{control:i,value:o,disabled:l,checked:c,required:u,setControl:d,setChecked:h,hasConsumerStoppedPropagationRef:f,isFormControl:m,bubbleInput:g}=rk(NH,t),x=mn(s,d),w=p.useRef(c);return p.useEffect(()=>{const v=i==null?void 0:i.form;if(v){const _=()=>h(w.current);return v.addEventListener("reset",_),()=>v.removeEventListener("reset",_)}},[i,h]),a.jsx(Wt.button,{type:"button",role:"checkbox","aria-checked":wc(c)?"mixed":c,"aria-required":u,"data-state":DH(c),"data-disabled":l?"":void 0,disabled:l,value:o,...r,ref:x,onKeyDown:gt(e,v=>{v.key==="Enter"&&v.preventDefault()}),onClick:gt(n,v=>{h(_=>wc(_)?!0:!_),g&&m&&(f.current=v.isPropagationStopped(),f.current||v.stopPropagation())})})});PH.displayName=NH;var sk=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:o,disabled:l,value:c,onCheckedChange:u,form:d,...h}=t;return a.jsx(J1e,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:l,required:o,onCheckedChange:u,name:r,form:d,value:c,internal_do_not_use_render:({isFormControl:f})=>a.jsxs(a.Fragment,{children:[a.jsx(PH,{...h,ref:e,__scopeCheckbox:n}),f&&a.jsx(jH,{__scopeCheckbox:n})]})})});sk.displayName=d_;var AH="CheckboxIndicator",kH=p.forwardRef((t,e)=>{const{__scopeCheckbox:n,forceMount:r,...s}=t,i=rk(AH,n);return a.jsx(_s,{present:r||wc(i.checked)||i.checked===!0,children:a.jsx(Wt.span,{"data-state":DH(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:e,style:{pointerEvents:"none",...t.style}})})});kH.displayName=AH;var RH="CheckboxBubbleInput",jH=p.forwardRef(({__scopeCheckbox:t,...e},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:o,required:l,disabled:c,name:u,value:d,form:h,bubbleInput:f,setBubbleInput:m}=rk(RH,t),g=mn(n,m),x=q7(i),w=zA(r);p.useEffect(()=>{const _=f;if(!_)return;const C=window.HTMLInputElement.prototype,R=Object.getOwnPropertyDescriptor(C,"checked").set,k=!s.current;if(x!==i&&R){const E=new Event("click",{bubbles:k});_.indeterminate=wc(i),R.call(_,wc(i)?!1:i),_.dispatchEvent(E)}},[f,x,i,s]);const v=p.useRef(wc(i)?!1:i);return a.jsx(Wt.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??v.current,required:l,disabled:c,name:u,value:d,form:h,...e,tabIndex:-1,ref:g,style:{...e.style,...w,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});jH.displayName=RH;function X1e(t){return typeof t=="function"}function wc(t){return t==="indeterminate"}function DH(t){return wc(t)?"indeterminate":t?"checked":"unchecked"}const MH=p.forwardRef(({className:t,...e},n)=>a.jsx(sk,{ref:n,className:bt("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...e,children:a.jsx(kH,{className:bt("flex items-center justify-center text-current"),children:a.jsx(Pg,{className:"h-4 w-4"})})}));MH.displayName=sk.displayName;const Q1e=({isOpen:t,onClose:e,collection:n,allProducts:r,onSave:s})=>{const[i,o]=p.useState([]);p.useEffect(()=>{n&&n.product_ids?o(n.product_ids):o([])},[n]);const l=u=>{o(d=>d.includes(u)?d.filter(h=>h!==u):[...d,u])},c=()=>{s(n.id||n.name,i),e()};return n?a.jsx(zr,{open:t,onOpenChange:e,children:a.jsxs(Dr,{className:"sm:max-w-lg",children:[a.jsxs(Mr,{children:[a.jsxs(Lr,{children:['Manage Products in "',n.name,'"']}),a.jsx(_i,{children:"Select the products that should appear in this collection."})]}),a.jsx(ws,{className:"max-h-[60vh] p-1",children:a.jsx("div",{className:"py-4 space-y-3",children:r&&r.length>0?r.map(u=>a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md hover:bg-muted/50 transition-colors",children:[a.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[u.images&&u.images.length>0?a.jsx("img",{src:u.images[0],alt:u.name||"Product image",className:"w-16 h-16 object-cover rounded-md border"}):a.jsx("div",{className:"w-16 h-16 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold",children:u.name||"Untitled Product"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:u.price?`$${parseFloat(u.price).toFixed(2)}`:"Price not available"})]})]}),a.jsx(MH,{checked:i.includes(u.id),onCheckedChange:()=>l(u.id),id:`product-${u.id}`})]},u.id)):a.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No products available to add to this collection."})})}),a.jsxs(Nr,{className:"sm:justify-between",children:[a.jsx(al,{asChild:!0,children:a.jsx($,{type:"button",variant:"outline",children:"Cancel"})}),a.jsx($,{type:"button",onClick:c,children:"Save Changes"})]})]})}):null},Z1e=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),eIe=({isOpen:t,onClose:e,product:n,onSave:r,onGenerateMainImage:s,onGenerateMoreAngles:i,productIndexInWizard:o,isGeneratingProductImage:l,isGeneratingAngles:c})=>{const[u,d]=p.useState(null),{toast:h}=Ss();p.useEffect(()=>{if(n){const P=n.variants?n.variants.map(j=>({...j,values:Array.isArray(j.values)?[...j.values]:typeof j.values=="string"?j.values.split(",").map(M=>M.trim()).filter(M=>M):[]})):[],A=Array.isArray(n.images)?[...n.images]:[],D={...n,variants:P,images:A};A.length===0&&n.imageUrl&&(D.images=[n.imageUrl]),d(D)}else d(null)},[n,t]);const f=P=>{const{name:A,value:D,type:j}=P.target;d(M=>({...M,[A]:j==="number"?parseFloat(D)||0:D}))},m=P=>{d(A=>({...A,images:P}))},g=async P=>{if(P.target.files&&P.target.files.length>0){const D=Array.from(P.target.files).map(j=>Z1e(j));try{const j=await Promise.all(D);m([...u.images||[],...j])}catch{h({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}},x=P=>{m((u.images||[]).filter((A,D)=>D!==P))},w=async()=>{s&&o!==null&&u&&await s(o,u)},v=async()=>{i&&o!==null&&u&&u.images&&u.images.length>0?await i(o,u):h({title:"Cannot Generate Angles",description:"A main image is required first.",variant:"warning"})},_=(P,A,D)=>{d(j=>{const M=[...j.variants||[]];return M[P]={...M[P],[A]:D},{...j,variants:M}})},C=(P,A,D)=>{d(j=>{const M=[...j.variants||[]],z=[...M[P].values];return z[A]=D,M[P]={...M[P],values:z},{...j,variants:M}})},T=P=>{d(A=>{const D=[...A.variants||[]],j=[...D[P].values,""];return D[P]={...D[P],values:j},{...A,variants:D}})},R=(P,A)=>{d(D=>{const j=[...D.variants||[]],M=j[P].values.filter((z,U)=>U!==A);return j[P]={...j[P],values:M},M.length===0&&h({title:"Info",description:`Variant option "${j[P].name}" has no values.`,variant:"default"}),{...D,variants:j}})},k=()=>{d(P=>({...P,variants:[...P.variants||[],{name:"",values:[""]}]}))},E=P=>{d(A=>({...A,variants:(A.variants||[]).filter((D,j)=>j!==P)}))},I=()=>{if(!u.name||u.name.trim()===""){h({title:"Validation Error",description:"Product name cannot be empty.",variant:"destructive"});return}if(u.price===void 0||u.price===null||isNaN(parseFloat(u.price))||parseFloat(u.price)<0){h({title:"Validation Error",description:"Product price must be a valid non-negative number.",variant:"destructive"});return}const P=u.variants?u.variants.map(A=>({...A,name:A.name.trim(),values:A.values.map(D=>D.trim()).filter(D=>D!=="")})).filter(A=>A.name!==""&&A.values.length>0):[];r({...u,variants:P}),e()};return!t||!u?null:a.jsx(zr,{open:t,onOpenChange:P=>{P||e()},children:a.jsxs(Dr,{className:"sm:max-w-2xl",children:[a.jsxs(Mr,{children:[a.jsx(Lr,{children:"Edit AI Generated Product"}),a.jsx(_i,{children:"Modify the details of the generated product below."})]}),a.jsx(ws,{className:"max-h-[70vh] p-1 pr-3",children:a.jsxs("div",{className:"space-y-4 py-4 pr-2",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"name",children:"Product Name"}),a.jsx(qe,{id:"name",name:"name",value:u.name||"",onChange:f})]}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"price",children:"Price (USD)"}),a.jsx(qe,{id:"price",name:"price",type:"number",value:u.price||0,onChange:f})]}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"description",children:"Description"}),a.jsx(Cn,{id:"description",name:"description",value:u.description||"",onChange:f,rows:4})]}),a.jsxs("div",{className:"space-y-2 border p-3 rounded-md",children:[a.jsx(ke,{className:"text-md font-semibold",children:"Product Images"}),u.images&&u.images.length>0?a.jsx("div",{className:"overflow-x-auto py-2",children:a.jsx("div",{className:"flex flex-row gap-2 mb-2 min-w-max",children:u.images.map((P,A)=>a.jsxs("div",{className:"relative group flex-shrink-0",children:[a.jsx("img",{src:P,alt:`Product image ${A+1}`,className:"w-24 h-24 object-contain rounded-md border"}),a.jsx($,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>x(A),children:a.jsx(Bn,{className:"h-3.5 w-3.5"})})]},`${P}-${A}`))})}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No images yet."}),a.jsxs("div",{className:"flex flex-wrap gap-2 mt-2",children:[a.jsxs($,{variant:"outline",size:"sm",onClick:()=>document.getElementById("editAiProductImageUpload").click(),children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),a.jsx(qe,{id:"editAiProductImageUpload",type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:g}),a.jsxs($,{variant:"outline",size:"sm",onClick:w,disabled:l||!u.name,children:[l?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),u.images&&u.images.length>0?"Regenerate Main":"Generate Main"]}),u.images&&u.images.length>0&&a.jsxs($,{variant:"outline",size:"sm",onClick:v,disabled:c,children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"More Angles"]})]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("h3",{className:"text-md font-semibold",children:"Variants"}),(u.variants||[]).map((P,A)=>a.jsxs(Ke,{className:"p-3 space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ke,{htmlFor:`variantName-${A}`,children:"Option Name"}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>E(A),className:"h-7 w-7",children:a.jsx(Bn,{className:"h-4 w-4 text-destructive"})})]}),a.jsx(qe,{id:`variantName-${A}`,value:P.name||"",onChange:D=>_(A,"name",D.target.value),placeholder:"e.g., Color, Size"}),a.jsx(ke,{children:"Option Values"}),P.values.map((D,j)=>a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qe,{value:D||"",onChange:M=>C(A,j,M.target.value),placeholder:"e.g., Red, Large"}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>R(A,j),className:"h-7 w-7",children:a.jsx(Bn,{className:"h-4 w-4 text-destructive"})})]},j)),a.jsxs($,{variant:"outline",size:"sm",onClick:()=>T(A),children:[a.jsx(Ui,{className:"mr-2 h-4 w-4"})," Add Value"]})]},A)),a.jsxs($,{variant:"outline",onClick:k,className:"w-full",children:[a.jsx(Ui,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]})}),a.jsxs(Nr,{children:[a.jsx(al,{asChild:!0,children:a.jsx($,{type:"button",variant:"outline",onClick:e,children:"Cancel"})}),a.jsx($,{type:"button",onClick:I,children:"Save Changes"})]})]})})},Hd=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),gF=(t,e)=>{const{formData:n,setFormData:r,handleInputChange:s,handleProductTypeChange:i,handleProductSourceChange:o,handleProductCountChange:l,handleManualProductChange:c,addManualProduct:u,removeManualProduct:d,suggestStoreName:h,generateLogo:f,generateAiProducts:m,generateAiCollections:g,handleGenerateManualProductImage:x,handleGenerateMoreAngles:w,isProcessing:v,isGeneratingProductImageForIndex:_,productImageGenerationError:C,isGeneratingAnglesForIndex:T,angleGenerationError:R,storeNameSuggestions:k,handleSuggestionClick:E,suggestionError:I,handleInitialImportMethodChange:P,handleProductPhotoUpload:A,uploadedProductPhotos:D,removeUploadedProductPhoto:j,isProcessingPhotos:M,handleGenerateCollectionImage:z,isGeneratingCollectionImageForIndex:U,collectionImageGenerationError:K,isCheckingStoreName:q,storeNameAvailability:W,handleManualStoreNameCheck:te}=e,[O,V]=p.useState(""),[H,L]=p.useState(""),[ee,pe]=p.useState(null),[xe,we]=p.useState(null),[Ie,Fe]=p.useState(""),[Ve,Ge]=p.useState(""),[fe,je]=p.useState([]),[ie,$e]=p.useState([]);p.useState(null);const[me,Ue]=p.useState([]),[et,ct]=p.useState(!1),[Mt,Sn]=p.useState(!1),[en,rn]=p.useState(""),{toast:kt}=Ss(),[xn,re]=p.useState(!1),[Se,B]=p.useState(null),[X,ne]=p.useState(null),Y=(Q,se,ye)=>{r(J=>{const le=[...J.products.items],be={...le[Q]};return be.variants=[...be.variants||[]],be.variants[se]={...be.variants[se],name:ye},le[Q]=be,{...J,products:{...J.products,items:le}}})},Ne=(Q,se,ye,J)=>{r(le=>{const be=[...le.products.items],Te={...be[Q]};Te.variants=[...Te.variants||[]];const Le={...Te.variants[se]};return Le.values=[...Le.values||[]],Le.values[ye]=J,Te.variants[se]=Le,be[Q]=Te,{...le,products:{...le.products,items:be}}})},ce=(Q,se)=>{r(ye=>{const J=[...ye.products.items],le={...J[Q]};le.variants=[...le.variants||[]];const be={...le.variants[se]};return be.values=[...be.values||[],""],le.variants[se]=be,J[Q]=le,{...ye,products:{...ye.products,items:J}}})},Ee=(Q,se,ye)=>{r(J=>{const le=[...J.products.items],be={...le[Q]};be.variants=[...be.variants||[]];const Te={...be.variants[se]};return Te.values=(Te.values||[]).filter((Le,Ce)=>Ce!==ye),be.variants[se]=Te,Te.values.length===0&&kt({title:"Info",description:`Variant option "${Te.name}" has no values. Consider removing the option or adding values.`,variant:"default"}),le[Q]=be,{...J,products:{...J.products,items:le}}})},Re=Q=>{r(se=>{const ye=[...se.products.items],J={...ye[Q]};return J.variants=[...J.variants||[],{name:"",values:[""]}],ye[Q]=J,{...se,products:{...se.products,items:ye}}})},Be=(Q,se)=>{r(ye=>{const J=[...ye.products.items],le={...J[Q]};return le.variants=(le.variants||[]).filter((be,Te)=>Te!==se),J[Q]=le,{...ye,products:{...ye.products,items:J}}})},_t=async Q=>{const se=Q.target.files[0];if(se){rn(""),pe(se);try{const ye=await Hd(se);L(ye),V(""),kt({title:"Image Uploaded",description:"Your image is ready for visualization."})}catch(ye){console.error("Error converting uploaded file to base64:",ye),rn("Failed to load uploaded image. Please try again."),kt({variant:"destructive",title:"Upload Failed",description:"Could not process the uploaded image."}),L(""),pe(null)}}},mt=()=>{L(""),pe(null),V(""),rn("");const Q=document.getElementById("podImageUpload");Q&&(Q.value="")},Ht=async Q=>{const se=Q.target.files[0];if(se){rn(""),we(se);try{const ye=await Hd(se);Fe(ye),kt({title:"Reference Image Added",description:"This image will be used with your prompt for generation."})}catch(ye){console.error("Error converting reference file to base64:",ye),rn("Failed to load reference image. Please try again."),kt({variant:"destructive",title:"Reference Image Load Failed",description:"Could not process the reference image."}),Fe(""),we(null)}}},tn=()=>{Fe(""),we(null),rn("");const Q=document.getElementById("podReferenceImageUpload");Q&&(Q.value="")},Rt=async()=>{if(!O){kt({title:"Missing Prompt",description:"Please enter a prompt for image generation.",variant:"destructive"});return}if(ee){kt({title:"Image Already Uploaded",description:"An image has already been uploaded. Clear it if you want to generate a new one.",variant:"warning"});return}ct(!0),rn(""),L("");let Q={prompt:O};if(xe&&Ie){const[se,ye]=Ie.split(","),J=se.match(/:(.*?);/)[1];Q.referenceImage={base64Data:ye,mimeType:J,fileName:xe.name},console.log("Attempting to generate POD image preview with prompt and reference image:",O,xe.name)}else console.log("Attempting to generate POD image preview for prompt:",O);try{const se=await Rg(Q);if(se.imageData&&se.imageMimeType){const ye=`data:${se.imageMimeType};base64,${se.imageData}`;L(ye),console.log("POD Image preview generated successfully.")}else throw new Error(se.textResponse||"Image data not returned from API.")}catch(se){console.error("Error generating POD image preview:",se);const ye=se.message||"Failed to generate image preview.";rn(ye),kt({variant:"destructive",title:"Image Generation Failed",description:ye})}finally{ct(!1)}},sn=Q=>{const se=Q.target.value;Ge(se),je(se?so.filter(ye=>ye.name.toLowerCase().includes(se.toLowerCase())):[])},In=Q=>{$e(se=>se.some(J=>J.name===Q.name)?se.filter(J=>J.name!==Q.name):[...se,Q])},Fr=async()=>{if(!H||ie.length===0){kt({title:"Missing Selections",description:"Please provide an image (generate or upload) and select at least one product type to visualize.",variant:"destructive"});return}let Q;if(ee&&ee.name?Q=`Uploaded: ${ee.name}`:O?Q=O:Q="Custom design",!ee&&!O){kt({title:"Missing Prompt",description:"If not uploading an image, please enter a prompt to generate an image first.",variant:"destructive"});return}Sn(!0),rn(""),Ue([]);const[se,ye]=H.split(","),J=se.match(/:(.*?);/)[1];let le=!0;const be=[];for(const Te of ie)try{console.log("Attempting to visualize POD product:",Te.name);const Le=await tf(ye,J,Te.imageUrl,Q,Te.name);if(Le.visualizedImageData&&Le.productDetails){const Ce=`data:${Le.visualizedImageMimeType};base64,${Le.visualizedImageData}`;be.push({title:Le.productDetails.title,price:parseFloat(Le.productDetails.price).toFixed(2),description:Le.productDetails.description,finalImageUrl:Ce,baseProductName:Te.name,generatedImagePrompt:Q,baseProductImageUrl:Te.imageUrl,sourceImageUsedForVisualization:H,tempId:`${Te.name}-${Date.now()}`}),console.log("POD Product visualized successfully:",Te.name)}else le=!1,console.error("Visualization failed for product:",Te.name,Le),rn(Ce=>Ce+`Visualization failed for ${Te.name}. `)}catch(Le){le=!1,console.error("Error visualizing POD product:",Te.name,Le);const Ce=Le.message||`Failed to visualize ${Te.name}.`;rn(it=>it+Ce+" ")}Ue(be),le?be.length>0&&kt({title:"Visualization Complete",description:`${be.length} product(s) visualized. You can now add them to your store.`}):kt({variant:"destructive",title:"Some Visualizations Failed",description:"Check errors below. Some products may not have visualized correctly."}),Sn(!1)},zn=Q=>{if(!Q)return;const se={name:Q.title,price:Q.price,description:Q.description,imageUrl:Q.finalImageUrl,isPrintOnDemand:!0,podDetails:{...Q}};delete se.podDetails.tempId,r(ye=>({...ye,products:{...ye.products,items:[...ye.products.items,se]}})),Ue(ye=>ye.filter(J=>J.tempId!==Q.tempId)),me.length===1&&me[0].tempId===Q.tempId&&($e([]),Ge("")),kt({title:"Product Added",description:`"${se.name}" added to your store's products.`})},wr=Q=>{r(se=>({...se,products:{...se.products,items:se.products.items.filter((ye,J)=>J!==Q)}})),kt({title:"Product Removed",description:"The Print on Demand product has been removed from your list.",variant:"destructive"})},[un,Nn]=p.useState(!1),[dn,cs]=p.useState(null),Z=(Q,se,ye)=>{r(J=>{const le=[...J.collections.items];return le[Q][se]=ye,{...J,collections:{...J.collections,items:le}}})},he=()=>{r(Q=>({...Q,collections:{...Q.collections,items:[...Q.collections.items,{name:"",description:"",imageUrl:""}]}}))},_e=Q=>{r(se=>{const ye=se.collections.items.filter((J,le)=>le!==Q);return{...se,collections:{...se.collections,items:ye}}})},Me=Q=>{cs(Q),Nn(!0)},Qe=(Q,se)=>{r(ye=>{const J=ye.collections.items.map(le=>le.id&&le.id===Q||le.name===Q?{...le,product_ids:se}:le);return{...ye,collections:{...ye.collections,items:J}}}),Nn(!1),cs(null)};switch(t){case 1:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"initialImportMethod",className:"text-lg font-semibold",children:"How would you like to start?"}),a.jsxs(xc,{onValueChange:P,value:n.initialImportMethod||"productType",children:[a.jsx(tl,{id:"initialImportMethod",className:"mt-2",children:a.jsx(vc,{placeholder:"Choose starting method..."})}),a.jsxs(nl,{children:[a.jsx(nr,{value:"productType",children:"Describe Product Type"}),a.jsx(nr,{value:"photos",children:"Start from Product Photos"})]})]})]}),n.initialImportMethod==="productType"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(ke,{htmlFor:"productType",className:"text-md font-medium",children:"What kind of products will your store sell?"}),a.jsx(qe,{id:"productType",name:"productType",value:n.productType,onChange:Q=>i(Q.target.value),placeholder:"e.g., Fashion, Electronics, Home Decor",list:"productTypeSuggestions"}),a.jsx("datalist",{id:"productTypeSuggestions",children:Zw.map(Q=>a.jsx("option",{value:Q.label},Q.value))}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This helps us tailor product suggestions and store design. Type to see suggestions."})]}),n.initialImportMethod==="photos"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(ke,{htmlFor:"productPhotosUpload",className:"text-md font-medium",children:"Upload Product Photos"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Upload multiple photos of your products. We'll use AI to understand them and pre-fill store details."}),a.jsx(qe,{id:"productPhotosUpload",type:"file",multiple:!0,accept:"image/*",onChange:A,className:`block w-full text-sm text-slate-500
                  file:mr-4 file:py-2 file:px-4
                  file:rounded-full file:border-0
                  file:text-sm file:font-semibold
                  file:bg-primary/10 file:text-primary
                  hover:file:bg-primary/20`,disabled:M}),M&&a.jsxs("div",{className:"flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing uploaded photos..."]}),D&&D.length>0&&a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Uploaded Photos (",D.length,"):"]}),a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 md:grid-cols-5 gap-3",children:D.map((Q,se)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:Q.previewUrl||Q,alt:`Uploaded product ${se+1}`,className:"w-full aspect-square object-cover rounded-md border"}),a.jsx($,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:()=>j(se),disabled:M,children:a.jsx(Bn,{className:"h-3.5 w-3.5"})})]},se))})]})]})]},"step1");case 2:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(ke,{htmlFor:"storeName",className:"text-lg font-semibold",children:"What's your store name?"}),a.jsxs("div",{className:"relative flex items-center gap-2",children:[a.jsx(qe,{id:"storeName",name:"storeName",value:n.storeName,onChange:s,placeholder:"e.g., 'The Cozy Corner Bookstore'",className:"flex-grow pr-20"}),a.jsxs($,{type:"button",variant:"ghost",size:"sm",onClick:te,disabled:!n.storeName||q,className:"absolute right-1 top-1/2 -translate-y-1/2 h-8 px-2 z-10",children:[q?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(ya,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-1 hidden sm:inline",children:"Check"})]})]}),a.jsxs($,{type:"button",variant:"outline",onClick:h,disabled:v||q||!n.productType,className:"w-full mt-2 sm:w-auto sm:mt-0",children:[v&&!q?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2",children:"Suggest Names"})]}),a.jsxs("div",{className:"h-5 mt-1",children:[" ",q&&n.storeName&&a.jsxs("p",{className:"text-sm text-muted-foreground flex items-center",children:[a.jsx(ft,{className:"h-4 w-4 animate-spin mr-2"})," Checking..."]}),W&&n.storeName&&!q&&a.jsxs("p",{className:`text-sm font-medium ${W.status==="available"?"text-green-600":W.status==="claimed"?"text-red-600":W.status==="error"?"text-yellow-600":"text-muted-foreground"}`,children:[W.message==="Available"?a.jsx(ya,{className:"inline h-4 w-4 mr-1"}):"",W.message]})]}),!n.storeName&&!q&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:'Choose a catchy name or let us suggest one. Click "Check" to verify availability.'}),I&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),k&&k.length>0&&a.jsxs("div",{className:"mt-3 space-y-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:k.map((Q,se)=>a.jsx($,{variant:"outline",size:"sm",onClick:()=>E(Q),className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:Q},se))})]})]},"step2");case 3:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(ke,{className:"text-lg font-semibold",children:"Design a logo for your store"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center p-4 border rounded-md",children:[a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(ke,{className:"text-sm mb-2",children:"For Light Backgrounds"}),n.logoUrlDark?a.jsx("img",{src:n.logoUrlDark,alt:"Logo for light backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-white"}):a.jsx("div",{className:"w-48 h-48 bg-gray-100 rounded-md flex items-center justify-center text-muted-foreground",children:"Light Bg Preview"})]}),a.jsxs("div",{className:"flex flex-col items-center",children:[a.jsx(ke,{className:"text-sm mb-2",children:"For Dark Backgrounds"}),n.logoUrlLight?a.jsx("img",{src:n.logoUrlLight,alt:"Logo for dark backgrounds",className:"w-48 h-48 object-contain rounded-md border bg-gray-800"}):a.jsx("div",{className:"w-48 h-48 bg-gray-700 rounded-md flex items-center justify-center text-gray-400",children:"Dark Bg Preview"})]})]}),a.jsxs($,{type:"button",onClick:f,disabled:v||!n.storeName,className:"w-full",children:[v?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ea,{className:"mr-2 h-4 w-4"}),"Generate Logo with AI (Light & Dark Versions)"]}),a.jsx("p",{className:"text-xs text-muted-foreground text-center",children:"AI will generate a logo, remove its background, and attempt to create light/dark mode versions."}),a.jsxs("div",{className:"space-y-3",children:[a.jsx(ke,{className:"text-sm",children:"Manually set logos (optional):"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"logoUrlDarkUpload",className:"text-xs",children:"Logo for Light Background (e.g., black logo)"}),a.jsx(qe,{id:"logoUrlDarkUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async Q=>{if(Q.target.files&&Q.target.files[0]){const se=Q.target.files[0];try{const ye=await Hd(se);r(J=>({...J,logoUrlDark:ye}))}catch(ye){console.error("Error converting file for logoUrlDark:",ye)}}}})]}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"logoUrlLightUpload",className:"text-xs",children:"Logo for Dark Background (e.g., white logo)"}),a.jsx(qe,{id:"logoUrlLightUpload",type:"file",accept:"image/*",className:"mt-1 text-xs",onChange:async Q=>{if(Q.target.files&&Q.target.files[0]){const se=Q.target.files[0];try{const ye=await Hd(se);r(J=>({...J,logoUrlLight:ye}))}catch(ye){console.error("Error converting file for logoUrlLight:",ye)}}}})]})]})]}),(n.logoUrlLight||n.logoUrlDark)&&a.jsxs($,{variant:"destructive",size:"sm",onClick:()=>r(Q=>({...Q,logoUrlLight:"",logoUrlDark:""})),className:"mt-4 w-full",children:[a.jsx(Bn,{className:"mr-2 h-4 w-4"})," Remove All Logos"]})]},"step3");case 4:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(ke,{className:"text-lg font-semibold",children:"How do you want to add products?"}),a.jsxs(xc,{onValueChange:o,value:n.products.source,children:[a.jsx(tl,{children:a.jsx(vc,{placeholder:"Choose product source..."})}),a.jsxs(nl,{children:[a.jsx(nr,{value:"ai",children:"Generate with AI"}),a.jsx(nr,{value:"manual",children:"Add Manually"}),a.jsx(nr,{value:"printOnDemand",children:"Print on Demand"}),a.jsx(nr,{value:"csv",disabled:!0,children:"Upload CSV (Coming Soon)"})]})]}),n.products.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"productCount",children:"Number of AI Products to Generate"}),a.jsx(qe,{id:"productCount",type:"number",min:"1",max:"5",value:n.products.count,onChange:l})]}),a.jsxs($,{type:"button",onClick:m,disabled:v||!n.productType||!n.storeName,className:"w-full",children:[v?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Products with AI"]}),I&&n.products.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),n.products.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[" ",a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Products:"}),n.products.items.map((Q,se)=>a.jsxs(Ke,{className:"p-4 flex gap-4 items-start relative",children:[Q.images&&Q.images.length>0?a.jsx("img",{src:Q.images[0],alt:Q.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:Q.name||"Untitled Product"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["$",Q.price||"0.00"]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:Q.description||"No description."}),Q.variants&&Q.variants.length>0&&a.jsx("div",{className:"mt-1.5",children:Q.variants.map((ye,J)=>a.jsxs("div",{className:"text-xs",children:[a.jsxs("span",{className:"font-medium text-muted-foreground",children:[ye.name,": "]}),a.jsx("span",{className:"text-gray-700 dark:text-gray-300",children:Array.isArray(ye.values)?ye.values.join(", "):ye.values})]},J))})]}),a.jsx($,{variant:"outline",size:"icon",className:"absolute top-2 right-2 h-8 w-8",onClick:()=>{B({...Q}),ne(se),re(!0)},children:a.jsx(nw,{className:"h-4 w-4"})})]},se))]})]}),xn&&X!==null&&n.products.items[X]&&a.jsx(eIe,{isOpen:xn,onClose:()=>{re(!1),ne(null)},product:n.products.items[X],onSave:Q=>{r(se=>{const ye=[...se.products.items];return X!==null&&ye[X]&&(ye[X]=Q),{...se,products:{...se.products,items:ye}}}),re(!1),B(null),ne(null),kt({title:"Product Updated",description:`"${Q.name}" has been updated.`})},onGenerateMainImage:x,onGenerateMoreAngles:w,productIndexInWizard:X,isGeneratingProductImage:_===X,isGeneratingAngles:T===X}),n.products.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[" ",n.products.items.map((Q,se)=>a.jsxs(Ke,{className:"p-4 space-y-3 relative",children:[a.jsx($,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>d(se),disabled:n.products.items.length<=1,children:a.jsx(Bn,{className:"h-4 w-4 text-destructive"})}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:`productName-${se}`,children:"Product Name"}),a.jsx(qe,{id:`productName-${se}`,value:Q.name,onChange:ye=>c(se,"name",ye.target.value),placeholder:"e.g., 'Handmade Coffee Mug'"})]}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:`productPrice-${se}`,children:"Price (USD)"}),a.jsx(qe,{id:`productPrice-${se}`,type:"number",value:Q.price,onChange:ye=>c(se,"price",ye.target.value),placeholder:"e.g., '24.99'"})]})]}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:`productDescription-${se}`,children:"Short Description (Optional)"}),a.jsx(Cn,{id:`productDescription-${se}`,value:Q.description,onChange:ye=>c(se,"description",ye.target.value),placeholder:"e.g., 'Beautifully crafted ceramic mug, perfect for your morning coffee.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[Q.images&&Q.images.length>0?a.jsx("div",{className:"flex flex-wrap gap-2 mb-2",children:Q.images.map((ye,J)=>a.jsxs("div",{className:"relative group",children:[a.jsx("img",{src:ye,alt:`${Q.name||"Product"} image ${J+1}`,className:"w-20 h-20 object-contain rounded-md border"}),a.jsx($,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity",onClick:()=>{const le=Q.images.filter((be,Te)=>Te!==J);c(se,"images",le)},children:a.jsx(Bn,{className:"h-3 w-3"})})]},J))}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground mb-2",children:"No Images"}),a.jsx(ke,{htmlFor:`productImageUpload-${se}`,className:"text-sm sr-only",children:"Upload Product Images"}),a.jsx(qe,{id:`productImageUpload-${se}`,type:"file",accept:"image/*",multiple:!0,className:"hidden",onChange:async ye=>{if(ye.target.files&&ye.target.files.length>0){const le=Array.from(ye.target.files).map(be=>Hd(be));try{const be=await Promise.all(le),Te=[...Q.images||[],...be];c(se,"images",Te)}catch(be){console.error("Error converting files to base64:",be),kt({title:"Image Upload Error",description:"Could not process some images.",variant:"destructive"})}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs($,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`productImageUpload-${se}`).click(),children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Upload Images"]}),Q.images&&Q.images.length>0&&a.jsxs($,{variant:"destructive",size:"sm",onClick:()=>c(se,"images",[]),children:[a.jsx(Bn,{className:"mr-2 h-4 w-4"})," Remove All"]}),a.jsxs($,{type:"button",variant:"outline",size:"sm",onClick:()=>x(se),disabled:_===se||!Q.name,children:[_===se?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Main Image"]}),Q.images&&Q.images.length>0&&a.jsxs($,{type:"button",variant:"outline",size:"sm",onClick:()=>w(se),disabled:T===se,children:[T===se?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate More Angles"]})]}),C&&_===se&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:C}),R&&T===se&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:R})]}),a.jsxs("div",{className:"space-y-3 pt-3 border-t mt-3",children:[a.jsx("h4",{className:"text-sm font-semibold text-muted-foreground",children:"Product Variants"}),(Q.variants||[]).map((ye,J)=>a.jsxs(Ke,{className:"p-2 space-y-2 bg-muted/50",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx(ke,{htmlFor:`manualVariantName-${se}-${J}`,className:"text-xs",children:"Option Name"}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>Be(se,J),className:"h-6 w-6",children:a.jsx(Bn,{className:"h-3 w-3 text-destructive"})})]}),a.jsx(qe,{id:`manualVariantName-${se}-${J}`,value:ye.name||"",onChange:le=>Y(se,J,le.target.value),placeholder:"e.g., Color, Size",className:"text-sm h-8"}),a.jsx(ke,{className:"text-xs",children:"Option Values"}),(ye.values||[]).map((le,be)=>a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(qe,{value:le||"",onChange:Te=>Ne(se,J,be,Te.target.value),placeholder:"e.g., Red, Large",className:"text-sm h-8"}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>Ee(se,J,be),className:"h-6 w-6",children:a.jsx(Bn,{className:"h-3 w-3 text-destructive"})})]},be)),a.jsxs($,{variant:"outline",size:"sm",onClick:()=>ce(se,J),className:"text-xs h-7",children:[a.jsx(Ui,{className:"mr-1 h-3 w-3"})," Add Value"]})]},J)),a.jsxs($,{variant:"outline",onClick:()=>Re(se),className:"w-full text-sm h-8",children:[a.jsx(Ui,{className:"mr-2 h-4 w-4"})," Add Variant Option"]})]})]},se)),a.jsxs($,{type:"button",variant:"outline",onClick:()=>{u()},className:"w-full",children:[a.jsx(Ui,{className:"mr-2 h-4 w-4"})," Add Another Product"]})]}),n.products.source==="printOnDemand"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-md font-semibold",children:"Configure Print on Demand Product"}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"podImagePrompt",children:"Image Generation Prompt"}),a.jsx(Cn,{id:"podImagePrompt",placeholder:"e.g., A majestic wolf howling at a vibrant aurora borealis",value:O,onChange:Q=>V(Q.target.value),rows:2}),a.jsxs($,{type:"button",onClick:Rt,disabled:v||et||!O||!!ee,className:"mt-2",variant:"outline",children:[et?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Image"]}),a.jsxs($,{type:"button",variant:"outline",className:"mt-2 ml-2",onClick:()=>document.getElementById("podReferenceImageUpload").click(),disabled:v||et||!!ee,children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Add Ref. Image"]}),a.jsx(qe,{id:"podReferenceImageUpload",type:"file",accept:"image/*",className:"hidden",onChange:Ht})]}),Ie&&a.jsxs("div",{className:"mt-2 flex flex-col items-start text-sm",children:[a.jsx(ke,{className:"mb-1",children:"Reference Image:"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:Ie,alt:"Reference preview",className:"w-16 h-16 object-contain rounded-md border bg-muted"}),a.jsx("span",{className:"text-xs text-muted-foreground truncate max-w-[150px]",children:xe==null?void 0:xe.name}),a.jsx($,{type:"button",variant:"ghost",size:"icon",onClick:tn,className:"h-7 w-7",children:a.jsx(Bn,{className:"h-4 w-4 text-destructive"})})]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx(ke,{htmlFor:"podImageUpload",children:"Or Upload Final Image for Product"}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx(qe,{id:"podImageUpload",type:"file",accept:"image/*",onChange:_t,className:"flex-grow",disabled:et}),H&&ee&&a.jsx($,{type:"button",variant:"ghost",size:"icon",onClick:mt,className:"h-9 w-9",children:a.jsx(Bn,{className:"h-4 w-4 text-destructive"})})]}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"If you upload an image, it will be used instead of the generated one."})]}),en&&a.jsxs("div",{className:"mt-2 p-2 bg-destructive/10 border border-destructive/50 rounded-md text-destructive text-sm flex items-center gap-2",children:[a.jsx(Ng,{className:"h-5 w-5"}),a.jsx("p",{children:en})]}),H&&a.jsxs("div",{className:"mt-2 flex flex-col items-center",children:[a.jsx(ke,{className:"mb-1",children:"Image Preview:"}),a.jsx("img",{src:H,alt:"Generated preview",className:"w-40 h-40 object-contain rounded-md border bg-muted"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ke,{htmlFor:"podProductSearch",children:"Search Print on Demand Products"}),a.jsx(qe,{id:"podProductSearch",placeholder:"e.g., T-shirt, Mug",value:Ve,onChange:sn,disabled:!H}),fe.length>0&&a.jsx(Ke,{className:"absolute z-10 w-full mt-1 max-h-48 overflow-y-auto border bg-background shadow-lg",children:fe.map(Q=>{const se=ie.some(ye=>ye.name===Q.name);return a.jsxs("div",{className:`p-2 hover:bg-muted cursor-pointer flex items-center gap-2 ${se?"bg-primary/10":""}`,onClick:()=>In(Q),children:[a.jsx("img",{src:Q.imageUrl,alt:Q.name,className:"w-8 h-8 object-contain rounded-sm"}),a.jsx("span",{children:Q.name}),se&&a.jsx(ya,{className:"h-4 w-4 text-primary ml-auto"})]},Q.name)})})]}),ie.length>0&&a.jsxs("div",{className:"mt-3",children:[a.jsx(ke,{className:"text-sm mb-1 block",children:"Selected Product Types:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:ie.map(Q=>a.jsxs(yg,{variant:"secondary",className:"flex items-center gap-1.5 pr-1",children:[Q.name,a.jsx($,{variant:"ghost",size:"icon",className:"h-5 w-5 hover:bg-destructive/20",onClick:()=>In(Q),children:a.jsx(Ji,{className:"h-3 w-3 text-destructive"})})]},Q.name))})]}),a.jsxs($,{type:"button",onClick:Fr,disabled:v||Mt||!H||ie.length===0,className:"w-full mt-2",children:[Mt?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ea,{className:"mr-2 h-4 w-4"}),`Visualize Design on ${ie.length} Product(s)`]}),me.length>0&&a.jsxs("div",{className:"mt-4 space-y-3",children:[a.jsx("h4",{className:"font-semibold text-md",children:"Visualized Products:"}),me.map(Q=>a.jsxs(Ke,{className:"p-4 space-y-3",children:[a.jsxs("div",{className:"flex gap-4 items-start",children:[a.jsx("img",{src:Q.finalImageUrl,alt:Q.title,className:"w-24 h-24 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("p",{className:"font-semibold",children:Q.title}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Base: ",Q.baseProductName]}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["Price: $",Q.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-3",children:Q.description})]})]}),a.jsxs($,{type:"button",onClick:()=>zn(Q),className:"w-full bg-green-600 hover:bg-green-700",disabled:v,children:[a.jsx(Ui,{className:"mr-2 h-4 w-4"}),"Add This Product to Store"]})]},Q.tempId))]}),n.products.items.filter(Q=>Q.isPrintOnDemand).length>0&&a.jsxs("div",{className:"mt-6 space-y-3",children:[a.jsx("p",{className:"text-md font-semibold",children:"Added Print on Demand Products:"}),a.jsxs("div",{className:"max-h-96 overflow-y-auto pr-2 space-y-3",children:[" ",n.products.items.map((Q,se)=>Q.isPrintOnDemand?a.jsxs(Ke,{className:"p-3 flex gap-3 items-start relative",children:[a.jsx("img",{src:Q.imageUrl,alt:Q.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-sm",children:Q.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["$",Q.price]}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:Q.description})]}),a.jsx($,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-6 w-6",onClick:()=>wr(se),children:a.jsx(Bn,{className:"h-4 w-4 text-destructive"})})]},`pod-item-${se}`):null)]})]})]})]},"step4");case 5:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-6 w-full",children:[a.jsx(ke,{className:"text-lg font-semibold",children:"How do you want to add collections?"}),a.jsxs(xc,{onValueChange:Q=>r(se=>({...se,collections:{...se.collections,source:Q}})),value:n.collections.source,children:[a.jsx(tl,{children:a.jsx(vc,{placeholder:"Choose collection source..."})}),a.jsxs(nl,{children:[a.jsx(nr,{value:"ai",children:"Generate with AI"}),a.jsx(nr,{value:"manual",children:"Add Manually"})]})]}),I&&n.collections.source==="ai"&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:I}),K&&n.collections.source==="manual"&&U===null&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:K}),n.collections.source==="ai"&&a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"collectionCount",children:"Number of AI Collections to Generate"}),a.jsx(qe,{id:"collectionCount",type:"number",min:"1",max:"5",value:n.collections.count,onChange:Q=>r(se=>({...se,collections:{...se.collections,count:parseInt(Q.target.value)||1}}))})]}),a.jsxs($,{type:"button",onClick:g,disabled:v||!n.productType||!n.storeName||n.products.items.length===0,className:"w-full",children:[v?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate Collections with AI"]}),n.collections.items.length>0&&a.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto pr-2 mt-4",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Generated Collections:"}),n.collections.items.map((Q,se)=>a.jsxs(Ke,{className:"p-4 flex gap-4 items-start",children:[Q.imageUrl?a.jsx("img",{src:Q.imageUrl,alt:Q.name,className:"w-24 h-24 object-cover rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsxs("div",{className:"flex-1 space-y-1",children:[a.jsx("h4",{className:"font-semibold text-md",children:Q.name||"Untitled Collection"}),a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:Q.description||"No description."})]}),a.jsx("div",{className:"flex flex-col gap-1",children:a.jsx($,{variant:"outline",size:"sm",className:"text-xs h-auto py-1 mt-2",onClick:()=>Me(Q),children:"Manage Products"})})]},se))]}),dn&&a.jsx(Q1e,{isOpen:un,onClose:()=>{Nn(!1),cs(null)},collection:dn,allProducts:n.products.items,onSave:Qe})]}),n.collections.source==="manual"&&a.jsxs("div",{className:"space-y-4 max-h-96 overflow-y-auto pr-2",children:[a.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Your Collections:"}),n.collections.items.map((Q,se)=>a.jsxs(Ke,{className:"p-4 space-y-3 relative",children:[a.jsx($,{variant:"ghost",size:"icon",className:"absolute top-1 right-1 h-7 w-7",onClick:()=>_e(se),disabled:n.collections.items.length<=1&&!Q.name&&!Q.description&&!Q.imageUrl,children:a.jsx(Bn,{className:"h-4 w-4 text-destructive"})}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:a.jsxs("div",{children:[a.jsx(ke,{htmlFor:`collectionName-${se}`,children:"Collection Name"}),a.jsx(qe,{id:`collectionName-${se}`,value:Q.name,onChange:ye=>Z(se,"name",ye.target.value),placeholder:"e.g., 'Summer Collection'"})]})}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:`collectionDescription-${se}`,children:"Short Description (Optional)"}),a.jsx(Cn,{id:`collectionDescription-${se}`,value:Q.description,onChange:ye=>Z(se,"description",ye.target.value),placeholder:"e.g., 'A curated selection of products perfect for the summer season.'",rows:2})]}),a.jsxs("div",{className:"flex flex-col items-center gap-2 p-2 border rounded-md",children:[Q.imageUrl?a.jsx("img",{src:Q.imageUrl,alt:Q.name||"Collection image",className:"w-24 h-24 object-contain rounded-md border"}):a.jsx("div",{className:"w-24 h-24 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),a.jsx(ke,{htmlFor:`collectionImageUpload-${se}`,className:"text-sm sr-only",children:"Upload Collection Image"}),a.jsx(qe,{id:`collectionImageUpload-${se}`,type:"file",accept:"image/*",className:"hidden",onChange:async ye=>{if(ye.target.files&&ye.target.files[0]){const J=ye.target.files[0];try{const le=await Hd(J);Z(se,"imageUrl",le)}catch(le){console.error("Error converting file to base64:",le)}}}}),a.jsxs("div",{className:"flex flex-wrap gap-2",children:[a.jsxs($,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById(`collectionImageUpload-${se}`).click(),children:[a.jsx(Uo,{className:"mr-2 h-4 w-4"})," Upload"]}),a.jsxs($,{type:"button",variant:"outline",size:"sm",onClick:()=>z(se),disabled:U===se||!Q.name,children:[U===se?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate"]}),Q.imageUrl&&a.jsxs($,{variant:"destructive",size:"sm",onClick:()=>Z(se,"imageUrl",""),children:[a.jsx(Bn,{className:"mr-1 h-3 w-3"})," Remove Img"]})]})]}),K&&U===se&&a.jsx("p",{className:"text-xs text-destructive mt-1",children:K})]},se)),a.jsxs($,{type:"button",variant:"outline",onClick:he,className:"w-full",children:[a.jsx(Ui,{className:"mr-2 h-4 w-4"})," Add Another Collection"]})]})]},"step5");case 6:return a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50},className:"space-y-4 w-full",children:[a.jsx(ke,{htmlFor:"prompt",className:"text-lg font-semibold",children:"Describe your store's overall style and feel"}),a.jsx(Cn,{id:"prompt",name:"prompt",value:n.prompt,onChange:s,placeholder:"e.g., 'A minimalist and modern design with a focus on high-quality product imagery. Use a cool color palette.' OR 'A vibrant and playful store with bold colors and fun animations.'",className:"min-h-[100px]"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"This will influence the theme, layout, and imagery. Your store name, logo, and products are already included. You can also pick from the examples below."}),a.jsxs("div",{className:"mt-4 space-y-2",children:[a.jsx(ke,{className:"text-md font-semibold",children:"AI Prompt Examples:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:[{key:"elegance",displayName:"Elegance",storeName:"Elegant Finds",promptText:"A sophisticated and elegant store experience, focusing on timeless design and high-quality craftsmanship. The aesthetic is refined, with a clean layout and luxurious feel, using a palette of soft neutrals, gold accents, and rich textures."},{key:"futuretech",displayName:"FutureTech",storeName:"Nexus Innovations",promptText:"A cutting-edge, futuristic store specializing in the latest technology and gadgets. The design is sleek, minimalist, and dark-themed with neon blue or cyan accents, interactive elements, and a high-tech vibe."},{key:"greenharvest",displayName:"GreenHarvest",storeName:"Evergreen Market",promptText:"An eco-friendly and organic store focusing on sustainable and natural products. The design should feel earthy, warm, and inviting, using natural materials, green and brown tones, and imagery of nature."},{key:"urbanthreads",displayName:"UrbanThreads",storeName:"Metro Threads Co.",promptText:"A trendy, urban streetwear store with a gritty yet stylish aesthetic. Think industrial-chic, graffiti art influences, bold typography, and a dynamic, energetic feel. Muted colors with pops of vibrant color."}].map(Q=>a.jsx($,{variant:"outline",size:"sm",onClick:()=>{e.setFormData(se=>({...se,storeName:Q.storeName,prompt:Q.promptText}))},className:"bg-primary-foreground dark:bg-neutral-800 hover:bg-primary/10 dark:hover:bg-neutral-700",children:Q.displayName},Q.key))})]})]},"step6");default:return null}},yF=(t,e,n)=>!!(t===1&&(e.initialImportMethod==="productType"&&!e.productType||e.initialImportMethod==="photos"&&(!n||n.length===0))||t===2&&!e.storeName||t===4&&(e.products.source==="manual"&&e.products.items.some(r=>!r.name||!r.price)||e.products.source==="ai"&&e.products.items.length===0&&e.products.count>0)||t===5&&(e.collections.source==="ai"&&e.collections.items.length===0&&e.collections.count>0||e.collections.source==="manual"&&e.collections.items.some(r=>!r.name))||t===6&&!e.prompt),LH=({isEmbedded:t=!1,onGenerationComplete:e,initialDataFromImport:n=null})=>{const r=wi(),[s,i]=p.useState(1),[o,l]=p.useState([]),[c,u]=p.useState({initialImportMethod:"productType",productType:"",storeName:"",logoUrlLight:"",logoUrlDark:"",products:{source:"ai",count:3,items:[]},collections:{source:"ai",count:3,items:[]},prompt:""}),[d,h]=p.useState([]),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[w,v]=p.useState(null),[_,C]=p.useState(null),[T,R]=p.useState(null),[k,E]=p.useState(null),[I,P]=p.useState(null),[A,D]=p.useState(null),[j,M]=p.useState(null),[z,U]=p.useState(!1),[K,q]=p.useState(null),{generateStoreFromWizard:W,isGenerating:te,checkStoreNameAvailability:O,importedStoreDataForGenerator:V,isImportDataReadyForGenerator:H,clearImportedStoreDataForGenerator:L}=$n();p.useEffect(()=>{t&&H&&V?(console.log("StoreWizard (Embedded) consuming imported data:",V),u(B=>({...B,storeName:V.name||B.storeName,prompt:V.prompt||B.prompt,logoUrlLight:V.logoUrl||B.logoUrlLight,logoUrlDark:V.logoUrl||B.logoUrlDark,products:V.products&&V.products.length>0?{source:"manual",count:V.products.length,items:V.products.map(X=>({name:X.name||"",price:X.price||"",description:X.description||"",images:X.images||[],variants:X.variants||[]}))}:B.products,collections:V.collections&&V.collections.length>0?{source:"manual",count:V.collections.length,items:V.collections.map(X=>({name:X.name||"",description:X.description||"",imageUrl:X.imageUrl||"",product_ids:X.product_ids||[]}))}:B.collections})),V.name&&ee(V.name),L()):n&&(u(B=>({...B,storeName:n.name||B.storeName,prompt:n.prompt||B.prompt,logoUrlLight:n.logoUrl||B.logoUrlLight,logoUrlDark:n.logoUrl||B.logoUrlDark,products:n.products&&n.products.length>0?{source:"manual",count:n.products.length,items:n.products.map(X=>({name:X.name||"",price:X.price||"",description:X.description||"",images:X.images||[],variants:X.variants||[]}))}:B.products,collections:n.collections&&n.collections.length>0?{source:"manual",count:n.collections.length,items:n.collections.map(X=>({name:X.name||"",description:X.description||"",imageUrl:X.imageUrl||"",product_ids:X.product_ids||[]}))}:B.collections})),n.name&&ee(n.name))},[t,H,V,L,n]);const ee=async B=>{if(!(B||c.storeName)){q({status:"error",message:"Please enter a store name to check."});return}U(!0),q(null),v(null);try{const ne=await ST(c.storeName);q(ne?{status:"claimed",message:"Not available"}:{status:"available",message:"Available"})}catch(ne){console.error("Store name availability check failed:",ne),q({status:"error",message:ne.message||"Could not check store name. Please try again."})}finally{U(!1)}};p.useEffect(()=>{if(c.storeName&&w){const B=w.toLowerCase();B.includes("store name")&&(B.includes("empty")||B.includes("required"))&&v(null)}if(c.storeName&&s===2){const B=setTimeout(async()=>{U(!0),q(null),v(null);try{const X=await ST(c.storeName);q(X?{status:"claimed",message:"This store name is already taken."}:{status:"available",message:"Store name is available!"})}catch(X){console.error("Store name availability check failed:",X),q({status:"error",message:X.message||"Could not check store name. Please try again."})}finally{U(!1)}},750);return()=>{clearTimeout(B)}}else!c.storeName&&s===2&&q(null)},[c.storeName,s,w]);const pe=B=>{u(X=>({...X,initialImportMethod:B,productType:B==="photos"?"":X.productType})),B==="productType"&&h([])},xe=B=>new Promise((X,ne)=>{const Y=new FileReader;Y.onload=()=>X(Y.result),Y.onerror=ne,Y.readAsDataURL(B)}),we=async B=>{const X=Array.from(B.target.files);if(X.length===0)return;const ne=10;if(d.length+X.length>ne){v(`You can upload a maximum of ${ne} photos.`);return}v(null);const Y=X.map(async ce=>{try{const Ee=await xe(ce);return{file:ce,previewUrl:URL.createObjectURL(ce),base64:Ee,name:ce.name,type:ce.type}}catch(Ee){return console.error("Error processing file:",ce.name,Ee),null}}),Ne=(await Promise.all(Y)).filter(Boolean);if(h(ce=>{const Ee=[...ce,...Ne];return ce.forEach(Re=>{Re.previewUrl&&Re.previewUrl.startsWith("blob:")}),Ee}),c.initialImportMethod==="photos"&&Ne.length>0){m(!0),v(null);try{const ce=d.concat(Ne).map(Re=>({base64:Re.base64,mimeType:Re.type,name:Re.name})),Ee=await YG(ce);Ee.error?v(Ee.error):(u(Re=>({...Re,productType:Ee.productType||Re.productType,storeName:Ee.storeNameSuggestions&&Ee.storeNameSuggestions.length>0?Ee.storeNameSuggestions[0]:Re.storeName,products:{source:"manual",count:Ee.products.length,items:Ee.products.map(Be=>({name:Be.name||"",price:Be.price||"",description:Be.description||"",images:Be.images||[],variants:[],isFromPhotoAI:!0}))},collections:{source:"manual",count:Ee.collections.length,items:Ee.collections.map(Be=>({name:Be.name||"",description:Be.description||"",imageUrl:"",product_ids:[],isFromPhotoAI:!0}))},prompt:Ee.storePrompt||Re.prompt})),Ee.storeNameSuggestions&&Ee.storeNameSuggestions.length>0&&l(Ee.storeNameSuggestions),Ee.logoDescription&&console.log("AI Logo Description:",Ee.logoDescription))}catch(ce){console.error("Error processing photos with AI:",ce),v(`Failed to process images with AI: ${ce.message}`)}finally{m(!1)}}},Ie=B=>{h(X=>{const ne=X[B];return ne&&ne.previewUrl&&ne.previewUrl.startsWith("blob:")&&URL.revokeObjectURL(ne.previewUrl),X.filter((Y,Ne)=>Ne!==B)})},Fe=B=>{const{name:X,value:ne}=B.target;u(Y=>({...Y,[X]:ne}))},Ve=B=>{u(X=>({...X,productType:B}))},Ge=B=>{u(X=>({...X,products:{...X.products,source:B}}))},fe=B=>{u(X=>({...X,products:{...X.products,count:parseInt(B.target.value)||1}}))},je=(B,X,ne)=>{const Y=[...c.products.items];Y[B][X]=ne,u(Ne=>({...Ne,products:{...Ne.products,items:Y}}))},ie=()=>{u(B=>({...B,products:{...B.products,items:[...B.products.items,{name:"",price:"",description:"",images:[]}]}}))},$e=B=>{const X=c.products.items.filter((ne,Y)=>Y!==B);u(ne=>({...ne,products:{...ne.products,items:X}}))},me=async()=>{var B;if(!c.productType){v("Please select a product type first.");return}x(!0),l([]),v(null);try{const X=((B=Zw.find(Y=>Y.value===c.productType))==null?void 0:B.label)||c.productType,ne=await TI(X);ne.error?(console.error("Failed to suggest store names:",ne.error),v(ne.error),l([])):ne.suggestions&&ne.suggestions.length>0?l(ne.suggestions):(v("No suggestions received, or response was empty."),l([]))}catch(X){console.error("Error in suggestStoreNameHandler:",X),v(`An unexpected error occurred: ${X.message}`),l([])}x(!1)},Ue=B=>{u(X=>({...X,storeName:B})),l([])},et=async()=>{if(!c.storeName){console.warn("Store name is required to generate a logo."),v("Please ensure a store name is set before generating a logo.");return}x(!0),v(null);try{const B=await kg(c.storeName);B&&(B.logoUrlLight||B.logoUrlDark)?(u(X=>({...X,logoUrlLight:B.logoUrlLight||"",logoUrlDark:B.logoUrlDark||""})),console.log("Logos generated and URLs set:",B),B.textResponse&&console.log("Gemini text response for logo generation:",B.textResponse)):(console.error("Failed to generate logos: No image data received for either version."),v("Failed to generate logo. The AI did not return sufficient image data."))}catch(B){console.error("Failed to generate logos:",B),v(`Logo generation failed: ${B.message}`)}x(!1)},ct=async()=>{if(!c.productType||!c.storeName){v("Please provide a product type and store name before generating AI products.");return}x(!0),v(null);let B=[];try{const X=await H1e(c.prompt,c.productType);if(console.log("Prompt Analysis Result:",X),X.error||X.strategy==="error"){v(X.error||"Failed to analyze store prompt for product strategy."),x(!1);return}let ne=null,Y="image/png";const Ne=c.logoUrlLight||c.logoUrlDark;if(Ne&&Ne.startsWith("data:")){const ce=Ne.split(",");if(ce.length===2){ne=ce[1];const Ee=ce[0].match(/:(.*?);/);Ee&&Ee[1]&&(Y=Ee[1])}}if(X.strategy==="standard"){console.log("Strategy: Standard Product Generation");for(let ce=0;ce<c.products.count;ce++){console.log(`Generating AI product ${ce+1} of ${c.products.count}...`);const Ee=await qG(c.productType,c.storeName,ne,Y,B.map(Re=>Re.name),void 0,void 0,void 0,c.prompt);Ee&&Ee.images&&Ee.images.length>0?B.push({name:Ee.title,description:Ee.description,price:Ee.price,images:Ee.images,variants:Ee.variants||[]}):console.warn(`Failed to generate full data for standard product ${ce+1}. Skipping.`)}}else if(X.strategy==="pod_theme_visualization"||X.strategy==="pod_specific_products"){console.log(`Strategy: Print on Demand - ${X.strategy}`);const ce=X.theme&&X.theme!=="General"?`Design for print-on-demand products for a store themed '${X.theme}'. Store name: ${c.storeName}. User prompt: ${c.prompt}`:`Versatile design for print-on-demand products based on store prompt: "${c.prompt}". Store name: ${c.storeName}.`,Ee=6;let Re=[];for(let mt=0;mt<Ee;mt++){const Ht=`${ce} (Design variation ${mt+1} of ${Ee}, ensure it's distinct from previous designs for this store if any were made).`;console.log(`Generating POD design ${mt+1}/${Ee}...`);const tn=await Rg({prompt:Ht});tn&&tn.imageData?Re.push({base64:tn.imageData,mimeType:tn.imageMimeType||"image/png",prompt:Ht}):console.warn(`Failed to generate POD design ${mt+1}.`)}if(Re.length===0){v("Failed to generate any base designs for POD products."),x(!1);return}let Be=[...so],_t=[];for(let mt=0;mt<Math.min(Re.length,Be.length);mt++){const Ht=Math.floor(Math.random()*Be.length);_t.push(Be.splice(Ht,1)[0])}if(_t.length===0){v("No POD mockup products available for visualization."),x(!1);return}for(let mt=0;mt<Math.min(Re.length,_t.length);mt++){const Ht=Re[mt],tn=_t[mt];console.log(`Visualizing design ${mt+1} on ${tn.name}...`);const Rt=await tf(Ht.base64,Ht.mimeType,tn.imageUrl,X.theme||c.prompt,tn.name);if(Rt&&Rt.visualizedImageData&&Rt.productDetails){const sn=`data:${Ht.mimeType};base64,${Ht.base64}`,In=`data:${Rt.visualizedImageMimeType};base64,${Rt.visualizedImageData}`;B.push({name:Rt.productDetails.title,price:parseFloat(Rt.productDetails.price).toFixed(2),description:Rt.productDetails.description,images:[sn,In],isPrintOnDemand:!0,podDetails:{originalDesignImageUrl:sn,designPrompt:Ht.prompt,baseProductName:tn.name,baseProductImageUrl:tn.imageUrl},variants:Rt.productDetails.variants||[]})}else console.warn(`Failed to visualize design ${mt+1} on ${tn.name}. Skipping.`)}}u(ce=>({...ce,products:{...ce.products,items:B}})),B.length===0&&c.products.count>0&&v("AI failed to generate any products with the selected strategy. Please try again or adjust settings.")}catch(X){console.error("Error generating AI products:",X),v(`Failed to generate AI products: ${X.message}`)}x(!1)},Mt=async()=>{if(!c.productType||!c.storeName||c.products.items.length===0){v("Please ensure product type, store name, and at least one product are set before generating AI collections.");return}x(!0),v(null);const B=[],X=c.collections.items.map(ne=>ne.name);try{for(let ne=0;ne<c.collections.count;ne++){console.log(`Generating AI collection ${ne+1} of ${c.collections.count}...`);const Y=await KG(c.productType,c.storeName,c.products.items,X);if(Y&&!Y.error&&Y.name&&Y.description&&Y.product_ids){let Ne=`https://via.placeholder.com/400x200.png?text=${encodeURIComponent(Y.name||"Collection")}`;Y.imageData&&(Ne=`data:image/png;base64,${Y.imageData}`),B.push({name:Y.name,description:Y.description,imageUrl:Ne,product_ids:Y.product_ids}),Y.name&&X.push(Y.name)}else console.warn(`Failed to generate full data for collection ${ne+1}. Skipping.`)}u(ne=>({...ne,collections:{...ne.collections,items:B}})),B.length===0&&c.collections.count>0&&v("AI failed to generate any collections. Please try again or adjust settings.")}catch(ne){console.error("Error generating AI collections:",ne),v(`Failed to generate AI collections: ${ne.message}`)}x(!1)},Sn=async B=>{const X=c.products.items[B];if(!X||!X.name){R("Product name is required to generate an image.");return}C(B),R(null);try{const ne=await h5(X.name,X.description);if(ne&&ne.imageData){const Y=`data:image/png;base64,${ne.imageData}`,Ne=[...c.products.items];Ne[B].images=[Y],u(ce=>({...ce,products:{...ce.products,items:Ne}}))}else throw new Error(ne.textResponse||"Failed to generate product image data.")}catch(ne){console.error(`Error generating image for product ${B}:`,ne),R(ne.message)}finally{C(null)}},en=async B=>{const X=c.products.items[B];if(!X||!X.images||X.images.length===0){P("At least one image must be uploaded or generated first to create more angles.");return}const ne=X.images[0];E(B),P(null);try{const{generateDifferentAnglesFromImage:Y}=await At(()=>Promise.resolve().then(()=>Kae),void 0),Ne=ne.split(",");if(Ne.length!==2)throw new Error("Invalid base image URL format for angle generation.");const ce=Ne[0],Ee=Ne[1],Re=ce.match(/:(.*?);/);if(!Re||!Re[1])throw new Error("Could not determine mime type from base image URL.");const Be=Re[1],_t=await Y(Ee,Be,X.name||"Product"),mt=[...c.products.items],Ht=mt[B].images||[];mt[B].images=[...Ht,..._t.filter(tn=>!Ht.includes(tn))],u(tn=>({...tn,products:{...tn.products,items:mt}}))}catch(Y){console.error(`Error generating more angles for product ${B}:`,Y),P(Y.message||"Failed to generate additional angles.")}finally{E(null)}},rn=async B=>{const X=c.collections.items[B];if(!X||!X.name){M("Collection name is required to generate an image.");return}D(B),M(null),v(null);try{const ne=await f5(X.name,X.description);if(ne&&ne.imageData&&ne.imageMimeType){const Y=`data:${ne.imageMimeType};base64,${ne.imageData}`,Ne=[...c.collections.items];Ne[B].imageUrl=Y,u(ce=>({...ce,collections:{...ce.collections,items:Ne}}))}else throw new Error(ne.textResponse||"Failed to generate collection image data.")}catch(ne){console.error(`Error generating image for collection ${B} ("${X.name}"):`,ne),M(ne.message||"Unknown error during collection image generation.");const Y=[...c.collections.items];Y[B].imageUrl="",u(Ne=>({...Ne,collections:{...Ne.collections,items:Y}}))}finally{D(null)}},kt=()=>i(B=>B+1),xn=()=>i(B=>B-1),re=async()=>{x(!0),v(null);try{const B={name:c.storeName,niche:c.productType,description:c.prompt},X=await p3(B);X.error&&console.warn("Failed to generate hero content:",X.error);const ne=await g3(B);ne.error&&console.warn("Failed to generate store way content:",ne.error);const Y=await II(B);Y.error&&console.warn("Failed to generate store features content:",Y.error);const Ne={...c,content:{...c.content||{},hero:X&&!X.error?X:void 0,storeWay:ne&&!ne.error?ne:void 0,storeFeatures:Y&&!Y.error?Y:void 0}},ce=await W(Ne);if(ce){if(t&&e)e(ce);else if(!t){const Ee=`/${ce.urlSlug||mc(ce.name)}`;r(Ee)}}}catch(B){console.error("Error during final store generation steps or navigation:",B),v(`An error occurred during final store setup: ${B.message}`)}finally{x(!1)}},Se={formData:c,setFormData:u,handleInputChange:Fe,handleProductTypeChange:Ve,handleProductSourceChange:Ge,handleProductCountChange:fe,handleManualProductChange:je,addManualProduct:ie,removeManualProduct:$e,suggestStoreName:me,generateLogo:et,generateAiProducts:ct,generateAiCollections:Mt,handleGenerateManualProductImage:Sn,handleGenerateMoreAngles:en,isProcessing:g,isGeneratingProductImageForIndex:_,productImageGenerationError:T,isGeneratingAnglesForIndex:k,angleGenerationError:I,productTypeOptions:Zw,storeNameSuggestions:o,handleSuggestionClick:Ue,suggestionError:w,handleInitialImportMethodChange:pe,handleProductPhotoUpload:we,uploadedProductPhotos:d,removeUploadedProductPhoto:Ie,isProcessingPhotos:f,handleGenerateCollectionImage:rn,isGeneratingCollectionImageForIndex:A,collectionImageGenerationError:j,isCheckingStoreName:z,storeNameAvailability:K,handleManualStoreNameCheck:ee};return t?a.jsxs("div",{className:"w-full p-2",children:[" ",a.jsx(Ac,{mode:"wait",children:gF(s,Se)}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs($,{variant:"outline",onClick:xn,disabled:s===1||te||f,children:[a.jsx(Go,{className:"mr-2 h-4 w-4"})," Previous"]}),s<6?a.jsxs($,{onClick:kt,disabled:yF(s,c,d)||te||f,children:["Next ",a.jsx(Fu,{className:"ml-2 h-4 w-4"})]}):a.jsxs($,{onClick:re,disabled:g||te||f||!c.prompt,className:"bg-primary hover:bg-primary/90",children:[g||te?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ea,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]}):a.jsxs("div",{className:"w-full max-w-2xl mx-auto",children:[" ",a.jsxs(at,{children:[a.jsx(lt,{className:"text-2xl font-bold",children:"Store Creation Wizard"}),a.jsxs(Kt,{children:["Step ",s," of 6: Let's build your online store together!"]}),a.jsx("div",{className:"w-full bg-green-200 dark:bg-green-800 rounded-full h-2.5 mt-2",children:a.jsx(Ct.div,{className:"bg-green-600 dark:bg-green-500 h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${s/6*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(st,{className:"min-h-[250px] flex items-center",children:a.jsx(Ac,{mode:"wait",children:gF(s,Se)})}),a.jsxs(vd,{className:"flex justify-between",children:[a.jsxs($,{variant:"outline",onClick:xn,disabled:s===1||te||f,children:[a.jsx(Go,{className:"mr-2 h-4 w-4"})," Previous"]}),s<6?a.jsxs($,{onClick:kt,disabled:yF(s,c,d)||te||f,children:["Next ",a.jsx(Fu,{className:"ml-2 h-4 w-4"})]}):a.jsxs($,{onClick:re,disabled:g||te||f||!c.prompt,children:[g||te?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ea,{className:"mr-2 h-4 w-4"}),"Generate Store"]})]})]})},tIe=({isOpen:t,onClose:e,product:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{var d,h,f,m,g,x,w;if(n){const v=(h=(d=n.variants)==null?void 0:d.edges[0])==null?void 0:h.node;i({...n,name:n.title||"",price:((f=v==null?void 0:v.price)==null?void 0:f.amount)||0,currencyCode:((m=v==null?void 0:v.price)==null?void 0:m.currencyCode)||"USD",imageUrl:((w=(x=(g=n.images)==null?void 0:g.edges[0])==null?void 0:x.node)==null?void 0:w.url)||""})}else i(null)},[n]),!t||!s)return null;const o=d=>{const{name:h,value:f}=d.target;i(m=>({...m,[h]:f}))},l=d=>{const{value:h}=d.target;i(f=>({...f,price:parseFloat(h)||0}))},c=d=>{const{value:h}=d.target;i(f=>({...f,imageUrl:h}))},u=()=>{var h,f,m,g;const d={...s,title:s.name,images:{edges:[{node:{url:s.imageUrl,altText:s.name}}]},variants:{...s.variants,edges:[{node:{...((f=(h=s.variants)==null?void 0:h.edges[0])==null?void 0:f.node)||{},price:{amount:s.price,currencyCode:s.currencyCode}}},...((g=(m=s.variants)==null?void 0:m.edges)==null?void 0:g.slice(1))||[]]}};r(d),e()};return a.jsx(zr,{open:t,onOpenChange:e,children:a.jsxs(Dr,{className:"sm:max-w-lg",children:[a.jsxs(Mr,{children:[a.jsxs(Lr,{children:["Edit Product: ",n.title]}),a.jsx(_i,{children:"Make changes to the product details below."})]}),a.jsx(ws,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ke,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(qe,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ke,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(Cn,{id:"description",name:"description",value:s.description,onChange:o,className:"col-span-3",rows:4})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ke,{htmlFor:"price",className:"text-right",children:"Price"}),a.jsx(qe,{id:"price",name:"price",type:"number",value:s.price,onChange:l,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ke,{htmlFor:"imageUrl",className:"text-right",children:"Image URL"}),a.jsx(qe,{id:"imageUrl",name:"imageUrl",value:s.imageUrl,onChange:c,className:"col-span-3"})]})]})}),a.jsxs(Nr,{children:[a.jsx($,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx($,{type:"button",onClick:u,children:"Save Changes"})]})]})})},nIe=({isOpen:t,onClose:e,collection:n,onSave:r})=>{const[s,i]=p.useState(null);if(p.useEffect(()=>{i(n?{...n,name:n.title||""}:null)},[n]),!t||!s)return null;const o=c=>{const{name:u,value:d}=c.target;i(h=>({...h,[u]:d}))},l=()=>{const c={...s,title:s.name};r(c),e()};return a.jsx(zr,{open:t,onOpenChange:e,children:a.jsxs(Dr,{className:"sm:max-w-lg",children:[a.jsxs(Mr,{children:[a.jsxs(Lr,{children:["Edit Collection: ",n.title]}),a.jsx(_i,{children:"Make changes to the collection details below."})]}),a.jsx(ws,{className:"max-h-[60vh] p-1",children:a.jsxs("div",{className:"grid gap-4 py-4 pr-3",children:[a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ke,{htmlFor:"name",className:"text-right",children:"Name"}),a.jsx(qe,{id:"name",name:"name",value:s.name,onChange:o,className:"col-span-3"})]}),a.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[a.jsx(ke,{htmlFor:"description",className:"text-right",children:"Description"}),a.jsx(Cn,{id:"description",name:"description",value:s.description||"",onChange:o,className:"col-span-3",rows:4})]})]})}),a.jsxs(Nr,{children:[a.jsx($,{type:"button",variant:"outline",onClick:e,children:"Cancel"}),a.jsx($,{type:"button",onClick:l,children:"Save Changes"})]})]})})},rIe=()=>{var x,w,v,_,C,T,R,k,E,I,P,A,D,j,M;const{shopifyPreviewMetadata:t,isFetchingShopifyPreviewData:e,shopifyImportError:n,updateShopifyPreviewMetadata:r}=$n(),[s,i]=p.useState(((v=(w=(x=t==null?void 0:t.brand)==null?void 0:x.colors)==null?void 0:w.primary)==null?void 0:v.background)||"#000000"),[o,l]=p.useState(((T=(C=(_=t==null?void 0:t.brand)==null?void 0:_.colors)==null?void 0:C.secondary)==null?void 0:T.background)||"#ffffff");ht.useEffect(()=>{var z,U,K;(z=t==null?void 0:t.brand)!=null&&z.colors&&(i(((U=t.brand.colors.primary)==null?void 0:U.background)||"#000000"),l(((K=t.brand.colors.secondary)==null?void 0:K.background)||"#ffffff"))},[t]);const c=z=>{var K,q,W;const U=z.target.value;i(U),r&&r({...t,brand:{...t.brand,colors:{...(K=t.brand)==null?void 0:K.colors,primary:{...(W=(q=t.brand)==null?void 0:q.colors)==null?void 0:W.primary,background:U}}}})},u=z=>{var K,q,W;const U=z.target.value;l(U),r&&r({...t,brand:{...t.brand,colors:{...(K=t.brand)==null?void 0:K.colors,secondary:{...(W=(q=t.brand)==null?void 0:q.colors)==null?void 0:W.secondary,background:U}}}})};if(e&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Fetching store information..."})]});if(n&&!t)return a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-destructive",children:[a.jsx(Ng,{className:"h-12 w-12 mb-4"}),a.jsx("p",{className:"font-semibold",children:"Error Fetching Store Info"}),a.jsx("p",{className:"text-sm text-center",children:n})]});if(!t)return a.jsx("div",{className:"text-center text-muted-foreground",children:"No store metadata to display."});const{name:d,description:h,primaryDomain:f,brand:m}=t,g=((k=(R=m==null?void 0:m.logo)==null?void 0:R.image)==null?void 0:k.url)||((I=(E=m==null?void 0:m.squareLogo)==null?void 0:E.image)==null?void 0:I.url);return a.jsxs("div",{className:"w-full p-4",children:[a.jsx("h3",{className:"text-xl font-semibold mb-4 text-center",children:"Store Preview"}),a.jsxs(Ke,{className:"mb-4",children:[a.jsx(at,{children:a.jsxs("div",{className:"flex items-center space-x-4",children:[g?a.jsx("img",{src:g,alt:`${d} logo`,className:"h-16 w-16 object-contain rounded border"}):a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(RE,{size:32})}),a.jsxs("div",{children:[a.jsx(lt,{children:d||"N/A"}),(f==null?void 0:f.host)&&a.jsx(Kt,{children:f.host})]})]})}),a.jsxs(st,{children:[a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Slogan:"})," ",(m==null?void 0:m.slogan)||"N/A"]}),a.jsxs("p",{className:"text-sm text-muted-foreground mb-1",children:[a.jsx("strong",{children:"Description:"})," ",h||(m==null?void 0:m.shortDescription)||"N/A"]}),((P=m==null?void 0:m.coverImage)==null?void 0:P.url)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Cover Image:"}),a.jsx("img",{src:m.coverImage.url,alt:"Store cover",className:"rounded max-h-40 w-auto mx-auto border"})]})]})]}),(m==null?void 0:m.colors)&&a.jsxs(Ke,{className:"mt-4",children:[a.jsx(at,{children:a.jsx(lt,{className:"text-lg",children:"Brand Colors"})}),a.jsxs(st,{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"primaryColorPicker",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Primary Color"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"color",id:"primaryColorPicker",value:s,onChange:c,className:"h-10 w-10 rounded border cursor-pointer"}),a.jsx("div",{className:"w-12 h-10 rounded border",style:{backgroundColor:s},title:`Primary Background: ${s}`}),a.jsx("span",{className:"text-sm",children:s})]}),((D=(A=m==null?void 0:m.colors)==null?void 0:A.primary)==null?void 0:D.foreground)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Text/Icon Color (from Shopify):"}),a.jsx("div",{className:"w-full h-6 rounded border mt-1",style:{backgroundColor:m.colors.primary.foreground},title:`Primary Foreground: ${m.colors.primary.foreground}`})]})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"secondaryColorPicker",className:"block text-sm font-medium text-muted-foreground mb-1",children:"Secondary Color"}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("input",{type:"color",id:"secondaryColorPicker",value:o,onChange:u,className:"h-10 w-10 rounded border cursor-pointer"}),a.jsx("div",{className:"w-12 h-10 rounded border",style:{backgroundColor:o},title:`Secondary Background: ${o}`}),a.jsx("span",{className:"text-sm",children:o})]}),((M=(j=m==null?void 0:m.colors)==null?void 0:j.secondary)==null?void 0:M.foreground)&&a.jsxs("div",{className:"mt-2",children:[a.jsx("p",{className:"text-xs text-muted-foreground",children:"Text/Icon Color (from Shopify):"}),a.jsx("div",{className:"w-full h-6 rounded border mt-1",style:{backgroundColor:m.colors.secondary.foreground},title:`Secondary Foreground: ${m.colors.secondary.foreground}`})]})]})]})]})]})},sIe=()=>{var U,K,q,W,te,O;const{shopifyPreviewProducts:t,shopifyPreviewCollections:e,fetchShopifyWizardProducts:n,fetchShopifyWizardCollections:r,isFetchingShopifyPreviewData:s,shopifyImportError:i,shopifyPreviewMetadata:o,generatedLogoImage:l,isGeneratingLogo:c,logoGenerationError:u,generateShopifyStoreLogo:d,updateShopifyPreviewProduct:h,updateShopifyPreviewCollection:f}=$n(),[m,g]=p.useState(!1),[x,w]=p.useState(null),[v,_]=p.useState(!1),[C,T]=p.useState(null),R=V=>{w(V),g(!0)},k=()=>{g(!1),w(null)},E=V=>{h(V)},I=V=>{T(V),_(!0)},P=()=>{_(!1),T(null)},A=V=>{f(V)},D=()=>{t.pageInfo.hasNextPage&&n(10,t.pageInfo.endCursor)},j=()=>{e.pageInfo.hasNextPage&&r(10,e.pageInfo.endCursor)},M=(o==null?void 0:o.name)||"Your Store",z=((q=(K=(U=o==null?void 0:o.brand)==null?void 0:U.logo)==null?void 0:K.image)==null?void 0:q.url)||((O=(te=(W=o==null?void 0:o.brand)==null?void 0:W.squareLogo)==null?void 0:te.image)==null?void 0:O.url);return a.jsxs("div",{className:"w-full p-4 space-y-6",children:[a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Generate Store Logo"}),a.jsxs(Kt,{children:['Optionally, generate a new logo for "',M,'" using AI. The generated logo will be used for your new store if you proceed.']})]}),a.jsxs(st,{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 items-center",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Current Shopify Logo (if any):"}),z?a.jsx("img",{src:z,alt:`${M} current logo`,className:"h-48 w-auto object-contain"}):a.jsx("p",{className:"text-sm text-muted-foreground",children:"No logo found in Shopify data."})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Generated Logo Preview:"}),c&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary"})," "]}),!c&&l&&a.jsx("div",{className:"h-48 w-auto flex items-center justify-center",children:a.jsx("img",{src:l,alt:`${M} AI generated logo`,className:"h-full w-auto object-contain"})}),!c&&!l&&a.jsxs("div",{className:"h-48 w-full flex items-center justify-center text-muted-foreground",children:[a.jsx(RE,{className:"h-12 w-12 mr-2"})," ",a.jsx("span",{children:"Logo will appear here"})]})]})]}),a.jsxs($,{onClick:d,disabled:c||!(o!=null&&o.name),className:"w-full md:w-auto",children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Generate New Logo with AI"]}),u&&a.jsxs("p",{className:"text-sm text-destructive text-center mt-2",children:[a.jsx(Ng,{className:"inline h-4 w-4 mr-1"}),u]}),!(o!=null&&o.name)&&a.jsx("p",{className:"text-sm text-amber-600 text-center mt-2",children:"Store name from Shopify is required to generate a logo."})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Products (",t.edges.length," loaded)"]}),i&&i.includes("products")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(ws,{className:"h-60 border rounded p-2",children:[t.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No products loaded yet or none found."}),t.edges.map(({node:V})=>{var H,L,ee,pe,xe,we,Ie,Fe,Ve;return a.jsx("div",{className:"p-3 border-b last:border-b-0",children:a.jsxs("div",{className:"flex items-start space-x-3",children:[((ee=(L=(H=V.images)==null?void 0:H.edges[0])==null?void 0:L.node)==null?void 0:ee.url)&&a.jsx("img",{src:V.images.edges[0].node.url,alt:V.title,className:"h-16 w-16 rounded object-cover border"}),!((we=(xe=(pe=V.images)==null?void 0:pe.edges[0])==null?void 0:xe.node)!=null&&we.url)&&a.jsx("div",{className:"h-16 w-16 bg-muted rounded border flex items-center justify-center text-muted-foreground",children:a.jsx(RE,{size:24})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-semibold text-sm",children:V.title}),((Ve=(Fe=(Ie=V.variants)==null?void 0:Ie.edges[0])==null?void 0:Fe.node)==null?void 0:Ve.price)&&a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: ",V.variants.edges[0].node.price.amount," ",V.variants.edges[0].node.price.currencyCode]}),V.description&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1 truncate",title:V.description,children:["Desc: ",V.description.substring(0,50),V.description.length>50?"...":""]}),V.tags&&V.tags.length>0&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Tags: ",V.tags.join(", ")]})]}),a.jsx($,{variant:"ghost",size:"sm",onClick:()=>R(V),className:"ml-auto",children:a.jsx(nw,{className:"h-4 w-4"})})]})},V.id)}),s&&t.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(ft,{className:"h-5 w-5 animate-spin"})})]}),t.pageInfo.hasNextPage&&a.jsx($,{onClick:D,disabled:s,className:"mt-2 w-full",children:s?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Products"}),!t.pageInfo.hasNextPage&&t.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All products loaded."})]}),a.jsxs("div",{children:[a.jsxs("h3",{className:"text-lg font-semibold mb-2",children:["Collections (",e.edges.length," loaded)"]}),i&&i.includes("collections")&&a.jsx("p",{className:"text-destructive text-sm mb-2",children:i}),a.jsxs(ws,{className:"h-60 border rounded p-2",children:[e.edges.length===0&&!s&&a.jsx("p",{className:"text-muted-foreground text-sm p-2",children:"No collections loaded yet or none found."}),e.edges.map(({node:V})=>a.jsxs("div",{className:"p-2 border-b text-sm flex justify-between items-center",children:[a.jsx("span",{children:V.title}),a.jsx($,{variant:"ghost",size:"sm",onClick:()=>I(V),children:a.jsx(nw,{className:"h-4 w-4"})})]},V.id)),s&&e.pageInfo.hasNextPage&&a.jsx("div",{className:"flex justify-center py-2",children:a.jsx(ft,{className:"h-5 w-5 animate-spin"})})]}),e.pageInfo.hasNextPage&&a.jsx($,{onClick:j,disabled:s,className:"mt-2 w-full",children:s?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):"Load More Collections"}),!e.pageInfo.hasNextPage&&e.edges.length>0&&a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:"All collections loaded."})]})]}),x&&a.jsx(tIe,{isOpen:m,onClose:k,product:x,onSave:E}),C&&a.jsx(nIe,{isOpen:v,onClose:P,collection:C,onSave:A})]})},iIe=()=>{var r,s;const{bigCommercePreviewSettings:t,isFetchingBigCommercePreviewData:e,bigCommerceImportError:n}=$n();return e&&!t?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching store settings..."})]}):n&&!t?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error: ",n]}):t?a.jsxs(Ke,{className:"w-full",children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Store Settings Preview (BigCommerce)"}),a.jsx(Kt,{children:"Review your BigCommerce store's basic information."})]}),a.jsxs(st,{className:"space-y-2",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Store Name:"})," ",t.storeName||"N/A"]}),((s=(r=t.logo)==null?void 0:r.image)==null?void 0:s.url)&&a.jsxs("div",{children:[a.jsx("strong",{children:"Logo:"}),a.jsx("img",{src:t.logo.image.url,alt:t.logo.image.altText||"Store Logo",className:"mt-2 max-w-xs max-h-24 object-contain border rounded"})]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Store Hash:"})," ",t.storeHash||"N/A"]}),a.jsxs("p",{children:[a.jsx("strong",{children:"Status:"})," ",t.status||"N/A"]})]})]}):a.jsx("div",{className:"text-center p-4",children:"Connect to BigCommerce to see store settings, or settings are being fetched."})},oIe=()=>{const{bigCommercePreviewProducts:t,fetchBigCommerceWizardProducts:e,isFetchingBigCommercePreviewData:n,bigCommerceImportError:r}=$n(),s=(t==null?void 0:t.items)||[];return n&&s.length===0?a.jsxs("div",{className:"flex items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin"})," ",a.jsx("span",{className:"ml-2",children:"Fetching products..."})]}):r&&s.length===0?a.jsxs("div",{className:"text-center p-4 text-red-600",children:["Error fetching products: ",r]}):s.length===0?a.jsxs("div",{className:"text-center p-4",children:[a.jsx("p",{className:"mb-4",children:"No products loaded yet for BigCommerce."}),a.jsxs($,{onClick:()=>e(10),disabled:n,children:[n?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,"Load Products Preview"]})]}):a.jsxs(Ke,{className:"w-full",children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Products Preview (BigCommerce)"}),a.jsx(Kt,{children:"A sample of products from your BigCommerce store."})]}),a.jsxs(st,{children:[a.jsx("ul",{className:"space-y-2 max-h-96 overflow-y-auto",children:s.slice(0,10).map(i=>{var o,l,c,u,d;return a.jsxs("li",{className:"p-2 border rounded text-sm flex justify-between items-center",children:[a.jsxs("div",{children:[i.name," - ",(l=(o=i.prices)==null?void 0:o.price)==null?void 0:l.value," ",(u=(c=i.prices)==null?void 0:c.price)==null?void 0:u.currencyCode]}),((d=i.defaultImage)==null?void 0:d.url)&&a.jsx("img",{src:i.defaultImage.url,alt:i.defaultImage.altText||i.name,className:"w-12 h-12 object-cover rounded ml-2"})]},i.entityId)})}),s.length>10&&a.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Showing 10 of ",s.length," products fetched for preview."]})]})]})},aIe=({isOpen:t,onClose:e,initialImportSource:n="shopify"})=>{const r=wi(),[s,i]=p.useState(n),{shopifyWizardStep:o,setShopifyWizardStep:l,resetShopifyWizardState:c,shopifyPreviewMetadata:u,shopifyPreviewProducts:d,shopifyPreviewCollections:h,isFetchingShopifyPreviewData:f,shopifyImportError:m,fetchShopifyWizardProducts:g,fetchShopifyWizardCollections:x,finalizeShopifyImportFromWizard:w,shopifyWizardShouldShowGenerator:v,setShopifyWizardShouldShowGenerator:_,bigCommerceWizardStep:C,setBigCommerceWizardStep:T,resetBigCommerceWizardState:R,bigCommercePreviewSettings:k,bigCommercePreviewProducts:E,isFetchingBigCommercePreviewData:I,bigCommerceImportError:P,fetchBigCommerceWizardProducts:A,finalizeBigCommerceImportFromWizard:D,isGenerating:j,generateStoreFromWizard:M}=$n(),z={shopify:{wizardStep:o,setWizardStep:l,resetWizardState:c,previewMetadata:u,previewProducts:d,previewCollections:h,isFetchingPreviewData:f,importError:m,fetchWizardProducts:g,fetchWizardCollections:x,finalizeImportFromWizard:w,ConnectFormComponent:$1e,MetadataPreviewComponent:rIe,ItemsPreviewComponent:sIe,wizardShouldShowGenerator:v,setWizardShouldShowGenerator:_,totalSteps:5},bigcommerce:{wizardStep:C,setWizardStep:T,resetWizardState:R,previewMetadata:k,previewProducts:E,isFetchingPreviewData:I,importError:P,fetchWizardProducts:A,finalizeImportFromWizard:D,ConnectFormComponent:V1e,MetadataPreviewComponent:iIe,ItemsPreviewComponent:oIe,totalSteps:4}},U=z[s],{wizardStep:K,setWizardStep:q,resetWizardState:W,previewMetadata:te,previewProducts:O,previewCollections:V,isFetchingPreviewData:H,importError:L,fetchWizardProducts:ee,fetchWizardCollections:pe,finalizeImportFromWizard:xe,ConnectFormComponent:we,MetadataPreviewComponent:Ie,ItemsPreviewComponent:Fe,totalSteps:Ve,wizardShouldShowGenerator:Ge,setWizardShouldShowGenerator:fe}=U;if(p.useEffect(()=>{i(n),n==="shopify"&&z.bigcommerce.resetWizardState&&z.bigcommerce.resetWizardState(),n==="bigcommerce"&&z.shopify.resetWizardState&&z.shopify.resetWizardState()},[n,z.bigcommerce,z.shopify]),p.useEffect(()=>{t&&K===0&&q(1),!t&&K!==0&&W()},[t,K,q,W]),!t||K===0)return null;const je=async()=>{K<Ve&&(s==="shopify"?K===2?((!O||O.edges.length===0)&&await ee(10),(!V||V.edges.length===0)&&await pe(10),q(3)):K===3&&await xe():s==="bigcommerce"&&(K===1||(K===2?((!O||O.items.length===0)&&await ee(10),q(3)):K===3&&await me())))},ie=()=>{K>1&&q(K-1)},$e=()=>{W(),fe&&fe(!1),e&&e()},me=async()=>{await xe()&&e&&e()},Ue=()=>{switch(K){case 1:return a.jsx(we,{open:K===1,onOpenChange:ct=>{ct||$e()},onSuccessfulConnect:ct=>{s==="shopify"&&startShopifyImportWizard(ct.domain,ct.token)}});case 2:return a.jsx(Ie,{});case 3:return a.jsx(Fe,{});case 4:return s==="shopify"&&Ge?a.jsx(LH,{isEmbedded:!0,onGenerationComplete:ct=>{if(ct&&(ct.urlSlug||ct.name)){const Mt=`/${ct.urlSlug||mc(ct.name)}`;r(Mt)}e&&e(),fe&&fe(!1)}}):a.jsx("div",{children:"Loading generator..."});default:return K===Ve&&j?a.jsxs("div",{className:"flex flex-col items-center justify-center p-8",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin mb-4"})," ",a.jsx("p",{children:"Processing..."})]}):a.jsxs("div",{children:["Invalid Wizard Step or processing... (",K,")"]})}};if(K===1&&s==="shopify")return Ue();const et=s==="shopify"?"Import from Shopify":s==="bigcommerce"?"Import from BigCommerce":"Import Store Data";return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs(Ke,{className:"w-full max-w-2xl mx-auto shadow-xl",children:[a.jsxs(at,{children:[a.jsx(lt,{className:"text-2xl font-bold",children:K===1&&s==="bigcommerce"?"Connect to BigCommerce":et}),a.jsx(Kt,{children:K===1&&s==="bigcommerce"?"Enter your store domain and API token.":K===4&&s==="shopify"?"Configure and generate your new store.":`Step ${K} of ${Ve-1}`}),a.jsx("div",{className:"w-full bg-muted rounded-full h-2.5 mt-2",children:a.jsx(Ct.div,{className:"bg-primary h-2.5 rounded-full",initial:{width:"0%"},animate:{width:`${K/Ve*100}%`},transition:{duration:.5,ease:"easeInOut"}})})]}),a.jsx(st,{className:"min-h-[250px] max-h-[60vh] overflow-y-auto flex items-center justify-center",children:Ue()}),a.jsxs(vd,{className:"flex justify-between",children:[K>1&&K!==4&&a.jsxs($,{variant:"outline",onClick:$e,disabled:j||H,children:[a.jsx(ow,{className:"mr-2 h-4 w-4"})," Cancel"]}),K===4&&s==="shopify"&&a.jsxs($,{variant:"outline",onClick:$e,disabled:j||H,children:[a.jsx(ow,{className:"mr-2 h-4 w-4"})," Cancel Import"]}),a.jsxs("div",{children:[K>1&&K<Ve-1&&a.jsxs($,{variant:"outline",onClick:ie,disabled:j||H,className:"mr-2",children:[a.jsx(Go,{className:"mr-2 h-4 w-4"})," Previous"]}),K===1&&s==="bigcommerce"&&a.jsxs($,{onClick:je,disabled:j||H,children:["Next ",a.jsx(Fu,{className:"ml-2 h-4 w-4"})]}),K===2&&a.jsxs($,{onClick:je,disabled:j||H,children:["Next ",a.jsx(Fu,{className:"ml-2 h-4 w-4"})]}),K===3&&a.jsxs($,{onClick:je,disabled:j||H,children:[j?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Fu,{className:"ml-2 h-4 w-4"}),"Configure Store"]}),K===Ve&&j&&a.jsxs($,{disabled:!0,children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]})]})]})]})})},lIe=({onSelectSource:t,onClose:e})=>a.jsxs(Ke,{className:"w-full max-w-md mx-auto relative",children:[" ",a.jsx($,{variant:"ghost",size:"icon",className:"absolute top-2 right-2 text-muted-foreground hover:text-foreground",onClick:e,children:a.jsx(Ji,{className:"h-5 w-5"})}),a.jsxs(at,{children:[a.jsx(lt,{children:"Import Store Data"}),a.jsxs(Kt,{className:"text-slate-500 dark:text-slate-400",children:[" ","Select your e-commerce platform to begin importing your store and product data."]})]}),a.jsx(st,{children:a.jsxs(Si,{defaultValue:"shopify",className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-2",children:[a.jsx(jt,{value:"shopify",children:"Shopify"}),a.jsx(jt,{value:"bigcommerce",children:"BigCommerce"})]}),a.jsxs(Dt,{value:"shopify",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your Shopify store to import your shop details, products, and collections."]}),a.jsx($,{className:"w-full",onClick:()=>t("shopify"),children:"Connect Shopify"})]}),a.jsxs(Dt,{value:"bigcommerce",className:"mt-4",children:[a.jsxs("p",{className:"text-sm text-slate-500 dark:text-slate-400 mb-4",children:[" ","Connect to your BigCommerce store to import your store settings and product catalog."]}),a.jsx($,{className:"w-full",onClick:()=>t("bigcommerce"),children:"Connect BigCommerce"})]})]})}),a.jsx(vd,{children:a.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:[" ","You will be guided through a few steps to connect and confirm the data to be imported."]})})]}),cIe=({onClose:t})=>a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-8 max-w-sm w-full text-center",children:[a.jsx("button",{onClick:t,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-800 dark:hover:text-gray-200",children:a.jsx(Ji,{size:24})}),a.jsx("h2",{className:"text-2xl font-bold mb-4",children:"Create Unlimited Stores"}),a.jsx("p",{className:"text-gray-600 dark:text-gray-300 mb-6",children:"Sign up or log in to create more stores and unlock all features."}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(ir,{to:"/auth",children:a.jsx($,{size:"lg",className:"w-full",children:"Sign Up"})}),a.jsx(ir,{to:"/auth",children:a.jsx($,{variant:"outline",size:"lg",className:"w-full",children:"Log In"})})]})]})}),uIe=()=>{var v;const t=wl(),[e,n]=p.useState(!1),[r,s]=p.useState(!1),[i,o]=p.useState(null),[l,c]=p.useState("ai-prompt"),[u,d]=p.useState(!1),{isAuthModalOpen:h,closeAuthModal:f}=$n(),m=()=>{n(!0)},g=()=>{n(!1)},x=_=>{o(_),n(!1),s(!0)},w=()=>{s(!1),o(null)};return p.useEffect(()=>{let _,C;return _=setInterval(()=>{d(!0),C=setTimeout(()=>{d(!1)},2500)},5e3),()=>{clearInterval(_),clearTimeout(C)}},[]),a.jsxs("div",{className:"min-h-screen flex flex-col bg-[#ededed] dark:bg-[#0a0a0a]",children:[a.jsx(ek,{}),a.jsxs(Ct.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"flex-1 container mx-auto px-4 py-8",children:[a.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-10",children:[a.jsx("h1",{className:`text-4xl md:text-5xl font-bold mb-4 bg-clip-text text-transparent bg-gradient-to-r from-gray-600 to-gray-200 dark:from-gray-500 dark:to-gray-300 ${u?"animate-shimmer bg-200%":"bg-auto"}`,children:"Start Fresh"}),a.jsxs("p",{className:"text-lg font-inter text-muted-foreground max-w-3xl mx-auto",children:["You can create a store 3 ways: ",a.jsx("br",{})," Prompt, Steps or Import."]})]}),a.jsxs(Si,{value:l,onValueChange:c,className:"w-full max-w-3xl mx-auto mb-12",children:[a.jsxs(ti,{className:"grid w-full grid-cols-2 md:grid-cols-3 mb-6",children:[a.jsxs(jt,{value:"ai-prompt",children:[a.jsx("span",{className:"hidden sm:inline",children:"AI Prompt"}),a.jsx("span",{className:"sm:hidden",children:"AI Prompt"})]}),a.jsxs(jt,{value:"wizard",children:[a.jsx("span",{className:"hidden sm:inline",children:"Step-by-Step"}),a.jsx("span",{className:"sm:hidden",children:"Steps"})]}),a.jsx(jt,{value:"store-import",className:"hidden md:inline-flex",onClick:m,children:"Import Store"})]}),a.jsx(Dt,{value:"ai-prompt",children:a.jsx(d1e,{generatedImage:(v=t.state)==null?void 0:v.generatedImage})}),a.jsx(Dt,{value:"wizard",children:a.jsx(LH,{})}),a.jsxs(Dt,{value:"store-import",className:"text-center py-8",children:[" ",a.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-4",children:"Import data from Shopify or BigCommerce."})," ",a.jsxs($,{onClick:m,variant:"default",size:"lg",children:[a.jsx(P2,{className:"mr-2 h-5 w-5"}),"Select Import Source"]})]})]}),a.jsxs("div",{className:"mb-8 flex justify-center md:hidden",children:[" ",a.jsxs($,{onClick:m,variant:"outline",size:"lg",className:"w-full max-w-xs",children:[a.jsx(P2,{className:"mr-2 h-5 w-5"}),"Import Store Data"]})]}),a.jsx(O1e,{})]}),a.jsx("footer",{className:"mt-auto py-6 text-center text-sm text-muted-foreground",children:a.jsxs("p",{children:["© ",new Date().getFullYear()," FreshFront. All rights reserved."]})}),e&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsx(lIe,{onSelectSource:x,onClose:g})}),i&&a.jsx(aIe,{isOpen:r,onClose:w,initialImportSource:i}),h&&a.jsx(cIe,{onClose:f})]})};var h_="Popover",[FH,r2e]=bi(h_,[a_]),hy=a_(),[dIe,Qc]=FH(h_),OH=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!1}=t,l=hy(e),c=p.useRef(null),[u,d]=p.useState(!1),[h,f]=Vc({prop:r,defaultProp:s??!1,onChange:i,caller:h_});return a.jsx(uW,{...l,children:a.jsx(dIe,{scope:e,contentId:lc(),triggerRef:c,open:h,onOpenChange:f,onOpenToggle:p.useCallback(()=>f(m=>!m),[f]),hasCustomAnchor:u,onCustomAnchorAdd:p.useCallback(()=>d(!0),[]),onCustomAnchorRemove:p.useCallback(()=>d(!1),[]),modal:o,children:n})})};OH.displayName=h_;var $H="PopoverAnchor",hIe=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Qc($H,n),i=hy(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:l}=s;return p.useEffect(()=>(o(),()=>l()),[o,l]),a.jsx(HA,{...i,...r,ref:e})});hIe.displayName=$H;var VH="PopoverTrigger",UH=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Qc(VH,n),i=hy(n),o=mn(e,s.triggerRef),l=a.jsx(Wt.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":HH(s.open),...r,ref:o,onClick:gt(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?l:a.jsx(HA,{asChild:!0,...i,children:l})});UH.displayName=VH;var ik="PopoverPortal",[fIe,mIe]=FH(ik,{forceMount:void 0}),BH=t=>{const{__scopePopover:e,forceMount:n,children:r,container:s}=t,i=Qc(ik,e);return a.jsx(fIe,{scope:e,forceMount:n,children:a.jsx(_s,{present:n||i.open,children:a.jsx(Tg,{asChild:!0,container:s,children:r})})})};BH.displayName=ik;var Ef="PopoverContent",zH=p.forwardRef((t,e)=>{const n=mIe(Ef,t.__scopePopover),{forceMount:r=n.forceMount,...s}=t,i=Qc(Ef,t.__scopePopover);return a.jsx(_s,{present:r||i.open,children:i.modal?a.jsx(gIe,{...s,ref:e}):a.jsx(yIe,{...s,ref:e})})});zH.displayName=Ef;var pIe=Yu("PopoverContent.RemoveScroll"),gIe=p.forwardRef((t,e)=>{const n=Qc(Ef,t.__scopePopover),r=p.useRef(null),s=mn(e,r),i=p.useRef(!1);return p.useEffect(()=>{const o=r.current;if(o)return B0(o)},[]),a.jsx(zI,{as:pIe,allowPinchZoom:!0,children:a.jsx(GH,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:gt(t.onCloseAutoFocus,o=>{var l;o.preventDefault(),i.current||(l=n.triggerRef.current)==null||l.focus()}),onPointerDownOutside:gt(t.onPointerDownOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;i.current=u},{checkForDefaultPrevented:!1}),onFocusOutside:gt(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),yIe=p.forwardRef((t,e)=>{const n=Qc(Ef,t.__scopePopover),r=p.useRef(!1),s=p.useRef(!1);return a.jsx(GH,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,l;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(l=n.triggerRef.current)==null||l.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var c,u;(c=t.onInteractOutside)==null||c.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((u=n.triggerRef.current)==null?void 0:u.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),GH=p.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onInteractOutside:d,...h}=t,f=Qc(Ef,n),m=hy(n);return UI(),a.jsx(V0,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:a.jsx(Eg,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:d,onEscapeKeyDown:l,onPointerDownOutside:c,onFocusOutside:u,onDismiss:()=>f.onOpenChange(!1),children:a.jsx(dW,{"data-state":HH(f.open),role:"dialog",id:f.contentId,...m,...h,ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),WH="PopoverClose",xIe=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Qc(WH,n);return a.jsx(Wt.button,{type:"button",...r,ref:e,onClick:gt(t.onClick,()=>s.onOpenChange(!1))})});xIe.displayName=WH;var vIe="PopoverArrow",wIe=p.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=hy(n);return a.jsx(hW,{...s,...r,ref:e})});wIe.displayName=vIe;function HH(t){return t?"open":"closed"}var bIe=OH,_Ie=UH,SIe=BH,qH=zH;const xF=bIe,vF=_Ie,h1=p.forwardRef(({className:t,align:e="center",sideOffset:n=4,...r},s)=>a.jsx(SIe,{children:a.jsx(qH,{ref:s,align:e,sideOffset:n,className:bt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));h1.displayName=qH.displayName;const CIe=({store:t,onEdit:e,currentTemplate:n,onTemplateChange:r,availableTemplates:s=[]})=>{const i=wi(),{toast:o}=Ss(),{viewMode:l,setViewMode:c,currentStore:u,updateStore:d,updateStoreTemplateVersion:h,user:f}=$n(),m=async()=>{if(!f||!f.email){o({title:"Authentication Error",description:"You must be logged in with a valid email to onboard with Stripe.",variant:"destructive"});return}o({title:"Redirecting to Stripe...",description:"Please wait while we connect you to Stripe for onboarding."});try{const R=Ow(),E=await Xa(R,"stripeCreateConnectAccount")({email:f.email}),{accountLinkUrl:I}=E.data;if(I)window.location.href=I;else throw new Error("Account link URL not returned from function.")}catch(R){console.error("Error creating Stripe Connect account link:",R),o({title:"Error",description:"Could not initiate Stripe onboarding. Please try again.",variant:"destructive"})}},g=async()=>{if(!(!u||!u.stripe_account_id)){o({title:"Generating Dashboard Link...",description:"Please wait while we connect you to Stripe."});try{const R=Ow(),E=await Xa(R,"stripeCreateLoginLink")({stripeAccountId:u.stripe_account_id}),{loginLinkUrl:I}=E.data;if(I)window.open(I,"_blank");else throw new Error("Login link URL not returned from function.")}catch(R){console.error("Error creating Stripe login link:",R),o({title:"Error",description:"Could not create a link to the Stripe dashboard. Please try again.",variant:"destructive"})}}},x=()=>{t&&t.name?(navigator.clipboard.writeText(`${window.location.origin}/${t.name}`),o({title:"Link Copied",description:"Store link has been copied to clipboard."})):o({title:"Error",description:"Could not copy link: Store name not available.",variant:"destructive"})},w=()=>{const R=l==="edit"?"published":"edit";c(R),o({title:`Switched to ${R==="published"?"Consumer View":"Admin View"}`,description:`Store is now in ${R==="published"?"consumer":"admin editing"} mode.`})},v=R=>{r&&r(R)},_=async R=>{let k=R;if(R==="classic"&&(k="v1"),t&&t.id&&k&&k!==t.template_version)try{await h(t.id,k),o({title:"Template Saved",description:`Store template successfully changed to ${R}.`,className:"bg-green-500 text-white"})}catch(E){console.error("Failed to save template:",E),o({title:"Save Failed",description:"Could not save the template change. Please try again.",variant:"destructive"})}else k===t.template_version&&o({title:"No Change",description:`Store is already using the ${R} template.`})},C=()=>{l!=="edit"&&c("edit"),e()},T=async()=>{if(t&&t.id)try{await d(t.id,{published_at:new Date().toISOString(),status:"published"}),o({title:"Store Published!",description:`${t.name} is now live.`,className:"bg-green-500 text-white"})}catch(R){console.error("Failed to publish store:",R),o({title:"Publish Failed",description:"Could not publish the store. Please try again.",variant:"destructive"})}};return l==="published"?a.jsx("button",{onClick:()=>c("edit"),className:"fixed bottom-4 left-4 p-2 z-50 rounded-full hover:bg-gray-200 dark:hover:bg-gray-700 transition-colors",title:"Open Admin Controls","aria-label":"Open Admin Controls",children:a.jsx(kh,{className:"h-6 w-6 text-gray-500 opacity-50 hover:opacity-75 dark:text-gray-400"})}):a.jsx(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},className:"fixed bottom-0 left-0 right-0 bg-background/80 backdrop-blur-md border-t z-50 py-3",children:a.jsxs("div",{className:"container mx-auto px-4 flex items-center justify-between overflow-x-auto",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx($,{variant:"outline",size:"icon",className:"aspect-square",onClick:()=>i("/"),title:"Back",children:a.jsx(Go,{className:"h-4 w-4"})}),a.jsxs("div",{className:"hidden sm:flex items-center gap-1",children:[a.jsxs(xc,{value:n||"",onValueChange:v,children:[a.jsxs(tl,{className:"w-[180px] h-9 text-sm",children:[a.jsx(tw,{className:"mr-2 h-4 w-4"}),a.jsx(vc,{placeholder:"Switch Template"})]}),a.jsx(nl,{children:s.map(R=>a.jsx(nr,{value:R,children:R.charAt(0).toUpperCase()+R.slice(1)},R))})]}),n&&n!==(t==null?void 0:t.template_version)&&a.jsx($,{variant:"outline",size:"icon",className:"h-9 w-9 border-green-500 text-green-500 hover:bg-green-50 hover:text-green-600",onClick:()=>_(n),title:`Save ${n.charAt(0).toUpperCase()+n.slice(1)} Template`,children:a.jsx(Pg,{className:"h-4 w-4"})})]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"sm:hidden",children:a.jsxs(xF,{children:[a.jsx(vF,{asChild:!0,children:a.jsx($,{variant:"outline",size:"icon",children:a.jsx(tw,{className:"h-4 w-4"})})}),a.jsx(h1,{className:"w-48",children:a.jsx("div",{className:"grid gap-2",children:s.map(R=>a.jsx($,{variant:n===R?"solid":"ghost",onClick:()=>v(R),className:"w-full justify-start",children:R.charAt(0).toUpperCase()+R.slice(1)},R))})})]})}),a.jsx($,{variant:"outline",size:"icon",onClick:x,title:"Copy Link",children:a.jsx(FI,{className:"h-4 w-4"})}),u&&u.stripe_account_id?a.jsxs($,{variant:"outline",size:"sm",onClick:g,children:[a.jsx("span",{className:"hidden sm:inline",children:"Dashboard"}),a.jsx(ef,{className:"sm:ml-2 h-4 w-4"})]}):a.jsxs(xF,{children:[a.jsx(vF,{asChild:!0,children:a.jsxs($,{variant:"outline",size:"sm",children:[a.jsx("span",{className:"hidden sm:inline",children:"Dashboard"}),a.jsx(ef,{className:"sm:ml-2 h-4 w-4"})]})}),a.jsx(h1,{className:"w-80",children:a.jsxs("div",{className:"grid gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("h4",{className:"font-medium leading-none",children:"No active business account"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Connect with Stripe to manage your payments and payouts."})]}),a.jsxs($,{onClick:m,children:["Onboard with ",a.jsx("img",{src:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Stripelogo.PNG?alt=media&token=7b989f42-b2c9-4a3c-a7e1-9ed280b6a9ea",alt:"Stripe",className:"inline-block h-4 ml-2"})]})]})})]}),a.jsx($,{asChild:!0,size:"sm",variant:"outline",disabled:!u||!u.name,children:a.jsxs(ir,{to:u&&u.name?`/${u.name}/content-creation`:"#",state:{storeData:u},children:[a.jsx(Sr,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Create"})]})}),a.jsxs($,{size:"sm",onClick:C,children:[a.jsx(rw,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Edit"})]}),a.jsxs($,{size:"sm",onClick:w,variant:"outline",className:"text-green-600 border-green-600 hover:bg-green-50 hover:text-green-700",children:[a.jsx(Hie,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Customer"})]}),a.jsxs($,{size:"sm",onClick:T,className:"bg-green-500 hover:bg-green-600 text-white hidden sm:flex",children:[a.jsx(Uo,{className:"sm:mr-2 h-4 w-4"}),a.jsx("span",{className:"hidden sm:inline",children:"Publish"})]})]})]})})},EIe=({store:t,open:e,onOpenChange:n})=>{var h;wi();const{updateStore:r,isLoadingStores:s}=$n(),[i,o]=p.useState({name:t.name,description:t.description,type:t.type,theme:{primaryColor:t.theme.primaryColor,secondaryColor:t.theme.secondaryColor,fontFamily:t.theme.fontFamily,layout:t.theme.layout},settings:{showThemeToggle:((h=t.settings)==null?void 0:h.showThemeToggle)??!0}}),l=f=>{const{name:m,value:g}=f.target;o(x=>({...x,[m]:g}))},c=(f,m)=>{o(g=>({...g,theme:{...g.theme,[f]:m}}))},u=(f,m)=>{o(g=>({...g,settings:{...g.settings,[f]:m}}))},d=f=>{f.preventDefault();const m={name:i.name,description:i.description,type:i.type,theme:i.theme,settings:i.settings};r(t.id,m),n(!1)};return a.jsx(zr,{open:e,onOpenChange:n,children:a.jsxs(Dr,{className:"sm:max-w-[600px] max-h-[85vh] overflow-y-auto",children:[a.jsxs(Mr,{children:[a.jsx(Lr,{children:"Edit Store"}),a.jsx(_i,{children:"Customize your store's details and appearance."})]}),a.jsxs("form",{onSubmit:d,className:"space-y-6 py-4",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"name",children:"Store Name"}),a.jsx(qe,{id:"name",name:"name",value:i.name,onChange:l,required:!0})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"description",children:"Description"}),a.jsx(Cn,{id:"description",name:"description",value:i.description,onChange:l,rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"type",children:"Store Type"}),a.jsxs(xc,{value:i.type,onValueChange:f=>o(m=>({...m,type:f})),children:[a.jsx(tl,{id:"type",children:a.jsx(vc,{placeholder:"Select store type"})}),a.jsxs(nl,{children:[a.jsx(nr,{value:"fashion",children:"Fashion"}),a.jsx(nr,{value:"electronics",children:"Electronics"}),a.jsx(nr,{value:"food",children:"Food"}),a.jsx(nr,{value:"jewelry",children:"Jewelry"}),a.jsx(nr,{value:"general",children:"General"})]})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx("h3",{className:"text-sm font-medium",children:"Theme Settings"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"primaryColor",children:"Primary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(qe,{id:"primaryColor",name:"primaryColor",type:"color",value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(qe,{value:i.theme.primaryColor,onChange:f=>c("primaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"secondaryColor",children:"Secondary Color"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx(qe,{id:"secondaryColor",name:"secondaryColor",type:"color",value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"w-12 h-10 p-1"}),a.jsx(qe,{value:i.theme.secondaryColor,onChange:f=>c("secondaryColor",f.target.value),className:"flex-1"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"fontFamily",children:"Font Family"}),a.jsxs(xc,{value:i.theme.fontFamily,onValueChange:f=>c("fontFamily",f),children:[a.jsx(tl,{id:"fontFamily",children:a.jsx(vc,{placeholder:"Select font"})}),a.jsxs(nl,{children:[a.jsx(nr,{value:"Inter",children:"Inter"}),a.jsx(nr,{value:"Roboto",children:"Roboto"}),a.jsx(nr,{value:"Poppins",children:"Poppins"}),a.jsx(nr,{value:"Montserrat",children:"Montserrat"}),a.jsx(nr,{value:"Open Sans",children:"Open Sans"})]})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"layout",children:"Layout Style"}),a.jsxs(xc,{value:i.theme.layout,onValueChange:f=>c("layout",f),children:[a.jsx(tl,{id:"layout",children:a.jsx(vc,{placeholder:"Select layout"})}),a.jsxs(nl,{children:[a.jsx(nr,{value:"grid",children:"Grid"}),a.jsx(nr,{value:"list",children:"List"}),a.jsx(nr,{value:"masonry",children:"Masonry"}),a.jsx(nr,{value:"carousel",children:"Carousel"})]})]})]}),a.jsxs("div",{className:"space-y-2 sm:col-span-2",children:[a.jsx(ke,{htmlFor:"showThemeToggle",className:"flex items-center",children:"Show Light/Dark Mode Toggle in Store Header"}),a.jsx(Oo,{id:"showThemeToggle",checked:i.settings.showThemeToggle,onCheckedChange:f=>u("showThemeToggle",f),disabled:s}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Allows customers to switch between light and dark themes on your store page."})]})]})]})]}),a.jsx(Nr,{children:a.jsx($,{type:"submit",disabled:s,children:"Save Changes"})})]})]})})};function TIe(t,e){const n=e||{};return(t[t.length-1]===""?[...t,""]:t).join((n.padRight?" ":"")+","+(n.padLeft===!1?"":" ")).trim()}const IIe=/^[$_\p{ID_Start}][$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,NIe=/^[$_\p{ID_Start}][-$_\u{200C}\u{200D}\p{ID_Continue}]*$/u,PIe={};function wF(t,e){return((e||PIe).jsx?NIe:IIe).test(t)}const AIe=/[ \t\n\f\r]/g;function kIe(t){return typeof t=="object"?t.type==="text"?bF(t.value):!1:bF(t)}function bF(t){return t.replace(AIe,"")===""}class fy{constructor(e,n,r){this.normal=n,this.property=e,r&&(this.space=r)}}fy.prototype.normal={};fy.prototype.property={};fy.prototype.space=void 0;function KH(t,e){const n={},r={};for(const s of t)Object.assign(n,s.property),Object.assign(r,s.normal);return new fy(n,r,e)}function f1(t){return t.toLowerCase()}class Ci{constructor(e,n){this.attribute=n,this.property=e}}Ci.prototype.attribute="";Ci.prototype.booleanish=!1;Ci.prototype.boolean=!1;Ci.prototype.commaOrSpaceSeparated=!1;Ci.prototype.commaSeparated=!1;Ci.prototype.defined=!1;Ci.prototype.mustUseProperty=!1;Ci.prototype.number=!1;Ci.prototype.overloadedBoolean=!1;Ci.prototype.property="";Ci.prototype.spaceSeparated=!1;Ci.prototype.space=void 0;let RIe=0;const Xt=Cd(),Vr=Cd(),m1=Cd(),Xe=Cd(),Hn=Cd(),zh=Cd(),Di=Cd();function Cd(){return 2**++RIe}const p1=Object.freeze(Object.defineProperty({__proto__:null,boolean:Xt,booleanish:Vr,commaOrSpaceSeparated:Di,commaSeparated:zh,number:Xe,overloadedBoolean:m1,spaceSeparated:Hn},Symbol.toStringTag,{value:"Module"})),oC=Object.keys(p1);class ok extends Ci{constructor(e,n,r,s){let i=-1;if(super(e,n),_F(this,"space",s),typeof r=="number")for(;++i<oC.length;){const o=oC[i];_F(this,oC[i],(r&p1[o])===p1[o])}}}ok.prototype.defined=!0;function _F(t,e,n){n&&(t[e]=n)}function zf(t){const e={},n={};for(const[r,s]of Object.entries(t.properties)){const i=new ok(r,t.transform(t.attributes||{},r),s,t.space);t.mustUseProperty&&t.mustUseProperty.includes(r)&&(i.mustUseProperty=!0),e[r]=i,n[f1(r)]=r,n[f1(i.attribute)]=r}return new fy(e,n,t.space)}const YH=zf({properties:{ariaActiveDescendant:null,ariaAtomic:Vr,ariaAutoComplete:null,ariaBusy:Vr,ariaChecked:Vr,ariaColCount:Xe,ariaColIndex:Xe,ariaColSpan:Xe,ariaControls:Hn,ariaCurrent:null,ariaDescribedBy:Hn,ariaDetails:null,ariaDisabled:Vr,ariaDropEffect:Hn,ariaErrorMessage:null,ariaExpanded:Vr,ariaFlowTo:Hn,ariaGrabbed:Vr,ariaHasPopup:null,ariaHidden:Vr,ariaInvalid:null,ariaKeyShortcuts:null,ariaLabel:null,ariaLabelledBy:Hn,ariaLevel:Xe,ariaLive:null,ariaModal:Vr,ariaMultiLine:Vr,ariaMultiSelectable:Vr,ariaOrientation:null,ariaOwns:Hn,ariaPlaceholder:null,ariaPosInSet:Xe,ariaPressed:Vr,ariaReadOnly:Vr,ariaRelevant:null,ariaRequired:Vr,ariaRoleDescription:Hn,ariaRowCount:Xe,ariaRowIndex:Xe,ariaRowSpan:Xe,ariaSelected:Vr,ariaSetSize:Xe,ariaSort:null,ariaValueMax:Xe,ariaValueMin:Xe,ariaValueNow:Xe,ariaValueText:null,role:null},transform(t,e){return e==="role"?e:"aria-"+e.slice(4).toLowerCase()}});function JH(t,e){return e in t?t[e]:e}function XH(t,e){return JH(t,e.toLowerCase())}const jIe=zf({attributes:{acceptcharset:"accept-charset",classname:"class",htmlfor:"for",httpequiv:"http-equiv"},mustUseProperty:["checked","multiple","muted","selected"],properties:{abbr:null,accept:zh,acceptCharset:Hn,accessKey:Hn,action:null,allow:null,allowFullScreen:Xt,allowPaymentRequest:Xt,allowUserMedia:Xt,alt:null,as:null,async:Xt,autoCapitalize:null,autoComplete:Hn,autoFocus:Xt,autoPlay:Xt,blocking:Hn,capture:null,charSet:null,checked:Xt,cite:null,className:Hn,cols:Xe,colSpan:null,content:null,contentEditable:Vr,controls:Xt,controlsList:Hn,coords:Xe|zh,crossOrigin:null,data:null,dateTime:null,decoding:null,default:Xt,defer:Xt,dir:null,dirName:null,disabled:Xt,download:m1,draggable:Vr,encType:null,enterKeyHint:null,fetchPriority:null,form:null,formAction:null,formEncType:null,formMethod:null,formNoValidate:Xt,formTarget:null,headers:Hn,height:Xe,hidden:m1,high:Xe,href:null,hrefLang:null,htmlFor:Hn,httpEquiv:Hn,id:null,imageSizes:null,imageSrcSet:null,inert:Xt,inputMode:null,integrity:null,is:null,isMap:Xt,itemId:null,itemProp:Hn,itemRef:Hn,itemScope:Xt,itemType:Hn,kind:null,label:null,lang:null,language:null,list:null,loading:null,loop:Xt,low:Xe,manifest:null,max:null,maxLength:Xe,media:null,method:null,min:null,minLength:Xe,multiple:Xt,muted:Xt,name:null,nonce:null,noModule:Xt,noValidate:Xt,onAbort:null,onAfterPrint:null,onAuxClick:null,onBeforeMatch:null,onBeforePrint:null,onBeforeToggle:null,onBeforeUnload:null,onBlur:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onContextLost:null,onContextMenu:null,onContextRestored:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnded:null,onError:null,onFocus:null,onFormData:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLanguageChange:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadEnd:null,onLoadStart:null,onMessage:null,onMessageError:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRejectionHandled:null,onReset:null,onResize:null,onScroll:null,onScrollEnd:null,onSecurityPolicyViolation:null,onSeeked:null,onSeeking:null,onSelect:null,onSlotChange:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnhandledRejection:null,onUnload:null,onVolumeChange:null,onWaiting:null,onWheel:null,open:Xt,optimum:Xe,pattern:null,ping:Hn,placeholder:null,playsInline:Xt,popover:null,popoverTarget:null,popoverTargetAction:null,poster:null,preload:null,readOnly:Xt,referrerPolicy:null,rel:Hn,required:Xt,reversed:Xt,rows:Xe,rowSpan:Xe,sandbox:Hn,scope:null,scoped:Xt,seamless:Xt,selected:Xt,shadowRootClonable:Xt,shadowRootDelegatesFocus:Xt,shadowRootMode:null,shape:null,size:Xe,sizes:null,slot:null,span:Xe,spellCheck:Vr,src:null,srcDoc:null,srcLang:null,srcSet:null,start:Xe,step:null,style:null,tabIndex:Xe,target:null,title:null,translate:null,type:null,typeMustMatch:Xt,useMap:null,value:Vr,width:Xe,wrap:null,writingSuggestions:null,align:null,aLink:null,archive:Hn,axis:null,background:null,bgColor:null,border:Xe,borderColor:null,bottomMargin:Xe,cellPadding:null,cellSpacing:null,char:null,charOff:null,classId:null,clear:null,code:null,codeBase:null,codeType:null,color:null,compact:Xt,declare:Xt,event:null,face:null,frame:null,frameBorder:null,hSpace:Xe,leftMargin:Xe,link:null,longDesc:null,lowSrc:null,marginHeight:Xe,marginWidth:Xe,noResize:Xt,noHref:Xt,noShade:Xt,noWrap:Xt,object:null,profile:null,prompt:null,rev:null,rightMargin:Xe,rules:null,scheme:null,scrolling:Vr,standby:null,summary:null,text:null,topMargin:Xe,valueType:null,version:null,vAlign:null,vLink:null,vSpace:Xe,allowTransparency:null,autoCorrect:null,autoSave:null,disablePictureInPicture:Xt,disableRemotePlayback:Xt,prefix:null,property:null,results:Xe,security:null,unselectable:null},space:"html",transform:XH}),DIe=zf({attributes:{accentHeight:"accent-height",alignmentBaseline:"alignment-baseline",arabicForm:"arabic-form",baselineShift:"baseline-shift",capHeight:"cap-height",className:"class",clipPath:"clip-path",clipRule:"clip-rule",colorInterpolation:"color-interpolation",colorInterpolationFilters:"color-interpolation-filters",colorProfile:"color-profile",colorRendering:"color-rendering",crossOrigin:"crossorigin",dataType:"datatype",dominantBaseline:"dominant-baseline",enableBackground:"enable-background",fillOpacity:"fill-opacity",fillRule:"fill-rule",floodColor:"flood-color",floodOpacity:"flood-opacity",fontFamily:"font-family",fontSize:"font-size",fontSizeAdjust:"font-size-adjust",fontStretch:"font-stretch",fontStyle:"font-style",fontVariant:"font-variant",fontWeight:"font-weight",glyphName:"glyph-name",glyphOrientationHorizontal:"glyph-orientation-horizontal",glyphOrientationVertical:"glyph-orientation-vertical",hrefLang:"hreflang",horizAdvX:"horiz-adv-x",horizOriginX:"horiz-origin-x",horizOriginY:"horiz-origin-y",imageRendering:"image-rendering",letterSpacing:"letter-spacing",lightingColor:"lighting-color",markerEnd:"marker-end",markerMid:"marker-mid",markerStart:"marker-start",navDown:"nav-down",navDownLeft:"nav-down-left",navDownRight:"nav-down-right",navLeft:"nav-left",navNext:"nav-next",navPrev:"nav-prev",navRight:"nav-right",navUp:"nav-up",navUpLeft:"nav-up-left",navUpRight:"nav-up-right",onAbort:"onabort",onActivate:"onactivate",onAfterPrint:"onafterprint",onBeforePrint:"onbeforeprint",onBegin:"onbegin",onCancel:"oncancel",onCanPlay:"oncanplay",onCanPlayThrough:"oncanplaythrough",onChange:"onchange",onClick:"onclick",onClose:"onclose",onCopy:"oncopy",onCueChange:"oncuechange",onCut:"oncut",onDblClick:"ondblclick",onDrag:"ondrag",onDragEnd:"ondragend",onDragEnter:"ondragenter",onDragExit:"ondragexit",onDragLeave:"ondragleave",onDragOver:"ondragover",onDragStart:"ondragstart",onDrop:"ondrop",onDurationChange:"ondurationchange",onEmptied:"onemptied",onEnd:"onend",onEnded:"onended",onError:"onerror",onFocus:"onfocus",onFocusIn:"onfocusin",onFocusOut:"onfocusout",onHashChange:"onhashchange",onInput:"oninput",onInvalid:"oninvalid",onKeyDown:"onkeydown",onKeyPress:"onkeypress",onKeyUp:"onkeyup",onLoad:"onload",onLoadedData:"onloadeddata",onLoadedMetadata:"onloadedmetadata",onLoadStart:"onloadstart",onMessage:"onmessage",onMouseDown:"onmousedown",onMouseEnter:"onmouseenter",onMouseLeave:"onmouseleave",onMouseMove:"onmousemove",onMouseOut:"onmouseout",onMouseOver:"onmouseover",onMouseUp:"onmouseup",onMouseWheel:"onmousewheel",onOffline:"onoffline",onOnline:"ononline",onPageHide:"onpagehide",onPageShow:"onpageshow",onPaste:"onpaste",onPause:"onpause",onPlay:"onplay",onPlaying:"onplaying",onPopState:"onpopstate",onProgress:"onprogress",onRateChange:"onratechange",onRepeat:"onrepeat",onReset:"onreset",onResize:"onresize",onScroll:"onscroll",onSeeked:"onseeked",onSeeking:"onseeking",onSelect:"onselect",onShow:"onshow",onStalled:"onstalled",onStorage:"onstorage",onSubmit:"onsubmit",onSuspend:"onsuspend",onTimeUpdate:"ontimeupdate",onToggle:"ontoggle",onUnload:"onunload",onVolumeChange:"onvolumechange",onWaiting:"onwaiting",onZoom:"onzoom",overlinePosition:"overline-position",overlineThickness:"overline-thickness",paintOrder:"paint-order",panose1:"panose-1",pointerEvents:"pointer-events",referrerPolicy:"referrerpolicy",renderingIntent:"rendering-intent",shapeRendering:"shape-rendering",stopColor:"stop-color",stopOpacity:"stop-opacity",strikethroughPosition:"strikethrough-position",strikethroughThickness:"strikethrough-thickness",strokeDashArray:"stroke-dasharray",strokeDashOffset:"stroke-dashoffset",strokeLineCap:"stroke-linecap",strokeLineJoin:"stroke-linejoin",strokeMiterLimit:"stroke-miterlimit",strokeOpacity:"stroke-opacity",strokeWidth:"stroke-width",tabIndex:"tabindex",textAnchor:"text-anchor",textDecoration:"text-decoration",textRendering:"text-rendering",transformOrigin:"transform-origin",typeOf:"typeof",underlinePosition:"underline-position",underlineThickness:"underline-thickness",unicodeBidi:"unicode-bidi",unicodeRange:"unicode-range",unitsPerEm:"units-per-em",vAlphabetic:"v-alphabetic",vHanging:"v-hanging",vIdeographic:"v-ideographic",vMathematical:"v-mathematical",vectorEffect:"vector-effect",vertAdvY:"vert-adv-y",vertOriginX:"vert-origin-x",vertOriginY:"vert-origin-y",wordSpacing:"word-spacing",writingMode:"writing-mode",xHeight:"x-height",playbackOrder:"playbackorder",timelineBegin:"timelinebegin"},properties:{about:Di,accentHeight:Xe,accumulate:null,additive:null,alignmentBaseline:null,alphabetic:Xe,amplitude:Xe,arabicForm:null,ascent:Xe,attributeName:null,attributeType:null,azimuth:Xe,bandwidth:null,baselineShift:null,baseFrequency:null,baseProfile:null,bbox:null,begin:null,bias:Xe,by:null,calcMode:null,capHeight:Xe,className:Hn,clip:null,clipPath:null,clipPathUnits:null,clipRule:null,color:null,colorInterpolation:null,colorInterpolationFilters:null,colorProfile:null,colorRendering:null,content:null,contentScriptType:null,contentStyleType:null,crossOrigin:null,cursor:null,cx:null,cy:null,d:null,dataType:null,defaultAction:null,descent:Xe,diffuseConstant:Xe,direction:null,display:null,dur:null,divisor:Xe,dominantBaseline:null,download:Xt,dx:null,dy:null,edgeMode:null,editable:null,elevation:Xe,enableBackground:null,end:null,event:null,exponent:Xe,externalResourcesRequired:null,fill:null,fillOpacity:Xe,fillRule:null,filter:null,filterRes:null,filterUnits:null,floodColor:null,floodOpacity:null,focusable:null,focusHighlight:null,fontFamily:null,fontSize:null,fontSizeAdjust:null,fontStretch:null,fontStyle:null,fontVariant:null,fontWeight:null,format:null,fr:null,from:null,fx:null,fy:null,g1:zh,g2:zh,glyphName:zh,glyphOrientationHorizontal:null,glyphOrientationVertical:null,glyphRef:null,gradientTransform:null,gradientUnits:null,handler:null,hanging:Xe,hatchContentUnits:null,hatchUnits:null,height:null,href:null,hrefLang:null,horizAdvX:Xe,horizOriginX:Xe,horizOriginY:Xe,id:null,ideographic:Xe,imageRendering:null,initialVisibility:null,in:null,in2:null,intercept:Xe,k:Xe,k1:Xe,k2:Xe,k3:Xe,k4:Xe,kernelMatrix:Di,kernelUnitLength:null,keyPoints:null,keySplines:null,keyTimes:null,kerning:null,lang:null,lengthAdjust:null,letterSpacing:null,lightingColor:null,limitingConeAngle:Xe,local:null,markerEnd:null,markerMid:null,markerStart:null,markerHeight:null,markerUnits:null,markerWidth:null,mask:null,maskContentUnits:null,maskUnits:null,mathematical:null,max:null,media:null,mediaCharacterEncoding:null,mediaContentEncodings:null,mediaSize:Xe,mediaTime:null,method:null,min:null,mode:null,name:null,navDown:null,navDownLeft:null,navDownRight:null,navLeft:null,navNext:null,navPrev:null,navRight:null,navUp:null,navUpLeft:null,navUpRight:null,numOctaves:null,observer:null,offset:null,onAbort:null,onActivate:null,onAfterPrint:null,onBeforePrint:null,onBegin:null,onCancel:null,onCanPlay:null,onCanPlayThrough:null,onChange:null,onClick:null,onClose:null,onCopy:null,onCueChange:null,onCut:null,onDblClick:null,onDrag:null,onDragEnd:null,onDragEnter:null,onDragExit:null,onDragLeave:null,onDragOver:null,onDragStart:null,onDrop:null,onDurationChange:null,onEmptied:null,onEnd:null,onEnded:null,onError:null,onFocus:null,onFocusIn:null,onFocusOut:null,onHashChange:null,onInput:null,onInvalid:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onLoad:null,onLoadedData:null,onLoadedMetadata:null,onLoadStart:null,onMessage:null,onMouseDown:null,onMouseEnter:null,onMouseLeave:null,onMouseMove:null,onMouseOut:null,onMouseOver:null,onMouseUp:null,onMouseWheel:null,onOffline:null,onOnline:null,onPageHide:null,onPageShow:null,onPaste:null,onPause:null,onPlay:null,onPlaying:null,onPopState:null,onProgress:null,onRateChange:null,onRepeat:null,onReset:null,onResize:null,onScroll:null,onSeeked:null,onSeeking:null,onSelect:null,onShow:null,onStalled:null,onStorage:null,onSubmit:null,onSuspend:null,onTimeUpdate:null,onToggle:null,onUnload:null,onVolumeChange:null,onWaiting:null,onZoom:null,opacity:null,operator:null,order:null,orient:null,orientation:null,origin:null,overflow:null,overlay:null,overlinePosition:Xe,overlineThickness:Xe,paintOrder:null,panose1:null,path:null,pathLength:Xe,patternContentUnits:null,patternTransform:null,patternUnits:null,phase:null,ping:Hn,pitch:null,playbackOrder:null,pointerEvents:null,points:null,pointsAtX:Xe,pointsAtY:Xe,pointsAtZ:Xe,preserveAlpha:null,preserveAspectRatio:null,primitiveUnits:null,propagate:null,property:Di,r:null,radius:null,referrerPolicy:null,refX:null,refY:null,rel:Di,rev:Di,renderingIntent:null,repeatCount:null,repeatDur:null,requiredExtensions:Di,requiredFeatures:Di,requiredFonts:Di,requiredFormats:Di,resource:null,restart:null,result:null,rotate:null,rx:null,ry:null,scale:null,seed:null,shapeRendering:null,side:null,slope:null,snapshotTime:null,specularConstant:Xe,specularExponent:Xe,spreadMethod:null,spacing:null,startOffset:null,stdDeviation:null,stemh:null,stemv:null,stitchTiles:null,stopColor:null,stopOpacity:null,strikethroughPosition:Xe,strikethroughThickness:Xe,string:null,stroke:null,strokeDashArray:Di,strokeDashOffset:null,strokeLineCap:null,strokeLineJoin:null,strokeMiterLimit:Xe,strokeOpacity:Xe,strokeWidth:null,style:null,surfaceScale:Xe,syncBehavior:null,syncBehaviorDefault:null,syncMaster:null,syncTolerance:null,syncToleranceDefault:null,systemLanguage:Di,tabIndex:Xe,tableValues:null,target:null,targetX:Xe,targetY:Xe,textAnchor:null,textDecoration:null,textRendering:null,textLength:null,timelineBegin:null,title:null,transformBehavior:null,type:null,typeOf:Di,to:null,transform:null,transformOrigin:null,u1:null,u2:null,underlinePosition:Xe,underlineThickness:Xe,unicode:null,unicodeBidi:null,unicodeRange:null,unitsPerEm:Xe,values:null,vAlphabetic:Xe,vMathematical:Xe,vectorEffect:null,vHanging:Xe,vIdeographic:Xe,version:null,vertAdvY:Xe,vertOriginX:Xe,vertOriginY:Xe,viewBox:null,viewTarget:null,visibility:null,width:null,widths:null,wordSpacing:null,writingMode:null,x:null,x1:null,x2:null,xChannelSelector:null,xHeight:Xe,y:null,y1:null,y2:null,yChannelSelector:null,z:null,zoomAndPan:null},space:"svg",transform:JH}),QH=zf({properties:{xLinkActuate:null,xLinkArcRole:null,xLinkHref:null,xLinkRole:null,xLinkShow:null,xLinkTitle:null,xLinkType:null},space:"xlink",transform(t,e){return"xlink:"+e.slice(5).toLowerCase()}}),ZH=zf({attributes:{xmlnsxlink:"xmlns:xlink"},properties:{xmlnsXLink:null,xmlns:null},space:"xmlns",transform:XH}),eq=zf({properties:{xmlBase:null,xmlLang:null,xmlSpace:null},space:"xml",transform(t,e){return"xml:"+e.slice(3).toLowerCase()}}),MIe={classId:"classID",dataType:"datatype",itemId:"itemID",strokeDashArray:"strokeDasharray",strokeDashOffset:"strokeDashoffset",strokeLineCap:"strokeLinecap",strokeLineJoin:"strokeLinejoin",strokeMiterLimit:"strokeMiterlimit",typeOf:"typeof",xLinkActuate:"xlinkActuate",xLinkArcRole:"xlinkArcrole",xLinkHref:"xlinkHref",xLinkRole:"xlinkRole",xLinkShow:"xlinkShow",xLinkTitle:"xlinkTitle",xLinkType:"xlinkType",xmlnsXLink:"xmlnsXlink"},LIe=/[A-Z]/g,SF=/-[a-z]/g,FIe=/^data[-\w.:]+$/i;function OIe(t,e){const n=f1(e);let r=e,s=Ci;if(n in t.normal)return t.property[t.normal[n]];if(n.length>4&&n.slice(0,4)==="data"&&FIe.test(e)){if(e.charAt(4)==="-"){const i=e.slice(5).replace(SF,VIe);r="data"+i.charAt(0).toUpperCase()+i.slice(1)}else{const i=e.slice(4);if(!SF.test(i)){let o=i.replace(LIe,$Ie);o.charAt(0)!=="-"&&(o="-"+o),e="data"+o}}s=ok}return new s(r,e)}function $Ie(t){return"-"+t.toLowerCase()}function VIe(t){return t.charAt(1).toUpperCase()}const UIe=KH([YH,jIe,QH,ZH,eq],"html"),ak=KH([YH,DIe,QH,ZH,eq],"svg");function BIe(t){return t.join(" ").trim()}var lk={},CF=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,zIe=/\n/g,GIe=/^\s*/,WIe=/^(\*?[-#/*\\\w]+(\[[0-9a-z_-]+\])?)\s*/,HIe=/^:\s*/,qIe=/^((?:'(?:\\'|.)*?'|"(?:\\"|.)*?"|\([^)]*?\)|[^};])+)/,KIe=/^[;\s]*/,YIe=/^\s+|\s+$/g,JIe=`
`,EF="/",TF="*",Su="",XIe="comment",QIe="declaration",ZIe=function(t,e){if(typeof t!="string")throw new TypeError("First argument must be a string");if(!t)return[];e=e||{};var n=1,r=1;function s(g){var x=g.match(zIe);x&&(n+=x.length);var w=g.lastIndexOf(JIe);r=~w?g.length-w:r+g.length}function i(){var g={line:n,column:r};return function(x){return x.position=new o(g),u(),x}}function o(g){this.start=g,this.end={line:n,column:r},this.source=e.source}o.prototype.content=t;function l(g){var x=new Error(e.source+":"+n+":"+r+": "+g);if(x.reason=g,x.filename=e.source,x.line=n,x.column=r,x.source=t,!e.silent)throw x}function c(g){var x=g.exec(t);if(x){var w=x[0];return s(w),t=t.slice(w.length),x}}function u(){c(GIe)}function d(g){var x;for(g=g||[];x=h();)x!==!1&&g.push(x);return g}function h(){var g=i();if(!(EF!=t.charAt(0)||TF!=t.charAt(1))){for(var x=2;Su!=t.charAt(x)&&(TF!=t.charAt(x)||EF!=t.charAt(x+1));)++x;if(x+=2,Su===t.charAt(x-1))return l("End of comment missing");var w=t.slice(2,x-2);return r+=2,s(w),t=t.slice(x),r+=2,g({type:XIe,comment:w})}}function f(){var g=i(),x=c(WIe);if(x){if(h(),!c(HIe))return l("property missing ':'");var w=c(qIe),v=g({type:QIe,property:IF(x[0].replace(CF,Su)),value:w?IF(w[0].replace(CF,Su)):Su});return c(KIe),v}}function m(){var g=[];d(g);for(var x;x=f();)x!==!1&&(g.push(x),d(g));return g}return u(),m()};function IF(t){return t?t.replace(YIe,Su):Su}var eNe=Sv&&Sv.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(lk,"__esModule",{value:!0});lk.default=nNe;var tNe=eNe(ZIe);function nNe(t,e){var n=null;if(!t||typeof t!="string")return n;var r=(0,tNe.default)(t),s=typeof e=="function";return r.forEach(function(i){if(i.type==="declaration"){var o=i.property,l=i.value;s?e(o,l,i):l&&(n=n||{},n[o]=l)}}),n}var f_={};Object.defineProperty(f_,"__esModule",{value:!0});f_.camelCase=void 0;var rNe=/^--[a-zA-Z0-9_-]+$/,sNe=/-([a-z])/g,iNe=/^[^-]+$/,oNe=/^-(webkit|moz|ms|o|khtml)-/,aNe=/^-(ms)-/,lNe=function(t){return!t||iNe.test(t)||rNe.test(t)},cNe=function(t,e){return e.toUpperCase()},NF=function(t,e){return"".concat(e,"-")},uNe=function(t,e){return e===void 0&&(e={}),lNe(t)?t:(t=t.toLowerCase(),e.reactCompat?t=t.replace(aNe,NF):t=t.replace(oNe,NF),t.replace(sNe,cNe))};f_.camelCase=uNe;var dNe=Sv&&Sv.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},hNe=dNe(lk),fNe=f_;function g1(t,e){var n={};return!t||typeof t!="string"||(0,hNe.default)(t,function(r,s){r&&s&&(n[(0,fNe.camelCase)(r,e)]=s)}),n}g1.default=g1;var mNe=g1;const pNe=c0(mNe),tq=nq("end"),ck=nq("start");function nq(t){return e;function e(n){const r=n&&n.position&&n.position[t]||{};if(typeof r.line=="number"&&r.line>0&&typeof r.column=="number"&&r.column>0)return{line:r.line,column:r.column,offset:typeof r.offset=="number"&&r.offset>-1?r.offset:void 0}}}function gNe(t){const e=ck(t),n=tq(t);if(e&&n)return{start:e,end:n}}function bp(t){return!t||typeof t!="object"?"":"position"in t||"type"in t?PF(t.position):"start"in t||"end"in t?PF(t):"line"in t||"column"in t?y1(t):""}function y1(t){return AF(t&&t.line)+":"+AF(t&&t.column)}function PF(t){return y1(t&&t.start)+"-"+y1(t&&t.end)}function AF(t){return t&&typeof t=="number"?t:1}class Vs extends Error{constructor(e,n,r){super(),typeof n=="string"&&(r=n,n=void 0);let s="",i={},o=!1;if(n&&("line"in n&&"column"in n?i={place:n}:"start"in n&&"end"in n?i={place:n}:"type"in n?i={ancestors:[n],place:n.position}:i={...n}),typeof e=="string"?s=e:!i.cause&&e&&(o=!0,s=e.message,i.cause=e),!i.ruleId&&!i.source&&typeof r=="string"){const c=r.indexOf(":");c===-1?i.ruleId=r:(i.source=r.slice(0,c),i.ruleId=r.slice(c+1))}if(!i.place&&i.ancestors&&i.ancestors){const c=i.ancestors[i.ancestors.length-1];c&&(i.place=c.position)}const l=i.place&&"start"in i.place?i.place.start:i.place;this.ancestors=i.ancestors||void 0,this.cause=i.cause||void 0,this.column=l?l.column:void 0,this.fatal=void 0,this.file,this.message=s,this.line=l?l.line:void 0,this.name=bp(i.place)||"1:1",this.place=i.place||void 0,this.reason=this.message,this.ruleId=i.ruleId||void 0,this.source=i.source||void 0,this.stack=o&&i.cause&&typeof i.cause.stack=="string"?i.cause.stack:"",this.actual,this.expected,this.note,this.url}}Vs.prototype.file="";Vs.prototype.name="";Vs.prototype.reason="";Vs.prototype.message="";Vs.prototype.stack="";Vs.prototype.column=void 0;Vs.prototype.line=void 0;Vs.prototype.ancestors=void 0;Vs.prototype.cause=void 0;Vs.prototype.fatal=void 0;Vs.prototype.place=void 0;Vs.prototype.ruleId=void 0;Vs.prototype.source=void 0;const uk={}.hasOwnProperty,yNe=new Map,xNe=/[A-Z]/g,vNe=new Set(["table","tbody","thead","tfoot","tr"]),wNe=new Set(["td","th"]),rq="https://github.com/syntax-tree/hast-util-to-jsx-runtime";function bNe(t,e){if(!e||e.Fragment===void 0)throw new TypeError("Expected `Fragment` in options");const n=e.filePath||void 0;let r;if(e.development){if(typeof e.jsxDEV!="function")throw new TypeError("Expected `jsxDEV` in options when `development: true`");r=PNe(n,e.jsxDEV)}else{if(typeof e.jsx!="function")throw new TypeError("Expected `jsx` in production options");if(typeof e.jsxs!="function")throw new TypeError("Expected `jsxs` in production options");r=NNe(n,e.jsx,e.jsxs)}const s={Fragment:e.Fragment,ancestors:[],components:e.components||{},create:r,elementAttributeNameCase:e.elementAttributeNameCase||"react",evaluater:e.createEvaluater?e.createEvaluater():void 0,filePath:n,ignoreInvalidStyle:e.ignoreInvalidStyle||!1,passKeys:e.passKeys!==!1,passNode:e.passNode||!1,schema:e.space==="svg"?ak:UIe,stylePropertyNameCase:e.stylePropertyNameCase||"dom",tableCellAlignToStyle:e.tableCellAlignToStyle!==!1},i=sq(s,t,void 0);return i&&typeof i!="string"?i:s.create(t,s.Fragment,{children:i||void 0},void 0)}function sq(t,e,n){if(e.type==="element")return _Ne(t,e,n);if(e.type==="mdxFlowExpression"||e.type==="mdxTextExpression")return SNe(t,e);if(e.type==="mdxJsxFlowElement"||e.type==="mdxJsxTextElement")return ENe(t,e,n);if(e.type==="mdxjsEsm")return CNe(t,e);if(e.type==="root")return TNe(t,e,n);if(e.type==="text")return INe(t,e)}function _Ne(t,e,n){const r=t.schema;let s=r;e.tagName.toLowerCase()==="svg"&&r.space==="html"&&(s=ak,t.schema=s),t.ancestors.push(e);const i=oq(t,e.tagName,!1),o=ANe(t,e);let l=hk(t,e);return vNe.has(e.tagName)&&(l=l.filter(function(c){return typeof c=="string"?!kIe(c):!0})),iq(t,o,i,e),dk(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function SNe(t,e){if(e.data&&e.data.estree&&t.evaluater){const r=e.data.estree.body[0];return r.type,t.evaluater.evaluateExpression(r.expression)}xg(t,e.position)}function CNe(t,e){if(e.data&&e.data.estree&&t.evaluater)return t.evaluater.evaluateProgram(e.data.estree);xg(t,e.position)}function ENe(t,e,n){const r=t.schema;let s=r;e.name==="svg"&&r.space==="html"&&(s=ak,t.schema=s),t.ancestors.push(e);const i=e.name===null?t.Fragment:oq(t,e.name,!0),o=kNe(t,e),l=hk(t,e);return iq(t,o,i,e),dk(o,l),t.ancestors.pop(),t.schema=r,t.create(e,i,o,n)}function TNe(t,e,n){const r={};return dk(r,hk(t,e)),t.create(e,t.Fragment,r,n)}function INe(t,e){return e.value}function iq(t,e,n,r){typeof n!="string"&&n!==t.Fragment&&t.passNode&&(e.node=r)}function dk(t,e){if(e.length>0){const n=e.length>1?e:e[0];n&&(t.children=n)}}function NNe(t,e,n){return r;function r(s,i,o,l){const u=Array.isArray(o.children)?n:e;return l?u(i,o,l):u(i,o)}}function PNe(t,e){return n;function n(r,s,i,o){const l=Array.isArray(i.children),c=ck(r);return e(s,i,o,l,{columnNumber:c?c.column-1:void 0,fileName:t,lineNumber:c?c.line:void 0},void 0)}}function ANe(t,e){const n={};let r,s;for(s in e.properties)if(s!=="children"&&uk.call(e.properties,s)){const i=RNe(t,s,e.properties[s]);if(i){const[o,l]=i;t.tableCellAlignToStyle&&o==="align"&&typeof l=="string"&&wNe.has(e.tagName)?r=l:n[o]=l}}if(r){const i=n.style||(n.style={});i[t.stylePropertyNameCase==="css"?"text-align":"textAlign"]=r}return n}function kNe(t,e){const n={};for(const r of e.attributes)if(r.type==="mdxJsxExpressionAttribute")if(r.data&&r.data.estree&&t.evaluater){const i=r.data.estree.body[0];i.type;const o=i.expression;o.type;const l=o.properties[0];l.type,Object.assign(n,t.evaluater.evaluateExpression(l.argument))}else xg(t,e.position);else{const s=r.name;let i;if(r.value&&typeof r.value=="object")if(r.value.data&&r.value.data.estree&&t.evaluater){const l=r.value.data.estree.body[0];l.type,i=t.evaluater.evaluateExpression(l.expression)}else xg(t,e.position);else i=r.value===null?!0:r.value;n[s]=i}return n}function hk(t,e){const n=[];let r=-1;const s=t.passKeys?new Map:yNe;for(;++r<e.children.length;){const i=e.children[r];let o;if(t.passKeys){const c=i.type==="element"?i.tagName:i.type==="mdxJsxFlowElement"||i.type==="mdxJsxTextElement"?i.name:void 0;if(c){const u=s.get(c)||0;o=c+"-"+u,s.set(c,u+1)}}const l=sq(t,i,o);l!==void 0&&n.push(l)}return n}function RNe(t,e,n){const r=OIe(t.schema,e);if(!(n==null||typeof n=="number"&&Number.isNaN(n))){if(Array.isArray(n)&&(n=r.commaSeparated?TIe(n):BIe(n)),r.property==="style"){let s=typeof n=="object"?n:jNe(t,String(n));return t.stylePropertyNameCase==="css"&&(s=DNe(s)),["style",s]}return[t.elementAttributeNameCase==="react"&&r.space?MIe[r.property]||r.property:r.attribute,n]}}function jNe(t,e){try{return pNe(e,{reactCompat:!0})}catch(n){if(t.ignoreInvalidStyle)return{};const r=n,s=new Vs("Cannot parse `style` attribute",{ancestors:t.ancestors,cause:r,ruleId:"style",source:"hast-util-to-jsx-runtime"});throw s.file=t.filePath||void 0,s.url=rq+"#cannot-parse-style-attribute",s}}function oq(t,e,n){let r;if(!n)r={type:"Literal",value:e};else if(e.includes(".")){const s=e.split(".");let i=-1,o;for(;++i<s.length;){const l=wF(s[i])?{type:"Identifier",name:s[i]}:{type:"Literal",value:s[i]};o=o?{type:"MemberExpression",object:o,property:l,computed:!!(i&&l.type==="Literal"),optional:!1}:l}r=o}else r=wF(e)&&!/^[a-z]/.test(e)?{type:"Identifier",name:e}:{type:"Literal",value:e};if(r.type==="Literal"){const s=r.value;return uk.call(t.components,s)?t.components[s]:s}if(t.evaluater)return t.evaluater.evaluateExpression(r);xg(t)}function xg(t,e){const n=new Vs("Cannot handle MDX estrees without `createEvaluater`",{ancestors:t.ancestors,place:e,ruleId:"mdx-estree",source:"hast-util-to-jsx-runtime"});throw n.file=t.filePath||void 0,n.url=rq+"#cannot-handle-mdx-estrees-without-createevaluater",n}function DNe(t){const e={};let n;for(n in t)uk.call(t,n)&&(e[MNe(n)]=t[n]);return e}function MNe(t){let e=t.replace(xNe,LNe);return e.slice(0,3)==="ms-"&&(e="-"+e),e}function LNe(t){return"-"+t.toLowerCase()}const aC={action:["form"],cite:["blockquote","del","ins","q"],data:["object"],formAction:["button","input"],href:["a","area","base","link"],icon:["menuitem"],itemId:null,manifest:["html"],ping:["a","area"],poster:["video"],src:["audio","embed","iframe","img","input","script","source","track","video"]},FNe={};function ONe(t,e){const n=e||FNe,r=typeof n.includeImageAlt=="boolean"?n.includeImageAlt:!0,s=typeof n.includeHtml=="boolean"?n.includeHtml:!0;return aq(t,r,s)}function aq(t,e,n){if($Ne(t)){if("value"in t)return t.type==="html"&&!n?"":t.value;if(e&&"alt"in t&&t.alt)return t.alt;if("children"in t)return kF(t.children,e,n)}return Array.isArray(t)?kF(t,e,n):""}function kF(t,e,n){const r=[];let s=-1;for(;++s<t.length;)r[s]=aq(t[s],e,n);return r.join("")}function $Ne(t){return!!(t&&typeof t=="object")}const RF=document.createElement("i");function fk(t){const e="&"+t+";";RF.innerHTML=e;const n=RF.textContent;return n.charCodeAt(n.length-1)===59&&t!=="semi"||n===e?!1:n}function Na(t,e,n,r){const s=t.length;let i=0,o;if(e<0?e=-e>s?0:s+e:e=e>s?s:e,n=n>0?n:0,r.length<1e4)o=Array.from(r),o.unshift(e,n),t.splice(...o);else for(n&&t.splice(e,n);i<r.length;)o=r.slice(i,i+1e4),o.unshift(e,0),t.splice(...o),i+=1e4,e+=1e4}function ao(t,e){return t.length>0?(Na(t,t.length,0,e),t):e}const jF={}.hasOwnProperty;function VNe(t){const e={};let n=-1;for(;++n<t.length;)UNe(e,t[n]);return e}function UNe(t,e){let n;for(n in e){const s=(jF.call(t,n)?t[n]:void 0)||(t[n]={}),i=e[n];let o;if(i)for(o in i){jF.call(s,o)||(s[o]=[]);const l=i[o];BNe(s[o],Array.isArray(l)?l:l?[l]:[])}}}function BNe(t,e){let n=-1;const r=[];for(;++n<e.length;)(e[n].add==="after"?t:r).push(e[n]);Na(t,0,0,r)}function lq(t,e){const n=Number.parseInt(t,e);return n<9||n===11||n>13&&n<32||n>126&&n<160||n>55295&&n<57344||n>64975&&n<65008||(n&65535)===65535||(n&65535)===65534||n>1114111?"�":String.fromCodePoint(n)}function Gh(t){return t.replace(/[\t\n\r ]+/g," ").replace(/^ | $/g,"").toLowerCase().toUpperCase()}const la=Zc(/[A-Za-z]/),Hi=Zc(/[\dA-Za-z]/),zNe=Zc(/[#-'*+\--9=?A-Z^-~]/);function x1(t){return t!==null&&(t<32||t===127)}const v1=Zc(/\d/),GNe=Zc(/[\dA-Fa-f]/),WNe=Zc(/[!-/:-@[-`{-~]/);function Gt(t){return t!==null&&t<-2}function xi(t){return t!==null&&(t<0||t===32)}function wn(t){return t===-2||t===-1||t===32}const HNe=Zc(/\p{P}|\p{S}/u),qNe=Zc(/\s/);function Zc(t){return e;function e(n){return n!==null&&n>-1&&t.test(String.fromCharCode(n))}}function Gf(t){const e=[];let n=-1,r=0,s=0;for(;++n<t.length;){const i=t.charCodeAt(n);let o="";if(i===37&&Hi(t.charCodeAt(n+1))&&Hi(t.charCodeAt(n+2)))s=2;else if(i<128)/[!#$&-;=?-Z_a-z~]/.test(String.fromCharCode(i))||(o=String.fromCharCode(i));else if(i>55295&&i<57344){const l=t.charCodeAt(n+1);i<56320&&l>56319&&l<57344?(o=String.fromCharCode(i,l),s=1):o="�"}else o=String.fromCharCode(i);o&&(e.push(t.slice(r,n),encodeURIComponent(o)),r=n+s+1,o=""),s&&(n+=s,s=0)}return e.join("")+t.slice(r)}function Yn(t,e,n,r){const s=r?r-1:Number.POSITIVE_INFINITY;let i=0;return o;function o(c){return wn(c)?(t.enter(n),l(c)):e(c)}function l(c){return wn(c)&&i++<s?(t.consume(c),l):(t.exit(n),e(c))}}const KNe={tokenize:YNe};function YNe(t){const e=t.attempt(this.parser.constructs.contentInitial,r,s);let n;return e;function r(l){if(l===null){t.consume(l);return}return t.enter("lineEnding"),t.consume(l),t.exit("lineEnding"),Yn(t,e,"linePrefix")}function s(l){return t.enter("paragraph"),i(l)}function i(l){const c=t.enter("chunkText",{contentType:"text",previous:n});return n&&(n.next=c),n=c,o(l)}function o(l){if(l===null){t.exit("chunkText"),t.exit("paragraph"),t.consume(l);return}return Gt(l)?(t.consume(l),t.exit("chunkText"),i):(t.consume(l),o)}}const JNe={tokenize:XNe},DF={tokenize:QNe};function XNe(t){const e=this,n=[];let r=0,s,i,o;return l;function l(C){if(r<n.length){const T=n[r];return e.containerState=T[1],t.attempt(T[0].continuation,c,u)(C)}return u(C)}function c(C){if(r++,e.containerState._closeFlow){e.containerState._closeFlow=void 0,s&&_();const T=e.events.length;let R=T,k;for(;R--;)if(e.events[R][0]==="exit"&&e.events[R][1].type==="chunkFlow"){k=e.events[R][1].end;break}v(r);let E=T;for(;E<e.events.length;)e.events[E][1].end={...k},E++;return Na(e.events,R+1,0,e.events.slice(T)),e.events.length=E,u(C)}return l(C)}function u(C){if(r===n.length){if(!s)return f(C);if(s.currentConstruct&&s.currentConstruct.concrete)return g(C);e.interrupt=!!(s.currentConstruct&&!s._gfmTableDynamicInterruptHack)}return e.containerState={},t.check(DF,d,h)(C)}function d(C){return s&&_(),v(r),f(C)}function h(C){return e.parser.lazy[e.now().line]=r!==n.length,o=e.now().offset,g(C)}function f(C){return e.containerState={},t.attempt(DF,m,g)(C)}function m(C){return r++,n.push([e.currentConstruct,e.containerState]),f(C)}function g(C){if(C===null){s&&_(),v(0),t.consume(C);return}return s=s||e.parser.flow(e.now()),t.enter("chunkFlow",{_tokenizer:s,contentType:"flow",previous:i}),x(C)}function x(C){if(C===null){w(t.exit("chunkFlow"),!0),v(0),t.consume(C);return}return Gt(C)?(t.consume(C),w(t.exit("chunkFlow")),r=0,e.interrupt=void 0,l):(t.consume(C),x)}function w(C,T){const R=e.sliceStream(C);if(T&&R.push(null),C.previous=i,i&&(i.next=C),i=C,s.defineSkip(C.start),s.write(R),e.parser.lazy[C.start.line]){let k=s.events.length;for(;k--;)if(s.events[k][1].start.offset<o&&(!s.events[k][1].end||s.events[k][1].end.offset>o))return;const E=e.events.length;let I=E,P,A;for(;I--;)if(e.events[I][0]==="exit"&&e.events[I][1].type==="chunkFlow"){if(P){A=e.events[I][1].end;break}P=!0}for(v(r),k=E;k<e.events.length;)e.events[k][1].end={...A},k++;Na(e.events,I+1,0,e.events.slice(E)),e.events.length=k}}function v(C){let T=n.length;for(;T-- >C;){const R=n[T];e.containerState=R[1],R[0].exit.call(e,t)}n.length=C}function _(){s.write([null]),i=void 0,s=void 0,e.containerState._closeFlow=void 0}}function QNe(t,e,n){return Yn(t,t.attempt(this.parser.constructs.document,e,n),"linePrefix",this.parser.constructs.disable.null.includes("codeIndented")?void 0:4)}function MF(t){if(t===null||xi(t)||qNe(t))return 1;if(HNe(t))return 2}function mk(t,e,n){const r=[];let s=-1;for(;++s<t.length;){const i=t[s].resolveAll;i&&!r.includes(i)&&(e=i(e,n),r.push(i))}return e}const w1={name:"attention",resolveAll:ZNe,tokenize:ePe};function ZNe(t,e){let n=-1,r,s,i,o,l,c,u,d;for(;++n<t.length;)if(t[n][0]==="enter"&&t[n][1].type==="attentionSequence"&&t[n][1]._close){for(r=n;r--;)if(t[r][0]==="exit"&&t[r][1].type==="attentionSequence"&&t[r][1]._open&&e.sliceSerialize(t[r][1]).charCodeAt(0)===e.sliceSerialize(t[n][1]).charCodeAt(0)){if((t[r][1]._close||t[n][1]._open)&&(t[n][1].end.offset-t[n][1].start.offset)%3&&!((t[r][1].end.offset-t[r][1].start.offset+t[n][1].end.offset-t[n][1].start.offset)%3))continue;c=t[r][1].end.offset-t[r][1].start.offset>1&&t[n][1].end.offset-t[n][1].start.offset>1?2:1;const h={...t[r][1].end},f={...t[n][1].start};LF(h,-c),LF(f,c),o={type:c>1?"strongSequence":"emphasisSequence",start:h,end:{...t[r][1].end}},l={type:c>1?"strongSequence":"emphasisSequence",start:{...t[n][1].start},end:f},i={type:c>1?"strongText":"emphasisText",start:{...t[r][1].end},end:{...t[n][1].start}},s={type:c>1?"strong":"emphasis",start:{...o.start},end:{...l.end}},t[r][1].end={...o.start},t[n][1].start={...l.end},u=[],t[r][1].end.offset-t[r][1].start.offset&&(u=ao(u,[["enter",t[r][1],e],["exit",t[r][1],e]])),u=ao(u,[["enter",s,e],["enter",o,e],["exit",o,e],["enter",i,e]]),u=ao(u,mk(e.parser.constructs.insideSpan.null,t.slice(r+1,n),e)),u=ao(u,[["exit",i,e],["enter",l,e],["exit",l,e],["exit",s,e]]),t[n][1].end.offset-t[n][1].start.offset?(d=2,u=ao(u,[["enter",t[n][1],e],["exit",t[n][1],e]])):d=0,Na(t,r-1,n-r+3,u),n=r+u.length-d-2;break}}for(n=-1;++n<t.length;)t[n][1].type==="attentionSequence"&&(t[n][1].type="data");return t}function ePe(t,e){const n=this.parser.constructs.attentionMarkers.null,r=this.previous,s=MF(r);let i;return o;function o(c){return i=c,t.enter("attentionSequence"),l(c)}function l(c){if(c===i)return t.consume(c),l;const u=t.exit("attentionSequence"),d=MF(c),h=!d||d===2&&s||n.includes(c),f=!s||s===2&&d||n.includes(r);return u._open=!!(i===42?h:h&&(s||!f)),u._close=!!(i===42?f:f&&(d||!h)),e(c)}}function LF(t,e){t.column+=e,t.offset+=e,t._bufferIndex+=e}const tPe={name:"autolink",tokenize:nPe};function nPe(t,e,n){let r=0;return s;function s(m){return t.enter("autolink"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.enter("autolinkProtocol"),i}function i(m){return la(m)?(t.consume(m),o):m===64?n(m):u(m)}function o(m){return m===43||m===45||m===46||Hi(m)?(r=1,l(m)):u(m)}function l(m){return m===58?(t.consume(m),r=0,c):(m===43||m===45||m===46||Hi(m))&&r++<32?(t.consume(m),l):(r=0,u(m))}function c(m){return m===62?(t.exit("autolinkProtocol"),t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):m===null||m===32||m===60||x1(m)?n(m):(t.consume(m),c)}function u(m){return m===64?(t.consume(m),d):zNe(m)?(t.consume(m),u):n(m)}function d(m){return Hi(m)?h(m):n(m)}function h(m){return m===46?(t.consume(m),r=0,d):m===62?(t.exit("autolinkProtocol").type="autolinkEmail",t.enter("autolinkMarker"),t.consume(m),t.exit("autolinkMarker"),t.exit("autolink"),e):f(m)}function f(m){if((m===45||Hi(m))&&r++<63){const g=m===45?f:h;return t.consume(m),g}return n(m)}}const m_={partial:!0,tokenize:rPe};function rPe(t,e,n){return r;function r(i){return wn(i)?Yn(t,s,"linePrefix")(i):s(i)}function s(i){return i===null||Gt(i)?e(i):n(i)}}const cq={continuation:{tokenize:iPe},exit:oPe,name:"blockQuote",tokenize:sPe};function sPe(t,e,n){const r=this;return s;function s(o){if(o===62){const l=r.containerState;return l.open||(t.enter("blockQuote",{_container:!0}),l.open=!0),t.enter("blockQuotePrefix"),t.enter("blockQuoteMarker"),t.consume(o),t.exit("blockQuoteMarker"),i}return n(o)}function i(o){return wn(o)?(t.enter("blockQuotePrefixWhitespace"),t.consume(o),t.exit("blockQuotePrefixWhitespace"),t.exit("blockQuotePrefix"),e):(t.exit("blockQuotePrefix"),e(o))}}function iPe(t,e,n){const r=this;return s;function s(o){return wn(o)?Yn(t,i,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(o):i(o)}function i(o){return t.attempt(cq,e,n)(o)}}function oPe(t){t.exit("blockQuote")}const uq={name:"characterEscape",tokenize:aPe};function aPe(t,e,n){return r;function r(i){return t.enter("characterEscape"),t.enter("escapeMarker"),t.consume(i),t.exit("escapeMarker"),s}function s(i){return WNe(i)?(t.enter("characterEscapeValue"),t.consume(i),t.exit("characterEscapeValue"),t.exit("characterEscape"),e):n(i)}}const dq={name:"characterReference",tokenize:lPe};function lPe(t,e,n){const r=this;let s=0,i,o;return l;function l(h){return t.enter("characterReference"),t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),c}function c(h){return h===35?(t.enter("characterReferenceMarkerNumeric"),t.consume(h),t.exit("characterReferenceMarkerNumeric"),u):(t.enter("characterReferenceValue"),i=31,o=Hi,d(h))}function u(h){return h===88||h===120?(t.enter("characterReferenceMarkerHexadecimal"),t.consume(h),t.exit("characterReferenceMarkerHexadecimal"),t.enter("characterReferenceValue"),i=6,o=GNe,d):(t.enter("characterReferenceValue"),i=7,o=v1,d(h))}function d(h){if(h===59&&s){const f=t.exit("characterReferenceValue");return o===Hi&&!fk(r.sliceSerialize(f))?n(h):(t.enter("characterReferenceMarker"),t.consume(h),t.exit("characterReferenceMarker"),t.exit("characterReference"),e)}return o(h)&&s++<i?(t.consume(h),d):n(h)}}const FF={partial:!0,tokenize:uPe},OF={concrete:!0,name:"codeFenced",tokenize:cPe};function cPe(t,e,n){const r=this,s={partial:!0,tokenize:R};let i=0,o=0,l;return c;function c(k){return u(k)}function u(k){const E=r.events[r.events.length-1];return i=E&&E[1].type==="linePrefix"?E[2].sliceSerialize(E[1],!0).length:0,l=k,t.enter("codeFenced"),t.enter("codeFencedFence"),t.enter("codeFencedFenceSequence"),d(k)}function d(k){return k===l?(o++,t.consume(k),d):o<3?n(k):(t.exit("codeFencedFenceSequence"),wn(k)?Yn(t,h,"whitespace")(k):h(k))}function h(k){return k===null||Gt(k)?(t.exit("codeFencedFence"),r.interrupt?e(k):t.check(FF,x,T)(k)):(t.enter("codeFencedFenceInfo"),t.enter("chunkString",{contentType:"string"}),f(k))}function f(k){return k===null||Gt(k)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),h(k)):wn(k)?(t.exit("chunkString"),t.exit("codeFencedFenceInfo"),Yn(t,m,"whitespace")(k)):k===96&&k===l?n(k):(t.consume(k),f)}function m(k){return k===null||Gt(k)?h(k):(t.enter("codeFencedFenceMeta"),t.enter("chunkString",{contentType:"string"}),g(k))}function g(k){return k===null||Gt(k)?(t.exit("chunkString"),t.exit("codeFencedFenceMeta"),h(k)):k===96&&k===l?n(k):(t.consume(k),g)}function x(k){return t.attempt(s,T,w)(k)}function w(k){return t.enter("lineEnding"),t.consume(k),t.exit("lineEnding"),v}function v(k){return i>0&&wn(k)?Yn(t,_,"linePrefix",i+1)(k):_(k)}function _(k){return k===null||Gt(k)?t.check(FF,x,T)(k):(t.enter("codeFlowValue"),C(k))}function C(k){return k===null||Gt(k)?(t.exit("codeFlowValue"),_(k)):(t.consume(k),C)}function T(k){return t.exit("codeFenced"),e(k)}function R(k,E,I){let P=0;return A;function A(U){return k.enter("lineEnding"),k.consume(U),k.exit("lineEnding"),D}function D(U){return k.enter("codeFencedFence"),wn(U)?Yn(k,j,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(U):j(U)}function j(U){return U===l?(k.enter("codeFencedFenceSequence"),M(U)):I(U)}function M(U){return U===l?(P++,k.consume(U),M):P>=o?(k.exit("codeFencedFenceSequence"),wn(U)?Yn(k,z,"whitespace")(U):z(U)):I(U)}function z(U){return U===null||Gt(U)?(k.exit("codeFencedFence"),E(U)):I(U)}}}function uPe(t,e,n){const r=this;return s;function s(o){return o===null?n(o):(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}const lC={name:"codeIndented",tokenize:hPe},dPe={partial:!0,tokenize:fPe};function hPe(t,e,n){const r=this;return s;function s(u){return t.enter("codeIndented"),Yn(t,i,"linePrefix",4+1)(u)}function i(u){const d=r.events[r.events.length-1];return d&&d[1].type==="linePrefix"&&d[2].sliceSerialize(d[1],!0).length>=4?o(u):n(u)}function o(u){return u===null?c(u):Gt(u)?t.attempt(dPe,o,c)(u):(t.enter("codeFlowValue"),l(u))}function l(u){return u===null||Gt(u)?(t.exit("codeFlowValue"),o(u)):(t.consume(u),l)}function c(u){return t.exit("codeIndented"),e(u)}}function fPe(t,e,n){const r=this;return s;function s(o){return r.parser.lazy[r.now().line]?n(o):Gt(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),s):Yn(t,i,"linePrefix",4+1)(o)}function i(o){const l=r.events[r.events.length-1];return l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):Gt(o)?s(o):n(o)}}const mPe={name:"codeText",previous:gPe,resolve:pPe,tokenize:yPe};function pPe(t){let e=t.length-4,n=3,r,s;if((t[n][1].type==="lineEnding"||t[n][1].type==="space")&&(t[e][1].type==="lineEnding"||t[e][1].type==="space")){for(r=n;++r<e;)if(t[r][1].type==="codeTextData"){t[n][1].type="codeTextPadding",t[e][1].type="codeTextPadding",n+=2,e-=2;break}}for(r=n-1,e++;++r<=e;)s===void 0?r!==e&&t[r][1].type!=="lineEnding"&&(s=r):(r===e||t[r][1].type==="lineEnding")&&(t[s][1].type="codeTextData",r!==s+2&&(t[s][1].end=t[r-1][1].end,t.splice(s+2,r-s-2),e-=r-s-2,r=s+2),s=void 0);return t}function gPe(t){return t!==96||this.events[this.events.length-1][1].type==="characterEscape"}function yPe(t,e,n){let r=0,s,i;return o;function o(h){return t.enter("codeText"),t.enter("codeTextSequence"),l(h)}function l(h){return h===96?(t.consume(h),r++,l):(t.exit("codeTextSequence"),c(h))}function c(h){return h===null?n(h):h===32?(t.enter("space"),t.consume(h),t.exit("space"),c):h===96?(i=t.enter("codeTextSequence"),s=0,d(h)):Gt(h)?(t.enter("lineEnding"),t.consume(h),t.exit("lineEnding"),c):(t.enter("codeTextData"),u(h))}function u(h){return h===null||h===32||h===96||Gt(h)?(t.exit("codeTextData"),c(h)):(t.consume(h),u)}function d(h){return h===96?(t.consume(h),s++,d):s===r?(t.exit("codeTextSequence"),t.exit("codeText"),e(h)):(i.type="codeTextData",u(h))}}class xPe{constructor(e){this.left=e?[...e]:[],this.right=[]}get(e){if(e<0||e>=this.left.length+this.right.length)throw new RangeError("Cannot access index `"+e+"` in a splice buffer of size `"+(this.left.length+this.right.length)+"`");return e<this.left.length?this.left[e]:this.right[this.right.length-e+this.left.length-1]}get length(){return this.left.length+this.right.length}shift(){return this.setCursor(0),this.right.pop()}slice(e,n){const r=n??Number.POSITIVE_INFINITY;return r<this.left.length?this.left.slice(e,r):e>this.left.length?this.right.slice(this.right.length-r+this.left.length,this.right.length-e+this.left.length).reverse():this.left.slice(e).concat(this.right.slice(this.right.length-r+this.left.length).reverse())}splice(e,n,r){const s=n||0;this.setCursor(Math.trunc(e));const i=this.right.splice(this.right.length-s,Number.POSITIVE_INFINITY);return r&&vm(this.left,r),i.reverse()}pop(){return this.setCursor(Number.POSITIVE_INFINITY),this.left.pop()}push(e){this.setCursor(Number.POSITIVE_INFINITY),this.left.push(e)}pushMany(e){this.setCursor(Number.POSITIVE_INFINITY),vm(this.left,e)}unshift(e){this.setCursor(0),this.right.push(e)}unshiftMany(e){this.setCursor(0),vm(this.right,e.reverse())}setCursor(e){if(!(e===this.left.length||e>this.left.length&&this.right.length===0||e<0&&this.left.length===0))if(e<this.left.length){const n=this.left.splice(e,Number.POSITIVE_INFINITY);vm(this.right,n.reverse())}else{const n=this.right.splice(this.left.length+this.right.length-e,Number.POSITIVE_INFINITY);vm(this.left,n.reverse())}}}function vm(t,e){let n=0;if(e.length<1e4)t.push(...e);else for(;n<e.length;)t.push(...e.slice(n,n+1e4)),n+=1e4}function hq(t){const e={};let n=-1,r,s,i,o,l,c,u;const d=new xPe(t);for(;++n<d.length;){for(;n in e;)n=e[n];if(r=d.get(n),n&&r[1].type==="chunkFlow"&&d.get(n-1)[1].type==="listItemPrefix"&&(c=r[1]._tokenizer.events,i=0,i<c.length&&c[i][1].type==="lineEndingBlank"&&(i+=2),i<c.length&&c[i][1].type==="content"))for(;++i<c.length&&c[i][1].type!=="content";)c[i][1].type==="chunkText"&&(c[i][1]._isInFirstContentOfListItem=!0,i++);if(r[0]==="enter")r[1].contentType&&(Object.assign(e,vPe(d,n)),n=e[n],u=!0);else if(r[1]._container){for(i=n,s=void 0;i--;)if(o=d.get(i),o[1].type==="lineEnding"||o[1].type==="lineEndingBlank")o[0]==="enter"&&(s&&(d.get(s)[1].type="lineEndingBlank"),o[1].type="lineEnding",s=i);else if(!(o[1].type==="linePrefix"||o[1].type==="listItemIndent"))break;s&&(r[1].end={...d.get(s)[1].start},l=d.slice(s,n),l.unshift(r),d.splice(s,n-s+1,l))}}return Na(t,0,Number.POSITIVE_INFINITY,d.slice(0)),!u}function vPe(t,e){const n=t.get(e)[1],r=t.get(e)[2];let s=e-1;const i=[];let o=n._tokenizer;o||(o=r.parser[n.contentType](n.start),n._contentTypeTextTrailing&&(o._contentTypeTextTrailing=!0));const l=o.events,c=[],u={};let d,h,f=-1,m=n,g=0,x=0;const w=[x];for(;m;){for(;t.get(++s)[1]!==m;);i.push(s),m._tokenizer||(d=r.sliceStream(m),m.next||d.push(null),h&&o.defineSkip(m.start),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=!0),o.write(d),m._isInFirstContentOfListItem&&(o._gfmTasklistFirstContentOfListItem=void 0)),h=m,m=m.next}for(m=n;++f<l.length;)l[f][0]==="exit"&&l[f-1][0]==="enter"&&l[f][1].type===l[f-1][1].type&&l[f][1].start.line!==l[f][1].end.line&&(x=f+1,w.push(x),m._tokenizer=void 0,m.previous=void 0,m=m.next);for(o.events=[],m?(m._tokenizer=void 0,m.previous=void 0):w.pop(),f=w.length;f--;){const v=l.slice(w[f],w[f+1]),_=i.pop();c.push([_,_+v.length-1]),t.splice(_,2,v)}for(c.reverse(),f=-1;++f<c.length;)u[g+c[f][0]]=g+c[f][1],g+=c[f][1]-c[f][0]-1;return u}const wPe={resolve:_Pe,tokenize:SPe},bPe={partial:!0,tokenize:CPe};function _Pe(t){return hq(t),t}function SPe(t,e){let n;return r;function r(l){return t.enter("content"),n=t.enter("chunkContent",{contentType:"content"}),s(l)}function s(l){return l===null?i(l):Gt(l)?t.check(bPe,o,i)(l):(t.consume(l),s)}function i(l){return t.exit("chunkContent"),t.exit("content"),e(l)}function o(l){return t.consume(l),t.exit("chunkContent"),n.next=t.enter("chunkContent",{contentType:"content",previous:n}),n=n.next,s}}function CPe(t,e,n){const r=this;return s;function s(o){return t.exit("chunkContent"),t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),Yn(t,i,"linePrefix")}function i(o){if(o===null||Gt(o))return n(o);const l=r.events[r.events.length-1];return!r.parser.constructs.disable.null.includes("codeIndented")&&l&&l[1].type==="linePrefix"&&l[2].sliceSerialize(l[1],!0).length>=4?e(o):t.interrupt(r.parser.constructs.flow,n,e)(o)}}function fq(t,e,n,r,s,i,o,l,c){const u=c||Number.POSITIVE_INFINITY;let d=0;return h;function h(v){return v===60?(t.enter(r),t.enter(s),t.enter(i),t.consume(v),t.exit(i),f):v===null||v===32||v===41||x1(v)?n(v):(t.enter(r),t.enter(o),t.enter(l),t.enter("chunkString",{contentType:"string"}),x(v))}function f(v){return v===62?(t.enter(i),t.consume(v),t.exit(i),t.exit(s),t.exit(r),e):(t.enter(l),t.enter("chunkString",{contentType:"string"}),m(v))}function m(v){return v===62?(t.exit("chunkString"),t.exit(l),f(v)):v===null||v===60||Gt(v)?n(v):(t.consume(v),v===92?g:m)}function g(v){return v===60||v===62||v===92?(t.consume(v),m):m(v)}function x(v){return!d&&(v===null||v===41||xi(v))?(t.exit("chunkString"),t.exit(l),t.exit(o),t.exit(r),e(v)):d<u&&v===40?(t.consume(v),d++,x):v===41?(t.consume(v),d--,x):v===null||v===32||v===40||x1(v)?n(v):(t.consume(v),v===92?w:x)}function w(v){return v===40||v===41||v===92?(t.consume(v),x):x(v)}}function mq(t,e,n,r,s,i){const o=this;let l=0,c;return u;function u(m){return t.enter(r),t.enter(s),t.consume(m),t.exit(s),t.enter(i),d}function d(m){return l>999||m===null||m===91||m===93&&!c||m===94&&!l&&"_hiddenFootnoteSupport"in o.parser.constructs?n(m):m===93?(t.exit(i),t.enter(s),t.consume(m),t.exit(s),t.exit(r),e):Gt(m)?(t.enter("lineEnding"),t.consume(m),t.exit("lineEnding"),d):(t.enter("chunkString",{contentType:"string"}),h(m))}function h(m){return m===null||m===91||m===93||Gt(m)||l++>999?(t.exit("chunkString"),d(m)):(t.consume(m),c||(c=!wn(m)),m===92?f:h)}function f(m){return m===91||m===92||m===93?(t.consume(m),l++,h):h(m)}}function pq(t,e,n,r,s,i){let o;return l;function l(f){return f===34||f===39||f===40?(t.enter(r),t.enter(s),t.consume(f),t.exit(s),o=f===40?41:f,c):n(f)}function c(f){return f===o?(t.enter(s),t.consume(f),t.exit(s),t.exit(r),e):(t.enter(i),u(f))}function u(f){return f===o?(t.exit(i),c(o)):f===null?n(f):Gt(f)?(t.enter("lineEnding"),t.consume(f),t.exit("lineEnding"),Yn(t,u,"linePrefix")):(t.enter("chunkString",{contentType:"string"}),d(f))}function d(f){return f===o||f===null||Gt(f)?(t.exit("chunkString"),u(f)):(t.consume(f),f===92?h:d)}function h(f){return f===o||f===92?(t.consume(f),d):d(f)}}function _p(t,e){let n;return r;function r(s){return Gt(s)?(t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),n=!0,r):wn(s)?Yn(t,r,n?"linePrefix":"lineSuffix")(s):e(s)}}const EPe={name:"definition",tokenize:IPe},TPe={partial:!0,tokenize:NPe};function IPe(t,e,n){const r=this;let s;return i;function i(m){return t.enter("definition"),o(m)}function o(m){return mq.call(r,t,l,n,"definitionLabel","definitionLabelMarker","definitionLabelString")(m)}function l(m){return s=Gh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)),m===58?(t.enter("definitionMarker"),t.consume(m),t.exit("definitionMarker"),c):n(m)}function c(m){return xi(m)?_p(t,u)(m):u(m)}function u(m){return fq(t,d,n,"definitionDestination","definitionDestinationLiteral","definitionDestinationLiteralMarker","definitionDestinationRaw","definitionDestinationString")(m)}function d(m){return t.attempt(TPe,h,h)(m)}function h(m){return wn(m)?Yn(t,f,"whitespace")(m):f(m)}function f(m){return m===null||Gt(m)?(t.exit("definition"),r.parser.defined.push(s),e(m)):n(m)}}function NPe(t,e,n){return r;function r(l){return xi(l)?_p(t,s)(l):n(l)}function s(l){return pq(t,i,n,"definitionTitle","definitionTitleMarker","definitionTitleString")(l)}function i(l){return wn(l)?Yn(t,o,"whitespace")(l):o(l)}function o(l){return l===null||Gt(l)?e(l):n(l)}}const PPe={name:"hardBreakEscape",tokenize:APe};function APe(t,e,n){return r;function r(i){return t.enter("hardBreakEscape"),t.consume(i),s}function s(i){return Gt(i)?(t.exit("hardBreakEscape"),e(i)):n(i)}}const kPe={name:"headingAtx",resolve:RPe,tokenize:jPe};function RPe(t,e){let n=t.length-2,r=3,s,i;return t[r][1].type==="whitespace"&&(r+=2),n-2>r&&t[n][1].type==="whitespace"&&(n-=2),t[n][1].type==="atxHeadingSequence"&&(r===n-1||n-4>r&&t[n-2][1].type==="whitespace")&&(n-=r+1===n?2:4),n>r&&(s={type:"atxHeadingText",start:t[r][1].start,end:t[n][1].end},i={type:"chunkText",start:t[r][1].start,end:t[n][1].end,contentType:"text"},Na(t,r,n-r+1,[["enter",s,e],["enter",i,e],["exit",i,e],["exit",s,e]])),t}function jPe(t,e,n){let r=0;return s;function s(d){return t.enter("atxHeading"),i(d)}function i(d){return t.enter("atxHeadingSequence"),o(d)}function o(d){return d===35&&r++<6?(t.consume(d),o):d===null||xi(d)?(t.exit("atxHeadingSequence"),l(d)):n(d)}function l(d){return d===35?(t.enter("atxHeadingSequence"),c(d)):d===null||Gt(d)?(t.exit("atxHeading"),e(d)):wn(d)?Yn(t,l,"whitespace")(d):(t.enter("atxHeadingText"),u(d))}function c(d){return d===35?(t.consume(d),c):(t.exit("atxHeadingSequence"),l(d))}function u(d){return d===null||d===35||xi(d)?(t.exit("atxHeadingText"),l(d)):(t.consume(d),u)}}const DPe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],$F=["pre","script","style","textarea"],MPe={concrete:!0,name:"htmlFlow",resolveTo:OPe,tokenize:$Pe},LPe={partial:!0,tokenize:UPe},FPe={partial:!0,tokenize:VPe};function OPe(t){let e=t.length;for(;e--&&!(t[e][0]==="enter"&&t[e][1].type==="htmlFlow"););return e>1&&t[e-2][1].type==="linePrefix"&&(t[e][1].start=t[e-2][1].start,t[e+1][1].start=t[e-2][1].start,t.splice(e-2,2)),t}function $Pe(t,e,n){const r=this;let s,i,o,l,c;return u;function u(L){return d(L)}function d(L){return t.enter("htmlFlow"),t.enter("htmlFlowData"),t.consume(L),h}function h(L){return L===33?(t.consume(L),f):L===47?(t.consume(L),i=!0,x):L===63?(t.consume(L),s=3,r.interrupt?e:O):la(L)?(t.consume(L),o=String.fromCharCode(L),w):n(L)}function f(L){return L===45?(t.consume(L),s=2,m):L===91?(t.consume(L),s=5,l=0,g):la(L)?(t.consume(L),s=4,r.interrupt?e:O):n(L)}function m(L){return L===45?(t.consume(L),r.interrupt?e:O):n(L)}function g(L){const ee="CDATA[";return L===ee.charCodeAt(l++)?(t.consume(L),l===ee.length?r.interrupt?e:j:g):n(L)}function x(L){return la(L)?(t.consume(L),o=String.fromCharCode(L),w):n(L)}function w(L){if(L===null||L===47||L===62||xi(L)){const ee=L===47,pe=o.toLowerCase();return!ee&&!i&&$F.includes(pe)?(s=1,r.interrupt?e(L):j(L)):DPe.includes(o.toLowerCase())?(s=6,ee?(t.consume(L),v):r.interrupt?e(L):j(L)):(s=7,r.interrupt&&!r.parser.lazy[r.now().line]?n(L):i?_(L):C(L))}return L===45||Hi(L)?(t.consume(L),o+=String.fromCharCode(L),w):n(L)}function v(L){return L===62?(t.consume(L),r.interrupt?e:j):n(L)}function _(L){return wn(L)?(t.consume(L),_):A(L)}function C(L){return L===47?(t.consume(L),A):L===58||L===95||la(L)?(t.consume(L),T):wn(L)?(t.consume(L),C):A(L)}function T(L){return L===45||L===46||L===58||L===95||Hi(L)?(t.consume(L),T):R(L)}function R(L){return L===61?(t.consume(L),k):wn(L)?(t.consume(L),R):C(L)}function k(L){return L===null||L===60||L===61||L===62||L===96?n(L):L===34||L===39?(t.consume(L),c=L,E):wn(L)?(t.consume(L),k):I(L)}function E(L){return L===c?(t.consume(L),c=null,P):L===null||Gt(L)?n(L):(t.consume(L),E)}function I(L){return L===null||L===34||L===39||L===47||L===60||L===61||L===62||L===96||xi(L)?R(L):(t.consume(L),I)}function P(L){return L===47||L===62||wn(L)?C(L):n(L)}function A(L){return L===62?(t.consume(L),D):n(L)}function D(L){return L===null||Gt(L)?j(L):wn(L)?(t.consume(L),D):n(L)}function j(L){return L===45&&s===2?(t.consume(L),K):L===60&&s===1?(t.consume(L),q):L===62&&s===4?(t.consume(L),V):L===63&&s===3?(t.consume(L),O):L===93&&s===5?(t.consume(L),te):Gt(L)&&(s===6||s===7)?(t.exit("htmlFlowData"),t.check(LPe,H,M)(L)):L===null||Gt(L)?(t.exit("htmlFlowData"),M(L)):(t.consume(L),j)}function M(L){return t.check(FPe,z,H)(L)}function z(L){return t.enter("lineEnding"),t.consume(L),t.exit("lineEnding"),U}function U(L){return L===null||Gt(L)?M(L):(t.enter("htmlFlowData"),j(L))}function K(L){return L===45?(t.consume(L),O):j(L)}function q(L){return L===47?(t.consume(L),o="",W):j(L)}function W(L){if(L===62){const ee=o.toLowerCase();return $F.includes(ee)?(t.consume(L),V):j(L)}return la(L)&&o.length<8?(t.consume(L),o+=String.fromCharCode(L),W):j(L)}function te(L){return L===93?(t.consume(L),O):j(L)}function O(L){return L===62?(t.consume(L),V):L===45&&s===2?(t.consume(L),O):j(L)}function V(L){return L===null||Gt(L)?(t.exit("htmlFlowData"),H(L)):(t.consume(L),V)}function H(L){return t.exit("htmlFlow"),e(L)}}function VPe(t,e,n){const r=this;return s;function s(o){return Gt(o)?(t.enter("lineEnding"),t.consume(o),t.exit("lineEnding"),i):n(o)}function i(o){return r.parser.lazy[r.now().line]?n(o):e(o)}}function UPe(t,e,n){return r;function r(s){return t.enter("lineEnding"),t.consume(s),t.exit("lineEnding"),t.attempt(m_,e,n)}}const BPe={name:"htmlText",tokenize:zPe};function zPe(t,e,n){const r=this;let s,i,o;return l;function l(O){return t.enter("htmlText"),t.enter("htmlTextData"),t.consume(O),c}function c(O){return O===33?(t.consume(O),u):O===47?(t.consume(O),R):O===63?(t.consume(O),C):la(O)?(t.consume(O),I):n(O)}function u(O){return O===45?(t.consume(O),d):O===91?(t.consume(O),i=0,g):la(O)?(t.consume(O),_):n(O)}function d(O){return O===45?(t.consume(O),m):n(O)}function h(O){return O===null?n(O):O===45?(t.consume(O),f):Gt(O)?(o=h,q(O)):(t.consume(O),h)}function f(O){return O===45?(t.consume(O),m):h(O)}function m(O){return O===62?K(O):O===45?f(O):h(O)}function g(O){const V="CDATA[";return O===V.charCodeAt(i++)?(t.consume(O),i===V.length?x:g):n(O)}function x(O){return O===null?n(O):O===93?(t.consume(O),w):Gt(O)?(o=x,q(O)):(t.consume(O),x)}function w(O){return O===93?(t.consume(O),v):x(O)}function v(O){return O===62?K(O):O===93?(t.consume(O),v):x(O)}function _(O){return O===null||O===62?K(O):Gt(O)?(o=_,q(O)):(t.consume(O),_)}function C(O){return O===null?n(O):O===63?(t.consume(O),T):Gt(O)?(o=C,q(O)):(t.consume(O),C)}function T(O){return O===62?K(O):C(O)}function R(O){return la(O)?(t.consume(O),k):n(O)}function k(O){return O===45||Hi(O)?(t.consume(O),k):E(O)}function E(O){return Gt(O)?(o=E,q(O)):wn(O)?(t.consume(O),E):K(O)}function I(O){return O===45||Hi(O)?(t.consume(O),I):O===47||O===62||xi(O)?P(O):n(O)}function P(O){return O===47?(t.consume(O),K):O===58||O===95||la(O)?(t.consume(O),A):Gt(O)?(o=P,q(O)):wn(O)?(t.consume(O),P):K(O)}function A(O){return O===45||O===46||O===58||O===95||Hi(O)?(t.consume(O),A):D(O)}function D(O){return O===61?(t.consume(O),j):Gt(O)?(o=D,q(O)):wn(O)?(t.consume(O),D):P(O)}function j(O){return O===null||O===60||O===61||O===62||O===96?n(O):O===34||O===39?(t.consume(O),s=O,M):Gt(O)?(o=j,q(O)):wn(O)?(t.consume(O),j):(t.consume(O),z)}function M(O){return O===s?(t.consume(O),s=void 0,U):O===null?n(O):Gt(O)?(o=M,q(O)):(t.consume(O),M)}function z(O){return O===null||O===34||O===39||O===60||O===61||O===96?n(O):O===47||O===62||xi(O)?P(O):(t.consume(O),z)}function U(O){return O===47||O===62||xi(O)?P(O):n(O)}function K(O){return O===62?(t.consume(O),t.exit("htmlTextData"),t.exit("htmlText"),e):n(O)}function q(O){return t.exit("htmlTextData"),t.enter("lineEnding"),t.consume(O),t.exit("lineEnding"),W}function W(O){return wn(O)?Yn(t,te,"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(O):te(O)}function te(O){return t.enter("htmlTextData"),o(O)}}const pk={name:"labelEnd",resolveAll:qPe,resolveTo:KPe,tokenize:YPe},GPe={tokenize:JPe},WPe={tokenize:XPe},HPe={tokenize:QPe};function qPe(t){let e=-1;const n=[];for(;++e<t.length;){const r=t[e][1];if(n.push(t[e]),r.type==="labelImage"||r.type==="labelLink"||r.type==="labelEnd"){const s=r.type==="labelImage"?4:2;r.type="data",e+=s}}return t.length!==n.length&&Na(t,0,t.length,n),t}function KPe(t,e){let n=t.length,r=0,s,i,o,l;for(;n--;)if(s=t[n][1],i){if(s.type==="link"||s.type==="labelLink"&&s._inactive)break;t[n][0]==="enter"&&s.type==="labelLink"&&(s._inactive=!0)}else if(o){if(t[n][0]==="enter"&&(s.type==="labelImage"||s.type==="labelLink")&&!s._balanced&&(i=n,s.type!=="labelLink")){r=2;break}}else s.type==="labelEnd"&&(o=n);const c={type:t[i][1].type==="labelLink"?"link":"image",start:{...t[i][1].start},end:{...t[t.length-1][1].end}},u={type:"label",start:{...t[i][1].start},end:{...t[o][1].end}},d={type:"labelText",start:{...t[i+r+2][1].end},end:{...t[o-2][1].start}};return l=[["enter",c,e],["enter",u,e]],l=ao(l,t.slice(i+1,i+r+3)),l=ao(l,[["enter",d,e]]),l=ao(l,mk(e.parser.constructs.insideSpan.null,t.slice(i+r+4,o-3),e)),l=ao(l,[["exit",d,e],t[o-2],t[o-1],["exit",u,e]]),l=ao(l,t.slice(o+1)),l=ao(l,[["exit",c,e]]),Na(t,i,t.length,l),t}function YPe(t,e,n){const r=this;let s=r.events.length,i,o;for(;s--;)if((r.events[s][1].type==="labelImage"||r.events[s][1].type==="labelLink")&&!r.events[s][1]._balanced){i=r.events[s][1];break}return l;function l(f){return i?i._inactive?h(f):(o=r.parser.defined.includes(Gh(r.sliceSerialize({start:i.end,end:r.now()}))),t.enter("labelEnd"),t.enter("labelMarker"),t.consume(f),t.exit("labelMarker"),t.exit("labelEnd"),c):n(f)}function c(f){return f===40?t.attempt(GPe,d,o?d:h)(f):f===91?t.attempt(WPe,d,o?u:h)(f):o?d(f):h(f)}function u(f){return t.attempt(HPe,d,h)(f)}function d(f){return e(f)}function h(f){return i._balanced=!0,n(f)}}function JPe(t,e,n){return r;function r(h){return t.enter("resource"),t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),s}function s(h){return xi(h)?_p(t,i)(h):i(h)}function i(h){return h===41?d(h):fq(t,o,l,"resourceDestination","resourceDestinationLiteral","resourceDestinationLiteralMarker","resourceDestinationRaw","resourceDestinationString",32)(h)}function o(h){return xi(h)?_p(t,c)(h):d(h)}function l(h){return n(h)}function c(h){return h===34||h===39||h===40?pq(t,u,n,"resourceTitle","resourceTitleMarker","resourceTitleString")(h):d(h)}function u(h){return xi(h)?_p(t,d)(h):d(h)}function d(h){return h===41?(t.enter("resourceMarker"),t.consume(h),t.exit("resourceMarker"),t.exit("resource"),e):n(h)}}function XPe(t,e,n){const r=this;return s;function s(l){return mq.call(r,t,i,o,"reference","referenceMarker","referenceString")(l)}function i(l){return r.parser.defined.includes(Gh(r.sliceSerialize(r.events[r.events.length-1][1]).slice(1,-1)))?e(l):n(l)}function o(l){return n(l)}}function QPe(t,e,n){return r;function r(i){return t.enter("reference"),t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),s}function s(i){return i===93?(t.enter("referenceMarker"),t.consume(i),t.exit("referenceMarker"),t.exit("reference"),e):n(i)}}const ZPe={name:"labelStartImage",resolveAll:pk.resolveAll,tokenize:eAe};function eAe(t,e,n){const r=this;return s;function s(l){return t.enter("labelImage"),t.enter("labelImageMarker"),t.consume(l),t.exit("labelImageMarker"),i}function i(l){return l===91?(t.enter("labelMarker"),t.consume(l),t.exit("labelMarker"),t.exit("labelImage"),o):n(l)}function o(l){return l===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(l):e(l)}}const tAe={name:"labelStartLink",resolveAll:pk.resolveAll,tokenize:nAe};function nAe(t,e,n){const r=this;return s;function s(o){return t.enter("labelLink"),t.enter("labelMarker"),t.consume(o),t.exit("labelMarker"),t.exit("labelLink"),i}function i(o){return o===94&&"_hiddenFootnoteSupport"in r.parser.constructs?n(o):e(o)}}const cC={name:"lineEnding",tokenize:rAe};function rAe(t,e){return n;function n(r){return t.enter("lineEnding"),t.consume(r),t.exit("lineEnding"),Yn(t,e,"linePrefix")}}const wv={name:"thematicBreak",tokenize:sAe};function sAe(t,e,n){let r=0,s;return i;function i(u){return t.enter("thematicBreak"),o(u)}function o(u){return s=u,l(u)}function l(u){return u===s?(t.enter("thematicBreakSequence"),c(u)):r>=3&&(u===null||Gt(u))?(t.exit("thematicBreak"),e(u)):n(u)}function c(u){return u===s?(t.consume(u),r++,c):(t.exit("thematicBreakSequence"),wn(u)?Yn(t,l,"whitespace")(u):l(u))}}const ai={continuation:{tokenize:lAe},exit:uAe,name:"list",tokenize:aAe},iAe={partial:!0,tokenize:dAe},oAe={partial:!0,tokenize:cAe};function aAe(t,e,n){const r=this,s=r.events[r.events.length-1];let i=s&&s[1].type==="linePrefix"?s[2].sliceSerialize(s[1],!0).length:0,o=0;return l;function l(m){const g=r.containerState.type||(m===42||m===43||m===45?"listUnordered":"listOrdered");if(g==="listUnordered"?!r.containerState.marker||m===r.containerState.marker:v1(m)){if(r.containerState.type||(r.containerState.type=g,t.enter(g,{_container:!0})),g==="listUnordered")return t.enter("listItemPrefix"),m===42||m===45?t.check(wv,n,u)(m):u(m);if(!r.interrupt||m===49)return t.enter("listItemPrefix"),t.enter("listItemValue"),c(m)}return n(m)}function c(m){return v1(m)&&++o<10?(t.consume(m),c):(!r.interrupt||o<2)&&(r.containerState.marker?m===r.containerState.marker:m===41||m===46)?(t.exit("listItemValue"),u(m)):n(m)}function u(m){return t.enter("listItemMarker"),t.consume(m),t.exit("listItemMarker"),r.containerState.marker=r.containerState.marker||m,t.check(m_,r.interrupt?n:d,t.attempt(iAe,f,h))}function d(m){return r.containerState.initialBlankLine=!0,i++,f(m)}function h(m){return wn(m)?(t.enter("listItemPrefixWhitespace"),t.consume(m),t.exit("listItemPrefixWhitespace"),f):n(m)}function f(m){return r.containerState.size=i+r.sliceSerialize(t.exit("listItemPrefix"),!0).length,e(m)}}function lAe(t,e,n){const r=this;return r.containerState._closeFlow=void 0,t.check(m_,s,i);function s(l){return r.containerState.furtherBlankLines=r.containerState.furtherBlankLines||r.containerState.initialBlankLine,Yn(t,e,"listItemIndent",r.containerState.size+1)(l)}function i(l){return r.containerState.furtherBlankLines||!wn(l)?(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,o(l)):(r.containerState.furtherBlankLines=void 0,r.containerState.initialBlankLine=void 0,t.attempt(oAe,e,o)(l))}function o(l){return r.containerState._closeFlow=!0,r.interrupt=void 0,Yn(t,t.attempt(ai,e,n),"linePrefix",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4)(l)}}function cAe(t,e,n){const r=this;return Yn(t,s,"listItemIndent",r.containerState.size+1);function s(i){const o=r.events[r.events.length-1];return o&&o[1].type==="listItemIndent"&&o[2].sliceSerialize(o[1],!0).length===r.containerState.size?e(i):n(i)}}function uAe(t){t.exit(this.containerState.type)}function dAe(t,e,n){const r=this;return Yn(t,s,"listItemPrefixWhitespace",r.parser.constructs.disable.null.includes("codeIndented")?void 0:4+1);function s(i){const o=r.events[r.events.length-1];return!wn(i)&&o&&o[1].type==="listItemPrefixWhitespace"?e(i):n(i)}}const VF={name:"setextUnderline",resolveTo:hAe,tokenize:fAe};function hAe(t,e){let n=t.length,r,s,i;for(;n--;)if(t[n][0]==="enter"){if(t[n][1].type==="content"){r=n;break}t[n][1].type==="paragraph"&&(s=n)}else t[n][1].type==="content"&&t.splice(n,1),!i&&t[n][1].type==="definition"&&(i=n);const o={type:"setextHeading",start:{...t[r][1].start},end:{...t[t.length-1][1].end}};return t[s][1].type="setextHeadingText",i?(t.splice(s,0,["enter",o,e]),t.splice(i+1,0,["exit",t[r][1],e]),t[r][1].end={...t[i][1].end}):t[r][1]=o,t.push(["exit",o,e]),t}function fAe(t,e,n){const r=this;let s;return i;function i(u){let d=r.events.length,h;for(;d--;)if(r.events[d][1].type!=="lineEnding"&&r.events[d][1].type!=="linePrefix"&&r.events[d][1].type!=="content"){h=r.events[d][1].type==="paragraph";break}return!r.parser.lazy[r.now().line]&&(r.interrupt||h)?(t.enter("setextHeadingLine"),s=u,o(u)):n(u)}function o(u){return t.enter("setextHeadingLineSequence"),l(u)}function l(u){return u===s?(t.consume(u),l):(t.exit("setextHeadingLineSequence"),wn(u)?Yn(t,c,"lineSuffix")(u):c(u))}function c(u){return u===null||Gt(u)?(t.exit("setextHeadingLine"),e(u)):n(u)}}const mAe={tokenize:pAe};function pAe(t){const e=this,n=t.attempt(m_,r,t.attempt(this.parser.constructs.flowInitial,s,Yn(t,t.attempt(this.parser.constructs.flow,s,t.attempt(wPe,s)),"linePrefix")));return n;function r(i){if(i===null){t.consume(i);return}return t.enter("lineEndingBlank"),t.consume(i),t.exit("lineEndingBlank"),e.currentConstruct=void 0,n}function s(i){if(i===null){t.consume(i);return}return t.enter("lineEnding"),t.consume(i),t.exit("lineEnding"),e.currentConstruct=void 0,n}}const gAe={resolveAll:yq()},yAe=gq("string"),xAe=gq("text");function gq(t){return{resolveAll:yq(t==="text"?vAe:void 0),tokenize:e};function e(n){const r=this,s=this.parser.constructs[t],i=n.attempt(s,o,l);return o;function o(d){return u(d)?i(d):l(d)}function l(d){if(d===null){n.consume(d);return}return n.enter("data"),n.consume(d),c}function c(d){return u(d)?(n.exit("data"),i(d)):(n.consume(d),c)}function u(d){if(d===null)return!0;const h=s[d];let f=-1;if(h)for(;++f<h.length;){const m=h[f];if(!m.previous||m.previous.call(r,r.previous))return!0}return!1}}}function yq(t){return e;function e(n,r){let s=-1,i;for(;++s<=n.length;)i===void 0?n[s]&&n[s][1].type==="data"&&(i=s,s++):(!n[s]||n[s][1].type!=="data")&&(s!==i+2&&(n[i][1].end=n[s-1][1].end,n.splice(i+2,s-i-2),s=i+2),i=void 0);return t?t(n,r):n}}function vAe(t,e){let n=0;for(;++n<=t.length;)if((n===t.length||t[n][1].type==="lineEnding")&&t[n-1][1].type==="data"){const r=t[n-1][1],s=e.sliceStream(r);let i=s.length,o=-1,l=0,c;for(;i--;){const u=s[i];if(typeof u=="string"){for(o=u.length;u.charCodeAt(o-1)===32;)l++,o--;if(o)break;o=-1}else if(u===-2)c=!0,l++;else if(u!==-1){i++;break}}if(e._contentTypeTextTrailing&&n===t.length&&(l=0),l){const u={type:n===t.length||c||l<2?"lineSuffix":"hardBreakTrailing",start:{_bufferIndex:i?o:r.start._bufferIndex+o,_index:r.start._index+i,line:r.end.line,column:r.end.column-l,offset:r.end.offset-l},end:{...r.end}};r.end={...u.start},r.start.offset===r.end.offset?Object.assign(r,u):(t.splice(n,0,["enter",u,e],["exit",u,e]),n+=2)}n++}return t}const wAe={42:ai,43:ai,45:ai,48:ai,49:ai,50:ai,51:ai,52:ai,53:ai,54:ai,55:ai,56:ai,57:ai,62:cq},bAe={91:EPe},_Ae={[-2]:lC,[-1]:lC,32:lC},SAe={35:kPe,42:wv,45:[VF,wv],60:MPe,61:VF,95:wv,96:OF,126:OF},CAe={38:dq,92:uq},EAe={[-5]:cC,[-4]:cC,[-3]:cC,33:ZPe,38:dq,42:w1,60:[tPe,BPe],91:tAe,92:[PPe,uq],93:pk,95:w1,96:mPe},TAe={null:[w1,gAe]},IAe={null:[42,95]},NAe={null:[]},PAe=Object.freeze(Object.defineProperty({__proto__:null,attentionMarkers:IAe,contentInitial:bAe,disable:NAe,document:wAe,flow:SAe,flowInitial:_Ae,insideSpan:TAe,string:CAe,text:EAe},Symbol.toStringTag,{value:"Module"}));function AAe(t,e,n){let r={_bufferIndex:-1,_index:0,line:n&&n.line||1,column:n&&n.column||1,offset:n&&n.offset||0};const s={},i=[];let o=[],l=[];const c={attempt:E(R),check:E(k),consume:_,enter:C,exit:T,interrupt:E(k,{interrupt:!0})},u={code:null,containerState:{},defineSkip:x,events:[],now:g,parser:t,previous:null,sliceSerialize:f,sliceStream:m,write:h};let d=e.tokenize.call(u,c);return e.resolveAll&&i.push(e),u;function h(D){return o=ao(o,D),w(),o[o.length-1]!==null?[]:(I(e,0),u.events=mk(i,u.events,u),u.events)}function f(D,j){return RAe(m(D),j)}function m(D){return kAe(o,D)}function g(){const{_bufferIndex:D,_index:j,line:M,column:z,offset:U}=r;return{_bufferIndex:D,_index:j,line:M,column:z,offset:U}}function x(D){s[D.line]=D.column,A()}function w(){let D;for(;r._index<o.length;){const j=o[r._index];if(typeof j=="string")for(D=r._index,r._bufferIndex<0&&(r._bufferIndex=0);r._index===D&&r._bufferIndex<j.length;)v(j.charCodeAt(r._bufferIndex));else v(j)}}function v(D){d=d(D)}function _(D){Gt(D)?(r.line++,r.column=1,r.offset+=D===-3?2:1,A()):D!==-1&&(r.column++,r.offset++),r._bufferIndex<0?r._index++:(r._bufferIndex++,r._bufferIndex===o[r._index].length&&(r._bufferIndex=-1,r._index++)),u.previous=D}function C(D,j){const M=j||{};return M.type=D,M.start=g(),u.events.push(["enter",M,u]),l.push(M),M}function T(D){const j=l.pop();return j.end=g(),u.events.push(["exit",j,u]),j}function R(D,j){I(D,j.from)}function k(D,j){j.restore()}function E(D,j){return M;function M(z,U,K){let q,W,te,O;return Array.isArray(z)?H(z):"tokenize"in z?H([z]):V(z);function V(xe){return we;function we(Ie){const Fe=Ie!==null&&xe[Ie],Ve=Ie!==null&&xe.null,Ge=[...Array.isArray(Fe)?Fe:Fe?[Fe]:[],...Array.isArray(Ve)?Ve:Ve?[Ve]:[]];return H(Ge)(Ie)}}function H(xe){return q=xe,W=0,xe.length===0?K:L(xe[W])}function L(xe){return we;function we(Ie){return O=P(),te=xe,xe.partial||(u.currentConstruct=xe),xe.name&&u.parser.constructs.disable.null.includes(xe.name)?pe():xe.tokenize.call(j?Object.assign(Object.create(u),j):u,c,ee,pe)(Ie)}}function ee(xe){return D(te,O),U}function pe(xe){return O.restore(),++W<q.length?L(q[W]):K}}}function I(D,j){D.resolveAll&&!i.includes(D)&&i.push(D),D.resolve&&Na(u.events,j,u.events.length-j,D.resolve(u.events.slice(j),u)),D.resolveTo&&(u.events=D.resolveTo(u.events,u))}function P(){const D=g(),j=u.previous,M=u.currentConstruct,z=u.events.length,U=Array.from(l);return{from:z,restore:K};function K(){r=D,u.previous=j,u.currentConstruct=M,u.events.length=z,l=U,A()}}function A(){r.line in s&&r.column<2&&(r.column=s[r.line],r.offset+=s[r.line]-1)}}function kAe(t,e){const n=e.start._index,r=e.start._bufferIndex,s=e.end._index,i=e.end._bufferIndex;let o;if(n===s)o=[t[n].slice(r,i)];else{if(o=t.slice(n,s),r>-1){const l=o[0];typeof l=="string"?o[0]=l.slice(r):o.shift()}i>0&&o.push(t[s].slice(0,i))}return o}function RAe(t,e){let n=-1;const r=[];let s;for(;++n<t.length;){const i=t[n];let o;if(typeof i=="string")o=i;else switch(i){case-5:{o="\r";break}case-4:{o=`
`;break}case-3:{o=`\r
`;break}case-2:{o=e?" ":"	";break}case-1:{if(!e&&s)continue;o=" ";break}default:o=String.fromCharCode(i)}s=i===-2,r.push(o)}return r.join("")}function jAe(t){const r={constructs:VNe([PAe,...(t||{}).extensions||[]]),content:s(KNe),defined:[],document:s(JNe),flow:s(mAe),lazy:{},string:s(yAe),text:s(xAe)};return r;function s(i){return o;function o(l){return AAe(r,i,l)}}}function DAe(t){for(;!hq(t););return t}const UF=/[\0\t\n\r]/g;function MAe(){let t=1,e="",n=!0,r;return s;function s(i,o,l){const c=[];let u,d,h,f,m;for(i=e+(typeof i=="string"?i.toString():new TextDecoder(o||void 0).decode(i)),h=0,e="",n&&(i.charCodeAt(0)===65279&&h++,n=void 0);h<i.length;){if(UF.lastIndex=h,u=UF.exec(i),f=u&&u.index!==void 0?u.index:i.length,m=i.charCodeAt(f),!u){e=i.slice(h);break}if(m===10&&h===f&&r)c.push(-3),r=void 0;else switch(r&&(c.push(-5),r=void 0),h<f&&(c.push(i.slice(h,f)),t+=f-h),m){case 0:{c.push(65533),t++;break}case 9:{for(d=Math.ceil(t/4)*4,c.push(-2);t++<d;)c.push(-1);break}case 10:{c.push(-4),t=1;break}default:r=!0,t=1}h=f+1}return l&&(r&&c.push(-5),e&&c.push(e),c.push(null)),c}}const LAe=/\\([!-/:-@[-`{-~])|&(#(?:\d{1,7}|x[\da-f]{1,6})|[\da-z]{1,31});/gi;function FAe(t){return t.replace(LAe,OAe)}function OAe(t,e,n){if(e)return e;if(n.charCodeAt(0)===35){const s=n.charCodeAt(1),i=s===120||s===88;return lq(n.slice(i?2:1),i?16:10)}return fk(n)||t}const xq={}.hasOwnProperty;function $Ae(t,e,n){return typeof e!="string"&&(n=e,e=void 0),VAe(n)(DAe(jAe(n).document().write(MAe()(t,e,!0))))}function VAe(t){const e={transforms:[],canContainEols:["emphasis","fragment","heading","paragraph","strong"],enter:{autolink:i(ct),autolinkProtocol:P,autolinkEmail:P,atxHeading:i($e),blockQuote:i(Ve),characterEscape:P,characterReference:P,codeFenced:i(Ge),codeFencedFenceInfo:o,codeFencedFenceMeta:o,codeIndented:i(Ge,o),codeText:i(fe,o),codeTextData:P,data:P,codeFlowValue:P,definition:i(je),definitionDestinationString:o,definitionLabelString:o,definitionTitleString:o,emphasis:i(ie),hardBreakEscape:i(me),hardBreakTrailing:i(me),htmlFlow:i(Ue,o),htmlFlowData:P,htmlText:i(Ue,o),htmlTextData:P,image:i(et),label:o,link:i(ct),listItem:i(Sn),listItemValue:f,listOrdered:i(Mt,h),listUnordered:i(Mt),paragraph:i(en),reference:L,referenceString:o,resourceDestinationString:o,resourceTitleString:o,setextHeading:i($e),strong:i(rn),thematicBreak:i(xn)},exit:{atxHeading:c(),atxHeadingSequence:R,autolink:c(),autolinkEmail:Fe,autolinkProtocol:Ie,blockQuote:c(),characterEscapeValue:A,characterReferenceMarkerHexadecimal:pe,characterReferenceMarkerNumeric:pe,characterReferenceValue:xe,characterReference:we,codeFenced:c(w),codeFencedFence:x,codeFencedFenceInfo:m,codeFencedFenceMeta:g,codeFlowValue:A,codeIndented:c(v),codeText:c(U),codeTextData:A,data:A,definition:c(),definitionDestinationString:T,definitionLabelString:_,definitionTitleString:C,emphasis:c(),hardBreakEscape:c(j),hardBreakTrailing:c(j),htmlFlow:c(M),htmlFlowData:A,htmlText:c(z),htmlTextData:A,image:c(q),label:te,labelText:W,lineEnding:D,link:c(K),listItem:c(),listOrdered:c(),listUnordered:c(),paragraph:c(),referenceString:ee,resourceDestinationString:O,resourceTitleString:V,resource:H,setextHeading:c(I),setextHeadingLineSequence:E,setextHeadingText:k,strong:c(),thematicBreak:c()}};vq(e,(t||{}).mdastExtensions||[]);const n={};return r;function r(re){let Se={type:"root",children:[]};const B={stack:[Se],tokenStack:[],config:e,enter:l,exit:u,buffer:o,resume:d,data:n},X=[];let ne=-1;for(;++ne<re.length;)if(re[ne][1].type==="listOrdered"||re[ne][1].type==="listUnordered")if(re[ne][0]==="enter")X.push(ne);else{const Y=X.pop();ne=s(re,Y,ne)}for(ne=-1;++ne<re.length;){const Y=e[re[ne][0]];xq.call(Y,re[ne][1].type)&&Y[re[ne][1].type].call(Object.assign({sliceSerialize:re[ne][2].sliceSerialize},B),re[ne][1])}if(B.tokenStack.length>0){const Y=B.tokenStack[B.tokenStack.length-1];(Y[1]||BF).call(B,void 0,Y[0])}for(Se.position={start:jl(re.length>0?re[0][1].start:{line:1,column:1,offset:0}),end:jl(re.length>0?re[re.length-2][1].end:{line:1,column:1,offset:0})},ne=-1;++ne<e.transforms.length;)Se=e.transforms[ne](Se)||Se;return Se}function s(re,Se,B){let X=Se-1,ne=-1,Y=!1,Ne,ce,Ee,Re;for(;++X<=B;){const Be=re[X];switch(Be[1].type){case"listUnordered":case"listOrdered":case"blockQuote":{Be[0]==="enter"?ne++:ne--,Re=void 0;break}case"lineEndingBlank":{Be[0]==="enter"&&(Ne&&!Re&&!ne&&!Ee&&(Ee=X),Re=void 0);break}case"linePrefix":case"listItemValue":case"listItemMarker":case"listItemPrefix":case"listItemPrefixWhitespace":break;default:Re=void 0}if(!ne&&Be[0]==="enter"&&Be[1].type==="listItemPrefix"||ne===-1&&Be[0]==="exit"&&(Be[1].type==="listUnordered"||Be[1].type==="listOrdered")){if(Ne){let _t=X;for(ce=void 0;_t--;){const mt=re[_t];if(mt[1].type==="lineEnding"||mt[1].type==="lineEndingBlank"){if(mt[0]==="exit")continue;ce&&(re[ce][1].type="lineEndingBlank",Y=!0),mt[1].type="lineEnding",ce=_t}else if(!(mt[1].type==="linePrefix"||mt[1].type==="blockQuotePrefix"||mt[1].type==="blockQuotePrefixWhitespace"||mt[1].type==="blockQuoteMarker"||mt[1].type==="listItemIndent"))break}Ee&&(!ce||Ee<ce)&&(Ne._spread=!0),Ne.end=Object.assign({},ce?re[ce][1].start:Be[1].end),re.splice(ce||X,0,["exit",Ne,Be[2]]),X++,B++}if(Be[1].type==="listItemPrefix"){const _t={type:"listItem",_spread:!1,start:Object.assign({},Be[1].start),end:void 0};Ne=_t,re.splice(X,0,["enter",_t,Be[2]]),X++,B++,Ee=void 0,Re=!0}}}return re[Se][1]._spread=Y,B}function i(re,Se){return B;function B(X){l.call(this,re(X),X),Se&&Se.call(this,X)}}function o(){this.stack.push({type:"fragment",children:[]})}function l(re,Se,B){this.stack[this.stack.length-1].children.push(re),this.stack.push(re),this.tokenStack.push([Se,B||void 0]),re.position={start:jl(Se.start),end:void 0}}function c(re){return Se;function Se(B){re&&re.call(this,B),u.call(this,B)}}function u(re,Se){const B=this.stack.pop(),X=this.tokenStack.pop();if(X)X[0].type!==re.type&&(Se?Se.call(this,re,X[0]):(X[1]||BF).call(this,re,X[0]));else throw new Error("Cannot close `"+re.type+"` ("+bp({start:re.start,end:re.end})+"): it’s not open");B.position.end=jl(re.end)}function d(){return ONe(this.stack.pop())}function h(){this.data.expectingFirstListItemValue=!0}function f(re){if(this.data.expectingFirstListItemValue){const Se=this.stack[this.stack.length-2];Se.start=Number.parseInt(this.sliceSerialize(re),10),this.data.expectingFirstListItemValue=void 0}}function m(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.lang=re}function g(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.meta=re}function x(){this.data.flowCodeInside||(this.buffer(),this.data.flowCodeInside=!0)}function w(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.value=re.replace(/^(\r?\n|\r)|(\r?\n|\r)$/g,""),this.data.flowCodeInside=void 0}function v(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.value=re.replace(/(\r?\n|\r)$/g,"")}function _(re){const Se=this.resume(),B=this.stack[this.stack.length-1];B.label=Se,B.identifier=Gh(this.sliceSerialize(re)).toLowerCase()}function C(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.title=re}function T(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.url=re}function R(re){const Se=this.stack[this.stack.length-1];if(!Se.depth){const B=this.sliceSerialize(re).length;Se.depth=B}}function k(){this.data.setextHeadingSlurpLineEnding=!0}function E(re){const Se=this.stack[this.stack.length-1];Se.depth=this.sliceSerialize(re).codePointAt(0)===61?1:2}function I(){this.data.setextHeadingSlurpLineEnding=void 0}function P(re){const B=this.stack[this.stack.length-1].children;let X=B[B.length-1];(!X||X.type!=="text")&&(X=kt(),X.position={start:jl(re.start),end:void 0},B.push(X)),this.stack.push(X)}function A(re){const Se=this.stack.pop();Se.value+=this.sliceSerialize(re),Se.position.end=jl(re.end)}function D(re){const Se=this.stack[this.stack.length-1];if(this.data.atHardBreak){const B=Se.children[Se.children.length-1];B.position.end=jl(re.end),this.data.atHardBreak=void 0;return}!this.data.setextHeadingSlurpLineEnding&&e.canContainEols.includes(Se.type)&&(P.call(this,re),A.call(this,re))}function j(){this.data.atHardBreak=!0}function M(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.value=re}function z(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.value=re}function U(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.value=re}function K(){const re=this.stack[this.stack.length-1];if(this.data.inReference){const Se=this.data.referenceType||"shortcut";re.type+="Reference",re.referenceType=Se,delete re.url,delete re.title}else delete re.identifier,delete re.label;this.data.referenceType=void 0}function q(){const re=this.stack[this.stack.length-1];if(this.data.inReference){const Se=this.data.referenceType||"shortcut";re.type+="Reference",re.referenceType=Se,delete re.url,delete re.title}else delete re.identifier,delete re.label;this.data.referenceType=void 0}function W(re){const Se=this.sliceSerialize(re),B=this.stack[this.stack.length-2];B.label=FAe(Se),B.identifier=Gh(Se).toLowerCase()}function te(){const re=this.stack[this.stack.length-1],Se=this.resume(),B=this.stack[this.stack.length-1];if(this.data.inReference=!0,B.type==="link"){const X=re.children;B.children=X}else B.alt=Se}function O(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.url=re}function V(){const re=this.resume(),Se=this.stack[this.stack.length-1];Se.title=re}function H(){this.data.inReference=void 0}function L(){this.data.referenceType="collapsed"}function ee(re){const Se=this.resume(),B=this.stack[this.stack.length-1];B.label=Se,B.identifier=Gh(this.sliceSerialize(re)).toLowerCase(),this.data.referenceType="full"}function pe(re){this.data.characterReferenceType=re.type}function xe(re){const Se=this.sliceSerialize(re),B=this.data.characterReferenceType;let X;B?(X=lq(Se,B==="characterReferenceMarkerNumeric"?10:16),this.data.characterReferenceType=void 0):X=fk(Se);const ne=this.stack[this.stack.length-1];ne.value+=X}function we(re){const Se=this.stack.pop();Se.position.end=jl(re.end)}function Ie(re){A.call(this,re);const Se=this.stack[this.stack.length-1];Se.url=this.sliceSerialize(re)}function Fe(re){A.call(this,re);const Se=this.stack[this.stack.length-1];Se.url="mailto:"+this.sliceSerialize(re)}function Ve(){return{type:"blockquote",children:[]}}function Ge(){return{type:"code",lang:null,meta:null,value:""}}function fe(){return{type:"inlineCode",value:""}}function je(){return{type:"definition",identifier:"",label:null,title:null,url:""}}function ie(){return{type:"emphasis",children:[]}}function $e(){return{type:"heading",depth:0,children:[]}}function me(){return{type:"break"}}function Ue(){return{type:"html",value:""}}function et(){return{type:"image",title:null,url:"",alt:null}}function ct(){return{type:"link",title:null,url:"",children:[]}}function Mt(re){return{type:"list",ordered:re.type==="listOrdered",start:null,spread:re._spread,children:[]}}function Sn(re){return{type:"listItem",spread:re._spread,checked:null,children:[]}}function en(){return{type:"paragraph",children:[]}}function rn(){return{type:"strong",children:[]}}function kt(){return{type:"text",value:""}}function xn(){return{type:"thematicBreak"}}}function jl(t){return{line:t.line,column:t.column,offset:t.offset}}function vq(t,e){let n=-1;for(;++n<e.length;){const r=e[n];Array.isArray(r)?vq(t,r):UAe(t,r)}}function UAe(t,e){let n;for(n in e)if(xq.call(e,n))switch(n){case"canContainEols":{const r=e[n];r&&t[n].push(...r);break}case"transforms":{const r=e[n];r&&t[n].push(...r);break}case"enter":case"exit":{const r=e[n];r&&Object.assign(t[n],r);break}}}function BF(t,e){throw t?new Error("Cannot close `"+t.type+"` ("+bp({start:t.start,end:t.end})+"): a different token (`"+e.type+"`, "+bp({start:e.start,end:e.end})+") is open"):new Error("Cannot close document, a token (`"+e.type+"`, "+bp({start:e.start,end:e.end})+") is still open")}function BAe(t){const e=this;e.parser=n;function n(r){return $Ae(r,{...e.data("settings"),...t,extensions:e.data("micromarkExtensions")||[],mdastExtensions:e.data("fromMarkdownExtensions")||[]})}}function zAe(t,e){const n={type:"element",tagName:"blockquote",properties:{},children:t.wrap(t.all(e),!0)};return t.patch(e,n),t.applyData(e,n)}function GAe(t,e){const n={type:"element",tagName:"br",properties:{},children:[]};return t.patch(e,n),[t.applyData(e,n),{type:"text",value:`
`}]}function WAe(t,e){const n=e.value?e.value+`
`:"",r={};e.lang&&(r.className=["language-"+e.lang]);let s={type:"element",tagName:"code",properties:r,children:[{type:"text",value:n}]};return e.meta&&(s.data={meta:e.meta}),t.patch(e,s),s=t.applyData(e,s),s={type:"element",tagName:"pre",properties:{},children:[s]},t.patch(e,s),s}function HAe(t,e){const n={type:"element",tagName:"del",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function qAe(t,e){const n={type:"element",tagName:"em",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function KAe(t,e){const n=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",r=String(e.identifier).toUpperCase(),s=Gf(r.toLowerCase()),i=t.footnoteOrder.indexOf(r);let o,l=t.footnoteCounts.get(r);l===void 0?(l=0,t.footnoteOrder.push(r),o=t.footnoteOrder.length):o=i+1,l+=1,t.footnoteCounts.set(r,l);const c={type:"element",tagName:"a",properties:{href:"#"+n+"fn-"+s,id:n+"fnref-"+s+(l>1?"-"+l:""),dataFootnoteRef:!0,ariaDescribedBy:["footnote-label"]},children:[{type:"text",value:String(o)}]};t.patch(e,c);const u={type:"element",tagName:"sup",properties:{},children:[c]};return t.patch(e,u),t.applyData(e,u)}function YAe(t,e){const n={type:"element",tagName:"h"+e.depth,properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function JAe(t,e){if(t.options.allowDangerousHtml){const n={type:"raw",value:e.value};return t.patch(e,n),t.applyData(e,n)}}function wq(t,e){const n=e.referenceType;let r="]";if(n==="collapsed"?r+="[]":n==="full"&&(r+="["+(e.label||e.identifier)+"]"),e.type==="imageReference")return[{type:"text",value:"!["+e.alt+r}];const s=t.all(e),i=s[0];i&&i.type==="text"?i.value="["+i.value:s.unshift({type:"text",value:"["});const o=s[s.length-1];return o&&o.type==="text"?o.value+=r:s.push({type:"text",value:r}),s}function XAe(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return wq(t,e);const s={src:Gf(r.url||""),alt:e.alt};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"img",properties:s,children:[]};return t.patch(e,i),t.applyData(e,i)}function QAe(t,e){const n={src:Gf(e.url)};e.alt!==null&&e.alt!==void 0&&(n.alt=e.alt),e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"img",properties:n,children:[]};return t.patch(e,r),t.applyData(e,r)}function ZAe(t,e){const n={type:"text",value:e.value.replace(/\r?\n|\r/g," ")};t.patch(e,n);const r={type:"element",tagName:"code",properties:{},children:[n]};return t.patch(e,r),t.applyData(e,r)}function eke(t,e){const n=String(e.identifier).toUpperCase(),r=t.definitionById.get(n);if(!r)return wq(t,e);const s={href:Gf(r.url||"")};r.title!==null&&r.title!==void 0&&(s.title=r.title);const i={type:"element",tagName:"a",properties:s,children:t.all(e)};return t.patch(e,i),t.applyData(e,i)}function tke(t,e){const n={href:Gf(e.url)};e.title!==null&&e.title!==void 0&&(n.title=e.title);const r={type:"element",tagName:"a",properties:n,children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function nke(t,e,n){const r=t.all(e),s=n?rke(n):bq(e),i={},o=[];if(typeof e.checked=="boolean"){const d=r[0];let h;d&&d.type==="element"&&d.tagName==="p"?h=d:(h={type:"element",tagName:"p",properties:{},children:[]},r.unshift(h)),h.children.length>0&&h.children.unshift({type:"text",value:" "}),h.children.unshift({type:"element",tagName:"input",properties:{type:"checkbox",checked:e.checked,disabled:!0},children:[]}),i.className=["task-list-item"]}let l=-1;for(;++l<r.length;){const d=r[l];(s||l!==0||d.type!=="element"||d.tagName!=="p")&&o.push({type:"text",value:`
`}),d.type==="element"&&d.tagName==="p"&&!s?o.push(...d.children):o.push(d)}const c=r[r.length-1];c&&(s||c.type!=="element"||c.tagName!=="p")&&o.push({type:"text",value:`
`});const u={type:"element",tagName:"li",properties:i,children:o};return t.patch(e,u),t.applyData(e,u)}function rke(t){let e=!1;if(t.type==="list"){e=t.spread||!1;const n=t.children;let r=-1;for(;!e&&++r<n.length;)e=bq(n[r])}return e}function bq(t){const e=t.spread;return e??t.children.length>1}function ske(t,e){const n={},r=t.all(e);let s=-1;for(typeof e.start=="number"&&e.start!==1&&(n.start=e.start);++s<r.length;){const o=r[s];if(o.type==="element"&&o.tagName==="li"&&o.properties&&Array.isArray(o.properties.className)&&o.properties.className.includes("task-list-item")){n.className=["contains-task-list"];break}}const i={type:"element",tagName:e.ordered?"ol":"ul",properties:n,children:t.wrap(r,!0)};return t.patch(e,i),t.applyData(e,i)}function ike(t,e){const n={type:"element",tagName:"p",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function oke(t,e){const n={type:"root",children:t.wrap(t.all(e))};return t.patch(e,n),t.applyData(e,n)}function ake(t,e){const n={type:"element",tagName:"strong",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}function lke(t,e){const n=t.all(e),r=n.shift(),s=[];if(r){const o={type:"element",tagName:"thead",properties:{},children:t.wrap([r],!0)};t.patch(e.children[0],o),s.push(o)}if(n.length>0){const o={type:"element",tagName:"tbody",properties:{},children:t.wrap(n,!0)},l=ck(e.children[1]),c=tq(e.children[e.children.length-1]);l&&c&&(o.position={start:l,end:c}),s.push(o)}const i={type:"element",tagName:"table",properties:{},children:t.wrap(s,!0)};return t.patch(e,i),t.applyData(e,i)}function cke(t,e,n){const r=n?n.children:void 0,i=(r?r.indexOf(e):1)===0?"th":"td",o=n&&n.type==="table"?n.align:void 0,l=o?o.length:e.children.length;let c=-1;const u=[];for(;++c<l;){const h=e.children[c],f={},m=o?o[c]:void 0;m&&(f.align=m);let g={type:"element",tagName:i,properties:f,children:[]};h&&(g.children=t.all(h),t.patch(h,g),g=t.applyData(h,g)),u.push(g)}const d={type:"element",tagName:"tr",properties:{},children:t.wrap(u,!0)};return t.patch(e,d),t.applyData(e,d)}function uke(t,e){const n={type:"element",tagName:"td",properties:{},children:t.all(e)};return t.patch(e,n),t.applyData(e,n)}const zF=9,GF=32;function dke(t){const e=String(t),n=/\r?\n|\r/g;let r=n.exec(e),s=0;const i=[];for(;r;)i.push(WF(e.slice(s,r.index),s>0,!0),r[0]),s=r.index+r[0].length,r=n.exec(e);return i.push(WF(e.slice(s),s>0,!1)),i.join("")}function WF(t,e,n){let r=0,s=t.length;if(e){let i=t.codePointAt(r);for(;i===zF||i===GF;)r++,i=t.codePointAt(r)}if(n){let i=t.codePointAt(s-1);for(;i===zF||i===GF;)s--,i=t.codePointAt(s-1)}return s>r?t.slice(r,s):""}function hke(t,e){const n={type:"text",value:dke(String(e.value))};return t.patch(e,n),t.applyData(e,n)}function fke(t,e){const n={type:"element",tagName:"hr",properties:{},children:[]};return t.patch(e,n),t.applyData(e,n)}const mke={blockquote:zAe,break:GAe,code:WAe,delete:HAe,emphasis:qAe,footnoteReference:KAe,heading:YAe,html:JAe,imageReference:XAe,image:QAe,inlineCode:ZAe,linkReference:eke,link:tke,listItem:nke,list:ske,paragraph:ike,root:oke,strong:ake,table:lke,tableCell:uke,tableRow:cke,text:hke,thematicBreak:fke,toml:Ix,yaml:Ix,definition:Ix,footnoteDefinition:Ix};function Ix(){}const _q=-1,p_=0,Sp=1,a0=2,gk=3,yk=4,xk=5,vk=6,Sq=7,Cq=8,HF=typeof self=="object"?self:globalThis,pke=(t,e)=>{const n=(s,i)=>(t.set(i,s),s),r=s=>{if(t.has(s))return t.get(s);const[i,o]=e[s];switch(i){case p_:case _q:return n(o,s);case Sp:{const l=n([],s);for(const c of o)l.push(r(c));return l}case a0:{const l=n({},s);for(const[c,u]of o)l[r(c)]=r(u);return l}case gk:return n(new Date(o),s);case yk:{const{source:l,flags:c}=o;return n(new RegExp(l,c),s)}case xk:{const l=n(new Map,s);for(const[c,u]of o)l.set(r(c),r(u));return l}case vk:{const l=n(new Set,s);for(const c of o)l.add(r(c));return l}case Sq:{const{name:l,message:c}=o;return n(new HF[l](c),s)}case Cq:return n(BigInt(o),s);case"BigInt":return n(Object(BigInt(o)),s);case"ArrayBuffer":return n(new Uint8Array(o).buffer,o);case"DataView":{const{buffer:l}=new Uint8Array(o);return n(new DataView(l),o)}}return n(new HF[i](o),s)};return r},qF=t=>pke(new Map,t)(0),qd="",{toString:gke}={},{keys:yke}=Object,wm=t=>{const e=typeof t;if(e!=="object"||!t)return[p_,e];const n=gke.call(t).slice(8,-1);switch(n){case"Array":return[Sp,qd];case"Object":return[a0,qd];case"Date":return[gk,qd];case"RegExp":return[yk,qd];case"Map":return[xk,qd];case"Set":return[vk,qd];case"DataView":return[Sp,n]}return n.includes("Array")?[Sp,n]:n.includes("Error")?[Sq,n]:[a0,n]},Nx=([t,e])=>t===p_&&(e==="function"||e==="symbol"),xke=(t,e,n,r)=>{const s=(o,l)=>{const c=r.push(o)-1;return n.set(l,c),c},i=o=>{if(n.has(o))return n.get(o);let[l,c]=wm(o);switch(l){case p_:{let d=o;switch(c){case"bigint":l=Cq,d=o.toString();break;case"function":case"symbol":if(t)throw new TypeError("unable to serialize "+c);d=null;break;case"undefined":return s([_q],o)}return s([l,d],o)}case Sp:{if(c){let f=o;return c==="DataView"?f=new Uint8Array(o.buffer):c==="ArrayBuffer"&&(f=new Uint8Array(o)),s([c,[...f]],o)}const d=[],h=s([l,d],o);for(const f of o)d.push(i(f));return h}case a0:{if(c)switch(c){case"BigInt":return s([c,o.toString()],o);case"Boolean":case"Number":case"String":return s([c,o.valueOf()],o)}if(e&&"toJSON"in o)return i(o.toJSON());const d=[],h=s([l,d],o);for(const f of yke(o))(t||!Nx(wm(o[f])))&&d.push([i(f),i(o[f])]);return h}case gk:return s([l,o.toISOString()],o);case yk:{const{source:d,flags:h}=o;return s([l,{source:d,flags:h}],o)}case xk:{const d=[],h=s([l,d],o);for(const[f,m]of o)(t||!(Nx(wm(f))||Nx(wm(m))))&&d.push([i(f),i(m)]);return h}case vk:{const d=[],h=s([l,d],o);for(const f of o)(t||!Nx(wm(f)))&&d.push(i(f));return h}}const{message:u}=o;return s([l,{name:c,message:u}],o)};return i},KF=(t,{json:e,lossy:n}={})=>{const r=[];return xke(!(e||n),!!e,new Map,r)(t),r},l0=typeof structuredClone=="function"?(t,e)=>e&&("json"in e||"lossy"in e)?qF(KF(t,e)):structuredClone(t):(t,e)=>qF(KF(t,e));function vke(t,e){const n=[{type:"text",value:"↩"}];return e>1&&n.push({type:"element",tagName:"sup",properties:{},children:[{type:"text",value:String(e)}]}),n}function wke(t,e){return"Back to reference "+(t+1)+(e>1?"-"+e:"")}function bke(t){const e=typeof t.options.clobberPrefix=="string"?t.options.clobberPrefix:"user-content-",n=t.options.footnoteBackContent||vke,r=t.options.footnoteBackLabel||wke,s=t.options.footnoteLabel||"Footnotes",i=t.options.footnoteLabelTagName||"h2",o=t.options.footnoteLabelProperties||{className:["sr-only"]},l=[];let c=-1;for(;++c<t.footnoteOrder.length;){const u=t.footnoteById.get(t.footnoteOrder[c]);if(!u)continue;const d=t.all(u),h=String(u.identifier).toUpperCase(),f=Gf(h.toLowerCase());let m=0;const g=[],x=t.footnoteCounts.get(h);for(;x!==void 0&&++m<=x;){g.length>0&&g.push({type:"text",value:" "});let _=typeof n=="string"?n:n(c,m);typeof _=="string"&&(_={type:"text",value:_}),g.push({type:"element",tagName:"a",properties:{href:"#"+e+"fnref-"+f+(m>1?"-"+m:""),dataFootnoteBackref:"",ariaLabel:typeof r=="string"?r:r(c,m),className:["data-footnote-backref"]},children:Array.isArray(_)?_:[_]})}const w=d[d.length-1];if(w&&w.type==="element"&&w.tagName==="p"){const _=w.children[w.children.length-1];_&&_.type==="text"?_.value+=" ":w.children.push({type:"text",value:" "}),w.children.push(...g)}else d.push(...g);const v={type:"element",tagName:"li",properties:{id:e+"fn-"+f},children:t.wrap(d,!0)};t.patch(u,v),l.push(v)}if(l.length!==0)return{type:"element",tagName:"section",properties:{dataFootnotes:!0,className:["footnotes"]},children:[{type:"element",tagName:i,properties:{...l0(o),id:"footnote-label"},children:[{type:"text",value:s}]},{type:"text",value:`
`},{type:"element",tagName:"ol",properties:{},children:t.wrap(l,!0)},{type:"text",value:`
`}]}}const Eq=function(t){if(t==null)return Eke;if(typeof t=="function")return g_(t);if(typeof t=="object")return Array.isArray(t)?_ke(t):Ske(t);if(typeof t=="string")return Cke(t);throw new Error("Expected function, string, or object as test")};function _ke(t){const e=[];let n=-1;for(;++n<t.length;)e[n]=Eq(t[n]);return g_(r);function r(...s){let i=-1;for(;++i<e.length;)if(e[i].apply(this,s))return!0;return!1}}function Ske(t){const e=t;return g_(n);function n(r){const s=r;let i;for(i in t)if(s[i]!==e[i])return!1;return!0}}function Cke(t){return g_(e);function e(n){return n&&n.type===t}}function g_(t){return e;function e(n,r,s){return!!(Tke(n)&&t.call(this,n,typeof r=="number"?r:void 0,s||void 0))}}function Eke(){return!0}function Tke(t){return t!==null&&typeof t=="object"&&"type"in t}const Tq=[],Ike=!0,YF=!1,Nke="skip";function Pke(t,e,n,r){let s;typeof e=="function"&&typeof n!="function"?(r=n,n=e):s=e;const i=Eq(s),o=r?-1:1;l(t,void 0,[])();function l(c,u,d){const h=c&&typeof c=="object"?c:{};if(typeof h.type=="string"){const m=typeof h.tagName=="string"?h.tagName:typeof h.name=="string"?h.name:void 0;Object.defineProperty(f,"name",{value:"node ("+(c.type+(m?"<"+m+">":""))+")"})}return f;function f(){let m=Tq,g,x,w;if((!e||i(c,u,d[d.length-1]||void 0))&&(m=Ake(n(c,d)),m[0]===YF))return m;if("children"in c&&c.children){const v=c;if(v.children&&m[0]!==Nke)for(x=(r?v.children.length:-1)+o,w=d.concat(v);x>-1&&x<v.children.length;){const _=v.children[x];if(g=l(_,x,w)(),g[0]===YF)return g;x=typeof g[1]=="number"?g[1]:x+o}}return m}}}function Ake(t){return Array.isArray(t)?t:typeof t=="number"?[Ike,t]:t==null?Tq:[t]}function Iq(t,e,n,r){let s,i,o;typeof e=="function"&&typeof n!="function"?(i=void 0,o=e,s=n):(i=e,o=n,s=r),Pke(t,i,l,s);function l(c,u){const d=u[u.length-1],h=d?d.children.indexOf(c):void 0;return o(c,h,d)}}const b1={}.hasOwnProperty,kke={};function Rke(t,e){const n=e||kke,r=new Map,s=new Map,i=new Map,o={...mke,...n.handlers},l={all:u,applyData:Dke,definitionById:r,footnoteById:s,footnoteCounts:i,footnoteOrder:[],handlers:o,one:c,options:n,patch:jke,wrap:Lke};return Iq(t,function(d){if(d.type==="definition"||d.type==="footnoteDefinition"){const h=d.type==="definition"?r:s,f=String(d.identifier).toUpperCase();h.has(f)||h.set(f,d)}}),l;function c(d,h){const f=d.type,m=l.handlers[f];if(b1.call(l.handlers,f)&&m)return m(l,d,h);if(l.options.passThrough&&l.options.passThrough.includes(f)){if("children"in d){const{children:x,...w}=d,v=l0(w);return v.children=l.all(d),v}return l0(d)}return(l.options.unknownHandler||Mke)(l,d,h)}function u(d){const h=[];if("children"in d){const f=d.children;let m=-1;for(;++m<f.length;){const g=l.one(f[m],d);if(g){if(m&&f[m-1].type==="break"&&(!Array.isArray(g)&&g.type==="text"&&(g.value=JF(g.value)),!Array.isArray(g)&&g.type==="element")){const x=g.children[0];x&&x.type==="text"&&(x.value=JF(x.value))}Array.isArray(g)?h.push(...g):h.push(g)}}}return h}}function jke(t,e){t.position&&(e.position=gNe(t))}function Dke(t,e){let n=e;if(t&&t.data){const r=t.data.hName,s=t.data.hChildren,i=t.data.hProperties;if(typeof r=="string")if(n.type==="element")n.tagName=r;else{const o="children"in n?n.children:[n];n={type:"element",tagName:r,properties:{},children:o}}n.type==="element"&&i&&Object.assign(n.properties,l0(i)),"children"in n&&n.children&&s!==null&&s!==void 0&&(n.children=s)}return n}function Mke(t,e){const n=e.data||{},r="value"in e&&!(b1.call(n,"hProperties")||b1.call(n,"hChildren"))?{type:"text",value:e.value}:{type:"element",tagName:"div",properties:{},children:t.all(e)};return t.patch(e,r),t.applyData(e,r)}function Lke(t,e){const n=[];let r=-1;for(e&&n.push({type:"text",value:`
`});++r<t.length;)r&&n.push({type:"text",value:`
`}),n.push(t[r]);return e&&t.length>0&&n.push({type:"text",value:`
`}),n}function JF(t){let e=0,n=t.charCodeAt(e);for(;n===9||n===32;)e++,n=t.charCodeAt(e);return t.slice(e)}function XF(t,e){const n=Rke(t,e),r=n.one(t,void 0),s=bke(n),i=Array.isArray(r)?{type:"root",children:r}:r||{type:"root",children:[]};return s&&i.children.push({type:"text",value:`
`},s),i}function Fke(t,e){return t&&"run"in t?async function(n,r){const s=XF(n,{file:r,...e});await t.run(s,r)}:function(n,r){return XF(n,{file:r,...t||e})}}function QF(t){if(t)throw t}var bv=Object.prototype.hasOwnProperty,Nq=Object.prototype.toString,ZF=Object.defineProperty,eO=Object.getOwnPropertyDescriptor,tO=function(e){return typeof Array.isArray=="function"?Array.isArray(e):Nq.call(e)==="[object Array]"},nO=function(e){if(!e||Nq.call(e)!=="[object Object]")return!1;var n=bv.call(e,"constructor"),r=e.constructor&&e.constructor.prototype&&bv.call(e.constructor.prototype,"isPrototypeOf");if(e.constructor&&!n&&!r)return!1;var s;for(s in e);return typeof s>"u"||bv.call(e,s)},rO=function(e,n){ZF&&n.name==="__proto__"?ZF(e,n.name,{enumerable:!0,configurable:!0,value:n.newValue,writable:!0}):e[n.name]=n.newValue},sO=function(e,n){if(n==="__proto__")if(bv.call(e,n)){if(eO)return eO(e,n).value}else return;return e[n]},Oke=function t(){var e,n,r,s,i,o,l=arguments[0],c=1,u=arguments.length,d=!1;for(typeof l=="boolean"&&(d=l,l=arguments[1]||{},c=2),(l==null||typeof l!="object"&&typeof l!="function")&&(l={});c<u;++c)if(e=arguments[c],e!=null)for(n in e)r=sO(l,n),s=sO(e,n),l!==s&&(d&&s&&(nO(s)||(i=tO(s)))?(i?(i=!1,o=r&&tO(r)?r:[]):o=r&&nO(r)?r:{},rO(l,{name:n,newValue:t(d,o,s)})):typeof s<"u"&&rO(l,{name:n,newValue:s}));return l};const uC=c0(Oke);function _1(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function $ke(){const t=[],e={run:n,use:r};return e;function n(...s){let i=-1;const o=s.pop();if(typeof o!="function")throw new TypeError("Expected function as last argument, not "+o);l(null,...s);function l(c,...u){const d=t[++i];let h=-1;if(c){o(c);return}for(;++h<s.length;)(u[h]===null||u[h]===void 0)&&(u[h]=s[h]);s=u,d?Vke(d,l)(...u):o(null,...u)}}function r(s){if(typeof s!="function")throw new TypeError("Expected `middelware` to be a function, not "+s);return t.push(s),e}}function Vke(t,e){let n;return r;function r(...o){const l=t.length>o.length;let c;l&&o.push(s);try{c=t.apply(this,o)}catch(u){const d=u;if(l&&n)throw d;return s(d)}l||(c&&c.then&&typeof c.then=="function"?c.then(i,s):c instanceof Error?s(c):i(c))}function s(o,...l){n||(n=!0,e(o,...l))}function i(o){s(null,o)}}const ra={basename:Uke,dirname:Bke,extname:zke,join:Gke,sep:"/"};function Uke(t,e){if(e!==void 0&&typeof e!="string")throw new TypeError('"ext" argument must be a string');my(t);let n=0,r=-1,s=t.length,i;if(e===void 0||e.length===0||e.length>t.length){for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else r<0&&(i=!0,r=s+1);return r<0?"":t.slice(n,r)}if(e===t)return"";let o=-1,l=e.length-1;for(;s--;)if(t.codePointAt(s)===47){if(i){n=s+1;break}}else o<0&&(i=!0,o=s+1),l>-1&&(t.codePointAt(s)===e.codePointAt(l--)?l<0&&(r=s):(l=-1,r=o));return n===r?r=o:r<0&&(r=t.length),t.slice(n,r)}function Bke(t){if(my(t),t.length===0)return".";let e=-1,n=t.length,r;for(;--n;)if(t.codePointAt(n)===47){if(r){e=n;break}}else r||(r=!0);return e<0?t.codePointAt(0)===47?"/":".":e===1&&t.codePointAt(0)===47?"//":t.slice(0,e)}function zke(t){my(t);let e=t.length,n=-1,r=0,s=-1,i=0,o;for(;e--;){const l=t.codePointAt(e);if(l===47){if(o){r=e+1;break}continue}n<0&&(o=!0,n=e+1),l===46?s<0?s=e:i!==1&&(i=1):s>-1&&(i=-1)}return s<0||n<0||i===0||i===1&&s===n-1&&s===r+1?"":t.slice(s,n)}function Gke(...t){let e=-1,n;for(;++e<t.length;)my(t[e]),t[e]&&(n=n===void 0?t[e]:n+"/"+t[e]);return n===void 0?".":Wke(n)}function Wke(t){my(t);const e=t.codePointAt(0)===47;let n=Hke(t,!e);return n.length===0&&!e&&(n="."),n.length>0&&t.codePointAt(t.length-1)===47&&(n+="/"),e?"/"+n:n}function Hke(t,e){let n="",r=0,s=-1,i=0,o=-1,l,c;for(;++o<=t.length;){if(o<t.length)l=t.codePointAt(o);else{if(l===47)break;l=47}if(l===47){if(!(s===o-1||i===1))if(s!==o-1&&i===2){if(n.length<2||r!==2||n.codePointAt(n.length-1)!==46||n.codePointAt(n.length-2)!==46){if(n.length>2){if(c=n.lastIndexOf("/"),c!==n.length-1){c<0?(n="",r=0):(n=n.slice(0,c),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}}else if(n.length>0){n="",r=0,s=o,i=0;continue}}e&&(n=n.length>0?n+"/..":"..",r=2)}else n.length>0?n+="/"+t.slice(s+1,o):n=t.slice(s+1,o),r=o-s-1;s=o,i=0}else l===46&&i>-1?i++:i=-1}return n}function my(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}const qke={cwd:Kke};function Kke(){return"/"}function S1(t){return!!(t!==null&&typeof t=="object"&&"href"in t&&t.href&&"protocol"in t&&t.protocol&&t.auth===void 0)}function Yke(t){if(typeof t=="string")t=new URL(t);else if(!S1(t)){const e=new TypeError('The "path" argument must be of type string or an instance of URL. Received `'+t+"`");throw e.code="ERR_INVALID_ARG_TYPE",e}if(t.protocol!=="file:"){const e=new TypeError("The URL must be of scheme file");throw e.code="ERR_INVALID_URL_SCHEME",e}return Jke(t)}function Jke(t){if(t.hostname!==""){const r=new TypeError('File URL host must be "localhost" or empty on darwin');throw r.code="ERR_INVALID_FILE_URL_HOST",r}const e=t.pathname;let n=-1;for(;++n<e.length;)if(e.codePointAt(n)===37&&e.codePointAt(n+1)===50){const r=e.codePointAt(n+2);if(r===70||r===102){const s=new TypeError("File URL path must not include encoded / characters");throw s.code="ERR_INVALID_FILE_URL_PATH",s}}return decodeURIComponent(e)}const dC=["history","path","basename","stem","extname","dirname"];class Pq{constructor(e){let n;e?S1(e)?n={path:e}:typeof e=="string"||Xke(e)?n={value:e}:n=e:n={},this.cwd="cwd"in n?"":qke.cwd(),this.data={},this.history=[],this.messages=[],this.value,this.map,this.result,this.stored;let r=-1;for(;++r<dC.length;){const i=dC[r];i in n&&n[i]!==void 0&&n[i]!==null&&(this[i]=i==="history"?[...n[i]]:n[i])}let s;for(s in n)dC.includes(s)||(this[s]=n[s])}get basename(){return typeof this.path=="string"?ra.basename(this.path):void 0}set basename(e){fC(e,"basename"),hC(e,"basename"),this.path=ra.join(this.dirname||"",e)}get dirname(){return typeof this.path=="string"?ra.dirname(this.path):void 0}set dirname(e){iO(this.basename,"dirname"),this.path=ra.join(e||"",this.basename)}get extname(){return typeof this.path=="string"?ra.extname(this.path):void 0}set extname(e){if(hC(e,"extname"),iO(this.dirname,"extname"),e){if(e.codePointAt(0)!==46)throw new Error("`extname` must start with `.`");if(e.includes(".",1))throw new Error("`extname` cannot contain multiple dots")}this.path=ra.join(this.dirname,this.stem+(e||""))}get path(){return this.history[this.history.length-1]}set path(e){S1(e)&&(e=Yke(e)),fC(e,"path"),this.path!==e&&this.history.push(e)}get stem(){return typeof this.path=="string"?ra.basename(this.path,this.extname):void 0}set stem(e){fC(e,"stem"),hC(e,"stem"),this.path=ra.join(this.dirname||"",e+(this.extname||""))}fail(e,n,r){const s=this.message(e,n,r);throw s.fatal=!0,s}info(e,n,r){const s=this.message(e,n,r);return s.fatal=void 0,s}message(e,n,r){const s=new Vs(e,n,r);return this.path&&(s.name=this.path+":"+s.name,s.file=this.path),s.fatal=!1,this.messages.push(s),s}toString(e){return this.value===void 0?"":typeof this.value=="string"?this.value:new TextDecoder(e||void 0).decode(this.value)}}function hC(t,e){if(t&&t.includes(ra.sep))throw new Error("`"+e+"` cannot be a path: did not expect `"+ra.sep+"`")}function fC(t,e){if(!t)throw new Error("`"+e+"` cannot be empty")}function iO(t,e){if(!t)throw new Error("Setting `"+e+"` requires `path` to be set too")}function Xke(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const Qke=function(t){const r=this.constructor.prototype,s=r[t],i=function(){return s.apply(i,arguments)};return Object.setPrototypeOf(i,r),i},Zke={}.hasOwnProperty;class wk extends Qke{constructor(){super("copy"),this.Compiler=void 0,this.Parser=void 0,this.attachers=[],this.compiler=void 0,this.freezeIndex=-1,this.frozen=void 0,this.namespace={},this.parser=void 0,this.transformers=$ke()}copy(){const e=new wk;let n=-1;for(;++n<this.attachers.length;){const r=this.attachers[n];e.use(...r)}return e.data(uC(!0,{},this.namespace)),e}data(e,n){return typeof e=="string"?arguments.length===2?(gC("data",this.frozen),this.namespace[e]=n,this):Zke.call(this.namespace,e)&&this.namespace[e]||void 0:e?(gC("data",this.frozen),this.namespace=e,this):this.namespace}freeze(){if(this.frozen)return this;const e=this;for(;++this.freezeIndex<this.attachers.length;){const[n,...r]=this.attachers[this.freezeIndex];if(r[0]===!1)continue;r[0]===!0&&(r[0]=void 0);const s=n.call(e,...r);typeof s=="function"&&this.transformers.use(s)}return this.frozen=!0,this.freezeIndex=Number.POSITIVE_INFINITY,this}parse(e){this.freeze();const n=Px(e),r=this.parser||this.Parser;return mC("parse",r),r(String(n),n)}process(e,n){const r=this;return this.freeze(),mC("process",this.parser||this.Parser),pC("process",this.compiler||this.Compiler),n?s(void 0,n):new Promise(s);function s(i,o){const l=Px(e),c=r.parse(l);r.run(c,l,function(d,h,f){if(d||!h||!f)return u(d);const m=h,g=r.stringify(m,f);nRe(g)?f.value=g:f.result=g,u(d,f)});function u(d,h){d||!h?o(d):i?i(h):n(void 0,h)}}}processSync(e){let n=!1,r;return this.freeze(),mC("processSync",this.parser||this.Parser),pC("processSync",this.compiler||this.Compiler),this.process(e,s),aO("processSync","process",n),r;function s(i,o){n=!0,QF(i),r=o}}run(e,n,r){oO(e),this.freeze();const s=this.transformers;return!r&&typeof n=="function"&&(r=n,n=void 0),r?i(void 0,r):new Promise(i);function i(o,l){const c=Px(n);s.run(e,c,u);function u(d,h,f){const m=h||e;d?l(d):o?o(m):r(void 0,m,f)}}}runSync(e,n){let r=!1,s;return this.run(e,n,i),aO("runSync","run",r),s;function i(o,l){QF(o),s=l,r=!0}}stringify(e,n){this.freeze();const r=Px(n),s=this.compiler||this.Compiler;return pC("stringify",s),oO(e),s(e,r)}use(e,...n){const r=this.attachers,s=this.namespace;if(gC("use",this.frozen),e!=null)if(typeof e=="function")c(e,n);else if(typeof e=="object")Array.isArray(e)?l(e):o(e);else throw new TypeError("Expected usable value, not `"+e+"`");return this;function i(u){if(typeof u=="function")c(u,[]);else if(typeof u=="object")if(Array.isArray(u)){const[d,...h]=u;c(d,h)}else o(u);else throw new TypeError("Expected usable value, not `"+u+"`")}function o(u){if(!("plugins"in u)&&!("settings"in u))throw new Error("Expected usable value but received an empty preset, which is probably a mistake: presets typically come with `plugins` and sometimes with `settings`, but this has neither");l(u.plugins),u.settings&&(s.settings=uC(!0,s.settings,u.settings))}function l(u){let d=-1;if(u!=null)if(Array.isArray(u))for(;++d<u.length;){const h=u[d];i(h)}else throw new TypeError("Expected a list of plugins, not `"+u+"`")}function c(u,d){let h=-1,f=-1;for(;++h<r.length;)if(r[h][0]===u){f=h;break}if(f===-1)r.push([u,...d]);else if(d.length>0){let[m,...g]=d;const x=r[f][1];_1(x)&&_1(m)&&(m=uC(!0,x,m)),r[f]=[u,m,...g]}}}}const eRe=new wk().freeze();function mC(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `parser`")}function pC(t,e){if(typeof e!="function")throw new TypeError("Cannot `"+t+"` without `compiler`")}function gC(t,e){if(e)throw new Error("Cannot call `"+t+"` on a frozen processor.\nCreate a new processor first, by calling it: use `processor()` instead of `processor`.")}function oO(t){if(!_1(t)||typeof t.type!="string")throw new TypeError("Expected node, got `"+t+"`")}function aO(t,e,n){if(!n)throw new Error("`"+t+"` finished async. Use `"+e+"` instead")}function Px(t){return tRe(t)?t:new Pq(t)}function tRe(t){return!!(t&&typeof t=="object"&&"message"in t&&"messages"in t)}function nRe(t){return typeof t=="string"||rRe(t)}function rRe(t){return!!(t&&typeof t=="object"&&"byteLength"in t&&"byteOffset"in t)}const sRe="https://github.com/remarkjs/react-markdown/blob/main/changelog.md",lO=[],cO={allowDangerousHtml:!0},iRe=/^(https?|ircs?|mailto|xmpp)$/i,oRe=[{from:"astPlugins",id:"remove-buggy-html-in-markdown-parser"},{from:"allowDangerousHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"allowNode",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowElement"},{from:"allowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"allowedElements"},{from:"className",id:"remove-classname"},{from:"disallowedTypes",id:"replace-allownode-allowedtypes-and-disallowedtypes",to:"disallowedElements"},{from:"escapeHtml",id:"remove-buggy-html-in-markdown-parser"},{from:"includeElementIndex",id:"#remove-includeelementindex"},{from:"includeNodeIndex",id:"change-includenodeindex-to-includeelementindex"},{from:"linkTarget",id:"remove-linktarget"},{from:"plugins",id:"change-plugins-to-remarkplugins",to:"remarkPlugins"},{from:"rawSourcePos",id:"#remove-rawsourcepos"},{from:"renderers",id:"change-renderers-to-components",to:"components"},{from:"source",id:"change-source-to-children",to:"children"},{from:"sourcePos",id:"#remove-sourcepos"},{from:"transformImageUri",id:"#add-urltransform",to:"urlTransform"},{from:"transformLinkUri",id:"#add-urltransform",to:"urlTransform"}];function aRe(t){const e=lRe(t),n=cRe(t);return uRe(e.runSync(e.parse(n),n),t)}function lRe(t){const e=t.rehypePlugins||lO,n=t.remarkPlugins||lO,r=t.remarkRehypeOptions?{...t.remarkRehypeOptions,...cO}:cO;return eRe().use(BAe).use(n).use(Fke,r).use(e)}function cRe(t){const e=t.children||"",n=new Pq;return typeof e=="string"&&(n.value=e),n}function uRe(t,e){const n=e.allowedElements,r=e.allowElement,s=e.components,i=e.disallowedElements,o=e.skipHtml,l=e.unwrapDisallowed,c=e.urlTransform||dRe;for(const d of oRe)Object.hasOwn(e,d.from)&&(""+d.from+(d.to?"use `"+d.to+"` instead":"remove it")+sRe+d.id,void 0);return Iq(t,u),bNe(t,{Fragment:a.Fragment,components:s,ignoreInvalidStyle:!0,jsx:a.jsx,jsxs:a.jsxs,passKeys:!0,passNode:!0});function u(d,h,f){if(d.type==="raw"&&f&&typeof h=="number")return o?f.children.splice(h,1):f.children[h]={type:"text",value:d.value},h;if(d.type==="element"){let m;for(m in aC)if(Object.hasOwn(aC,m)&&Object.hasOwn(d.properties,m)){const g=d.properties[m],x=aC[m];(x===null||x.includes(d.tagName))&&(d.properties[m]=c(String(g||""),m,d))}}if(d.type==="element"){let m=n?!n.includes(d.tagName):i?i.includes(d.tagName):!1;if(!m&&r&&typeof h=="number"&&(m=!r(d,h,f)),m&&f&&typeof h=="number")return l&&d.children?f.children.splice(h,1,...d.children):f.children.splice(h,1),h}}}function dRe(t){const e=t.indexOf(":"),n=t.indexOf("?"),r=t.indexOf("#"),s=t.indexOf("/");return e===-1||s!==-1&&e>s||n!==-1&&e>n||r!==-1&&e>r||iRe.test(t.slice(0,e))?t:""}const hRe=({productData:t,onViewDetails:e,onAddToCart:n,onBuyNow:r,onVisualize:s})=>{if(!t)return null;const{name:i,description:o,price:l,imageUrl:c,id:u}=t;return a.jsxs(Ke,{className:"mb-2 w-full max-w-xs sm:max-w-sm overflow-hidden shadow-md border border-border",children:[c&&a.jsx("div",{className:"w-full h-32 sm:h-40 overflow-hidden bg-muted",children:a.jsx("img",{src:c,alt:i||"Product image",className:"w-full h-full object-contain"})}),a.jsx(at,{className:"p-3",children:i&&a.jsx(lt,{className:"text-sm sm:text-base font-semibold leading-tight line-clamp-2",children:i})}),a.jsxs(st,{className:"p-3 pt-0 text-xs sm:text-sm",children:[o&&a.jsx(Kt,{className:"mb-2 line-clamp-2 sm:line-clamp-3 text-muted-foreground",children:o}),l&&a.jsx("p",{className:"font-semibold text-sm sm:text-base",children:typeof l=="number"?`$${l.toFixed(2)}`:l}),a.jsxs("div",{className:"mt-3 flex flex-col sm:flex-row sm:space-x-2 space-y-2 sm:space-y-0",children:[e&&a.jsx($,{size:"sm",variant:"outline",className:"flex-1 text-xs sm:text-sm",onClick:()=>e(u,i),children:"View"}),n&&a.jsx($,{size:"sm",variant:"secondary",className:"flex-1 text-xs sm:text-sm",onClick:()=>n(u,i),children:"Add to Cart"}),r&&a.jsx($,{size:"sm",variant:"default",className:"flex-1 text-xs sm:text-sm",onClick:()=>r(u,i),children:"Buy Now"})]}),s&&a.jsxs($,{size:"sm",variant:"outline",className:"w-full mt-2 text-xs sm:text-sm",onClick:()=>s(u,i),children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Visualize with Image"]})]})]})},fRe="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk",mRe=new _n({apiKey:fRe}),pRe="gemini-2.0-flash-preview-image-generation";async function yC(t,e){if(!t)throw new Error("Image source is undefined or null.");let n,r=e;if(typeof t=="string"&&(t.startsWith("http://")||t.startsWith("https://"))){console.log(`Fetching image from URL: ${t}`);const i=await fetch(t);if(!i.ok)throw new Error(`Failed to fetch image from ${t}: ${i.statusText}`);const o=await i.blob();r=o.type||r||"image/jpeg",n=await new Promise((l,c)=>{const u=new FileReader;u.onloadend=()=>{typeof u.result=="string"?l(u.result.split(",")[1]):c(new Error("FileReader did not return a string for URL image."))},u.onerror=d=>c(new Error(`FileReader failed for URL image: ${d}`)),u.readAsDataURL(o)})}else if(typeof t=="string"&&t.startsWith("data:")){console.log("Processing Data URL image.");try{const i=t.split(",");if(i.length<2)throw new Error("Invalid data URL structure.");const o=i[0];n=i[1];const l=o.match(/:(.*?);/);if(!l||!l[1])throw new Error("Could not parse MIME type from data URL.");r=l[1]}catch(i){throw console.error("Error parsing data URL:",t,i),new Error(`Invalid data URL format: ${i.message}`)}}else if(typeof File<"u"&&t instanceof File)console.log(`Processing File object: ${t.name}`),r=t.type,n=await new Promise((i,o)=>{const l=new FileReader;l.onloadend=()=>{typeof l.result=="string"?i(l.result.split(",")[1]):o(new Error("FileReader did not return a string for File object."))},l.onerror=c=>o(new Error(`FileReader failed for File object: ${c}`)),l.readAsDataURL(t)});else if(typeof t=="string"){console.warn(`Received string imageSource that is not a URL or Data URL: "${t}". This path is intended for Node.js file paths.`);try{console.log(`Attempting to read image from local path (Node.js context): ${t}`),n=(await(await At(()=>import("./__vite-browser-external-b25bb000.js"),[])).readFile(t)).toString("base64");const c=(await At(()=>import("./__vite-browser-external-b25bb000.js"),[])).extname(t).toLowerCase();if(!r)if(c===".png")r="image/png";else if(c===".jpg"||c===".jpeg")r="image/jpeg";else if(c===".webp")r="image/webp";else if(c===".gif")r="image/gif";else throw new Error(`Unsupported image extension or MIME type not provided for path: ${t}`)}catch(i){throw console.error("Failed to process string as Node.js file path (this is expected in browser):",i),new Error("Unsupported string imageSource in browser. Must be URL or Data URL, or provide a File object.")}}else throw new Error("Unsupported image source type. Provide a URL, Data URL, or File object.");if(!n)throw new Error("Could not obtain base64 image data.");r||(r="image/jpeg",console.warn("MIME type could not be determined, defaulting to image/jpeg."));const s=["image/png","image/jpeg","image/webp","image/heic","image/heif"];return s.includes(r)||console.warn(`MIME type ${r} may not be optimally supported. Supported types are: ${s.join(", ")}.`),{inlineData:{data:n,mimeType:r}}}async function Aq({mainProduct:t,referenceSceneSource:e,additionalProducts:n=[],customInstructions:r=""}){var o,l,c,u,d,h,f,m;if(!t||!t.name||!t.imageSource)throw new Error("Main product with name and imageSource is required.");if(!e)throw new Error("Reference scene imageSource is required.");const s=[];let i=`Visually integrate the product named "${t.name}" into a scene inspired by the provided reference scene image.
The main product is described as: "${t.description||"Not specified"}".
The reference scene image sets the style, lighting, and overall environment.
Make the main product the primary focus, well-lit, and naturally fitting the scene's perspective.
`;n.length>0&&(i+=`
Also, incorporate the following additional products naturally into the scene:
`,n.forEach((g,x)=>{i+=`- Product ${x+1}: "${g.name}" (Description: "${g.description||"Not specified"}")
`})),r.trim()!==""&&(i+=`
Specific User Instructions: "${r.trim()}"
`),i+=`
Please generate a high-quality, photorealistic image based on these instructions and the provided images. Also provide a brief text commentary about the generated image or any challenges encountered.`,s.push({text:i});try{s.push(await yC(e)),s.push(await yC(t.imageSource));for(const g of n)if(g.imageSource)try{s.push(await yC(g.imageSource))}catch(x){console.warn(`Could not process image for additional product "${g.name}": ${x.message}. Skipping this image.`)}}catch(g){throw new Error(`Failed to process one or more input images: ${g.message}`)}console.log("Constructed prompt parts. Total parts:",s.length);try{const g=await mRe.models.generateContent({model:pRe,contents:[{role:"user",parts:s}],generationConfig:{temperature:.6,candidateCount:1},safetySettings:[{category:Tr.HARM_CATEGORY_HARASSMENT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_HATE_SPEECH,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_SEXUALLY_EXPLICIT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE},{category:Tr.HARM_CATEGORY_DANGEROUS_CONTENT,threshold:Ir.BLOCK_MEDIUM_AND_ABOVE}],config:{responseModalities:[yn.TEXT,yn.IMAGE]}}),x=g;if(!x)throw console.error("Full API result from Gemini was undefined:",g),new Error("Invalid or empty response from Gemini API.");let w=null,v="No specific commentary from the model.";console.log("Full API response from Gemini:",JSON.stringify(x,null,2)),(o=x.promptFeedback)!=null&&o.blockReason&&(v=`Image generation may have been blocked. Reason: ${x.promptFeedback.blockReason}.`,console.warn(v));const _=(l=x.candidates)==null?void 0:l[0];if(_){if(_.finishReason&&_.finishReason!=="STOP"&&_.finishReason!=="MAX_TOKENS"){const C=`Generation stopped. Reason: ${_.finishReason}.`;v=v==="No specific commentary from the model."?C:`${v}. ${C}`,console.warn(C)}if(((u=(c=_.content)==null?void 0:c.parts)==null?void 0:u.length)>0)for(const C of _.content.parts)C.text?v=v==="No specific commentary from the model."||!v.includes(C.text)?v==="No specific commentary from the model."?C.text:v+" "+C.text:v:(h=(d=C.inlineData)==null?void 0:d.mimeType)!=null&&h.startsWith("image/")&&(w=`data:${C.inlineData.mimeType};base64,${C.inlineData.data}`,console.log(`Image generated successfully. MIME type: ${C.inlineData.mimeType}`))}else(f=x.promptFeedback)!=null&&f.blockReason||(v=v==="No specific commentary from the model."?"No candidates returned by the model.":`${v}. Also, no candidates were returned.`);return!w&&v==="No specific commentary from the model."&&(v="Image generation failed, and no specific reason or commentary was provided."),{imageUrl:w,commentary:v,promptUsed:i}}catch(g){console.error("Error during Gemini API call or response processing:",g);let x=g.message;throw(m=g.response)!=null&&m.message?x=g.response.message:g.response&&(x=JSON.stringify(g.response)),new Error(`Product visualization failed: ${x}`)}}const kq=()=>{var Se;const t=wi(),{currentStore:e,addToCart:n,getProductById:r,updateQuantity:s,viewMode:i}=$n(),{userRole:o}=ls(),[l,c]=p.useState(!1),[u,d]=p.useState(!1),[h,f]=p.useState('You are a friendly and helpful AI assistant for an e-commerce store. Be concise and helpful. Always format your responses using Markdown. If a user asks you to find a product, your primary action should be to use the `find_and_open_product` function. **Only after the `find_and_open_product` function successfully returns product details (indicated by `product_found: true` in the function\'s result) should you then say something like "Here is the product I found for you:".** At that point, a product card will also be displayed by the UI. Following your acknowledgment, you MUST ask a relevant follow-up question, such as "Would you like to see more details, add it to your cart, or keep browsing?". If the function call indicates the product was not found (`product_found: false`), you should inform the user you could not find the product and offer to search again or help with something else. Do not repeat raw product data (like image URLs or full product objects) in your text response, as the card already displays this information.'),[m,g]=p.useState(""),[x,w]=p.useState([]),[v,_]=p.useState(null),[C,T]=p.useState(null),R=p.useRef(null),k=p.useRef(null),[E,I]=p.useState(null),[P,A]=p.useState(!1),D=p.useRef(!1),j={name:"find_and_open_product",description:"Finds a product based on a query (name, keywords, or ID) and returns its details for display. It does NOT navigate. After displaying, ask if the user wants to navigate or add to cart.",parameters:{type:He.OBJECT,properties:{product_query:{type:He.STRING,description:"The name, keywords, or ID of the product to find."}},required:["product_query"]}},M={name:"navigate_to_product_detail_page",description:"Navigates the user to the detailed page for a specific product, given its ID.",parameters:{type:He.OBJECT,properties:{product_id:{type:He.STRING,description:"The unique ID of the product."},product_name:{type:He.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},z={name:"add_to_cart",description:"Adds a specified product to the user's shopping cart.",parameters:{type:He.OBJECT,properties:{product_id:{type:He.STRING,description:"The unique ID of the product to add."},product_name:{type:He.STRING,description:"The name of the product (for confirmation)."},quantity:{type:He.NUMBER,description:"The quantity to add. Defaults to 1 if not specified."}},required:["product_id"]}},U={name:"initiate_purchase",description:"Initiates the purchase process for a specified product, potentially by adding to cart and navigating to checkout or directly to a payment page.",parameters:{type:He.OBJECT,properties:{product_id:{type:He.STRING,description:"The unique ID of the product to purchase."},product_name:{type:He.STRING,description:"The name of the product (for confirmation)."}},required:["product_id"]}},K={name:"navigate_home",description:`Navigates the user to the application's home page (typically the root path "/").`,parameters:{type:He.OBJECT,properties:{}}},q={name:"navigate_to_content_creation_page",description:"Navigates the user to the content creation page.",parameters:{type:He.OBJECT,properties:{}}},W={name:"navigate_to_store_dashboard",description:"Navigates the user to the store dashboard page.",parameters:{type:He.OBJECT,properties:{}}},te={name:"navigate_to_route",description:'Navigates the user to a specified route within the application. Use for requests like "go to a specific page". This is a generic navigation tool.',parameters:{type:He.OBJECT,properties:{route:{type:He.STRING,description:'The path to navigate to (e.g., "/", "/content-creation", "/dashboard").'}},required:["route"]}},O={name:"toggle_theme_mode",description:"Toggles the application's visual theme between light and dark mode.",parameters:{type:He.OBJECT,properties:{}}},V={name:"open_import_store_dialog",description:"Opens the dialog or interface for importing a store from another platform.",parameters:{type:He.OBJECT,properties:{}}},H={name:"go_to_cart",description:"Navigates the user to their shopping cart page.",parameters:{type:He.OBJECT,properties:{}}},L=[j,M,z,U,te,O,V,H,K,q,W],ee=()=>{var B;(B=R.current)==null||B.scrollIntoView({behavior:"smooth"})};p.useEffect(ee,[x]);const pe=()=>c(!l),xe=()=>d(!u),we=()=>{d(!1)},Ie=(B=null)=>{const X=typeof B=="string"?B:m;if(X.trim()==="")return;const ne=`user-text-${Date.now()}`;w(Y=>[...Y,{id:ne,role:"user",text:X}]),typeof B!="string"&&g(""),v==="gemini"&&C?Fe(X):console.error("Error: Gemini chat not active. Cannot send message.")},Fe=async B=>{if(!C){console.error("Gemini chat not initialized.");return}try{const X=await C.sendMessageStream({message:[{text:B}]}),ne=`assistant-gemini-${Date.now()}`;w(ce=>[...ce,{id:ne,role:"assistant",text:"",functionCallData:null}]);let Y="",Ne=null;for await(const ce of X){let Ee=null;ce.functionCalls&&ce.functionCalls.length>0?Ee=ce.functionCalls[0]:ce.functionCall&&(Ee=ce.functionCall),Ee&&(Ne=Ee);const Re=ce.text;Re&&(Y+=Re,w(Be=>Be.map(_t=>_t.id===ne?{..._t,text:Y}:_t)))}Ne?(w(ce=>ce.map(Ee=>{if(Ee.id===ne){let Re=`(Function call: ${Ne.name})`;Ne.name==="find_and_open_product"&&(Re="Searching for product…");const Be=Y.trim()===""?Re:`${Y}
${Re}`;return{...Ee,text:Be,functionCallData:Ne}}return Ee})),await et(Ne,ne)):Y.trim()!==""||w(ce=>ce.map(Ee=>Ee.id===ne?{...Ee,text:"(Assistant responded without text)"}:Ee))}catch(X){console.error("Error sending/receiving Gemini message:",X)}},Ve=B=>{const X=B.route;if(X)try{return t(X),{success:!0,detail:`Successfully navigated to ${X}`}}catch(ne){return console.error("Navigation error:",ne),{success:!1,detail:`Failed to navigate: ${ne.message}`}}return{success:!1,detail:"Route not provided in arguments."}},Ge=B=>({success:!0,detail:"Theme toggled (placeholder action)."}),fe=B=>({success:!0,detail:"Import store dialog would be shown (placeholder action)."}),je=B=>{try{return t("/cart"),{success:!0,detail:"Navigated to cart page."}}catch(X){return console.error("Navigation to cart error:",X),{success:!1,detail:`Failed to navigate to cart: ${X.message}`}}},ie=B=>{var Ne,ce,Ee,Re,Be,_t,mt,Ht,tn;const X=(Ne=B.product_query)==null?void 0:Ne.toLowerCase().trim();if(!X)return{success:!0,product_found:!1,detail:"Product query not provided."};if(!e||!e.products||e.products.length===0)return{success:!0,product_found:!1,detail:"No products available in the current store to search."};const ne=e.products;let Y=null;if(Y=ne.find(Rt=>{var sn;return((sn=Rt.name)==null?void 0:sn.toLowerCase())===X}),!Y){const Rt=X.split(/\s+/).filter(sn=>sn.length>1);if(Rt.length>0){let sn=ne.map(In=>{var un,Nn;const Fr=((un=In.name)==null?void 0:un.toLowerCase())||"",zn=((Nn=In.description)==null?void 0:Nn.toLowerCase())||"";let wr=0;return Rt.forEach(dn=>{Fr.includes(dn)&&(wr+=2),zn.includes(dn)&&(wr+=1)}),Fr.includes(X)&&(wr+=5),zn.includes(X)&&(wr+=2),{product:In,score:wr}});sn=sn.filter(In=>In.score>0).sort((In,Fr)=>Fr.score-In.score),sn.length>0&&(Y=sn[0].product)}}if(Y||/^[a-zA-Z0-9-_]+$/.test(X)&&!X.includes(" ")&&(Y=ne.find(Rt=>{var sn;return((sn=Rt.id)==null?void 0:sn.toString())===X})),Y){let Rt=null;return(Ee=(ce=Y.image)==null?void 0:ce.src)!=null&&Ee.large&&typeof Y.image.src.large=="string"?Rt=Y.image.src.large:(Be=(Re=Y.image)==null?void 0:Re.src)!=null&&Be.medium&&typeof Y.image.src.medium=="string"?Rt=Y.image.src.medium:(mt=(_t=Y.image)==null?void 0:_t.src)!=null&&mt.small&&typeof Y.image.src.small=="string"?Rt=Y.image.src.small:Y.image_url&&typeof Y.image_url=="string"?Rt=Y.image_url:Y.imageUrl&&typeof Y.imageUrl=="string"?Rt=Y.imageUrl:Y.image&&typeof Y.image=="string"?Rt=Y.image:Y.images&&Array.isArray(Y.images)&&Y.images.length>0&&((Ht=Y.images[0])!=null&&Ht.src)&&typeof Y.images[0].src=="string"?Rt=Y.images[0].src:(tn=Y.featuredImage)!=null&&tn.url&&typeof Y.featuredImage.url=="string"&&(Rt=Y.featuredImage.url),Rt&&typeof Rt=="string"&&Rt.trim()!==""?Rt=Rt.trim():Rt=null,{success:!0,product_found:!0,product_data:{id:Y.id,name:Y.name,description:Y.description||"No description available.",price:Y.price||"Price not available.",imageUrl:Rt},detail:`Found product: ${Y.name}`}}else return{success:!0,product_found:!1,detail:`Could not find a matching or relevant product for query: "${B.product_query}"`}},$e=B=>B.product_id&&e&&e.id?(t(`/store/${e.id}/product/${B.product_id}`),{success:!0,detail:`Navigated to product page for ID ${B.product_id} in store ${e.id}`}):!e||!e.id?{success:!1,detail:"Current store information is not available for navigation."}:{success:!1,detail:"Product ID not provided for navigation."},me=B=>{if(!e||!e.id)return{success:!1,detail:"Current store not available for cart operation."};if(!B.product_id)return{success:!1,detail:"Product ID not provided to add to cart."};const X=r(e.id,B.product_id);if(X){const ne=B.quantity||1;return n(X,e.id),ne>1&&s(B.product_id,e.id,ne),{success:!0,detail:`${B.product_name||X.name||"Product"} added/updated in cart with quantity ${ne}.`}}else return{success:!1,detail:`Product with ID ${B.product_id} not found.`}},Ue=B=>{const{product_id:X,product_name:ne}=B;if(!e||!e.id)return console.error("Buy Now: Current store not available."),{success:!1,detail:"Current store information is not available to initiate purchase."};if(!X)return console.error("Buy Now: Product ID not provided."),{success:!1,detail:"Product ID not provided."};const Y=r(e.id,X);if(!Y)return console.error(`Buy Now: Product with ID ${X} not found.`),{success:!1,detail:`Product with ID ${X} not found.`};try{return n(Y,e.id),t("/checkout",{state:{action:"buyNow",productToAddId:Y.id,storeId:e.id}}),{success:!0,detail:`Added ${Y.name||"product"} to cart and navigated to checkout.`}}catch(Ne){return console.error("Error during Buy Now (add to cart & navigate) process:",Ne),{success:!1,detail:Ne.message||"Could not process Buy Now action."}}},et=async(B,X)=>{let ne,Y=!1;switch(B.name){case"navigate_to_route":ne=Ve(B.args),Y=ne.success;break;case"toggle_theme_mode":ne=Ge(B.args),Y=ne.success;break;case"open_import_store_dialog":ne=fe(B.args),Y=ne.success;break;case"go_to_cart":ne=je(B.args),Y=ne.success;break;case"navigate_home":ne=Ve({route:"/"}),Y=ne.success;break;case"navigate_to_content_creation_page":ne=Ve({route:"/content-creation"}),Y=ne.success;break;case"navigate_to_store_dashboard":ne=Ve({route:"/dashboard"}),Y=ne.success;break;case"find_and_open_product":ne=ie(B.args),Y=ne.success;break;case"navigate_to_product_detail_page":ne=$e(B.args),Y=ne.success;break;case"add_to_cart":ne=me(B.args),Y=ne.success;break;case"initiate_purchase":ne=Ue(B.args),Y=ne.success;break;default:ne={success:!1,detail:`Error: Unknown function ${B.name}`}}if(!Y){console.error(`Function ${B.name} execution failed: ${ne.detail}`),w(ce=>ce.map(Ee=>Ee.id===X?{...Ee,text:(Ee.text.replace(/\(Function call: .*\)/,"").trim()+`
(Function ${B.name} failed)`).trim(),functionCallData:null}:Ee));return}const Ne={message:[{functionResponse:{name:B.name,response:{result:ne}}}]};try{const ce=await C.sendMessageStream(Ne);let Ee="";w(Re=>Re.map(Be=>Be.id===X?{...Be,text:"",functionCallData:null,productCardData:null}:Be));for await(const Re of ce){if(Re.functionCalls||Re.functionCall){console.error("Model attempted another function call immediately after a function response.");break}const Be=Re.text;Be&&(Ee+=Be,w(_t=>_t.map(mt=>{if(mt.id===X){const Ht={...mt,text:Ee};return B.name==="find_and_open_product"&&ne.success&&ne.product_found&&(Ht.productCardData=ne.product_data),Ht}return mt})))}B.name==="find_and_open_product"&&ne.success&&ne.product_found&&w(Re=>Re.map(Be=>Be.id===X?{...Be,productCardData:ne.product_data}:Be)),Ee.trim()===""&&(B.name==="find_and_open_product"&&ne.product_found?w(Re=>Re.map(Be=>Be.id===X&&Be.text.trim()===""?{...Be,text:"Here is the product information:"}:Be)):w(Re=>Re.map(Be=>Be.id===X&&Be.text.trim()===""?{...Be,text:"(Function processed)"}:Be)))}catch(ce){console.error("Error sending function response or getting final response from Gemini:",ce),w(Ee=>Ee.map(Re=>Re.id===X?{...Re,text:(Re.text+`
(Error processing function result)`).trim(),functionCallData:null}:Re))}},ct=async()=>{if(C||P)return;A(!0);const B="AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk";try{const X=new _n({apiKey:B}),Y=x.filter(Ee=>Ee.role==="user"||Ee.role==="assistant").map(Ee=>({role:Ee.role==="assistant"?"model":"user",parts:[{text:Ee.text||""}]})).filter(Ee=>Ee.parts.every(Re=>typeof Re.text=="string"&&Re.text.trim()!=="")),Ne={tools:[{functionDeclarations:L}],systemInstruction:h},ce=X.chats.create({model:"gemini-2.5-flash-lite-preview-06-17",history:Y,config:Ne,generationConfig:{}});if(!ce)throw new Error("genAI.chats.create() returned a null or undefined chat instance.");T(ce),_("gemini"),D.current=!1}catch(X){console.error("Error initializing Gemini chat:",X),T(null),_(null)}finally{A(!1)}},Mt=()=>{T(null),A(!1),_(null),D.current=!1};p.useEffect(()=>(l?!C&&!P&&ct():Mt(),()=>Mt()),[l]),p.useEffect(()=>{v==="gemini"?D.current?h&&!P&&C&&(T(null),D.current=!1,ct()):D.current=!0:D.current=!1},[h,v,P,C]);const Sn=(B,X)=>{$e({product_id:B})},en=(B,X)=>{if(!e||!e.id){console.error("Cannot add to cart: current store not available.");return}const ne=r(e.id,B);ne?n(ne,e.id):console.error(`Product with ID ${B} not found, cannot add to cart.`)},rn=async(B,X)=>{const ne=await Ue({product_id:B,product_name:X});ne.success||console.error("Buy Now failed:",ne.detail)},kt=(B,X)=>{var ne;I({id:B,name:X}),(ne=k.current)==null||ne.click()},xn=B=>{var ne,Y,Ne,ce,Ee,Re,Be,_t;if(!B)return null;let X=null;return(Y=(ne=B.image)==null?void 0:ne.src)!=null&&Y.large&&typeof B.image.src.large=="string"?X=B.image.src.large:(ce=(Ne=B.image)==null?void 0:Ne.src)!=null&&ce.medium&&typeof B.image.src.medium=="string"?X=B.image.src.medium:(Re=(Ee=B.image)==null?void 0:Ee.src)!=null&&Re.small&&typeof B.image.src.small=="string"?X=B.image.src.small:B.image_url&&typeof B.image_url=="string"?X=B.image_url:B.imageUrl&&typeof B.imageUrl=="string"?X=B.imageUrl:B.image&&typeof B.image=="string"?X=B.image:B.images&&Array.isArray(B.images)&&B.images.length>0&&((Be=B.images[0])!=null&&Be.src)?X=B.images[0].src:(_t=B.featuredImage)!=null&&_t.url&&(X=B.featuredImage.url),X&&typeof X=="string"&&X.trim()!==""?X.trim():null},re=async B=>{var ne;const X=(ne=B.target.files)==null?void 0:ne[0];if(!X||!E){I(null),k.current&&(k.current.value="");return}w(Y=>[...Y,{id:`system-visualizing-${Date.now()}`,role:"system",text:`Visualizing ${E.name} with your uploaded image. This may take a moment...`}]);try{console.log("[ChatViz] Getting product details for ID:",E.id);const Y=r(e.id,E.id);if(!Y)throw console.error("[ChatViz] Product not found for ID:",E.id),new Error("Product details not found for visualization.");console.log("[ChatViz] Product found:",Y.name);const Ne=xn(Y);if(!Ne)throw console.error("[ChatViz] Product actual image URL is missing or invalid for product:",Y.name,"Raw product data:",Y),new Error("Product does not have a valid existing image to use for visualization context.");console.log("[ChatViz] Actual Product imageUrl to use:",Ne);const ce={name:Y.name,description:Y.description,imageSource:Ne},Ee=`Visualize the product "${Y.name}" in a new scene inspired by the provided reference image. Focus on a creative and appealing composition.`;console.log("[ChatViz] Calling generateProductVisualization...");const Re=await Aq({mainProduct:ce,referenceSceneSource:X,additionalProducts:[],customInstructions:Ee});if(console.log("[ChatViz] generateProductVisualization result:",Re),Re&&Re.imageUrl)w(Be=>[...Be,{id:`assistant-viz-${Date.now()}`,role:"assistant",text:Re.commentary||`Here's a new visualization for ${Y.name}:`,imageDataUrl:Re.imageUrl}]);else throw console.error("[ChatViz] generateProductVisualization did not return an imageUrl. Commentary:",Re==null?void 0:Re.commentary),new Error((Re==null?void 0:Re.commentary)||"Visualization did not return an image.")}catch(Y){console.error("Error during visualization in chat:",Y.name,Y.message,Y.stack),w(Ne=>[...Ne,{id:`error-viz-${Date.now()}`,role:"system",text:`Sorry, I couldn't visualize the product. Error: ${Y.name} - ${Y.message}`}])}finally{I(null),k.current&&(k.current.value="")}};return a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"file",ref:k,style:{display:"none"},accept:"image/*",onChange:re}),!l&&a.jsx($,{onClick:pe,className:"fixed bottom-[96px] right-0 py-4 pl-4 pr-1.5 shadow-lg z-50 rounded-tl-[20px] rounded-bl-[20px] rounded-tr-none rounded-br-none",size:"icon","aria-label":"Open Chatbot",style:{backgroundColor:((Se=e==null?void 0:e.theme)==null?void 0:Se.primaryColor)||"#007bff"},children:a.jsx(roe,{size:20})}),l&&a.jsxs(Ke,{className:"fixed bottom-[96px] right-4 w-full max-w-md h-[70vh] max-h-[600px] shadow-xl z-[1000] flex flex-col bg-background border rounded-lg",children:[a.jsxs(at,{className:"flex flex-row items-center justify-between p-3 border-b",children:[a.jsx(lt,{className:"text-md font-semibold",children:"AI Assistant"}),a.jsxs("div",{className:"flex items-center gap-1",children:[(o==="admin"||i==="edit")&&a.jsx($,{variant:"ghost",size:"icon",onClick:xe,title:"Set Knowledge Base",children:a.jsx(doe,{size:18})}),a.jsx($,{variant:"ghost",size:"icon",onClick:pe,title:"Close Chat",children:a.jsx(Ji,{size:18})})]})]}),u&&a.jsxs("div",{className:"p-3 border-b bg-muted/40",children:[a.jsx("label",{htmlFor:"knowledgeBaseInput",className:"text-xs font-medium mb-1 block text-muted-foreground",children:"Knowledge Base (Instructions for Gemini)"}),a.jsx(Cn,{id:"knowledgeBaseInput",placeholder:"Enter instructions for the assistant...",value:h,onChange:B=>f(B.target.value),className:"h-28 text-xs mb-2 rounded-md"}),a.jsx($,{onClick:we,size:"sm",className:"w-full",disabled:P||!C,children:"Save & Apply Instructions"})]}),a.jsxs(st,{className:"flex-grow p-3 overflow-y-auto space-y-3",children:[x.map(B=>(B.role==="user"||B.role==="assistant")&&a.jsx("div",{className:`flex flex-col ${B.role==="user"?"items-end":"items-start"}`,children:a.jsx("div",{className:`max-w-[80%] p-2.5 rounded-lg text-sm ${B.role==="user"?"bg-primary text-primary-foreground rounded-br-none":"bg-muted rounded-bl-none"}`,children:B.role==="assistant"?a.jsxs(a.Fragment,{children:[B.productCardData&&a.jsx(hRe,{productData:B.productCardData,onViewDetails:Sn,onAddToCart:en,onBuyNow:rn,onVisualize:B.productCardData.imageUrl&&typeof B.productCardData.imageUrl=="string"&&B.productCardData.imageUrl.trim()!==""?kt:null}),B.imageDataUrl&&a.jsx("img",{src:B.imageDataUrl,alt:"Generated visualization",className:"max-w-full h-auto rounded-md my-2"}),B.text&&a.jsx("div",{className:`prose prose-sm max-w-none dark:prose-invert ${B.productCardData||B.imageDataUrl?"mt-2":""}`,children:a.jsx(aRe,{children:B.text})}),!B.productCardData&&!B.text&&!B.imageDataUrl&&a.jsx("p",{className:"whitespace-pre-wrap",children:"(Assistant message)"})]}):a.jsx("p",{className:"whitespace-pre-wrap",children:B.text})})},B.id)),a.jsx("div",{ref:R})]}),a.jsx(vd,{className:"p-3 border-t",children:a.jsxs("div",{className:"flex w-full items-center gap-2",children:[a.jsx(Cn,{placeholder:"Type a message...",value:m,onChange:B=>g(B.target.value),onKeyPress:B=>{B.key==="Enter"&&!B.shiftKey&&(B.preventDefault(),Ie())},className:"flex-grow resize-none text-sm p-2 rounded-md min-h-[40px] max-h-[100px]",rows:1,disabled:!v||P}),a.jsx($,{onClick:()=>Ie(),size:"icon",title:"Send Message",disabled:!m.trim()||!v||P,children:a.jsx(uoe,{size:18})})]})})]})]})};function gRe({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{fillRule:"evenodd",d:"M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.493-12.74a.75.75 0 0 1 1.04-.207Z",clipRule:"evenodd"}))}const yRe=p.forwardRef(gRe),xRe=yRe;function vRe({title:t,titleId:e,...n},r){return p.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":e},n),t?p.createElement("title",{id:e},t):null,p.createElement("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-12.15 12.15a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32L19.513 8.2Z"}))}const wRe=p.forwardRef(vRe),bRe=wRe,qn=({initialText:t,onSave:e,isAdmin:n,placeholder:r="Enter text...",as:s="span",className:i="",textClassName:o="",inputClassName:l="",useTextarea:c=!1})=>{const[u,d]=p.useState(!1),[h,f]=p.useState(t),m=p.useRef(null);p.useEffect(()=>{f(t)},[t]),p.useEffect(()=>{u&&m.current&&(m.current.focus(),m.current.select(),c&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`))},[u,c]);const g=()=>{e&&e(h),d(!1)},x=_=>{f(_.target.value),c&&m.current&&(m.current.style.height="auto",m.current.style.height=`${m.current.scrollHeight}px`)},w=_=>{_.key==="Enter"&&!c?g():_.key==="Escape"&&(f(t),d(!1))},v=s;return n?a.jsx(v,{className:`inline-text-edit-container relative group ${i} ${u?"w-full":""}`,children:u?a.jsxs("div",{className:"flex items-start space-x-1 w-full",children:[" ",c?a.jsx("textarea",{ref:m,value:h,onChange:x,onKeyDown:w,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none resize-none overflow-hidden bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r,rows:1}):a.jsx("input",{ref:m,type:"text",value:h,onChange:x,onKeyDown:w,onBlur:g,className:`p-0 m-0 border-none focus:ring-0 focus:outline-none bg-transparent text-inherit font-inherit w-full ${o} ${l}`,placeholder:r}),a.jsx("button",{onClick:g,className:"p-1 text-green-500 hover:text-green-700 flex-shrink-0",title:"Save",children:a.jsx(xRe,{className:"h-5 w-5"})})]}):a.jsxs("div",{className:`flex items-center space-x-1 cursor-pointer w-full ${o}`,onClick:()=>d(!0),role:"button",tabIndex:0,onKeyDown:_=>{_.key==="Enter"&&d(!0)},children:[a.jsx("span",{className:"flex-grow",children:h||r}),a.jsx(bRe,{className:"h-4 w-4 text-gray-500 opacity-0 group-hover:opacity-100 transition-opacity flex-shrink-0"})]})}):a.jsx(v,{className:o,children:h||r})},_Re=({store:t,isPublishedView:e=!1})=>{var f;const{updateStore:n}=$n(),r=(t==null?void 0:t.name)||"Our Store",s=t==null?void 0:t.id,i=!e,o={title:`The ${r} Way`,subtitle:"Discover the core values that make us unique.",items:[{emoji:"✨",icon:Sr,title:"Quality First",description:"We prioritize premium materials and craftsmanship in every product."},{emoji:"🌿",icon:Qie,title:"Sustainable Practices",description:"Committed to eco-friendly sourcing and ethical production."},{emoji:"⚡️",icon:tU,title:"Innovative Design",description:"Blending timeless styles with modern, cutting-edge aesthetics."},{emoji:"💖",icon:H3,title:"Customer Love",description:"Our customers are at the heart of everything we do."}]},l=((f=t==null?void 0:t.content)==null?void 0:f.storeWay)||o,c=l.items&&l.items.length>0?l.items:o.items,u=async(m,g,x=null)=>{if(!s)return;let w={title:l.title,subtitle:l.subtitle,items:[...c].map(v=>({...v}))};x!==null&&w.items[x]?m==="itemTitle"?w.items[x].title=g:m==="itemDescription"?w.items[x].description=g:m==="itemEmoji"&&(w.items[x].emoji=g):m==="title"?w.title=g:m==="subtitle"&&(w.subtitle=g);try{await n(s,{content:{...t.content,storeWay:w}})}catch(v){console.error(`Failed to update store way content for ${m}:`,v)}},d=({item:m})=>{const g=m.icon||Z3;return a.jsx(g,{className:"w-8 h-8 mb-4 text-[var(--theme-primary)]"})},h=(t==null?void 0:t.template_version)||"classic";return a.jsx("section",{className:"py-16 md:py-24 bg-background",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs(Ct.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"text-center mb-12 md:mb-16",children:[a.jsx("div",{className:`inline-flex items-center justify-center bg-[var(--theme-primary-10)] p-3 mb-4 ${h!=="sleek"?"rounded-full":""}`,children:a.jsx(tw,{className:"h-8 w-8 text-[var(--theme-primary)]"})}),a.jsx(qn,{initialText:l.title,onSave:m=>u("title",m),isAdmin:i,placeholder:"Section Title",as:"h2",textClassName:"text-4xl md:text-5xl font-bold tracking-tight text-foreground"}),a.jsx(qn,{initialText:l.subtitle,onSave:m=>u("subtitle",m),isAdmin:i,placeholder:"Section Subtitle",as:"p",textClassName:"text-lg text-muted-foreground max-w-xl mx-auto mt-3"})]}),a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-8",children:c.map((m,g)=>a.jsxs(Ct.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.4,delay:g*.1+.2},className:`bg-card p-6 shadow-lg text-center border border-border/50 hover:shadow-2xl transition-shadow ${h!=="sleek"?"rounded-xl":""}`,children:[a.jsxs("div",{className:"flex justify-center items-center mb-4",children:[i?a.jsx(qn,{initialText:m.emoji,onSave:x=>u("itemEmoji",x,g),isAdmin:i,placeholder:"✨",textClassName:"text-4xl"}):a.jsx("span",{className:"text-4xl",children:m.emoji}),!m.emoji&&a.jsx(d,{item:m})]}),a.jsx("h3",{className:"text-xl font-semibold mb-2 text-foreground",children:a.jsx(qn,{initialText:m.title,onSave:x=>u("itemTitle",x,g),isAdmin:i,placeholder:"Item Title"})}),a.jsx("p",{className:"text-muted-foreground text-sm",children:a.jsx(qn,{initialText:m.description,onSave:x=>u("itemDescription",x,g),isAdmin:i,placeholder:"Item Description",useTextarea:!0})})]},g))})]})})},Rq="CEVWpXluVU77FgaVriTzqBCoN4FD3f0VL2Y8bXNPynNfqUg2DoUgPt8t",SRe="https://api.pexels.com/videos",CRe="https://api.pexels.com/v1";async function jq(t,e=15){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=t.split(" ")[0],r=`${SRe}/search?query=${encodeURIComponent(n)}&per_page=${e}`;try{const s=await fetch(r,{headers:{Authorization:Rq}});if(!s.ok){const d=await s.json().catch(()=>({message:s.statusText}));return console.error("Pexels API error:",s.status,d),{error:`Pexels API error: ${d.message||s.statusText}`}}const i=await s.json();if(!i.videos||i.videos.length===0)return{videos:[],totalResults:0};const o=Math.floor(Math.random()*i.videos.length),l=i.videos[o],c=l.video_files.find(d=>d.file_type==="video/mp4"&&(d.quality==="hd"||d.quality==="sd"))||l.video_files.find(d=>d.file_type==="video/mp4");return{video:{id:l.id,width:l.width,height:l.height,duration:l.duration,imageUrl:l.image,videoUrl:c?c.link:l.video_files[0]?l.video_files[0].link:null,photographer:l.user.name,pexelsUrl:l.url},totalResults:i.total_results}}catch(s){return console.error("Error fetching from Pexels API:",s),{error:`Network error or other issue fetching Pexels videos: ${s.message}`}}}async function ERe(t,e=9){if(!t||!t.trim())return{error:"Search query cannot be empty."};const n=`${CRe}/search?query=${encodeURIComponent(t)}&per_page=${e}`;try{const r=await fetch(n,{headers:{Authorization:Rq}});if(!r.ok){const o=await r.json().catch(()=>({message:r.statusText}));return console.error("Pexels API error:",r.status,o),{error:`Pexels API error: ${o.message||r.statusText}`}}const s=await r.json();return{photos:s.photos.map(o=>({id:o.id,width:o.width,height:o.height,src:o.src.medium,alt:o.alt,photographer:o.photographer,pexelsUrl:o.url})),totalResults:s.total_results,page:s.page,perPage:s.per_page}}catch(r){return console.error("Error fetching from Pexels API:",r),{error:`Network error or other issue fetching Pexels photos: ${r.message}`}}}const TRe=({open:t,onOpenChange:e,storeId:n,currentVideoUrl:r,onVideoReplaced:s})=>{const{user:i}=ls(),[o,l]=p.useState("ai"),[c,u]=p.useState(""),[d,h]=p.useState(!1),[f,m]=p.useState(null),[g,x]=p.useState(""),[w,v]=p.useState(null),[_,C]=p.useState(!1),[T,R]=p.useState(null),[k,E]=p.useState(null),[I,P]=p.useState(null),[A,D]=p.useState(!1);p.useEffect(()=>{t&&(u(""),h(!1),m(null),x(""),v(null),C(!1),R(null),E(null),P(null),D(!1))},[t]);const j=async()=>{if(!c.trim()){m("Please enter a prompt for the video.");return}h(!0),m(null);try{if(!await ba(i.uid,15)){m("You don't have enough credits to generate a video."),h(!1);return}console.log(`Generating video for store ${n} with prompt: "${c}"`);const W=await Yae(c);s&&s(W),await Qa(i.uid,15),e(!1),u("")}catch(q){console.error("Error generating video with AI:",q),m(q.message||"Failed to generate video. Please try again.")}finally{h(!1)}},M=async()=>{if(!g.trim()){R("Please enter a search query for Pexels.");return}C(!0),R(null),v(null);try{const q=await jq(g);q.error?R(q.error):q.video?v(q.video):R("No video found for your query.")}catch(q){console.error("Error searching Pexels videos:",q),R(q.message||"Failed to search Pexels. Please try again.")}finally{C(!1)}},z=q=>{s&&q?(s(q),e(!1)):R("Invalid video URL selected or replacement handler missing.")},U=q=>{const W=q.target.files[0];if(W){if(W.size>50*1024*1024){P("File is too large. Please select a video under 50MB."),E(null);return}if(!W.type.startsWith("video/")){P("Invalid file type. Please select a video file."),E(null);return}E(W),P(null)}},K=()=>{if(k&&s){D(!0),P(null);const q=new FileReader;q.onloadend=()=>{s(q.result),e(!1),E(null),D(!1)},q.onerror=()=>{P("Failed to read video file for upload."),D(!1)},q.readAsDataURL(k)}else P("No video file selected or replacement handler missing.")};return a.jsx(zr,{open:t,onOpenChange:e,children:a.jsxs(Dr,{className:"w-[90vw] sm:max-w-[672px]",children:[a.jsxs(Mr,{className:"text-left",children:[a.jsx(Lr,{children:"Replace Hero Video"}),a.jsxs(_i,{className:"text-left",children:["Current video: ",a.jsx("a",{href:r,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 underline truncate block max-w-full",children:r||"No video set"})]})]}),a.jsxs(Si,{value:o,onValueChange:l,className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-3",children:[" ",a.jsx(jt,{value:"ai",children:"AI Generation (Veo)"}),a.jsx(jt,{value:"pexels",children:"Search Pexels"}),a.jsx(jt,{value:"upload",children:"Upload Video"})," "]}),a.jsxs(Dt,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"aiPrompt",className:"text-left block mb-1",children:"AI Video Prompt"}),a.jsx(qe,{id:"aiPrompt",value:c,onChange:q=>u(q.target.value),placeholder:"e.g., A futuristic cityscape at sunset",disabled:d})]}),f&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:f}),a.jsxs(Nr,{className:"justify-start pt-4",children:[a.jsx($,{variant:"outline",onClick:()=>e(!1),disabled:d,children:"Cancel"}),a.jsx($,{onClick:j,disabled:d||!c.trim(),children:d?"Generating...":"Generate Video"})]})]}),a.jsxs(Dt,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(qe,{id:"pexelsQuery",value:g,onChange:q=>x(q.target.value),placeholder:"e.g., Nature, Business, Technology",disabled:_,className:"flex-grow"}),a.jsx($,{onClick:M,disabled:_||!g.trim(),children:_?"Searching...":"Search"})]}),T&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:T}),_&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels video..."}),!_&&w&&a.jsx("div",{className:"flex justify-center",children:a.jsxs("div",{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border hover:border-primary w-full max-w-md",onClick:()=>z(w.videoUrl),children:[a.jsx("img",{src:w.imageUrl,alt:`Pexels video by ${w.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-lg font-semibold text-center p-2 bg-black/50 rounded",children:"Use This Video"})})]})}),a.jsx(Nr,{className:"justify-start pt-4",children:a.jsx($,{variant:"outline",onClick:()=>e(!1),disabled:_,children:"Cancel"})})]}),a.jsxs(Dt,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"video-upload-input",className:"text-left block mb-1",children:"Select Video File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(qe,{id:"video-upload-input",type:"file",accept:"video/*",onChange:U,className:"flex-grow",disabled:A})}),k&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",k.name," (",(k.size/1024/1024).toFixed(2)," MB)"]}),I&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:I})]}),a.jsxs(Nr,{className:"justify-start pt-4",children:[a.jsx($,{variant:"outline",onClick:()=>e(!1),disabled:A,children:"Cancel"}),a.jsx($,{onClick:K,disabled:A||!k,children:A?"Uploading...":"Confirm Upload"})]})]})]})]})})},IRe=t=>new Promise((e,n)=>{const r=new FileReader;r.readAsDataURL(t),r.onload=()=>e(r.result),r.onerror=s=>n(s)}),NRe=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageSelected:r,imageSearchContext:s="image",modalTitle:i="Change Image",storeName:o="your store"})=>{const{toast:l}=Ss(),[c,u]=p.useState("search"),[d,h]=p.useState(s),[f,m]=p.useState([]),[g,x]=p.useState(!1),[w,v]=p.useState(`A visually appealing ${s} for ${o}`),_=async()=>{if(d.trim()){x(!0),m([]);try{const k=await lo(d,9,"landscape");m(k.map(E=>({id:E.id.toString(),src:{medium:E.src.large,large:E.src.large},alt:E.alt||d,photographer:E.photographer})))}catch(k){l({title:"Pexels Search Failed",description:k.message,variant:"destructive"})}x(!1)}},C=async()=>{if(w.trim()){x(!0),m([]);try{const k=await L0(w);if(k&&k.url)m([{id:Pt(),src:{medium:k.url,large:k.url},alt:k.alt||w,photographer:"Generated by AI"}]),l({title:"AI Image Generated",description:"Select the image below or generate more."});else throw new Error("AI did not return an image URL.")}catch(k){l({title:"AI Image Generation Failed",description:k.message,variant:"destructive"})}x(!1)}},T=async k=>{const E=k.target.files[0];if(E){x(!0);try{const I=await IRe(E);r(I),l({title:"Image Uploaded",description:"Your image has been selected."}),e(!1)}catch{l({title:"Upload Failed",description:"Could not process the uploaded file.",variant:"destructive"})}x(!1)}},R=k=>{r(k),e(!1)};return p.useEffect(()=>{t&&(h(s||"abstract background"),v(`A visually appealing ${s||"image"} for ${o||"a store"}`),m([]),u("search"))},[t,s,o]),a.jsx(zr,{open:t,onOpenChange:e,children:a.jsxs(Dr,{className:"sm:max-w-2xl md:max-w-3xl lg:max-w-4xl",children:[a.jsx(Mr,{children:a.jsx(Lr,{children:i})}),a.jsxs("div",{className:"py-4",children:[a.jsxs(Si,{value:c,onValueChange:u,className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-3",children:[a.jsx(jt,{value:"search",children:"Search Pexels"}),a.jsx(jt,{value:"ai",children:"Generate with AI"}),a.jsx(jt,{value:"upload",children:"Upload"})]}),a.jsx(Dt,{value:"search",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(qe,{placeholder:"Search for images on Pexels...",value:d,onChange:k=>h(k.target.value),onKeyPress:k=>k.key==="Enter"&&_()}),a.jsxs($,{onClick:_,disabled:g||!d.trim(),children:[g?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(ac,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Search"})]})]})}),a.jsx(Dt,{value:"ai",className:"mt-4",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx(qe,{placeholder:"Describe the image you want AI to generate...",value:w,onChange:k=>v(k.target.value),onKeyPress:k=>k.key==="Enter"&&C()}),a.jsxs($,{onClick:C,disabled:g||!w.trim(),children:[g?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Ea,{className:"h-4 w-4"}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Generate"})]})]})}),a.jsxs(Dt,{value:"upload",className:"mt-4",children:[a.jsx(ke,{htmlFor:"image-upload-input",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Upload your own image:"}),a.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 dark:border-gray-600 border-dashed rounded-md",children:a.jsxs("div",{className:"space-y-1 text-center",children:[a.jsx(Uo,{className:"mx-auto h-12 w-12 text-gray-400"}),a.jsxs("div",{className:"flex text-sm text-gray-600 dark:text-gray-400",children:[a.jsxs("label",{htmlFor:"image-upload-input-file",className:"relative cursor-pointer bg-white dark:bg-gray-800 rounded-md font-medium text-primary hover:text-primary-focus focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-primary-ring",children:[a.jsx("span",{children:"Upload a file"}),a.jsx(qe,{id:"image-upload-input-file",name:"image-upload-input-file",type:"file",className:"sr-only",accept:"image/*",onChange:T})]}),a.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),a.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"PNG, JPG, GIF up to 10MB"})]})})]})]}),g&&f.length===0&&a.jsxs("div",{className:"text-center py-10",children:[a.jsx(ft,{className:"h-8 w-8 animate-spin mx-auto text-primary"}),a.jsx("p",{className:"mt-2 text-sm text-muted-foreground",children:"Fetching images..."})]}),f.length>0&&a.jsx(ScrollArea,{className:"mt-4 max-h-[50vh]",children:a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3 p-1",children:f.map(k=>a.jsxs(Ct.div,{className:"relative aspect-video rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>R(k.src.large||k.src.medium),whileHover:{scale:1.03},initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:[a.jsx("img",{src:k.src.medium,alt:k.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/40 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(PRe,{className:"h-10 w-10 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/60 text-white text-[10px] p-1 truncate text-center",children:k.photographer||k.alt||"Untitled"})]},k.id))})})]}),a.jsx(Nr,{children:a.jsx(al,{asChild:!0,children:a.jsx($,{type:"button",variant:"outline",children:"Cancel"})})})]})})},PRe=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),ARe=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");e({base64ImageData:i,mimeType:o[1]})}catch(r){n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o=s.toDataURL("image/png"),l="image/png";(!o||o.length<100)&&(o=s.toDataURL("image/jpeg"),l="image/jpeg");const c=o.split(",");e({base64ImageData:c[1],mimeType:l})}catch(o){n(new Error("Canvas toDataURL failed: "+o.message))}},r.onerror=()=>n(new Error("Failed to load image from URL for conversion.")),r.src=t}}),kRe=({isOpen:t,onOpenChange:e,currentImageUrl:n,onImageEdited:r,imageContext:s="image",modalTitle:i="Edit Image with AI"})=>{const{toast:o}=Ss(),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState("");p.useEffect(()=>{t&&n&&(f(n),c(""))},[t,n]);const m=async()=>{if(!l.trim()||!h){o({title:"Missing data",description:"Image or edit prompt is missing.",variant:"destructive"});return}d(!0);try{const{base64ImageData:g,mimeType:x}=await ARe(h),w=await Wo(g,x,l);if(w&&w.editedImageData&&w.newMimeType){const v=`data:${w.newMimeType};base64,${w.editedImageData}`;r(v),o({title:"Image Edited",description:"Image updated with AI edit."}),e(!1)}else throw new Error((w==null?void 0:w.textResponse)||"AI did not return an edited image.")}catch(g){console.error("Error editing image:",g),o({title:"Image Edit Failed",description:g.message,variant:"destructive"})}d(!1)};return a.jsx(zr,{open:t,onOpenChange:e,children:a.jsxs(Dr,{className:"sm:max-w-md",children:[a.jsx(Mr,{children:a.jsx(Lr,{children:i})}),a.jsxs("div",{className:"space-y-4 py-4",children:[h&&a.jsxs("div",{className:"flex flex-col items-center space-y-2 mb-4",children:[a.jsx("img",{src:h,alt:`Current ${s} to edit`,className:"max-h-48 w-auto object-contain rounded border"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Editing: Current ",s]})]}),a.jsx(ke,{htmlFor:"editPrompt",className:"text-left",children:"Edit Instruction:"}),a.jsx(Cn,{id:"editPrompt",placeholder:`e.g., 'make the background blue', 'add sparkles to the ${s}'`,value:l,onChange:g=>c(g.target.value),rows:3,className:"resize-none"})]}),a.jsxs(Nr,{children:[a.jsx(al,{asChild:!0,children:a.jsx($,{type:"button",variant:"outline",disabled:u,children:"Cancel"})}),a.jsxs($,{onClick:m,disabled:u||!l.trim(),children:[u?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Ea,{className:"mr-2 h-4 w-4"}),"Apply Edit"]})]})]})})},Dq=({store:t,isPublishedView:e=!1})=>{var L,ee,pe,xe,we,Ie,Fe,Ve,Ge,fe,je;const{updateStore:n,updateStoreTextContent:r}=$n(),[s,i]=p.useState(0),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(!1),[w,v]=p.useState(null),_=p.useRef(null),C={Shield:hoe,Truck:iw,CreditCard:Do,Headphones:A2,Star:VI,Zap:tU,GlobeIcon:Ou,AwardIcon:Vie,UsersIcon:$0,HeartIcon:H3,CheckCircle:ya,Sparkles:Sr,ArrowRight:Fu,Play:$I,Pause:ooe,Package:Vi},T=K0e(_,{once:!0,margin:"-100px"}),{scrollYProgress:R}=W0e({target:_,offset:["start end","end start"]}),k=$S(R,[0,1],[100,-100]),E=$S(R,[0,.2,.8,1],[0,1,1,0]),I=$S(R,[0,.2,.8,1],[.9,1,1,.9]),P=((L=t==null?void 0:t.theme)==null?void 0:L.primaryColor)||"#6366F1",A=t==null?void 0:t.id,D=!e,j={title:"An Exceptional Experience",subtitle:"We're committed to providing you with the best shopping experience through our premium services and customer-first approach.",items:[{emoji:"",iconName:"Zap",title:"Smart Solutions",description:"Innovative products designed for modern living and efficiency.",color:"#007AFF",stats:"Future Ready",image:"https://images.pexels.com/photos/373543/pexels-photo-373543.jpeg?auto=compress&cs=tinysrgb&w=600&q=80",videoUrl:""},{emoji:"🚚",icon:iw,title:"Fast Delivery",description:"Free shipping worldwide with express delivery options available.",color:"#3B82F6",stats:"2-3 Days",image:"https://images.unsplash.com/photo-1566576912321-d58ddd7a6088?w=600&q=80"},{emoji:"💳",icon:Do,title:"Easy Returns",description:"30-day hassle-free returns with full refund guarantee.",color:"#8B5CF6",stats:"30 Days",image:"https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=600&q=80"},{emoji:"🎧",icon:A2,title:"24/7 Support",description:"Round-the-clock customer support via chat, email, and phone.",color:"#F59E0B",stats:"Always On",image:"https://images.unsplash.com/photo-1553484771-371a605b060b?w=600&q=80"}],secondaryItems:[{iconName:"GlobeIcon",title:"Global Reach",description:"Serving customers in 50+ countries"},{iconName:"AwardIcon",title:"Premium Quality",description:"Certified products with quality guarantee"},{iconName:"UsersIcon",title:"Community Driven",description:"Join 100K+ satisfied customers"},{iconName:"HeartIcon",title:"Eco-Conscious",description:"Sustainable packaging and practices"}],statsItems:[{iconName:"UsersIcon",number:"50K+",label:"Happy Customers"},{iconName:"ZapIcon",number:"99.9%",label:"Uptime"},{iconName:"HeadphonesIcon",number:"24/7",label:"Support"},{iconName:"StarIcon",number:"4.9★",label:"Rating"}]},M=(ee=t==null?void 0:t.content)!=null&&ee.storeFeatures?{...j,...t.content.storeFeatures,items:t.content.storeFeatures.items&&t.content.storeFeatures.items.length>0?t.content.storeFeatures.items:j.items,secondaryItems:t.content.storeFeatures.secondaryItems&&t.content.storeFeatures.secondaryItems.length>0?t.content.storeFeatures.secondaryItems:j.secondaryItems,statsItems:t.content.storeFeatures.statsItems&&t.content.storeFeatures.statsItems.length>0?t.content.storeFeatures.statsItems:j.statsItems}:j,z=M.items&&M.items.length>0?M.items:j.items;p.useEffect(()=>{const ie=async()=>{const $e=z[s];if($e&&!$e.videoUrl){const me=$e.title||$e.description||"modern abstract motion";try{console.log(`[Modern StoreFeatures] Fetching Pexels video for active feature "${me}"`);const Ue=await jq(me);Ue&&Ue.video?(l(Ue.video.videoUrl),u(Ue.video.imageUrl)):(console.warn(`No Pexels video found for query: "${me}". Clearing previous Pexels video.`),l(null),u(null))}catch(Ue){console.error(`Failed to fetch Pexels video for query "${me}":`,Ue),l(null),u(null)}}else $e&&$e.videoUrl&&(l(null),u(null))};z&&z.length>0&&s<z.length&&ie()},[s,z]);const U=async(ie,$e)=>{!A||!D||console.log(`[ModernStoreFeatures] handleSaveText called with field: ${ie}, value: ${$e}. This might be redundant if InlineTextEdit is used.`)},K=ie=>{v(ie),m(!0)},q=async ie=>{if(A==null||w==null||!ie)return;const $e=JSON.parse(JSON.stringify(M));if($e.items&&$e.items[w])$e.items[w].image=ie,$e.items[w].videoUrl="";else{console.error("Cannot update feature image: active feature item not found."),m(!1);return}try{await n(A,{content:{...t.content,storeFeatures:$e}})}catch(me){console.error("Failed to update store with new feature image URL:",me)}m(!1),v(null)},W=()=>h(!0),te=async ie=>{if(!A||!D||s===null||!z[s])return;const $e=JSON.parse(JSON.stringify(M));if($e.items&&$e.items[s])$e.items[s].videoUrl=ie,$e.items[s].image="",l(null),u(null);else{console.error("Cannot update video URL: active feature item not found."),h(!1);return}try{await n(A,{content:{...t.content,storeFeatures:$e}})}catch(me){console.error("Failed to update store with new feature video URL:",me)}h(!1)},O={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1,delayChildren:.2}}},V={hidden:{opacity:0,y:30},visible:{opacity:1,y:0,transition:{duration:.6,ease:[.25,.46,.45,.94]}}},H={hidden:{opacity:0,x:-50},visible:{opacity:1,x:0,transition:{duration:.8,ease:[.25,.46,.45,.94]}}};return a.jsxs("section",{ref:_,className:"relative py-20 gradient-bg overflow-hidden",id:`features-${A}`,children:[a.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[a.jsx(Ct.div,{className:"absolute top-20 left-20 w-96 h-96 bg-primary/5 blur-3xl rounded-full",style:{backgroundColor:`${P}10`,y:k}}),a.jsx(Ct.div,{className:"absolute bottom-20 right-20 w-80 h-80 bg-secondary/5 blur-3xl rounded-full",style:{y:k}}),a.jsx(Ct.div,{className:"absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-[600px] h-[600px] bg-accent/5 blur-3xl rounded-full",animate:{scale:[1,1.1,1],opacity:[.3,.5,.3]},transition:{duration:8,repeat:1/0}})]}),a.jsxs(Ct.div,{className:"container mx-auto px-6 relative z-10",style:{opacity:E,scale:I},children:[a.jsxs(Ct.div,{variants:O,initial:"hidden",animate:T?"visible":"hidden",className:"text-center mb-20",children:[a.jsxs(Ct.div,{variants:V,className:"inline-flex items-center gap-2 px-4 py-2 bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-full text-sm font-medium mb-6",style:{color:P,borderColor:`${P}30`},children:[a.jsx(Sr,{className:"w-4 h-4"}),a.jsx("span",{children:"Why Choose Us"})]}),a.jsx(Ct.h2,{variants:V,className:"text-4xl md:text-5xl lg:text-6xl font-bold text-gray-900 dark:text-white mb-6 tracking-tight",children:a.jsx(qn,{initialText:M.title,onSave:ie=>U("title",ie),isAdmin:D,placeholder:"Section Title",as:"span",textClassName:"bg-gradient-to-r from-gray-900 via-primary to-gray-900 dark:from-white dark:via-primary dark:to-white bg-clip-text text-transparent",style:{backgroundImage:`linear-gradient(90deg, currentColor, ${P}, currentColor)`}})}),a.jsx(Ct.p,{variants:V,className:"text-xl text-muted-foreground max-w-3xl mx-auto leading-relaxed",children:a.jsx(qn,{initialText:M.subtitle,onSave:ie=>U("subtitle",ie),isAdmin:D,placeholder:"Section Subtitle",as:"span"})})]}),a.jsxs(Ct.div,{variants:O,initial:"hidden",animate:T?"visible":"hidden",className:"grid lg:grid-cols-2 gap-16 mb-20",children:[a.jsx(Ct.div,{variants:H,className:"space-y-6",children:z.map((ie,$e)=>{const me=ie.icon||Vi,Ue=s===$e;return a.jsx(Ct.div,{className:`p-6 rounded-3xl border transition-all duration-500 cursor-pointer ${Ue?"bg-white/20 dark:bg-black/20 border-white/30 dark:border-white/20 shadow-float-lg":"bg-white/10 dark:bg-black/10 border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15"}`,onClick:()=>i($e),whileHover:{scale:1.02,y:-5},whileTap:{scale:.98},initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{delay:$e*.1},children:a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("div",{className:"w-16 h-16 rounded-2xl flex items-center justify-center shadow-lg text-3xl",style:{backgroundColor:ie.color||P+"30"},children:ie.emoji||a.jsx(me,{className:"w-8 h-8 text-white"})}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-white",children:a.jsx(qn,{initialText:ie.title,onSave:et=>U("itemTitle",et),isAdmin:D,placeholder:"Feature Title"})}),ie.stats&&a.jsx(yg,{variant:"secondary",className:"text-xs font-medium",style:{backgroundColor:`${ie.color||P}20`,color:ie.color||P},children:ie.stats})]}),a.jsx("p",{className:"text-muted-foreground leading-relaxed",children:a.jsx(qn,{initialText:ie.description,onSave:et=>U("itemDescription",et),isAdmin:D,placeholder:"Feature Description",useTextarea:!0})}),Ue&&a.jsx(Ct.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 pt-4 border-t border-white/20 dark:border-white/10",children:a.jsxs($,{variant:"outline",size:"sm",className:"group",style:{borderColor:ie.color||P,color:ie.color||P},children:["Learn More",a.jsx(Fu,{className:"w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform"})]})})]})]})},ie.title+$e)})}),z[s]&&a.jsxs(Ct.div,{variants:V,className:"relative aspect-square lg:aspect-[4/3] rounded-3xl overflow-hidden shadow-float-lg group",children:[!e&&z[s]&&a.jsx("div",{className:"absolute top-3 left-3 z-20 flex flex-col gap-2 opacity-0 group-hover:opacity-100 transition-opacity",children:(pe=z[s])!=null&&pe.videoUrl||o?a.jsxs($,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:W,title:"Replace Feature Video",children:[a.jsx(R2,{className:"h-4 w-4 mr-1"})," Replace Video"]}):a.jsxs(a.Fragment,{children:[a.jsxs($,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>K(s),title:"Change Feature Image",children:[a.jsx(R2,{className:"h-4 w-4 mr-1"})," Change Image"]}),a.jsxs($,{variant:"outline",size:"sm",className:"bg-background/70 hover:bg-background/90 text-foreground rounded-md p-2",onClick:()=>{v(s),x(!0)},title:"Edit Feature Image with AI",children:[a.jsx(Ea,{className:"h-4 w-4 mr-1"})," Edit with AI"]})]})}),(xe=z[s])!=null&&xe.videoUrl?a.jsx("video",{src:z[s].videoUrl,poster:z[s].image||c||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`feat-video-${s}`):o?a.jsx("video",{src:o,poster:c||((we=z[s])==null?void 0:we.image)||"",autoPlay:!0,loop:!0,muted:!0,playsInline:!0,className:"absolute inset-0 w-full h-full object-cover"},`current-pexels-video-${s}`):(Ie=z[s])!=null&&Ie.image?a.jsx(Ct.img,{src:z[s].image,alt:z[s].title||"Modern feature image",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`feat-img-${s}`):a.jsx(Ct.img,{src:"https://images.pexels.com/photos/1571460/pexels-photo-1571460.jpeg?auto=compress&cs=tinysrgb&w=600",alt:"Default modern feature background",className:"absolute inset-0 w-full h-full object-cover",initial:{opacity:0,scale:1.1},animate:{opacity:1,scale:1},transition:{duration:.8}},`fallback-img-${s}`),a.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/40 via-transparent to-transparent"}),a.jsx(Ct.div,{className:"absolute bottom-6 left-6 right-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:a.jsxs("div",{className:"bg-white/10 dark:bg-black/10 backdrop-blur-md border border-white/20 dark:border-white/10 rounded-2xl p-6",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[a.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center text-2xl",style:{backgroundColor:z[s].color||P+"30"},children:z[s].emoji||ht.createElement(z[s].icon||Vi,{className:"w-6 h-6 text-white"})}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-lg font-bold text-white",children:z[s].title}),z[s].stats&&a.jsx("p",{className:"text-sm text-gray-200",children:z[s].stats})]})]}),a.jsx("p",{className:"text-gray-200 text-sm leading-relaxed",children:z[s].description})]})},`overlay-${s}`),a.jsx(Ct.div,{className:"absolute -top-4 -right-4 w-24 h-24 bg-white/20 dark:bg-black/20 backdrop-blur-md rounded-2xl flex items-center justify-center border border-white/30 dark:border-white/20 z-10",animate:{y:[-8,8,-8],rotate:[0,10,0]},transition:{duration:6,repeat:1/0},children:a.jsx(ya,{className:"w-12 h-12 text-green-400"})})]})]}),a.jsx(Ct.div,{variants:O,initial:"hidden",animate:T?"visible":"hidden",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-16",children:(M.secondaryItems||[]).map((ie,$e)=>{const me=C[ie.iconName]||Vi;return a.jsxs(Ct.div,{variants:V,className:"text-center p-6 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10 hover:bg-white/15 dark:hover:bg-black/15 transition-all duration-300",whileHover:{scale:1.05,y:-5},children:[a.jsx("div",{className:"w-16 h-16 mx-auto mb-4 rounded-2xl flex items-center justify-center shadow-lg",style:{backgroundColor:P},children:a.jsx(me,{className:"w-8 h-8 text-white"})}),a.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-white mb-2",children:a.jsx(qn,{initialText:ie.title,onSave:Ue=>U(`secondaryItemTitle.${$e}`,Ue),isAdmin:D,placeholder:"Feature Title"})}),a.jsx("p",{className:"text-sm text-muted-foreground leading-relaxed",children:a.jsx(qn,{initialText:ie.description,onSave:Ue=>U(`secondaryItemDescription.${$e}`,Ue),isAdmin:D,placeholder:"Feature Description",useTextarea:!0})})]},ie.title+$e)})}),a.jsx(Ct.div,{variants:O,initial:"hidden",animate:T?"visible":"hidden",className:"grid grid-cols-2 md:grid-cols-4 gap-8 p-8 bg-white/10 dark:bg-black/10 backdrop-blur-md rounded-3xl border border-white/20 dark:border-white/10",children:(M.statsItems||[]).map((ie,$e)=>{const me=C[ie.iconName]||Vi;return a.jsxs(Ct.div,{variants:V,className:"text-center",children:[a.jsx("div",{className:"w-12 h-12 mx-auto mb-3 rounded-xl flex items-center justify-center",style:{backgroundColor:`${P}20`},children:a.jsx(me,{className:"w-6 h-6",style:{color:P}})}),a.jsx("div",{className:"text-3xl font-bold text-gray-900 dark:text-white mb-1",children:a.jsx(qn,{initialText:ie.number,onSave:Ue=>U("statsItemNumber",Ue),isAdmin:D,placeholder:"Stat Number"})}),a.jsx("div",{className:"text-sm text-muted-foreground",children:a.jsx(qn,{initialText:ie.label,onSave:Ue=>U("statsItemLabel",Ue),isAdmin:D,placeholder:"Stat Label"})})]},ie.label+$e)})})]}),!e&&A&&a.jsx(TRe,{open:d,onOpenChange:h,storeId:A,currentVideoUrl:((Fe=z[s])==null?void 0:Fe.videoUrl)||o,onVideoReplaced:te}),!e&&A&&w!==null&&z[w]&&a.jsx(NRe,{isOpen:f,onOpenChange:m,currentImageUrl:(Ve=z[w])==null?void 0:Ve.image,onImageSelected:ie=>q(ie),imageSearchContext:`feature image for ${((Ge=z[w])==null?void 0:Ge.title)||"section"}`,modalTitle:"Change Feature Image",storeName:t.name}),!e&&A&&w!==null&&z[w]&&a.jsx(kRe,{isOpen:g,onOpenChange:x,currentImageUrl:(fe=z[w])==null?void 0:fe.image,onImageEdited:ie=>q(ie),imageContext:`feature image for "${((je=z[w])==null?void 0:je.title)||"section"}"`,modalTitle:"Edit Feature Image with AI"})]})},RRe=Object.freeze(Object.defineProperty({__proto__:null,default:Dq},Symbol.toStringTag,{value:"Module"})),jRe=()=>{var de,ae;console.log("[StorePreview] Component mounted.");const{storeName:t,productHandle:e}=k0();console.log("[StorePreview] storeName from params:",t);const{getStoreByName:n,getStoreBySlug:r,getStoreById:s,currentStore:i,setCurrentStore:o,updateStore:l,viewMode:c,isLoadingStores:u,user:d}=$n(),{toast:h}=Ss(),[f,m]=p.useState(null),[g,x]=p.useState(!1),[w,v]=p.useState(null);p.useEffect(()=>{f&&v(f.template_version)},[f]);const[_,C]=p.useState(null),[T,R]=p.useState(null),[k,E]=p.useState(null),[I,P]=p.useState(null),[A,D]=p.useState(null),[j,M]=p.useState(null),[z,U]=p.useState(null),[K,q]=p.useState(null),[W,te]=p.useState(null),[O,V]=p.useState(null),[H,L]=p.useState(null),[ee,pe]=p.useState(null),[xe,we]=p.useState(null),[Ie,Fe]=p.useState(null),[Ve,Ge]=p.useState(null),[fe,je]=p.useState(null),[ie,$e]=p.useState(null),[me,Ue]=p.useState(null),[et,ct]=p.useState(null),[Mt,Sn]=p.useState(null),[en,rn]=p.useState(null),[kt,xn]=p.useState(null),[re,Se]=p.useState(null),[B,X]=p.useState(null),[ne,Y]=p.useState(null),[Ne,ce]=p.useState(null),[Ee,Re]=p.useState(null),[Be,_t]=p.useState(null),[mt,Ht]=p.useState(null),[tn,Rt]=p.useState(null),[sn,In]=p.useState(null),[Fr,zn]=p.useState(null),[wr,un]=p.useState(null),[Nn,dn]=p.useState(null),[cs,Z]=p.useState(null),[he,_e]=p.useState(null),[Me,Qe]=p.useState(null),[Q,se]=p.useState(null),[ye,J]=p.useState(null),[le,be]=p.useState(null),[Te,Le]=p.useState(null),[Ce,it]=p.useState(null),[ut,Nt]=p.useState(null),[vn,es]=p.useState(null),[Vn,Wr]=p.useState(null),[Ei,Us]=p.useState(null),[ri,Bs]=p.useState(null),[us,Jt]=p.useState(null),[Pn,si]=p.useState(null),[Ti,Ln]=p.useState(null),[ii,_o]=p.useState(!1),[Qo,eu]=p.useState(""),[Wf,tu]=p.useState(!1),[nu,ru]=p.useState(!1);p.useEffect(()=>{(async()=>{if(!t||g)return;x(!0);let ue=null;i&&i.urlSlug===t?ue=i:(ue=n(t),ue||(ue=await r(t))),ue?(m(ue),(!i||i.id!==ue.id)&&o(ue)):u||(h({title:"Store Not Found",description:`Could not find store with slug: ${t}`,variant:"destructive"}),m(null)),x(!1)})()},[t,u,g,i,n,r,o,h]),p.useEffect(()=>{const oe=w||(f==null?void 0:f.template_version),ue=document.documentElement;f&&f.theme?(f.theme.primaryColor?ue.style.setProperty("--theme-primary-color",f.theme.primaryColor):ue.style.removeProperty("--theme-primary-color"),f.theme.secondaryColor?ue.style.setProperty("--theme-secondary-color",f.theme.secondaryColor):ue.style.removeProperty("--theme-secondary-color"),oe==="premium"?(ue.style.setProperty("--premium-gradient-start-color",f.theme.primaryColor||"#667eea"),ue.style.setProperty("--premium-gradient-end-color",f.theme.secondaryColor||"#764ba2")):(ue.style.removeProperty("--premium-gradient-start-color"),ue.style.removeProperty("--premium-gradient-end-color"))):(ue.style.removeProperty("--theme-primary-color"),ue.style.removeProperty("--theme-secondary-color"),ue.style.removeProperty("--premium-gradient-start-color"),ue.style.removeProperty("--premium-gradient-end-color"));let Pe=!1;return oe==="sharp"&&(ue.classList.contains("dark")||(ue.classList.add("dark"),Pe=!0)),()=>{Pe&&oe!=="sharp"&&ue.classList.contains("dark")}},[f==null?void 0:f.theme,f==null?void 0:f.template_version,w]),p.useEffect(()=>{if(f){const oe=w||f.template_version||"classic";console.log(`[StorePreview] Loading components for template: ${oe}`),Nt(null),es(null),Wr(null),Us(null),Bs(null),Jt(null),si(null),Ln(null),C(null),R(null),E(null),P(null),D(null),M(null),U(null),q(null),te(null),V(null),L(null),pe(null),we(null),Fe(null),Ge(null),je(null),$e(null),Ue(null),ct(null),Sn(null),rn(null),xn(null),Se(null),X(null),Y(null),ce(null),Re(null),_t(null),Ht(null),Rt(null),In(null),zn(null),un(null),dn(null),Z(null),_e(null),Qe(null),se(null),J(null),be(null),Le(null),it(null),Le(()=>_Re),it(()=>Dq),oe==="classic"?(Nt(()=>p.lazy(()=>At(()=>Promise.resolve().then(()=>MRe),void 0))),es(()=>p.lazy(()=>At(()=>import("./StoreHero-b9de3374.js"),[]))),Wr(()=>p.lazy(()=>At(()=>import("./StoreCollections-42f76cab.js"),["assets/StoreCollections-42f76cab.js","assets/CollectionProductsDialog-151ef3ae.js"]))),Us(()=>p.lazy(()=>At(()=>import("./ProductGrid-83825688.js"),["assets/ProductGrid-83825688.js","assets/list-36439a30.js","assets/filter-aead4891.js"]))),Bs(()=>p.lazy(()=>At(()=>import("./StoreFeatures-4c5b0c9a.js"),["assets/StoreFeatures-4c5b0c9a.js","assets/shield-check-76ed568d.js","assets/message-square-c31aa9cb.js"]))),Jt(()=>p.lazy(()=>At(()=>import("./StoreTestimonials-7656e258.js"),["assets/StoreTestimonials-7656e258.js","assets/user-circle-403087e4.js"]))),si(()=>p.lazy(()=>At(()=>import("./StoreNewsletter-94899f5d.js"),[]))),Ln(()=>p.lazy(()=>At(()=>Promise.resolve().then(()=>LRe),void 0)))):oe==="modern"?(C(()=>p.lazy(()=>At(()=>import("./StoreHeader-51a73e53.js"),["assets/StoreHeader-51a73e53.js","assets/minus-9da54c3a.js"]))),R(()=>p.lazy(()=>At(()=>import("./StoreHero-966b6d17.js"),[]))),E(()=>p.lazy(()=>At(()=>Promise.resolve().then(()=>RRe),void 0))),P(()=>p.lazy(()=>At(()=>import("./StoreCollections-604d3be6.js"),[]))),D(()=>p.lazy(()=>At(()=>import("./ProductGrid-27355dd6.js"),["assets/ProductGrid-27355dd6.js","assets/minus-9da54c3a.js","assets/crown-e5d77234.js","assets/list-36439a30.js"]))),M(()=>p.lazy(()=>At(()=>import("./Footer-a59a8d51.js"),[])))):oe==="premium"?(U(()=>p.lazy(()=>At(()=>import("./Header-8ac395bd.js"),[]))),q(()=>p.lazy(()=>At(()=>import("./Hero-c9996610.js"),[]))),te(()=>p.lazy(()=>At(()=>import("./FeaturedProducts-45eda4e7.js"),["assets/FeaturedProducts-45eda4e7.js","assets/minus-9da54c3a.js","assets/crown-e5d77234.js","assets/list-36439a30.js","assets/filter-aead4891.js"]))),V(()=>p.lazy(()=>At(()=>import("./CategoryShowcase-bcd61b8f.js"),["assets/CategoryShowcase-bcd61b8f.js","assets/CollectionProductsDialog-151ef3ae.js"]))),L(()=>p.lazy(()=>At(()=>import("./SocialProof-90428cba.js"),[]))),pe(()=>p.lazy(()=>At(()=>import("./Newsletter-2755cf14.js"),[]))),we(()=>p.lazy(()=>At(()=>import("./Footer-e765c8a0.js"),[])))):oe==="sharp"?(Fe(()=>p.lazy(()=>At(()=>import("./StoreHeader-45edd065.js"),[]))),Ge(()=>p.lazy(()=>At(()=>import("./StoreHero-059705d6.js"),["assets/StoreHero-059705d6.js","assets/ReplaceVideoModal-80a42644.js"]))),je(()=>p.lazy(()=>At(()=>import("./StoreFeatures-d617c8df.js"),[]))),$e(()=>p.lazy(()=>At(()=>import("./ProductGrid-701ce2e3.js"),["assets/ProductGrid-701ce2e3.js","assets/list-36439a30.js"]))),Ue(()=>p.lazy(()=>At(()=>import("./Testimonials-bc30eae7.js"),["assets/Testimonials-bc30eae7.js","assets/message-square-c31aa9cb.js","assets/user-circle-403087e4.js"]))),ct(()=>p.lazy(()=>At(()=>import("./ImageRightSection-47e709af.js"),[]))),Sn(()=>p.lazy(()=>At(()=>import("./VideoLeftSection-1dc17b28.js"),["assets/VideoLeftSection-1dc17b28.js","assets/ReplaceVideoModal-80a42644.js"]))),rn(()=>p.lazy(()=>At(()=>import("./HeroFollowUpVideo-0b1dc475.js"),["assets/HeroFollowUpVideo-0b1dc475.js","assets/ReplaceVideoModal-80a42644.js"]))),xn(()=>p.lazy(()=>At(()=>import("./Newsletter-802ce517.js"),[]))),Se(()=>p.lazy(()=>At(()=>import("./Footer-eb1ba37d.js"),[])))):oe==="fresh"?(X(()=>p.lazy(()=>At(()=>import("./StoreHeader-07d5aae9.js"),[]))),Y(()=>p.lazy(()=>At(()=>import("./StoreHero-b5af6739.js"),[]))),ce(()=>p.lazy(()=>At(()=>import("./StoreFeatures-d5368d6d.js"),[]))),Re(()=>p.lazy(()=>At(()=>import("./ProductGrid-b9fc6a4c.js"),["assets/ProductGrid-b9fc6a4c.js","assets/list-36439a30.js"]))),_t(()=>p.lazy(()=>At(()=>import("./StoreCollections-9849994b.js"),["assets/StoreCollections-9849994b.js","assets/CollectionProductsDialog-151ef3ae.js"]))),Ht(()=>p.lazy(()=>At(()=>import("./Testimonials-b2ed2703.js"),["assets/Testimonials-b2ed2703.js","assets/user-circle-403087e4.js"]))),Rt(()=>p.lazy(()=>At(()=>import("./Newsletter-49d8b326.js"),[]))),In(()=>p.lazy(()=>At(()=>import("./Footer-17094ae0.js"),["assets/Footer-17094ae0.js","assets/shield-check-76ed568d.js"])))):oe==="sleek"&&(zn(()=>p.lazy(()=>At(()=>import("./StoreHeader-2d148a7f.js"),[]))),un(()=>p.lazy(()=>At(()=>import("./StoreHero-9eb47ecf.js"),[]))),dn(()=>p.lazy(()=>At(()=>import("./ProductGrid-06971a7b.js"),["assets/ProductGrid-06971a7b.js","assets/list-36439a30.js","assets/filter-aead4891.js"]))),Z(()=>p.lazy(()=>At(()=>import("./StoreFeatures-da5bccba.js"),[]))),_e(()=>p.lazy(()=>At(()=>import("./Testimonials-cde58748.js"),["assets/Testimonials-cde58748.js","assets/user-circle-403087e4.js"]))),Qe(()=>p.lazy(()=>At(()=>import("./Newsletter-03f2f852.js"),[]))),se(()=>p.lazy(()=>At(()=>import("./Footer-fa707b24.js"),[]))),J(()=>p.lazy(()=>At(()=>import("./StoreCollections-624415f6.js"),[]))),be(()=>p.lazy(()=>At(()=>import("./StoreWaySection-16755b4b.js"),[]))))}},[f==null?void 0:f.id,w]);const Ed=()=>{if(!f||!f.pass_key){tu(!0);return}ru(!0),setTimeout(()=>{Qo===f.pass_key?(tu(!0),h({title:"Access Granted",description:"Welcome to the store!"})):(h({title:"Access Denied",description:"Incorrect pass key.",variant:"destructive"}),eu("")),ru(!1)},500)};if(u||g||!f)return a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading store..."})]})});if(!Wf&&f.pass_key)return a.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800 p-4",children:a.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-2xl w-full max-w-md text-center",children:[a.jsx(eoe,{className:"h-16 w-16 text-primary mx-auto mb-6"}),a.jsx("h2",{className:"text-3xl font-bold text-card-foreground mb-3",children:"Protected Store"}),a.jsx("p",{className:"text-muted-foreground mb-8",children:"This store requires a pass key to view its content."}),a.jsxs("div",{className:"flex flex-col gap-4",children:[a.jsx(qe,{type:"password",placeholder:"Enter Pass Key",value:Qo,onChange:oe=>eu(oe.target.value),className:"h-12 text-lg text-center bg-input border-border focus:ring-primary focus:border-primary",onKeyPress:oe=>oe.key==="Enter"&&Ed()}),a.jsx($,{onClick:Ed,disabled:nu||!Qo.trim(),className:"h-12 text-lg w-full bg-primary hover:bg-primary/90 text-primary-foreground",children:nu?a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-current"}):a.jsxs(a.Fragment,{children:[a.jsx(goe,{className:"mr-2 h-5 w-5"})," Access Store"]})})]})]})});const vt=c==="published";let Xn=w;return Xn||(Xn=(f==null?void 0:f.template_version)==="v1"||!(f!=null&&f.template_version)?"classic":f.template_version),console.log(`[StorePreview] Determined templateVersionToRender: ${Xn}. (previewTemplateVersion: ${w}, store.template_version: ${f==null?void 0:f.template_version})`),console.log(`[StorePreview] Rendering template: ${Xn}. Store products: ${((de=f==null?void 0:f.products)==null?void 0:de.length)||0}, collections: ${((ae=f==null?void 0:f.collections)==null?void 0:ae.length)||0}`),a.jsxs("div",{className:"min-h-screen bg-background",children:[a.jsx(p.Suspense,{fallback:a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading Store..."})]})}),children:Xn==="classic"?a.jsxs(ht.Fragment,{children:[ut&&a.jsx(ut,{store:f,isPublishedView:vt}),vn&&a.jsx(vn,{store:f,isPublishedView:vt}),Ei&&a.jsx(Ei,{store:f,isPublishedView:vt}),Vn&&a.jsx(Vn,{store:f,isPublishedView:vt}),Ce&&a.jsx(Ce,{store:f,isPublishedView:vt}),Te&&a.jsx(Te,{store:f,isPublishedView:vt}),us&&a.jsx(us,{store:f,isPublishedView:vt}),Pn&&a.jsx(Pn,{store:f,isPublishedView:vt}),Ti&&a.jsx(Ti,{store:f,isPublishedView:vt})]},"classic"):Xn==="modern"?a.jsx(ht.Fragment,{children:a.jsxs("div",{className:"min-h-screen flex flex-col",children:[a.jsxs("main",{className:"flex-1",children:[_&&a.jsx(_,{store:f,isPublishedView:vt}),T&&a.jsx(T,{store:f,isPublishedView:vt}),k?a.jsx(k,{store:f,isPublishedView:vt}):Ce&&a.jsx(Ce,{store:f,isPublishedView:vt}),A&&a.jsx(A,{store:f,products:(f==null?void 0:f.products)||[],isPublishedView:vt}),I&&a.jsx(I,{store:f,isPublishedView:vt}),Te&&a.jsx(Te,{store:f,isPublishedView:vt})]}),a.jsx("footer",{className:"mt-auto",children:j&&a.jsx(j,{store:f,isPublishedView:vt})})]})},"modern"):Xn==="premium"?a.jsxs(ht.Fragment,{children:[z&&a.jsx(z,{store:f,isPublishedView:vt}),K&&a.jsx(K,{store:f,isPublishedView:vt}),W&&a.jsx(W,{store:f,isPublishedView:vt}),O&&a.jsx(O,{store:f,isPublishedView:vt}),Ce&&a.jsx(Ce,{store:f,isPublishedView:vt}),Te&&a.jsx(Te,{store:f,isPublishedView:vt}),H&&a.jsx(H,{store:f,isPublishedView:vt}),ee&&a.jsx(ee,{store:f,isPublishedView:vt}),xe&&a.jsx(xe,{store:f,isPublishedView:vt})]},"premium"):Xn==="sharp"?a.jsxs(ht.Fragment,{children:[Ie&&a.jsx(Ie,{store:f,isPublishedView:vt}),Ve&&a.jsx(Ve,{store:f,isPublishedView:vt}),en&&a.jsx(en,{store:f}),ie&&a.jsx(ie,{store:f,isPublishedView:vt}),fe?a.jsx(fe,{store:f,isPublishedView:vt}):Ce&&a.jsx(Ce,{store:f,isPublishedView:vt}),Te&&a.jsx(Te,{store:f,isPublishedView:vt}),et&&a.jsx(et,{store:f,isPublishedView:vt}),Mt&&a.jsx(Mt,{store:f,isPublishedView:vt}),me&&a.jsx(me,{store:f,isPublishedView:vt}),kt&&a.jsx(kt,{store:f}),re&&a.jsx(re,{store:f})]},"sharp"):Xn==="fresh"?a.jsxs(ht.Fragment,{children:[B&&a.jsx(B,{store:f,isPublishedView:vt}),ne&&a.jsx(ne,{store:f,isPublishedView:vt}),Ee&&a.jsx(Ee,{store:f,isPublishedView:vt})," ",Be&&a.jsx(Be,{store:f,isPublishedView:vt})," ",Ne?a.jsx(Ne,{store:f,isPublishedView:vt}):Ce&&a.jsx(Ce,{store:f,isPublishedView:vt}),mt&&a.jsx(mt,{store:f,isPublishedView:vt}),Te&&a.jsx(Te,{store:f,isPublishedView:vt}),tn&&a.jsx(tn,{store:f}),sn&&a.jsx(sn,{store:f})]},"fresh"):Xn==="sleek"?a.jsxs(ht.Fragment,{children:[Fr&&a.jsx(Fr,{store:f,isPublishedView:vt}),wr&&a.jsx(wr,{store:f,isPublishedView:vt}),Nn&&a.jsx(Nn,{store:f,isPublishedView:vt}),ye&&a.jsx(ye,{store:f,isPublishedView:vt}),cs?a.jsx(cs,{store:f,isPublishedView:vt}):Ce&&a.jsx(Ce,{store:f,isPublishedView:vt}),le?a.jsx(le,{store:f,isPublishedView:vt}):Te&&a.jsx(Te,{store:f,isPublishedView:vt}),he&&a.jsx(he,{store:f,isPublishedView:vt}),Me&&a.jsx(Me,{store:f,isPublishedView:vt}),Q&&a.jsx(Q,{store:f,isPublishedView:vt})]},"sleek"):null}),d&&f&&d.uid===f.merchant_id&&a.jsx(CIe,{store:f,onEdit:()=>_o(!0),currentTemplate:w,onTemplateChange:v,availableTemplates:["classic","modern","premium","sharp","fresh","sleek"]}),!vt&&f&&a.jsx(EIe,{store:f,open:ii,onOpenChange:_o,onStoreUpdate:oe=>{m(ue=>({...ue,...oe})),oe.template_version&&oe.template_version!==w&&v(oe.template_version),(f&&f.id===oe.id||i&&i.id===oe.id)&&l(oe.id,oe)}}),a.jsx(kq,{storeId:f==null?void 0:f.id})," "]})},DRe=({open:t,onOpenChange:e,storeId:n,storeName:r,currentLogoUrlLight:s,currentLogoUrlDark:i,onLogoReplaced:o})=>{const[l,c]=p.useState("ai"),[u,d]=p.useState(r||""),[h,f]=p.useState(!1),[m,g]=p.useState(null),[x,w]=p.useState({light:null,dark:null}),[v,_]=p.useState(""),[C,T]=p.useState([]),[R,k]=p.useState(!1),[E,I]=p.useState(null),[P,A]=p.useState(null),[D,j]=p.useState(null),[M,z]=p.useState(!1),[U,K]=p.useState(null);p.useEffect(()=>{t&&(d(r||""),f(!1),g(null),w({light:null,dark:null}),_(""),T([]),k(!1),I(null),A(null),j(null),z(!1),K(null))},[t,r]);const q=async()=>{if(!r){g("Store name is required to generate a logo with AI.");return}f(!0),g(null),w({light:null,dark:null});try{console.log(`Generating light/dark logos for store ${r}`);const L=await kg(r);L&&(L.logoUrlLight||L.logoUrlDark)?w({light:L.logoUrlLight,dark:L.logoUrlDark}):g(L.textResponse||"AI did not return sufficient image data for logos.")}catch(L){console.error("Error generating logos with AI:",L),g(L.message||"Failed to generate logos. Please try again.")}finally{f(!1)}},W=async()=>{if(!v.trim()){I("Please enter a search query for Pexels.");return}k(!0),I(null),T([]);try{const L=await ERe(v);L.error?(I(L.error),T([])):(T(L.photos||[]),(L.photos||[]).length===0&&I("No images found for your query."))}catch(L){console.error("Error searching Pexels images:",L),I(L.message||"Failed to search Pexels. Please try again.")}finally{k(!1)}},te=L=>{o&&L?(o({logoUrlLight:L,logoUrlDark:L}),e(!1)):I("Invalid image URL selected or replacement handler missing.")},O=L=>{const ee=L.target.files[0];if(ee){if(ee.size>10*1024*1024){j("File is too large. Please select an image under 10MB."),A(null),K(null);return}if(!ee.type.startsWith("image/")){j("Invalid file type. Please select an image file (e.g., PNG, JPG, GIF)."),A(null),K(null);return}A(ee),j(null);const pe=new FileReader;pe.onloadend=()=>{K(pe.result)},pe.readAsDataURL(ee)}},V=()=>{if(P&&o){z(!0),j(null);const L=new FileReader;L.onloadend=()=>{const ee=L.result;o({logoUrlLight:ee,logoUrlDark:ee}),e(!1),A(null),K(null),z(!1)},L.onerror=()=>{j("Failed to read image file for upload."),z(!1)},L.readAsDataURL(P)}else j("No image file selected or replacement handler missing.")},H=()=>{x.light||x.dark?(o({logoUrlLight:x.light,logoUrlDark:x.dark}),e(!1)):g("No AI generated logos available to confirm.")};return a.jsx(zr,{open:t,onOpenChange:e,children:a.jsxs(Dr,{className:"sm:max-w-[728px]",children:[" ",a.jsxs(Mr,{className:"text-left",children:[a.jsx(Lr,{children:"Change Store Logo"}),a.jsxs(_i,{className:"text-left space-y-2",children:[a.jsx("p",{children:"Current Logos:"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(ke,{className:"text-xs text-muted-foreground",children:"For Dark Backgrounds (Light Logo)"}),s?a.jsx("img",{src:s,alt:"Current light logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-gray-700 p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]}),a.jsxs("div",{className:"flex-1 text-center",children:[a.jsx(ke,{className:"text-xs text-muted-foreground",children:"For Light Backgrounds (Dark Logo)"}),i?a.jsx("img",{src:i,alt:"Current dark logo",className:"h-20 w-auto mx-auto max-w-full object-contain my-1 border rounded bg-white p-1"}):a.jsx("div",{className:"h-20 flex items-center justify-center text-xs text-muted-foreground bg-gray-200 dark:bg-gray-700 rounded my-1",children:"Not set"})]})]})]})]}),a.jsxs(Si,{value:l,onValueChange:c,className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-3",children:[a.jsx(jt,{value:"ai",children:"Generate with AI"}),a.jsx(jt,{value:"pexels",children:"Search Pexels"}),a.jsx(jt,{value:"upload",children:"Upload Image"})]}),a.jsxs(Dt,{value:"ai",className:"space-y-4 py-4",children:[a.jsxs("p",{className:"text-sm text-muted-foreground",children:["AI will generate a logo based on your store name: ",a.jsx("strong",{children:r}),"."]}),m&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:m}),h&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Generating logos..."}),(x.light||x.dark)&&!h&&a.jsxs("div",{className:"flex flex-col items-center gap-4 mt-3",children:[a.jsx("p",{className:"text-sm font-medium",children:"Generated Previews:"}),a.jsxs("div",{className:"flex gap-4",children:[x.dark&&a.jsxs("div",{className:"text-center",children:[a.jsx(ke,{className:"text-xs text-muted-foreground",children:"For Light BG"}),a.jsx("img",{src:x.dark,alt:"AI Generated Dark Logo",className:"h-24 w-24 object-contain border rounded-md bg-white p-1"})]}),x.light&&a.jsxs("div",{className:"text-center",children:[a.jsx(ke,{className:"text-xs text-muted-foreground",children:"For Dark BG"}),a.jsx("img",{src:x.light,alt:"AI Generated Light Logo",className:"h-24 w-24 object-contain border rounded-md bg-gray-700 p-1"})]})]})]}),a.jsxs(Nr,{className:"justify-start pt-4",children:[a.jsx($,{variant:"outline",onClick:()=>e(!1),disabled:h,children:"Cancel"}),a.jsxs($,{onClick:q,disabled:h||!r,children:[a.jsx(tw,{className:"mr-2 h-4 w-4"}),h?"Generating...":x.light||x.dark?"Regenerate Logos":"Generate Logos"]}),(x.light||x.dark)&&a.jsx($,{onClick:H,disabled:h,children:"Use These Logos"})]})]}),a.jsxs(Dt,{value:"pexels",className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(qe,{id:"pexelsQuery",value:v,onChange:L=>_(L.target.value),placeholder:"e.g., Abstract, Minimal, Tech",disabled:R,className:"flex-grow"}),a.jsx($,{onClick:W,disabled:R||!v.trim(),children:R?"Searching...":"Search Images"})]}),E&&a.jsx("p",{className:"text-sm text-red-500 text-center",children:E}),R&&a.jsx("p",{className:"text-sm text-muted-foreground text-center",children:"Loading Pexels images..."}),!R&&C.length>0&&a.jsx("div",{className:"grid grid-cols-3 sm:grid-cols-4 gap-3 max-h-[300px] overflow-y-auto pr-2",children:C.map(L=>a.jsxs("div",{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border hover:border-primary",onClick:()=>te(L.src.large2x||L.src.large||L.src.original),children:[a.jsx("img",{src:L.src.medium,alt:L.alt||`Pexels image by ${L.photographer}`,className:"w-full h-full object-cover transition-transform group-hover:scale-105"}),a.jsx("div",{className:"absolute inset-0 bg-black/30 group-hover:bg-black/50 transition-colors flex items-center justify-center",children:a.jsx("p",{className:"text-white text-xs text-center p-1 bg-black/50 rounded",children:"Use Image"})})]},L.id))}),a.jsx(Nr,{className:"justify-start pt-4",children:a.jsx($,{variant:"outline",onClick:()=>e(!1),disabled:R,children:"Cancel"})})]}),a.jsxs(Dt,{value:"upload",className:"space-y-4 py-4",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"image-upload-input",className:"text-left block mb-1",children:"Select Image File"}),a.jsx("div",{className:"flex items-center gap-2",children:a.jsx(qe,{id:"image-upload-input",type:"file",accept:"image/*",onChange:O,className:"flex-grow",disabled:M})}),U&&a.jsxs("div",{className:"mt-3 flex flex-col items-center",children:[a.jsx("p",{className:"text-sm font-medium mb-1",children:"Preview:"}),a.jsx("img",{src:U,alt:"Upload preview",className:"h-32 w-32 object-contain border rounded-md"})]}),P&&!U&&a.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:["Selected: ",P.name," (",(P.size/1024/1024).toFixed(2)," MB)"]}),D&&a.jsx("p",{className:"text-sm text-red-500 text-center mt-2",children:D})]}),a.jsxs(Nr,{className:"justify-start pt-4",children:[a.jsx($,{variant:"outline",onClick:()=>e(!1),disabled:M,children:"Cancel"}),a.jsx($,{onClick:V,disabled:M||!P,children:M?"Uploading...":"Confirm Upload"})]})]})]})]})})},Mq=({store:t,isPublishedView:e=!1,productName:n})=>{const{name:r,theme:s,logo_url_light:i,logo_url_dark:o,id:l,settings:c,content:u,template_version:d}=t,{cart:h,removeFromCart:f,updateQuantity:m,updateStore:g,updateStoreTemplateVersion:x}=$n(),[w,v]=p.useState(!1),[_,C]=p.useState(!1),[T,R]=p.useState(!1),k=!e,[E,I]=p.useState(!1),P=wi(),A=h.filter(L=>L.storeId===l),D=A.reduce((L,ee)=>L+ee.quantity,0),j=A.reduce((L,ee)=>L+ee.price*ee.quantity,0);p.useEffect(()=>{const L=localStorage.getItem("theme"),ee=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;I(!!(L==="dark"||!L&&ee))},[]);const M=async(L,ee,pe=null)=>{if(l)try{if(L==="storeName")await g(l,{name:ee});else if(L==="navLink"&&pe!==null){const we=((u==null?void 0:u.navLinks)||O.map(Ie=>({label:Ie.label,href:Ie.href}))).map((Ie,Fe)=>Fe===pe?{...Ie,label:ee}:Ie);await g(l,{content:{...u,navLinks:we}})}await z()}catch(xe){console.error(`Failed to update store ${L} or refresh template:`,xe)}},z=async()=>{const L=d||"v1";console.log(`Performing template refresh. Current version: ${L}`),L==="v1"?(await x(l,"v2"),await x(l,"v1"),console.log("Template refreshed: v1 -> v2 -> v1")):L==="v2"&&(await x(l,"v1"),await x(l,"v2"),console.log("Template refreshed: v2 -> v1 -> v2"))},U=()=>{R(!0),console.log("Open change image dialog (placeholder)")},K=async L=>{if(l&&L)try{await g(l,{logo_url_light:L.logoUrlLight||t.logo_url_light,logo_url_dark:L.logoUrlDark||t.logo_url_dark}),console.log("Store logos updated successfully.")}catch(ee){console.error("Failed to update store logos:",ee)}},q=()=>{const L=!E;I(L),L?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},W=`/store/${l}`,te=[{href:W,label:"Home"},{href:`#products-${l}`,label:"Products"},{href:`#features-${l}`,label:"Features"},{href:`#contact-${l}`,label:"Contact"}],O=u!=null&&u.navLinks&&u.navLinks.length===te.length?u.navLinks.map((L,ee)=>({...te[ee],label:L.label||te[ee].label})):te,V=(L,ee)=>{if(L.preventDefault(),v(!1),ee.startsWith("/store/"))P(ee);else{const pe=ee.substring(1),xe=document.getElementById(pe);xe?xe.scrollIntoView({behavior:"smooth"}):P(W)}},H=()=>{C(!1),P("/checkout",{state:{cart:A,storeName:r,storeId:l}})};return a.jsxs(a.Fragment,{children:[a.jsx(Ct.header,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.3},className:"sticky top-0 z-40 w-full bg-background/90 backdrop-blur-md border-b",style:{borderColor:`${s.primaryColor}30`},children:a.jsxs("div",{className:"container mx-auto px-4 py-3 flex items-center justify-between",children:[a.jsx("div",{className:"flex items-center gap-2",children:n?a.jsx("h1",{className:"font-bold text-xl tracking-tight",style:{color:s.primaryColor},children:n}):a.jsxs(a.Fragment,{children:[a.jsx(ir,{to:W,className:"group",children:(E?i:o)?a.jsx("img",{src:E?i:o,alt:`${r} logo`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):i||o?a.jsx("img",{src:i||o,alt:`${r} logo (fallback)`,className:"h-16 w-16 object-contain group-hover:scale-105 transition-transform duration-200"}):null}),k&&(i||o)&&a.jsx($,{variant:"outline",size:"icon",onClick:U,className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(rw,{className:"h-4 w-4"})}),a.jsx(ir,{to:W,className:"group ml-2",children:a.jsx("span",{className:"font-bold text-xl tracking-tight group-hover:text-primary transition-colors",style:{color:s.primaryColor},children:a.jsx(qn,{initialText:r,onSave:L=>M("storeName",L),isAdmin:k,placeholder:"Store Name"})})})]})}),!n&&a.jsx("nav",{className:"hidden md:flex items-center gap-x-6",children:O.map((L,ee)=>a.jsx("a",{href:L.href,onClick:pe=>V(pe,L.href),className:"text-sm font-medium text-muted-foreground hover:text-primary transition-colors",style:{"--hover-color":s.primaryColor},children:a.jsx(qn,{initialText:L.label,onSave:pe=>M("navLink",pe,ee),isAdmin:k,placeholder:`Link ${ee+1}`})},L.label+ee))}),a.jsxs("div",{className:"flex items-center gap-2",children:[((c==null?void 0:c.showThemeToggle)??!0)&&a.jsxs("div",{className:"hidden md:flex items-center gap-2 mr-2",children:[a.jsx(Oo,{id:`store-theme-switcher-${l}`,checked:E,onCheckedChange:q,"aria-label":"Toggle dark mode"}),E?a.jsx(jE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(ME,{className:"h-5 w-5 text-muted-foreground"})]}),a.jsx($,{variant:"ghost",size:"icon",className:"hidden md:flex text-muted-foreground hover:text-primary",style:{"--hover-color":s.primaryColor},children:a.jsx(ac,{className:"h-5 w-5"})}),a.jsxs($,{variant:"outline",className:"relative",onClick:()=>C(!0),style:{borderColor:s.primaryColor,color:s.primaryColor},children:[a.jsx(Wp,{className:"h-5 w-5"}),D>0&&a.jsx(yg,{variant:"destructive",className:"absolute -top-2 -right-2 h-5 w-5 p-0 flex items-center justify-center text-xs",style:{backgroundColor:s.secondaryColor||"red"},children:D}),a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Cart"})]}),!n&&a.jsx($,{variant:"ghost",size:"icon",className:"md:hidden text-muted-foreground hover:text-primary",onClick:()=>v(!0),style:{"--hover-color":s.primaryColor},children:a.jsx(K3,{className:"h-6 w-6"})})]})]})}),a.jsx(Ac,{children:w&&a.jsxs(Ct.div,{initial:{opacity:0,x:"100%"},animate:{opacity:1,x:0},exit:{opacity:0,x:"100%"},transition:{type:"spring",stiffness:300,damping:30},className:"fixed inset-0 z-50 bg-background p-6 md:hidden",children:[a.jsxs("div",{className:"flex justify-between items-center mb-8",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(ir,{to:W,className:"group",onClick:()=>v(!1),children:(E?i:o)?a.jsx("img",{src:E?i:o,alt:`${r} logo`,className:"h-16 w-16 object-contain"}):i||o?a.jsx("img",{src:i||o,alt:`${r} logo (fallback)`,className:"h-16 w-16 object-contain"}):null}),k&&(i||o)&&a.jsx($,{variant:"outline",size:"icon",onClick:()=>{U(),v(!1)},className:"h-8 w-8 p-0 -ml-2 relative z-10 bg-background hover:bg-muted",children:a.jsx(rw,{className:"h-4 w-4"})}),a.jsx(ir,{to:W,className:"group ml-2",onClick:()=>v(!1),children:a.jsx("span",{className:"font-bold text-xl",style:{color:s.primaryColor},children:a.jsx(qn,{initialText:r,onSave:L=>M("storeName",L),isAdmin:k,placeholder:"Store Name"})})})]})," ",a.jsx($,{variant:"ghost",size:"icon",onClick:()=>v(!1),children:a.jsx(Ji,{className:"h-6 w-6"})})]}),a.jsxs("nav",{className:"flex flex-col gap-y-4",children:[O.map((L,ee)=>a.jsx("a",{href:L.href,onClick:pe=>V(pe,L.href),className:"text-lg font-medium text-foreground hover:text-primary transition-colors",style:{"--hover-color":s.primaryColor},children:a.jsx(qn,{initialText:L.label,onSave:pe=>M("navLink",pe,ee),isAdmin:k,placeholder:`Link ${ee+1}`})},L.label+ee)),((c==null?void 0:c.showThemeToggle)??!0)&&a.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-4 border-t border-border",children:[a.jsx(Oo,{id:`mobile-store-theme-switcher-${l}`,checked:E,onCheckedChange:q,"aria-label":"Toggle dark mode"}),E?a.jsx(jE,{className:"h-5 w-5 text-muted-foreground"}):a.jsx(ME,{className:"h-5 w-5 text-muted-foreground"}),a.jsx("span",{className:"text-sm text-muted-foreground",children:E?"Dark Mode":"Light Mode"})]})]})]})}),a.jsx(Ac,{children:_&&a.jsx(Ch.Root,{open:_,onOpenChange:C,children:a.jsxs(Ch.Portal,{children:[a.jsx(Ch.Overlay,{className:"fixed inset-0 z-50 bg-black/50 backdrop-blur-sm"}),a.jsxs(Ch.Content,{className:"fixed z-50 inset-y-0 right-0 h-full w-full max-w-md bg-background border-l shadow-xl flex flex-col",as:Ct.div,initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",stiffness:300,damping:30},children:[a.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[a.jsx("h2",{className:"text-xl font-semibold",children:"Your Cart"}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>C(!1),children:a.jsx(Ji,{className:"h-5 w-5"})})]}),A.length===0?a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6 text-center",children:[a.jsx(Wp,{className:"h-16 w-16 text-muted-foreground mb-4"}),a.jsx("p",{className:"text-lg font-medium",children:"Your cart is empty"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Looks like you haven't added anything yet."}),a.jsx($,{onClick:()=>C(!1),className:"mt-6",style:{backgroundColor:s.primaryColor},children:"Continue Shopping"})]}):a.jsxs(a.Fragment,{children:[a.jsx(ws,{className:"flex-1 p-6",children:a.jsx("div",{className:"space-y-4",children:A.map(L=>{var ee,pe,xe,we;return a.jsxs("div",{className:"flex items-start gap-4",children:[a.jsx("img",{src:((pe=(ee=L.image)==null?void 0:ee.src)==null?void 0:pe.tiny)||((we=(xe=L.image)==null?void 0:xe.src)==null?void 0:we.medium)||`https://via.placeholder.com/80x80.png?text=${L.name.substring(0,1)}`,alt:L.name,className:"w-20 h-20 object-cover rounded-md border"}),a.jsxs("div",{className:"flex-1",children:[a.jsx("h3",{className:"font-medium text-sm line-clamp-1",children:L.name}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Price: $",L.price.toFixed(2)]}),a.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[a.jsx($,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>m(L.id,l,L.quantity-1),children:a.jsx("span",{className:"text-lg leading-none",children:"-"})}),a.jsx("span",{className:"text-sm w-4 text-center",children:L.quantity}),a.jsx($,{variant:"outline",size:"icon",className:"h-6 w-6",onClick:()=>m(L.id,l,L.quantity+1),children:a.jsx("span",{className:"text-lg leading-none",children:"+"})})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-semibold text-sm",children:["$",(L.price*L.quantity).toFixed(2)]}),a.jsx($,{variant:"ghost",size:"icon",className:"h-7 w-7 mt-1 text-muted-foreground hover:text-destructive",onClick:()=>f(L.id,l),children:a.jsx(Bn,{className:"h-4 w-4"})})]})]},L.id)})})}),a.jsx(zi,{}),a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsxs("div",{className:"flex justify-between font-medium",children:[a.jsx("span",{children:"Subtotal"}),a.jsxs("span",{children:["$",j.toFixed(2)]})]}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Shipping and taxes calculated at checkout."}),a.jsx($,{className:"w-full",size:"lg",style:{backgroundColor:s.primaryColor},onClick:H,children:"Proceed to Checkout"})]})]})]})]})})}),k&&a.jsx(DRe,{open:T,onOpenChange:R,storeId:l,storeName:r,currentLogoUrl:o,currentLogoUrlLight:i,currentLogoUrlDark:o,onLogoReplaced:K})]})},Ch={Root:({children:t,...e})=>a.jsx("div",{...e,children:t}),Portal:({children:t})=>a.jsx(a.Fragment,{children:t}),Overlay:ht.forwardRef(({className:t,...e},n)=>a.jsx("div",{ref:n,className:bt("fixed inset-0 z-50",t),...e})),Content:ht.forwardRef(({className:t,children:e,...n},r)=>a.jsx("div",{ref:r,className:bt("fixed z-50",t),...n,children:e}))};Ch.Overlay.displayName="DialogPrimitive.Overlay";Ch.Content.displayName="DialogPrimitive.Content";const MRe=Object.freeze(Object.defineProperty({__proto__:null,default:Mq},Symbol.toStringTag,{value:"Module"})),Lq=({store:t,isPublishedView:e=!1})=>{const{name:n,theme:r,id:s,content:i}=t,{updateStore:o}=$n(),l=!e,c=new Date().getFullYear(),u=[{icon:qie,href:"#",label:"Facebook"},{icon:Hx,href:"#",label:"Instagram"},{icon:poe,href:"#",label:"Twitter"},{icon:Zie,href:"#",label:"LinkedIn"},{icon:yoe,href:"#",label:"YouTube"}],h=[{href:`/store/${s}`,label:"Home"},{href:`#products-${s}`,label:"Products"},{href:"#",label:"About Us"},{href:"#",label:"Contact"},{href:"#",label:"FAQ"},{href:"#",label:"Privacy Policy"},{href:"#",label:"Terms of Service"},{href:"#",label:"Shipping Info"},{href:"#",label:"Returns"}],f=i!=null&&i.footerNavLinks&&Array.isArray(i.footerNavLinks)&&i.footerNavLinks.length>0?i.footerNavLinks.map((k,E)=>{var I,P;return{href:k.href||((I=h[E])==null?void 0:I.href)||"#",label:k.label||((P=h[E])==null?void 0:P.label)||`Link ${E+1}`}}):h,m=()=>{window.scrollTo({top:0,behavior:"smooth"})},g=async(k,E,I=null)=>{if(s)try{if(k.startsWith("content.footerNavLinks")){const P=f.map((A,D)=>D===I?{...A,label:E}:A);await o(s,{content:{...i,footerNavLinks:P}})}else{const P=k.split(".");P.length===2&&P[0]==="content"?await o(s,{content:{...i,[P[1]]:E}}):console.warn("Unsupported identifier for footer text save:",k)}}catch(P){console.error(`Failed to update store footer text for ${k}:`,P)}},x=(i==null?void 0:i.footerStoreInfo)||`Your favorite destination for ${t.type||"quality products"}. We are committed to bringing you the best experience with premium quality and exceptional service.`,w=(i==null?void 0:i.footerQuickLinksTitle)||"Quick Links",v=(i==null?void 0:i.footerCustomerServiceTitle)||"Customer Service",_=(i==null?void 0:i.footerContactUsTitle)||"Contact Us",C=(i==null?void 0:i.footerAddress)||"123 Store Street, Cityville, ST 12345",T=(i==null?void 0:i.footerPhoneNumber)||"(123) 456-7890",R=(i==null?void 0:i.footerCopyrightSuffix)||"All Rights Reserved. Powered by FreshFront.";return a.jsxs("footer",{className:"bg-muted dark:bg-slate-900 text-muted-foreground relative overflow-hidden",id:`contact-${s}`,children:[a.jsx(Ct.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{duration:.5},viewport:{once:!0},className:"pt-16 pb-8",children:a.jsxs("div",{className:"container mx-auto px-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 mb-12",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-xl font-bold text-foreground font-poppins",style:{color:r.primaryColor},children:n}),a.jsx("div",{className:"text-sm",children:a.jsx(qn,{initialText:x,onSave:k=>g("content.footerStoreInfo",k),isAdmin:l,placeholder:"Store information paragraph",useTextarea:!0,textClassName:"text-sm"})}),a.jsx("div",{className:"flex space-x-3 pt-2",children:u.map(k=>a.jsx("a",{href:k.href,"aria-label":k.label,className:"p-2 rounded-full bg-background/50 hover:bg-primary/10 hover:scale-110 transition-all duration-300",style:{"--hover-bg-color":`${r.primaryColor}1A`,"--hover-text-color":r.primaryColor},children:a.jsx(k.icon,{className:"h-5 w-5"})},k.label))})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(qn,{initialText:w,onSave:k=>g("content.footerQuickLinksTitle",k),isAdmin:l,placeholder:"Quick Links Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(0,5).map((k,E)=>a.jsx("li",{children:a.jsx("a",{href:k.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx(qn,{initialText:k.label,onSave:I=>g("content.footerNavLinks",I,E),isAdmin:l,placeholder:`Link ${E+1}`,textClassName:"text-sm"})})},k.label+E))})]}),a.jsxs(Ct.div,{variants:{hidden:{opacity:0,x:-30},visible:{opacity:1,x:0,transition:{duration:.5,ease:"easeOut",delay:.2}}},children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(qn,{initialText:v,onSave:k=>g("content.footerCustomerServiceTitle",k),isAdmin:l,placeholder:"Customer Service Title",textClassName:"font-bold text-foreground"})}),a.jsx("ul",{className:"space-y-2",children:f.slice(5).map((k,E)=>a.jsx("li",{children:a.jsx("a",{href:k.href,className:"text-sm hover:text-primary transition-colors hover:translate-x-1 inline-block hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:a.jsx(qn,{initialText:k.label,onSave:I=>g("content.footerNavLinks",I,E+5),isAdmin:l,placeholder:`Link ${E+6}`,textClassName:"text-sm"})})},k.label+E+5))})]}),a.jsxs("div",{className:"space-y-3 text-sm",children:[a.jsx("h4",{className:"font-bold text-foreground mb-4 font-poppins",children:a.jsx(qn,{initialText:_,onSave:k=>g("content.footerContactUsTitle",k),isAdmin:l,placeholder:"Contact Us Title",textClassName:"font-bold text-foreground"})}),a.jsxs("div",{className:"flex items-start space-x-3",children:[a.jsx(toe,{className:"h-5 w-5 mt-0.5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx(qn,{initialText:C,onSave:k=>g("content.footerAddress",k),isAdmin:l,placeholder:"Store Address",useTextarea:!0,textClassName:"text-sm"})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(mh,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsxs("a",{href:`mailto:info@${n.toLowerCase().replace(/\s+/g,"")}.com`,className:"hover:text-primary hover:underline decoration-primary/30 underline-offset-4",style:{"--hover-color":r.primaryColor},children:["info@",n.toLowerCase().replace(/\s+/g,""),".com"]})]}),a.jsxs("div",{className:"flex items-center space-x-3",children:[a.jsx(aoe,{className:"h-5 w-5 flex-shrink-0",style:{color:r.primaryColor}}),a.jsx(qn,{initialText:T,onSave:k=>g("content.footerPhoneNumber",k),isAdmin:l,placeholder:"Store Phone Number",textClassName:"text-sm hover:text-primary hover:underline decoration-primary/30 underline-offset-4"})]})]})]}),a.jsxs("div",{className:"border-t border-border/50 pt-6 flex flex-col md:flex-row justify-between items-center text-sm",children:[a.jsxs("p",{children:["© ",c," ",n,". ",a.jsx(qn,{initialText:R,onSave:k=>g("content.footerCopyrightSuffix",k),isAdmin:l,placeholder:"Copyright suffix",textClassName:"text-sm",as:"span"})]}),a.jsx("div",{className:"flex items-center mt-4 md:mt-0",children:a.jsx($,{variant:"ghost",size:"icon",className:"rounded-full hover:bg-primary/10 transition-all duration-300",onClick:m,style:{"--hover-bg-color":`${r.primaryColor}1A`},children:a.jsx($ie,{className:"h-5 w-5",style:{color:r.primaryColor}})})})]})]})}),a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-primary/5 rounded-full translate-x-1/2 -translate-y-1/2 blur-3xl"}),a.jsx("div",{className:"absolute bottom-0 left-0 w-96 h-96 bg-secondary/5 rounded-full -translate-x-1/3 translate-y-1/3 blur-3xl"})]})},LRe=Object.freeze(Object.defineProperty({__proto__:null,default:Lq},Symbol.toStringTag,{value:"Module"})),FRe=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),ORe=({open:t,onOpenChange:e,product:n,onVideoGenerated:r})=>{var T,R,k,E;const[s,i]=p.useState(""),[o,l]=p.useState(null),[c,u]=p.useState(null),[d,h]=p.useState(!1),[f,m]=p.useState(!1),[g,x]=p.useState(null),{toast:w}=Ss(),v=((R=(T=n==null?void 0:n.image)==null?void 0:T.src)==null?void 0:R.large)||((E=(k=n==null?void 0:n.image)==null?void 0:k.src)==null?void 0:E.medium);p.useEffect(()=>{t&&v&&(x(null),i(""),l(null),u(null),FRe(v).then(I=>{l(I.base64ImageData),u(I.mimeType)}).catch(I=>{console.error("Error loading product image data:",I),x(`Failed to load product image: ${I.message}`),w({title:"Error",description:`Failed to load product image: ${I.message}`,variant:"destructive"})}))},[t,v,w]);const _=async()=>{if(!o||!c){w({title:"Error",description:"Product image data is not available to suggest a prompt.",variant:"destructive"});return}h(!0),x(null);try{const I=await ca(o,c);i(I)}catch(I){console.error("Error generating prompt suggestion:",I),x(`Failed to suggest prompt: ${I.message}`),w({title:"Suggestion Failed",description:`Could not suggest a prompt: ${I.message}`,variant:"destructive"})}finally{h(!1)}},C=async()=>{if(!s.trim()){x("Please enter a prompt for the video.");return}if(!o||!c){x("Product image data is not available.");return}m(!0),x(null);try{const I=await nN(s,o,c);r&&r(I),e(!1)}catch(I){console.error("Error generating product video:",I),x(I.message||"Failed to generate video. Please try again."),w({title:"Video Generation Failed",description:I.message,variant:"destructive"})}finally{m(!1)}};return n?a.jsx(zr,{open:t,onOpenChange:e,children:a.jsxs(Dr,{className:"sm:max-w-lg",children:[a.jsxs(Mr,{children:[a.jsx(Lr,{children:"Generate Product Video"}),a.jsxs(_i,{children:['Create a short video for "',n.name,'" using its image and a prompt.']})]}),a.jsxs("div",{className:"grid gap-4 py-4",children:[v&&a.jsxs("div",{className:"flex flex-col items-center gap-2",children:[a.jsx("img",{src:v,alt:n.name,className:"w-32 h-32 object-contain rounded border"}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Using this image as the base."})]}),a.jsxs("div",{className:"grid w-full gap-1.5",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(ke,{htmlFor:"video-prompt",children:"Video Prompt"}),a.jsxs($,{variant:"outline",size:"sm",onClick:_,disabled:d||f||!o,children:[d?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Suggest"]})]}),a.jsx(Cn,{id:"video-prompt",value:s,onChange:I=>i(I.target.value),placeholder:"e.g., A dynamic shot of the product with vibrant background...",rows:4,disabled:d||f}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"AI will use the product image and this prompt to create a video."})]}),g&&a.jsx("p",{className:"text-sm text-red-500 col-span-4 text-center",children:g})]}),a.jsxs(Nr,{children:[a.jsx(al,{asChild:!0,children:a.jsx($,{variant:"outline",disabled:f,children:"Cancel"})}),a.jsxs($,{onClick:C,disabled:d||f||!s.trim()||!o,children:[f?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Generate Video"]})]})]})}):null},uO="msy_4wQeZBKbKsyGKmfCOGWk0Ux9F7zGIByWSgwC",dO="https://api.meshy.ai/openapi/v1",$Re=({open:t,onOpenChange:e,product:n,storeId:r,onModelGenerated:s})=>{const{toast:i}=Ss(),[o,l]=p.useState([]),[c,u]=p.useState(null),[d,h]=p.useState(0),[f,m]=p.useState(""),[g,x]=p.useState(""),[w,v]=p.useState(!1),[_,C]=p.useState(null),T=p.useCallback(()=>{var A,D,j,M,z,U,K;return n?(D=(A=n.image)==null?void 0:A.src)!=null&&D.large||(M=(j=n.image)==null?void 0:j.src)!=null&&M.medium?[{name:"Main Product Image",url:n.image.src.large||n.image.src.medium}]:((U=(z=n.images)==null?void 0:z.edges)==null?void 0:U.length)>0&&((K=n.images.edges[0].node)!=null&&K.url)?n.images.edges.map((q,W)=>({name:`Product Image ${W+1}`,url:q.node.url})).slice(0,4):[]:[]},[n]);p.useEffect(()=>{t&&n?(l(T().slice(0,1)),u(null),h(0),m(""),x(""),v(!1),_&&(clearInterval(_),C(null))):!t&&_&&(clearInterval(_),C(null))},[t,n,T,_]);const R=A=>{const D=Array.from(A.target.files);if(D.length===0)return;const j=[];let M=o.length;D.forEach(z=>{if(M>=4){i({title:"Limit Reached",description:"You can select up to 4 images.",variant:"warning"});return}const U=new FileReader;U.onload=K=>{j.push({name:z.name,url:K.target.result,file:z}),j.length===Math.min(D.length,4-o.length)&&l(q=>[...q,...j].slice(0,4))},U.readAsDataURL(z),M++})},k=A=>{l(D=>D.filter((j,M)=>M!==A))},E=async()=>{if(o.length===0){i({title:"No Image Selected",description:"Please select at least one image.",variant:"destructive"});return}v(!0),x(""),m("PENDING"),h(5);const A=o.length>1?"/multi-image-to-3d":"/image-to-3d",D=o.length>1?{image_urls:o.map(j=>j.url)}:{image_url:o[0].url};D.enable_pbr=!0,D.should_texture=!0,o.length===1&&(n!=null&&n.name);try{const j=await fetch(`${dO}${A}`,{method:"POST",headers:{Authorization:`Bearer ${uO}`,"Content-Type":"application/json"},body:JSON.stringify(D)}),M=await j.json();if(!j.ok)throw new Error(M.detail||M.message||`API Error: ${j.status}`);if(M.result){u(M.result),m("IN_PROGRESS"),h(10);const z=setInterval(()=>I(M.result,A),5e3);C(z)}else throw new Error("Task ID not found in response.")}catch(j){console.error("Error creating Meshy task:",j),x(`Error creating task: ${j.message}`),m("FAILED"),v(!1)}},I=async(A,D)=>{var j,M;try{const z=await fetch(`${dO}${D}/${A}`,{headers:{Authorization:`Bearer ${uO}`}}),U=await z.json();if(!z.ok){if(z.status===404&&d<30){h(K=>Math.min(K+5,30));return}throw new Error(U.detail||U.message||`API Error: ${z.status}`)}if(h(U.progress||d),m(U.status),U.status==="SUCCEEDED")if(_&&clearInterval(_),C(null),v(!1),(j=U.model_urls)!=null&&j.glb)s(U.model_urls.glb),i({title:"3D Model Generated!",description:"The model has been successfully created."}),e(!1);else throw new Error("GLB model URL not found in successful response.");else U.status==="FAILED"?(_&&clearInterval(_),C(null),x(((M=U.task_error)==null?void 0:M.message)||"Generation failed for an unknown reason."),v(!1)):(U.status==="PENDING"||U.status==="IN_PROGRESS")&&U.progress===100&&U.status==="IN_PROGRESS"&&h(99)}catch(z){console.error("Error polling Meshy task status:",z),x(`Error polling status: ${z.message}`),_&&clearInterval(_),C(null),m("FAILED"),v(!1)}},P=()=>{_&&(clearInterval(_),C(null)),e(!1)};return a.jsx(zr,{open:t,onOpenChange:P,children:a.jsxs(Dr,{className:"sm:max-w-lg",children:[a.jsx(Mr,{children:a.jsxs(Lr,{children:["Generate 3D Model for ",(n==null?void 0:n.name)||(n==null?void 0:n.title)||"Product"]})}),a.jsxs("div",{className:"py-4 space-y-4",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"image-upload",children:"Product Images (select 1-4)"}),a.jsxs("div",{className:"mt-2 grid grid-cols-2 sm:grid-cols-4 gap-2 mb-2",children:[o.map((A,D)=>a.jsxs("div",{className:"relative group aspect-square border rounded-md overflow-hidden",children:[a.jsx("img",{src:A.url,alt:A.name,className:"w-full h-full object-cover"}),a.jsx($,{variant:"destructive",size:"icon",className:"absolute top-1 right-1 h-6 w-6 opacity-50 group-hover:opacity-100",onClick:()=>k(D),disabled:w||f==="IN_PROGRESS",children:a.jsx(Bn,{size:14})})]},D)),o.length<4&&a.jsxs(ke,{htmlFor:"image-upload-input",className:"aspect-square border-2 border-dashed rounded-md flex flex-col items-center justify-center cursor-pointer hover:border-primary transition-colors text-muted-foreground",children:[a.jsx(Uo,{size:24,className:"mb-1"}),a.jsx("span",{className:"text-xs",children:"Add Image"})]})]}),a.jsx(qe,{id:"image-upload-input",type:"file",multiple:!0,accept:"image/png, image/jpeg, image/jpg",onChange:R,className:"hidden",disabled:w||f==="IN_PROGRESS"||o.length>=4}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Default is main product image. You can add up to 4 images (PNG, JPG). More images can improve quality."})]}),f&&a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs(ke,{children:["Status: ",f]}),f==="SUCCEEDED"&&a.jsx(ya,{className:"h-5 w-5 text-green-500"}),f==="FAILED"&&a.jsx(ow,{className:"h-5 w-5 text-red-500"}),(f==="PENDING"||f==="IN_PROGRESS")&&a.jsx(ft,{className:"h-5 w-5 animate-spin"})]}),a.jsx(Ua,{value:d,className:"w-full"}),g&&a.jsx("p",{className:"text-sm text-red-500",children:g})]})]}),a.jsxs(Nr,{children:[a.jsx($,{type:"button",variant:"outline",onClick:P,disabled:w&&f==="IN_PROGRESS",children:"Cancel"}),a.jsxs($,{type:"button",onClick:E,disabled:w||o.length===0||f==="IN_PROGRESS"||f==="SUCCEEDED",children:[w&&(f==="PENDING"||f==="IN_PROGRESS")?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,f==="IN_PROGRESS"?"Generating...":"Generate 3D Model"]})]})]})})},VRe=({modelUrl:t,thumbnailUrl:e,productName:n="Product",className:r="",height:s="400px",showControls:i=!0,autoRotate:o=!1,cameraControls:l=!0,ar:c=!0})=>{const u=p.useRef(null);p.useEffect(()=>{if(!window.customElements.get("model-viewer")){const m=document.createElement("script");m.type="module",m.src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js",document.head.appendChild(m)}},[]);const d=()=>{u.current&&(u.current.resetTurntableRotation(),u.current.jumpCameraToGoal())},h=()=>{u.current&&u.current.requestFullscreen&&u.current.requestFullscreen()},f=()=>{if(t){const m=document.createElement("a");m.href=t,m.download=`${n.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_3d_model.glb`,document.body.appendChild(m),m.click(),document.body.removeChild(m)}};return t?a.jsx(Ke,{className:r,children:a.jsxs(st,{className:"p-0 relative",children:[a.jsxs("model-viewer",{ref:u,src:t,poster:e,alt:`3D model of ${n}`,style:{width:"100%",height:s,backgroundColor:"#f8f9fa"},"camera-controls":l,"auto-rotate":o,ar:c,"ar-modes":"webxr scene-viewer quick-look","environment-image":"neutral","shadow-intensity":"1",exposure:"1","tone-mapping":"neutral",loading:"eager",children:[a.jsx("div",{slot:"progress-bar",className:"absolute inset-0 flex items-center justify-center bg-background/80",children:a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Loading 3D model..."})]})}),a.jsx("div",{slot:"error",className:"absolute inset-0 flex items-center justify-center bg-background",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-destructive mb-2",children:"Failed to load 3D model"}),a.jsx($,{variant:"outline",size:"sm",onClick:()=>window.location.reload(),children:"Retry"})]})})]}),i&&a.jsxs("div",{className:"absolute top-2 right-2 flex flex-col space-y-1",children:[a.jsx($,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:d,title:"Reset camera",children:a.jsx(coe,{className:"h-4 w-4"})}),a.jsx($,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:h,title:"Fullscreen",children:a.jsx(noe,{className:"h-4 w-4"})}),a.jsx($,{variant:"secondary",size:"icon",className:"h-8 w-8 bg-background/80 hover:bg-background",onClick:f,title:"Download model",children:a.jsx(OI,{className:"h-4 w-4"})})]}),a.jsx("div",{className:"absolute bottom-2 right-2"})]})}):a.jsx(Ke,{className:r,children:a.jsx(st,{className:"flex items-center justify-center p-6",style:{height:s},children:a.jsx("p",{className:"text-muted-foreground",children:"No 3D model available"})})})},URe=({product:t,storeId:e,isPublishedView:n=!1})=>{const{toast:r}=Ss(),{getStoreById:s}=$n(),[i,o]=p.useState(null),[l,c]=p.useState(null),[u,d]=p.useState(""),[h,f]=p.useState([]),[m,g]=p.useState([]),[x,w]=p.useState(null),[v,_]=p.useState(!1),[C,T]=p.useState(""),[R,k]=p.useState("#FFFFFF"),[E,I]=p.useState({}),[P,A]=p.useState(""),[D,j]=p.useState(""),[M,z]=p.useState(!1),[U,K]=p.useState(!1);p.useEffect(()=>{if(e){const V=s(e);o(V),V&&t&&f(V.products.filter(H=>{var L,ee;return H.id!==t.id&&((ee=(L=H.image)==null?void 0:L.src)==null?void 0:ee.medium)}))}},[e,t,s]);const q=V=>{const H=V.target.files[0];if(H){H.size>5*1024*1024&&r({title:"File too large",description:"Reference image should ideally be under 5MB.",variant:"destructive"}),c(H);const L=new FileReader;L.onloadend=()=>d(L.result),L.readAsDataURL(H),w(null),A(""),j("")}},W=()=>{c(null),d(""),w(null),A(""),j("")},te=V=>{g(H=>H.find(L=>L.id===V.id)?H.filter(L=>L.id!==V.id):[...H,V]),w(null),A(""),j("")},O=async()=>{var L,ee,pe,xe;if(!t||!l){r({title:"Missing inputs",description:"Main product and a reference image are required.",variant:"destructive"});return}_(!0),w(null),A(""),j("Generating visualization, please wait...");let V=C;R&&R!=="#FFFFFF"&&(V=`${V} The main product's color should be ${R}.`.trim());const H=Object.entries(E);if(H.length>0){const we=H.map(([Ie,Fe])=>`${Ie}: ${Fe}`).join(", ");V=`${V} Apply these product attributes: ${we}.`.trim()}try{const we={name:t.name,description:t.description,imageSource:((ee=(L=t.image)==null?void 0:L.src)==null?void 0:ee.large)||((xe=(pe=t.image)==null?void 0:pe.src)==null?void 0:xe.medium)},Ie=m.map(Ve=>{var Ge,fe,je,ie;return{name:Ve.name,description:Ve.description,imageSource:((fe=(Ge=Ve.image)==null?void 0:Ge.src)==null?void 0:fe.large)||((ie=(je=Ve.image)==null?void 0:je.src)==null?void 0:ie.medium)}}),Fe=await Aq({mainProduct:we,referenceSceneSource:l,additionalProducts:Ie,customInstructions:V});A(Fe.promptUsed||"Prompt details not available."),j(Fe.commentary||"Processing complete."),Fe&&Fe.imageUrl?(w(Fe.imageUrl),r({title:"Visualization Generated!",description:Fe.commentary||"Image created."})):r({title:"Visualization Issue",description:Fe.commentary||"No image generated by AI.",variant:"default",duration:7e3})}catch(we){console.error("Error in ProductVisualizer calling generateProductVisualization:",we);const Ie=we.message||"An unknown error occurred during visualization.";j(`Error: ${Ie}`),r({title:"Visualization Failed",description:Ie,variant:"destructive",duration:1e4})}finally{_(!1)}};return!t||!i?a.jsx("div",{className:"py-8 text-center text-muted-foreground",children:"Initializing Product Visualizer..."}):a.jsxs("div",{className:"my-8 border rounded-lg shadow-sm bg-card",children:[a.jsxs("div",{className:"p-4 md:p-6 cursor-pointer flex justify-between items-center",onClick:()=>K(!U),role:"button",tabIndex:0,onKeyDown:V=>(V.key==="Enter"||V.key===" ")&&K(!U),"aria-expanded":U,"aria-controls":"product-visualizer-content-area",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl md:text-2xl font-semibold",children:"Product Visualizer"}),a.jsxs("p",{className:"text-sm text-muted-foreground",children:["See how ",a.jsx("span",{className:"font-medium text-primary",children:t.name})," looks in different settings."]})]}),a.jsx($,{variant:"ghost",size:"icon","aria-label":U?"Collapse visualizer":"Expand visualizer",children:U?a.jsx(G3,{className:"h-6 w-6"}):a.jsx(Pu,{className:"h-6 w-6"})})]}),U&&a.jsxs("div",{id:"product-visualizer-content-area",className:"p-4 md:p-6 border-t",children:[a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6",children:[a.jsxs("div",{className:"space-y-4 md:space-y-6",children:[a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"visualizer-reference-image-upload",className:"text-md font-medium block mb-1",children:"1. Upload Reference Scene"}),a.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"E.g., a room, a model. (Max ~5MB recommended)"}),u?a.jsxs("div",{className:"relative group aspect-video rounded-md border overflow-hidden bg-muted/20",children:[a.jsx("img",{src:u,alt:"Reference scene preview",className:"w-full h-full object-contain"}),a.jsx($,{variant:"destructive",size:"icon",className:"absolute top-2 right-2 opacity-50 group-hover:opacity-100 transition-opacity",onClick:W,"aria-label":"Remove reference image",children:a.jsx(Ji,{className:"h-4 w-4"})})]}):a.jsxs("label",{htmlFor:"visualizer-reference-image-input",className:"mt-1 flex flex-col justify-center items-center w-full h-40 md:h-48 px-6 py-5 border-2 border-dashed rounded-md cursor-pointer hover:border-primary transition-colors",children:[a.jsx(Uo,{className:"mx-auto h-8 md:h-10 w-8 md:w-10 text-muted-foreground mb-2"}),a.jsx("span",{className:"font-semibold text-primary text-sm",children:"Click to upload image"}),a.jsx("span",{className:"text-xs text-muted-foreground mt-1",children:"PNG, JPG, GIF, WEBP"}),a.jsx(qe,{id:"visualizer-reference-image-input",type:"file",className:"sr-only",accept:"image/*",onChange:q})]})]}),h.length>0&&a.jsxs("div",{children:[a.jsx(ke,{className:"text-md font-medium block mb-1",children:"2. Add Other Products (Optional)"}),a.jsx(ws,{className:"h-32 md:h-40 border rounded-md p-2",children:a.jsx("div",{className:"space-y-1.5",children:h.map(V=>a.jsxs("div",{className:`flex items-center justify-between p-2 rounded-md cursor-pointer transition-all text-sm ${m.some(H=>H.id===V.id)?"bg-primary/10 ring-1 ring-primary":"hover:bg-muted/50"}`,onClick:()=>te(V),role:"checkbox","aria-checked":m.some(H=>H.id===V.id),tabIndex:0,onKeyDown:H=>(H.key==="Enter"||H.key===" ")&&te(V),children:[a.jsxs("div",{className:"flex items-center gap-2 overflow-hidden",children:[a.jsx("img",{src:V.image.src.medium,alt:V.name,className:"w-8 h-8 object-cover rounded flex-shrink-0"}),a.jsx("span",{className:"truncate",title:V.name,children:V.name})]}),m.some(H=>H.id===V.id)&&a.jsx(ya,{className:"h-4 w-4 text-primary flex-shrink-0"})]},V.id))})})]}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"visualizer-product-color",className:"text-md font-medium block mb-1",children:"3. Main Product Color (Optional)"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qe,{type:"color",id:"visualizer-product-color",value:R,onChange:V=>k(V.target.value),className:"w-12 h-10 p-1"}),a.jsx(qe,{type:"text",value:R,onChange:V=>k(V.target.value),placeholder:"#FFFFFF",className:"flex-grow h-10 text-sm"})]})]}),t.variants&&t.variants.length>0&&a.jsxs("div",{children:[a.jsx(ke,{className:"text-md font-medium block mb-1",children:"3. Main Product Variants (Optional)"}),a.jsx("div",{className:"space-y-2",children:t.variants.map(V=>!V.name||!V.values||V.values.length===0?null:a.jsxs("div",{children:[a.jsx(ke,{htmlFor:`visualizer-variant-${V.name}`,className:"text-sm text-muted-foreground",children:V.name}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:V.values.map(H=>a.jsx($,{variant:E[V.name]===H?"default":"outline",size:"xs",onClick:()=>I(L=>({...L,[V.name]:H})),className:"text-xs px-2 py-1 h-auto",children:H},H))})]},V.name))})]}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"visualizer-custom-prompt",className:"text-md font-medium block mb-1",children:t.variants&&t.variants.length>0?"5. Additional Custom Instructions (Optional)":"4. Custom Instructions (Optional)"}),a.jsx(Cn,{id:"visualizer-custom-prompt",placeholder:"e.g., 'place the sofa by the window', 'make it a sunny day'",value:C,onChange:V=>T(V.target.value),rows:2,className:"resize-none text-sm"})]}),a.jsxs($,{onClick:O,disabled:v||!l,className:"w-full py-2.5 text-sm md:text-base",size:"lg",children:[v?a.jsx(ft,{className:"mr-2 h-5 w-5 animate-spin"}):a.jsx(Ea,{className:"mr-2 h-5 w-5"}),"Generate Visualization"]})]}),a.jsx("div",{className:"flex flex-col items-center justify-center border rounded-md p-2 md:p-4 bg-muted/30 min-h-[250px] md:min-h-[300px] lg:min-h-full relative",children:v?a.jsxs("div",{className:"text-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary mb-3"}),a.jsx("p",{className:"text-muted-foreground font-medium",children:D||"Generating your scene..."})]}):x?a.jsxs(a.Fragment,{children:[a.jsx("img",{src:x,alt:"Generated Product Visualization",className:"max-w-full max-h-[calc(100%-40px)] object-contain rounded-md"}),D&&!D.toLowerCase().includes("error")&&a.jsx("p",{className:"text-xs text-muted-foreground mt-2 text-center max-w-xs mx-auto",children:D}),a.jsxs($,{variant:"ghost",size:"sm",onClick:()=>z(!M),className:"absolute bottom-1 right-1 text-muted-foreground hover:text-primary h-auto p-1","aria-label":"Toggle prompt information",children:[a.jsx(Yie,{className:"h-4 w-4 mr-1"})," ",a.jsx("span",{className:"text-xs",children:"Info"})]})]}):a.jsxs("div",{className:"text-center text-muted-foreground p-4",children:[D&&a.jsx("p",{className:`text-sm mb-2 ${D.toLowerCase().includes("error")||D.toLowerCase().includes("failed")?"text-destructive":""}`,children:D}),a.jsx(Ea,{className:"h-12 w-12 mx-auto mb-3"}),a.jsx("p",{className:"font-medium",children:"Your product visualization will appear here."}),!x&&a.jsx("p",{className:"text-xs mt-1",children:'Upload a reference scene and click "Generate".'})]})})]}),M&&P&&!n&&a.jsxs("div",{className:"mt-4 p-3 border rounded-md bg-muted/50",children:[a.jsx(ke,{className:"text-xs font-semibold text-muted-foreground",children:"Technical Prompt Sent to AI:"}),a.jsx("p",{className:"text-xs text-muted-foreground mt-1 whitespace-pre-wrap",children:P})]}),a.jsx(zi,{className:"mt-6 md:mt-8 mb-0"})]})]})};var Fq=p.forwardRef(({transition:t,...e},n)=>{let r={position:"absolute",top:0,left:0,width:"100%",height:"100%",transition:t?`clip-path ${t}`:void 0,userSelect:"none",willChange:"clip-path, transition",KhtmlUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none"};return a.jsx("div",{...e,style:r,"data-rcs":"clip-item",ref:n})});Fq.displayName="ContainerClip";var Oq=p.forwardRef(({children:t,disabled:e,portrait:n,position:r,transition:s},i)=>{let o={position:"absolute",top:0,width:n?"100%":void 0,height:n?void 0:"100%",background:"none",border:0,padding:0,pointerEvents:"all",appearance:"none",WebkitAppearance:"none",MozAppearance:"none",outline:0,transform:n?"translate3d(0, -50% ,0)":"translate3d(-50%, 0, 0)",transition:s?`${n?"top":"left"} ${s}`:void 0};return a.jsx("button",{ref:i,"aria-label":"Drag to move or focus and use arrow keys","aria-orientation":n?"vertical":"horizontal","aria-valuemin":0,"aria-valuemax":100,"aria-valuenow":r,"data-rcs":"handle-container",disabled:e,role:"slider",style:o,children:t})});Oq.displayName="ThisHandleContainer";var hO=({flip:t})=>a.jsx("div",{className:"__rcs-handle-arrow",style:{width:0,height:0,borderTop:"8px solid transparent",borderRight:"10px solid",borderBottom:"8px solid transparent",transform:t?"rotate(180deg)":void 0}}),BRe=({className:t="__rcs-handle-root",disabled:e,buttonStyle:n,linesStyle:r,portrait:s,style:i,...o})=>{let l={display:"flex",flexDirection:s?"row":"column",placeItems:"center",height:"100%",cursor:e?"not-allowed":s?"ns-resize":"ew-resize",pointerEvents:"none",color:"#fff",...i},c={flexGrow:1,height:s?2:"100%",width:s?"100%":2,backgroundColor:"currentColor",pointerEvents:"auto",boxShadow:"0 0 4px rgba(0,0,0,.5)",...r},u={display:"grid",gridAutoFlow:"column",gap:8,placeContent:"center",flexShrink:0,width:56,height:56,borderRadius:"50%",borderStyle:"solid",borderWidth:2,pointerEvents:"auto",backdropFilter:"blur(7px)",WebkitBackdropFilter:"blur(7px)",backgroundColor:"rgba(0, 0, 0, 0.125)",boxShadow:"0 0 4px rgba(0,0,0,.35)",transform:s?"rotate(90deg)":void 0,...n};return a.jsxs("div",{...o,className:t,style:l,children:[a.jsx("div",{className:"__rcs-handle-line",style:c}),a.jsxs("div",{className:"__rcs-handle-button",style:u,children:[a.jsx(hO,{}),a.jsx(hO,{flip:!0})]}),a.jsx("div",{className:"__rcs-handle-line",style:c})]})},$q=(t=>(t.ARROW_LEFT="ArrowLeft",t.ARROW_RIGHT="ArrowRight",t.ARROW_UP="ArrowUp",t.ARROW_DOWN="ArrowDown",t))($q||{}),zRe=({boxSizing:t="border-box",objectFit:e="cover",objectPosition:n="center center",...r}={})=>({display:"block",width:"100%",height:"100%",maxWidth:"100%",boxSizing:t,objectFit:e,objectPosition:n,...r}),GRe=t=>{let e=p.useRef(t);return p.useEffect(()=>{e.current=t}),e.current},xC=(t,e,n,r)=>{let s=p.useRef();p.useEffect(()=>{s.current=e},[e]),p.useEffect(()=>{if(!(n&&n.addEventListener))return;let i=o=>s.current&&s.current(o);return n.addEventListener(t,i,r),()=>{n.removeEventListener(t,i,r)}},[t,n,r])},WRe=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u"?p.useLayoutEffect:p.useEffect,HRe=(t,e)=>{let n=p.useRef(),r=p.useCallback(()=>{t.current&&n.current&&n.current.observe(t.current)},[t]);WRe(()=>(n.current=new ResizeObserver(([s])=>e(s.contentRect)),r(),()=>{n.current&&n.current.disconnect()}),[e,r])},Ax={capture:!1,passive:!0},vC={capture:!0,passive:!1},qRe=t=>{t.preventDefault(),t.currentTarget.focus()},Vq=p.forwardRef(({boundsPadding:t=0,browsingContext:e=globalThis,changePositionOnHover:n=!1,disabled:r=!1,handle:s,itemOne:i,itemTwo:o,keyboardIncrement:l="5%",onlyHandleDraggable:c=!1,onPositionChange:u,portrait:d=!1,position:h=50,style:f,transition:m,...g},x)=>{let w=p.useRef(null),v=p.useRef(null),_=p.useRef(null),C=p.useRef(h),[T,R]=p.useState(!1),[k,E]=p.useState(!0),I=p.useRef(!1),[P,A]=p.useState(),D=GRe(h),j=p.useCallback(function({x:V,y:H,isOffset:L}){let ee=w.current,pe=_.current,xe=v.current,{width:we,height:Ie,left:Fe,top:Ve}=ee.getBoundingClientRect();if(we===0||Ie===0)return;let Ge=d?L?H-Ve-e.scrollY:H:L?V-Fe-e.scrollX:V,fe=Math.min(Math.max(Ge/(d?Ie:we)*100,0),100),je=d?Ie/(ee.offsetHeight||1):we/(ee.offsetWidth||1),ie=t*je/(d?Ie:we)*100,$e=Math.min(Math.max(fe,ie*je),100-ie*je);C.current=fe,pe.setAttribute("aria-valuenow",`${Math.round(C.current)}`),pe.style.top=d?`${$e}%`:"0",pe.style.left=d?"0":`${$e}%`,xe.style.clipPath=d?`inset(${$e}% 0 0 0)`:`inset(0 0 0 ${$e}%)`,u&&u(C.current)},[t,u,d,e]);p.useEffect(()=>{let{width:V,height:H}=w.current.getBoundingClientRect(),L=h===D?C.current:h;j({x:V/100*L,y:H/100*L})},[t,h,d,D,j]);let M=p.useCallback(V=>{V.preventDefault(),!(r||V.button!==0)&&(j({isOffset:!0,x:V.pageX,y:V.pageY}),R(!0),E(!0))},[r,j]),z=p.useCallback(function(V){j({isOffset:!0,x:V.pageX,y:V.pageY}),E(!1)},[j]),U=p.useCallback(()=>{R(!1),E(!0)},[]),K=p.useCallback(({width:V,height:H})=>{let{width:L,height:ee}=w.current.getBoundingClientRect();j({x:V/100*C.current*L/V,y:H/100*C.current*ee/H})},[j]),q=p.useCallback(V=>{if(!Object.values($q).includes(V.key))return;V.preventDefault(),E(!0);let{top:H,left:L}=_.current.getBoundingClientRect(),{width:ee,height:pe}=w.current.getBoundingClientRect(),xe=typeof l=="string"?parseFloat(l):l/ee*100,we=d?V.key==="ArrowLeft"||V.key==="ArrowDown":V.key==="ArrowRight"||V.key==="ArrowUp",Ie=Math.min(Math.max(we?C.current+xe:C.current-xe,0),100);j({x:d?L:ee*Ie/100,y:d?pe*Ie/100:H})},[l,d,j]);p.useEffect(()=>{A(c?_.current:w.current)},[c]),p.useEffect(()=>{let V=w.current,H=()=>{T||U()};return n&&(V.addEventListener("pointermove",z,Ax),V.addEventListener("pointerleave",H,Ax)),()=>{V.removeEventListener("pointermove",z),V.removeEventListener("pointerleave",H)}},[n,z,U,T]),p.useEffect(()=>(T&&!I.current&&(e.addEventListener("pointermove",z,Ax),e.addEventListener("pointerup",U,Ax),I.current=!0),()=>{I.current&&(e.removeEventListener("pointermove",z),e.removeEventListener("pointerup",U),I.current=!1)}),[z,U,T,e]),p.useImperativeHandle(x,()=>({rootContainer:w.current,handleContainer:_.current,setPosition(V){let{width:H,height:L}=w.current.getBoundingClientRect();j({x:H/100*V,y:L/100*V})}}),[j]),HRe(w,K),xC("keydown",q,_.current,vC),xC("click",qRe,_.current,vC),xC("pointerdown",M,P,vC);let W=s||a.jsx(BRe,{disabled:r,portrait:d}),te=k?m:void 0,O={position:"relative",display:"flex",overflow:"hidden",cursor:T?d?"ns-resize":"ew-resize":void 0,touchAction:"none",userSelect:"none",KhtmlUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",WebkitUserSelect:"none",...f};return a.jsxs("div",{...g,ref:w,style:O,"data-rcs":"root",children:[i,a.jsx(Fq,{ref:v,transition:te,children:o}),a.jsx(Oq,{disabled:r,portrait:d,position:Math.round(C.current),ref:_,transition:te,children:W})]})});Vq.displayName="ReactCompareSlider";var C1=p.forwardRef(({style:t,...e},n)=>{let r=zRe(t);return a.jsx("img",{ref:n,...e,style:r,"data-rcs":"image"})});C1.displayName="ReactCompareSliderImage";const KRe=()=>{var Z,he,_e,Me,Qe,Q,se,ye;const t=k0(),e=t.storeName,n=decodeURIComponent(t.productId),{getStoreByName:r,getProductById:s,updateProductImage:i,updateStore:o,isLoadingStores:l,viewMode:c,updateProductImagesArray:u}=$n(),d=c==="published",{toast:h}=Ss(),f=wi(),m=Ow(),[g,x]=p.useState(null),[w,v]=p.useState(null),[_,C]=p.useState(1),[T,R]=p.useState({}),[k,E]=p.useState(null),[I,P]=p.useState(!1),[A,D]=p.useState(""),[j,M]=p.useState([]),[z,U]=p.useState(!1),[K,q]=p.useState(!1),[W,te]=p.useState(null),[O,V]=p.useState(""),[H,L]=p.useState(!1),[ee,pe]=p.useState(!1),[xe,we]=p.useState(""),[Ie,Fe]=p.useState(!1),[Ve,Ge]=p.useState(""),[fe,je]=p.useState(""),[ie,$e]=p.useState(""),[me,Ue]=p.useState([]),[et,ct]=p.useState(!1),[Mt,Sn]=p.useState(null),[en,rn]=p.useState(""),[kt,xn]=p.useState(""),[re,Se]=p.useState(!1),[B,X]=p.useState(!1),ne=J=>{let le=J.split(","),be=le[0].match(/:(.*?);/)[1],Te=atob(le[1]),Le=Te.length,Ce=new Uint8Array(Le);for(;Le--;)Ce[Le]=Te.charCodeAt(Le);return new Blob([Ce],{type:be})},Y=async()=>{if(!ie||!w||!g){h({title:"Missing data",description:"Cannot generate angles without an active image, product, or store context.",variant:"destructive"});return}Se(!0);try{const{base64ImageData:J,mimeType:le}=await ce(ie),be=await K0(J,le,w.name||"Product");if(be&&be.length>0){const Te=[];for(const ut of be)if(ut.startsWith("data:")){const Nt=ne(ut),vn=`angle-${Date.now()}-${Math.random().toString(36).substring(2,15)}.png`,es=`products/${g.id}/${w.id}/angles/${vn}`,Vn=yh(xh,es);await ph(Vn,Nt);const Wr=await gh(Vn);Te.push(Wr)}else Te.push(ut);const Le=Te.map((ut,Nt)=>({id:`angle-${w.id}-${me.length+Nt}-${Pt()}`,src:{medium:ut,large:ut},alt:`${w.name} - Angle ${me.length+Nt+1}`})),Ce=[...me,...Le];Ue(Ce);const it=Ce.map(ut=>ut.src.large||ut.src.medium);await u(g.id,w.id,it),h({title:"Angles Generated & Stored",description:`${Te.length} new angle images added to gallery and storage.`})}else h({title:"No Angles Generated",description:"The AI did not return any new angle images.",variant:"default"})}catch(J){console.error("Error generating or storing angles on detail page:",J),h({title:"Angle Generation/Storage Failed",description:J.message,variant:"destructive"})}Se(!1)},Ne=async J=>{var Te,Le;if(!g||!w)return;const le=me.filter(Ce=>Ce.id!==J);if(le.length===0){const Ce=`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(w.name||"Product")}`;Ue([{id:`placeholder-${w.id}`,src:{medium:Ce,large:Ce},alt:w.name||"Product image"}]),$e(Ce)}else Ue(le),(ie===((Te=me.find(Ce=>Ce.id===J))==null?void 0:Te.src.large)||ie===((Le=me.find(Ce=>Ce.id===J))==null?void 0:Le.src.medium))&&$e(le[0].src.large||le[0].src.medium);const be=le.map(Ce=>Ce.src.large||Ce.src.medium).filter(Ce=>!Ce.includes("via.placeholder.com"));await u(g.id,w.id,be),h({title:"Image Deleted",description:"Image removed from gallery.",variant:"destructive"})},ce=p.useCallback(J=>new Promise((le,be)=>{if(!J)return be(new Error("Image source is undefined or null."));if(J.startsWith("data:"))try{const Te=J.split(",");if(Te.length<2)throw new Error("Invalid data URL structure.");const Le=Te[0],Ce=Te[1],it=Le.match(/:(.*?);/);if(!it||!it[1])throw new Error("Could not parse MIME type from data URL.");const ut=it[1];le({base64ImageData:Ce,mimeType:ut})}catch(Te){console.error("Error parsing data URL:",J,Te),be(new Error(`Invalid data URL format: ${Te.message}`))}else{const Te=new Image;Te.crossOrigin="Anonymous",Te.onload=()=>{const Le=document.createElement("canvas");Le.width=Te.naturalWidth,Le.height=Te.naturalHeight,Le.getContext("2d").drawImage(Te,0,0);try{const Nt=Le.toDataURL("image/png").split(",")[1];le({base64ImageData:Nt,mimeType:"image/png"})}catch(it){console.error("Canvas toDataURL failed:",it),be(new Error("Canvas toDataURL failed, possibly due to CORS or tainted canvas. "+it.message))}},Te.onerror=Le=>{console.error("Failed to load image from URL for conversion:",J,Le),be(new Error("Failed to load image from URL for conversion."))},Te.src=J}}),[]);p.useCallback(async()=>{if(!O.trim()||!ie||!w||!g){h({title:"Missing data",description:"Active image, edit prompt, product, or store context is missing.",variant:"destructive"});return}L(!0);try{const{base64ImageData:J,mimeType:le}=await ce(ie),be=await Wo(J,le,O);if(be&&be.editedImageData&&be.newMimeType){const Te=`data:${be.newMimeType};base64,${be.editedImageData}`,Le=ne(Te),Ce=`edited-${Date.now()}.png`,it=`products/${g.id}/${w.id}/images/${Ce}`,ut=yh(xh,it);await ph(ut,Le);const Nt=await gh(ut),vn={id:Pt(),src:{medium:Nt,large:Nt},alt:`${w.name} (edited: ${O.substring(0,20)}...)`,photographer:"Edited with Gemini AI via Firebase Storage"};await i(g.id,n,vn);const es=me.map(Vn=>Vn.src.medium===ie||Vn.src.large===ie?vn:Vn);me.some(Vn=>Vn.src.medium===ie||Vn.src.large===ie)||es.push(vn),Ue(es),$e(Nt),h({title:"Image Edited & Stored",description:"Product image updated and saved to storage."}),q(!1),V("")}else throw new Error("AI did not return valid edited image data.")}catch(J){console.error("Error editing image or uploading to storage:",J),h({title:"Image Edit Failed",description:J.message,variant:"destructive"})}L(!1)},[ie,O,w,g,n,i,me,h,ce,ne]),p.useEffect(()=>{var le,be,Te,Le;if(l)return;const J=r(e);if(J){x(J);const Ce=s(J.id,n);if(Ce){v(Ce),D(Ce.name),we(Ce.video_url||""),Ge(Ce.model_3d_url||""),je(Ce.model_3d_thumbnail_url||"");let it=[];Ce.images&&Array.isArray(Ce.images)&&Ce.images.length>0?it=Ce.images.map((Nt,vn)=>({id:`gallery-img-${Ce.id}-${vn}-${Pt()}`,src:{medium:Nt,large:Nt},alt:`${Ce.name||"Product"} image ${vn+1}`})):Ce.image&&Ce.image.src?it=[{id:Ce.image.id||`gallery-img-${Ce.id}-0-${Pt()}`,src:Ce.image.src,alt:Ce.image.alt||`${Ce.name||"Product"} image`}]:it=[{id:`placeholder-${Ce.id||Pt()}`,src:{medium:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(Ce.name||"Product")}`,large:`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(Ce.name||"Product")}`},alt:Ce.name||"Product image"}],Ce.video_url&&it.push({id:`video-${Ce.id}-${Pt()}`,src:{medium:Ce.video_url,large:Ce.video_url},alt:`${Ce.name} video`,type:"video"}),Ue(it),$e(((be=(le=it[0])==null?void 0:le.src)==null?void 0:be.large)||((Le=(Te=it[0])==null?void 0:Te.src)==null?void 0:Le.medium)||"");let ut=[];if(Ce.options&&Array.isArray(Ce.options)?ut=Ce.options:Ce.variants&&Array.isArray(Ce.variants)&&Ce.variants.length>0&&Ce.variants[0].name&&Ce.variants[0].values&&(ut=Ce.variants),ut.length>0){const Nt={};ut.forEach(vn=>{vn.values&&vn.values.length>0&&(Nt[vn.name]=vn.values[0])}),R(Nt)}}else h({title:"Product not found",description:`Product ID ${n} not found in store ${J.name}.`,variant:"destructive"}),f(`/${e}`)}else h({title:"Store not found",description:`Could not find store: ${e}`,variant:"destructive"}),f("/")},[e,n,r,s,f,h,l]),p.useEffect(()=>{var J,le,be,Te,Le;if(w&&Object.keys(T).length>0){if(((le=(J=w.variants)==null?void 0:J.edges)==null?void 0:le.length)>0){const Ce=(be=w.variants.edges.find(it=>!it.node||!it.node.selectedOptions?!1:it.node.selectedOptions.every(ut=>T[ut.name]===ut.value)))==null?void 0:be.node;if(Ce){E(Ce);return}}}else w&&((Le=(Te=w.variants)==null?void 0:Te.edges)==null?void 0:Le.length)>0&&Object.keys(T).length},[w,T]);const Ee=J=>{const le=parseInt(J.target.value);le>0&&C(le)},Re=async()=>{if(!g||!w||!In||zn===void 0||!wr){h({title:"Error",description:"Product or store data is incomplete for checkout.",variant:"destructive"});return}if(!g.merchant_id){console.error("Store merchant_id is missing.",g),h({title:"Error",description:"Store owner information is missing.",variant:"destructive"});return}X(!0);try{const J=me.map(Le=>Le.src.large||Le.src.medium).filter(Le=>Le&&!Le.includes("via.placeholder.com")&&!Le.startsWith("data:")).slice(0,8),Te=(await Xa(m,"createProductCheckoutSession")({productName:w.name,productDescription:w.description,productImage:In,amount:zn*100,currency:wr.toLowerCase(),storeOwnerId:g.merchant_id})).data;if(Te&&Te.url)window.location.href=Te.url;else throw new Error("Failed to create checkout session.")}catch(J){console.error("Error creating Stripe Payment Link or redirecting:",J),h({title:"Checkout Setup Failed",description:J.message||"Could not prepare for checkout.",variant:"destructive"})}finally{X(!1)}},Be=async()=>{if(A.trim()){U(!0);try{const J=await lo(A,5,"square");M(J)}catch(J){h({title:"Image search failed",description:J.message,variant:"destructive"})}U(!1)}},_t=async()=>{if(!A.trim()||!g||!w){h({title:"Missing context",description:"Store or product context is missing for image generation.",variant:"destructive"});return}U(!0);try{const J=`Product image for: ${A}, ${(w==null?void 0:w.type)||(g==null?void 0:g.type)||"item"}`,le=await L0(J);if(!le||!le.url||!le.url.startsWith("data:"))throw new Error("AI did not return a valid base64 image data URL.");const be=`gemini-${Date.now()}.png`,Te=`products/${g.id}/${w.id}/images/${be}`,Le=yh(xh,Te),it=await(await fetch(le.url)).blob();await ph(Le,it);const ut=await gh(Le),Nt={id:Date.now().toString(),src:{medium:ut,large:ut},alt:le.alt||A,photographer:"Gemini AI via Firebase Storage"};M(vn=>[Nt,...vn.slice(0,4)]),h({title:"Image Generated & Stored",description:"Gemini AI generated an image, and it has been uploaded to storage."})}catch(J){console.error("Gemini image generation or storage upload failed:",J),h({title:"Gemini Process Failed",description:J.message,variant:"destructive"})}U(!1)},mt=J=>{const le=J.target.files[0];if(le&&g&&w){U(!0);const be=`uploaded-${Date.now()}-${le.name}`,Te=`products/${g.id}/${w.id}/images/${be}`,Le=yh(xh,Te);ph(Le,le).then(()=>gh(Le)).then(Ce=>{const it={id:Pt(),src:{medium:Ce,large:Ce},alt:le.name,photographer:"Uploaded by user via Firebase Storage"};M(ut=>[it,...ut.slice(0,4)]),h({title:"Image Uploaded & Stored",description:`${le.name} uploaded. Select it from the results to use.`})}).catch(Ce=>{console.error("Error uploading image to Firebase Storage:",Ce),h({title:"Storage Upload Failed",description:Ce.message,variant:"destructive"})}).finally(()=>{U(!1)})}else le&&(h({title:"Missing context",description:"Store or product context is missing for image upload.",variant:"destructive"}),U(!1))},Ht=async J=>{if(!g||!w)return;const le={id:`video-${w.id}-${Pt()}`,src:{medium:J,large:J},alt:`${w.name} video`,type:"video"},be=[...me,le];Ue(be);const Te=be.filter(Ce=>Ce.type!=="video").map(Ce=>Ce.src.large||Ce.src.medium),Le=g.products.map(Ce=>Ce.id===n?{...Ce,video_url:J,images:Te}:Ce);try{g&&g.id?(await o(g.id,{products:Le}),we(J),h({title:"Product Video Generated",description:"The video has been added to the product gallery."})):h({title:"Error",description:"Store ID not available for video update.",variant:"destructive"})}catch(Ce){console.error("Failed to update store with product video:",Ce),h({title:"Update Failed",description:"Could not save the product video.",variant:"destructive"})}},tn=async J=>{if(!g||!w)return;const le=g.products.map(be=>be.id===n?{...be,model_3d_url:J,model_3d_thumbnail_url:J}:be);try{g&&g.id?(await o(g.id,{products:le}),Ge(J),je(J),h({title:"3D Model Generated",description:"The 3D model has been added to the product."})):h({title:"Error",description:"Store ID not available for 3D model update.",variant:"destructive"})}catch(be){console.error("Failed to update store with 3D model:",be),h({title:"Update Failed",description:"Could not save the 3D model.",variant:"destructive"})}},Rt=J=>{if(g&&g.id&&w&&J&&J.src&&(J.src.medium||J.src.large)){const le=J.src.large||J.src.medium;if(le.startsWith("https://firebasestorage.googleapis.com")||le.startsWith("http://localhost:")||le.startsWith("https://images.pexels.com")){const be={id:J.id||Pt(),src:{medium:le,large:le},alt:J.alt||w.name,photographer:J.photographer||"User"};if(i(g.id,n,be),!me.find(Le=>Le.src.medium===le||Le.src.large===le)){const Le={...be,id:be.id||Pt()};Ue(Ce=>{const it=Ce.filter(ut=>!ut.src.medium.includes("via.placeholder.com"));return[Le,...it.filter(ut=>ut.src.medium!==le)]})}$e(le),h({title:"Image Selected",description:"Product image updated."})}else h({title:"Invalid Image URL",description:"Selected image does not have a valid storage or Pexels URL.",variant:"destructive"})}else h({title:"Error",description:"Cannot select image. Store, product, or image data missing.",variant:"destructive"});P(!1),M([])};if(l||!g||!w)return a.jsxs("div",{className:"min-h-screen flex items-center justify-center",children:[a.jsx(ft,{className:"h-12 w-12 animate-spin text-primary"}),a.jsx("p",{className:"ml-4 text-muted-foreground",children:"Loading product details..."})]});const sn=me.find(J=>J.src.large===ie||J.src.medium===ie),In=ie||((he=(Z=w.image)==null?void 0:Z.src)==null?void 0:he.large)||((Me=(_e=w.image)==null?void 0:_e.src)==null?void 0:Me.medium)||`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(w.name)}`,Fr=(sn==null?void 0:sn.alt)||((Qe=w.image)==null?void 0:Qe.alt)||w.name,zn=((Q=k==null?void 0:k.price)==null?void 0:Q.amount)!==void 0?parseFloat(k.price.amount):w.price,wr=((se=k==null?void 0:k.price)==null?void 0:se.currencyCode)||w.currencyCode||"USD",un=10,Nn=((ye=g==null?void 0:g.theme)==null?void 0:ye.primaryColor)||"#000000";let dn=[];w&&(w.options&&Array.isArray(w.options)?dn=w.options.map(J=>({...J,name:J.name,values:J.values})):w.variants&&Array.isArray(w.variants)&&w.variants.length>0&&w.variants[0].name&&w.variants[0].values&&(dn=w.variants.map(J=>({...J,name:J.name,values:J.values}))));const cs=async()=>{if(!w||!ie||Object.keys(T).length===0){h({title:"Cannot Visualize",description:"Product data, main image, or selected variants missing.",variant:"destructive"});return}ct(!0),Sn(null),xn(ie);try{const{base64ImageData:J,mimeType:le}=await ce(ie);let be=[];for(const it in T)be.push(`${it}: ${T[it]}`);const Te=be.join(", "),Le=`Visualize the product "${w.name}" with the following attributes: ${Te}. Apply these changes to the provided image.`,Ce=await Wo(J,le,Le);if(Ce&&Ce.editedImageData&&Ce.newMimeType&&typeof Ce.newMimeType=="string"&&Ce.newMimeType.includes("/")){const it=`data:${Ce.newMimeType};base64,${Ce.editedImageData}`,ut={id:`visualized-${Pt()}`,src:{medium:it,large:it},alt:`${w.name} visualized with ${Te}`,photographer:"Variant Visualization by Gemini AI"};Ue(Nt=>[ut,...Nt]),rn(ut.src.medium||ut.src.large),h({title:"Variant Visualized",description:"Comparison slider generated below."})}else{let it="AI image generation failed: ";throw Ce?Ce.editedImageData?Ce.newMimeType?it+=`Invalid MIME type from AI ('${Ce.newMimeType}').`:it+="Missing MIME type from AI.":it+="Missing image data from AI.":it+="No result from AI.",new Error(it)}}catch(J){console.error("Error visualizing variant:",J),Sn(J.message),h({title:"Visualization Failed",description:J.message,variant:"destructive"})}ct(!1)};return a.jsxs("div",{className:"min-h-screen bg-background flex flex-col",children:[a.jsx(Mq,{store:g,isPublishedView:d,productName:w.name}),a.jsxs(Ct.main,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"container mx-auto px-4 py-8 md:py-12 flex-grow",children:[a.jsxs($,{variant:"outline",onClick:()=>f(`/${e}`),className:"mb-6",children:[a.jsx(Go,{className:"mr-2 h-4 w-4"})," Back to Store"]}),a.jsxs("div",{className:"grid md:grid-cols-2 gap-8 lg:gap-12",children:[a.jsxs(Ct.div,{initial:{opacity:0,x:-50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.1},className:"flex flex-col items-center",children:[a.jsxs("div",{className:"relative group w-full",children:[ie&&me.find(J=>(J.src.large===ie||J.src.medium===ie)&&J.type==="video")?a.jsx("video",{src:ie,controls:!0,autoPlay:!0,loop:!0,playsInline:!0,className:"w-full h-auto aspect-square object-cover rounded-xl shadow-lg border",children:"Your browser does not support the video tag."},ie):a.jsx("img",{src:In,alt:Fr,className:"w-full h-auto aspect-square object-cover rounded-xl shadow-lg border"},ie),!d&&a.jsxs(a.Fragment,{children:[a.jsxs($,{variant:"secondary",onClick:()=>P(!0),className:"absolute top-4 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(Q3,{className:"mr-2 h-4 w-4"})," Change Image"]}),a.jsxs($,{variant:"outline",size:"sm",onClick:()=>{te(w),q(!0)},className:"absolute top-16 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(nw,{className:"mr-2 h-4 w-4"})," Edit Product"]}),a.jsxs($,{variant:"outline",size:"sm",onClick:()=>pe(!0),className:"absolute top-28 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(j2,{className:"mr-2 h-4 w-4"})," Gen Video"]}),a.jsxs($,{variant:"outline",size:"sm",onClick:()=>Fe(!0),className:"absolute top-40 right-4 opacity-0 group-hover:opacity-100 transition-opacity duration-300 shadow-md",children:[a.jsx(Uie,{className:"mr-2 h-4 w-4"})," Gen 3D"]})]})]}),me.length>0&&a.jsxs(Ct.div,{className:"mt-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.2,duration:.5},children:[a.jsx("div",{className:"grid grid-cols-4 sm:grid-cols-5 md:grid-cols-6 gap-2",children:me.map((J,le)=>{var be,Te;return a.jsxs(Ct.div,{className:"relative group",whileHover:{scale:1.05},children:[a.jsx("div",{className:`aspect-square rounded-md overflow-hidden cursor-pointer border-2 transition-all hover:opacity-80
                                    ${J.src.large===ie||J.src.medium===ie?"border-primary shadow-sm":"border-transparent"}`,onClick:()=>$e(J.src.large||J.src.medium),children:J.type==="video"?a.jsxs("div",{className:"relative w-full h-full",children:[a.jsx("video",{src:J.src.medium||J.src.large,className:"w-full h-full object-cover",poster:((Te=(be=w.image)==null?void 0:be.src)==null?void 0:Te.medium)||`https://via.placeholder.com/600x600.png?text=${encodeURIComponent(w.name)}`}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black bg-opacity-50",children:a.jsx(j2,{className:"h-8 w-8 text-white"})})]}):a.jsx("img",{src:J.src.medium||J.src.large,alt:J.alt||`Product image ${le+1}`,className:"w-full h-full object-cover"})}),!d&&me.length>1&&!J.src.medium.includes("via.placeholder.com")&&a.jsx($,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-5 w-5 p-0 opacity-0 group-hover:opacity-100 transition-opacity z-10",onClick:Le=>{Le.stopPropagation(),Ne(J.id)},"aria-label":"Delete image",children:a.jsx(Bn,{className:"h-3 w-3"})})]},J.id||`gallery-${le}`)})}),!d&&ie&&!ie.includes("via.placeholder.com")&&a.jsxs($,{variant:"outline",size:"sm",className:"mt-3 w-full",onClick:Y,disabled:re,children:[re?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(Xie,{className:"mr-2 h-4 w-4"}),"Generate More Angles from Active Image"]})]})]}),a.jsxs(Ct.div,{initial:{opacity:0,x:50},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"space-y-6",children:[a.jsx("h1",{className:"text-3xl lg:text-4xl font-bold tracking-tight text-foreground",children:w.name}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"flex items-center",children:[...Array(5)].map((J,le)=>a.jsx(VI,{className:`h-5 w-5 ${le<Math.floor(w.rating)?"text-amber-400 fill-amber-400":"text-muted-foreground/30"}`},le))}),a.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",w.rating," reviews)"]}),a.jsx(zi,{orientation:"vertical",className:"h-5"}),a.jsx(yg,{variant:"outline",style:{borderColor:g.theme.primaryColor,color:g.theme.primaryColor},children:"In Stock"})]}),a.jsxs("p",{className:"text-2xl lg:text-3xl font-semibold",style:{color:g.theme.primaryColor},children:[wr," ",zn.toFixed(2)]}),dn.length>0&&a.jsxs("div",{className:"space-y-4 pt-4",children:[dn.map(J=>a.jsxs("div",{children:[a.jsxs(ke,{className:"text-sm font-medium text-foreground",children:[J.name,":",a.jsx("span",{className:"text-muted-foreground font-normal ml-1",children:T[J.name]||""})]}),a.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:J.values.map(le=>a.jsx($,{variant:T[J.name]===le?"default":"outline",size:"sm",onClick:()=>{R(be=>({...be,[J.name]:le}))},style:T[J.name]===le?{backgroundColor:Nn,color:"white",borderColor:Nn}:{borderColor:g.theme.secondaryColor||"#cccccc",color:g.theme.secondaryColor||"#333333"},children:le},le))})]},J.name)),dn.length>0&&Object.keys(T).length>0&&a.jsxs("div",{className:"mt-4 w-full",children:[en&&kt&&a.jsx("div",{className:"mb-3 flex justify-center",children:a.jsx(Vq,{itemOne:a.jsx(C1,{src:kt,alt:"Original Image"}),itemTwo:a.jsx(C1,{src:en,alt:"Visualized Variant"}),className:"w-full max-w-md h-auto aspect-square rounded-md border shadow-md"})}),a.jsxs($,{onClick:cs,disabled:et,className:"w-full",variant:"outline",children:[et?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Visualize Variant"]}),Mt&&a.jsx("p",{className:"text-red-500 text-xs mt-2",children:Mt})]})]}),a.jsx("div",{className:"prose prose-sm sm:prose dark:prose-invert max-w-none text-muted-foreground pt-4",children:a.jsx("p",{children:w.description})}),w.tags&&w.tags.length>0&&a.jsx("div",{className:"flex flex-wrap gap-2 mt-4",children:w.tags.map(J=>a.jsx(yg,{variant:"secondary",children:J},J))}),a.jsx(zi,{className:"my-6"}),a.jsxs("div",{className:"flex items-end gap-4 pt-4",children:[a.jsxs("div",{className:"space-y-1",children:[a.jsx(ke,{htmlFor:"quantity",className:"text-sm",children:"Quantity"}),a.jsx(qe,{id:"quantity",type:"number",value:_,onChange:Ee,min:"1",max:un,className:"w-20 h-10 text-center",disabled:un===0})]}),a.jsxs($,{size:"lg",onClick:Re,className:"flex-1 h-10",style:{backgroundColor:Nn,color:"white"},disabled:un===0,children:[a.jsx(Wp,{className:"mr-2 h-5 w-5"}),B?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):null,B?"Processing...":"Proceed to Checkout"]})]})]})]}),Ve&&a.jsxs(Ct.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.6,duration:.5},children:[a.jsx("h3",{className:"text-lg font-semibold mb-3 text-foreground",children:"3D Model"}),a.jsx(VRe,{modelUrl:Ve,thumbnailUrl:fe,productName:w.name,height:"500px",className:"w-full"})]}),w&&g&&g.id&&a.jsx(Ct.div,{className:"mt-8",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7,duration:.5},children:a.jsx(URe,{product:w,storeId:g.id,isPublishedView:d})})]}),a.jsx(Lq,{store:g,isPublishedView:d}),!d&&a.jsxs(a.Fragment,{children:[a.jsx(zr,{open:I,onOpenChange:P,children:a.jsxs(Dr,{className:"sm:max-w-2xl",children:[a.jsx(Mr,{children:a.jsx(Lr,{children:"Change Product Image"})}),a.jsxs("div",{className:"space-y-4 py-4",children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(qe,{placeholder:"Search Pexels or describe for AI...",value:A,onChange:J=>D(J.target.value)}),a.jsxs($,{onClick:Be,disabled:z||!A.trim(),children:[z&&j.length===0?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(Kie,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Pexels"})]}),a.jsxs($,{onClick:_t,variant:"outline",disabled:z||!A.trim(),children:[z&&j.length>0?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx(xa,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Gemini"})]}),a.jsxs($,{variant:"outline",onClick:()=>{var J;return(J=document.getElementById("upload-image-input"))==null?void 0:J.click()},disabled:z,children:[a.jsx(Uo,{className:"h-4 w-4"})," ",a.jsx("span",{className:"ml-2 hidden sm:inline",children:"Upload"})]}),a.jsx(qe,{type:"file",id:"upload-image-input",className:"hidden",accept:"image/*",onChange:mt})]}),z&&j.length===0&&a.jsx("p",{className:"text-center text-sm text-muted-foreground",children:"Searching for images or processing upload..."}),j.length>0&&a.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-2 max-h-80 overflow-y-auto",children:j.map(J=>a.jsxs(Ct.div,{className:"relative aspect-square rounded-md overflow-hidden cursor-pointer group border-2 border-transparent hover:border-primary transition-all",onClick:()=>Rt(J),whileHover:{scale:1.05},initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},children:[a.jsx("img",{src:J.src.medium,alt:J.alt||"Search result",className:"w-full h-full object-cover"}),a.jsx("div",{className:"absolute inset-0 bg-black/50 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(YRe,{className:"h-8 w-8 text-white"})}),a.jsx("p",{className:"absolute bottom-0 left-0 right-0 bg-black/70 text-white text-xs p-1 truncate",children:J.photographer||J.alt})]},J.id))})]}),a.jsx(Nr,{children:a.jsx(al,{asChild:!0,children:a.jsx($,{type:"button",variant:"outline",children:"Cancel"})})})]})}),W&&a.jsx(ProductEditModal,{isOpen:K,onClose:()=>q(!1),product:W,onSave:async J=>{if(!g||!w)return;const le=g.products.map(be=>be.id===J.id?{...be,...J}:be);await o(g.id,{products:le}),v(J),h({title:"Product Updated",description:"Your product has been successfully updated."})},storeId:g.id}),w&&a.jsx(ORe,{open:ee,onOpenChange:pe,product:w,onVideoGenerated:Ht}),w&&a.jsx($Re,{open:Ie,onOpenChange:Fe,product:w,onModelGenerated:tn,storeId:g==null?void 0:g.id})]})]})},YRe=t=>a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",...t,children:[a.jsx("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"}),a.jsx("polyline",{points:"22 4 12 14.01 9 11.01"})]}),JRe=()=>{const{cart:t,currentStore:e}=$n(),{user:n}=ls(),[r,s]=p.useState(!1),[i,o]=p.useState(null),l=()=>t.reduce((u,d)=>u+d.price*d.quantity,0),c=async()=>{if(!n){o("You must be logged in to purchase.");return}s(!0),o(null);try{const u=t[0];if(!u)throw new Error("Your cart is empty.");const f=(await Xa(Oh,"createProductCheckoutSession")({productName:u.name,productDescription:u.description,productImage:u.imageUrl,amount:u.price*100,currency:"usd",storeOwnerId:e.merchantId})).data;if(f&&f.url)window.location.href=f.url;else throw new Error("Failed to create checkout session.")}catch(u){console.error("Checkout error:",u),o(u.message||"An unexpected error occurred."),s(!1)}};return a.jsxs(a.Fragment,{children:[a.jsx(ek,{}),a.jsxs("div",{className:"container mx-auto p-4",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Checkout"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold mb-2",children:"Order Summary"}),t.map(u=>a.jsxs("div",{className:"flex justify-between items-center mb-2",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",children:u.name}),a.jsxs("p",{children:["Quantity: ",u.quantity]})]}),a.jsxs("p",{children:["$",(u.price*u.quantity).toFixed(2)]})]},u.id)),a.jsx("hr",{className:"my-2"}),a.jsxs("div",{className:"flex justify-between font-bold",children:[a.jsx("p",{children:"Total"}),a.jsxs("p",{children:["$",l().toFixed(2)]})]})]}),a.jsxs("div",{children:[a.jsx("button",{onClick:c,disabled:r||t.length===0,className:"w-full bg-blue-500 text-white py-2 rounded disabled:bg-gray-400",children:r?"Processing...":"Purchase"}),i&&a.jsx("p",{className:"text-red-500 mt-2",children:i})]})]})]})]})},XRe="https://static.wixstatic.com/media/bd2e29_20f2a8a94b7e492a9d76e0b8b14e623b~mv2.png",QRe="https://static.wixstatic.com/media/bd2e29_c6677c7824044124b64fe765d0e9b88d~mv2.png";function ZRe(){const[t,e]=p.useState(!0),[n,r]=p.useState(""),[s,i]=p.useState(!1),o=p.useRef(),l=p.useRef(),c=wi();p.useEffect(()=>{const h=localStorage.getItem("theme"),f=window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches;h==="dark"||!h&&f?(document.documentElement.classList.add("dark"),i(!0)):(document.documentElement.classList.remove("dark"),i(!1))},[]);const u=async h=>{r("");const f=o.current.value,m=l.current.value;if(!f||!m){r("Please enter both email and password.");return}try{let g;h==="login"?g=await Nue(hp,f,m):(g=await Iue(hp,f,m),await Fh(rs(gn,"profiles",g.user.uid),{id:g.user.uid,email:g.user.email,role:"store_owner",created_at:new Date}),await CT(g.user.uid)),c("/")}catch(g){console.error("Authentication error (Email/Password):",g.message),r(g.message)}},d=async()=>{r("");const h=new Va;try{const m=(await Que(hp,h)).user,g=rs(gn,"profiles",m.uid);(await uP(g)).exists()||(await Fh(g,{id:m.uid,email:m.email,displayName:m.displayName,photoURL:m.photoURL,role:"store_owner",created_at:new Date}),await CT(m.uid)),c("/")}catch(f){console.error("Google Sign-In error:",f.message),f.code==="auth/popup-closed-by-user"?r("Google Sign-In was cancelled. Please try again."):f.code==="auth/account-exists-with-different-credential"?r("An account already exists with the same email address but different sign-in credentials. Try signing in with your original method."):r(`Google Sign-In failed: ${f.message}`)}};return a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-cover bg-center bg-no-repeat p-4",style:{backgroundImage:`url(${QRe})`},children:a.jsxs("div",{className:`w-full max-w-md p-8 md:p-10 space-y-6
                   bg-white/10 dark:bg-black/30 backdrop-blur-lg
                   shadow-2xl rounded-xl border border-white/20 dark:border-black/20`,children:[a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("img",{src:XRe,alt:"FreshFront Logo",className:"h-12 w-auto"})}),a.jsx("h2",{className:"text-center text-3xl font-extrabold text-white mb-6",children:t?"Sign In":"Sign Up"}),n&&a.jsx("p",{className:"text-red-500 text-center",children:n}),a.jsxs("form",{onSubmit:h=>{h.preventDefault(),u(t?"login":"signup")},className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-white mb-1",children:"Email"}),a.jsx("input",{type:"email",id:"email",ref:o,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"you@example.com"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-white mb-1",children:"Password"}),a.jsx("input",{type:"password",id:"password",ref:l,required:!0,className:"w-full p-3 rounded-md bg-white/10 border border-white/20 text-white placeholder-white/70 focus:outline-none focus:ring-2 focus:ring-primary",placeholder:"••••••••"})]}),a.jsx("button",{type:"submit",className:"w-full bg-black text-white py-3 rounded-md font-semibold hover:bg-gray-800 transition-colors",children:t?"Sign In":"Sign Up"})]}),a.jsxs("div",{className:"relative my-6",children:[a.jsx("div",{className:"absolute inset-0 flex items-center","aria-hidden":"true",children:a.jsx("div",{className:"w-full border-t border-white/30"})}),a.jsx("div",{className:"relative flex justify-center text-sm",children:a.jsx("span",{className:"px-2 bg-white/10 dark:bg-black/30 text-white rounded-md",children:"Or continue with"})})]}),a.jsx("div",{children:a.jsxs("button",{type:"button",onClick:d,className:"w-full flex items-center justify-center gap-2 bg-white/90 dark:bg-white/10 text-black dark:text-white py-3 rounded-md font-semibold hover:bg-white dark:hover:bg-white/20 transition-colors border border-white/20",children:[a.jsx("svg",{className:"w-5 h-5","aria-hidden":"true",focusable:"false",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 18 18",children:a.jsxs("g",{fill:"none","fill-rule":"evenodd",children:[a.jsx("path",{d:"M17.64 9.2045c0-.6381-.0573-1.2518-.1636-1.8409H9v3.4818h4.8436c-.2086 1.125-.8427 2.0782-1.7777 2.7218v2.2582h2.9082c1.7018-1.5668 2.6836-3.8741 2.6836-6.621Z",fill:"#4285F4"}),a.jsx("path",{d:"M9 18c2.43 0 4.4673-.8055 5.9564-2.1818l-2.9082-2.2582c-.8055.5436-1.8368.8618-2.9945.8618-2.3127 0-4.2609-1.5668-4.9582-3.6709H1.0718v2.3318C2.5564 16.1632 5.5218 18 9 18Z",fill:"#34A853"}),a.jsx("path",{d:"M4.0418 10.7318c-.1164-.3464-.18-.7173-.18-1.0909 0-.3736.0636-.7445.18-1.0909V6.2182H1.0718C.3859 7.5614 0 9.0182 0 10.6409s.3859 3.0795 1.0718 4.4227l2.97-2.3318Z",fill:"#FBBC05"}),a.jsx("path",{d:"M9 3.5818c1.3218 0 2.5077.4559 3.4405 1.3468l2.5818-2.5818C13.4632.9918 11.43 0 9 0 5.5218 0 2.5564 1.8368 1.0718 4.5727l2.97 2.3318C4.7391 4.9855 6.6873 3.5818 9 3.5818Z",fill:"#EA4335"})]})}),t?"Sign in with Google":"Sign up with Google"]})}),a.jsxs("p",{className:"text-center text-sm text-white pt-4",children:[t?"Don't have an account?":"Already have an account?"," ",a.jsx("button",{onClick:()=>e(!t),className:"text-white hover:underline font-medium",children:t?"Sign Up":"Sign In"})]})]})})}const eje=()=>{const{isAuthenticated:t,user:e}=ls();return a.jsxs(a.Fragment,{children:[a.jsx(ek,{}),a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Our Plan"}),a.jsx("p",{children:"Get full access to all store creation and management features."}),a.jsxs("div",{style:{border:"1px solid #ccc",padding:"20px",margin:"20px auto",maxWidth:"400px",borderRadius:"8px"},children:[a.jsx("h2",{children:"Store Creator Plan"}),a.jsx("p",{style:{fontSize:"2em",fontWeight:"bold",margin:"10px 0"},children:"$24.99 / month"}),a.jsxs("ul",{children:[a.jsx("li",{children:"Full access to publishing"}),a.jsx("li",{children:"Accept payments for your store"}),a.jsx("li",{children:"Unlimited products"}),a.jsx("li",{children:"And more!"})]}),t?null:a.jsxs("p",{children:["Please ",a.jsx(ir,{to:"/auth",children:"log in or sign up"})," to subscribe."]})]})]})]})};function tje(){return new URLSearchParams(wl().search)}const nje=()=>{const e=tje().get("session_id");p.useState(null);const[n,r]=p.useState(!0),[s,i]=p.useState(null);return p.useEffect(()=>{if(!e){i("No session ID found. Your order might still be processing."),r(!1);return}r(!1)},[e]),n?a.jsx("div",{style:{padding:"20px",textAlign:"center"},children:"Loading order details..."}):s?a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Order Status"}),a.jsx("p",{style:{color:"red"},children:s}),a.jsx(ir,{to:"/",children:"Go to Homepage"})]}):a.jsxs("div",{style:{padding:"20px",textAlign:"center"},children:[a.jsx("h1",{children:"Thank You for Your Order!"}),a.jsx("p",{children:"Your payment was successful and your order is being processed."}),a.jsxs("p",{children:["Order (Session ID): ",e]}),a.jsx("p",{children:"You will receive an email confirmation shortly."}),a.jsx(ir,{to:"/",children:"Continue Shopping"})]})},rje=()=>{const{isGenerating:t,progress:e,statusMessage:n}=$n();return a.jsx(Ac,{children:t&&a.jsx(Ct.div,{initial:{y:"-100%",opacity:0},animate:{y:"20px",opacity:1},exit:{y:"-100%",opacity:0},transition:{type:"spring",stiffness:300,damping:30},className:"fixed top-0 left-0 right-0 flex justify-center z-[9999] p-4",children:a.jsxs(Ke,{className:"shadow-2xl rounded-xl overflow-hidden w-full max-w-md",children:[" ",a.jsxs(st,{className:"p-6 space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center mb-1",children:[a.jsx("p",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Store Generation"}),a.jsxs("p",{className:"text-sm font-semibold text-blue-600 dark:text-blue-400",children:[Math.floor(e),"%"]})]}),a.jsx(Ua,{value:e,className:"w-full h-2 [&>div]:bg-blue-600"}),a.jsx("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400 pt-1 min-h-[1.2em]",children:n||"Processing..."})]})]})})})},sje=()=>a.jsxs(CEe,{children:[a.jsx(rje,{})," ",a.jsxs("main",{className:"min-h-screen bg-white dark:bg-gray-900",children:[a.jsx(AX,{})," ",a.jsx(Coe,{}),a.jsx(kq,{})," ",a.jsx(lQ,{})]})]});const ije=({children:t,activeTab:e,setActiveTab:n,storeId:r,storeName:s})=>{const[i,o]=p.useState(""),[l,c]=p.useState([]),u=[{id:"orders",label:"Orders",icon:a.jsx(Wp,{className:"h-5 w-5"})},{id:"products",label:"Products",icon:a.jsx(Vi,{className:"h-5 w-5"})},{id:"customers",label:"Customers",icon:a.jsx($0,{className:"h-5 w-5"})},{id:"payments",label:"Payments",icon:a.jsx(Do,{className:"h-5 w-5"})},{id:"analytics",label:"Analytics",icon:a.jsx(Zv,{className:"h-5 w-5"})},{id:"marketing",label:"Marketing",icon:a.jsx(mh,{className:"h-5 w-5"})},{id:"shipping",label:"Shipping",icon:a.jsx(iw,{className:"h-5 w-5"})},{id:"settings",label:"Settings",icon:a.jsx(kh,{className:"h-5 w-5"})}],d=u.map(m=>({id:m.id,label:m.label,tab:m.id})),h=m=>{const g=m.target.value;if(o(g),g.trim()===""){c([]);return}const x=g.toLowerCase(),w=[];d.forEach(v=>{v.label.toLowerCase().includes(x)&&w.push({id:`${v.id}-main`,label:v.label,tab:v.tab}),v.subItems&&v.subItems.forEach(_=>{_.label.toLowerCase().includes(x)&&w.push({id:_.id,label:`${v.label} > ${_.label}`,tab:v.tab})})}),c(w)},f=m=>{n(m.tab),o(""),c([])};return a.jsxs("div",{className:"flex h-screen bg-muted/40",children:[" ",a.jsxs("div",{className:"w-64 bg-card border-r border-border flex flex-col",children:[" ",a.jsxs("div",{className:"p-4 border-b flex items-center gap-2",children:[" ",s&&a.jsx($,{asChild:!0,variant:"outline",size:"icon",className:"flex-shrink-0",children:a.jsxs(ir,{to:`/${s}`,children:[" ",a.jsx(Go,{className:"h-4 w-4"}),a.jsx("span",{className:"sr-only",children:"Back to Store"})]})}),a.jsxs("div",{className:"relative flex-grow",children:[" ",a.jsx(ac,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),a.jsx(qe,{type:"text",placeholder:"Search dashboard...",className:"pl-9 w-full",value:i,onChange:h}),l.length>0&&a.jsxs(Ke,{className:"absolute mt-1 w-full z-50 max-h-64 overflow-y-auto shadow-lg",children:[" ",a.jsxs("div",{className:"p-1",children:[" ",l.map(m=>a.jsx("button",{className:"w-full text-left px-3 py-1.5 hover:bg-accent rounded-md text-sm",onClick:()=>f(m),children:m.label},m.id))]})]})]})]}),a.jsxs("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[" ",u.map(m=>a.jsxs($,{variant:e===m.id?"secondary":"ghost",className:"w-full justify-start text-left h-10 px-3",onClick:()=>n(m.id),children:[a.jsx("span",{className:"mr-3",children:m.icon})," ",m.label]},m.id))]}),a.jsx("div",{className:"p-4 border-t",children:a.jsx($,{variant:"ghost",className:"w-full justify-start text-left",children:"Help & Support"})})]}),a.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[" ",t]})]})},fO=()=>{const[t,e]=p.useState("all"),n=[{id:"ORD-1234",customer:"John Doe",date:"2023-05-15",total:"$129.99",status:"Fulfilled"},{id:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",total:"$89.50",status:"Processing"},{id:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",total:"$210.75",status:"Pending"}],r=[{id:"CART-567",customer:"Emily Davis",date:"2023-05-15",items:3,total:"$78.45",timeSpent:"12m 30s"},{id:"CART-568",customer:"Michael Brown",date:"2023-05-14",items:2,total:"$45.99",timeSpent:"5m 15s"}],s=[{id:"RET-890",orderId:"ORD-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Wrong size"},{id:"RET-891",orderId:"ORD-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Damaged item"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Orders"}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-4 mb-6",children:[a.jsxs(jt,{value:"all",children:[a.jsx(Wp,{className:"mr-2 h-4 w-4"}),"All Orders"]}),a.jsxs(jt,{value:"abandoned",children:[a.jsx(Ng,{className:"mr-2 h-4 w-4"}),"Abandoned Checkouts"]}),a.jsxs(jt,{value:"returns",children:[a.jsx(DE,{className:"mr-2 h-4 w-4"}),"Returns & Refunds"]}),a.jsxs(jt,{value:"fulfillment",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"}),"Order Fulfillment"]})]}),a.jsx(Dt,{value:"all",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"All Orders"}),a.jsx(Kt,{children:"View and manage all customer orders"})]}),a.jsx(st,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"View"})})]},i.id))})]})})})]})}),a.jsx(Dt,{value:"abandoned",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Abandoned Checkouts"}),a.jsx(Kt,{children:"View details of abandoned shopping carts"})]}),a.jsx(st,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Cart ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Items"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Time Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.items}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:i.timeSpent}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"View Details"})})]},i.id))})]})})})]})}),a.jsx(Dt,{value:"returns",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Returns & Refunds"}),a.jsx(Kt,{children:"Manage customer returns and process refunds"})]}),a.jsx(st,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Return ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.orderId}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.amount}),a.jsx("td",{className:"py-3 px-4",children:i.reason}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx($,{variant:"outline",size:"sm",children:"Process"})]})]},i.id))})]})})})]})}),a.jsx(Dt,{value:"fulfillment",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Order Fulfillment"}),a.jsx(Kt,{children:"Manage and fulfill pending orders"})]}),a.jsx(st,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Fraud Risk"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer Score"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(i=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.id}),a.jsx("td",{className:"py-3 px-4",children:i.customer}),a.jsx("td",{className:"py-3 px-4",children:i.date}),a.jsx("td",{className:"py-3 px-4",children:i.total}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${i.status==="Fulfilled"?"bg-green-100 text-green-800":i.status==="Processing"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:i.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsxs("td",{className:"py-3 px-4",children:[Math.floor(Math.random()*100),"/100"]}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx($,{variant:"default",size:"sm",disabled:i.status==="Fulfilled",children:"Fulfill"})]})]},i.id))})]})})})]})})]})]})},oje=()=>{const[t,e]=p.useState("all"),n=[{id:"PRD-1234",name:"Premium T-Shirt",category:"Apparel",price:"$29.99",inventory:45,status:"Active"},{id:"PRD-1235",name:"Wireless Headphones",category:"Electronics",price:"$89.50",inventory:12,status:"Active"},{id:"PRD-1236",name:"Leather Wallet",category:"Accessories",price:"$49.99",inventory:0,status:"Out of Stock"}],r=[{id:"COL-567",name:"Summer Collection",products:12,type:"Manual",status:"Active"},{id:"COL-568",name:"Holiday Specials",products:8,type:"AI Generated",status:"Draft"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Products"}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-3 mb-6",children:[a.jsxs(jt,{value:"all",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"}),"All Products"]}),a.jsxs(jt,{value:"inventory",children:[a.jsx(Qm,{className:"mr-2 h-4 w-4"}),"Inventory"]}),a.jsxs(jt,{value:"collections",children:[a.jsx(Z_,{className:"mr-2 h-4 w-4"}),"Collections"]})]}),a.jsx(Dt,{value:"all",children:a.jsxs(Ke,{children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"All Products"}),a.jsx(Kt,{children:"Manage your product catalog"})]}),a.jsxs($,{children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"}),"Add Product"]})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(qe,{placeholder:"Search products...",className:"max-w-sm mr-2"}),a.jsx($,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Inventory"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.category}),a.jsx("td",{className:"py-3 px-4",children:s.price}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx($,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})]})]})}),a.jsx(Dt,{value:"inventory",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Inventory Management"}),a.jsx(Kt,{children:"Track and update product inventory levels"})]}),a.jsx(st,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Stock"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Low Stock Alert"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.inventory}),a.jsx("td",{className:"py-3 px-4",children:"10"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.inventory>10?"bg-green-100 text-green-800":s.inventory>0?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.inventory>10?"In Stock":s.inventory>0?"Low Stock":"Out of Stock"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"Update Stock"})})]},s.id))})]})})})]})}),a.jsx(Dt,{value:"collections",children:a.jsxs(Ke,{children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"Collections"}),a.jsx(Kt,{children:"Organize products into collections"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{variant:"outline",children:[a.jsx(Z_,{className:"mr-2 h-4 w-4"}),"Create Manual Collection"]}),a.jsxs($,{children:[a.jsx(Z_,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]}),a.jsx(st,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Collection Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.id}),a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.type}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx($,{variant:"outline",size:"sm",children:"Delete"})]})]},s.id))})]})})})]})})]})]})},aje=()=>{const t=[{id:"CUS-1234",name:"John Doe",email:"john.doe@example.com",orders:5,totalSpent:"$345.75",lastOrder:"2023-05-10",segment:"Loyal"},{id:"CUS-1235",name:"Jane Smith",email:"jane.smith@example.com",orders:2,totalSpent:"$129.50",lastOrder:"2023-04-22",segment:"New"},{id:"CUS-1236",name:"Robert Johnson",email:"robert.j@example.com",orders:8,totalSpent:"$780.25",lastOrder:"2023-05-15",segment:"VIP"}],e=[{id:"SEG-1",name:"New Customers",count:124,description:"Customers with 1-2 orders"},{id:"SEG-2",name:"Loyal Customers",count:86,description:"Customers with 3-7 orders"},{id:"SEG-3",name:"VIP Customers",count:32,description:"Customers with 8+ orders"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Customers"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:e.map(n=>a.jsxs(Ke,{children:[a.jsxs(at,{className:"pb-2",children:[a.jsx(lt,{className:"text-lg",children:n.name}),a.jsx(Kt,{children:n.description})]}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:n.count}),a.jsx($,{variant:"link",className:"p-0",children:"View customers"})]})]},n.id))}),a.jsxs(Ke,{className:"mb-6",children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"Customer Insights"}),a.jsx(Kt,{children:"AI-generated insights about your customer base"})]}),a.jsxs($,{variant:"outline",children:[a.jsx(loe,{className:"mr-2 h-4 w-4"}),"Generate New Insights"]})]}),a.jsx(st,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Your customer base is primarily 25-34 years old (45%), followed by 35-44 years old (30%). The gender distribution is 55% female and 45% male."})]}),a.jsxs("div",{className:"bg-muted/30 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Geographic Distribution"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-card rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Geographic map placeholder"})}),a.jsx("p",{className:"mt-3 text-sm text-muted-foreground",children:"Most of your customers are from California (25%), New York (18%), and Texas (12%). International customers make up 15% of your customer base."})]})]})})]}),a.jsxs(Ke,{children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"All Customers"}),a.jsx(Kt,{children:"View and manage your customer database"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{variant:"outline",children:[a.jsx(Qm,{className:"mr-2 h-4 w-4"}),"Add Tags"]}),a.jsxs($,{children:[a.jsx($0,{className:"mr-2 h-4 w-4"}),"Create Segment"]})]})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"mb-4 flex items-center",children:[a.jsx(qe,{placeholder:"Search customers...",className:"max-w-sm mr-2"}),a.jsx($,{variant:"outline",children:"Search"})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Email"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Orders"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Total Spent"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Last Order"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Segment"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:t.map(n=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:n.id}),a.jsx("td",{className:"py-3 px-4",children:n.name}),a.jsx("td",{className:"py-3 px-4",children:n.email}),a.jsx("td",{className:"py-3 px-4",children:n.orders}),a.jsx("td",{className:"py-3 px-4",children:n.totalSpent}),a.jsx("td",{className:"py-3 px-4",children:n.lastOrder}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${n.segment==="VIP"?"bg-purple-100 text-purple-800":n.segment==="Loyal"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:n.segment})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"View Profile"})})]},n.id))})]})})]})]})]})},lje=()=>{const[t,e]=p.useState("transactions"),{session:n,user:r}=ls(),[s,i]=p.useState(!1),[o,l]=p.useState(null),c=async()=>{if(!(n!=null&&n.access_token)||!r){l("Authentication token not found. Please log in again.");return}i(!0),l(null);try{const f=await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/create-stripe-connect-account",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${n.access_token}`},body:JSON.stringify({record:{id:r.id,email:r.email}})}),m=await f.json();if(!f.ok){const g=m.error||m.data&&m.data.error||"Failed to create Stripe Connect account link.";throw new Error(g)}if(m.account_link_url)window.location.href=m.account_link_url;else if(m.url)window.location.href=m.url;else throw new Error("No URL returned from Stripe Connect account creation.")}catch(f){console.error("Stripe Connect account creation error:",f),l(f.message)}finally{i(!1)}},u=[{id:"TRX-1234",orderId:"ORD-1234",customer:"John Doe",date:"2023-05-15",amount:"$129.99",status:"Completed",method:"Credit Card"},{id:"TRX-1235",orderId:"ORD-1235",customer:"Jane Smith",date:"2023-05-14",amount:"$89.50",status:"Completed",method:"PayPal"},{id:"TRX-1236",orderId:"ORD-1236",customer:"Robert Johnson",date:"2023-05-13",amount:"$210.75",status:"Pending",method:"Credit Card"}],d=[{id:"PAY-567",date:"2023-05-15",amount:"$1,245.75",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-568",date:"2023-05-01",amount:"$980.50",status:"Completed",destination:"Bank Account (****1234)"},{id:"PAY-569",scheduledDate:"2023-06-01",estimatedAmount:"$1,500.00",status:"Scheduled",destination:"Bank Account (****1234)"}],h=[{id:"DSP-890",transactionId:"TRX-1230",customer:"Sarah Wilson",date:"2023-05-10",amount:"$65.00",reason:"Item not received",status:"Under Review"},{id:"DSP-891",transactionId:"TRX-1228",customer:"David Miller",date:"2023-05-09",amount:"$120.50",reason:"Unauthorized charge",status:"Lost"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Payments & Payouts"}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-4 mb-6",children:[" ",a.jsxs(jt,{value:"overview",children:[" ",a.jsx(ef,{className:"mr-2 h-4 w-4"}),"Connect Account"]}),a.jsxs(jt,{value:"transactions",children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),"Transactions"]}),a.jsxs(jt,{value:"payouts",children:[a.jsx(LI,{className:"mr-2 h-4 w-4"}),"Payout Schedule"]}),a.jsxs(jt,{value:"disputes",children:[a.jsx(Ng,{className:"mr-2 h-4 w-4"}),"Disputes & Chargebacks"]})]}),a.jsxs(Dt,{value:"overview",children:[" ",a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Connect Stripe Account"}),a.jsx(Kt,{children:"Connect your Stripe account to start accepting payments and manage payouts."})]}),a.jsxs(st,{children:[a.jsxs($,{onClick:c,disabled:s,children:[a.jsx(ef,{className:"mr-2 h-4 w-4"}),s?"Connecting...":"Connect with Stripe"]}),o&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:o})]})]})]}),a.jsx(Dt,{value:"transactions",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"All Transactions"}),a.jsx(Kt,{children:"View all payment transactions"})]}),a.jsx(st,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Order ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:u.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.orderId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.method}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})})})]})}),a.jsx(Dt,{value:"payouts",children:a.jsxs(Ke,{className:"mb-6",children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"Payout Schedule"}),a.jsx(Kt,{children:"Manage your payout schedule and instant transfers"})]}),a.jsxs($,{children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),"Instant Transfer"]})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Current Balance"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,845.75"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Available for payout"})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Next Payout"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$1,500.00"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Scheduled for June 1, 2023"})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Payout Schedule"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-xl font-medium",children:"Monthly"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Every 1st of the month"}),a.jsx($,{variant:"link",className:"p-0 mt-2",children:"Change schedule"})]})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Payout History"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Payout ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Destination"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:d.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.date||f.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:f.amount||f.estimatedAmount}),a.jsx("td",{className:"py-3 px-4",children:f.destination}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Completed"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"View Details"})})]},f.id))})]})]})]})]})}),a.jsx(Dt,{value:"disputes",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Disputes & Chargebacks"}),a.jsx(Kt,{children:"Manage payment disputes and chargebacks"})]}),a.jsx(st,{children:a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Dispute ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Transaction ID"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Customer"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Reason"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"AI Analysis"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:h.map(f=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:f.id}),a.jsx("td",{className:"py-3 px-4",children:f.transactionId}),a.jsx("td",{className:"py-3 px-4",children:f.customer}),a.jsx("td",{className:"py-3 px-4",children:f.date}),a.jsx("td",{className:"py-3 px-4",children:f.amount}),a.jsx("td",{className:"py-3 px-4",children:f.reason}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${f.status==="Under Review"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:f.status})}),a.jsx("td",{className:"py-3 px-4",children:f.status==="Under Review"?a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"High chance of winning"}):a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"Insufficient evidence"})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),f.status==="Under Review"&&a.jsx($,{variant:"default",size:"sm",children:"Respond"})]})]},f.id))})]})})})]})})]})]})},cje=()=>{const[t,e]=p.useState("sales");return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Analytics & Reports"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Total Sales"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$12,845.75"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(am,{className:"h-4 w-4 mr-1"})," +15% from last month"]})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Orders"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"156"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(am,{className:"h-4 w-4 mr-1"})," +8% from last month"]})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Conversion Rate"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3.2%"}),a.jsxs("p",{className:"text-sm text-red-600 flex items-center",children:[a.jsx(am,{className:"h-4 w-4 mr-1"})," -0.5% from last month"]})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Avg. Order Value"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"$82.34"}),a.jsxs("p",{className:"text-sm text-green-600 flex items-center",children:[a.jsx(am,{className:"h-4 w-4 mr-1"})," +5% from last month"]})]})]})]}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(jt,{value:"sales",children:[a.jsx(Zv,{className:"mr-2 h-4 w-4"}),"Sales Reports"]}),a.jsxs(jt,{value:"traffic",children:[a.jsx(am,{className:"mr-2 h-4 w-4"}),"Traffic & Conversion"]}),a.jsxs(jt,{value:"customers",children:[a.jsx($0,{className:"mr-2 h-4 w-4"}),"Customer Insights"]}),a.jsxs(jt,{value:"marketing",children:[a.jsx(Z3,{className:"mr-2 h-4 w-4"}),"Marketing Attribution"]}),a.jsxs(jt,{value:"products",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"}),"Product Performance"]})]}),a.jsx(Dt,{value:"sales",children:a.jsxs(Ke,{children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"Sales Overview"}),a.jsx(Kt,{children:"Comprehensive sales data with AI summarization"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx($,{variant:"outline",children:"Export"}),a.jsx($,{variant:"outline",children:"Print"})]})]}),a.jsxs(st,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Sales chart placeholder"})})}),a.jsxs(Ke,{className:"bg-muted/30",children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"AI Sales Summary"})}),a.jsxs(st,{children:[a.jsxs("p",{className:"text-sm",children:[a.jsx("strong",{children:"Key Insights:"}),' Your sales have increased by 15% compared to last month, with the highest growth in the "Electronics" category (+24%). Weekend sales are particularly strong, accounting for 45% of your weekly revenue. The average order value has increased by 5%, indicating customers are purchasing higher-value items.']}),a.jsxs("p",{className:"text-sm mt-2",children:[a.jsx("strong",{children:"Recommendations:"}),' Consider running promotions on weekdays to boost sales during slower periods. The "Apparel" category has seen a slight decline (-3%) and may benefit from new product additions or targeted marketing.']})]})]})]})]})}),a.jsx(Dt,{value:"traffic",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Traffic & Conversion Analysis"}),a.jsx(Kt,{children:"Website traffic sources and conversion rates"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Traffic Sources"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Traffic sources chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Conversion Funnel"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Conversion funnel chart placeholder"})})]})]}),a.jsxs(Ke,{className:"bg-muted/30",children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"AI Conversion Recommendations"})}),a.jsxs(st,{children:[a.jsx("p",{className:"text-sm",children:"Your current conversion rate of 3.2% is below the industry average of 4.5% for e-commerce stores in your category. The biggest drop-off occurs at the checkout page (45% abandonment rate)."}),a.jsx("p",{className:"text-sm mt-2",children:a.jsx("strong",{children:"Recommendations:"})}),a.jsxs("ul",{className:"text-sm list-disc pl-5 mt-1",children:[a.jsx("li",{children:"Simplify your checkout process by reducing the number of form fields"}),a.jsx("li",{children:"Add trust badges and security indicators near payment information"}),a.jsx("li",{children:"Implement exit-intent popups with discount offers to reduce cart abandonment"}),a.jsx("li",{children:"Optimize product page load times (currently averaging 3.2s, aim for under 2s)"})]})]})]})]})]})}),a.jsx(Dt,{value:"customers",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Customer Insights"}),a.jsx(Kt,{children:"Detailed analysis of customer behavior and demographics"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Demographics"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Demographics chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Purchase Frequency"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Purchase frequency chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Customer Lifetime Value"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"CLV chart placeholder"})})]})]}),a.jsxs(Ke,{className:"bg-muted/30",children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Customer Personas"})}),a.jsx(st,{children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Tech-Savvy Millennials"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"25-34 years old, urban areas, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Prefer electronics and premium products, shop primarily on mobile devices"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Budget-Conscious Families"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"35-44 years old, suburban areas, middle income"}),a.jsx("p",{className:"text-sm mt-2",children:"Focus on value, frequently use discount codes, buy in bulk"})]}),a.jsxs("div",{className:"bg-card p-3 rounded-md border",children:[a.jsx("h4",{className:"font-medium",children:"Luxury Shoppers"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"45-60 years old, various locations, high income"}),a.jsx("p",{className:"text-sm mt-2",children:"Purchase high-end products, less price sensitive, value quality and service"})]})]})})]})]})]})}),a.jsx(Dt,{value:"marketing",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Marketing Attribution"}),a.jsx(Kt,{children:"Track the effectiveness of your marketing channels"})]}),a.jsxs(st,{children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"h-80 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Marketing attribution chart placeholder"})})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Channel"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Sessions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conv. Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"ROAS"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Organic Search"}),a.jsx("td",{className:"py-3 px-4",children:"2,456"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"4.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$7,845.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Paid Search"}),a.jsx("td",{className:"py-3 px-4",children:"1,245"}),a.jsx("td",{className:"py-3 px-4",children:"62"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$4,980.00"}),a.jsx("td",{className:"py-3 px-4",children:"3.2x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Social Media"}),a.jsx("td",{className:"py-3 px-4",children:"3,120"}),a.jsx("td",{className:"py-3 px-4",children:"78"}),a.jsx("td",{className:"py-3 px-4",children:"2.5%"}),a.jsx("td",{className:"py-3 px-4",children:"$5,460.00"}),a.jsx("td",{className:"py-3 px-4",children:"2.8x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Email Marketing"}),a.jsx("td",{className:"py-3 px-4",children:"980"}),a.jsx("td",{className:"py-3 px-4",children:"49"}),a.jsx("td",{className:"py-3 px-4",children:"5.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,920.00"}),a.jsx("td",{className:"py-3 px-4",children:"4.5x"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Direct"}),a.jsx("td",{className:"py-3 px-4",children:"1,560"}),a.jsx("td",{className:"py-3 px-4",children:"47"}),a.jsx("td",{className:"py-3 px-4",children:"3.0%"}),a.jsx("td",{className:"py-3 px-4",children:"$3,760.00"}),a.jsx("td",{className:"py-3 px-4",children:"N/A"})]})]})]})})]})]})}),a.jsx(Dt,{value:"products",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Product Performance"}),a.jsx(Kt,{children:"Detailed analysis of product sales and performance"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Selling Products"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Top products chart placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Product Category Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"Category performance chart placeholder"})})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Product"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Category"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Units Sold"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Profit Margin"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Return Rate"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Rating"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Premium T-Shirt"}),a.jsx("td",{className:"py-3 px-4",children:"Apparel"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:"$7,345.55"}),a.jsx("td",{className:"py-3 px-4",children:"45%"}),a.jsx("td",{className:"py-3 px-4",children:"2.1%"}),a.jsx("td",{className:"py-3 px-4",children:"4.8/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Wireless Headphones"}),a.jsx("td",{className:"py-3 px-4",children:"Electronics"}),a.jsx("td",{className:"py-3 px-4",children:"124"}),a.jsx("td",{className:"py-3 px-4",children:"$11,098.00"}),a.jsx("td",{className:"py-3 px-4",children:"32%"}),a.jsx("td",{className:"py-3 px-4",children:"3.5%"}),a.jsx("td",{className:"py-3 px-4",children:"4.6/5"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Leather Wallet"}),a.jsx("td",{className:"py-3 px-4",children:"Accessories"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:"$4,899.02"}),a.jsx("td",{className:"py-3 px-4",children:"55%"}),a.jsx("td",{className:"py-3 px-4",children:"1.2%"}),a.jsx("td",{className:"py-3 px-4",children:"4.9/5"})]})]})]})})]})]})})]})]})},uje=()=>{const[t,e]=p.useState("email"),n=[{id:"EM-1234",name:"Summer Sale Announcement",status:"Sent",sentDate:"2023-05-15",opens:1245,clicks:356,conversions:28,revenue:"$2,450"},{id:"EM-1235",name:"New Product Launch",status:"Draft",lastEdited:"2023-05-14"},{id:"EM-1236",name:"Customer Feedback Request",status:"Scheduled",scheduledDate:"2023-05-20"},{id:"EM-1237",name:"Abandoned Cart Recovery",status:"Sent",sentDate:"2023-05-12",opens:876,clicks:234,conversions:15,revenue:"$1,280"}],r=[{id:"SM-567",platform:"Instagram",content:"Summer collection now available!",status:"Published",publishDate:"2023-05-15",engagement:245,likes:189,comments:32},{id:"SM-568",platform:"Facebook",content:"Limited time offer: 20% off all accessories",status:"Scheduled",scheduledDate:"2023-05-18"},{id:"SM-569",platform:"Twitter",content:"Flash sale today only! Use code FLASH25",status:"Published",publishDate:"2023-05-14",engagement:178,likes:45,comments:12},{id:"SM-570",platform:"TikTok",content:"Behind the scenes of our latest photoshoot",status:"Draft",lastEdited:"2023-05-16"}],s=[{id:"BLG-890",title:"10 Summer Fashion Trends",status:"Published",publishDate:"2023-05-10",views:1245,comments:23,shares:56},{id:"BLG-891",title:"How to Choose the Perfect Headphones",status:"Draft",lastEdited:"2023-05-14"},{id:"BLG-892",title:"Sustainable Fashion: Our Commitment",status:"Published",publishDate:"2023-05-05",views:980,comments:18,shares:42},{id:"BLG-893",title:"Gift Guide: Father's Day Edition",status:"Scheduled",scheduledDate:"2023-05-25"}],i=[{id:"PROMO-123",name:"Summer Sale",type:"Discount",value:"20% off",status:"Active",startDate:"2023-05-01",endDate:"2023-05-31",usageCount:245},{id:"PROMO-124",name:"Free Shipping",type:"Free Shipping",value:"Orders over $50",status:"Active",startDate:"2023-05-01",endDate:"2023-06-30",usageCount:189},{id:"PROMO-125",name:"WELCOME10",type:"Discount",value:"10% off first order",status:"Active",startDate:"2023-01-01",endDate:"2023-12-31",usageCount:567},{id:"PROMO-126",name:"Holiday Bundle",type:"Bundle",value:"Buy 2 Get 1 Free",status:"Draft",startDate:"2023-11-15",endDate:"2023-12-25"}];return a.jsxs("div",{className:"bg-background",children:[a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h1",{className:"text-3xl font-bold",children:"Marketing"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs($,{variant:"outline",size:"sm",children:[a.jsx(LI,{className:"h-4 w-4 mr-2"}),"Content Calendar"]}),a.jsxs($,{size:"sm",children:[a.jsx(Ui,{className:"h-4 w-4 mr-2"}),"Create Campaign"]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Email Performance"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"24.5%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Average open rate"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+2.3% from last month"})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Social Engagement"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"1,245"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Total interactions"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+15% from last month"})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Blog Traffic"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"3,890"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Monthly page views"}),a.jsx("p",{className:"text-sm text-green-600 mt-2",children:"+8% from last month"})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Promo Conversions"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-3xl font-bold",children:"12.8%"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Conversion rate"}),a.jsx("p",{className:"text-sm text-red-600 mt-2",children:"-1.2% from last month"})]})]})]}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(jt,{value:"email",children:[a.jsx(mh,{className:"mr-2 h-4 w-4"}),"Email Campaigns"]}),a.jsxs(jt,{value:"social",children:[a.jsx(Hx,{className:"mr-2 h-4 w-4"}),"Social Media"]}),a.jsxs(jt,{value:"seo",children:[a.jsx(ac,{className:"mr-2 h-4 w-4"}),"SEO Tools"]}),a.jsxs(jt,{value:"blog",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Blog"]}),a.jsxs(jt,{value:"promotions",children:[a.jsx(Qm,{className:"mr-2 h-4 w-4"}),"Promotions"]})]}),a.jsx(Dt,{value:"email",children:a.jsxs(Ke,{children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"Email Campaigns"}),a.jsx(Kt,{children:"Create and manage email marketing campaigns"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{variant:"outline",children:[a.jsx(mh,{className:"mr-2 h-4 w-4"}),"Import Template"]}),a.jsxs($,{children:[a.jsx(mh,{className:"mr-2 h-4 w-4"}),"Create Campaign"]})]})]}),a.jsxs(st,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Campaign Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Opens"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Clicks"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Conversions"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Revenue"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:n.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Sent"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.sentDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.opens||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.clicks||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.conversions||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.revenue||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Sent"&&a.jsx($,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Email Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate professional marketing emails with AI, including copy and layout suggestions."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{children:[a.jsx(mh,{className:"mr-2 h-4 w-4"}),"Generate New Email"]}),a.jsxs($,{variant:"outline",children:[a.jsx(Zv,{className:"mr-2 h-4 w-4"}),"A/B Test Generator"]})]})]})]})]})}),a.jsx(Dt,{value:"social",children:a.jsxs(Ke,{children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"Social Media Campaigns"}),a.jsx(Kt,{children:"Create and schedule social media content"})]}),a.jsxs($,{children:[a.jsx(Hx,{className:"mr-2 h-4 w-4"}),"Create Post"]})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Content Calendar"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Content calendar placeholder"})})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Platform Performance"}),a.jsx("div",{className:"h-64 flex items-center justify-center bg-muted rounded-md border",children:a.jsx("p",{className:"text-muted-foreground",children:"Performance chart placeholder"})})]})]}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Recent Posts"}),a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Platform"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Content"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Engagement"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Likes"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.platform}),a.jsx("td",{className:"py-3 px-4",children:o.content}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.scheduledDate||o.lastEdited}),a.jsx("td",{className:"py-3 px-4",children:o.engagement||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.likes||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),o.status!=="Published"&&a.jsx($,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Transform product images into engaging social media content with AI."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{children:[a.jsx(Hx,{className:"mr-2 h-4 w-4"}),"Generate Social Media Images"]}),a.jsxs($,{variant:"outline",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Generate Caption Ideas"]})]})]})]})]})}),a.jsx(Dt,{value:"seo",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"SEO Tools"}),a.jsx(Kt,{children:"Optimize your store for search engines"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Keyword Research"})}),a.jsxs(st,{children:[a.jsxs("div",{className:"mb-4 flex gap-2",children:[a.jsx(qe,{placeholder:"Enter a keyword to research...",className:"flex-1"}),a.jsxs($,{children:[a.jsx(ac,{className:"mr-2 h-4 w-4"}),"Analyze"]})]}),a.jsx("div",{className:"text-sm text-muted-foreground",children:"Recent searches: wireless headphones, premium t-shirts, leather wallet"})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"SEO Performance"})}),a.jsx(st,{children:a.jsx("div",{className:"h-40 flex items-center justify-center bg-muted rounded-md",children:a.jsx("p",{className:"text-muted-foreground",children:"SEO performance chart placeholder"})})})]})]}),a.jsxs("div",{className:"mt-6",children:[a.jsx("h3",{className:"font-medium mb-3",children:"Top Keywords"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Keyword"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Search Volume"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Difficulty"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Current Ranking"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Traffic"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"wireless headphones"}),a.jsx("td",{className:"py-3 px-4",children:"12,400"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-yellow-100 text-yellow-800",children:"Medium"})}),a.jsx("td",{className:"py-3 px-4",children:"#8"}),a.jsx("td",{className:"py-3 px-4",children:"245"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"premium t-shirts"}),a.jsx("td",{className:"py-3 px-4",children:"5,800"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Low"})}),a.jsx("td",{className:"py-3 px-4",children:"#3"}),a.jsx("td",{className:"py-3 px-4",children:"320"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"Optimize"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"leather wallet men"}),a.jsx("td",{className:"py-3 px-4",children:"8,200"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-red-100 text-red-800",children:"High"})}),a.jsx("td",{className:"py-3 px-4",children:"#15"}),a.jsx("td",{className:"py-3 px-4",children:"98"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"Optimize"})})]})]})]})})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Content Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate SEO-optimized content for your product pages and blog posts."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Generate SEO Content"]}),a.jsxs($,{variant:"outline",children:[a.jsx(ac,{className:"mr-2 h-4 w-4"}),"Analyze Page SEO"]})]})]})]})]})}),a.jsx(Dt,{value:"blog",children:a.jsxs(Ke,{children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"Blog"}),a.jsx(Kt,{children:"Create and manage blog content"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{variant:"outline",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Import Article"]}),a.jsxs($,{children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Create New Post"]})]})]}),a.jsxs(st,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Title"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Views"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Comments"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Shares"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.title}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Published"?"bg-green-100 text-green-800":o.status==="Draft"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.publishDate||o.lastEdited||o.scheduledDate}),a.jsx("td",{className:"py-3 px-4",children:o.views||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.comments||"-"}),a.jsx("td",{className:"py-3 px-4",children:o.shares||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx($,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Blog Generator"}),a.jsx("p",{className:"text-sm mb-4",children:"Generate engaging blog content with AI based on your products and target audience."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Generate Blog Post"]}),a.jsxs($,{variant:"outline",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Generate Topic Ideas"]})]})]})]})]})}),a.jsx(Dt,{value:"promotions",children:a.jsxs(Ke,{children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"Promotions"}),a.jsx(Kt,{children:"Create and manage promotional campaigns"})]}),a.jsxs($,{children:[a.jsx(Qm,{className:"mr-2 h-4 w-4"}),"Create Promotion"]})]}),a.jsxs(st,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Start Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"End Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Usage"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:i.map(o=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:o.name}),a.jsx("td",{className:"py-3 px-4",children:o.type}),a.jsx("td",{className:"py-3 px-4",children:o.value}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${o.status==="Active"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:o.status})}),a.jsx("td",{className:"py-3 px-4",children:o.startDate}),a.jsx("td",{className:"py-3 px-4",children:o.endDate}),a.jsx("td",{className:"py-3 px-4",children:o.usageCount||"-"}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"View"}),a.jsx($,{variant:"outline",size:"sm",children:"Edit"})]})]},o.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"AI Promotion Optimizer"}),a.jsx("p",{className:"text-sm mb-4",children:"Get AI recommendations for optimal discount levels and promotion timing based on your sales data."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{children:[a.jsx(Qm,{className:"mr-2 h-4 w-4"}),"Generate Promotion Strategy"]}),a.jsxs($,{variant:"outline",children:[a.jsx(Zv,{className:"mr-2 h-4 w-4"}),"Analyze Past Promotions"]})]})]})]})]})})]})]})},dje=()=>{const[t,e]=p.useState("rates"),n=[{id:"ZONE-1",name:"Domestic",countries:["United States"],methods:[{name:"Standard",price:"$5.99",deliveryTime:"3-5 business days"},{name:"Express",price:"$12.99",deliveryTime:"1-2 business days"}]},{id:"ZONE-2",name:"Canada & Mexico",countries:["Canada","Mexico"],methods:[{name:"Standard",price:"$9.99",deliveryTime:"5-7 business days"},{name:"Express",price:"$19.99",deliveryTime:"2-3 business days"}]},{id:"ZONE-3",name:"International",countries:["Rest of World"],methods:[{name:"Standard",price:"$14.99",deliveryTime:"7-14 business days"},{name:"Express",price:"$29.99",deliveryTime:"3-5 business days"}]}],r=[{id:"SUP-1",name:"GlobalDropship Inc.",products:245,avgShippingTime:"4-7 days",status:"Connected"},{id:"SUP-2",name:"FastShip Solutions",products:189,avgShippingTime:"3-5 days",status:"Pending"},{id:"SUP-3",name:"EcoPackaging Co.",products:78,avgShippingTime:"5-8 days",status:"Connected"}];return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Shipping & Delivery"}),a.jsxs(Si,{value:t,onValueChange:e,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-3 mb-6",children:[a.jsxs(jt,{value:"rates",children:[a.jsx(iw,{className:"mr-2 h-4 w-4"}),"Shipping Rates"]}),a.jsxs(jt,{value:"dropshipping",children:[a.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Dropshipping"]}),a.jsxs(jt,{value:"policy",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Shipping Policy"]})]}),a.jsx(Dt,{value:"rates",children:a.jsxs(Ke,{children:[a.jsxs(at,{className:"flex flex-row items-center justify-between",children:[a.jsxs("div",{children:[a.jsx(lt,{children:"Shipping Zones & Rates"}),a.jsx(Kt,{children:"Configure shipping rates by zone and package type"})]}),a.jsxs($,{children:[a.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Add Shipping Zone"]})]}),a.jsxs(st,{children:[n.map(s=>a.jsxs(Ke,{className:"mb-6",children:[a.jsxs(at,{className:"pb-2",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(lt,{className:"text-lg",children:s.name}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx($,{variant:"outline",size:"sm",children:"Edit"}),a.jsx($,{variant:"outline",size:"sm",children:"Delete"})]})]}),a.jsxs(Kt,{children:["Countries: ",s.countries.join(", ")]})]}),a.jsxs(st,{children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Method"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Price"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Delivery Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:s.methods.map((i,o)=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:i.name}),a.jsx("td",{className:"py-3 px-4",children:i.price}),a.jsx("td",{className:"py-3 px-4",children:i.deliveryTime}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"Edit"}),a.jsx($,{variant:"outline",size:"sm",children:"Delete"})]})]},o))})]})}),a.jsxs($,{variant:"outline",size:"sm",className:"mt-4",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"}),"Add Shipping Method"]})]})]},s.id)),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Package Types"}),a.jsx("p",{className:"text-sm mb-4",children:"Define standard package types to calculate shipping rates accurately."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Small Package"}),a.jsx($,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 1 lb, 9" x 6" x 2"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Medium Package"}),a.jsx($,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 5 lbs, 12" x 9" x 4"'})]}),a.jsxs("div",{className:"p-3 border rounded-md",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h4",{className:"font-medium",children:"Large Package"}),a.jsx($,{variant:"ghost",size:"sm",children:"Edit"})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:'Up to 10 lbs, 18" x 12" x 6"'})]})]}),a.jsxs($,{variant:"outline",size:"sm",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"}),"Add Package Type"]})]})]})]})}),a.jsx(Dt,{value:"dropshipping",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Dropshipping Integration"}),a.jsx(Kt,{children:"Connect with dropshipping suppliers and manage fulfillment"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Fulfillment Mode"})}),a.jsxs(st,{children:[a.jsxs("div",{className:"flex items-center space-x-4",children:[a.jsx($,{variant:"outline",className:"flex-1",children:"Self-Fulfillment"}),a.jsx($,{variant:"default",className:"flex-1",children:"Dropshipping"}),a.jsx($,{variant:"outline",className:"flex-1",children:"Hybrid"})]}),a.jsxs("p",{className:"text-sm text-muted-foreground mt-4",children:["Current mode: ",a.jsx("strong",{children:"Dropshipping"}),". Products will be shipped directly from suppliers to customers."]})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Connect Supplier"})}),a.jsxs(st,{children:[a.jsxs("div",{className:"flex gap-2",children:[a.jsx(qe,{placeholder:"Enter supplier API key or ID",className:"flex-1"}),a.jsxs($,{children:[a.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"We support direct integration with AliExpress, Spocket, Oberlo, and more."})]})]})]}),a.jsx("h3",{className:"font-medium mb-3",children:"Connected Suppliers"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Supplier"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Products"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Avg. Shipping Time"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Actions"})]})}),a.jsx("tbody",{children:r.map(s=>a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:s.name}),a.jsx("td",{className:"py-3 px-4",children:s.products}),a.jsx("td",{className:"py-3 px-4",children:s.avgShippingTime}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:`px-2 py-1 rounded-full text-xs ${s.status==="Connected"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:s.status})}),a.jsxs("td",{className:"py-3 px-4",children:[a.jsx($,{variant:"outline",size:"sm",className:"mr-2",children:"View Products"}),a.jsx($,{variant:"outline",size:"sm",children:"Disconnect"})]})]},s.id))})]})}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Automatic Order Routing"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how orders are routed to different suppliers based on product, location, or other criteria."}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs($,{children:[a.jsx(DE,{className:"mr-2 h-4 w-4"}),"Configure Routing Rules"]}),a.jsxs($,{variant:"outline",children:[a.jsx(Vi,{className:"mr-2 h-4 w-4"}),"View Order Queue"]})]})]})]})]})}),a.jsx(Dt,{value:"policy",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Shipping Policy & Returns"}),a.jsx(Kt,{children:"Configure your shipping policy and return management settings"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Shipping Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Shipping Policy"}),a.jsx("p",{children:"We ship to all 50 US states and select international destinations. Orders are typically processed within 1-2 business days."}),a.jsx("h5",{children:"Domestic Shipping"}),a.jsxs("p",{children:["Standard shipping (3-5 business days): $5.99",a.jsx("br",{}),"Express shipping (1-2 business days): $12.99"]}),a.jsx("h5",{children:"International Shipping"}),a.jsxs("p",{children:["Standard shipping (7-14 business days): $14.99",a.jsx("br",{}),"Express shipping (3-5 business days): $29.99"]}),a.jsx("p",{children:"Free shipping on all domestic orders over $50. Shipping times may vary during peak seasons and holidays."})]})}),a.jsxs($,{className:"mt-4",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Edit Shipping Policy"]})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-medium mb-3",children:"Return Policy"}),a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Return Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs($,{className:"mt-4",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Edit Return Policy"]})]})]}),a.jsxs("div",{className:"mt-6 p-4 bg-muted/30 rounded-lg",children:[a.jsx("h3",{className:"font-medium mb-2",children:"Return Management"}),a.jsx("p",{className:"text-sm mb-4",children:"Configure how returns are processed and managed."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Window"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qe,{type:"number",defaultValue:"30",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"days after delivery"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Restocking Fee"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qe,{type:"number",defaultValue:"10",className:"w-20"}),a.jsx("span",{className:"text-sm",children:"% of item price"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Return Labels"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx($,{variant:"outline",size:"sm",children:"Customer Pays"}),a.jsx($,{variant:"default",size:"sm",children:"Store Provides"})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-sm font-medium mb-2",children:"Refund Method"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx($,{variant:"default",size:"sm",children:"Original Payment"}),a.jsx($,{variant:"outline",size:"sm",children:"Store Credit"})]})]})]}),a.jsxs($,{className:"mt-4",children:[a.jsx(DE,{className:"mr-2 h-4 w-4"}),"Save Return Settings"]})]})]})]})})]})]})},hje=({store:t})=>{var v,_,C,T;const[e,n]=p.useState("store"),{user:r,session:s,subscriptionStatus:i}=ls(),{updateStore:o,isLoadingStores:l}=$n(),[c,u]=p.useState(!1),[d,h]=p.useState(null),[f,m]=p.useState(!1),g=i==="active",x=async()=>{if(!(s!=null&&s.access_token)){h("Authentication token not found. Please log in again.");return}u(!0),h(null);try{const R=await fetch("https://uwbrgokfgelgxeonoqah.supabase.co/functions/v1/create-portal-session",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s.access_token}`}}),k=await R.json();if(!R.ok)throw new Error(k.error||"Failed to create portal session.");window.location.href=k.url}catch(R){console.error("Portal session error:",R),h(R.message)}finally{u(!1)}},w=()=>{var k;const R=((k=r==null?void 0:r.store)==null?void 0:k.subdomain)||"your-store";navigator.clipboard.writeText(`${R}.storegen.app`),m(!0),setTimeout(()=>m(!1),2e3)};return a.jsxs("div",{children:[a.jsx("h1",{className:"text-3xl font-bold mb-6",children:"Settings"}),a.jsxs(Si,{value:e,onValueChange:n,className:"w-full",children:[a.jsxs(ti,{className:"grid grid-cols-5 mb-6",children:[a.jsxs(jt,{value:"store",children:[a.jsx(kh,{className:"mr-2 h-4 w-4"}),"Store Details"]}),a.jsxs(jt,{value:"billing",children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),"Billing"]}),a.jsxs(jt,{value:"domain",children:[a.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Domain Management"]}),a.jsxs(jt,{value:"legal",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Legal Pages"]}),a.jsxs(jt,{value:"footer",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Footer Editor"]})]}),a.jsx(Dt,{value:"store",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Store Details"}),a.jsx(Kt,{children:"Update your store information and preferences"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"store-name",children:"Store Name"}),a.jsx(qe,{id:"store-name",placeholder:"Your Store Name",defaultValue:"My Awesome Store"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"store-email",children:"Store Email"}),a.jsx(qe,{id:"store-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"store-phone",children:"Store Phone"}),a.jsx(qe,{id:"store-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"store-address",children:"Store Address"}),a.jsx(Cn,{id:"store-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"store-currency",children:"Currency"}),a.jsxs("select",{id:"store-currency",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"USD",children:[a.jsx("option",{value:"USD",children:"USD ($)"}),a.jsx("option",{value:"EUR",children:"EUR (€)"}),a.jsx("option",{value:"GBP",children:"GBP (£)"}),a.jsx("option",{value:"CAD",children:"CAD ($)"}),a.jsx("option",{value:"AUD",children:"AUD ($)"})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"store-timezone",children:"Timezone"}),a.jsxs("select",{id:"store-timezone",className:"w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",defaultValue:"America/New_York",children:[a.jsx("option",{value:"America/New_York",children:"Eastern Time (ET)"}),a.jsx("option",{value:"America/Chicago",children:"Central Time (CT)"}),a.jsx("option",{value:"America/Denver",children:"Mountain Time (MT)"}),a.jsx("option",{value:"America/Los_Angeles",children:"Pacific Time (PT)"}),a.jsx("option",{value:"Europe/London",children:"London (GMT)"})]})]})]})]})]}),a.jsxs("div",{className:"mt-6 space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"store-description",children:"Store Description"}),a.jsx(Cn,{id:"store-description",placeholder:"Tell customers about your store...",defaultValue:"Welcome to My Awesome Store! We offer high-quality products at competitive prices. Our mission is to provide exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Oo,{id:"enable-reviews",defaultChecked:!0}),a.jsx(ke,{htmlFor:"enable-reviews",children:"Enable customer reviews"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Oo,{id:"enable-inventory",defaultChecked:!0}),a.jsx(ke,{htmlFor:"enable-inventory",children:"Show inventory warnings on product pages"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Oo,{id:"enable-tax",defaultChecked:!0}),a.jsx(ke,{htmlFor:"enable-tax",children:"Enable automatic tax calculation"})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Oo,{id:"enable-store-theme-toggle",checked:((v=t==null?void 0:t.settings)==null?void 0:v.showThemeToggle)??!0,onCheckedChange:R=>{t&&o&&o(t.id,{settings:{...t.settings,showThemeToggle:R}})},disabled:l||!t}),a.jsx(ke,{htmlFor:"enable-store-theme-toggle",children:"Show theme (light/dark) toggle in store header"})]})]}),a.jsxs($,{className:"mt-6",disabled:l||!t,children:[a.jsx(eS,{className:"mr-2 h-4 w-4"}),"Save Store Details"]})]})]})}),a.jsx(Dt,{value:"billing",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Billing Information"}),a.jsx(Kt,{children:"Manage your subscription and payment methods"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Current Plan"})}),a.jsxs(st,{children:[a.jsx("div",{className:"text-xl font-medium",children:g?"Store Creator Plan":"Free Plan"}),a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:g?"$29.99/month, billed monthly":"Limited features"}),a.jsxs("div",{className:"mt-4",children:[g?a.jsxs($,{onClick:x,disabled:c,children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Manage Subscription"]}):a.jsxs($,{onClick:x,disabled:c,children:[" ",a.jsx(Do,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]}),d&&a.jsx("p",{className:"text-sm text-red-500 mt-2",children:d})]})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Payment Methods"})}),a.jsx(st,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("div",{className:"bg-blue-100 p-2 rounded-md mr-3",children:a.jsx(Do,{className:"h-5 w-5 text-blue-600"})}),a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:"Visa ending in 4242"}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Expires 12/2025"})]})]}),a.jsx($,{variant:"outline",size:"sm",onClick:x,disabled:c,children:"Edit"})]}),a.jsxs($,{variant:"outline",onClick:x,disabled:c,children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Add Payment Method"]})]}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No payment methods available.",a.jsx("br",{}),"Upgrade to add payment methods."]})})})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Billing History"})}),a.jsx(st,{children:g?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Date"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Description"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Amount"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Status"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Invoice"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"May 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"Download"})})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"Apr 1, 2023"}),a.jsx("td",{className:"py-3 px-4",children:"Store Creator Plan"}),a.jsx("td",{className:"py-3 px-4",children:"$29.99"}),a.jsx("td",{className:"py-3 px-4",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs bg-green-100 text-green-800",children:"Paid"})}),a.jsx("td",{className:"py-3 px-4",children:a.jsx($,{variant:"outline",size:"sm",children:"Download"})})]})]})]})}):a.jsx("div",{className:"flex items-center justify-center h-32",children:a.jsxs("p",{className:"text-muted-foreground",children:["No billing history available.",a.jsx("br",{}),"Upgrade to view billing history."]})})})]})]})]})}),a.jsx(Dt,{value:"domain",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Domain Management"}),a.jsx(Kt,{children:"Configure your store's domain and URL settings"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Subdomain"})}),a.jsxs(st,{children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qe,{defaultValue:((_=r==null?void 0:r.store)==null?void 0:_.subdomain)||"your-store",className:"flex-grow"}),a.jsx("span",{className:"text-muted-foreground",children:".storegen.app"})]}),a.jsxs("div",{className:"flex justify-between mt-4",children:[a.jsxs($,{children:[a.jsx(eS,{className:"mr-2 h-4 w-4"}),"Save Subdomain"]}),a.jsx($,{variant:"outline",onClick:w,children:f?a.jsxs(a.Fragment,{children:[a.jsx(Pg,{className:"mr-2 h-4 w-4"})," Copied"]}):a.jsxs(a.Fragment,{children:[a.jsx(FI,{className:"mr-2 h-4 w-4"})," Copy URL"]})})]})]})]}),a.jsxs(Ke,{children:[a.jsxs(at,{className:"pb-2",children:[a.jsx(lt,{className:"text-lg",children:"Custom Domain"}),!g&&a.jsx(Kt,{children:a.jsx("span",{className:"text-yellow-600",children:"Available on paid plans only"})})]}),a.jsx(st,{children:g?a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(qe,{placeholder:"yourdomain.com",className:"flex-grow"}),a.jsxs($,{children:[a.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Connect"]})]}),a.jsx("p",{className:"text-sm text-muted-foreground",children:"Enter your domain name without http:// or www."})]}):a.jsxs("div",{className:"flex flex-col items-center justify-center h-32 space-y-4",children:[a.jsx("p",{className:"text-muted-foreground text-center",children:"Custom domains are available on paid plans only."}),a.jsxs($,{onClick:x,disabled:c,children:[a.jsx(Do,{className:"mr-2 h-4 w-4"}),c?"Loading...":"Upgrade to Pro"]})]})})]})]}),g&&a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"DNS Configuration"})}),a.jsx(st,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-sm",children:"To connect your custom domain, add these DNS records in your domain provider's dashboard:"}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full text-sm",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b",children:[a.jsx("th",{className:"text-left py-3 px-4",children:"Type"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Name"}),a.jsx("th",{className:"text-left py-3 px-4",children:"Value"}),a.jsx("th",{className:"text-left py-3 px-4",children:"TTL"})]})}),a.jsxs("tbody",{children:[a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"@"}),a.jsxs("td",{className:"py-3 px-4",children:[((C=r==null?void 0:r.store)==null?void 0:C.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]}),a.jsxs("tr",{className:"border-b hover:bg-muted/50",children:[a.jsx("td",{className:"py-3 px-4",children:"CNAME"}),a.jsx("td",{className:"py-3 px-4",children:"www"}),a.jsxs("td",{className:"py-3 px-4",children:[((T=r==null?void 0:r.store)==null?void 0:T.subdomain)||"your-store",".storegen.app"]}),a.jsx("td",{className:"py-3 px-4",children:"3600"})]})]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs($,{variant:"outline",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"View DNS Guide"]}),a.jsxs($,{children:[a.jsx(Ou,{className:"mr-2 h-4 w-4"}),"Verify DNS"]})]})]})})]})]})]})}),a.jsx(Dt,{value:"legal",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Legal Pages"}),a.jsx(Kt,{children:"Configure your store's legal documents and policies"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Privacy Policy"})}),a.jsx(st,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Privacy Policy"}),a.jsx("p",{children:"This Privacy Policy describes how your personal information is collected, used, and shared when you visit or make a purchase from our store."}),a.jsx("h5",{children:"Personal Information We Collect"}),a.jsx("p",{children:"When you visit the Site, we automatically collect certain information about your device, including information about your web browser, IP address, time zone, and some of the cookies that are installed on your device."}),a.jsx("p",{children:"Additionally, as you browse the Site, we collect information about the individual web pages or products that you view, what websites or search terms referred you to the Site, and information about how you interact with the Site."}),a.jsx("h5",{children:"How We Use Your Personal Information"}),a.jsx("p",{children:"We use the information that we collect generally to fulfill any orders placed through the Site (including processing your payment information, arranging for shipping, and providing you with invoices and/or order confirmations)."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs($,{children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Edit Privacy Policy"]}),a.jsxs($,{variant:"outline",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Terms of Service"})}),a.jsx(st,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Terms of Service"}),a.jsx("p",{children:"These Terms of Service govern your use of our website and the products and services provided by us."}),a.jsx("h5",{children:"Overview"}),a.jsx("p",{children:"By accessing our website, you agree to these Terms of Service. If you do not agree with any part of these terms, you may not access the website or use our services."}),a.jsx("h5",{children:"Products and Services"}),a.jsx("p",{children:"All products and services displayed on our website are subject to availability. We reserve the right to discontinue any product or service at any time."}),a.jsx("h5",{children:"Accuracy of Information"}),a.jsx("p",{children:"We make every effort to ensure that the information on our website is accurate and up-to-date. However, we do not warrant that product descriptions or other content is accurate, complete, reliable, current, or error-free."})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs($,{children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Edit Terms of Service"]}),a.jsxs($,{variant:"outline",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Refund Policy"})}),a.jsx(st,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Refund Policy"}),a.jsx("p",{children:"We offer a 30-day return policy for most items. To be eligible for a return, your item must be unused and in the same condition that you received it."}),a.jsx("h5",{children:"Return Process"}),a.jsxs("p",{children:["1. Contact our customer service team",a.jsx("br",{}),"2. Receive a Return Merchandise Authorization (RMA) number",a.jsx("br",{}),"3. Ship the item back with the RMA number clearly marked",a.jsx("br",{}),"4. Once received, we will process your refund within 5-7 business days"]}),a.jsx("h5",{children:"Exceptions"}),a.jsxs("p",{children:["Certain items cannot be returned, including:",a.jsx("br",{}),"- Personalized or custom-made products",a.jsx("br",{}),"- Digital downloads",a.jsx("br",{}),"- Gift cards"]})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs($,{children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Edit Refund Policy"]}),a.jsxs($,{variant:"outline",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Cookie Policy"})}),a.jsx(st,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"border rounded-md p-4 h-64 overflow-y-auto",children:a.jsxs("div",{className:"prose prose-sm max-w-none",children:[a.jsx("h4",{children:"Cookie Policy"}),a.jsx("p",{children:"This Cookie Policy explains how we use cookies and similar technologies to recognize you when you visit our website."}),a.jsx("h5",{children:"What are cookies?"}),a.jsx("p",{children:"Cookies are small data files that are placed on your computer or mobile device when you visit a website. Cookies are widely used by website owners in order to make their websites work, or to work more efficiently, as well as to provide reporting information."}),a.jsx("h5",{children:"How we use cookies"}),a.jsx("p",{children:'We use cookies for several reasons. Some cookies are required for technical reasons in order for our website to operate, and we refer to these as "essential" or "strictly necessary" cookies. Other cookies enable us to track and target the interests of our users to enhance the experience on our website.'})]})}),a.jsxs("div",{className:"flex justify-between",children:[a.jsxs($,{children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Edit Cookie Policy"]}),a.jsxs($,{variant:"outline",children:[a.jsx(br,{className:"mr-2 h-4 w-4"}),"Generate with AI"]})]})]})})]})]})]})]})}),a.jsx(Dt,{value:"footer",children:a.jsxs(Ke,{children:[a.jsxs(at,{children:[a.jsx(lt,{children:"Footer Editor"}),a.jsx(Kt,{children:"Customize your store's footer information"})]}),a.jsxs(st,{children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Contact Information"})}),a.jsx(st,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"footer-email",children:"Email"}),a.jsx(qe,{id:"footer-email",type:"email",placeholder:"contact@yourstore.com",defaultValue:(r==null?void 0:r.email)||""})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"footer-phone",children:"Phone"}),a.jsx(qe,{id:"footer-phone",placeholder:"+1 (555) 123-4567",defaultValue:"+1 (555) 123-4567"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"footer-address",children:"Address"}),a.jsx(Cn,{id:"footer-address",placeholder:"123 Main St, City, State, ZIP",defaultValue:"123 Main St\\nNew York, NY 10001\\nUnited States",rows:3})]})]})})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Business Hours"})}),a.jsx(st,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"footer-hours",children:"Hours of Operation"}),a.jsx(Cn,{id:"footer-hours",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-5pm\\nSaturday: 10am-4pm\\nSunday: Closed",rows:3})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"footer-support",children:"Customer Support Hours"}),a.jsx(Cn,{id:"footer-support",placeholder:"Monday-Friday: 9am-5pm",defaultValue:"Monday-Friday: 9am-6pm\\nSaturday: 10am-2pm\\nSunday: Closed",rows:3})]})]})})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"Social Media"})}),a.jsx(st,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"footer-facebook",children:"Facebook"}),a.jsx(qe,{id:"footer-facebook",placeholder:"https://facebook.com/yourstore",defaultValue:"https://facebook.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"footer-instagram",children:"Instagram"}),a.jsx(qe,{id:"footer-instagram",placeholder:"https://instagram.com/yourstore",defaultValue:"https://instagram.com/yourstore"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"footer-twitter",children:"Twitter"}),a.jsx(qe,{id:"footer-twitter",placeholder:"https://twitter.com/yourstore",defaultValue:"https://twitter.com/yourstore"})]})]})})]})]}),a.jsxs(Ke,{children:[a.jsx(at,{className:"pb-2",children:a.jsx(lt,{className:"text-lg",children:"About Us"})}),a.jsx(st,{children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"footer-about",children:"About Us Text"}),a.jsx(Cn,{id:"footer-about",placeholder:"Tell customers about your business...",defaultValue:"My Awesome Store was founded in 2023 with a mission to provide high-quality products at competitive prices. We are committed to exceptional customer service and a seamless shopping experience.",rows:4})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsx(ke,{htmlFor:"footer-copyright",children:"Copyright Text"}),a.jsx(qe,{id:"footer-copyright",placeholder:"© 2023 Your Store. All rights reserved.",defaultValue:`© ${new Date().getFullYear()} My Awesome Store. All rights reserved.`})]})]})})]}),a.jsx("div",{className:"mt-6",children:a.jsxs($,{children:[a.jsx(eS,{className:"mr-2 h-4 w-4"}),"Save Footer Settings"]})})]})]})})]})]})},fje=()=>{const{storeName:t}=k0(),e=wl(),{getStoreById:n,getStoreByName:r,setCurrentStore:s,isLoadingStores:i}=$n(),o=new URLSearchParams(e.search),l=o.get("tab")||"orders",[c,u]=p.useState(l),[d,h]=p.useState(null);p.useEffect(()=>{if(!i&&t){const m=r(t);m?(h(m),s(m)):console.error(`Store with name ${t} not found.`)}},[t,r,s,i]),p.useEffect(()=>{const m=o.get("tab");m&&m!==c&&u(m)},[e.search]);const f=()=>{switch(c){case"orders":return a.jsx(fO,{store:d});case"products":return a.jsx(oje,{store:d});case"customers":return a.jsx(aje,{store:d});case"payments":return a.jsx(lje,{store:d});case"analytics":return a.jsx(cje,{store:d});case"marketing":return a.jsx(uje,{store:d});case"shipping":return a.jsx(dje,{store:d});case"settings":return a.jsx(hje,{store:d});default:return a.jsx(fO,{store:d})}};return i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),a.jsx("p",{className:"text-muted-foreground",children:"Loading dashboard..."})]})}):!d&&!i?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Store Not Found"}),a.jsxs("p",{className:"text-muted-foreground",children:["Could not load dashboard for store: ",t]})]})}):a.jsx(ije,{activeTab:c,setActiveTab:u,storeId:d==null?void 0:d.id,storeName:d==null?void 0:d.name,children:f()})},mje=[{id:"ref1",name:"Retro Futurism",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6520.webp?alt=media&token=0fc64381-9c10-4e96-a5d0-ca928b473471",designStyle:"Retro Futurism (from Looka)",aiPrompt:"A design inspired by retro-futurism and classic arcade games. The layout features bold, white, pixelated typography as the centerpiece, set against a dark, heavily textured and scratched background. The composition is framed by colorful, geometric, pixel-block patterns at the top and bottom, creating a strong contrast and a vintage, high-tech vibe."},{id:"ref2",name:"Neominimalism",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6521.webp?alt=media&token=72ee42cf-fc45-4c8b-866a-0a1422537cdf",designStyle:"Neominimalism (from Looka)",aiPrompt:"A neominimalist poster design with a vibrant, monochromatic background in a shocking pink or other saturated hue. The central visual element is a duotone photograph contained within a large, simple, organic shape like a flower. The typography is a clean, elegant serif font, creating a bold yet airy composition that balances minimalism with unapologetic color."},{id:"ref3",name:"70s Retro",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6522.webp?alt=media&token=8ee998bf-417e-4865-acd2-e4a97068b2fe",designStyle:"70s Retro (from Looka)",aiPrompt:"A retro-themed design with a 70s aesthetic. It features a very bold, chunky serif font as the main headline. The background has a warm, off-white, speckled texture. The composition is decorated with simple, stylized starburst graphics, and the color palette is limited to a classic pairing like bold blue on a neutral cream, evoking a friendly and nostalgic feeling."},{id:"ref4",name:"90s Nostalgia",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6523.webp?alt=media&token=62597e4a-c899-4f47-b474-aecbf714c927",designStyle:"90s Nostalgia (from Looka)",aiPrompt:"A retro graphic inspired by 90s design. The style features extremely bold, heavy, geometric block lettering that fills the frame. The background has a subtly distressed or crumpled paper texture. The color palette is simple but strong, using high-contrast colors like black on yellow. Thin, clean lines and secondary sans-serif fonts frame the central text, adding to the vintage, edgy feel."},{id:"ref5",name:"Art Deco",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6524.webp?alt=media&token=1531edd1-31c6-4b0b-9974-dba3a1cdbbd9",designStyle:"Art Deco (from Looka)",aiPrompt:"A minimalist and elegant logo design in the Art Deco style. The central feature is a sophisticated, classic script font, encircled by arched, sans-serif text. This typography is enclosed within a delicate, symmetrical frame made of clean, intersecting geometric lines with notched corners. The design uses a simple, high-contrast color scheme like black on an off-white background to convey timeless luxury."},{id:"ref6",name:"Mixed Media",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6525.webp?alt=media&token=20587a39-4572-407a-b1ae-0f0266f70579",designStyle:"Mixed Media (from Looka)",aiPrompt:"A mixed media poster design combining classical and modern elements. It features a photographic cutout of a Greco-Roman bust, which is creatively interrupted by hand-drawn, cartoonish line art. The background is a flat, solid color with a subtle, large floral silhouette. The typography is a loose, handwritten script, enhancing the design's artistic, scrapbook-like feel."},{id:"ref7",name:"Doodles and Scribbles",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6526.webp?alt=media&token=4e1a31ec-c1ab-4ca3-94e9-6367d3ff9548",designStyle:"Doodles and Scribbles (from Looka)",aiPrompt:"A design that mimics a page from a notebook, with a pale yellow, lined-paper background. The main visual is a continuous-line illustration, creating a sophisticated yet simple doodle. The typography is a casual, handwritten script, giving the overall composition an informal, brainstorming-session aesthetic."},{id:"ref8",name:"Mixed Media",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6527.jpeg?alt=media&token=9a9a6dad-765f-4a62-b221-7407f831a5a0",designStyle:"Mixed Media (from Looka)",aiPrompt:"A surrealist and maximalist collage. The design features a central grayscale photographic cutout of a face, layered over a vibrant, dreamlike background with abstract shapes and textures. The composition is adorned with disparate and colorful elements like floating objects, botanical illustrations, and snippets of nature photography, creating a psychedelic and visually dense aesthetic."},{id:"ref9",name:"Expressive and Experimental Lettering",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6528.jpeg?alt=media&token=6fd526c3-ff3f-4e9a-bc82-8dffaf3fa80a",designStyle:"Expressive and Experimental Lettering (from Looka)",aiPrompt:"A diptych poster design with a bold, experimental typographic treatment. The layout features dramatic, oversized, and vertically oriented text that dominates the composition. This text is layered over gritty, high-contrast, duotone photographs. The intense color palette and the way the images are seen through the text create a powerful, modern, and edgy aesthetic."},{id:"ref10",name:"Collage Craze",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6533.webp?alt=media&token=d5d771be-2a63-4c63-9bdb-da8172bff7c6",designStyle:"Collage Craze (from Shopify)",aiPrompt:"A maximalist and chaotic collage. The design should be built around a central photographic figure, which is then densely surrounded by a variety of layered elements, including smaller photos, vibrant and colorful stickers, pop-art graphics, and bold, playful text. The composition is tight and energetic, set against a bright, solid-colored background to make the layered elements pop."},{id:"ref11",name:"Acid Graphics",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6537.png?alt=media&token=244611c1-f7ad-4b2c-8ed2-eacf8bba0501",designStyle:"Acid Graphics (from Shopify)",aiPrompt:'A graphic design asset pack with a psychedelic, "acid graphics" theme. The style features bold, cartoonish illustrations with a futuristic or sci-fi edge. The color palette is intensely vibrant and limited, relying on high-contrast pairings like neon green and electric purple against a black background. The overall aesthetic is energetic, edgy, and slightly surreal.'},{id:"ref12",name:"Pixel-peeping",imageUrl:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/IMG_6538.webp?alt=media&token=88344b6f-f5ed-4aae-aa66-2b68dfcdb237",designStyle:"Pixel-peeping (from Shopify)",aiPrompt:"A design that heavily features pixel art aesthetics. The composition should be clean and structured, dominated by a large headline rendered in a bold, black-letter, pixelated font. Include smaller, secondary pixel art graphics. The color scheme is minimalist, using a light, neutral background with high-contrast black for the pixel elements to create a striking, retro digital effect."}],pje=()=>{const[t,e]=p.useState(""),[n,r]=p.useState(null),[s,i]=p.useState(null),[o,l]=p.useState(null),[c,u]=p.useState(!1),[d,h]=p.useState(!1),[f,m]=p.useState(null),[g,x]=p.useState(!1),[w,v]=p.useState([]),[_,C]=p.useState(""),[T,R]=p.useState([]),[k,E]=p.useState(!1),I=wi(),{user:P}=ls(),A=z=>{const U=z.target.files[0];if(U){const K=new FileReader;K.onloadend=()=>{r(K.result),l(K.result)},K.readAsDataURL(U)}},D=z=>{const U=Array.from(z.target.files);if(U.length+w.length>3){m("You can upload a maximum of 3 ingredient images.");return}U.forEach(K=>{const q=new FileReader;q.onloadend=()=>{v(W=>[...W,q.result])},q.readAsDataURL(K)})},j=async()=>{u(!0),m(null),l(null);try{if(!await ba(P.uid,5)){m("You don't have enough credits to generate an image."),u(!1);return}let U;const K=n?n.split(",")[1]:null,q=w.map(W=>({mimeType:"image/png",data:W.split(",")[1]}));if(g&&K)U=await OE(t,K,"image/png",q);else{const W=s?`${t} - ${s.aiPrompt}`:t;U=await eN(W,q)}U.imageData?(l(`data:image/png;base64,${U.imageData}`),R([]),await Qa(P.uid,5)):m(U.text||"Failed to generate image. No image data returned.")}catch(z){console.error("Error generating image:",z),m(z.message||"An unexpected error occurred.")}finally{u(!1)}},M=async()=>{if(!o)return;E(!0),R([]),m(null);const z=[{name:"Black hoodie",url:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Hoodie.jpeg?alt=media&token=733ac963-11ab-4a9d-8fac-445bf2cfb5f0"},{name:"Baseball cap",url:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Hat.jpeg?alt=media&token=d23f6d45-3bd5-456f-9a8d-31ed2c6e49eb"},{name:"Canvas",url:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Canvas.jpeg?alt=media&token=d2383e79-5362-4d18-8908-9e3b2741f724"},{name:"Notebook",url:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Notebook.jpeg?alt=media&token=4126231f-3c59-4398-9498-1db23d63193c"},{name:"T-shirt",url:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Shirt.webp?alt=media&token=212d112c-4ada-4264-81ab-7f1ee365ab36"},{name:"Totebag",url:"https://firebasestorage.googleapis.com/v0/b/fresh-dfe30.firebasestorage.app/o/Totebag.jpeg?alt=media&token=1e446c52-b273-4f01-86d1-3d33624859ea"}],[U,K]=o.split(";base64,");for(const q of z)try{const W=await tf(K,U.replace("data:",""),q.url,t,q.name);W.visualizedImageData&&R(te=>[...te,`data:${W.visualizedImageMimeType};base64,${W.visualizedImageData}`])}catch(W){console.error(`Error visualizing on ${q.name}:`,W)}E(!1)};return a.jsxs("div",{className:"flex flex-col md:flex-row h-screen bg-background text-foreground",children:[a.jsx($,{variant:"ghost",size:"icon",className:"absolute top-4 left-4 z-10 md:hidden",onClick:()=>window.history.back(),children:a.jsx(Go,{})}),a.jsxs("main",{className:"flex-1 flex items-center justify-center p-0 md:p-6 relative bg-background md:order-2",style:{paddingTop:"60px"},children:[o&&a.jsx("div",{className:"absolute top-0 left-0 right-0 bg-primary text-primary-foreground p-2 text-center md:hidden",children:a.jsxs($,{className:"bg-transparent hover:bg-primary/90",children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Create Store with Design"]})}),a.jsxs("div",{className:"w-full md:max-w-2xl aspect-square flex items-center justify-center relative",children:[c&&!d&&a.jsx("p",{children:"Loading..."}),f&&a.jsx("p",{className:"text-red-500",children:f}),o&&!k&&T.length===0&&a.jsx("img",{src:o,alt:"Generated result",className:"max-w-full max-h-full object-contain"}),k&&T.length===0&&a.jsx("p",{children:"Generating Mockups..."}),T.length>0&&a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4 p-4 overflow-y-auto h-full",children:T.map((z,U)=>a.jsx("img",{src:z,alt:`Mockup ${U+1}`,className:"w-full h-full object-contain rounded-lg"},U))}),!c&&!f&&!o&&a.jsx("div",{className:"text-center text-muted-foreground",children:a.jsx("p",{children:"Your design will appear here."})}),o&&a.jsx("div",{className:"absolute top-4 right-4 hidden md:flex flex-col space-y-2 z-10",children:a.jsxs($,{className:"bg-primary hover:bg-primary/90 text-primary-foreground",onClick:()=>I("/",{state:{generatedImage:o}}),children:[a.jsx(Sr,{className:"mr-2 h-4 w-4"}),"Create Store with Design"]})}),o&&a.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex items-center gap-2",children:[a.jsx(qe,{type:"text",value:_,onChange:z=>C(z.target.value),placeholder:"Describe your edit...",className:"bg-background/80 backdrop-blur-sm"}),a.jsx($,{onClick:async()=>{if(_){h(!0),m(null);try{if(!await ba(P.uid,2)){m("You don't have enough credits to edit an image."),h(!1);return}const U=o.split(",")[1],K=await OE(_,U,"image/png");K.imageData?(l(`data:image/png;base64,${K.imageData}`),await Qa(P.uid,2)):m(K.text||"Failed to edit image.")}catch(z){m(z.message)}finally{h(!1),C("")}}},disabled:c||d,className:"bg-secondary hover:bg-secondary/90 text-secondary-foreground",children:d?"Editing...":"Edit"})]})]})]}),a.jsxs("aside",{className:"w-full md:w-1/3 md:max-w-sm p-6 bg-card shadow-md relative md:order-1",children:[a.jsx(ws,{className:"h-full",children:a.jsxs("div",{className:"space-y-6 pb-20",children:[a.jsxs("div",{className:"hidden md:flex items-center justify-between",children:[a.jsx($,{variant:"ghost",size:"icon",onClick:()=>window.history.back(),children:a.jsx(Go,{})}),a.jsx("h1",{className:"text-2xl font-bold",children:"Designer"}),a.jsx("img",{src:"https://static.wixstatic.com/media/bd2e29_695f70787cc24db4891e63da7e7529b3~mv2.png",alt:"Logo",className:"h-8 dark:hidden"}),a.jsx("img",{src:"https://static.wixstatic.com/media/bd2e29_20f2a8a94b7e492a9d76e0b8b14e623b~mv2.png",alt:"Logo Dark",className:"h-8 hidden dark:block"})]}),a.jsx("div",{className:"md:hidden text-center"}),o&&a.jsxs($,{onClick:M,disabled:k,className:"w-full",children:[a.jsx(foe,{className:"mr-2 h-4 w-4"}),k?"Visualizing...":"View on Mockups"]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsx(Oo,{id:"use-own-image",checked:g,onCheckedChange:x}),a.jsx(ke,{htmlFor:"use-own-image",children:"Use your own image"})]}),g&&a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Upload Your Image"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Upload an image to edit."}),a.jsx(qe,{id:"image-upload",type:"file",accept:"image/*",onChange:A,className:"mt-2"}),n&&a.jsxs("div",{className:"mt-4",children:[a.jsx("img",{src:n,alt:"Uploaded preview",className:"w-full rounded-lg shadow-sm"}),a.jsx($,{variant:"link",size:"sm",onClick:()=>r(null),className:"mt-1 px-0",children:"Remove"})]})]}),a.jsx(zi,{}),a.jsxs("div",{children:[a.jsx(ke,{htmlFor:"prompt",className:"text-lg font-semibold",children:"Prompt"}),a.jsx(qe,{id:"prompt",type:"text",value:t,onChange:z=>e(z.target.value),placeholder:"e.g., a futuristic cityscape",className:"mt-2"})]}),a.jsx(zi,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Ingredients"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Add up to 3 images to include in the generation."}),a.jsx(qe,{id:"ingredient-upload",type:"file",accept:"image/*",multiple:!0,onChange:D,className:"mt-2"}),a.jsx("div",{className:"grid grid-cols-3 gap-2 mt-4",children:w.map((z,U)=>a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:z,alt:`Ingredient ${U+1}`,className:"w-full rounded-lg shadow-sm"}),a.jsx($,{variant:"destructive",size:"sm",className:"absolute top-1 right-1 h-6 w-6 p-0",onClick:()=>v(K=>K.filter((q,W)=>W!==U)),children:"X"})]},U))})]}),a.jsx(zi,{}),a.jsxs("div",{children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Reference Styles"}),a.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:"Optionally select a style to influence the generation."}),a.jsx("div",{className:"grid grid-cols-2 gap-4",children:mje.map(z=>a.jsxs("div",{className:`cursor-pointer border-2 rounded-lg overflow-hidden ${(s==null?void 0:s.id)===z.id?"border-primary":"border-transparent"}`,onClick:()=>i((s==null?void 0:s.id)===z.id?null:z),children:[a.jsx("img",{src:z.imageUrl,alt:z.name,className:"w-full h-24 object-cover"}),a.jsx("p",{className:"text-center text-sm p-1 bg-muted",children:z.name})]},z.id))})]}),a.jsx(zi,{})]})}),a.jsx("div",{className:"absolute bottom-6 left-6 right-6",children:a.jsx($,{onClick:j,disabled:c||!t,className:"w-full",children:c?"Generating...":"Generate Image"})})]})]})},gje=()=>a.jsxs("div",{className:"flex flex-col items-center justify-center h-screen",children:[a.jsx("h1",{className:"text-4xl font-bold",children:"Music Page"}),a.jsx("p",{className:"text-lg text-gray-600",children:"This page is under construction."})]}),yje=()=>{const{user:t}=ls(),[e,n]=p.useState(""),[r,s]=p.useState(""),[i,o]=p.useState(""),[l,c]=p.useState(""),[u,d]=p.useState(!1),[h,f]=p.useState([]),[m,g]=p.useState(0),[x,w]=p.useState([]),[v,_]=p.useState(null);p.useEffect(()=>{const E=JSON.parse(localStorage.getItem("podcasts")||"[]");w(E)},[]),p.useEffect(()=>{v&&(c(v.transcript),s(v.coverImageUrl),o(v.audioUrl))},[v]);const C=async E=>{f(A=>[...A,"Generating cover image..."]);const{imageData:I}=await eN(`Create a visually appealing podcast cover image for a podcast about ${E}.`),P=`data:image/png;base64,${I}`;return s(P),f(A=>[...A,"Cover image generated."]),P},T=async(E,I)=>{f(M=>[...M,"Generating audio..."]),g(75);const A=await(await fetch("https://api.elevenlabs.io/v1/text-to-speech/1SM7GgM6IMuvQlz2BwM3/stream",{method:"POST",headers:{"Content-Type":"application/json","xi-api-key":"sk_2997175c9f408b4579a544d993417bb0069872fa26c748e8"},body:JSON.stringify({text:E,model_id:"eleven_multilingual_v2"})})).blob(),D=new FileReader;D.readAsDataURL(A),D.onloadend=()=>{const M=D.result,U=[{coverImageUrl:I,audioUrl:M,transcript:l,topic:e,createdAt:new Date().toISOString()},...x];w(U),localStorage.setItem("podcasts",JSON.stringify(U))};const j=URL.createObjectURL(A);o(j),_({...newPodcast,audioUrl:j}),f(M=>[...M,"Audio generated."]),g(100)},R=async()=>{if(!e.trim())return;d(!0),o(""),f([]),g(0),_(null);const E=new _n({apiKey:"AIzaSyDOjjeLKSsIEOrBtYq7RZpShBG_XcEjyvk"});try{if(!await ba(t.uid,10)){f(j=>[...j,"You don't have enough credits to create a podcast."]),d(!1);return}f(j=>[...j,"Generating transcript..."]),g(25);const A=(await E.models.generateContent({model:"gemini-2.5-flash",contents:`Generate a short, conversational-style solo podcast script about ${e}. The output should be only the dialogue, without any speaker names, titles, or other text.`})).text;c(A),f(j=>[...j,"Transcript generated."]),g(50);const D=await C(e);await T(A,D),await Qa(t.uid,10)}catch(I){console.error("Error generating podcast:",I),f(P=>[...P,"Error generating podcast."])}finally{d(!1)}},k=E=>{const I=x.filter(P=>P.createdAt!==E);w(I),localStorage.setItem("podcasts",JSON.stringify(I))};return a.jsxs("div",{className:`flex flex-col items-center min-h-screen bg-neutral-100 dark:bg-neutral-900 relative text-neutral-900 dark:text-neutral-100 pt-20 ${x.length===0?"justify-center":""}`,children:[a.jsx($,{variant:"ghost",size:"icon",className:"absolute top-4 left-4",onClick:()=>v?_(null):window.history.back(),children:a.jsx(Go,{})}),!v&&!u&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6",children:[a.jsx("h1",{className:"text-3xl font-bold text-center",children:"Create a Podcast"}),a.jsx("div",{className:"space-y-2",children:a.jsx(qe,{type:"text",placeholder:"Enter a topic, ex. 2025 print on demand trends...",value:e,onChange:E=>n(E.target.value),className:"w-full bg-neutral-200/50 dark:bg-neutral-800/50 rounded-[18px] border-neutral-300 dark:border-neutral-700"})}),a.jsx($,{onClick:R,className:"w-full bg-blue-600 hover:bg-blue-700",children:"Create"})]}),x.length>0&&a.jsx("div",{className:"w-full max-w-6xl mx-auto p-8",children:a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:x.map((E,I)=>a.jsxs("div",{className:"bg-white dark:bg-neutral-800 rounded-lg shadow-md",children:[a.jsxs("div",{className:"relative",children:[a.jsx("img",{src:E.coverImageUrl,alt:"Podcast Cover",className:"w-full h-48 object-cover cursor-pointer rounded-t-lg",onClick:()=>_(E)}),a.jsx($,{variant:"destructive",size:"icon",className:"absolute -top-2 -right-2 h-8 w-8 rounded-full bg-black/50 hover:bg-black/75",onClick:()=>k(E.createdAt),children:"X"})]}),a.jsx("div",{className:"p-4",children:a.jsx("audio",{controls:!0,src:E.audioUrl,className:"w-full"})})]},I))})})]}),u&&a.jsxs("div",{className:"w-full max-w-md p-8 space-y-6 flex flex-col items-center",children:[a.jsx(Ua,{value:m,className:"w-full"}),a.jsx("div",{className:"text-center",children:h.map((E,I)=>a.jsx("p",{children:E},I))})]}),v&&!u&&a.jsx("div",{className:"w-full max-w-4xl p-4 sm:p-8",children:a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 items-start",children:[a.jsx("div",{className:"w-full",children:v.coverImageUrl&&a.jsx("img",{src:v.coverImageUrl,alt:"Podcast Cover",className:"w-full h-auto rounded-2xl shadow-2xl"})}),a.jsxs("div",{className:"w-full space-y-4",children:[a.jsx("textarea",{value:l,onChange:E=>c(E.target.value),className:"w-full h-64 p-4 border rounded-2xl bg-neutral-200/50 dark:bg-neutral-800/50 border-neutral-300 dark:border-neutral-700 text-sm",placeholder:"Your podcast transcript..."}),a.jsx("audio",{controls:!0,src:i,className:"w-full"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[a.jsx($,{onClick:()=>_(null),className:"w-full bg-blue-600 hover:bg-blue-700 rounded-lg",children:"Back"}),a.jsx($,{onClick:()=>T(l,r),className:"w-full bg-purple-600 hover:bg-purple-700 rounded-lg",children:"Regenerate"}),a.jsx("a",{href:i,download:"podcast.mp3",className:"w-full",children:a.jsx($,{className:"w-full bg-green-600 hover:bg-green-700 rounded-lg",children:"Download"})})]})]})]})})]})},bm=t=>new Promise((e,n)=>{if(!t)return n(new Error("Image source is undefined or null."));if(t.startsWith("data:"))try{const r=t.split(",");if(r.length<2)throw new Error("Invalid data URL structure.");const s=r[0],i=r[1],o=s.match(/:(.*?);/);if(!o||!o[1])throw new Error("Could not parse MIME type from data URL.");const l=o[1];e({base64ImageData:i,mimeType:l})}catch(r){console.error("Error parsing data URL:",t,r),n(new Error(`Invalid data URL format: ${r.message}`))}else{const r=new Image;r.crossOrigin="Anonymous",r.onload=()=>{const s=document.createElement("canvas");s.width=r.naturalWidth,s.height=r.naturalHeight,s.getContext("2d").drawImage(r,0,0);try{let o="image/png";(t.toLowerCase().endsWith(".jpg")||t.toLowerCase().endsWith(".jpeg"))&&(o="image/jpeg");const u=s.toDataURL(o).split(",")[1];e({base64ImageData:u,mimeType:o})}catch(o){console.error("Canvas toDataURL failed:",o),n(new Error("Canvas toDataURL failed. "+o.message))}},r.onerror=s=>{console.error("Failed to load image from URL for conversion:",t,s),n(new Error("Failed to load image from URL for conversion."))},r.src=t}}),xje=()=>{const{user:t}=ls(),{toast:e}=Ss(),[n,r]=p.useState("text-to-image"),[s,i]=p.useState(""),[o,l]=p.useState(""),[c,u]=p.useState(!1),[d,h]=p.useState(!1),[f,m]=p.useState(null),[g,x]=p.useState([]),[w,v]=p.useState(!1),[_,C]=p.useState(""),[T,R]=p.useState(null),[k,E]=p.useState(!1),[I,P]=p.useState(null),[A,D]=p.useState([]),[j,M]=p.useState(""),[z,U]=p.useState(!1),[K,q]=p.useState(null),[W,te]=p.useState(!1),[O,V]=p.useState(null),H=async()=>{var fe,je;if(!(!O||!O.url))try{const ie=document.createElement("a");let $e="download";if(O.url.startsWith("data:")){const me=O.url.match(/:(.*?);/),et=(me?me[1]:"application/octet-stream").split("/")[1]||"bin";$e=`${((fe=O.caption)==null?void 0:fe.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${et}`,ie.href=O.url}else{const Ue=await(await fetch(O.url)).blob();ie.href=URL.createObjectURL(Ue);const et=O.url.substring(O.url.lastIndexOf("/")+1).split("?")[0],ct=et.includes(".")?et.substring(et.lastIndexOf(".")+1):"",Mt=O.type==="video"?"mp4":"png";$e=et||`${((je=O.caption)==null?void 0:je.replace(/[^a-z0-9]/gi,"_").toLowerCase())||"media"}.${ct||Mt}`}ie.download=$e,document.body.appendChild(ie),ie.click(),document.body.removeChild(ie),O.url.startsWith("data:")||URL.revokeObjectURL(ie.href),e({title:"Download Started",description:`Downloading ${$e}`})}catch(ie){console.error("Error downloading media:",ie),e({title:"Download Failed",description:ie.message,variant:"destructive"})}},L=async()=>{if(!s.trim()){e({title:"Error",description:"Please enter a prompt for image generation",variant:"destructive"});return}u(!0),m(null),M("");try{const fe=await L0(s);let je=fe.alt?[fe.alt]:[`Image for: ${s.substring(0,30)}`];if(fe.url)try{const{base64ImageData:ie,mimeType:$e}=await bm(fe.url);je=await ca(ie,$e,`Image of ${s}`)}catch(ie){console.error("Error generating caption for Gemini image:",ie),je=[`Failed to generate caption for: ${s.substring(0,30)}`]}m({url:fe.url,captions:je,sourceApi:"gemini"}),je&&je.length>0&&M(je[0])}catch(fe){console.error("Error generating image with Gemini:",fe),e({title:"Image Generation Failed",description:fe.message,variant:"destructive"})}finally{u(!1)}},ee=async()=>{if(!o.trim()){e({title:"Error",description:"Please enter a prompt for OpenAI image generation",variant:"destructive"});return}h(!0),m(null),M("");try{const fe=await HG(o),je=`data:image/png;base64,${fe.b64_json}`;let ie=fe.alt?[fe.alt]:[`OpenAI image for: ${o.substring(0,30)}`];try{const{base64ImageData:$e,mimeType:me}=await bm(je);ie=await ca($e,me,`OpenAI-generated image of ${o}`)}catch($e){console.error("Error generating caption for OpenAI image:",$e),ie=[`Failed to generate caption for: ${o.substring(0,30)}`]}m({url:je,captions:ie,sourceApi:"openai"}),ie&&ie.length>0&&M(ie[0]),e({title:"Image Generated (OpenAI)",description:"Image successfully generated using OpenAI."})}catch(fe){console.error("Error generating image with OpenAI:",fe),e({title:"OpenAI Image Generation Failed",description:fe.message,variant:"destructive"})}finally{h(!1)}},pe=async(fe,je)=>{if(!fe||!fe.url){e({title:"Error",description:"No image selected to edit with Gemini.",variant:"destructive"});return}if(!je.trim()){e({title:"Error",description:"Please enter an edit prompt for Gemini.",variant:"destructive"});return}E(!0),P(null),M("");try{const{base64ImageData:ie,mimeType:$e}=await bm(fe.url),me=await Wo(ie,$e,je);if(me&&me.editedImageData){const Ue=`data:${me.newMimeType};base64,${me.editedImageData}`;let et=me.editTextResponse?[me.editTextResponse]:[`Edited with Gemini: ${fe.caption||fe.id}`];try{et=await ca(me.editedImageData,me.newMimeType,`Edited image based on: ${je}`)}catch(ct){console.error("Error generating caption for Gemini edited image:",ct)}P({url:Ue,captions:et,sourceApi:"gemini"}),et&&et.length>0&&M(et[0]),e({title:"Image Edited (Gemini)",description:"Image successfully edited with Gemini."})}else throw new Error("Gemini image edit did not return image data.")}catch(ie){console.error("Error editing image with Gemini:",ie),e({title:"Gemini Edit Failed",description:ie.message,variant:"destructive"})}finally{E(!1)}},xe=async fe=>{const je=fe.target.files[0];if(je){te(!0),q(null),M("");try{const ie=new FileReader;ie.onload=async $e=>{const me=$e.target.result,Ue=je.type.startsWith("video/")?"video":"image";let et=[je.name];if(Ue==="image")try{const{base64ImageData:ct,mimeType:Mt}=await bm(me);et=await ca(ct,Mt,"Uploaded image caption")}catch(ct){console.error("Error generating caption for uploaded image:",ct)}else et=[`Uploaded video: ${je.name}`];q({url:me,captions:et,type:Ue}),et&&et.length>0&&M(et[0]),te(!1)},ie.onerror=()=>{e({title:"Upload Failed",description:"Failed to read the selected file",variant:"destructive"}),te(!1)},ie.readAsDataURL(je)}catch(ie){console.error("Error processing uploaded file:",ie),e({title:"Upload Failed",description:ie.message,variant:"destructive"}),te(!1)}}},we=(fe,je,ie="image")=>{if(!fe){e({title:"Cannot Add",description:"Item URL is missing.",variant:"destructive"});return}const $e={id:Pt(),type:ie,url:fe,caption:je||`Item ${A.length+1}`,isVideo:ie==="video"};D(me=>[...me,$e]),e({title:"Added to Timeline",description:`${ie==="video"?"Video":"Image"} added to your content timeline.`}),m(null),P(null),q(null),R(null),M("")},Ie=(fe,je)=>{const ie=[...A],$e=ie[fe],me=fe+je;me<0||me>=ie.length||(ie.splice(fe,1),ie.splice(me,0,$e),D(ie))},Fe=fe=>{D(je=>je.filter(ie=>ie.id!==fe)),e({title:"Removed from Timeline",description:"Item removed."})},Ve=async(fe,je)=>{if(fe.isVideo){e({title:"Already a Video",description:"This item is already a video."});return}U(!0);try{if(!await ba(t.uid,15)){e({title:"Error",description:"You don't have enough credits to generate a video.",variant:"destructive"}),U(!1);return}const{base64ImageData:$e,mimeType:me}=await bm(fe.url),Ue=fe.caption||"Create a short video from this image",et=await nN(Ue,$e,me),ct=[...A];ct[je]={...fe,url:et,isVideo:!0,type:"video",caption:fe.caption+" (Veo Video)"},D(ct),await Qa(t.uid,15),e({title:"Veo Video Generated",description:"Image converted to video using Veo."})}catch(ie){console.error("Error converting to Veo video:",ie),e({title:"Veo Conversion Failed",description:ie.message,variant:"destructive"})}finally{U(!1)}},Ge=fe=>{const je=A.find($e=>$e.id===fe);if(!je)return;const ie=prompt("Edit caption:",je.caption);ie!==null&&ie.trim()!==je.caption&&(D($e=>$e.map(me=>me.id===fe?{...me,caption:ie.trim()}:me)),e({title:"Caption Updated"}))};return a.jsxs("div",{className:"container mx-auto p-4 md:p-6 lg:p-8 space-y-8 bg-background",children:[a.jsxs("header",{className:"relative text-center pb-4",children:[a.jsx(ir,{to:"/",className:"absolute left-0 top-0",children:a.jsxs($,{variant:"outline",size:"icon",children:[a.jsx(Go,{className:"h-5 w-5"}),a.jsx("span",{className:"sr-only",children:"Back to Home"})]})}),a.jsx("h1",{className:"text-3xl md:text-4xl font-bold tracking-tight",children:"AI Content Creation Studio"}),a.jsx("p",{className:"text-muted-foreground mt-2 text-lg",children:"Generate images, edit them, create videos, and build your content sequence."})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6 xl:gap-8",children:[a.jsx("div",{className:"lg:col-span-1 space-y-6",children:a.jsxs(Si,{value:n,onValueChange:r,className:"w-full",children:[a.jsxs(ti,{className:"grid w-full grid-cols-3",children:[a.jsxs(jt,{value:"text-to-image",children:[a.jsx(xa,{className:"mr-1 h-4 w-4 inline-block"}),"Gen Image"]}),a.jsxs(jt,{value:"image-edit",children:[a.jsx(sw,{className:"mr-1 h-4 w-4 inline-block"}),"Edit Image"]}),a.jsxs(jt,{value:"upload",children:[a.jsx(eU,{className:"mr-1 h-4 w-4 inline-block"}),"Upload"]})]}),a.jsxs(Dt,{value:"text-to-image",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(ke,{htmlFor:"text-prompt-model1",className:"text-lg font-semibold",children:"Text-to-Image (Quick)"}),a.jsx(Cn,{id:"text-prompt-model1",placeholder:"e.g., 'A futuristic cityscape at sunset'",value:s,onChange:fe=>i(fe.target.value),rows:3,className:"mt-2",disabled:c||d}),w&&a.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Loading prompt suggestions..."}),g.length>0&&!w&&a.jsxs("div",{className:"mt-2 space-y-1",children:[a.jsx(ke,{className:"text-xs text-muted-foreground",children:"Suggestions:"}),a.jsx("div",{className:"flex flex-wrap gap-1",children:g.map((fe,je)=>a.jsx($,{variant:"outline",size:"xs",onClick:()=>i(fe),className:"text-xs",children:fe.length>40?fe.substring(0,37)+"...":fe},je))})]}),a.jsxs($,{onClick:L,disabled:c||d||!s.trim(),className:"w-full mt-3",children:[c?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Generate with Quick"]}),a.jsx(zi,{className:"my-4"}),a.jsx(ke,{htmlFor:"text-prompt-model2",className:"text-lg font-semibold",children:"Text-to-Image (Quality)"}),a.jsx(Cn,{id:"text-prompt-model2",placeholder:"e.g., 'A photorealistic cat astronaut'",value:o,onChange:fe=>l(fe.target.value),rows:3,className:"mt-2",disabled:c||d}),a.jsxs($,{onClick:ee,disabled:c||d||!o.trim(),className:"w-full mt-3",children:[d?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(q3,{className:"mr-2 h-4 w-4"}),"Generate with Quality"]}),f&&f.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:f.url,alt:`Generated by ${f.sourceApi==="gemini"?"Quick":f.sourceApi==="openai"?"Quality":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",f.sourceApi==="gemini"?"Quick":f.sourceApi==="openai"?"Quality":"AI"]}),a.jsx(ke,{className:"text-sm font-medium",children:"Choose a caption:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(f.captions||[]).map((fe,je)=>a.jsx($,{variant:j===fe?"default":"outline",size:"sm",onClick:()=>M(fe),className:"text-xs",children:fe},je))}),a.jsxs($,{onClick:()=>we(f.url,j),size:"sm",className:"w-full mt-2",disabled:!j,children:[a.jsx(Au,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]}),a.jsxs(Dt,{value:"image-edit",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(ke,{className:"text-lg font-semibold",children:"Image Editing"}),!T&&a.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Select an image from the timeline to enable editing."}),T&&a.jsxs("div",{className:"mt-2 space-y-3",children:[a.jsxs("p",{className:"text-sm font-medium",children:["Editing: ",a.jsx("span",{className:"text-primary truncate",children:T.caption})]}),a.jsx("img",{src:T.url,alt:"Selected for editing",className:"w-full rounded-md object-contain max-h-48 border"}),a.jsx(ke,{htmlFor:"edit-prompt-model1",children:"Edit with Quick"}),a.jsx(Cn,{id:"edit-prompt-model1",placeholder:"Describe edits (e.g., 'change background to a beach')",value:_,onChange:fe=>C(fe.target.value),rows:2,disabled:k}),a.jsxs($,{onClick:()=>pe(T,_),disabled:k||!_.trim(),className:"w-full",children:[k?a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(xa,{className:"mr-2 h-4 w-4"}),"Edit with Quick"]})]}),I&&I.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[a.jsx("img",{src:I.url,alt:`Edited by ${I.sourceApi==="gemini"?"Quick":"AI"}`,className:"w-full rounded-md object-contain max-h-96"}),a.jsxs("p",{className:"text-xs text-muted-foreground",children:["Source: ",I.sourceApi==="gemini"?"Quick":"AI"]}),a.jsx(ke,{className:"text-sm font-medium",children:"Choose a caption for the edited image:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(I.captions||[]).map((fe,je)=>a.jsx($,{variant:j===fe?"default":"outline",size:"sm",onClick:()=>M(fe),className:"text-xs",children:fe},je))}),a.jsxs($,{onClick:()=>we(I.url,j),size:"sm",className:"w-full mt-2",disabled:!j,children:[a.jsx(Au,{className:"mr-2 h-4 w-4"})," Add Edited to Timeline"]})]})]}),a.jsxs(Dt,{value:"upload",className:"mt-4 p-4 border rounded-lg bg-card shadow",children:[a.jsx(ke,{htmlFor:"file-upload",className:"text-lg font-semibold",children:"Upload Image or Video"}),a.jsx(qe,{id:"file-upload",type:"file",accept:"image/*,video/*",onChange:xe,className:"mt-2",disabled:W}),W&&a.jsxs("div",{className:"mt-2 flex items-center text-sm text-muted-foreground",children:[a.jsx(ft,{className:"mr-2 h-4 w-4 animate-spin"})," Processing..."]}),K&&K.url&&a.jsxs("div",{className:"mt-4 border rounded-md p-4 space-y-3 bg-muted/50 min-h-[320px]",children:[K.type==="image"?a.jsx("img",{src:K.url,alt:"Uploaded content",className:"w-full rounded-md object-contain max-h-96"}):a.jsx("video",{src:K.url,controls:!0,className:"w-full rounded-md max-h-96",children:"Your browser does not support the video tag."}),a.jsx(ke,{className:"text-sm font-medium",children:"Choose a caption for the uploaded content:"}),a.jsx("div",{className:"flex flex-wrap gap-2",children:(K.captions||[]).map((fe,je)=>a.jsx($,{variant:j===fe?"default":"outline",size:"sm",onClick:()=>M(fe),className:"text-xs",children:fe},je))}),a.jsxs($,{onClick:()=>we(K.url,j,K.type),size:"sm",className:"w-full mt-2",disabled:!j,children:[a.jsx(Au,{className:"mr-2 h-4 w-4"})," Add to Timeline"]})]})]})]})}),a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"p-4 md:p-6 border rounded-lg bg-card shadow min-h-[400px]",children:[a.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Content Timeline"}),a.jsx(ws,{className:"h-[calc(100vh-350px)] min-h-[300px] pr-3",children:A.length===0?a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground",children:[a.jsx(W3,{className:"h-12 w-12 mb-3"}),a.jsx("p",{children:"Your timeline is empty."}),a.jsx("p",{className:"text-sm",children:"Generate or upload content to get started."})]}):a.jsx(Ac,{children:A.map((fe,je)=>a.jsxs(Ct.div,{layout:!0,initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,x:-50},transition:{type:"spring",stiffness:300,damping:30},className:"mb-3 p-3 border rounded-md flex items-start gap-3 hover:shadow-md transition-shadow bg-background cursor-pointer",onClick:()=>V(fe),children:[a.jsxs("div",{className:"w-24 h-24 flex-shrink-0 relative rounded overflow-hidden group bg-muted",children:[fe.isVideo?a.jsx("video",{src:fe.url,className:"w-full h-full object-cover",controls:!1,muted:!0,loop:!0,onMouseOver:ie=>ie.target.play(),onMouseOut:ie=>ie.target.pause()}):a.jsx("img",{src:fe.url,alt:fe.caption,className:"w-full h-full object-cover"}),!fe.isVideo&&a.jsx($,{size:"icon",variant:"secondary",className:"absolute top-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:ie=>{ie.stopPropagation(),Ve(fe,je)},disabled:z,title:"Convert to Veo Video",children:z?a.jsx(ft,{className:"h-4 w-4 animate-spin"}):a.jsx($I,{className:"h-4 w-4"})}),a.jsx($,{size:"icon",variant:"outline",className:"absolute bottom-1 right-1 h-7 w-7 opacity-0 group-hover:opacity-100 transition-opacity",onClick:ie=>{ie.stopPropagation(),R(fe),r("image-edit")},disabled:fe.isVideo,title:"Edit this image",children:a.jsx(sw,{className:"h-4 w-4"})})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsxs("span",{className:`text-xs font-semibold px-1.5 py-0.5 rounded-sm ${fe.isVideo?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"}`,children:[fe.isVideo?"Video":"Image"," ",je+1]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx($,{size:"icon",variant:"ghost",onClick:ie=>{ie.stopPropagation(),Ie(je,-1)},disabled:je===0,className:"h-7 w-7",children:a.jsx(J3,{className:"h-4 w-4"})}),a.jsx($,{size:"icon",variant:"ghost",onClick:ie=>{ie.stopPropagation(),Ie(je,1)},disabled:je===A.length-1,className:"h-7 w-7",children:a.jsx(Y3,{className:"h-4 w-4"})}),a.jsx($,{size:"icon",variant:"ghost",onClick:ie=>{ie.stopPropagation(),Ge(fe.id)},className:"h-7 w-7",children:a.jsx(X3,{className:"h-4 w-4"})}),a.jsx($,{size:"icon",variant:"ghost",onClick:ie=>{ie.stopPropagation(),Fe(fe.id)},className:"h-7 w-7 text-destructive",children:a.jsx(Bn,{className:"h-4 w-4"})})]})]}),a.jsx("p",{className:"text-sm mt-1 text-muted-foreground line-clamp-3",title:fe.caption,children:fe.caption})]})]},fe.id))})}),A.length>0&&a.jsx(zi,{className:"my-4"}),O&&a.jsxs("div",{className:"mt-6 p-4 border rounded-lg bg-card shadow",children:[a.jsxs("div",{className:"flex justify-between items-center mb-3",children:[a.jsx("h3",{className:"text-lg font-semibold",children:"Media Viewer"}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs($,{variant:"outline",size:"sm",onClick:H,children:[a.jsx(OI,{className:"mr-2 h-4 w-4"}),"Download"]}),a.jsx($,{variant:"ghost",size:"icon",onClick:()=>V(null),children:a.jsx(Ji,{className:"h-5 w-5"})})]})]}),O.type==="image"||!O.isVideo?a.jsx("img",{src:O.url,alt:O.caption||"Viewing media",className:"w-full max-h-[60vh] rounded-md object-contain border"}):a.jsx("video",{src:O.url,controls:!0,className:"w-full max-h-[60vh] rounded-md border bg-black",children:"Your browser does not support the video tag."}),a.jsx("p",{className:"text-sm text-muted-foreground mt-2 text-center",children:O.caption})]})]})})]})]})},vje=()=>a.jsx(uIe,{}),wje=()=>{const{isAuthenticated:t,loadingProfile:e}=ls();return e?a.jsx("div",{className:"min-h-screen flex items-center justify-center",children:a.jsx("p",{className:"text-xl",children:"Loading..."})}):t?a.jsx(zV,{to:"/",replace:!0}):a.jsx(ZRe,{})},bje=[{element:a.jsxs(tye,{children:[a.jsx(sje,{})," "]}),children:[{index:!0,element:a.jsx(vje,{})},{path:"auth",element:a.jsx(wje,{})},{path:"pricing",element:a.jsx(eje,{})},{path:"designer",element:a.jsx(pje,{})},{path:"music",element:a.jsx(gje,{})},{path:"podcast",element:a.jsx(yje,{})},{path:"video",element:a.jsx(xje,{})},{path:":storeName",element:a.jsx(jRe,{})},{path:":storeName/product/:productId",element:a.jsx(KRe,{})},{path:"checkout",element:a.jsx(JRe,{})},{path:"order-confirmation",element:a.jsx(nje,{})},{path:":storeName/content-creation",element:a.jsx(EEe,{})},{path:":storeName/dashboard",element:a.jsx(fje,{})},{path:"*",element:a.jsx(zV,{to:"/",replace:!0})}]}],_je=!0,Sje=!0,Cje=OX(bje,{future:{v7_startTransition:_je,v7_relativeSplatPath:Sje}}),_v=document.getElementById("root");_v._reactRoot||(_v._reactRoot=wC.createRoot(_v));const mO=_v._reactRoot;try{mO.render(a.jsx(ht.StrictMode,{children:a.jsx(qX,{router:Cje})}))}catch(t){console.error("Application initialization failed:",t);let e="Application failed to load. Please check the console for details.";t.message.includes("VITE_")&&t.message.includes("is not set")&&(e=`Configuration Error: ${t.message}. Please ensure all required environment variables are correctly set in your .env file and the application is rebuilt if necessary.`),mO.render(a.jsx(ht.StrictMode,{children:a.jsxs("div",{style:{padding:"20px",textAlign:"center",color:"red",fontFamily:"sans-serif"},children:[a.jsx("h1",{children:"Application Load Error"}),a.jsx("p",{children:e}),a.jsxs("p",{children:["Please check your ",a.jsx("code",{children:".env"})," file and ensure all necessary environment variables are configured."]})]})}))}export{yg as $,Ac as A,$ as B,Ke as C,Bn as D,Hie as E,jE as F,Z_ as G,H3 as H,qn as I,ME as J,K3 as K,ir as L,mh as M,Ou as N,wP as O,R2 as P,y0e as Q,ht as R,Sr as S,am as T,vi as U,Gw as V,ms as W,Ji as X,el as Y,tU as Z,Jg as _,W0e as a,moe as a0,$I as a1,$0 as a2,ya as a3,noe as a4,aoe as a5,toe as a6,$ie as a7,qie as a8,poe as a9,Vi as aA,ooe as aB,Ea as aC,NRe as aD,kRe as aE,Pg as aF,uoe as aG,xl as aH,al as aI,W3 as aJ,Uo as aK,Cn as aL,Ua as aM,ft as aN,Ui as aO,dg as aP,K0 as aQ,Wo as aR,Jie as aS,tw as aT,Qie as aU,Hx as aa,yoe as ab,Zie as ac,hoe as ad,A2 as ae,wi as af,Oo as ag,ws as ah,ls as ai,zr as aj,Dr as ak,Mr as al,Lr as am,_i as an,Si as ao,ti as ap,jt as aq,Dt as ar,ke as as,Nr as at,ba as au,Yae as av,Qa as aw,jq as ax,Z3 as ay,K0e as az,$S as b,VI as c,Fu as d,TRe as e,$a as f,st as g,vd as h,Wp as i,a as j,rw as k,c1e as l,Ct as m,ac as n,mc as o,We as p,iw as q,p as r,Do as s,Vie as t,$n as u,ERe as v,bt as w,Ss as x,qe as y,Au as z};
