import{K as T,j as e,D as k,g as I,h as $,k as F,l as B,N as E,H as f,s as M,O as P,B as v,y as H,r as j,F as p,z as O}from"./index-DQzOWQZE.js";const A=({isOpen:t,onClose:r,collection:o,storeId:m})=>{const c=T();if(!o)return null;const d=s=>{r(),c(`/store/${m}/product/${s}`)};return e.jsx(k,{open:t,onOpenChange:r,children:e.jsxs(I,{className:"sm:max-w-lg",children:[e.jsxs($,{children:[e.jsx(F,{children:o.name||"Collection Products"}),e.jsxs(B,{children:['Browse products available in the "',o.name||"Unnamed",'" collection. Click a product to see more details.']})]}),e.jsx(E,{className:"max-h-[60vh] p-1",children:e.jsx("div",{className:"py-4 space-y-3",children:o.products&&o.products.length>0?o.products.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-md hover:bg-muted/50 transition-colors cursor-pointer",onClick:()=>d(s.id),role:"button",tabIndex:0,onKeyDown:i=>i.key==="Enter"&&d(s.id),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[s.image&&s.image.src&&s.image.src.medium?e.jsx("img",{src:s.image.src.medium,alt:s.name||"Product image",className:"w-16 h-16 object-cover rounded-md border"}):e.jsx("div",{className:"w-16 h-16 bg-muted rounded-md flex items-center justify-center text-xs text-muted-foreground",children:"No Image"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:s.name||"Untitled Product"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:s.price?`$${parseFloat(s.price).toFixed(2)}`:"Price not available"})]})]}),e.jsx(f,{className:"h-5 w-5 text-muted-foreground"})]},s.id)):e.jsx("p",{className:"text-center text-muted-foreground py-8",children:"No products found in this collection."})})}),e.jsx(M,{className:"sm:justify-start",children:e.jsx(P,{asChild:!0,children:e.jsx(v,{type:"button",variant:"outline",children:"Close"})})})]})})},U=({collection:t,onCollectionClick:r,isAdmin:o,onSaveCollectionText:m,collectionIndex:c})=>{const d="https://images.unsplash.com/photo-1588099768531-a72d4a198538?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MTB8fGNsb3RoaW5nfGVufDB8fDB8fHww&auto=format&fit=crop&w=600&q=60",s=(t==null?void 0:t.name)||"Unnamed Collection",i=(t==null?void 0:t.description)||`Explore our ${s} collection.`,l=(t==null?void 0:t.imageUrl)||d,h=`Image for ${s}`;return e.jsxs(O.div,{whileHover:{y:-5},className:"group relative block overflow-hidden rounded-xl shadow-lg cursor-pointer",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},onClick:()=>r(t),role:"button",tabIndex:0,onKeyDown:n=>n.key==="Enter"&&r(t),children:[e.jsx("img",{src:l,alt:h,className:"h-72 w-full object-cover transition-transform duration-500 group-hover:scale-105 sm:h-80 lg:h-96",loading:"lazy"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/50 to-transparent"}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 text-white",children:[e.jsx("h3",{className:"text-2xl font-bold group-hover:underline group-hover:decoration-primary",children:e.jsx(p,{initialText:s,onSave:n=>m(c,"name",n),isAdmin:o,placeholder:"Collection Title",textClassName:"text-2xl font-bold"})}),e.jsx("p",{className:"mt-1 text-sm opacity-90 line-clamp-2",children:e.jsx(p,{initialText:i,onSave:n=>m(c,"description",n),isAdmin:o,placeholder:"Collection Description",useTextarea:!0,textClassName:"text-sm opacity-90"})}),e.jsxs("div",{className:"mt-4 inline-flex items-center text-sm font-medium text-primary group-hover:text-yellow-300 transition-colors",children:["View Products ",e.jsx(f,{className:"ml-1.5 h-4 w-4"})]})]})]})},K=({store:t,isPublishedView:r=!1})=>{const{updateStore:o}=H(),[m,c]=j.useState(!1),[d,s]=j.useState(null),i=t==null?void 0:t.collections,l=t==null?void 0:t.id,h=!r,n=(t==null?void 0:t.content)||{},N=a=>{console.log("Clicked collection:",a),a&&l?(s(a),c(!0)):console.warn("Collection data or store ID is missing for dialog.",{collection:a,storeId:l})},C=()=>{c(!1),s(null)},b=async(a,x)=>{if(l)try{a==="collectionsSectionTitle"&&await o(l,{content:{...n,collectionsSectionTitle:x}})}catch(g){console.error(`Failed to update store ${a}:`,g)}},y=async(a,x,g)=>{if(l&&i&&i[a]){const D=i.map((u,S)=>S===a?{...u,[x]:g}:u);try{await o(l,{collections:D})}catch(u){console.error(`Failed to update collection ${x} at index ${a}:`,u)}}},w=(n==null?void 0:n.collectionsSectionTitle)||"Shop by Collection";return e.jsxs(e.Fragment,{children:[e.jsxs("section",{id:`collections-${(t==null?void 0:t.id)||"featured-collections"}`,className:"container mx-auto px-4 pt-6 pb-12",children:[e.jsx("h2",{className:"text-3xl font-bold tracking-tight text-center mb-10 md:mb-12",children:e.jsx(p,{initialText:w,onSave:a=>b("collectionsSectionTitle",a),isAdmin:h,placeholder:"Section Title",textClassName:"text-3xl font-bold tracking-tight text-center"})}),!i||i.length===0?e.jsxs("div",{className:"text-center py-10",children:[e.jsx("p",{className:"text-muted-foreground",children:"No collections to display yet. Collections will appear here once added!"}),!r&&e.jsx(v,{variant:"outline",className:"mt-4",onClick:()=>console.log("Manage Collections clicked - implement navigation or modal"),children:"Manage Collections"})]}):e.jsx("div",{className:"grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-3",children:i.map((a,x)=>e.jsx(U,{collection:a,onCollectionClick:N,isAdmin:h,onSaveCollectionText:y,collectionIndex:x},a.id||a.name))})]}),d&&l&&e.jsx(A,{isOpen:m,onClose:C,collection:d,storeId:l})]})};export{K as default};
